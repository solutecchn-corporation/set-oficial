function uv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function op(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function dv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var Zc={exports:{}},ts={};var xg;function fv(){if(xg)return ts;xg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var h=null;if(d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:h,ref:u!==void 0?u:null,props:d}}return ts.Fragment=a,ts.jsx=s,ts.jsxs=s,ts}var jg;function hv(){return jg||(jg=1,Zc.exports=fv()),Zc.exports}var r=hv(),Wc={exports:{}},ns={},eu={exports:{}},tu={};var Sg;function gv(){return Sg||(Sg=1,(function(o){function a(C,k){var ee=C.length;C.push(k);e:for(;0<ee;){var me=ee-1>>>1,ve=C[me];if(0<u(ve,k))C[me]=k,C[ee]=ve,ee=me;else break e}}function s(C){return C.length===0?null:C[0]}function l(C){if(C.length===0)return null;var k=C[0],ee=C.pop();if(ee!==k){C[0]=ee;e:for(var me=0,ve=C.length,A=ve>>>1;me<A;){var z=2*(me+1)-1,$=C[z],F=z+1,pe=C[F];if(0>u($,ee))F<ve&&0>u(pe,$)?(C[me]=pe,C[F]=ee,me=F):(C[me]=$,C[z]=ee,me=z);else if(F<ve&&0>u(pe,ee))C[me]=pe,C[F]=ee,me=F;else break e}}return k}function u(C,k){var ee=C.sortIndex-k.sortIndex;return ee!==0?ee:C.id-k.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();o.unstable_now=function(){return h.now()-g}}var p=[],m=[],v=1,_=null,x=3,b=!1,w=!1,N=!1,O=!1,T=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function Y(C){for(var k=s(m);k!==null;){if(k.callback===null)l(m);else if(k.startTime<=C)l(m),k.sortIndex=k.expirationTime,a(p,k);else break;k=s(m)}}function E(C){if(N=!1,Y(C),!w)if(s(p)!==null)w=!0,M||(M=!0,xe());else{var k=s(m);k!==null&&ne(E,k.startTime-C)}}var M=!1,D=-1,V=5,ye=-1;function Q(){return O?!0:!(o.unstable_now()-ye<V)}function ge(){if(O=!1,M){var C=o.unstable_now();ye=C;var k=!0;try{e:{w=!1,N&&(N=!1,q(D),D=-1),b=!0;var ee=x;try{t:{for(Y(C),_=s(p);_!==null&&!(_.expirationTime>C&&Q());){var me=_.callback;if(typeof me=="function"){_.callback=null,x=_.priorityLevel;var ve=me(_.expirationTime<=C);if(C=o.unstable_now(),typeof ve=="function"){_.callback=ve,Y(C),k=!0;break t}_===s(p)&&l(p),Y(C)}else l(p);_=s(p)}if(_!==null)k=!0;else{var A=s(m);A!==null&&ne(E,A.startTime-C),k=!1}}break e}finally{_=null,x=ee,b=!1}k=void 0}}finally{k?xe():M=!1}}}var xe;if(typeof B=="function")xe=function(){B(ge)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,X=L.port2;L.port1.onmessage=ge,xe=function(){X.postMessage(null)}}else xe=function(){T(ge,0)};function ne(C,k){D=T(function(){C(o.unstable_now())},k)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(C){C.callback=null},o.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<C?Math.floor(1e3/C):5},o.unstable_getCurrentPriorityLevel=function(){return x},o.unstable_next=function(C){switch(x){case 1:case 2:case 3:var k=3;break;default:k=x}var ee=x;x=k;try{return C()}finally{x=ee}},o.unstable_requestPaint=function(){O=!0},o.unstable_runWithPriority=function(C,k){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var ee=x;x=C;try{return k()}finally{x=ee}},o.unstable_scheduleCallback=function(C,k,ee){var me=o.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?me+ee:me):ee=me,C){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=ee+ve,C={id:v++,callback:k,priorityLevel:C,startTime:ee,expirationTime:ve,sortIndex:-1},ee>me?(C.sortIndex=ee,a(m,C),s(p)===null&&C===s(m)&&(N?(q(D),D=-1):N=!0,ne(E,ee-me))):(C.sortIndex=ve,a(p,C),w||b||(w=!0,M||(M=!0,xe()))),C},o.unstable_shouldYield=Q,o.unstable_wrapCallback=function(C){var k=x;return function(){var ee=x;x=k;try{return C.apply(this,arguments)}finally{x=ee}}}})(tu)),tu}var wg;function pv(){return wg||(wg=1,eu.exports=gv()),eu.exports}var nu={exports:{}},Me={};var Eg;function mv(){if(Eg)return Me;Eg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),x=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=x&&A[x]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,O={};function T(A,z,$){this.props=A,this.context=z,this.refs=O,this.updater=$||w}T.prototype.isReactComponent={},T.prototype.setState=function(A,z){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,z,"setState")},T.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function q(){}q.prototype=T.prototype;function B(A,z,$){this.props=A,this.context=z,this.refs=O,this.updater=$||w}var Y=B.prototype=new q;Y.constructor=B,N(Y,T.prototype),Y.isPureReactComponent=!0;var E=Array.isArray;function M(){}var D={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function ye(A,z,$){var F=$.ref;return{$$typeof:o,type:A,key:z,ref:F!==void 0?F:null,props:$}}function Q(A,z){return ye(A.type,z,A.props)}function ge(A){return typeof A=="object"&&A!==null&&A.$$typeof===o}function xe(A){var z={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function($){return z[$]})}var L=/\/+/g;function X(A,z){return typeof A=="object"&&A!==null&&A.key!=null?xe(""+A.key):z.toString(36)}function ne(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(M,M):(A.status="pending",A.then(function(z){A.status==="pending"&&(A.status="fulfilled",A.value=z)},function(z){A.status==="pending"&&(A.status="rejected",A.reason=z)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function C(A,z,$,F,pe){var re=typeof A;(re==="undefined"||re==="boolean")&&(A=null);var P=!1;if(A===null)P=!0;else switch(re){case"bigint":case"string":case"number":P=!0;break;case"object":switch(A.$$typeof){case o:case a:P=!0;break;case v:return P=A._init,C(P(A._payload),z,$,F,pe)}}if(P)return pe=pe(A),P=F===""?"."+X(A,0):F,E(pe)?($="",P!=null&&($=P.replace(L,"$&/")+"/"),C(pe,z,$,"",function(Oe){return Oe})):pe!=null&&(ge(pe)&&(pe=Q(pe,$+(pe.key==null||A&&A.key===pe.key?"":(""+pe.key).replace(L,"$&/")+"/")+P)),z.push(pe)),1;P=0;var se=F===""?".":F+":";if(E(A))for(var _e=0;_e<A.length;_e++)F=A[_e],re=se+X(F,_e),P+=C(F,z,$,re,pe);else if(_e=b(A),typeof _e=="function")for(A=_e.call(A),_e=0;!(F=A.next()).done;)F=F.value,re=se+X(F,_e++),P+=C(F,z,$,re,pe);else if(re==="object"){if(typeof A.then=="function")return C(ne(A),z,$,F,pe);throw z=String(A),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return P}function k(A,z,$){if(A==null)return A;var F=[],pe=0;return C(A,F,"","",function(re){return z.call($,re,pe++)}),F}function ee(A){if(A._status===-1){var z=A._result;z=z(),z.then(function($){(A._status===0||A._status===-1)&&(A._status=1,A._result=$)},function($){(A._status===0||A._status===-1)&&(A._status=2,A._result=$)}),A._status===-1&&(A._status=0,A._result=z)}if(A._status===1)return A._result.default;throw A._result}var me=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},ve={map:k,forEach:function(A,z,$){k(A,function(){z.apply(this,arguments)},$)},count:function(A){var z=0;return k(A,function(){z++}),z},toArray:function(A){return k(A,function(z){return z})||[]},only:function(A){if(!ge(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Me.Activity=_,Me.Children=ve,Me.Component=T,Me.Fragment=s,Me.Profiler=u,Me.PureComponent=B,Me.StrictMode=l,Me.Suspense=p,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Me.__COMPILER_RUNTIME={__proto__:null,c:function(A){return D.H.useMemoCache(A)}},Me.cache=function(A){return function(){return A.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(A,z,$){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var F=N({},A.props),pe=A.key;if(z!=null)for(re in z.key!==void 0&&(pe=""+z.key),z)!V.call(z,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&z.ref===void 0||(F[re]=z[re]);var re=arguments.length-2;if(re===1)F.children=$;else if(1<re){for(var P=Array(re),se=0;se<re;se++)P[se]=arguments[se+2];F.children=P}return ye(A.type,pe,F)},Me.createContext=function(A){return A={$$typeof:h,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:d,_context:A},A},Me.createElement=function(A,z,$){var F,pe={},re=null;if(z!=null)for(F in z.key!==void 0&&(re=""+z.key),z)V.call(z,F)&&F!=="key"&&F!=="__self"&&F!=="__source"&&(pe[F]=z[F]);var P=arguments.length-2;if(P===1)pe.children=$;else if(1<P){for(var se=Array(P),_e=0;_e<P;_e++)se[_e]=arguments[_e+2];pe.children=se}if(A&&A.defaultProps)for(F in P=A.defaultProps,P)pe[F]===void 0&&(pe[F]=P[F]);return ye(A,re,pe)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(A){return{$$typeof:g,render:A}},Me.isValidElement=ge,Me.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:ee}},Me.memo=function(A,z){return{$$typeof:m,type:A,compare:z===void 0?null:z}},Me.startTransition=function(A){var z=D.T,$={};D.T=$;try{var F=A(),pe=D.S;pe!==null&&pe($,F),typeof F=="object"&&F!==null&&typeof F.then=="function"&&F.then(M,me)}catch(re){me(re)}finally{z!==null&&$.types!==null&&(z.types=$.types),D.T=z}},Me.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Me.use=function(A){return D.H.use(A)},Me.useActionState=function(A,z,$){return D.H.useActionState(A,z,$)},Me.useCallback=function(A,z){return D.H.useCallback(A,z)},Me.useContext=function(A){return D.H.useContext(A)},Me.useDebugValue=function(){},Me.useDeferredValue=function(A,z){return D.H.useDeferredValue(A,z)},Me.useEffect=function(A,z){return D.H.useEffect(A,z)},Me.useEffectEvent=function(A){return D.H.useEffectEvent(A)},Me.useId=function(){return D.H.useId()},Me.useImperativeHandle=function(A,z,$){return D.H.useImperativeHandle(A,z,$)},Me.useInsertionEffect=function(A,z){return D.H.useInsertionEffect(A,z)},Me.useLayoutEffect=function(A,z){return D.H.useLayoutEffect(A,z)},Me.useMemo=function(A,z){return D.H.useMemo(A,z)},Me.useOptimistic=function(A,z){return D.H.useOptimistic(A,z)},Me.useReducer=function(A,z,$){return D.H.useReducer(A,z,$)},Me.useRef=function(A){return D.H.useRef(A)},Me.useState=function(A){return D.H.useState(A)},Me.useSyncExternalStore=function(A,z,$){return D.H.useSyncExternalStore(A,z,$)},Me.useTransition=function(){return D.H.useTransition()},Me.version="19.2.0",Me}var Cg;function Cu(){return Cg||(Cg=1,nu.exports=mv()),nu.exports}var au={exports:{}},It={};var Tg;function yv(){if(Tg)return It;Tg=1;var o=Cu();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:_==null?null:""+_,children:p,containerInfo:m,implementation:v}}var h=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return It.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,It.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},It.flushSync=function(p){var m=h.T,v=l.p;try{if(h.T=null,l.p=2,p)return p()}finally{h.T=m,l.p=v,l.d.f()}},It.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},It.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},It.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:x,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:_,integrity:x,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},It.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},It.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},It.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},It.requestFormReset=function(p){l.d.r(p)},It.unstable_batchedUpdates=function(p,m){return p(m)},It.useFormState=function(p,m,v){return h.H.useFormState(p,m,v)},It.useFormStatus=function(){return h.H.useHostTransitionStatus()},It.version="19.2.0",It}var Ag;function cp(){if(Ag)return au.exports;Ag=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),au.exports=yv(),au.exports}var Ng;function vv(){if(Ng)return ns;Ng=1;var o=pv(),a=Cu(),s=cp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,i=t;;){var c=n.return;if(c===null)break;var f=c.alternate;if(f===null){if(i=c.return,i!==null){n=i;continue}break}if(c.child===f.child){for(f=c.child;f;){if(f===n)return p(c),e;if(f===i)return p(c),t;f=f.sibling}throw Error(l(188))}if(n.return!==i.return)n=c,i=f;else{for(var y=!1,j=c.child;j;){if(j===n){y=!0,n=c,i=f;break}if(j===i){y=!0,i=c,n=f;break}j=j.sibling}if(!y){for(j=f.child;j;){if(j===n){y=!0,n=f,i=c;break}if(j===i){y=!0,i=f,n=c;break}j=j.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==i)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var _=Object.assign,x=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),q=Symbol.for("react.consumer"),B=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),ye=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),ge=Symbol.iterator;function xe(e){return e===null||typeof e!="object"?null:(e=ge&&e[ge]||e["@@iterator"],typeof e=="function"?e:null)}var L=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===L?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case N:return"Fragment";case T:return"Profiler";case O:return"StrictMode";case E:return"Suspense";case M:return"SuspenseList";case ye:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case B:return e.displayName||"Context";case q:return(e._context.displayName||"Context")+".Consumer";case Y:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case D:return t=e.displayName||null,t!==null?t:X(e.type)||"Memo";case V:t=e._payload,e=e._init;try{return X(e(t))}catch{}}return null}var ne=Array.isArray,C=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,k=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},me=[],ve=-1;function A(e){return{current:e}}function z(e){0>ve||(e.current=me[ve],me[ve]=null,ve--)}function $(e,t){ve++,me[ve]=e.current,e.current=t}var F=A(null),pe=A(null),re=A(null),P=A(null);function se(e,t){switch($(re,t),$(pe,e),$(F,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Ph(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Ph(t),e=Gh(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(F),$(F,e)}function _e(){z(F),z(pe),z(re)}function Oe(e){e.memoizedState!==null&&$(P,e);var t=F.current,n=Gh(t,e.type);t!==n&&($(pe,e),$(F,n))}function De(e){pe.current===e&&(z(F),z(pe)),P.current===e&&(z(P),Xr._currentValue=ee)}var ze,Le;function Ke(e){if(ze===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ze=t&&t[1]||"",Le=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ze+e+Le}var gt=!1;function vt(e,t){if(!e||gt)return"";gt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(W){var J=W}Reflect.construct(e,[],ce)}else{try{ce.call()}catch(W){J=W}e.call(ce.prototype)}}else{try{throw Error()}catch(W){J=W}(ce=e())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(W){if(W&&J&&typeof W.stack=="string")return[W.stack,J.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=i.DetermineComponentFrameRoot(),y=f[0],j=f[1];if(y&&j){var R=y.split(`
`),K=j.split(`
`);for(c=i=0;i<R.length&&!R[i].includes("DetermineComponentFrameRoot");)i++;for(;c<K.length&&!K[c].includes("DetermineComponentFrameRoot");)c++;if(i===R.length||c===K.length)for(i=R.length-1,c=K.length-1;1<=i&&0<=c&&R[i]!==K[c];)c--;for(;1<=i&&0<=c;i--,c--)if(R[i]!==K[c]){if(i!==1||c!==1)do if(i--,c--,0>c||R[i]!==K[c]){var ie=`
`+R[i].replace(" at new "," at ");return e.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",e.displayName)),ie}while(1<=i&&0<=c);break}}}finally{gt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Ke(n):""}function bt(e,t){switch(e.tag){case 26:case 27:case 5:return Ke(e.type);case 16:return Ke("Lazy");case 13:return e.child!==t&&t!==null?Ke("Suspense Fallback"):Ke("Suspense");case 19:return Ke("SuspenseList");case 0:case 15:return vt(e.type,!1);case 11:return vt(e.type.render,!1);case 1:return vt(e.type,!0);case 31:return Ke("Activity");default:return""}}function Ot(e){try{var t="",n=null;do t+=bt(e,n),n=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var Jt=Object.prototype.hasOwnProperty,dt=o.unstable_scheduleCallback,et=o.unstable_cancelCallback,Da=o.unstable_shouldYield,di=o.unstable_requestPaint,Vt=o.unstable_now,cr=o.unstable_getCurrentPriorityLevel,ur=o.unstable_ImmediatePriority,fi=o.unstable_UserBlockingPriority,hi=o.unstable_NormalPriority,us=o.unstable_LowPriority,ds=o.unstable_IdlePriority,Hl=o.log,Vl=o.unstable_setDisableYieldValue,Un=null,$t=null;function zn(e){if(typeof Hl=="function"&&Vl(e),$t&&typeof $t.setStrictMode=="function")try{$t.setStrictMode(Un,e)}catch{}}var Pt=Math.clz32?Math.clz32:fs,$l=Math.log,Pl=Math.LN2;function fs(e){return e>>>=0,e===0?32:31-($l(e)/Pl|0)|0}var Ba=256,gi=262144,hn=4194304;function Gt(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ma(e,t,n){var i=e.pendingLanes;if(i===0)return 0;var c=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var j=i&134217727;return j!==0?(i=j&~f,i!==0?c=Gt(i):(y&=j,y!==0?c=Gt(y):n||(n=j&~e,n!==0&&(c=Gt(n))))):(j=i&~f,j!==0?c=Gt(j):y!==0?c=Gt(y):n||(n=i&~e,n!==0&&(c=Gt(n)))),c===0?0:t!==0&&t!==c&&(t&f)===0&&(f=c&-c,n=t&-t,f>=n||f===32&&(n&4194048)!==0)?t:c}function La(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Gl(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pi(){var e=hn;return hn<<=1,(hn&62914560)===0&&(hn=4194304),e}function dr(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Vn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function qa(e,t,n,i,c,f){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var j=e.entanglements,R=e.expirationTimes,K=e.hiddenUpdates;for(n=y&~n;0<n;){var ie=31-Pt(n),ce=1<<ie;j[ie]=0,R[ie]=-1;var J=K[ie];if(J!==null)for(K[ie]=null,ie=0;ie<J.length;ie++){var W=J[ie];W!==null&&(W.lane&=-536870913)}n&=~ce}i!==0&&hs(e,i,0),f!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function hs(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-Pt(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&261930}function gs(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Pt(n),c=1<<i;c&t|e[i]&t&&(e[i]|=t),n&=~c}}function ps(e,t){var n=t&-t;return n=(n&42)!==0?1:mi(n),(n&(e.suspendedLanes|t))!==0?0:n}function mi(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function fr(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function yi(){var e=k.p;return e!==0?e:(e=window.event,e===void 0?32:gg(e.type))}function Dn(e,t){var n=k.p;try{return k.p=e,t()}finally{k.p=n}}var Bn=Math.random().toString(36).slice(2),jt="__reactFiber$"+Bn,Ut="__reactProps$"+Bn,oa="__reactContainer$"+Bn,hr="__reactEvents$"+Bn,Kl="__reactListeners$"+Bn,H="__reactHandles$"+Bn,ae="__reactResources$"+Bn,be="__reactMarker$"+Bn;function oe(e){delete e[jt],delete e[Ut],delete e[hr],delete e[Kl],delete e[H]}function ue(e){var t=e[jt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[oa]||n[jt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Zh(e);e!==null;){if(n=e[jt])return n;e=Zh(e)}return t}e=n,n=e.parentNode}return null}function fe(e){if(e=e[jt]||e[oa]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function de(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function je(e){var t=e[ae];return t||(t=e[ae]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Z(e){e[be]=!0}var he=new Set,Ne={};function Ce(e,t){Ie(e,t),Ie(e+"Capture",t)}function Ie(e,t){for(Ne[e]=t,e=0;e<t.length;e++)he.add(t[e])}var Mn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),st={},ot={};function ft(e){return Jt.call(ot,e)?!0:Jt.call(st,e)?!1:Mn.test(e)?ot[e]=!0:(st[e]=!0,!1)}function gn(e,t,n){if(ft(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Ft(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function nn(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function Kt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function vi(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ia(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,f=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pn(e){if(!e._valueTracker){var t=vi(e)?"checked":"value";e._valueTracker=Ia(e,t,""+e[t])}}function Be(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=vi(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function Xe(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Rt=/[\n"\\]/g;function Re(e){return e.replace(Rt,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function tt(e,t,n,i,c,f,y,j){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Kt(t)):e.value!==""+Kt(t)&&(e.value=""+Kt(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?bi(e,y,Kt(t)):n!=null?bi(e,y,Kt(n)):i!=null&&e.removeAttribute("value"),c==null&&f!=null&&(e.defaultChecked=!!f),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?e.name=""+Kt(j):e.removeAttribute("name")}function qt(e,t,n,i,c,f,y,j){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||n!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){pn(e);return}n=n!=null?""+Kt(n):"",t=t!=null?""+Kt(t):n,j||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=j?e.checked:!!i,e.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),pn(e)}function bi(e,t,n){t==="number"&&Xe(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function $n(e,t,n,i){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Kt(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Lu(e,t,n){if(t!=null&&(t=""+Kt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Kt(n):""}function qu(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(l(92));if(ne(i)){if(1<i.length)throw Error(l(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=Kt(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i),pn(e)}function _i(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var rm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Iu(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||rm.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Hu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&n[c]!==i&&Iu(e,c,i)}else for(var f in t)t.hasOwnProperty(f)&&Iu(e,f,t[f])}function Yl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(e){return lm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pn(){}var Jl=null;function Fl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xi=null,ji=null;function Vu(e){var t=fe(e);if(t&&(e=t.stateNode)){var n=e[Ut]||null;e:switch(e=t.stateNode,t.type){case"input":if(tt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Re(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var c=i[Ut]||null;if(!c)throw Error(l(90));tt(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&Be(i)}break e;case"textarea":Lu(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&$n(e,!!n.multiple,t,!1)}}}var Ql=!1;function $u(e,t,n){if(Ql)return e(t,n);Ql=!0;try{var i=e(t);return i}finally{if(Ql=!1,(xi!==null||ji!==null)&&(al(),xi&&(t=xi,e=ji,ji=xi=null,Vu(t),e)))for(t=0;t<e.length;t++)Vu(e[t])}}function gr(e,t){var n=e.stateNode;if(n===null)return null;var i=n[Ut]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xl=!1;if(Gn)try{var pr={};Object.defineProperty(pr,"passive",{get:function(){Xl=!0}}),window.addEventListener("test",pr,pr),window.removeEventListener("test",pr,pr)}catch{Xl=!1}var ca=null,Zl=null,ys=null;function Pu(){if(ys)return ys;var e,t=Zl,n=t.length,i,c="value"in ca?ca.value:ca.textContent,f=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(i=1;i<=y&&t[n-i]===c[f-i];i++);return ys=c.slice(e,1<i?1-i:void 0)}function vs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bs(){return!0}function Gu(){return!1}function Qt(e){function t(n,i,c,f,y){this._reactName=n,this._targetInst=c,this.type=i,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(n=e[j],this[j]=n?n(f):f[j]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?bs:Gu,this.isPropagationStopped=Gu,this}return _(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),t}var Ha={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_s=Qt(Ha),mr=_({},Ha,{view:0,detail:0}),om=Qt(mr),Wl,eo,yr,xs=_({},mr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:no,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yr&&(yr&&e.type==="mousemove"?(Wl=e.screenX-yr.screenX,eo=e.screenY-yr.screenY):eo=Wl=0,yr=e),Wl)},movementY:function(e){return"movementY"in e?e.movementY:eo}}),Ku=Qt(xs),cm=_({},xs,{dataTransfer:0}),um=Qt(cm),dm=_({},mr,{relatedTarget:0}),to=Qt(dm),fm=_({},Ha,{animationName:0,elapsedTime:0,pseudoElement:0}),hm=Qt(fm),gm=_({},Ha,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pm=Qt(gm),mm=_({},Ha,{data:0}),Yu=Qt(mm),ym={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _m(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bm[e])?!!t[e]:!1}function no(){return _m}var xm=_({},mr,{key:function(e){if(e.key){var t=ym[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:no,charCode:function(e){return e.type==="keypress"?vs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jm=Qt(xm),Sm=_({},xs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ju=Qt(Sm),wm=_({},mr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:no}),Em=Qt(wm),Cm=_({},Ha,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tm=Qt(Cm),Am=_({},xs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nm=Qt(Am),Om=_({},Ha,{newState:0,oldState:0}),Rm=Qt(Om),km=[9,13,27,32],ao=Gn&&"CompositionEvent"in window,vr=null;Gn&&"documentMode"in document&&(vr=document.documentMode);var Um=Gn&&"TextEvent"in window&&!vr,Fu=Gn&&(!ao||vr&&8<vr&&11>=vr),Qu=" ",Xu=!1;function Zu(e,t){switch(e){case"keyup":return km.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Si=!1;function zm(e,t){switch(e){case"compositionend":return Wu(t);case"keypress":return t.which!==32?null:(Xu=!0,Qu);case"textInput":return e=t.data,e===Qu&&Xu?null:e;default:return null}}function Dm(e,t){if(Si)return e==="compositionend"||!ao&&Zu(e,t)?(e=Pu(),ys=Zl=ca=null,Si=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fu&&t.locale!=="ko"?null:t.data;default:return null}}var Bm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bm[e.type]:t==="textarea"}function td(e,t,n,i){xi?ji?ji.push(i):ji=[i]:xi=i,t=ul(t,"onChange"),0<t.length&&(n=new _s("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var br=null,_r=null;function Mm(e){Lh(e,0)}function js(e){var t=de(e);if(Be(t))return e}function nd(e,t){if(e==="change")return t}var ad=!1;if(Gn){var io;if(Gn){var ro="oninput"in document;if(!ro){var id=document.createElement("div");id.setAttribute("oninput","return;"),ro=typeof id.oninput=="function"}io=ro}else io=!1;ad=io&&(!document.documentMode||9<document.documentMode)}function rd(){br&&(br.detachEvent("onpropertychange",sd),_r=br=null)}function sd(e){if(e.propertyName==="value"&&js(_r)){var t=[];td(t,_r,e,Fl(e)),$u(Mm,t)}}function Lm(e,t,n){e==="focusin"?(rd(),br=t,_r=n,br.attachEvent("onpropertychange",sd)):e==="focusout"&&rd()}function qm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return js(_r)}function Im(e,t){if(e==="click")return js(t)}function Hm(e,t){if(e==="input"||e==="change")return js(t)}function Vm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var an=typeof Object.is=="function"?Object.is:Vm;function xr(e,t){if(an(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var c=n[i];if(!Jt.call(t,c)||!an(e[c],t[c]))return!1}return!0}function ld(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function od(e,t){var n=ld(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ld(n)}}function cd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ud(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Xe(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Xe(e.document)}return t}function so(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var $m=Gn&&"documentMode"in document&&11>=document.documentMode,wi=null,lo=null,jr=null,oo=!1;function dd(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;oo||wi==null||wi!==Xe(i)||(i=wi,"selectionStart"in i&&so(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),jr&&xr(jr,i)||(jr=i,i=ul(lo,"onSelect"),0<i.length&&(t=new _s("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=wi)))}function Va(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ei={animationend:Va("Animation","AnimationEnd"),animationiteration:Va("Animation","AnimationIteration"),animationstart:Va("Animation","AnimationStart"),transitionrun:Va("Transition","TransitionRun"),transitionstart:Va("Transition","TransitionStart"),transitioncancel:Va("Transition","TransitionCancel"),transitionend:Va("Transition","TransitionEnd")},co={},fd={};Gn&&(fd=document.createElement("div").style,"AnimationEvent"in window||(delete Ei.animationend.animation,delete Ei.animationiteration.animation,delete Ei.animationstart.animation),"TransitionEvent"in window||delete Ei.transitionend.transition);function $a(e){if(co[e])return co[e];if(!Ei[e])return e;var t=Ei[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in fd)return co[e]=t[n];return e}var hd=$a("animationend"),gd=$a("animationiteration"),pd=$a("animationstart"),Pm=$a("transitionrun"),Gm=$a("transitionstart"),Km=$a("transitioncancel"),md=$a("transitionend"),yd=new Map,uo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");uo.push("scrollEnd");function Tn(e,t){yd.set(e,t),Ce(t,[e])}var Ss=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},mn=[],Ci=0,fo=0;function ws(){for(var e=Ci,t=fo=Ci=0;t<e;){var n=mn[t];mn[t++]=null;var i=mn[t];mn[t++]=null;var c=mn[t];mn[t++]=null;var f=mn[t];if(mn[t++]=null,i!==null&&c!==null){var y=i.pending;y===null?c.next=c:(c.next=y.next,y.next=c),i.pending=c}f!==0&&vd(n,c,f)}}function Es(e,t,n,i){mn[Ci++]=e,mn[Ci++]=t,mn[Ci++]=n,mn[Ci++]=i,fo|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function ho(e,t,n,i){return Es(e,t,n,i),Cs(e)}function Pa(e,t){return Es(e,null,null,t),Cs(e)}function vd(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var c=!1,f=e.return;f!==null;)f.childLanes|=n,i=f.alternate,i!==null&&(i.childLanes|=n),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(c=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,c&&t!==null&&(c=31-Pt(n),e=f.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=n|536870912),f):null}function Cs(e){if(50<Pr)throw Pr=0,jc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ti={};function Ym(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(e,t,n,i){return new Ym(e,t,n,i)}function go(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Kn(e,t){var n=e.alternate;return n===null?(n=rn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function bd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ts(e,t,n,i,c,f){var y=0;if(i=e,typeof e=="function")go(e)&&(y=1);else if(typeof e=="string")y=Zy(e,n,F.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ye:return e=rn(31,n,t,c),e.elementType=ye,e.lanes=f,e;case N:return Ga(n.children,c,f,t);case O:y=8,c|=24;break;case T:return e=rn(12,n,t,c|2),e.elementType=T,e.lanes=f,e;case E:return e=rn(13,n,t,c),e.elementType=E,e.lanes=f,e;case M:return e=rn(19,n,t,c),e.elementType=M,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B:y=10;break e;case q:y=9;break e;case Y:y=11;break e;case D:y=14;break e;case V:y=16,i=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),i=null}return t=rn(y,n,t,c),t.elementType=e,t.type=i,t.lanes=f,t}function Ga(e,t,n,i){return e=rn(7,e,i,t),e.lanes=n,e}function po(e,t,n){return e=rn(6,e,null,t),e.lanes=n,e}function _d(e){var t=rn(18,null,null,0);return t.stateNode=e,t}function mo(e,t,n){return t=rn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var xd=new WeakMap;function yn(e,t){if(typeof e=="object"&&e!==null){var n=xd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Ot(t)},xd.set(e,t),t)}return{value:e,source:t,stack:Ot(t)}}var Ai=[],Ni=0,As=null,Sr=0,vn=[],bn=0,ua=null,Ln=1,qn="";function Yn(e,t){Ai[Ni++]=Sr,Ai[Ni++]=As,As=e,Sr=t}function jd(e,t,n){vn[bn++]=Ln,vn[bn++]=qn,vn[bn++]=ua,ua=e;var i=Ln;e=qn;var c=32-Pt(i)-1;i&=~(1<<c),n+=1;var f=32-Pt(t)+c;if(30<f){var y=c-c%5;f=(i&(1<<y)-1).toString(32),i>>=y,c-=y,Ln=1<<32-Pt(t)+c|n<<c|i,qn=f+e}else Ln=1<<f|n<<c|i,qn=e}function yo(e){e.return!==null&&(Yn(e,1),jd(e,1,0))}function vo(e){for(;e===As;)As=Ai[--Ni],Ai[Ni]=null,Sr=Ai[--Ni],Ai[Ni]=null;for(;e===ua;)ua=vn[--bn],vn[bn]=null,qn=vn[--bn],vn[bn]=null,Ln=vn[--bn],vn[bn]=null}function Sd(e,t){vn[bn++]=Ln,vn[bn++]=qn,vn[bn++]=ua,Ln=t.id,qn=t.overflow,ua=e}var zt=null,ct=null,Ye=!1,da=null,_n=!1,bo=Error(l(519));function fa(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wr(yn(t,e)),bo}function wd(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[jt]=e,t[Ut]=i,n){case"dialog":$e("cancel",t),$e("close",t);break;case"iframe":case"object":case"embed":$e("load",t);break;case"video":case"audio":for(n=0;n<Kr.length;n++)$e(Kr[n],t);break;case"source":$e("error",t);break;case"img":case"image":case"link":$e("error",t),$e("load",t);break;case"details":$e("toggle",t);break;case"input":$e("invalid",t),qt(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":$e("invalid",t);break;case"textarea":$e("invalid",t),qu(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||Vh(t.textContent,n)?(i.popover!=null&&($e("beforetoggle",t),$e("toggle",t)),i.onScroll!=null&&$e("scroll",t),i.onScrollEnd!=null&&$e("scrollend",t),i.onClick!=null&&(t.onclick=Pn),t=!0):t=!1,t||fa(e,!0)}function Ed(e){for(zt=e.return;zt;)switch(zt.tag){case 5:case 31:case 13:_n=!1;return;case 27:case 3:_n=!0;return;default:zt=zt.return}}function Oi(e){if(e!==zt)return!1;if(!Ye)return Ed(e),Ye=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Mc(e.type,e.memoizedProps)),n=!n),n&&ct&&fa(e),Ed(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ct=Xh(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ct=Xh(e)}else t===27?(t=ct,Ca(e.type)?(e=Vc,Vc=null,ct=e):ct=t):ct=zt?jn(e.stateNode.nextSibling):null;return!0}function Ka(){ct=zt=null,Ye=!1}function _o(){var e=da;return e!==null&&(en===null?en=e:en.push.apply(en,e),da=null),e}function wr(e){da===null?da=[e]:da.push(e)}var xo=A(null),Ya=null,Jn=null;function ha(e,t,n){$(xo,t._currentValue),t._currentValue=n}function Fn(e){e._currentValue=xo.current,z(xo)}function jo(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function So(e,t,n,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){var y=c.child;f=f.firstContext;e:for(;f!==null;){var j=f;f=c;for(var R=0;R<t.length;R++)if(j.context===t[R]){f.lanes|=n,j=f.alternate,j!==null&&(j.lanes|=n),jo(f.return,n,e),i||(y=null);break e}f=j.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,f=y.alternate,f!==null&&(f.lanes|=n),jo(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function Ri(e,t,n,i){e=null;for(var c=t,f=!1;c!==null;){if(!f){if((c.flags&524288)!==0)f=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var j=c.type;an(c.pendingProps.value,y.value)||(e!==null?e.push(j):e=[j])}}else if(c===P.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Xr):e=[Xr])}c=c.return}e!==null&&So(t,e,n,i),t.flags|=262144}function Ns(e){for(e=e.firstContext;e!==null;){if(!an(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ja(e){Ya=e,Jn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Dt(e){return Cd(Ya,e)}function Os(e,t){return Ya===null&&Ja(e),Cd(e,t)}function Cd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Jn===null){if(e===null)throw Error(l(308));Jn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Jn=Jn.next=t;return n}var Jm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Fm=o.unstable_scheduleCallback,Qm=o.unstable_NormalPriority,St={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wo(){return{controller:new Jm,data:new Map,refCount:0}}function Er(e){e.refCount--,e.refCount===0&&Fm(Qm,function(){e.controller.abort()})}var Cr=null,Eo=0,ki=0,Ui=null;function Xm(e,t){if(Cr===null){var n=Cr=[];Eo=0,ki=Ac(),Ui={status:"pending",value:void 0,then:function(i){n.push(i)}}}return Eo++,t.then(Td,Td),t}function Td(){if(--Eo===0&&Cr!==null){Ui!==null&&(Ui.status="fulfilled");var e=Cr;Cr=null,ki=0,Ui=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Zm(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),i}var Ad=C.S;C.S=function(e,t){fh=Vt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Xm(e,t),Ad!==null&&Ad(e,t)};var Fa=A(null);function Co(){var e=Fa.current;return e!==null?e:rt.pooledCache}function Rs(e,t){t===null?$(Fa,Fa.current):$(Fa,t.pool)}function Nd(){var e=Co();return e===null?null:{parent:St._currentValue,pool:e}}var zi=Error(l(460)),To=Error(l(474)),ks=Error(l(542)),Us={then:function(){}};function Od(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Rd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Pn,Pn),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ud(e),e;default:if(typeof t.status=="string")t.then(Pn,Pn);else{if(e=rt,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ud(e),e}throw Xa=t,zi}}function Qa(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Xa=n,zi):n}}var Xa=null;function kd(){if(Xa===null)throw Error(l(459));var e=Xa;return Xa=null,e}function Ud(e){if(e===zi||e===ks)throw Error(l(483))}var Di=null,Tr=0;function zs(e){var t=Tr;return Tr+=1,Di===null&&(Di=[]),Rd(Di,e,t)}function Ar(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ds(e,t){throw t.$$typeof===x?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function zd(e){function t(I,U){if(e){var G=I.deletions;G===null?(I.deletions=[U],I.flags|=16):G.push(U)}}function n(I,U){if(!e)return null;for(;U!==null;)t(I,U),U=U.sibling;return null}function i(I){for(var U=new Map;I!==null;)I.key!==null?U.set(I.key,I):U.set(I.index,I),I=I.sibling;return U}function c(I,U){return I=Kn(I,U),I.index=0,I.sibling=null,I}function f(I,U,G){return I.index=G,e?(G=I.alternate,G!==null?(G=G.index,G<U?(I.flags|=67108866,U):G):(I.flags|=67108866,U)):(I.flags|=1048576,U)}function y(I){return e&&I.alternate===null&&(I.flags|=67108866),I}function j(I,U,G,le){return U===null||U.tag!==6?(U=po(G,I.mode,le),U.return=I,U):(U=c(U,G),U.return=I,U)}function R(I,U,G,le){var Ae=G.type;return Ae===N?ie(I,U,G.props.children,le,G.key):U!==null&&(U.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===V&&Qa(Ae)===U.type)?(U=c(U,G.props),Ar(U,G),U.return=I,U):(U=Ts(G.type,G.key,G.props,null,I.mode,le),Ar(U,G),U.return=I,U)}function K(I,U,G,le){return U===null||U.tag!==4||U.stateNode.containerInfo!==G.containerInfo||U.stateNode.implementation!==G.implementation?(U=mo(G,I.mode,le),U.return=I,U):(U=c(U,G.children||[]),U.return=I,U)}function ie(I,U,G,le,Ae){return U===null||U.tag!==7?(U=Ga(G,I.mode,le,Ae),U.return=I,U):(U=c(U,G),U.return=I,U)}function ce(I,U,G){if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return U=po(""+U,I.mode,G),U.return=I,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case b:return G=Ts(U.type,U.key,U.props,null,I.mode,G),Ar(G,U),G.return=I,G;case w:return U=mo(U,I.mode,G),U.return=I,U;case V:return U=Qa(U),ce(I,U,G)}if(ne(U)||xe(U))return U=Ga(U,I.mode,G,null),U.return=I,U;if(typeof U.then=="function")return ce(I,zs(U),G);if(U.$$typeof===B)return ce(I,Os(I,U),G);Ds(I,U)}return null}function J(I,U,G,le){var Ae=U!==null?U.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return Ae!==null?null:j(I,U,""+G,le);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case b:return G.key===Ae?R(I,U,G,le):null;case w:return G.key===Ae?K(I,U,G,le):null;case V:return G=Qa(G),J(I,U,G,le)}if(ne(G)||xe(G))return Ae!==null?null:ie(I,U,G,le,null);if(typeof G.then=="function")return J(I,U,zs(G),le);if(G.$$typeof===B)return J(I,U,Os(I,G),le);Ds(I,G)}return null}function W(I,U,G,le,Ae){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return I=I.get(G)||null,j(U,I,""+le,Ae);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case b:return I=I.get(le.key===null?G:le.key)||null,R(U,I,le,Ae);case w:return I=I.get(le.key===null?G:le.key)||null,K(U,I,le,Ae);case V:return le=Qa(le),W(I,U,G,le,Ae)}if(ne(le)||xe(le))return I=I.get(G)||null,ie(U,I,le,Ae,null);if(typeof le.then=="function")return W(I,U,G,zs(le),Ae);if(le.$$typeof===B)return W(I,U,G,Os(U,le),Ae);Ds(U,le)}return null}function Se(I,U,G,le){for(var Ae=null,Je=null,we=U,He=U=0,Ge=null;we!==null&&He<G.length;He++){we.index>He?(Ge=we,we=null):Ge=we.sibling;var Fe=J(I,we,G[He],le);if(Fe===null){we===null&&(we=Ge);break}e&&we&&Fe.alternate===null&&t(I,we),U=f(Fe,U,He),Je===null?Ae=Fe:Je.sibling=Fe,Je=Fe,we=Ge}if(He===G.length)return n(I,we),Ye&&Yn(I,He),Ae;if(we===null){for(;He<G.length;He++)we=ce(I,G[He],le),we!==null&&(U=f(we,U,He),Je===null?Ae=we:Je.sibling=we,Je=we);return Ye&&Yn(I,He),Ae}for(we=i(we);He<G.length;He++)Ge=W(we,I,He,G[He],le),Ge!==null&&(e&&Ge.alternate!==null&&we.delete(Ge.key===null?He:Ge.key),U=f(Ge,U,He),Je===null?Ae=Ge:Je.sibling=Ge,Je=Ge);return e&&we.forEach(function(Ra){return t(I,Ra)}),Ye&&Yn(I,He),Ae}function ke(I,U,G,le){if(G==null)throw Error(l(151));for(var Ae=null,Je=null,we=U,He=U=0,Ge=null,Fe=G.next();we!==null&&!Fe.done;He++,Fe=G.next()){we.index>He?(Ge=we,we=null):Ge=we.sibling;var Ra=J(I,we,Fe.value,le);if(Ra===null){we===null&&(we=Ge);break}e&&we&&Ra.alternate===null&&t(I,we),U=f(Ra,U,He),Je===null?Ae=Ra:Je.sibling=Ra,Je=Ra,we=Ge}if(Fe.done)return n(I,we),Ye&&Yn(I,He),Ae;if(we===null){for(;!Fe.done;He++,Fe=G.next())Fe=ce(I,Fe.value,le),Fe!==null&&(U=f(Fe,U,He),Je===null?Ae=Fe:Je.sibling=Fe,Je=Fe);return Ye&&Yn(I,He),Ae}for(we=i(we);!Fe.done;He++,Fe=G.next())Fe=W(we,I,He,Fe.value,le),Fe!==null&&(e&&Fe.alternate!==null&&we.delete(Fe.key===null?He:Fe.key),U=f(Fe,U,He),Je===null?Ae=Fe:Je.sibling=Fe,Je=Fe);return e&&we.forEach(function(cv){return t(I,cv)}),Ye&&Yn(I,He),Ae}function it(I,U,G,le){if(typeof G=="object"&&G!==null&&G.type===N&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case b:e:{for(var Ae=G.key;U!==null;){if(U.key===Ae){if(Ae=G.type,Ae===N){if(U.tag===7){n(I,U.sibling),le=c(U,G.props.children),le.return=I,I=le;break e}}else if(U.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===V&&Qa(Ae)===U.type){n(I,U.sibling),le=c(U,G.props),Ar(le,G),le.return=I,I=le;break e}n(I,U);break}else t(I,U);U=U.sibling}G.type===N?(le=Ga(G.props.children,I.mode,le,G.key),le.return=I,I=le):(le=Ts(G.type,G.key,G.props,null,I.mode,le),Ar(le,G),le.return=I,I=le)}return y(I);case w:e:{for(Ae=G.key;U!==null;){if(U.key===Ae)if(U.tag===4&&U.stateNode.containerInfo===G.containerInfo&&U.stateNode.implementation===G.implementation){n(I,U.sibling),le=c(U,G.children||[]),le.return=I,I=le;break e}else{n(I,U);break}else t(I,U);U=U.sibling}le=mo(G,I.mode,le),le.return=I,I=le}return y(I);case V:return G=Qa(G),it(I,U,G,le)}if(ne(G))return Se(I,U,G,le);if(xe(G)){if(Ae=xe(G),typeof Ae!="function")throw Error(l(150));return G=Ae.call(G),ke(I,U,G,le)}if(typeof G.then=="function")return it(I,U,zs(G),le);if(G.$$typeof===B)return it(I,U,Os(I,G),le);Ds(I,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,U!==null&&U.tag===6?(n(I,U.sibling),le=c(U,G),le.return=I,I=le):(n(I,U),le=po(G,I.mode,le),le.return=I,I=le),y(I)):n(I,U)}return function(I,U,G,le){try{Tr=0;var Ae=it(I,U,G,le);return Di=null,Ae}catch(we){if(we===zi||we===ks)throw we;var Je=rn(29,we,null,I.mode);return Je.lanes=le,Je.return=I,Je}finally{}}}var Za=zd(!0),Dd=zd(!1),ga=!1;function Ao(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function No(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function pa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ma(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Qe&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=Cs(e),vd(e,null,n),t}return Es(e,i,t,n),Cs(e)}function Nr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,gs(e,n)}}function Oo(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var c=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};f===null?c=f=y:f=f.next=y,n=n.next}while(n!==null);f===null?c=f=t:f=f.next=t}else c=f=t;n={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:f,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Ro=!1;function Or(){if(Ro){var e=Ui;if(e!==null)throw e}}function Rr(e,t,n,i){Ro=!1;var c=e.updateQueue;ga=!1;var f=c.firstBaseUpdate,y=c.lastBaseUpdate,j=c.shared.pending;if(j!==null){c.shared.pending=null;var R=j,K=R.next;R.next=null,y===null?f=K:y.next=K,y=R;var ie=e.alternate;ie!==null&&(ie=ie.updateQueue,j=ie.lastBaseUpdate,j!==y&&(j===null?ie.firstBaseUpdate=K:j.next=K,ie.lastBaseUpdate=R))}if(f!==null){var ce=c.baseState;y=0,ie=K=R=null,j=f;do{var J=j.lane&-536870913,W=J!==j.lane;if(W?(Pe&J)===J:(i&J)===J){J!==0&&J===ki&&(Ro=!0),ie!==null&&(ie=ie.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Se=e,ke=j;J=t;var it=n;switch(ke.tag){case 1:if(Se=ke.payload,typeof Se=="function"){ce=Se.call(it,ce,J);break e}ce=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=ke.payload,J=typeof Se=="function"?Se.call(it,ce,J):Se,J==null)break e;ce=_({},ce,J);break e;case 2:ga=!0}}J=j.callback,J!==null&&(e.flags|=64,W&&(e.flags|=8192),W=c.callbacks,W===null?c.callbacks=[J]:W.push(J))}else W={lane:J,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ie===null?(K=ie=W,R=ce):ie=ie.next=W,y|=J;if(j=j.next,j===null){if(j=c.shared.pending,j===null)break;W=j,j=W.next,W.next=null,c.lastBaseUpdate=W,c.shared.pending=null}}while(!0);ie===null&&(R=ce),c.baseState=R,c.firstBaseUpdate=K,c.lastBaseUpdate=ie,f===null&&(c.shared.lanes=0),xa|=y,e.lanes=y,e.memoizedState=ce}}function Bd(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function Md(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Bd(n[e],t)}var Bi=A(null),Bs=A(0);function Ld(e,t){e=ia,$(Bs,e),$(Bi,t),ia=e|t.baseLanes}function ko(){$(Bs,ia),$(Bi,Bi.current)}function Uo(){ia=Bs.current,z(Bi),z(Bs)}var sn=A(null),xn=null;function ya(e){var t=e.alternate;$(_t,_t.current&1),$(sn,e),xn===null&&(t===null||Bi.current!==null||t.memoizedState!==null)&&(xn=e)}function zo(e){$(_t,_t.current),$(sn,e),xn===null&&(xn=e)}function qd(e){e.tag===22?($(_t,_t.current),$(sn,e),xn===null&&(xn=e)):va()}function va(){$(_t,_t.current),$(sn,sn.current)}function ln(e){z(sn),xn===e&&(xn=null),z(_t)}var _t=A(0);function Ms(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Ic(n)||Hc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qn=0,qe=null,nt=null,wt=null,Ls=!1,Mi=!1,Wa=!1,qs=0,kr=0,Li=null,Wm=0;function mt(){throw Error(l(321))}function Do(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!an(e[n],t[n]))return!1;return!0}function Bo(e,t,n,i,c,f){return Qn=f,qe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,C.H=e===null||e.memoizedState===null?Sf:Xo,Wa=!1,f=n(i,c),Wa=!1,Mi&&(f=Hd(t,n,i,c)),Id(e),f}function Id(e){C.H=Dr;var t=nt!==null&&nt.next!==null;if(Qn=0,wt=nt=qe=null,Ls=!1,kr=0,Li=null,t)throw Error(l(300));e===null||Et||(e=e.dependencies,e!==null&&Ns(e)&&(Et=!0))}function Hd(e,t,n,i){qe=e;var c=0;do{if(Mi&&(Li=null),kr=0,Mi=!1,25<=c)throw Error(l(301));if(c+=1,wt=nt=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}C.H=wf,f=t(n,i)}while(Mi);return f}function ey(){var e=C.H,t=e.useState()[0];return t=typeof t.then=="function"?Ur(t):t,e=e.useState()[0],(nt!==null?nt.memoizedState:null)!==e&&(qe.flags|=1024),t}function Mo(){var e=qs!==0;return qs=0,e}function Lo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function qo(e){if(Ls){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ls=!1}Qn=0,wt=nt=qe=null,Mi=!1,kr=qs=0,Li=null}function Yt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?qe.memoizedState=wt=e:wt=wt.next=e,wt}function xt(){if(nt===null){var e=qe.alternate;e=e!==null?e.memoizedState:null}else e=nt.next;var t=wt===null?qe.memoizedState:wt.next;if(t!==null)wt=t,nt=e;else{if(e===null)throw qe.alternate===null?Error(l(467)):Error(l(310));nt=e,e={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},wt===null?qe.memoizedState=wt=e:wt=wt.next=e}return wt}function Is(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ur(e){var t=kr;return kr+=1,Li===null&&(Li=[]),e=Rd(Li,e,t),t=qe,(wt===null?t.memoizedState:wt.next)===null&&(t=t.alternate,C.H=t===null||t.memoizedState===null?Sf:Xo),e}function Hs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Ur(e);if(e.$$typeof===B)return Dt(e)}throw Error(l(438,String(e)))}function Io(e){var t=null,n=qe.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=qe.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Is(),qe.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=Q;return t.index++,n}function Xn(e,t){return typeof t=="function"?t(e):t}function Vs(e){var t=xt();return Ho(t,nt,e)}function Ho(e,t,n){var i=e.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=n;var c=e.baseQueue,f=i.pending;if(f!==null){if(c!==null){var y=c.next;c.next=f.next,f.next=y}t.baseQueue=c=f,i.pending=null}if(f=e.baseState,c===null)e.memoizedState=f;else{t=c.next;var j=y=null,R=null,K=t,ie=!1;do{var ce=K.lane&-536870913;if(ce!==K.lane?(Pe&ce)===ce:(Qn&ce)===ce){var J=K.revertLane;if(J===0)R!==null&&(R=R.next={lane:0,revertLane:0,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),ce===ki&&(ie=!0);else if((Qn&J)===J){K=K.next,J===ki&&(ie=!0);continue}else ce={lane:0,revertLane:K.revertLane,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},R===null?(j=R=ce,y=f):R=R.next=ce,qe.lanes|=J,xa|=J;ce=K.action,Wa&&n(f,ce),f=K.hasEagerState?K.eagerState:n(f,ce)}else J={lane:ce,revertLane:K.revertLane,gesture:K.gesture,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},R===null?(j=R=J,y=f):R=R.next=J,qe.lanes|=ce,xa|=ce;K=K.next}while(K!==null&&K!==t);if(R===null?y=f:R.next=j,!an(f,e.memoizedState)&&(Et=!0,ie&&(n=Ui,n!==null)))throw n;e.memoizedState=f,e.baseState=y,e.baseQueue=R,i.lastRenderedState=f}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Vo(e){var t=xt(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var i=n.dispatch,c=n.pending,f=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do f=e(f,y.action),y=y.next;while(y!==c);an(f,t.memoizedState)||(Et=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,i]}function Vd(e,t,n){var i=qe,c=xt(),f=Ye;if(f){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!an((nt||c).memoizedState,n);if(y&&(c.memoizedState=n,Et=!0),c=c.queue,Go(Gd.bind(null,i,c,e),[e]),c.getSnapshot!==t||y||wt!==null&&wt.memoizedState.tag&1){if(i.flags|=2048,qi(9,{destroy:void 0},Pd.bind(null,i,c,n,t),null),rt===null)throw Error(l(349));f||(Qn&127)!==0||$d(i,t,n)}return n}function $d(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=qe.updateQueue,t===null?(t=Is(),qe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Pd(e,t,n,i){t.value=n,t.getSnapshot=i,Kd(t)&&Yd(e)}function Gd(e,t,n){return n(function(){Kd(t)&&Yd(e)})}function Kd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!an(e,n)}catch{return!0}}function Yd(e){var t=Pa(e,2);t!==null&&tn(t,e,2)}function $o(e){var t=Yt();if(typeof e=="function"){var n=e;if(e=n(),Wa){zn(!0);try{n()}finally{zn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:e},t}function Jd(e,t,n,i){return e.baseState=n,Ho(e,nt,typeof i=="function"?i:Xn)}function ty(e,t,n,i,c){if(Gs(e))throw Error(l(485));if(e=t.action,e!==null){var f={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};C.T!==null?n(!0):f.isTransition=!1,i(f),n=t.pending,n===null?(f.next=t.pending=f,Fd(t,f)):(f.next=n.next,t.pending=n.next=f)}}function Fd(e,t){var n=t.action,i=t.payload,c=e.state;if(t.isTransition){var f=C.T,y={};C.T=y;try{var j=n(c,i),R=C.S;R!==null&&R(y,j),Qd(e,t,j)}catch(K){Po(e,t,K)}finally{f!==null&&y.types!==null&&(f.types=y.types),C.T=f}}else try{f=n(c,i),Qd(e,t,f)}catch(K){Po(e,t,K)}}function Qd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Xd(e,t,i)},function(i){return Po(e,t,i)}):Xd(e,t,n)}function Xd(e,t,n){t.status="fulfilled",t.value=n,Zd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Fd(e,n)))}function Po(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,Zd(t),t=t.next;while(t!==i)}e.action=null}function Zd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Wd(e,t){return t}function ef(e,t){if(Ye){var n=rt.formState;if(n!==null){e:{var i=qe;if(Ye){if(ct){t:{for(var c=ct,f=_n;c.nodeType!==8;){if(!f){c=null;break t}if(c=jn(c.nextSibling),c===null){c=null;break t}}f=c.data,c=f==="F!"||f==="F"?c:null}if(c){ct=jn(c.nextSibling),i=c.data==="F!";break e}}fa(i)}i=!1}i&&(t=n[0])}}return n=Yt(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wd,lastRenderedState:t},n.queue=i,n=_f.bind(null,qe,i),i.dispatch=n,i=$o(!1),f=Qo.bind(null,qe,!1,i.queue),i=Yt(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,n=ty.bind(null,qe,c,f,n),c.dispatch=n,i.memoizedState=e,[t,n,!1]}function tf(e){var t=xt();return nf(t,nt,e)}function nf(e,t,n){if(t=Ho(e,t,Wd)[0],e=Vs(Xn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=Ur(t)}catch(y){throw y===zi?ks:y}else i=t;t=xt();var c=t.queue,f=c.dispatch;return n!==t.memoizedState&&(qe.flags|=2048,qi(9,{destroy:void 0},ny.bind(null,c,n),null)),[i,f,e]}function ny(e,t){e.action=t}function af(e){var t=xt(),n=nt;if(n!==null)return nf(t,n,e);xt(),t=t.memoizedState,n=xt();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function qi(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},t=qe.updateQueue,t===null&&(t=Is(),qe.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function rf(){return xt().memoizedState}function $s(e,t,n,i){var c=Yt();qe.flags|=e,c.memoizedState=qi(1|t,{destroy:void 0},n,i===void 0?null:i)}function Ps(e,t,n,i){var c=xt();i=i===void 0?null:i;var f=c.memoizedState.inst;nt!==null&&i!==null&&Do(i,nt.memoizedState.deps)?c.memoizedState=qi(t,f,n,i):(qe.flags|=e,c.memoizedState=qi(1|t,f,n,i))}function sf(e,t){$s(8390656,8,e,t)}function Go(e,t){Ps(2048,8,e,t)}function ay(e){qe.flags|=4;var t=qe.updateQueue;if(t===null)t=Is(),qe.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function lf(e){var t=xt().memoizedState;return ay({ref:t,nextImpl:e}),function(){if((Qe&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function of(e,t){return Ps(4,2,e,t)}function cf(e,t){return Ps(4,4,e,t)}function uf(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function df(e,t,n){n=n!=null?n.concat([e]):null,Ps(4,4,uf.bind(null,t,e),n)}function Ko(){}function ff(e,t){var n=xt();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&Do(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function hf(e,t){var n=xt();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&Do(t,i[1]))return i[0];if(i=e(),Wa){zn(!0);try{e()}finally{zn(!1)}}return n.memoizedState=[i,t],i}function Yo(e,t,n){return n===void 0||(Qn&1073741824)!==0&&(Pe&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=gh(),qe.lanes|=e,xa|=e,n)}function gf(e,t,n,i){return an(n,t)?n:Bi.current!==null?(e=Yo(e,n,i),an(e,t)||(Et=!0),e):(Qn&42)===0||(Qn&1073741824)!==0&&(Pe&261930)===0?(Et=!0,e.memoizedState=n):(e=gh(),qe.lanes|=e,xa|=e,t)}function pf(e,t,n,i,c){var f=k.p;k.p=f!==0&&8>f?f:8;var y=C.T,j={};C.T=j,Qo(e,!1,t,n);try{var R=c(),K=C.S;if(K!==null&&K(j,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var ie=Zm(R,i);zr(e,t,ie,un(e))}else zr(e,t,i,un(e))}catch(ce){zr(e,t,{then:function(){},status:"rejected",reason:ce},un())}finally{k.p=f,y!==null&&j.types!==null&&(y.types=j.types),C.T=y}}function iy(){}function Jo(e,t,n,i){if(e.tag!==5)throw Error(l(476));var c=mf(e).queue;pf(e,c,t,ee,n===null?iy:function(){return yf(e),n(i)})}function mf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:ee},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function yf(e){var t=mf(e);t.next===null&&(t=e.alternate.memoizedState),zr(e,t.next.queue,{},un())}function Fo(){return Dt(Xr)}function vf(){return xt().memoizedState}function bf(){return xt().memoizedState}function ry(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=un();e=pa(n);var i=ma(t,e,n);i!==null&&(tn(i,t,n),Nr(i,t,n)),t={cache:wo()},e.payload=t;return}t=t.return}}function sy(e,t,n){var i=un();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Gs(e)?xf(t,n):(n=ho(e,t,n,i),n!==null&&(tn(n,e,i),jf(n,t,i)))}function _f(e,t,n){var i=un();zr(e,t,n,i)}function zr(e,t,n,i){var c={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gs(e))xf(t,c);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,j=f(y,n);if(c.hasEagerState=!0,c.eagerState=j,an(j,y))return Es(e,t,c,0),rt===null&&ws(),!1}catch{}finally{}if(n=ho(e,t,c,i),n!==null)return tn(n,e,i),jf(n,t,i),!0}return!1}function Qo(e,t,n,i){if(i={lane:2,revertLane:Ac(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Gs(e)){if(t)throw Error(l(479))}else t=ho(e,n,i,2),t!==null&&tn(t,e,2)}function Gs(e){var t=e.alternate;return e===qe||t!==null&&t===qe}function xf(e,t){Mi=Ls=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function jf(e,t,n){if((n&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,gs(e,n)}}var Dr={readContext:Dt,use:Hs,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useLayoutEffect:mt,useInsertionEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useSyncExternalStore:mt,useId:mt,useHostTransitionStatus:mt,useFormState:mt,useActionState:mt,useOptimistic:mt,useMemoCache:mt,useCacheRefresh:mt};Dr.useEffectEvent=mt;var Sf={readContext:Dt,use:Hs,useCallback:function(e,t){return Yt().memoizedState=[e,t===void 0?null:t],e},useContext:Dt,useEffect:sf,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,$s(4194308,4,uf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return $s(4194308,4,e,t)},useInsertionEffect:function(e,t){$s(4,2,e,t)},useMemo:function(e,t){var n=Yt();t=t===void 0?null:t;var i=e();if(Wa){zn(!0);try{e()}finally{zn(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Yt();if(n!==void 0){var c=n(t);if(Wa){zn(!0);try{n(t)}finally{zn(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=sy.bind(null,qe,e),[i.memoizedState,e]},useRef:function(e){var t=Yt();return e={current:e},t.memoizedState=e},useState:function(e){e=$o(e);var t=e.queue,n=_f.bind(null,qe,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ko,useDeferredValue:function(e,t){var n=Yt();return Yo(n,e,t)},useTransition:function(){var e=$o(!1);return e=pf.bind(null,qe,e.queue,!0,!1),Yt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=qe,c=Yt();if(Ye){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),rt===null)throw Error(l(349));(Pe&127)!==0||$d(i,t,n)}c.memoizedState=n;var f={value:n,getSnapshot:t};return c.queue=f,sf(Gd.bind(null,i,f,e),[e]),i.flags|=2048,qi(9,{destroy:void 0},Pd.bind(null,i,f,n,t),null),n},useId:function(){var e=Yt(),t=rt.identifierPrefix;if(Ye){var n=qn,i=Ln;n=(i&~(1<<32-Pt(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=qs++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Wm++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Fo,useFormState:ef,useActionState:ef,useOptimistic:function(e){var t=Yt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Qo.bind(null,qe,!0,n),n.dispatch=t,[e,t]},useMemoCache:Io,useCacheRefresh:function(){return Yt().memoizedState=ry.bind(null,qe)},useEffectEvent:function(e){var t=Yt(),n={impl:e};return t.memoizedState=n,function(){if((Qe&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},Xo={readContext:Dt,use:Hs,useCallback:ff,useContext:Dt,useEffect:Go,useImperativeHandle:df,useInsertionEffect:of,useLayoutEffect:cf,useMemo:hf,useReducer:Vs,useRef:rf,useState:function(){return Vs(Xn)},useDebugValue:Ko,useDeferredValue:function(e,t){var n=xt();return gf(n,nt.memoizedState,e,t)},useTransition:function(){var e=Vs(Xn)[0],t=xt().memoizedState;return[typeof e=="boolean"?e:Ur(e),t]},useSyncExternalStore:Vd,useId:vf,useHostTransitionStatus:Fo,useFormState:tf,useActionState:tf,useOptimistic:function(e,t){var n=xt();return Jd(n,nt,e,t)},useMemoCache:Io,useCacheRefresh:bf};Xo.useEffectEvent=lf;var wf={readContext:Dt,use:Hs,useCallback:ff,useContext:Dt,useEffect:Go,useImperativeHandle:df,useInsertionEffect:of,useLayoutEffect:cf,useMemo:hf,useReducer:Vo,useRef:rf,useState:function(){return Vo(Xn)},useDebugValue:Ko,useDeferredValue:function(e,t){var n=xt();return nt===null?Yo(n,e,t):gf(n,nt.memoizedState,e,t)},useTransition:function(){var e=Vo(Xn)[0],t=xt().memoizedState;return[typeof e=="boolean"?e:Ur(e),t]},useSyncExternalStore:Vd,useId:vf,useHostTransitionStatus:Fo,useFormState:af,useActionState:af,useOptimistic:function(e,t){var n=xt();return nt!==null?Jd(n,nt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Io,useCacheRefresh:bf};wf.useEffectEvent=lf;function Zo(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:_({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wo={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=un(),c=pa(i);c.payload=t,n!=null&&(c.callback=n),t=ma(e,c,i),t!==null&&(tn(t,e,i),Nr(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=un(),c=pa(i);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=ma(e,c,i),t!==null&&(tn(t,e,i),Nr(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=un(),i=pa(n);i.tag=2,t!=null&&(i.callback=t),t=ma(e,i,n),t!==null&&(tn(t,e,n),Nr(t,e,n))}};function Ef(e,t,n,i,c,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,f,y):t.prototype&&t.prototype.isPureReactComponent?!xr(n,i)||!xr(c,f):!0}function Cf(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Wo.enqueueReplaceState(t,t.state,null)}function ei(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=_({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Tf(e){Ss(e)}function Af(e){console.error(e)}function Nf(e){Ss(e)}function Ks(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Of(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function ec(e,t,n){return n=pa(n),n.tag=3,n.payload={element:null},n.callback=function(){Ks(e,t)},n}function Rf(e){return e=pa(e),e.tag=3,e}function kf(e,t,n,i){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var f=i.value;e.payload=function(){return c(f)},e.callback=function(){Of(t,n,i)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Of(t,n,i),typeof c!="function"&&(ja===null?ja=new Set([this]):ja.add(this));var j=i.stack;this.componentDidCatch(i.value,{componentStack:j!==null?j:""})})}function ly(e,t,n,i,c){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Ri(t,n,c,!0),n=sn.current,n!==null){switch(n.tag){case 31:case 13:return xn===null?il():n.alternate===null&&yt===0&&(yt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,i===Us?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),Ec(e,i,c)),!1;case 22:return n.flags|=65536,i===Us?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),Ec(e,i,c)),!1}throw Error(l(435,n.tag))}return Ec(e,i,c),il(),!1}if(Ye)return t=sn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==bo&&(e=Error(l(422),{cause:i}),wr(yn(e,n)))):(i!==bo&&(t=Error(l(423),{cause:i}),wr(yn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=yn(i,n),c=ec(e.stateNode,i,c),Oo(e,c),yt!==4&&(yt=2)),!1;var f=Error(l(520),{cause:i});if(f=yn(f,n),$r===null?$r=[f]:$r.push(f),yt!==4&&(yt=2),t===null)return!0;i=yn(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=ec(n.stateNode,i,e),Oo(n,e),!1;case 1:if(t=n.type,f=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(ja===null||!ja.has(f))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Rf(c),kf(c,e,n,i),Oo(n,c),!1}n=n.return}while(n!==null);return!1}var tc=Error(l(461)),Et=!1;function Bt(e,t,n,i){t.child=e===null?Dd(t,null,n,i):Za(t,e.child,n,i)}function Uf(e,t,n,i,c){n=n.render;var f=t.ref;if("ref"in i){var y={};for(var j in i)j!=="ref"&&(y[j]=i[j])}else y=i;return Ja(t),i=Bo(e,t,n,y,f,c),j=Mo(),e!==null&&!Et?(Lo(e,t,c),Zn(e,t,c)):(Ye&&j&&yo(t),t.flags|=1,Bt(e,t,i,c),t.child)}function zf(e,t,n,i,c){if(e===null){var f=n.type;return typeof f=="function"&&!go(f)&&f.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=f,Df(e,t,f,i,c)):(e=Ts(n.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!cc(e,c)){var y=f.memoizedProps;if(n=n.compare,n=n!==null?n:xr,n(y,i)&&e.ref===t.ref)return Zn(e,t,c)}return t.flags|=1,e=Kn(f,i),e.ref=t.ref,e.return=t,t.child=e}function Df(e,t,n,i,c){if(e!==null){var f=e.memoizedProps;if(xr(f,i)&&e.ref===t.ref)if(Et=!1,t.pendingProps=i=f,cc(e,c))(e.flags&131072)!==0&&(Et=!0);else return t.lanes=e.lanes,Zn(e,t,c)}return nc(e,t,n,i,c)}function Bf(e,t,n,i){var c=i.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|n:n,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~f}else i=0,t.child=null;return Mf(e,t,f,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Rs(t,f!==null?f.cachePool:null),f!==null?Ld(t,f):ko(),qd(t);else return i=t.lanes=536870912,Mf(e,t,f!==null?f.baseLanes|n:n,n,i)}else f!==null?(Rs(t,f.cachePool),Ld(t,f),va(),t.memoizedState=null):(e!==null&&Rs(t,null),ko(),va());return Bt(e,t,c,n),t.child}function Br(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Mf(e,t,n,i,c){var f=Co();return f=f===null?null:{parent:St._currentValue,pool:f},t.memoizedState={baseLanes:n,cachePool:f},e!==null&&Rs(t,null),ko(),qd(t),e!==null&&Ri(e,t,i,!0),t.childLanes=c,null}function Ys(e,t){return t=Fs({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Lf(e,t,n){return Za(t,e.child,null,n),e=Ys(t,t.pendingProps),e.flags|=2,ln(t),t.memoizedState=null,e}function oy(e,t,n){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ye){if(i.mode==="hidden")return e=Ys(t,i),t.lanes=536870912,Br(null,e);if(zo(t),(e=ct)?(e=Qh(e,_n),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ua!==null?{id:Ln,overflow:qn}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,zt=t,ct=null)):e=null,e===null)throw fa(t);return t.lanes=536870912,null}return Ys(t,i)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if(zo(t),c)if(t.flags&256)t.flags&=-257,t=Lf(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(Et||Ri(e,t,n,!1),c=(n&e.childLanes)!==0,Et||c){if(i=rt,i!==null&&(y=ps(i,n),y!==0&&y!==f.retryLane))throw f.retryLane=y,Pa(e,y),tn(i,e,y),tc;il(),t=Lf(e,t,n)}else e=f.treeContext,ct=jn(y.nextSibling),zt=t,Ye=!0,da=null,_n=!1,e!==null&&Sd(t,e),t=Ys(t,i),t.flags|=4096;return t}return e=Kn(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Js(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function nc(e,t,n,i,c){return Ja(t),n=Bo(e,t,n,i,void 0,c),i=Mo(),e!==null&&!Et?(Lo(e,t,c),Zn(e,t,c)):(Ye&&i&&yo(t),t.flags|=1,Bt(e,t,n,c),t.child)}function qf(e,t,n,i,c,f){return Ja(t),t.updateQueue=null,n=Hd(t,i,n,c),Id(e),i=Mo(),e!==null&&!Et?(Lo(e,t,f),Zn(e,t,f)):(Ye&&i&&yo(t),t.flags|=1,Bt(e,t,n,f),t.child)}function If(e,t,n,i,c){if(Ja(t),t.stateNode===null){var f=Ti,y=n.contextType;typeof y=="object"&&y!==null&&(f=Dt(y)),f=new n(i,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=Wo,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=i,f.state=t.memoizedState,f.refs={},Ao(t),y=n.contextType,f.context=typeof y=="object"&&y!==null?Dt(y):Ti,f.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(Zo(t,n,y,i),f.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&Wo.enqueueReplaceState(f,f.state,null),Rr(t,i,f,c),Or(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){f=t.stateNode;var j=t.memoizedProps,R=ei(n,j);f.props=R;var K=f.context,ie=n.contextType;y=Ti,typeof ie=="object"&&ie!==null&&(y=Dt(ie));var ce=n.getDerivedStateFromProps;ie=typeof ce=="function"||typeof f.getSnapshotBeforeUpdate=="function",j=t.pendingProps!==j,ie||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(j||K!==y)&&Cf(t,f,i,y),ga=!1;var J=t.memoizedState;f.state=J,Rr(t,i,f,c),Or(),K=t.memoizedState,j||J!==K||ga?(typeof ce=="function"&&(Zo(t,n,ce,i),K=t.memoizedState),(R=ga||Ef(t,n,R,i,J,K,y))?(ie||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=K),f.props=i,f.state=K,f.context=y,i=R):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{f=t.stateNode,No(e,t),y=t.memoizedProps,ie=ei(n,y),f.props=ie,ce=t.pendingProps,J=f.context,K=n.contextType,R=Ti,typeof K=="object"&&K!==null&&(R=Dt(K)),j=n.getDerivedStateFromProps,(K=typeof j=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==ce||J!==R)&&Cf(t,f,i,R),ga=!1,J=t.memoizedState,f.state=J,Rr(t,i,f,c),Or();var W=t.memoizedState;y!==ce||J!==W||ga||e!==null&&e.dependencies!==null&&Ns(e.dependencies)?(typeof j=="function"&&(Zo(t,n,j,i),W=t.memoizedState),(ie=ga||Ef(t,n,ie,i,J,W,R)||e!==null&&e.dependencies!==null&&Ns(e.dependencies))?(K||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(i,W,R),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(i,W,R)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=W),f.props=i,f.state=W,f.context=R,i=ie):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),i=!1)}return f=i,Js(e,t),i=(t.flags&128)!==0,f||i?(f=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&i?(t.child=Za(t,e.child,null,c),t.child=Za(t,null,n,c)):Bt(e,t,n,c),t.memoizedState=f.state,e=t.child):e=Zn(e,t,c),e}function Hf(e,t,n,i){return Ka(),t.flags|=256,Bt(e,t,n,i),t.child}var ac={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ic(e){return{baseLanes:e,cachePool:Nd()}}function rc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=cn),e}function Vf(e,t,n){var i=t.pendingProps,c=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(_t.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ye){if(c?ya(t):va(),(e=ct)?(e=Qh(e,_n),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ua!==null?{id:Ln,overflow:qn}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,zt=t,ct=null)):e=null,e===null)throw fa(t);return Hc(e)?t.lanes=32:t.lanes=536870912,null}var j=i.children;return i=i.fallback,c?(va(),c=t.mode,j=Fs({mode:"hidden",children:j},c),i=Ga(i,c,n,null),j.return=t,i.return=t,j.sibling=i,t.child=j,i=t.child,i.memoizedState=ic(n),i.childLanes=rc(e,y,n),t.memoizedState=ac,Br(null,i)):(ya(t),sc(t,j))}var R=e.memoizedState;if(R!==null&&(j=R.dehydrated,j!==null)){if(f)t.flags&256?(ya(t),t.flags&=-257,t=lc(e,t,n)):t.memoizedState!==null?(va(),t.child=e.child,t.flags|=128,t=null):(va(),j=i.fallback,c=t.mode,i=Fs({mode:"visible",children:i.children},c),j=Ga(j,c,n,null),j.flags|=2,i.return=t,j.return=t,i.sibling=j,t.child=i,Za(t,e.child,null,n),i=t.child,i.memoizedState=ic(n),i.childLanes=rc(e,y,n),t.memoizedState=ac,t=Br(null,i));else if(ya(t),Hc(j)){if(y=j.nextSibling&&j.nextSibling.dataset,y)var K=y.dgst;y=K,i=Error(l(419)),i.stack="",i.digest=y,wr({value:i,source:null,stack:null}),t=lc(e,t,n)}else if(Et||Ri(e,t,n,!1),y=(n&e.childLanes)!==0,Et||y){if(y=rt,y!==null&&(i=ps(y,n),i!==0&&i!==R.retryLane))throw R.retryLane=i,Pa(e,i),tn(y,e,i),tc;Ic(j)||il(),t=lc(e,t,n)}else Ic(j)?(t.flags|=192,t.child=e.child,t=null):(e=R.treeContext,ct=jn(j.nextSibling),zt=t,Ye=!0,da=null,_n=!1,e!==null&&Sd(t,e),t=sc(t,i.children),t.flags|=4096);return t}return c?(va(),j=i.fallback,c=t.mode,R=e.child,K=R.sibling,i=Kn(R,{mode:"hidden",children:i.children}),i.subtreeFlags=R.subtreeFlags&65011712,K!==null?j=Kn(K,j):(j=Ga(j,c,n,null),j.flags|=2),j.return=t,i.return=t,i.sibling=j,t.child=i,Br(null,i),i=t.child,j=e.child.memoizedState,j===null?j=ic(n):(c=j.cachePool,c!==null?(R=St._currentValue,c=c.parent!==R?{parent:R,pool:R}:c):c=Nd(),j={baseLanes:j.baseLanes|n,cachePool:c}),i.memoizedState=j,i.childLanes=rc(e,y,n),t.memoizedState=ac,Br(e.child,i)):(ya(t),n=e.child,e=n.sibling,n=Kn(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function sc(e,t){return t=Fs({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Fs(e,t){return e=rn(22,e,null,t),e.lanes=0,e}function lc(e,t,n){return Za(t,e.child,null,n),e=sc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $f(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),jo(e.return,t,n)}function oc(e,t,n,i,c,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:c,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=n,y.tailMode=c,y.treeForkCount=f)}function Pf(e,t,n){var i=t.pendingProps,c=i.revealOrder,f=i.tail;i=i.children;var y=_t.current,j=(y&2)!==0;if(j?(y=y&1|2,t.flags|=128):y&=1,$(_t,y),Bt(e,t,i,n),i=Ye?Sr:0,!j&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$f(e,n,t);else if(e.tag===19)$f(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Ms(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),oc(t,!1,c,n,f,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Ms(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}oc(t,!0,n,null,f,i);break;case"together":oc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function Zn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),xa|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Ri(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Kn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Kn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Ns(e)))}function cy(e,t,n){switch(t.tag){case 3:se(t,t.stateNode.containerInfo),ha(t,St,e.memoizedState.cache),Ka();break;case 27:case 5:Oe(t);break;case 4:se(t,t.stateNode.containerInfo);break;case 10:ha(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,zo(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(ya(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Vf(e,t,n):(ya(t),e=Zn(e,t,n),e!==null?e.sibling:null);ya(t);break;case 19:var c=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Ri(e,t,n,!1),i=(n&t.childLanes)!==0),c){if(i)return Pf(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),$(_t,_t.current),i)break;return null;case 22:return t.lanes=0,Bf(e,t,n,t.pendingProps);case 24:ha(t,St,e.memoizedState.cache)}return Zn(e,t,n)}function Gf(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Et=!0;else{if(!cc(e,n)&&(t.flags&128)===0)return Et=!1,cy(e,t,n);Et=(e.flags&131072)!==0}else Et=!1,Ye&&(t.flags&1048576)!==0&&jd(t,Sr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=Qa(t.elementType),t.type=e,typeof e=="function")go(e)?(i=ei(e,i),t.tag=1,t=If(null,t,e,i,n)):(t.tag=0,t=nc(null,t,e,i,n));else{if(e!=null){var c=e.$$typeof;if(c===Y){t.tag=11,t=Uf(null,t,e,i,n);break e}else if(c===D){t.tag=14,t=zf(null,t,e,i,n);break e}}throw t=X(e)||e,Error(l(306,t,""))}}return t;case 0:return nc(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,c=ei(i,t.pendingProps),If(e,t,i,c,n);case 3:e:{if(se(t,t.stateNode.containerInfo),e===null)throw Error(l(387));i=t.pendingProps;var f=t.memoizedState;c=f.element,No(e,t),Rr(t,i,null,n);var y=t.memoizedState;if(i=y.cache,ha(t,St,i),i!==f.cache&&So(t,[St],n,!0),Or(),i=y.element,f.isDehydrated)if(f={element:i,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Hf(e,t,i,n);break e}else if(i!==c){c=yn(Error(l(424)),t),wr(c),t=Hf(e,t,i,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ct=jn(e.firstChild),zt=t,Ye=!0,da=null,_n=!0,n=Dd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Ka(),i===c){t=Zn(e,t,n);break e}Bt(e,t,i,n)}t=t.child}return t;case 26:return Js(e,t),e===null?(n=ng(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ye||(n=t.type,e=t.pendingProps,i=dl(re.current).createElement(n),i[jt]=t,i[Ut]=e,Mt(i,n,e),Z(i),t.stateNode=i):t.memoizedState=ng(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Oe(t),e===null&&Ye&&(i=t.stateNode=Wh(t.type,t.pendingProps,re.current),zt=t,_n=!0,c=ct,Ca(t.type)?(Vc=c,ct=jn(i.firstChild)):ct=c),Bt(e,t,t.pendingProps.children,n),Js(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ye&&((c=i=ct)&&(i=qy(i,t.type,t.pendingProps,_n),i!==null?(t.stateNode=i,zt=t,ct=jn(i.firstChild),_n=!1,c=!0):c=!1),c||fa(t)),Oe(t),c=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,i=f.children,Mc(c,f)?i=null:y!==null&&Mc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Bo(e,t,ey,null,null,n),Xr._currentValue=c),Js(e,t),Bt(e,t,i,n),t.child;case 6:return e===null&&Ye&&((e=n=ct)&&(n=Iy(n,t.pendingProps,_n),n!==null?(t.stateNode=n,zt=t,ct=null,e=!0):e=!1),e||fa(t)),null;case 13:return Vf(e,t,n);case 4:return se(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Za(t,null,i,n):Bt(e,t,i,n),t.child;case 11:return Uf(e,t,t.type,t.pendingProps,n);case 7:return Bt(e,t,t.pendingProps,n),t.child;case 8:return Bt(e,t,t.pendingProps.children,n),t.child;case 12:return Bt(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,ha(t,t.type,i.value),Bt(e,t,i.children,n),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,Ja(t),c=Dt(c),i=i(c),t.flags|=1,Bt(e,t,i,n),t.child;case 14:return zf(e,t,t.type,t.pendingProps,n);case 15:return Df(e,t,t.type,t.pendingProps,n);case 19:return Pf(e,t,n);case 31:return oy(e,t,n);case 22:return Bf(e,t,n,t.pendingProps);case 24:return Ja(t),i=Dt(St),e===null?(c=Co(),c===null&&(c=rt,f=wo(),c.pooledCache=f,f.refCount++,f!==null&&(c.pooledCacheLanes|=n),c=f),t.memoizedState={parent:i,cache:c},Ao(t),ha(t,St,c)):((e.lanes&n)!==0&&(No(e,t),Rr(t,null,null,n),Or()),c=e.memoizedState,f=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),ha(t,St,i)):(i=f.cache,ha(t,St,i),i!==c.cache&&So(t,[St],n,!0))),Bt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Wn(e){e.flags|=4}function uc(e,t,n,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(vh())e.flags|=8192;else throw Xa=Us,To}else e.flags&=-16777217}function Kf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!lg(t))if(vh())e.flags|=8192;else throw Xa=Us,To}function Qs(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?pi():536870912,e.lanes|=t,$i|=t)}function Mr(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ut(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function uy(e,t,n){var i=t.pendingProps;switch(vo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(t),null;case 1:return ut(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Fn(St),_e(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Oi(t)?Wn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,_o())),ut(t),null;case 26:var c=t.type,f=t.memoizedState;return e===null?(Wn(t),f!==null?(ut(t),Kf(t,f)):(ut(t),uc(t,c,null,i,n))):f?f!==e.memoizedState?(Wn(t),ut(t),Kf(t,f)):(ut(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&Wn(t),ut(t),uc(t,c,e,i,n)),null;case 27:if(De(t),n=re.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return ut(t),null}e=F.current,Oi(t)?wd(t):(e=Wh(c,i,n),t.stateNode=e,Wn(t))}return ut(t),null;case 5:if(De(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return ut(t),null}if(f=F.current,Oi(t))wd(t);else{var y=dl(re.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?f.multiple=!0:i.size&&(f.size=i.size);break;default:f=typeof i.is=="string"?y.createElement(c,{is:i.is}):y.createElement(c)}}f[jt]=t,f[Ut]=i;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(Mt(f,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Wn(t)}}return ut(t),uc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(l(166));if(e=re.current,Oi(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,c=zt,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[jt]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Vh(e.nodeValue,n)),e||fa(t,!0)}else e=dl(e).createTextNode(i),e[jt]=t,t.stateNode=e}return ut(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(i=Oi(t),n!==null){if(e===null){if(!i)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[jt]=t}else Ka(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ut(t),e=!1}else n=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(ln(t),t):(ln(t),null);if((t.flags&128)!==0)throw Error(l(558))}return ut(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Oi(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[jt]=t}else Ka(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ut(t),c=!1}else c=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(ln(t),t):(ln(t),null)}return ln(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,e=e!==null&&e.memoizedState!==null,n&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Qs(t,t.updateQueue),ut(t),null);case 4:return _e(),e===null&&kc(t.stateNode.containerInfo),ut(t),null;case 10:return Fn(t.type),ut(t),null;case 19:if(z(_t),i=t.memoizedState,i===null)return ut(t),null;if(c=(t.flags&128)!==0,f=i.rendering,f===null)if(c)Mr(i,!1);else{if(yt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=Ms(e),f!==null){for(t.flags|=128,Mr(i,!1),e=f.updateQueue,t.updateQueue=e,Qs(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)bd(n,e),n=n.sibling;return $(_t,_t.current&1|2),Ye&&Yn(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Vt()>tl&&(t.flags|=128,c=!0,Mr(i,!1),t.lanes=4194304)}else{if(!c)if(e=Ms(f),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,Qs(t,e),Mr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!f.alternate&&!Ye)return ut(t),null}else 2*Vt()-i.renderingStartTime>tl&&n!==536870912&&(t.flags|=128,c=!0,Mr(i,!1),t.lanes=4194304);i.isBackwards?(f.sibling=t.child,t.child=f):(e=i.last,e!==null?e.sibling=f:t.child=f,i.last=f)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Vt(),e.sibling=null,n=_t.current,$(_t,c?n&1|2:n&1),Ye&&Yn(t,i.treeForkCount),e):(ut(t),null);case 22:case 23:return ln(t),Uo(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(ut(t),t.subtreeFlags&6&&(t.flags|=8192)):ut(t),n=t.updateQueue,n!==null&&Qs(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&z(Fa),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Fn(St),ut(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function dy(e,t){switch(vo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fn(St),_e(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return De(t),null;case 31:if(t.memoizedState!==null){if(ln(t),t.alternate===null)throw Error(l(340));Ka()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(ln(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Ka()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return z(_t),null;case 4:return _e(),null;case 10:return Fn(t.type),null;case 22:case 23:return ln(t),Uo(),e!==null&&z(Fa),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Fn(St),null;case 25:return null;default:return null}}function Yf(e,t){switch(vo(t),t.tag){case 3:Fn(St),_e();break;case 26:case 27:case 5:De(t);break;case 4:_e();break;case 31:t.memoizedState!==null&&ln(t);break;case 13:ln(t);break;case 19:z(_t);break;case 10:Fn(t.type);break;case 22:case 23:ln(t),Uo(),e!==null&&z(Fa);break;case 24:Fn(St)}}function Lr(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var c=i.next;n=c;do{if((n.tag&e)===e){i=void 0;var f=n.create,y=n.inst;i=f(),y.destroy=i}n=n.next}while(n!==c)}}catch(j){We(t,t.return,j)}}function ba(e,t,n){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var f=c.next;i=f;do{if((i.tag&e)===e){var y=i.inst,j=y.destroy;if(j!==void 0){y.destroy=void 0,c=t;var R=n,K=j;try{K()}catch(ie){We(c,R,ie)}}}i=i.next}while(i!==f)}}catch(ie){We(t,t.return,ie)}}function Jf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Md(t,n)}catch(i){We(e,e.return,i)}}}function Ff(e,t,n){n.props=ei(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){We(e,t,i)}}function qr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof n=="function"?e.refCleanup=n(i):n.current=i}}catch(c){We(e,t,c)}}function In(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(c){We(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){We(e,t,c)}else n.current=null}function Qf(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(c){We(e,e.return,c)}}function dc(e,t,n){try{var i=e.stateNode;Uy(i,e.type,n,t),i[Ut]=t}catch(c){We(e,e.return,c)}}function Xf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ca(e.type)||e.tag===4}function fc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Xf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ca(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hc(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pn));else if(i!==4&&(i===27&&Ca(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(hc(e,t,n),e=e.sibling;e!==null;)hc(e,t,n),e=e.sibling}function Xs(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(i===27&&Ca(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Xs(e,t,n),e=e.sibling;e!==null;)Xs(e,t,n),e=e.sibling}function Zf(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Mt(t,i,n),t[jt]=e,t[Ut]=n}catch(f){We(e,e.return,f)}}var ea=!1,Ct=!1,gc=!1,Wf=typeof WeakSet=="function"?WeakSet:Set,kt=null;function fy(e,t){if(e=e.containerInfo,Dc=vl,e=ud(e),so(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var c=i.anchorOffset,f=i.focusNode;i=i.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var y=0,j=-1,R=-1,K=0,ie=0,ce=e,J=null;t:for(;;){for(var W;ce!==n||c!==0&&ce.nodeType!==3||(j=y+c),ce!==f||i!==0&&ce.nodeType!==3||(R=y+i),ce.nodeType===3&&(y+=ce.nodeValue.length),(W=ce.firstChild)!==null;)J=ce,ce=W;for(;;){if(ce===e)break t;if(J===n&&++K===c&&(j=y),J===f&&++ie===i&&(R=y),(W=ce.nextSibling)!==null)break;ce=J,J=ce.parentNode}ce=W}n=j===-1||R===-1?null:{start:j,end:R}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bc={focusedElem:e,selectionRange:n},vl=!1,kt=t;kt!==null;)if(t=kt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,kt=e;else for(;kt!==null;){switch(t=kt,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,n=t,c=f.memoizedProps,f=f.memoizedState,i=n.stateNode;try{var Se=ei(n.type,c);e=i.getSnapshotBeforeUpdate(Se,f),i.__reactInternalSnapshotBeforeUpdate=e}catch(ke){We(n,n.return,ke)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)qc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,kt=e;break}kt=t.return}}function eh(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:na(e,n),i&4&&Lr(5,n);break;case 1:if(na(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){We(n,n.return,y)}else{var c=ei(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){We(n,n.return,y)}}i&64&&Jf(n),i&512&&qr(n,n.return);break;case 3:if(na(e,n),i&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Md(e,t)}catch(y){We(n,n.return,y)}}break;case 27:t===null&&i&4&&Zf(n);case 26:case 5:na(e,n),t===null&&i&4&&Qf(n),i&512&&qr(n,n.return);break;case 12:na(e,n);break;case 31:na(e,n),i&4&&ah(e,n);break;case 13:na(e,n),i&4&&ih(e,n),i&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=xy.bind(null,n),Hy(e,n))));break;case 22:if(i=n.memoizedState!==null||ea,!i){t=t!==null&&t.memoizedState!==null||Ct,c=ea;var f=Ct;ea=i,(Ct=t)&&!f?aa(e,n,(n.subtreeFlags&8772)!==0):na(e,n),ea=c,Ct=f}break;case 30:break;default:na(e,n)}}function th(e){var t=e.alternate;t!==null&&(e.alternate=null,th(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&oe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ht=null,Xt=!1;function ta(e,t,n){for(n=n.child;n!==null;)nh(e,t,n),n=n.sibling}function nh(e,t,n){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(Un,n)}catch{}switch(n.tag){case 26:Ct||In(n,t),ta(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Ct||In(n,t);var i=ht,c=Xt;Ca(n.type)&&(ht=n.stateNode,Xt=!1),ta(e,t,n),Jr(n.stateNode),ht=i,Xt=c;break;case 5:Ct||In(n,t);case 6:if(i=ht,c=Xt,ht=null,ta(e,t,n),ht=i,Xt=c,ht!==null)if(Xt)try{(ht.nodeType===9?ht.body:ht.nodeName==="HTML"?ht.ownerDocument.body:ht).removeChild(n.stateNode)}catch(f){We(n,t,f)}else try{ht.removeChild(n.stateNode)}catch(f){We(n,t,f)}break;case 18:ht!==null&&(Xt?(e=ht,Jh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Xi(e)):Jh(ht,n.stateNode));break;case 4:i=ht,c=Xt,ht=n.stateNode.containerInfo,Xt=!0,ta(e,t,n),ht=i,Xt=c;break;case 0:case 11:case 14:case 15:ba(2,n,t),Ct||ba(4,n,t),ta(e,t,n);break;case 1:Ct||(In(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Ff(n,t,i)),ta(e,t,n);break;case 21:ta(e,t,n);break;case 22:Ct=(i=Ct)||n.memoizedState!==null,ta(e,t,n),Ct=i;break;default:ta(e,t,n)}}function ah(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Xi(e)}catch(n){We(t,t.return,n)}}}function ih(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Xi(e)}catch(n){We(t,t.return,n)}}function hy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Wf),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Wf),t;default:throw Error(l(435,e.tag))}}function Zs(e,t){var n=hy(e);t.forEach(function(i){if(!n.has(i)){n.add(i);var c=jy.bind(null,e,i);i.then(c,c)}})}function Zt(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var c=n[i],f=e,y=t,j=y;e:for(;j!==null;){switch(j.tag){case 27:if(Ca(j.type)){ht=j.stateNode,Xt=!1;break e}break;case 5:ht=j.stateNode,Xt=!1;break e;case 3:case 4:ht=j.stateNode.containerInfo,Xt=!0;break e}j=j.return}if(ht===null)throw Error(l(160));nh(f,y,c),ht=null,Xt=!1,f=c.alternate,f!==null&&(f.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)rh(t,e),t=t.sibling}var An=null;function rh(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Zt(t,e),Wt(e),i&4&&(ba(3,e,e.return),Lr(3,e),ba(5,e,e.return));break;case 1:Zt(t,e),Wt(e),i&512&&(Ct||n===null||In(n,n.return)),i&64&&ea&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var c=An;if(Zt(t,e),Wt(e),i&512&&(Ct||n===null||In(n,n.return)),i&4){var f=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":f=c.getElementsByTagName("title")[0],(!f||f[be]||f[jt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=c.createElement(i),c.head.insertBefore(f,c.querySelector("head > title"))),Mt(f,i,n),f[jt]=e,Z(f),i=f;break e;case"link":var y=rg("link","href",c).get(i+(n.href||""));if(y){for(var j=0;j<y.length;j++)if(f=y[j],f.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&f.getAttribute("rel")===(n.rel==null?null:n.rel)&&f.getAttribute("title")===(n.title==null?null:n.title)&&f.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(j,1);break t}}f=c.createElement(i),Mt(f,i,n),c.head.appendChild(f);break;case"meta":if(y=rg("meta","content",c).get(i+(n.content||""))){for(j=0;j<y.length;j++)if(f=y[j],f.getAttribute("content")===(n.content==null?null:""+n.content)&&f.getAttribute("name")===(n.name==null?null:n.name)&&f.getAttribute("property")===(n.property==null?null:n.property)&&f.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&f.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(j,1);break t}}f=c.createElement(i),Mt(f,i,n),c.head.appendChild(f);break;default:throw Error(l(468,i))}f[jt]=e,Z(f),i=f}e.stateNode=i}else sg(c,e.type,e.stateNode);else e.stateNode=ig(c,i,e.memoizedProps);else f!==i?(f===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):f.count--,i===null?sg(c,e.type,e.stateNode):ig(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&dc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Zt(t,e),Wt(e),i&512&&(Ct||n===null||In(n,n.return)),n!==null&&i&4&&dc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Zt(t,e),Wt(e),i&512&&(Ct||n===null||In(n,n.return)),e.flags&32){c=e.stateNode;try{_i(c,"")}catch(Se){We(e,e.return,Se)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,dc(e,c,n!==null?n.memoizedProps:c)),i&1024&&(gc=!0);break;case 6:if(Zt(t,e),Wt(e),i&4){if(e.stateNode===null)throw Error(l(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(Se){We(e,e.return,Se)}}break;case 3:if(gl=null,c=An,An=fl(t.containerInfo),Zt(t,e),An=c,Wt(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Xi(t.containerInfo)}catch(Se){We(e,e.return,Se)}gc&&(gc=!1,sh(e));break;case 4:i=An,An=fl(e.stateNode.containerInfo),Zt(t,e),Wt(e),An=i;break;case 12:Zt(t,e),Wt(e);break;case 31:Zt(t,e),Wt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 13:Zt(t,e),Wt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(el=Vt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 22:c=e.memoizedState!==null;var R=n!==null&&n.memoizedState!==null,K=ea,ie=Ct;if(ea=K||c,Ct=ie||R,Zt(t,e),Ct=ie,ea=K,Wt(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||R||ea||Ct||ti(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){R=n=t;try{if(f=R.stateNode,c)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{j=R.stateNode;var ce=R.memoizedProps.style,J=ce!=null&&ce.hasOwnProperty("display")?ce.display:null;j.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(Se){We(R,R.return,Se)}}}else if(t.tag===6){if(n===null){R=t;try{R.stateNode.nodeValue=c?"":R.memoizedProps}catch(Se){We(R,R.return,Se)}}}else if(t.tag===18){if(n===null){R=t;try{var W=R.stateNode;c?Fh(W,!0):Fh(R.stateNode,!1)}catch(Se){We(R,R.return,Se)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,Zs(e,n))));break;case 19:Zt(t,e),Wt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 30:break;case 21:break;default:Zt(t,e),Wt(e)}}function Wt(e){var t=e.flags;if(t&2){try{for(var n,i=e.return;i!==null;){if(Xf(i)){n=i;break}i=i.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,f=fc(e);Xs(e,f,c);break;case 5:var y=n.stateNode;n.flags&32&&(_i(y,""),n.flags&=-33);var j=fc(e);Xs(e,j,y);break;case 3:case 4:var R=n.stateNode.containerInfo,K=fc(e);hc(e,K,R);break;default:throw Error(l(161))}}catch(ie){We(e,e.return,ie)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;sh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function na(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)eh(e,t.alternate,t),t=t.sibling}function ti(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ba(4,t,t.return),ti(t);break;case 1:In(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Ff(t,t.return,n),ti(t);break;case 27:Jr(t.stateNode);case 26:case 5:In(t,t.return),ti(t);break;case 22:t.memoizedState===null&&ti(t);break;case 30:ti(t);break;default:ti(t)}e=e.sibling}}function aa(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:aa(c,f,n),Lr(4,f);break;case 1:if(aa(c,f,n),i=f,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(K){We(i,i.return,K)}if(i=f,c=i.updateQueue,c!==null){var j=i.stateNode;try{var R=c.shared.hiddenCallbacks;if(R!==null)for(c.shared.hiddenCallbacks=null,c=0;c<R.length;c++)Bd(R[c],j)}catch(K){We(i,i.return,K)}}n&&y&64&&Jf(f),qr(f,f.return);break;case 27:Zf(f);case 26:case 5:aa(c,f,n),n&&i===null&&y&4&&Qf(f),qr(f,f.return);break;case 12:aa(c,f,n);break;case 31:aa(c,f,n),n&&y&4&&ah(c,f);break;case 13:aa(c,f,n),n&&y&4&&ih(c,f);break;case 22:f.memoizedState===null&&aa(c,f,n),qr(f,f.return);break;case 30:break;default:aa(c,f,n)}t=t.sibling}}function pc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Er(n))}function mc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Er(e))}function Nn(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)lh(e,t,n,i),t=t.sibling}function lh(e,t,n,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Nn(e,t,n,i),c&2048&&Lr(9,t);break;case 1:Nn(e,t,n,i);break;case 3:Nn(e,t,n,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Er(e)));break;case 12:if(c&2048){Nn(e,t,n,i),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,j=f.onPostCommit;typeof j=="function"&&j(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(R){We(t,t.return,R)}}else Nn(e,t,n,i);break;case 31:Nn(e,t,n,i);break;case 13:Nn(e,t,n,i);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?Nn(e,t,n,i):Ir(e,t):f._visibility&2?Nn(e,t,n,i):(f._visibility|=2,Ii(e,t,n,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&pc(y,t);break;case 24:Nn(e,t,n,i),c&2048&&mc(t.alternate,t);break;default:Nn(e,t,n,i)}}function Ii(e,t,n,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,j=n,R=i,K=y.flags;switch(y.tag){case 0:case 11:case 15:Ii(f,y,j,R,c),Lr(8,y);break;case 23:break;case 22:var ie=y.stateNode;y.memoizedState!==null?ie._visibility&2?Ii(f,y,j,R,c):Ir(f,y):(ie._visibility|=2,Ii(f,y,j,R,c)),c&&K&2048&&pc(y.alternate,y);break;case 24:Ii(f,y,j,R,c),c&&K&2048&&mc(y.alternate,y);break;default:Ii(f,y,j,R,c)}t=t.sibling}}function Ir(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,c=i.flags;switch(i.tag){case 22:Ir(n,i),c&2048&&pc(i.alternate,i);break;case 24:Ir(n,i),c&2048&&mc(i.alternate,i);break;default:Ir(n,i)}t=t.sibling}}var Hr=8192;function Hi(e,t,n){if(e.subtreeFlags&Hr)for(e=e.child;e!==null;)oh(e,t,n),e=e.sibling}function oh(e,t,n){switch(e.tag){case 26:Hi(e,t,n),e.flags&Hr&&e.memoizedState!==null&&Wy(n,An,e.memoizedState,e.memoizedProps);break;case 5:Hi(e,t,n);break;case 3:case 4:var i=An;An=fl(e.stateNode.containerInfo),Hi(e,t,n),An=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Hr,Hr=16777216,Hi(e,t,n),Hr=i):Hi(e,t,n));break;default:Hi(e,t,n)}}function ch(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Vr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];kt=i,dh(i,e)}ch(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)uh(e),e=e.sibling}function uh(e){switch(e.tag){case 0:case 11:case 15:Vr(e),e.flags&2048&&ba(9,e,e.return);break;case 3:Vr(e);break;case 12:Vr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Ws(e)):Vr(e);break;default:Vr(e)}}function Ws(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];kt=i,dh(i,e)}ch(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ba(8,t,t.return),Ws(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Ws(t));break;default:Ws(t)}e=e.sibling}}function dh(e,t){for(;kt!==null;){var n=kt;switch(n.tag){case 0:case 11:case 15:ba(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Er(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,kt=i;else e:for(n=e;kt!==null;){i=kt;var c=i.sibling,f=i.return;if(th(i),i===n){kt=null;break e}if(c!==null){c.return=f,kt=c;break e}kt=f}}}var gy={getCacheForType:function(e){var t=Dt(St),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Dt(St).controller.signal}},py=typeof WeakMap=="function"?WeakMap:Map,Qe=0,rt=null,Ve=null,Pe=0,Ze=0,on=null,_a=!1,Vi=!1,yc=!1,ia=0,yt=0,xa=0,ni=0,vc=0,cn=0,$i=0,$r=null,en=null,bc=!1,el=0,fh=0,tl=1/0,nl=null,ja=null,At=0,Sa=null,Pi=null,ra=0,_c=0,xc=null,hh=null,Pr=0,jc=null;function un(){return(Qe&2)!==0&&Pe!==0?Pe&-Pe:C.T!==null?Ac():yi()}function gh(){if(cn===0)if((Pe&536870912)===0||Ye){var e=gi;gi<<=1,(gi&3932160)===0&&(gi=262144),cn=e}else cn=536870912;return e=sn.current,e!==null&&(e.flags|=32),cn}function tn(e,t,n){(e===rt&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)&&(Gi(e,0),wa(e,Pe,cn,!1)),Vn(e,n),((Qe&2)===0||e!==rt)&&(e===rt&&((Qe&2)===0&&(ni|=n),yt===4&&wa(e,Pe,cn,!1)),Hn(e))}function ph(e,t,n){if((Qe&6)!==0)throw Error(l(327));var i=!n&&(t&127)===0&&(t&e.expiredLanes)===0||La(e,t),c=i?vy(e,t):wc(e,t,!0),f=i;do{if(c===0){Vi&&!i&&wa(e,t,0,!1);break}else{if(n=e.current.alternate,f&&!my(n)){c=wc(e,t,!1),f=!1;continue}if(c===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var j=e;c=$r;var R=j.current.memoizedState.isDehydrated;if(R&&(Gi(j,y).flags|=256),y=wc(j,y,!1),y!==2){if(yc&&!R){j.errorRecoveryDisabledLanes|=f,ni|=f,c=4;break e}f=en,en=c,f!==null&&(en===null?en=f:en.push.apply(en,f))}c=y}if(f=!1,c!==2)continue}}if(c===1){Gi(e,0),wa(e,t,0,!0);break}e:{switch(i=e,f=c,f){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:wa(i,t,cn,!_a);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=el+300-Vt(),10<c)){if(wa(i,t,cn,!_a),Ma(i,0,!0)!==0)break e;ra=t,i.timeoutHandle=Kh(mh.bind(null,i,n,en,nl,bc,t,cn,ni,$i,_a,f,"Throttled",-0,0),c);break e}mh(i,n,en,nl,bc,t,cn,ni,$i,_a,f,null,-0,0)}}break}while(!0);Hn(e)}function mh(e,t,n,i,c,f,y,j,R,K,ie,ce,J,W){if(e.timeoutHandle=-1,ce=t.subtreeFlags,ce&8192||(ce&16785408)===16785408){ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pn},oh(t,f,ce);var Se=(f&62914560)===f?el-Vt():(f&4194048)===f?fh-Vt():0;if(Se=ev(ce,Se),Se!==null){ra=f,e.cancelPendingCommit=Se(wh.bind(null,e,t,f,n,i,c,y,j,R,ie,ce,null,J,W)),wa(e,f,y,!K);return}}wh(e,t,f,n,i,c,y,j,R)}function my(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var c=n[i],f=c.getSnapshot;c=c.value;try{if(!an(f(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function wa(e,t,n,i){t&=~vc,t&=~ni,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var f=31-Pt(c),y=1<<f;i[f]=-1,c&=~y}n!==0&&hs(e,n,t)}function al(){return(Qe&6)===0?(Gr(0),!1):!0}function Sc(){if(Ve!==null){if(Ze===0)var e=Ve.return;else e=Ve,Jn=Ya=null,qo(e),Di=null,Tr=0,e=Ve;for(;e!==null;)Yf(e.alternate,e),e=e.return;Ve=null}}function Gi(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,By(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),ra=0,Sc(),rt=e,Ve=n=Kn(e.current,null),Pe=t,Ze=0,on=null,_a=!1,Vi=La(e,t),yc=!1,$i=cn=vc=ni=xa=yt=0,en=$r=null,bc=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-Pt(i),f=1<<c;t|=e[c],i&=~f}return ia=t,ws(),n}function yh(e,t){qe=null,C.H=Dr,t===zi||t===ks?(t=kd(),Ze=3):t===To?(t=kd(),Ze=4):Ze=t===tc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,on=t,Ve===null&&(yt=1,Ks(e,yn(t,e.current)))}function vh(){var e=sn.current;return e===null?!0:(Pe&4194048)===Pe?xn===null:(Pe&62914560)===Pe||(Pe&536870912)!==0?e===xn:!1}function bh(){var e=C.H;return C.H=Dr,e===null?Dr:e}function _h(){var e=C.A;return C.A=gy,e}function il(){yt=4,_a||(Pe&4194048)!==Pe&&sn.current!==null||(Vi=!0),(xa&134217727)===0&&(ni&134217727)===0||rt===null||wa(rt,Pe,cn,!1)}function wc(e,t,n){var i=Qe;Qe|=2;var c=bh(),f=_h();(rt!==e||Pe!==t)&&(nl=null,Gi(e,t)),t=!1;var y=yt;e:do try{if(Ze!==0&&Ve!==null){var j=Ve,R=on;switch(Ze){case 8:Sc(),y=6;break e;case 3:case 2:case 9:case 6:sn.current===null&&(t=!0);var K=Ze;if(Ze=0,on=null,Ki(e,j,R,K),n&&Vi){y=0;break e}break;default:K=Ze,Ze=0,on=null,Ki(e,j,R,K)}}yy(),y=yt;break}catch(ie){yh(e,ie)}while(!0);return t&&e.shellSuspendCounter++,Jn=Ya=null,Qe=i,C.H=c,C.A=f,Ve===null&&(rt=null,Pe=0,ws()),y}function yy(){for(;Ve!==null;)xh(Ve)}function vy(e,t){var n=Qe;Qe|=2;var i=bh(),c=_h();rt!==e||Pe!==t?(nl=null,tl=Vt()+500,Gi(e,t)):Vi=La(e,t);e:do try{if(Ze!==0&&Ve!==null){t=Ve;var f=on;t:switch(Ze){case 1:Ze=0,on=null,Ki(e,t,f,1);break;case 2:case 9:if(Od(f)){Ze=0,on=null,jh(t);break}t=function(){Ze!==2&&Ze!==9||rt!==e||(Ze=7),Hn(e)},f.then(t,t);break e;case 3:Ze=7;break e;case 4:Ze=5;break e;case 7:Od(f)?(Ze=0,on=null,jh(t)):(Ze=0,on=null,Ki(e,t,f,7));break;case 5:var y=null;switch(Ve.tag){case 26:y=Ve.memoizedState;case 5:case 27:var j=Ve;if(y?lg(y):j.stateNode.complete){Ze=0,on=null;var R=j.sibling;if(R!==null)Ve=R;else{var K=j.return;K!==null?(Ve=K,rl(K)):Ve=null}break t}}Ze=0,on=null,Ki(e,t,f,5);break;case 6:Ze=0,on=null,Ki(e,t,f,6);break;case 8:Sc(),yt=6;break e;default:throw Error(l(462))}}by();break}catch(ie){yh(e,ie)}while(!0);return Jn=Ya=null,C.H=i,C.A=c,Qe=n,Ve!==null?0:(rt=null,Pe=0,ws(),yt)}function by(){for(;Ve!==null&&!Da();)xh(Ve)}function xh(e){var t=Gf(e.alternate,e,ia);e.memoizedProps=e.pendingProps,t===null?rl(e):Ve=t}function jh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=qf(n,t,t.pendingProps,t.type,void 0,Pe);break;case 11:t=qf(n,t,t.pendingProps,t.type.render,t.ref,Pe);break;case 5:qo(t);default:Yf(n,t),t=Ve=bd(t,ia),t=Gf(n,t,ia)}e.memoizedProps=e.pendingProps,t===null?rl(e):Ve=t}function Ki(e,t,n,i){Jn=Ya=null,qo(t),Di=null,Tr=0;var c=t.return;try{if(ly(e,c,t,n,Pe)){yt=1,Ks(e,yn(n,e.current)),Ve=null;return}}catch(f){if(c!==null)throw Ve=c,f;yt=1,Ks(e,yn(n,e.current)),Ve=null;return}t.flags&32768?(Ye||i===1?e=!0:Vi||(Pe&536870912)!==0?e=!1:(_a=e=!0,(i===2||i===9||i===3||i===6)&&(i=sn.current,i!==null&&i.tag===13&&(i.flags|=16384))),Sh(t,e)):rl(t)}function rl(e){var t=e;do{if((t.flags&32768)!==0){Sh(t,_a);return}e=t.return;var n=uy(t.alternate,t,ia);if(n!==null){Ve=n;return}if(t=t.sibling,t!==null){Ve=t;return}Ve=t=e}while(t!==null);yt===0&&(yt=5)}function Sh(e,t){do{var n=dy(e.alternate,e);if(n!==null){n.flags&=32767,Ve=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ve=e;return}Ve=e=n}while(e!==null);yt=6,Ve=null}function wh(e,t,n,i,c,f,y,j,R){e.cancelPendingCommit=null;do sl();while(At!==0);if((Qe&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(f=t.lanes|t.childLanes,f|=fo,qa(e,n,f,y,j,R),e===rt&&(Ve=rt=null,Pe=0),Pi=t,Sa=e,ra=n,_c=f,xc=c,hh=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Sy(hi,function(){return Nh(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=C.T,C.T=null,c=k.p,k.p=2,y=Qe,Qe|=4;try{fy(e,t,n)}finally{Qe=y,k.p=c,C.T=i}}At=1,Eh(),Ch(),Th()}}function Eh(){if(At===1){At=0;var e=Sa,t=Pi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=C.T,C.T=null;var i=k.p;k.p=2;var c=Qe;Qe|=4;try{rh(t,e);var f=Bc,y=ud(e.containerInfo),j=f.focusedElem,R=f.selectionRange;if(y!==j&&j&&j.ownerDocument&&cd(j.ownerDocument.documentElement,j)){if(R!==null&&so(j)){var K=R.start,ie=R.end;if(ie===void 0&&(ie=K),"selectionStart"in j)j.selectionStart=K,j.selectionEnd=Math.min(ie,j.value.length);else{var ce=j.ownerDocument||document,J=ce&&ce.defaultView||window;if(J.getSelection){var W=J.getSelection(),Se=j.textContent.length,ke=Math.min(R.start,Se),it=R.end===void 0?ke:Math.min(R.end,Se);!W.extend&&ke>it&&(y=it,it=ke,ke=y);var I=od(j,ke),U=od(j,it);if(I&&U&&(W.rangeCount!==1||W.anchorNode!==I.node||W.anchorOffset!==I.offset||W.focusNode!==U.node||W.focusOffset!==U.offset)){var G=ce.createRange();G.setStart(I.node,I.offset),W.removeAllRanges(),ke>it?(W.addRange(G),W.extend(U.node,U.offset)):(G.setEnd(U.node,U.offset),W.addRange(G))}}}}for(ce=[],W=j;W=W.parentNode;)W.nodeType===1&&ce.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<ce.length;j++){var le=ce[j];le.element.scrollLeft=le.left,le.element.scrollTop=le.top}}vl=!!Dc,Bc=Dc=null}finally{Qe=c,k.p=i,C.T=n}}e.current=t,At=2}}function Ch(){if(At===2){At=0;var e=Sa,t=Pi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=C.T,C.T=null;var i=k.p;k.p=2;var c=Qe;Qe|=4;try{eh(e,t.alternate,t)}finally{Qe=c,k.p=i,C.T=n}}At=3}}function Th(){if(At===4||At===3){At=0,di();var e=Sa,t=Pi,n=ra,i=hh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?At=5:(At=0,Pi=Sa=null,Ah(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(ja=null),fr(n),t=t.stateNode,$t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(Un,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=C.T,c=k.p,k.p=2,C.T=null;try{for(var f=e.onRecoverableError,y=0;y<i.length;y++){var j=i[y];f(j.value,{componentStack:j.stack})}}finally{C.T=t,k.p=c}}(ra&3)!==0&&sl(),Hn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===jc?Pr++:(Pr=0,jc=e):Pr=0,Gr(0)}}function Ah(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Er(t)))}function sl(){return Eh(),Ch(),Th(),Nh()}function Nh(){if(At!==5)return!1;var e=Sa,t=_c;_c=0;var n=fr(ra),i=C.T,c=k.p;try{k.p=32>n?32:n,C.T=null,n=xc,xc=null;var f=Sa,y=ra;if(At=0,Pi=Sa=null,ra=0,(Qe&6)!==0)throw Error(l(331));var j=Qe;if(Qe|=4,uh(f.current),lh(f,f.current,y,n),Qe=j,Gr(0,!1),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(Un,f)}catch{}return!0}finally{k.p=c,C.T=i,Ah(e,t)}}function Oh(e,t,n){t=yn(n,t),t=ec(e.stateNode,t,2),e=ma(e,t,2),e!==null&&(Vn(e,2),Hn(e))}function We(e,t,n){if(e.tag===3)Oh(e,e,n);else for(;t!==null;){if(t.tag===3){Oh(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ja===null||!ja.has(i))){e=yn(n,e),n=Rf(2),i=ma(t,n,2),i!==null&&(kf(n,i,t,e),Vn(i,2),Hn(i));break}}t=t.return}}function Ec(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new py;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(n)||(yc=!0,c.add(n),e=_y.bind(null,e,t,n),t.then(e,e))}function _y(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rt===e&&(Pe&n)===n&&(yt===4||yt===3&&(Pe&62914560)===Pe&&300>Vt()-el?(Qe&2)===0&&Gi(e,0):vc|=n,$i===Pe&&($i=0)),Hn(e)}function Rh(e,t){t===0&&(t=pi()),e=Pa(e,t),e!==null&&(Vn(e,t),Hn(e))}function xy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Rh(e,n)}function jy(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(t),Rh(e,n)}function Sy(e,t){return dt(e,t)}var ll=null,Yi=null,Cc=!1,ol=!1,Tc=!1,Ea=0;function Hn(e){e!==Yi&&e.next===null&&(Yi===null?ll=Yi=e:Yi=Yi.next=e),ol=!0,Cc||(Cc=!0,Ey())}function Gr(e,t){if(!Tc&&ol){Tc=!0;do for(var n=!1,i=ll;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var f=0;else{var y=i.suspendedLanes,j=i.pingedLanes;f=(1<<31-Pt(42|e)+1)-1,f&=c&~(y&~j),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(n=!0,Dh(i,f))}else f=Pe,f=Ma(i,i===rt?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(f&3)===0||La(i,f)||(n=!0,Dh(i,f));i=i.next}while(n);Tc=!1}}function wy(){kh()}function kh(){ol=Cc=!1;var e=0;Ea!==0&&Dy()&&(e=Ea);for(var t=Vt(),n=null,i=ll;i!==null;){var c=i.next,f=Uh(i,t);f===0?(i.next=null,n===null?ll=c:n.next=c,c===null&&(Yi=n)):(n=i,(e!==0||(f&3)!==0)&&(ol=!0)),i=c}At!==0&&At!==5||Gr(e),Ea!==0&&(Ea=0)}function Uh(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Pt(f),j=1<<y,R=c[y];R===-1?((j&n)===0||(j&i)!==0)&&(c[y]=Gl(j,t)):R<=t&&(e.expiredLanes|=j),f&=~j}if(t=rt,n=Pe,n=Ma(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,n===0||e===t&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&et(i),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||La(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&et(i),fr(n)){case 2:case 8:n=fi;break;case 32:n=hi;break;case 268435456:n=ds;break;default:n=hi}return i=zh.bind(null,e),n=dt(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&et(i),e.callbackPriority=2,e.callbackNode=null,2}function zh(e,t){if(At!==0&&At!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(sl()&&e.callbackNode!==n)return null;var i=Pe;return i=Ma(e,e===rt?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(ph(e,i,t),Uh(e,Vt()),e.callbackNode!=null&&e.callbackNode===n?zh.bind(null,e):null)}function Dh(e,t){if(sl())return null;ph(e,t,!0)}function Ey(){My(function(){(Qe&6)!==0?dt(ur,wy):kh()})}function Ac(){if(Ea===0){var e=ki;e===0&&(e=Ba,Ba<<=1,(Ba&261888)===0&&(Ba=256)),Ea=e}return Ea}function Bh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ms(""+e)}function Mh(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Cy(e,t,n,i,c){if(t==="submit"&&n&&n.stateNode===c){var f=Bh((c[Ut]||null).action),y=i.submitter;y&&(t=(t=y[Ut]||null)?Bh(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var j=new _s("action","action",null,i,c);e.push({event:j,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Ea!==0){var R=y?Mh(c,y):new FormData(c);Jo(n,{pending:!0,data:R,method:c.method,action:f},null,R)}}else typeof f=="function"&&(j.preventDefault(),R=y?Mh(c,y):new FormData(c),Jo(n,{pending:!0,data:R,method:c.method,action:f},f,R))},currentTarget:c}]})}}for(var Nc=0;Nc<uo.length;Nc++){var Oc=uo[Nc],Ty=Oc.toLowerCase(),Ay=Oc[0].toUpperCase()+Oc.slice(1);Tn(Ty,"on"+Ay)}Tn(hd,"onAnimationEnd"),Tn(gd,"onAnimationIteration"),Tn(pd,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(Pm,"onTransitionRun"),Tn(Gm,"onTransitionStart"),Tn(Km,"onTransitionCancel"),Tn(md,"onTransitionEnd"),Ie("onMouseEnter",["mouseout","mouseover"]),Ie("onMouseLeave",["mouseout","mouseover"]),Ie("onPointerEnter",["pointerout","pointerover"]),Ie("onPointerLeave",["pointerout","pointerover"]),Ce("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ce("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ce("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ce("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ce("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ce("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ny=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kr));function Lh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],c=i.event;i=i.listeners;e:{var f=void 0;if(t)for(var y=i.length-1;0<=y;y--){var j=i[y],R=j.instance,K=j.currentTarget;if(j=j.listener,R!==f&&c.isPropagationStopped())break e;f=j,c.currentTarget=K;try{f(c)}catch(ie){Ss(ie)}c.currentTarget=null,f=R}else for(y=0;y<i.length;y++){if(j=i[y],R=j.instance,K=j.currentTarget,j=j.listener,R!==f&&c.isPropagationStopped())break e;f=j,c.currentTarget=K;try{f(c)}catch(ie){Ss(ie)}c.currentTarget=null,f=R}}}}function $e(e,t){var n=t[hr];n===void 0&&(n=t[hr]=new Set);var i=e+"__bubble";n.has(i)||(qh(t,e,2,!1),n.add(i))}function Rc(e,t,n){var i=0;t&&(i|=4),qh(n,e,i,t)}var cl="_reactListening"+Math.random().toString(36).slice(2);function kc(e){if(!e[cl]){e[cl]=!0,he.forEach(function(n){n!=="selectionchange"&&(Ny.has(n)||Rc(n,!1,e),Rc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cl]||(t[cl]=!0,Rc("selectionchange",!1,t))}}function qh(e,t,n,i){switch(gg(t)){case 2:var c=av;break;case 8:c=iv;break;default:c=Yc}n=c.bind(null,t,n,e),c=void 0,!Xl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Uc(e,t,n,i,c){var f=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var j=i.stateNode.containerInfo;if(j===c)break;if(y===4)for(y=i.return;y!==null;){var R=y.tag;if((R===3||R===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;j!==null;){if(y=ue(j),y===null)return;if(R=y.tag,R===5||R===6||R===26||R===27){i=f=y;continue e}j=j.parentNode}}i=i.return}$u(function(){var K=f,ie=Fl(n),ce=[];e:{var J=yd.get(e);if(J!==void 0){var W=_s,Se=e;switch(e){case"keypress":if(vs(n)===0)break e;case"keydown":case"keyup":W=jm;break;case"focusin":Se="focus",W=to;break;case"focusout":Se="blur",W=to;break;case"beforeblur":case"afterblur":W=to;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=um;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=Em;break;case hd:case gd:case pd:W=hm;break;case md:W=Tm;break;case"scroll":case"scrollend":W=om;break;case"wheel":W=Nm;break;case"copy":case"cut":case"paste":W=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=Ju;break;case"toggle":case"beforetoggle":W=Rm}var ke=(t&4)!==0,it=!ke&&(e==="scroll"||e==="scrollend"),I=ke?J!==null?J+"Capture":null:J;ke=[];for(var U=K,G;U!==null;){var le=U;if(G=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||G===null||I===null||(le=gr(U,I),le!=null&&ke.push(Yr(U,le,G))),it)break;U=U.return}0<ke.length&&(J=new W(J,Se,null,n,ie),ce.push({event:J,listeners:ke}))}}if((t&7)===0){e:{if(J=e==="mouseover"||e==="pointerover",W=e==="mouseout"||e==="pointerout",J&&n!==Jl&&(Se=n.relatedTarget||n.fromElement)&&(ue(Se)||Se[oa]))break e;if((W||J)&&(J=ie.window===ie?ie:(J=ie.ownerDocument)?J.defaultView||J.parentWindow:window,W?(Se=n.relatedTarget||n.toElement,W=K,Se=Se?ue(Se):null,Se!==null&&(it=d(Se),ke=Se.tag,Se!==it||ke!==5&&ke!==27&&ke!==6)&&(Se=null)):(W=null,Se=K),W!==Se)){if(ke=Ku,le="onMouseLeave",I="onMouseEnter",U="mouse",(e==="pointerout"||e==="pointerover")&&(ke=Ju,le="onPointerLeave",I="onPointerEnter",U="pointer"),it=W==null?J:de(W),G=Se==null?J:de(Se),J=new ke(le,U+"leave",W,n,ie),J.target=it,J.relatedTarget=G,le=null,ue(ie)===K&&(ke=new ke(I,U+"enter",Se,n,ie),ke.target=G,ke.relatedTarget=it,le=ke),it=le,W&&Se)t:{for(ke=Oy,I=W,U=Se,G=0,le=I;le;le=ke(le))G++;le=0;for(var Ae=U;Ae;Ae=ke(Ae))le++;for(;0<G-le;)I=ke(I),G--;for(;0<le-G;)U=ke(U),le--;for(;G--;){if(I===U||U!==null&&I===U.alternate){ke=I;break t}I=ke(I),U=ke(U)}ke=null}else ke=null;W!==null&&Ih(ce,J,W,ke,!1),Se!==null&&it!==null&&Ih(ce,it,Se,ke,!0)}}e:{if(J=K?de(K):window,W=J.nodeName&&J.nodeName.toLowerCase(),W==="select"||W==="input"&&J.type==="file")var Je=nd;else if(ed(J))if(ad)Je=Hm;else{Je=qm;var we=Lm}else W=J.nodeName,!W||W.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?K&&Yl(K.elementType)&&(Je=nd):Je=Im;if(Je&&(Je=Je(e,K))){td(ce,Je,n,ie);break e}we&&we(e,J,K),e==="focusout"&&K&&J.type==="number"&&K.memoizedProps.value!=null&&bi(J,"number",J.value)}switch(we=K?de(K):window,e){case"focusin":(ed(we)||we.contentEditable==="true")&&(wi=we,lo=K,jr=null);break;case"focusout":jr=lo=wi=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,dd(ce,n,ie);break;case"selectionchange":if($m)break;case"keydown":case"keyup":dd(ce,n,ie)}var He;if(ao)e:{switch(e){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else Si?Zu(e,n)&&(Ge="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ge="onCompositionStart");Ge&&(Fu&&n.locale!=="ko"&&(Si||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&Si&&(He=Pu()):(ca=ie,Zl="value"in ca?ca.value:ca.textContent,Si=!0)),we=ul(K,Ge),0<we.length&&(Ge=new Yu(Ge,e,null,n,ie),ce.push({event:Ge,listeners:we}),He?Ge.data=He:(He=Wu(n),He!==null&&(Ge.data=He)))),(He=Um?zm(e,n):Dm(e,n))&&(Ge=ul(K,"onBeforeInput"),0<Ge.length&&(we=new Yu("onBeforeInput","beforeinput",null,n,ie),ce.push({event:we,listeners:Ge}),we.data=He)),Cy(ce,e,K,n,ie)}Lh(ce,t)})}function Yr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ul(e,t){for(var n=t+"Capture",i=[];e!==null;){var c=e,f=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||f===null||(c=gr(e,n),c!=null&&i.unshift(Yr(e,c,f)),c=gr(e,t),c!=null&&i.push(Yr(e,c,f))),e.tag===3)return i;e=e.return}return[]}function Oy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Ih(e,t,n,i,c){for(var f=t._reactName,y=[];n!==null&&n!==i;){var j=n,R=j.alternate,K=j.stateNode;if(j=j.tag,R!==null&&R===i)break;j!==5&&j!==26&&j!==27||K===null||(R=K,c?(K=gr(n,f),K!=null&&y.unshift(Yr(n,K,R))):c||(K=gr(n,f),K!=null&&y.push(Yr(n,K,R)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var Ry=/\r\n?/g,ky=/\u0000|\uFFFD/g;function Hh(e){return(typeof e=="string"?e:""+e).replace(Ry,`
`).replace(ky,"")}function Vh(e,t){return t=Hh(t),Hh(e)===t}function at(e,t,n,i,c,f){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||_i(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&_i(e,""+i);break;case"className":Ft(e,"class",i);break;case"tabIndex":Ft(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":Ft(e,n,i);break;case"style":Hu(e,i,f);break;case"data":if(t!=="object"){Ft(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(n==="formAction"?(t!=="input"&&at(e,t,"name",c.name,c,null),at(e,t,"formEncType",c.formEncType,c,null),at(e,t,"formMethod",c.formMethod,c,null),at(e,t,"formTarget",c.formTarget,c,null)):(at(e,t,"encType",c.encType,c,null),at(e,t,"method",c.method,c,null),at(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=Pn);break;case"onScroll":i!=null&&$e("scroll",e);break;case"onScrollEnd":i!=null&&$e("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=ms(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":$e("beforetoggle",e),$e("toggle",e),gn(e,"popover",i);break;case"xlinkActuate":nn(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":nn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":nn(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":nn(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":nn(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":nn(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":nn(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":nn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":nn(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":gn(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=sm.get(n)||n,gn(e,n,i))}}function zc(e,t,n,i,c,f){switch(n){case"style":Hu(e,i,f);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof i=="string"?_i(e,i):(typeof i=="number"||typeof i=="bigint")&&_i(e,""+i);break;case"onScroll":i!=null&&$e("scroll",e);break;case"onScrollEnd":i!=null&&$e("scrollend",e);break;case"onClick":i!=null&&(e.onclick=Pn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ne.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),f=e[Ut]||null,f=f!=null?f[n]:null,typeof f=="function"&&e.removeEventListener(t,f,c),typeof i=="function")){typeof f!="function"&&f!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,c);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):gn(e,n,i)}}}function Mt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",e),$e("load",e);var i=!1,c=!1,f;for(f in n)if(n.hasOwnProperty(f)){var y=n[f];if(y!=null)switch(f){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:at(e,t,f,y,n,null)}}c&&at(e,t,"srcSet",n.srcSet,n,null),i&&at(e,t,"src",n.src,n,null);return;case"input":$e("invalid",e);var j=f=y=c=null,R=null,K=null;for(i in n)if(n.hasOwnProperty(i)){var ie=n[i];if(ie!=null)switch(i){case"name":c=ie;break;case"type":y=ie;break;case"checked":R=ie;break;case"defaultChecked":K=ie;break;case"value":f=ie;break;case"defaultValue":j=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(l(137,t));break;default:at(e,t,i,ie,n,null)}}qt(e,f,j,R,K,y,c,!1);return;case"select":$e("invalid",e),i=y=f=null;for(c in n)if(n.hasOwnProperty(c)&&(j=n[c],j!=null))switch(c){case"value":f=j;break;case"defaultValue":y=j;break;case"multiple":i=j;default:at(e,t,c,j,n,null)}t=f,n=y,e.multiple=!!i,t!=null?$n(e,!!i,t,!1):n!=null&&$n(e,!!i,n,!0);return;case"textarea":$e("invalid",e),f=c=i=null;for(y in n)if(n.hasOwnProperty(y)&&(j=n[y],j!=null))switch(y){case"value":i=j;break;case"defaultValue":c=j;break;case"children":f=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(l(91));break;default:at(e,t,y,j,n,null)}qu(e,i,c,f);return;case"option":for(R in n)if(n.hasOwnProperty(R)&&(i=n[R],i!=null))switch(R){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:at(e,t,R,i,n,null)}return;case"dialog":$e("beforetoggle",e),$e("toggle",e),$e("cancel",e),$e("close",e);break;case"iframe":case"object":$e("load",e);break;case"video":case"audio":for(i=0;i<Kr.length;i++)$e(Kr[i],e);break;case"image":$e("error",e),$e("load",e);break;case"details":$e("toggle",e);break;case"embed":case"source":case"link":$e("error",e),$e("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in n)if(n.hasOwnProperty(K)&&(i=n[K],i!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:at(e,t,K,i,n,null)}return;default:if(Yl(t)){for(ie in n)n.hasOwnProperty(ie)&&(i=n[ie],i!==void 0&&zc(e,t,ie,i,n,void 0));return}}for(j in n)n.hasOwnProperty(j)&&(i=n[j],i!=null&&at(e,t,j,i,n,null))}function Uy(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,f=null,y=null,j=null,R=null,K=null,ie=null;for(W in n){var ce=n[W];if(n.hasOwnProperty(W)&&ce!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":R=ce;default:i.hasOwnProperty(W)||at(e,t,W,null,i,ce)}}for(var J in i){var W=i[J];if(ce=n[J],i.hasOwnProperty(J)&&(W!=null||ce!=null))switch(J){case"type":f=W;break;case"name":c=W;break;case"checked":K=W;break;case"defaultChecked":ie=W;break;case"value":y=W;break;case"defaultValue":j=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(l(137,t));break;default:W!==ce&&at(e,t,J,W,i,ce)}}tt(e,y,j,R,K,ie,f,c);return;case"select":W=y=j=J=null;for(f in n)if(R=n[f],n.hasOwnProperty(f)&&R!=null)switch(f){case"value":break;case"multiple":W=R;default:i.hasOwnProperty(f)||at(e,t,f,null,i,R)}for(c in i)if(f=i[c],R=n[c],i.hasOwnProperty(c)&&(f!=null||R!=null))switch(c){case"value":J=f;break;case"defaultValue":j=f;break;case"multiple":y=f;default:f!==R&&at(e,t,c,f,i,R)}t=j,n=y,i=W,J!=null?$n(e,!!n,J,!1):!!i!=!!n&&(t!=null?$n(e,!!n,t,!0):$n(e,!!n,n?[]:"",!1));return;case"textarea":W=J=null;for(j in n)if(c=n[j],n.hasOwnProperty(j)&&c!=null&&!i.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:at(e,t,j,null,i,c)}for(y in i)if(c=i[y],f=n[y],i.hasOwnProperty(y)&&(c!=null||f!=null))switch(y){case"value":J=c;break;case"defaultValue":W=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==f&&at(e,t,y,c,i,f)}Lu(e,J,W);return;case"option":for(var Se in n)if(J=n[Se],n.hasOwnProperty(Se)&&J!=null&&!i.hasOwnProperty(Se))switch(Se){case"selected":e.selected=!1;break;default:at(e,t,Se,null,i,J)}for(R in i)if(J=i[R],W=n[R],i.hasOwnProperty(R)&&J!==W&&(J!=null||W!=null))switch(R){case"selected":e.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:at(e,t,R,J,i,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in n)J=n[ke],n.hasOwnProperty(ke)&&J!=null&&!i.hasOwnProperty(ke)&&at(e,t,ke,null,i,J);for(K in i)if(J=i[K],W=n[K],i.hasOwnProperty(K)&&J!==W&&(J!=null||W!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(l(137,t));break;default:at(e,t,K,J,i,W)}return;default:if(Yl(t)){for(var it in n)J=n[it],n.hasOwnProperty(it)&&J!==void 0&&!i.hasOwnProperty(it)&&zc(e,t,it,void 0,i,J);for(ie in i)J=i[ie],W=n[ie],!i.hasOwnProperty(ie)||J===W||J===void 0&&W===void 0||zc(e,t,ie,J,i,W);return}}for(var I in n)J=n[I],n.hasOwnProperty(I)&&J!=null&&!i.hasOwnProperty(I)&&at(e,t,I,null,i,J);for(ce in i)J=i[ce],W=n[ce],!i.hasOwnProperty(ce)||J===W||J==null&&W==null||at(e,t,ce,J,i,W)}function $h(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var c=n[i],f=c.transferSize,y=c.initiatorType,j=c.duration;if(f&&j&&$h(y)){for(y=0,j=c.responseEnd,i+=1;i<n.length;i++){var R=n[i],K=R.startTime;if(K>j)break;var ie=R.transferSize,ce=R.initiatorType;ie&&$h(ce)&&(R=R.responseEnd,y+=ie*(R<j?1:(j-K)/(R-K)))}if(--i,t+=8*(f+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Dc=null,Bc=null;function dl(e){return e.nodeType===9?e:e.ownerDocument}function Ph(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gh(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Mc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Lc=null;function Dy(){var e=window.event;return e&&e.type==="popstate"?e===Lc?!1:(Lc=e,!0):(Lc=null,!1)}var Kh=typeof setTimeout=="function"?setTimeout:void 0,By=typeof clearTimeout=="function"?clearTimeout:void 0,Yh=typeof Promise=="function"?Promise:void 0,My=typeof queueMicrotask=="function"?queueMicrotask:typeof Yh<"u"?function(e){return Yh.resolve(null).then(e).catch(Ly)}:Kh;function Ly(e){setTimeout(function(){throw e})}function Ca(e){return e==="head"}function Jh(e,t){var n=t,i=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(i===0){e.removeChild(c),Xi(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")Jr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Jr(n);for(var f=n.firstChild;f;){var y=f.nextSibling,j=f.nodeName;f[be]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&f.rel.toLowerCase()==="stylesheet"||n.removeChild(f),f=y}}else n==="body"&&Jr(e.ownerDocument.body);n=c}while(n);Xi(t)}function Fh(e,t){var n=e;e=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=i}while(n)}function qc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":qc(n),oe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function qy(e,t,n,i){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[be])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=jn(e.nextSibling),e===null)break}return null}function Iy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=jn(e.nextSibling),e===null))return null;return e}function Qh(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=jn(e.nextSibling),e===null))return null;return e}function Ic(e){return e.data==="$?"||e.data==="$~"}function Hc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Hy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function jn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Vc=null;function Xh(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return jn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function Zh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Wh(e,t,n){switch(t=dl(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Jr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);oe(e)}var Sn=new Map,eg=new Set;function fl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var sa=k.d;k.d={f:Vy,r:$y,D:Py,C:Gy,L:Ky,m:Yy,X:Fy,S:Jy,M:Qy};function Vy(){var e=sa.f(),t=al();return e||t}function $y(e){var t=fe(e);t!==null&&t.tag===5&&t.type==="form"?yf(t):sa.r(e)}var Ji=typeof document>"u"?null:document;function tg(e,t,n){var i=Ji;if(i&&typeof t=="string"&&t){var c=Re(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),eg.has(c)||(eg.add(c),e={rel:e,crossOrigin:n,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),Mt(t,"link",e),Z(t),i.head.appendChild(t)))}}function Py(e){sa.D(e),tg("dns-prefetch",e,null)}function Gy(e,t){sa.C(e,t),tg("preconnect",e,t)}function Ky(e,t,n){sa.L(e,t,n);var i=Ji;if(i&&e&&t){var c='link[rel="preload"][as="'+Re(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+Re(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+Re(n.imageSizes)+'"]')):c+='[href="'+Re(e)+'"]';var f=c;switch(t){case"style":f=Fi(e);break;case"script":f=Qi(e)}Sn.has(f)||(e=_({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Sn.set(f,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(Fr(f))||t==="script"&&i.querySelector(Qr(f))||(t=i.createElement("link"),Mt(t,"link",e),Z(t),i.head.appendChild(t)))}}function Yy(e,t){sa.m(e,t);var n=Ji;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+Re(i)+'"][href="'+Re(e)+'"]',f=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Qi(e)}if(!Sn.has(f)&&(e=_({rel:"modulepreload",href:e},t),Sn.set(f,e),n.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Qr(f)))return}i=n.createElement("link"),Mt(i,"link",e),Z(i),n.head.appendChild(i)}}}function Jy(e,t,n){sa.S(e,t,n);var i=Ji;if(i&&e){var c=je(i).hoistableStyles,f=Fi(e);t=t||"default";var y=c.get(f);if(!y){var j={loading:0,preload:null};if(y=i.querySelector(Fr(f)))j.loading=5;else{e=_({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sn.get(f))&&$c(e,n);var R=y=i.createElement("link");Z(R),Mt(R,"link",e),R._p=new Promise(function(K,ie){R.onload=K,R.onerror=ie}),R.addEventListener("load",function(){j.loading|=1}),R.addEventListener("error",function(){j.loading|=2}),j.loading|=4,hl(y,t,i)}y={type:"stylesheet",instance:y,count:1,state:j},c.set(f,y)}}}function Fy(e,t){sa.X(e,t);var n=Ji;if(n&&e){var i=je(n).hoistableScripts,c=Qi(e),f=i.get(c);f||(f=n.querySelector(Qr(c)),f||(e=_({src:e,async:!0},t),(t=Sn.get(c))&&Pc(e,t),f=n.createElement("script"),Z(f),Mt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},i.set(c,f))}}function Qy(e,t){sa.M(e,t);var n=Ji;if(n&&e){var i=je(n).hoistableScripts,c=Qi(e),f=i.get(c);f||(f=n.querySelector(Qr(c)),f||(e=_({src:e,async:!0,type:"module"},t),(t=Sn.get(c))&&Pc(e,t),f=n.createElement("script"),Z(f),Mt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},i.set(c,f))}}function ng(e,t,n,i){var c=(c=re.current)?fl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Fi(n.href),n=je(c).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Fi(n.href);var f=je(c).hoistableStyles,y=f.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=c.querySelector(Fr(e)))&&!f._p&&(y.instance=f,y.state.loading=5),Sn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sn.set(e,n),f||Xy(c,e,n,y.state))),t&&i===null)throw Error(l(528,""));return y}if(t&&i!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Qi(n),n=je(c).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Fi(e){return'href="'+Re(e)+'"'}function Fr(e){return'link[rel="stylesheet"]['+e+"]"}function ag(e){return _({},e,{"data-precedence":e.precedence,precedence:null})}function Xy(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Mt(t,"link",n),Z(t),e.head.appendChild(t))}function Qi(e){return'[src="'+Re(e)+'"]'}function Qr(e){return"script[async]"+e}function ig(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+Re(n.href)+'"]');if(i)return t.instance=i,Z(i),i;var c=_({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),Z(i),Mt(i,"style",c),hl(i,n.precedence,e),t.instance=i;case"stylesheet":c=Fi(n.href);var f=e.querySelector(Fr(c));if(f)return t.state.loading|=4,t.instance=f,Z(f),f;i=ag(n),(c=Sn.get(c))&&$c(i,c),f=(e.ownerDocument||e).createElement("link"),Z(f);var y=f;return y._p=new Promise(function(j,R){y.onload=j,y.onerror=R}),Mt(f,"link",i),t.state.loading|=4,hl(f,n.precedence,e),t.instance=f;case"script":return f=Qi(n.src),(c=e.querySelector(Qr(f)))?(t.instance=c,Z(c),c):(i=n,(c=Sn.get(f))&&(i=_({},n),Pc(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),Z(c),Mt(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,hl(i,n.precedence,e));return t.instance}function hl(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,f=c,y=0;y<i.length;y++){var j=i[y];if(j.dataset.precedence===t)f=j;else if(f!==c)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function $c(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Pc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var gl=null;function rg(e,t,n){if(gl===null){var i=new Map,c=gl=new Map;c.set(n,i)}else c=gl,i=c.get(n),i||(i=new Map,c.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var f=n[c];if(!(f[be]||f[jt]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var j=i.get(y);j?j.push(f):i.set(y,[f])}}return i}function sg(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Zy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function lg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Wy(e,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=Fi(i.href),f=t.querySelector(Fr(c));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=pl.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=f,Z(f);return}f=t.ownerDocument||t,i=ag(i),(c=Sn.get(c))&&$c(i,c),f=f.createElement("link"),Z(f);var y=f;y._p=new Promise(function(j,R){y.onload=j,y.onerror=R}),Mt(f,"link",i),n.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=pl.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Gc=0;function ev(e,t){return e.stylesheets&&e.count===0&&yl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&Gc===0&&(Gc=62500*zy());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>Gc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function pl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)yl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ml=null;function yl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ml=new Map,t.forEach(tv,e),ml=null,pl.call(e))}function tv(e,t){if(!(t.state.loading&4)){var n=ml.get(e);if(n)var i=n.get(null);else{n=new Map,ml.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<c.length;f++){var y=c[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),i=y)}i&&n.set(null,i)}c=t.instance,y=c.getAttribute("data-precedence"),f=n.get(y)||i,f===i&&n.set(null,c),n.set(y,c),this.count++,i=pl.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),f?f.parentNode.insertBefore(c,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Xr={$$typeof:B,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function nv(e,t,n,i,c,f,y,j,R){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dr(0),this.hiddenUpdates=dr(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function og(e,t,n,i,c,f,y,j,R,K,ie,ce){return e=new nv(e,t,n,y,R,K,ie,ce,j),t=1,f===!0&&(t|=24),f=rn(3,null,null,t),e.current=f,f.stateNode=e,t=wo(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:i,isDehydrated:n,cache:t},Ao(f),e}function cg(e){return e?(e=Ti,e):Ti}function ug(e,t,n,i,c,f){c=cg(c),i.context===null?i.context=c:i.pendingContext=c,i=pa(t),i.payload={element:n},f=f===void 0?null:f,f!==null&&(i.callback=f),n=ma(e,i,t),n!==null&&(tn(n,e,t),Nr(n,e,t))}function dg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Kc(e,t){dg(e,t),(e=e.alternate)&&dg(e,t)}function fg(e){if(e.tag===13||e.tag===31){var t=Pa(e,67108864);t!==null&&tn(t,e,67108864),Kc(e,67108864)}}function hg(e){if(e.tag===13||e.tag===31){var t=un();t=mi(t);var n=Pa(e,t);n!==null&&tn(n,e,t),Kc(e,t)}}var vl=!0;function av(e,t,n,i){var c=C.T;C.T=null;var f=k.p;try{k.p=2,Yc(e,t,n,i)}finally{k.p=f,C.T=c}}function iv(e,t,n,i){var c=C.T;C.T=null;var f=k.p;try{k.p=8,Yc(e,t,n,i)}finally{k.p=f,C.T=c}}function Yc(e,t,n,i){if(vl){var c=Jc(i);if(c===null)Uc(e,t,i,bl,n),pg(e,i);else if(sv(c,e,t,n,i))i.stopPropagation();else if(pg(e,i),t&4&&-1<rv.indexOf(e)){for(;c!==null;){var f=fe(c);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=Gt(f.pendingLanes);if(y!==0){var j=f;for(j.pendingLanes|=2,j.entangledLanes|=2;y;){var R=1<<31-Pt(y);j.entanglements[1]|=R,y&=~R}Hn(f),(Qe&6)===0&&(tl=Vt()+500,Gr(0))}}break;case 31:case 13:j=Pa(f,2),j!==null&&tn(j,f,2),al(),Kc(f,2)}if(f=Jc(i),f===null&&Uc(e,t,i,bl,n),f===c)break;c=f}c!==null&&i.stopPropagation()}else Uc(e,t,i,null,n)}}function Jc(e){return e=Fl(e),Fc(e)}var bl=null;function Fc(e){if(bl=null,e=ue(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=h(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return bl=e,null}function gg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(cr()){case ur:return 2;case fi:return 8;case hi:case us:return 32;case ds:return 268435456;default:return 32}default:return 32}}var Qc=!1,Ta=null,Aa=null,Na=null,Zr=new Map,Wr=new Map,Oa=[],rv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pg(e,t){switch(e){case"focusin":case"focusout":Ta=null;break;case"dragenter":case"dragleave":Aa=null;break;case"mouseover":case"mouseout":Na=null;break;case"pointerover":case"pointerout":Zr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wr.delete(t.pointerId)}}function es(e,t,n,i,c,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:f,targetContainers:[c]},t!==null&&(t=fe(t),t!==null&&fg(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function sv(e,t,n,i,c){switch(t){case"focusin":return Ta=es(Ta,e,t,n,i,c),!0;case"dragenter":return Aa=es(Aa,e,t,n,i,c),!0;case"mouseover":return Na=es(Na,e,t,n,i,c),!0;case"pointerover":var f=c.pointerId;return Zr.set(f,es(Zr.get(f)||null,e,t,n,i,c)),!0;case"gotpointercapture":return f=c.pointerId,Wr.set(f,es(Wr.get(f)||null,e,t,n,i,c)),!0}return!1}function mg(e){var t=ue(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){e.blockedOn=t,Dn(e.priority,function(){hg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,Dn(e.priority,function(){hg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _l(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jc(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Jl=i,n.target.dispatchEvent(i),Jl=null}else return t=fe(n),t!==null&&fg(t),e.blockedOn=n,!1;t.shift()}return!0}function yg(e,t,n){_l(e)&&n.delete(t)}function lv(){Qc=!1,Ta!==null&&_l(Ta)&&(Ta=null),Aa!==null&&_l(Aa)&&(Aa=null),Na!==null&&_l(Na)&&(Na=null),Zr.forEach(yg),Wr.forEach(yg)}function xl(e,t){e.blockedOn===t&&(e.blockedOn=null,Qc||(Qc=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,lv)))}var jl=null;function vg(e){jl!==e&&(jl=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){jl===e&&(jl=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(Fc(i||n)===null)continue;break}var f=fe(n);f!==null&&(e.splice(t,3),t-=3,Jo(f,{pending:!0,data:c,method:n.method,action:i},i,c))}}))}function Xi(e){function t(R){return xl(R,e)}Ta!==null&&xl(Ta,e),Aa!==null&&xl(Aa,e),Na!==null&&xl(Na,e),Zr.forEach(t),Wr.forEach(t);for(var n=0;n<Oa.length;n++){var i=Oa[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Oa.length&&(n=Oa[0],n.blockedOn===null);)mg(n),n.blockedOn===null&&Oa.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var c=n[i],f=n[i+1],y=c[Ut]||null;if(typeof f=="function")y||vg(n);else if(y){var j=null;if(f&&f.hasAttribute("formAction")){if(c=f,y=f[Ut]||null)j=y.formAction;else if(Fc(c)!==null)continue}else j=y.action;typeof j=="function"?n[i+1]=j:(n.splice(i,3),i-=3),vg(n)}}}function bg(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function Xc(e){this._internalRoot=e}Sl.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,i=un();ug(n,i,e,t,null,null)},Sl.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ug(e.current,2,null,e,null,null),al(),t[oa]=null}};function Sl(e){this._internalRoot=e}Sl.prototype.unstable_scheduleHydration=function(e){if(e){var t=yi();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Oa.length&&t!==0&&t<Oa[n].priority;n++);Oa.splice(n,0,e),n===0&&mg(e)}};var _g=a.version;if(_g!=="19.2.0")throw Error(l(527,_g,"19.2.0"));k.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var ov={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:C,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{Un=wl.inject(ov),$t=wl}catch{}}return ns.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,i="",c=Tf,f=Af,y=Nf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=og(e,1,!1,null,null,n,i,null,c,f,y,bg),e[oa]=t.current,kc(e),new Xc(t)},ns.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var i=!1,c="",f=Tf,y=Af,j=Nf,R=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(j=n.onRecoverableError),n.formState!==void 0&&(R=n.formState)),t=og(e,1,!0,t,n??null,i,c,R,f,y,j,bg),t.context=cg(null),n=t.current,i=un(),i=mi(i),c=pa(i),c.callback=null,ma(n,c,i),n=i,t.current.lanes=n,Vn(t,n),Hn(t),e[oa]=t.current,kc(e),new Sl(t)},ns.version="19.2.0",ns}var Og;function bv(){if(Og)return Wc.exports;Og=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),Wc.exports=vv(),Wc.exports}var _v=bv(),S=Cu();const Tu=op(S);var hu=function(o,a){return hu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},hu(o,a)};function up(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");hu(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var zl=function(){return zl=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},zl.apply(this,arguments)};function lr(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function dp(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(h=o[g])&&(d=(u<3?h(d):u>3?h(a,s,d):h(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function fp(o,a){return function(s,l){a(s,l,o)}}function hp(o,a,s,l,u,d){function h(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),_,x=!1,b=s.length-1;b>=0;b--){var w={};for(var N in l)w[N]=N==="access"?{}:l[N];for(var N in l.access)w.access[N]=l.access[N];w.addInitializer=function(T){if(x)throw new TypeError("Cannot add initializers after decoration has completed");d.push(h(T||null))};var O=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(O===void 0)continue;if(O===null||typeof O!="object")throw new TypeError("Object expected");(_=h(O.get))&&(v.get=_),(_=h(O.set))&&(v.set=_),(_=h(O.init))&&u.unshift(_)}else(_=h(O))&&(g==="field"?u.unshift(_):v[p]=_)}m&&Object.defineProperty(m,l.name,v),x=!0}function gp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function pp(o){return typeof o=="symbol"?o:"".concat(o)}function mp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function yp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function Ee(o,a,s,l){function u(d){return d instanceof s?d:new s(function(h){h(d)})}return new(s||(s=Promise))(function(d,h){function g(v){try{m(l.next(v))}catch(_){h(_)}}function p(v){try{m(l.throw(v))}catch(_){h(_)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function vp(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=g(0),h.throw=g(1),h.return=g(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;h&&(h=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var ql=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function bp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&ql(a,o,s)}function Dl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Au(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],h;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){h={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(h)throw h.error}}return d}function _p(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(Au(arguments[a]));return o}function xp(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],h=0,g=d.length;h<g;h++,u++)l[u]=d[h];return l}function jp(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function sr(o){return this instanceof sr?(this.v=o,this):new sr(o)}function Sp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",h),u[Symbol.asyncIterator]=function(){return this},u;function h(b){return function(w){return Promise.resolve(w).then(b,_)}}function g(b,w){l[b]&&(u[b]=function(N){return new Promise(function(O,T){d.push([b,N,O,T])>1||p(b,N)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(N){x(d[0][3],N)}}function m(b){b.value instanceof sr?Promise.resolve(b.value.v).then(v,_):x(d[0][2],b)}function v(b){p("next",b)}function _(b){p("throw",b)}function x(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function wp(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(h){return(s=!s)?{value:sr(o[u](h)),done:!1}:d?d(h):h}:d}}function Ep(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Dl=="function"?Dl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(h){return new Promise(function(g,p){h=o[d](h),u(g,p,h.done,h.value)})}}function u(d,h,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},h)}}function Cp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var xv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},gu=function(o){return gu=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},gu(o)};function Tp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=gu(o),l=0;l<s.length;l++)s[l]!=="default"&&ql(a,o,s[l]);return xv(a,o),a}function Ap(o){return o&&o.__esModule?o:{default:o}}function Np(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function Op(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Rp(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function kp(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var jv=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Up(o){function a(d){o.error=o.hasError?new jv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(h){return a(h),u()})}else l|=1}catch(h){a(h)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function zp(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,h){return l?a?".jsx":".js":u&&(!d||!h)?s:u+d+"."+h.toLowerCase()+"js"}):o}const Sv={__extends:up,__assign:zl,__rest:lr,__decorate:dp,__param:fp,__esDecorate:hp,__runInitializers:gp,__propKey:pp,__setFunctionName:mp,__metadata:yp,__awaiter:Ee,__generator:vp,__createBinding:ql,__exportStar:bp,__values:Dl,__read:Au,__spread:_p,__spreadArrays:xp,__spreadArray:jp,__await:sr,__asyncGenerator:Sp,__asyncDelegator:wp,__asyncValues:Ep,__makeTemplateObject:Cp,__importStar:Tp,__importDefault:Ap,__classPrivateFieldGet:Np,__classPrivateFieldSet:Op,__classPrivateFieldIn:Rp,__addDisposableResource:kp,__disposeResources:Up,__rewriteRelativeImportExtension:zp},wv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:kp,get __assign(){return zl},__asyncDelegator:wp,__asyncGenerator:Sp,__asyncValues:Ep,__await:sr,__awaiter:Ee,__classPrivateFieldGet:Np,__classPrivateFieldIn:Rp,__classPrivateFieldSet:Op,__createBinding:ql,__decorate:dp,__disposeResources:Up,__esDecorate:hp,__exportStar:bp,__extends:up,__generator:vp,__importDefault:Ap,__importStar:Tp,__makeTemplateObject:Cp,__metadata:yp,__param:fp,__propKey:pp,__read:Au,__rest:lr,__rewriteRelativeImportExtension:zp,__runInitializers:gp,__setFunctionName:mp,__spread:_p,__spreadArray:jp,__spreadArrays:xp,__values:Dl,default:Sv},Symbol.toStringTag,{value:"Module"})),Ev=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Nu extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Cv extends Nu{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Rg extends Nu{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class kg extends Nu{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var pu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(pu||(pu={}));class Tv{constructor(a,{headers:s={},customFetch:l,region:u=pu.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Ev(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return Ee(this,arguments,void 0,function*(s,l={}){var u;let d,h;try{const{headers:g,method:p,body:m,signal:v,timeout:_}=l;let x={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${s}`);b&&b!=="any"&&(x["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let N;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",N=m):typeof m=="string"?(x["Content-Type"]="text/plain",N=m):typeof FormData<"u"&&m instanceof FormData?N=m:(x["Content-Type"]="application/json",N=JSON.stringify(m)):N=m;let O=v;_&&(h=new AbortController,d=setTimeout(()=>h.abort(),_),v?(O=h.signal,v.addEventListener("abort",()=>h.abort())):O=h.signal);const T=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),g),body:N,signal:O}).catch(E=>{throw new Cv(E)}),q=T.headers.get("x-relay-error");if(q&&q==="true")throw new Rg(T);if(!T.ok)throw new kg(T);let B=((u=T.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),Y;return B==="application/json"?Y=yield T.json():B==="application/octet-stream"||B==="application/pdf"?Y=yield T.blob():B==="text/event-stream"?Y=T:B==="multipart/form-data"?Y=yield T.formData():Y=yield T.text(),{data:Y,error:null,response:T}}catch(g){return{data:null,error:g,response:g instanceof kg||g instanceof Rg?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Ht={};const or=dv(wv);var El={},Cl={},Tl={},Al={},Nl={},Ol={},Ug;function Dp(){if(Ug)return Ol;Ug=1,Object.defineProperty(Ol,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Ol.default=o,Ol}var zg;function Bp(){if(zg)return Nl;zg=1,Object.defineProperty(Nl,"__esModule",{value:!0});const a=or.__importDefault(Dp());class s{constructor(u){var d,h;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(h=u.isMaybeSingle)!==null&&h!==void 0?h:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,_,x;let b=null,w=null,N=null,O=p.status,T=p.statusText;if(p.ok){if(this.method!=="HEAD"){const E=await p.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=E:w=JSON.parse(E))}const B=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),Y=(_=p.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");B&&Y&&Y.length>1&&(N=parseInt(Y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,N=null,O=406,T="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const B=await p.text();try{b=JSON.parse(B),Array.isArray(b)&&p.status===404&&(w=[],b=null,O=200,T="OK")}catch{p.status===404&&B===""?(O=204,T="No Content"):b={message:B}}if(b&&this.isMaybeSingle&&(!((x=b?.details)===null||x===void 0)&&x.includes("0 rows"))&&(b=null,O=200,T="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:N,status:O,statusText:T}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,_;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=p?.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Nl.default=s,Nl}var Dg;function Mp(){if(Dg)return Al;Dg=1,Object.defineProperty(Al,"__esModule",{value:!0});const a=or.__importDefault(Bp());class s extends a.default{select(u){let d=!1;const h=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",h),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:h,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:h=d}={}){const g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:h,referencedTable:g=h}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:h=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const _=[u?"analyze":null,d?"verbose":null,h?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),x=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${x}"; options=${_};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return Al.default=s,Al}var Bg;function Ou(){if(Bg)return Tl;Bg=1,Object.defineProperty(Tl,"__esModule",{value:!0});const a=or.__importDefault(Mp()),s=new RegExp("[,()]");class l extends a.default{eq(d,h){return this.url.searchParams.append(d,`eq.${h}`),this}neq(d,h){return this.url.searchParams.append(d,`neq.${h}`),this}gt(d,h){return this.url.searchParams.append(d,`gt.${h}`),this}gte(d,h){return this.url.searchParams.append(d,`gte.${h}`),this}lt(d,h){return this.url.searchParams.append(d,`lt.${h}`),this}lte(d,h){return this.url.searchParams.append(d,`lte.${h}`),this}like(d,h){return this.url.searchParams.append(d,`like.${h}`),this}likeAllOf(d,h){return this.url.searchParams.append(d,`like(all).{${h.join(",")}}`),this}likeAnyOf(d,h){return this.url.searchParams.append(d,`like(any).{${h.join(",")}}`),this}ilike(d,h){return this.url.searchParams.append(d,`ilike.${h}`),this}ilikeAllOf(d,h){return this.url.searchParams.append(d,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(d,h){return this.url.searchParams.append(d,`ilike(any).{${h.join(",")}}`),this}is(d,h){return this.url.searchParams.append(d,`is.${h}`),this}in(d,h){const g=Array.from(new Set(h)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cs.{${h.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(h)}`),this}containedBy(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cd.{${h.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(h)}`),this}rangeGt(d,h){return this.url.searchParams.append(d,`sr.${h}`),this}rangeGte(d,h){return this.url.searchParams.append(d,`nxl.${h}`),this}rangeLt(d,h){return this.url.searchParams.append(d,`sl.${h}`),this}rangeLte(d,h){return this.url.searchParams.append(d,`nxr.${h}`),this}rangeAdjacent(d,h){return this.url.searchParams.append(d,`adj.${h}`),this}overlaps(d,h){return typeof h=="string"?this.url.searchParams.append(d,`ov.${h}`):this.url.searchParams.append(d,`ov.{${h.join(",")}}`),this}textSearch(d,h,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${h}`),this}match(d){return Object.entries(d).forEach(([h,g])=>{this.url.searchParams.append(h,`eq.${g}`)}),this}not(d,h,g){return this.url.searchParams.append(d,`not.${h}.${g}`),this}or(d,{foreignTable:h,referencedTable:g=h}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,h,g){return this.url.searchParams.append(d,`${h}.${g}`),this}}return Tl.default=l,Tl}var Mg;function Lp(){if(Mg)return Cl;Mg=1,Object.defineProperty(Cl,"__esModule",{value:!0});const a=or.__importDefault(Ou());class s{constructor(u,{headers:d={},schema:h,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=h,this.fetch=g}select(u,d){const{head:h=!1,count:g}=d??{},p=h?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(_=>/\s/.test(_)&&!m?"":(_==='"'&&(m=!m),_)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:h=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,_)=>v.concat(Object.keys(_)),[]);if(m.length>0){const v=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:h=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${h?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const _=u.reduce((x,b)=>x.concat(Object.keys(b)),[]);if(_.length>0){const x=[...new Set(_)].map(b=>`"${b}"`);this.url.searchParams.set("columns",x.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var h;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}delete({count:u}={}){var d;const h="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Cl.default=s,Cl}var Lg;function Av(){if(Lg)return El;Lg=1,Object.defineProperty(El,"__esModule",{value:!0});const o=or,a=o.__importDefault(Lp()),s=o.__importDefault(Ou());class l{constructor(d,{headers:h={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(h),this.schemaName=g,this.fetch=p}from(d){const h=new URL(`${this.url}/${d}`);return new a.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,h={},{head:g=!1,get:p=!1,count:m}={}){var v;let _;const x=new URL(`${this.url}/rpc/${d}`);let b;g||p?(_=g?"HEAD":"GET",Object.entries(h).filter(([N,O])=>O!==void 0).map(([N,O])=>[N,Array.isArray(O)?`{${O.join(",")}}`:`${O}`]).forEach(([N,O])=>{x.searchParams.append(N,O)})):(_="POST",b=h);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new s.default({method:_,url:x,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return El.default=l,El}var qg;function Nv(){if(qg)return Ht;qg=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.PostgrestError=Ht.PostgrestBuilder=Ht.PostgrestTransformBuilder=Ht.PostgrestFilterBuilder=Ht.PostgrestQueryBuilder=Ht.PostgrestClient=void 0;const o=or,a=o.__importDefault(Av());Ht.PostgrestClient=a.default;const s=o.__importDefault(Lp());Ht.PostgrestQueryBuilder=s.default;const l=o.__importDefault(Ou());Ht.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Mp());Ht.PostgrestTransformBuilder=u.default;const d=o.__importDefault(Bp());Ht.PostgrestBuilder=d.default;const h=o.__importDefault(Dp());return Ht.PostgrestError=h.default,Ht.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:h.default},Ht}var qp=Nv();const Ip=op(qp),Ov=uv({__proto__:null,default:Ip},[qp]),{PostgrestClient:Rv,PostgrestQueryBuilder:dx,PostgrestFilterBuilder:fx,PostgrestTransformBuilder:hx,PostgrestBuilder:gx,PostgrestError:px}=Ip||Ov;class kv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const Uv="2.81.1",zv=`realtime-js/${Uv}`,Hp="1.0.0",Dv="2.0.0",Ig=Hp,mu=1e4,Bv=1e3,Mv=100;var li;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(li||(li={}));var Nt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Nt||(Nt={}));var wn;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(wn||(wn={}));var yu;(function(o){o.websocket="websocket"})(yu||(yu={}));var oi;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(oi||(oi={}));class Lv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:h}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,x=>m.setUint8(v++,x.charCodeAt(0))),Array.from(l,x=>m.setUint8(v++,x.charCodeAt(0))),Array.from(d,x=>m.setUint8(v++,x.charCodeAt(0))),Array.from(u,x=>m.setUint8(v++,x.charCodeAt(0)));var _=new Uint8Array(p.byteLength+h.byteLength);return _.set(new Uint8Array(p),0),_.set(new Uint8Array(h),p.byteLength),_.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let _=new DataView(v),x=0;_.setUint8(x++,this.KINDS.userBroadcastPush),_.setUint8(x++,u.length),_.setUint8(x++,d.length),_.setUint8(x++,h.length),_.setUint8(x++,g.length),_.setUint8(x++,this.BINARY_ENCODING),Array.from(u,w=>_.setUint8(x++,w.charCodeAt(0))),Array.from(d,w=>_.setUint8(x++,w.charCodeAt(0))),Array.from(h,w=>_.setUint8(x++,w.charCodeAt(0))),Array.from(g,w=>_.setUint8(x++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,_=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,x=new ArrayBuffer(this.HEADER_LENGTH+_);let b=new DataView(x),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,h.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(d,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(h,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(g,O=>b.setUint8(w++,O.charCodeAt(0)));var N=new Uint8Array(x.byteLength+v.byteLength);return N.set(new Uint8Array(x),0),N.set(new Uint8Array(v),x.byteLength),N.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,h,g,p]=l;return s({join_ref:u,ref:d,topic:h,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+h));g=g+h;const _=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:_}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+h));p=p+h;const x=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:x,response:b};return{join_ref:m,ref:v,topic:_,event:wn.reply,payload:w}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let h=this.HEADER_LENGTH+2;const g=l.decode(a.slice(h,h+u));h=h+u;const p=l.decode(a.slice(h,h+d));h=h+d;const m=JSON.parse(l.decode(a.slice(h,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+h));p=p+h;const x=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(x)):x,w={type:this.BROADCAST,event:v,payload:b};return h>0&&(w.meta=JSON.parse(_)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Vp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var lt;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(lt||(lt={}));const Hg=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,h)=>(d[h]=qv(h,o,a,u),d),{}):{}},qv=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,h=s[o];return d&&!l.includes(d)?$p(d,h):vu(h)},$p=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return $v(a,s)}switch(o){case lt.bool:return Iv(a);case lt.float4:case lt.float8:case lt.int2:case lt.int4:case lt.int8:case lt.numeric:case lt.oid:return Hv(a);case lt.json:case lt.jsonb:return Vv(a);case lt.timestamp:return Pv(a);case lt.abstime:case lt.date:case lt.daterange:case lt.int4range:case lt.int8range:case lt.money:case lt.reltime:case lt.text:case lt.time:case lt.timestamptz:case lt.timetz:case lt.tsrange:case lt.tstzrange:return vu(a);default:return vu(a)}},vu=o=>o,Iv=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Hv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Vv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},$v=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const h=o.slice(1,s);try{d=JSON.parse("["+h+"]")}catch{d=h?h.split(","):[]}return d.map(g=>$p(a,g))}return o},Pv=o=>typeof o=="string"?o.replace(" ","T"):o,Pp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class iu{constructor(a,s,l={},u=mu){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Vg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Vg||(Vg={}));class is{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=is.syncState(this.state,u,d,h),this.pendingDiffs.forEach(p=>{this.state=is.syncDiff(this.state,p,d,h)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=is.syncDiff(this.state,u,d,h),g())}),this.onJoin((u,d,h)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:h})}),this.onLeave((u,d,h)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),h=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{h[m]||(p[m]=v)}),this.map(h,(m,v)=>{const _=d[m];if(_){const x=v.map(O=>O.presence_ref),b=_.map(O=>O.presence_ref),w=v.filter(O=>b.indexOf(O.presence_ref)<0),N=_.filter(O=>x.indexOf(O.presence_ref)<0);w.length>0&&(g[m]=w),N.length>0&&(p[m]=N)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:h}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const _=a[g].map(b=>b.presence_ref),x=v.filter(b=>_.indexOf(b.presence_ref)<0);a[g].unshift(...x)}l(g,v,p)}),this.map(h,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(_=>_.presence_ref);m=m.filter(_=>v.indexOf(_.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $g;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})($g||($g={}));var rs;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(rs||(rs={}));var la;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(la||(la={}));class Ru{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=Nt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new iu(this,wn.join,this.params,this.timeout),this.rejoinTimer=new Vp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nt.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(wn.reply,{},(h,g)=>{this._trigger(this._replyEventName(g),h)}),this.presence=new is(this),this.broadcastEndpointURL=Pp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Nt.closed){const{config:{broadcast:h,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[rs.PRESENCE]&&this.bindings[rs.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,_={},x={broadcast:h,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(la.CHANNEL_ERROR,b)),this._onClose(()=>a?.(la.CLOSED)),this.updateJoinPayload(Object.assign({config:x},_)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(la.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,O=(w=N?.length)!==null&&w!==void 0?w:0,T=[];for(let q=0;q<O;q++){const B=N[q],{filter:{event:Y,schema:E,table:M,filter:D}}=B,V=b&&b[q];if(V&&V.event===Y&&V.schema===E&&V.table===M&&V.filter===D)T.push(Object.assign(Object.assign({},B),{id:V.id}));else{this.unsubscribe(),this.state=Nt.errored,a?.(la.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,a&&a(la.SUBSCRIBED);return}}).receive("error",b=>{this.state=Nt.errored,a?.(la.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(la.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===Nt.joined&&a===rs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const h={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:h}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:h,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var h,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(h=this.params)===null||h===void 0?void 0:h.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=Nt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(wn.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new iu(this,wn.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Nt.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),h=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),h}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new iu(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Mv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const h=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=wn;if(l&&[g,p,m,v].indexOf(h)>=0&&l!==this._joinRef())return;let x=this._onMessage(h,s,l);if(s&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,N,O;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((O=(N=b.filter)===null||N===void 0?void 0:N.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===h}).map(b=>b.callback(x,l)):(d=this.bindings[h])===null||d===void 0||d.filter(b=>{var w,N,O,T,q,B;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in b){const Y=b.id,E=(w=b.filter)===null||w===void 0?void 0:w.event;return Y&&((N=s.ids)===null||N===void 0?void 0:N.includes(Y))&&(E==="*"||E?.toLocaleLowerCase()===((O=s.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const Y=(q=(T=b?.filter)===null||T===void 0?void 0:T.event)===null||q===void 0?void 0:q.toLocaleLowerCase();return Y==="*"||Y===((B=s?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===h}).map(b=>{if(typeof x=="object"&&"ids"in x){const w=x.data,{schema:N,table:O,commit_timestamp:T,type:q,errors:B}=w;x=Object.assign(Object.assign({},{schema:N,table:O,commit_timestamp:T,eventType:q,new:{},old:{},errors:B}),this._getPayloadRecords(w))}b.callback(x,l)})}_isClosed(){return this.state===Nt.closed}_isJoined(){return this.state===Nt.joined}_isJoining(){return this.state===Nt.joining}_isLeaving(){return this.state===Nt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Ru.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(wn.close,{},a)}_onError(a){this._on(wn.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Hg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Hg(a.columns,a.old_record)),s}}const ru=()=>{},Rl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Gv=[1e3,2e3,5e3,1e4],Kv=1e4,Yv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mu,this.transport=null,this.heartbeatIntervalMs=Rl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ru,this.ref=0,this.reconnectTimer=null,this.vsn=Ig,this.logger=ru,this.conn=null,this.sendBuffer=[],this.serializer=new Lv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${yu.websocket}`,this.httpEndpoint=Pp(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=kv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case li.connecting:return oi.Connecting;case li.open:return oi.Open;case li.closing:return oi.Closing;default:return oi.Closed}}isConnected(){return this.connectionState()===oi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Ru(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,h=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Bv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Rl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:h}=s,g=h?`(${h})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,h)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===li.open||this.conn.readyState===li.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(wn.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Yv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:zv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(wn.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Vp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Rl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,h,g,p,m,v,_,x,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:mu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Rl.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(h=a?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:ru,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Ig,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Gv[w-1]||Kv),this.vsn){case Hp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,N)=>N(JSON.stringify(w))),this.decode=(_=a?.decode)!==null&&_!==void 0?_:((w,N)=>N(JSON.parse(w)));break;case Dv:this.encode=(x=a?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class ku extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function pt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Fv extends ku{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class bu extends ku{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const Uu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Qv=()=>Response,_u=o=>{if(Array.isArray(o))return o.map(s=>_u(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=_u(l)}),a},Xv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},su=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},Zv=(o,a,s)=>Ee(void 0,void 0,void 0,function*(){const l=yield Qv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,h=u?.statusCode||d+"";a(new Fv(su(u),d,h))}).catch(u=>{a(new bu(su(u),u))}):a(new bu(su(o),o))}),Wv=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Xv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function cs(o,a,s,l,u,d){return Ee(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,Wv(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>Zv(p,g,l))})})}function ss(o,a,s,l){return Ee(this,void 0,void 0,function*(){return cs(o,"GET",a,s,l)})}function kn(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return cs(o,"POST",a,l,u,s)})}function xu(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return cs(o,"PUT",a,l,u,s)})}function eb(o,a,s,l){return Ee(this,void 0,void 0,function*(){return cs(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function zu(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return cs(o,"DELETE",a,l,u,s)})}class tb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return Ee(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(pt(a))return{data:null,error:a};throw a}})}}var Gp;class nb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Gp]="BlobDownloadBuilder",this.promise=null}asStream(){return new tb(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ee(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(pt(a))return{data:null,error:a};throw a}})}}Gp=Symbol.toStringTag;const ab={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ib{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=Uu(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return Ee(this,void 0,void 0,function*(){try{let d;const h=Object.assign(Object.assign({},Pg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",h.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!h.duplex&&(h.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),_=yield(a=="PUT"?xu:kn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:m,id:_.Id,fullPath:_.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(pt(d))return{data:null,error:d};throw d}})}upload(a,s,l){return Ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return Ee(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),h=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${h}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:Pg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const _=yield xu(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:_.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(pt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return Ee(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield kn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),h=new URL(this.url+d.url),g=h.searchParams.get("token");if(!g)throw new ku("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}update(a,s,l){return Ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return Ee(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}copy(a,s,l){return Ee(this,void 0,void 0,function*(){try{return{data:{path:(yield kn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return Ee(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield kn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const h=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${h}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return Ee(this,void 0,void 0,function*(){try{const u=yield kn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),h=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>ss(this.fetch,`${this.url}/${u}/${g}${h}`,{headers:this.headers,noResolveJson:!0});return new nb(p,this.shouldThrowOnError)}info(a){return Ee(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield ss(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:_u(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}exists(a){return Ee(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield eb(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l)&&l instanceof bu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}list(a,s,l){return Ee(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},ab),s),{prefix:a||""});return{data:yield kn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}listV2(a,s){return Ee(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield kn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const Kp="2.81.1",Yp={"X-Client-Info":`storage-js/${Kp}`};class rb{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=Uu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return Ee(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield ss(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}getBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield ss(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}createBucket(a){return Ee(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return Ee(this,void 0,void 0,function*(){try{return{data:yield xu(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class sb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=Uu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}listBuckets(a){return Ee(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield ss(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}}const Du={"X-Client-Info":`storage-js/${Kp}`,"Content-Type":"application/json"};class Jp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function dn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class lu extends Jp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lb extends Jp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Gg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Gg||(Gg={}));const Bu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ob=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Kg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),cb=(o,a,s)=>Ee(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(h=>{const g=h?.statusCode||h?.code||u+"";a(new lu(Kg(h),u,g))}).catch(()=>{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new lu(g,u,h))});else{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new lu(g,u,h))}}else a(new lb(Kg(o),o))}),ub=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(ob(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function db(o,a,s,l,u,d){return Ee(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,ub(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>h(p)).catch(p=>cb(p,g,l))})})}function fn(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return db(o,"POST",a,l,u,s)})}class fb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return Ee(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}getIndex(a,s){return Ee(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dn(l))return{data:null,error:l};throw l}})}listIndexes(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return Ee(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dn(l))return{data:null,error:l};throw l}})}}class hb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return Ee(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield fn(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}getVectors(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}listVectors(a){return Ee(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield fn(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}queryVectors(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}deleteVectors(a){return Ee(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield fn(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}}class gb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}getBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}listBuckets(){return Ee(this,arguments,void 0,function*(a={}){try{return{data:yield fn(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}}class pb extends gb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new mb(this.url,this.headers,a,this.fetch)}}class mb extends fb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ee(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ee(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ee(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ee(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new yb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class yb extends hb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ee(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ee(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ee(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ee(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ee(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vb extends rb{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new ib(this.url,this.headers,a,this.fetch)}get vectors(){return new pb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new sb(this.url+"/iceberg",this.headers,this.fetch)}}const bb="2.81.1";let as="";typeof Deno<"u"?as="deno":typeof document<"u"?as="web":typeof navigator<"u"&&navigator.product==="ReactNative"?as="react-native":as="node";const _b={"X-Client-Info":`supabase-js-${as}/${bb}`},xb={headers:_b},jb={schema:"public"},Sb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wb={},Eb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Cb=()=>Headers,Tb=(o,a,s)=>{const l=Eb(s),u=Cb();return async(d,h)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(h?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},h),{headers:m}))}};function Ab(o){return o.endsWith("/")?o:o+"/"}function Nb(o,a){var s,l;const{db:u,auth:d,realtime:h,global:g}=o,{db:p,auth:m,realtime:v,global:_}=a,x={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),h),storage:{},global:Object.assign(Object.assign(Object.assign({},_),g),{headers:Object.assign(Object.assign({},(s=_?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?x.accessToken=o.accessToken:delete x.accessToken,x}function Ob(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ab(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Fp="2.81.1",ar=30*1e3,ju=3,ou=ju*ar,Rb="http://localhost:9999",kb="supabase.auth.token",Ub={"X-Client-Info":`gotrue-js/${Fp}`},Su="X-Supabase-Api-Version",Qp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},zb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Db=600*1e3;class ls extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function Te(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Bb extends ls{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function Mb(o){return Te(o)&&o.name==="AuthApiError"}class ci extends ls{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class za extends ls{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class On extends za{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Lb(o){return Te(o)&&o.name==="AuthSessionMissingError"}class Zi extends za{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class kl extends za{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Ul extends za{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function qb(o){return Te(o)&&o.name==="AuthImplicitGrantRedirectError"}class Yg extends za{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wu extends za{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function cu(o){return Te(o)&&o.name==="AuthRetryableFetchError"}class Jg extends za{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class Eu extends za{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fg=` 	
\r=`.split(""),Ib=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Fg.length;a+=1)o[Fg[a].charCodeAt(0)]=-2;for(let a=0;a<Bl.length;a+=1)o[Bl[a].charCodeAt(0)]=a;return o})();function Qg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Bl[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Bl[l]),a.queuedBits-=6}}function Xp(o,a,s){const l=Ib[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Xg(o){const a=[],s=h=>{a.push(String.fromCodePoint(h))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=h=>{$b(h,l,s)};for(let h=0;h<o.length;h+=1)Xp(o.charCodeAt(h),u,d);return a.join("")}function Hb(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Vb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Hb(l,a)}}function $b(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function rr(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)Xp(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Pb(o){const a=[];return Vb(o,s=>a.push(s)),new Uint8Array(a)}function ui(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Qg(u,s,l)),Qg(null,s,l),a.join("")}function Gb(o){return Math.round(Date.now()/1e3)+o}function Kb(){return Symbol("auth-callback")}const Lt=()=>typeof window<"u"&&typeof document<"u",ai={tested:!1,writable:!1},Zp=()=>{if(!Lt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ai.tested)return ai.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ai.tested=!0,ai.writable=!0}catch{ai.tested=!0,ai.writable=!1}return ai.writable};function Yb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const Wp=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Jb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",ir=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},ii=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},ka=async(o,a)=>{await o.removeItem(a)};class Il{constructor(){this.promise=new Il.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Il.promiseConstructor=Promise;function uu(o){const a=o.split(".");if(a.length!==3)throw new Eu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!zb.test(a[l]))throw new Eu("JWT not in base64url format");return{header:JSON.parse(Xg(a[0])),payload:JSON.parse(Xg(a[1])),signature:rr(a[2]),raw:{header:a[0],payload:a[1]}}}async function Fb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Qb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const h=await o(d);if(!a(d,null,h)){l(h);return}}catch(h){if(!a(d,h)){u(h);return}}})()})}function Xb(o){return("0"+o.toString(16)).substr(-2)}function Zb(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Xb).join("")}async function Wb(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function e0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await Wb(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wi(o,a,s=!1){const l=Zb();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await ir(o,`${a}-code-verifier`,u);const d=await e0(l);return[d,l===d?"plain":"s256"]}const t0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function n0(o){const a=o.headers.get(Su);if(!a||!a.match(t0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function a0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function i0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const r0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function er(o){if(!r0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function du(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function Zg(o){return JSON.parse(JSON.stringify(o))}const si=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),l0=[502,503,504];async function Wg(o){var a;if(!Jb(o))throw new wu(si(o),0);if(l0.includes(o.status))throw new wu(si(o),o.status);let s;try{s=await o.json()}catch(d){throw new ci(si(d),d)}let l;const u=n0(o);if(u&&u.getTime()>=Qp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Jg(si(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new On}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,h)=>d&&typeof h=="string",!0))throw new Jg(si(s),o.status,s.weak_password.reasons);throw new Bb(si(s),o.status||500,l)}const o0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Ue(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[Su]||(d[Su]=Qp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const h=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(h.redirect_to=l.redirectTo);const g=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await c0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function c0(o,a,s,l,u,d){const h=o0(a,l,u,d);let g;try{g=await o(s,Object.assign({},h))}catch(p){throw console.error(p),new wu(si(p),0)}if(g.ok||await Wg(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await Wg(p)}}function Rn(o){var a;let s=null;f0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Gb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function ep(o){const a=Rn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Ua(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function u0(o){return{data:o,error:null}}function d0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,h=lr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},h);return{data:{properties:g,user:p},error:null}}function tp(o){return o}function f0(o){return o.access_token&&o.refresh_token&&o.expires_in}const fu=["global","local","others"];class h0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=Wp(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=fu[0]){if(fu.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fu.join(", ")}`);try{return await Ue(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Te(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Ue(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Ua})}catch(l){if(Te(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=lr(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Ue(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:d0,redirectTo:s?.redirectTo})}catch(s){if(Te(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Ue(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Ua})}catch(s){if(Te(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Ue(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const _=await v.json(),x=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=N}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Te(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){er(a);try{return await Ue(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Ua})}catch(s){if(Te(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){er(a);try{return await Ue(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:Ua})}catch(l){if(Te(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){er(a);try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:Ua})}catch(l){if(Te(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){er(a.userId);try{const{data:s,error:l}=await Ue(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(Te(s))return{data:null,error:s};throw s}}async _deleteFactor(a){er(a.userId),er(a.id);try{return{data:await Ue(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(Te(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const _=await v.json(),x=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=N}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Te(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Te(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Ue(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Te(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Ue(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Te(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Ue(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Te(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Ue(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Te(s))return{data:null,error:s};throw s}}}function np(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const tr={debug:!!(globalThis&&Zp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class em extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class g0 extends em{}async function p0(o,a,s){tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),tr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw tr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new g0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(tr.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function m0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tm(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function y0(o){return parseInt(o,16)}function v0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function b0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:h,notBefore:g,requestId:p,resources:m,scheme:v,uri:_,version:x}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!_)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=tm(o.address),w=v?`${v}://${l}`:l,N=o.statement?`${o.statement}
`:"",O=`${w} wants you to sign in with your Ethereum account:
${b}

${N}`;let T=`URI: ${_}
Version: ${x}
Chain ID: ${s}${h?`
Nonce: ${h}`:""}
Issued At: ${d.toISOString()}`;if(u&&(T+=`
Expiration Time: ${u.toISOString()}`),g&&(T+=`
Not Before: ${g.toISOString()}`),p&&(T+=`
Request ID: ${p}`),m){let q=`
Resources:`;for(const B of m){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);q+=`
- ${B}`}T+=q}return`${O}
${T}`}class Tt extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Ml extends Tt{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function _0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Tt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Tt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Tt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new Tt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Tt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Tt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Tt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Tt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const h=window.location.hostname;if(nm(h)){if(d.rp.id!==h)return new Tt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Tt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Tt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function x0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Tt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Tt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(nm(l)){if(s.rpId!==l)return new Tt({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Tt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Tt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Tt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class j0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const S0=new j0;function w0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=lr(o,["challenge","user","excludeCredentials"]),d=rr(a).buffer,h=Object.assign(Object.assign({},s),{id:rr(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:h});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:rr(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function E0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=lr(o,["challenge","allowCredentials"]),u=rr(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const g=s[h];d.allowCredentials[h]=Object.assign(Object.assign({},g),{id:rr(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function C0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:ui(new Uint8Array(o.response.attestationObject)),clientDataJSON:ui(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function T0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:ui(new Uint8Array(u.authenticatorData)),clientDataJSON:ui(new Uint8Array(u.clientDataJSON)),signature:ui(new Uint8Array(u.signature)),userHandle:u.userHandle?ui(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function nm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function ap(){var o,a;return!!(Lt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function A0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ml("Browser returned unexpected credential type",a)}:{data:null,error:new Ml("Empty credential response",a)}}catch(a){return{data:null,error:_0({error:a,options:o})}}}async function N0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ml("Browser returned unexpected credential type",a)}:{data:null,error:new Ml("Empty credential response",a)}}catch(a){return{data:null,error:x0({error:a,options:o})}}}const O0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},R0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ll(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const h=u[d];if(h!==void 0)if(Array.isArray(h))l[d]=h;else if(s(h))l[d]=h;else if(a(h)){const g=l[d];a(g)?l[d]=Ll(g,h):l[d]=Ll(h)}else l[d]=h}return l}function k0(o,a){return Ll(O0,o,a||{})}function U0(o,a){return Ll(R0,o,a||{})}class z0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:h,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!h)return{data:null,error:g};const p=u??S0.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=k0(h.webauthn.credential_options.publicKey,d?.create),{data:v,error:_}=await A0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}case"request":{const m=U0(h.webauthn.credential_options.publicKey,d?.request),{data:v,error:_}=await N0(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}}}catch(h){return Te(h)?{data:null,error:h}:{data:null,error:new ci("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new ls("rpId is required for WebAuthn authentication")};try{if(!ap())return{data:null,error:new ci("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!h)return{data:null,error:g};const{webauthn:p}=h;return this._verify({factorId:a,challengeId:h.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(h){return Te(h)?{data:null,error:h}:{data:null,error:new ci("Unexpected error in authenticate",h)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new ls("rpId is required for WebAuthn registration")};try{if(!ap())return{data:null,error:new ci("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this._enroll({friendlyName:a});if(!h)return await this.client.mfa.listFactors().then(v=>{var _;return(_=v.data)===null||_===void 0?void 0:_.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===a&&x.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:h.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(h){return Te(h)?{data:null,error:h}:{data:null,error:new ci("Unexpected error in register",h)}}}}m0();const D0={url:Rb,storageKey:kb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ub,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ip(o,a,s){return await s()}const nr={};class os{get jwks(){var a,s;return(s=(a=nr[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){nr[this.storageKey]=Object.assign(Object.assign({},nr[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=nr[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){nr[this.storageKey]=Object.assign(Object.assign({},nr[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},D0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=os.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,os.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&Lt()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new h0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Wp(d.fetch),this.lock=d.lock||ip,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:Lt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=p0:this.lock=ip,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new z0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:Zp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=np(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=np(this.memoryStorage)),Lt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Fp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(Lt()&&(s=Yb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),Lt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),qb(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:h,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",h,"redirect type",g),await this._saveSession(h),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return Te(s)?this._returnResult({error:s}):this._returnResult({error:new ci("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:Rn}),{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Te(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:_,options:x}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await Wi(this.storage,this.storageKey)),d=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:v,password:_,data:(s=x?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:b,code_challenge_method:w},xform:Rn})}else if("phone"in a){const{phone:v,password:_,options:x}=a;d=await Ue(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:_,data:(l=x?.data)!==null&&l!==void 0?l:{},channel:(u=x?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Rn})}else throw new kl("You must provide either an email or phone number and a password");const{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Te(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:h,options:g}=a;s=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else if("phone"in a){const{phone:d,password:h,options:g}=a;s=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else throw new kl("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Zi;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,h,g,p,m,v,_,x;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:N,wallet:O,statement:T,options:q}=a;let B;if(Lt())if(typeof O=="object")B=O;else{const ye=window;if("ethereum"in ye&&typeof ye.ethereum=="object"&&"request"in ye.ethereum&&typeof ye.ethereum.request=="function")B=ye.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!q?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=O}const Y=new URL((s=q?.url)!==null&&s!==void 0?s:window.location.href),E=await B.request({method:"eth_requestAccounts"}).then(ye=>ye).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=tm(E[0]);let D=(l=q?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!D){const ye=await B.request({method:"eth_chainId"});D=y0(ye)}const V={domain:Y.host,address:M,statement:T,uri:Y.href,version:"1",chainId:D,nonce:(u=q?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(h=(d=q?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(g=q?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=q?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=q?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=q?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=b0(V),w=await B.request({method:"personal_sign",params:[v0(b),M]})}try{const{data:N,error:O}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(x=a.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Rn});if(O)throw O;if(!N||!N.session||!N.user){const T=new Zi;return this._returnResult({data:{user:null,session:null},error:T})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:O})}catch(N){if(Te(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async signInWithSolana(a){var s,l,u,d,h,g,p,m,v,_,x,b;let w,N;if("message"in a)w=a.message,N=a.signature;else{const{chain:O,wallet:T,statement:q,options:B}=a;let Y;if(Lt())if(typeof T=="object")Y=T;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))Y=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");Y=T}const E=new URL((s=B?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in Y&&Y.signIn){const M=await Y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),q?{statement:q}:null));let D;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")D=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)D=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)w=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),N=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in Y)||typeof Y.signMessage!="function"||!("publicKey"in Y)||typeof Y!="object"||!Y.publicKey||!("toBase58"in Y.publicKey)||typeof Y.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,Y.publicKey.toBase58(),...q?["",q,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(u=(l=B?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=B?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((h=B?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((g=B?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((p=B?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((m=B?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((_=(v=B?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||_===void 0)&&_.length?["Resources",...B.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const M=await Y.signMessage(new TextEncoder().encode(w),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=M}}try{const{data:O,error:T}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:ui(N)},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Rn});if(T)throw T;if(!O||!O.session||!O.user){const q=new Zi;return this._returnResult({data:{user:null,session:null},error:q})}return O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),this._returnResult({data:Object.assign({},O),error:T})}catch(O){if(Te(O))return this._returnResult({data:{user:null,session:null},error:O});throw O}}async _exchangeCodeForSession(a){const s=await ii(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:h}=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:Rn});if(await ka(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!d||!d.session||!d.user){const g=new Zi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:h})}catch(d){if(Te(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:h}=a,g=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:h,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Rn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new Zi;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,h;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Wi(this.storage,this.storageKey));const{error:_}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:_})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Ue(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(h=p?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new kl("You must provide either an email or phone number.")}catch(g){if(Te(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:h,error:g}=await Ue(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:Rn});if(g)throw g;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,m=h.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(Te(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,h;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Wi(this.storage,this.storageKey));const m=await Ue(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:u0});return!((d=m.data)===null||d===void 0)&&d.url&&Lt()&&!(!((h=a.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(Te(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new On;const{error:u}=await Ue(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(Te(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:h}=await Ue(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:h,error:g}=await Ue(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:g})}throw new kl("You must provide either an email or phone number and a type")}catch(s){if(Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await ii(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<ou:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const h=await ii(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=du()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};a.user=s0(a.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Ua}):await this._useSession(async s=>{var l,u,d;const{data:h,error:g}=s;if(g)throw g;return!(!((l=h.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new On}:await Ue(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Ua})})}catch(s){if(Te(s))return Lb(s)&&(await this._removeSession(),await ka(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new On;const h=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await Wi(this.storage,this.storageKey));const{data:m,error:v}=await Ue(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:h.access_token,xform:Ua});if(v)throw v;return h.user=m.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(l){if(Te(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new On;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:h}=uu(a.access_token);if(h.exp&&(l=h.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(Te(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:h,error:g}=s;if(g)throw g;a=(l=h.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new On;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(Te(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!Lt())throw new Ul("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Ul(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Yg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ul("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Yg("No code detected.");const{data:q,error:B}=await this._exchangeCodeForSession(a.code);if(B)throw B;const Y=new URL(window.location.href);return Y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",Y.toString()),{data:{session:q.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:h,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!h||!m)throw new Ul("No session defined in URL");const v=Math.round(Date.now()/1e3),_=parseInt(g);let x=v+_;p&&(x=parseInt(p));const b=x-v;b*1e3<=ar&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${_}s`);const w=x-_;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,x,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,x,v);const{data:N,error:O}=await this._getUser(d);if(O)throw O;const T={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:_,expires_at:x,refresh_token:h,token_type:m,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:a.type},error:null})}catch(l){if(Te(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await ii(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const h=(l=u.session)===null||l===void 0?void 0:l.access_token;if(h){const{error:g}=await this.admin.signOut(h,a);if(g&&!(Mb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await ka(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Kb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:h}=s;if(h)throw h;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Wi(this.storage,this.storageKey,!0));try{return await Ue(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(Te(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(Te(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var h,g,p,m,v;const{data:_,error:x}=d;if(x)throw x;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Ue(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=_.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return Lt()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(Te(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:h,provider:g,token:p,access_token:m,nonce:v}=a,_=await Ue(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Rn}),{data:x,error:b}=_;return b?this._returnResult({data:{user:null,session:null},error:b}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Zi}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:b}))}catch(u){if(Te(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)throw h;return await Ue(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(Te(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Qb(async u=>(u>0&&await Fb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Ue(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Rn})),(u,d)=>{const h=200*Math.pow(2,u);return d&&cu(d)&&Date.now()+h-l<ar})}catch(l){if(this._debug(s,"error",l),Te(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),Lt()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await ii(this.storage,this.storageKey);if(u&&this.userStorage){let h=await ii(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:u.user},await ir(this.userStorage,this.storageKey+"-user",h)),u.user=(a=h?.user)!==null&&a!==void 0?a:du()}else if(u&&!u.user&&!u.user){const h=await ii(this.storage,this.storageKey+"-user");h&&h?.user?(u.user=h.user,await ka(this.storage,this.storageKey+"-user"),await ir(this.storage,this.storageKey,u)):u.user=du()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<ou;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${ou}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:h}=await this._callRefreshToken(u.refresh_token);h&&(console.error(h),cu(h)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:g}=await this._getUser(u.access_token);!g&&h?.user?(u.user=h.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(l,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new On;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Il;const{data:d,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!d.session)throw new On;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),Te(d)){const h={data:null,error:d};return cu(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(h),h}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],h=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(h),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await ir(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=Zg(u);await ir(this.storage,this.storageKey,d)}else{const u=Zg(s);await ir(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await ka(this.storage,this.storageKey),await ka(this.storage,this.storageKey+"-code-verifier"),await ka(this.storage,this.storageKey+"-user"),this.userStorage&&await ka(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&Lt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),ar);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/ar);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${ar}ms, refresh threshold is ${ju} ticks`),u<=ju&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof em)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Lt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,h]=await Wi(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(h)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Ue(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(Te(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)return this._returnResult({data:null,error:h});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Ue(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(Te(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?C0(a.webauthn.credential_response):T0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Ue(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(Te(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=await Ue(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(h.error)return h;const{data:g}=h;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:w0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:E0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(Te(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=uu(l.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Ue(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new On})})}catch(s){if(Te(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new On});const h=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&Lt()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(Te(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new On});const h=await Ue(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&Lt()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(Te(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Db>u)return l;const{data:d,error:h}=await Ue(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:h,raw:{header:g,payload:p}}=uu(l);s?.allowExpired||a0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:h},error:null}}const v=i0(u.alg),_=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,_,h,Pb(`${g}.${p}`)))throw new Eu("Invalid JWT signature");return{data:{claims:d,header:u,signature:h},error:null}}catch(l){if(Te(l))return this._returnResult({data:null,error:l});throw l}}}os.nextInstanceID={};const B0=os;class M0 extends B0{constructor(a){super(a)}}class L0{constructor(a,s,l){var u,d,h;this.supabaseUrl=a,this.supabaseKey=s;const g=Ob(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:jb,realtime:wb,auth:Object.assign(Object.assign({},Sb),{storageKey:p}),global:xb},v=Nb(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,v.global.fetch),this.fetch=Tb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(_=>this.realtime.setAuth(_)).catch(_=>console.warn("Failed to set initial Realtime auth token:",_)),this.rest=new Rv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new vb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Tv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:h,flowType:g,lock:p,debug:m,throwOnError:v},_,x){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),_),storageKey:h,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Jv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const q0=(o,a,s)=>new L0(o,a,s);function I0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}I0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const H0="https://sqwqlvsjtimallidxrsz.supabase.co",V0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",te=q0(H0,V0,{auth:{persistSession:!1}}),En=Object.freeze(Object.defineProperty({__proto__:null,default:te,supabase:te},Symbol.toStringTag,{value:"Module"}));function $0({onLogin:o}){const[a,s]=S.useState(""),[l,u]=S.useState(""),[d,h]=S.useState(null);async function g(p){p.preventDefault(),h(null);try{const{data:m,error:v}=await te.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){h("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){h("Credenciales invlidas");return}const _=m;if(_.password===l){const x={id:_.id,username:_.username,role:_.role};localStorage.setItem("user",JSON.stringify(x));try{console.debug("Login: stored localStorage.user =",x)}catch{}try{if(_.role==="cajero"){const{data:b,error:w}=await te.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",_.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}h("Inicio de sesin correcto"),typeof o=="function"&&o()}else h("Credenciales invlidas")}catch(m){h(m.message||"Error al consultar la base de datos")}}return r.jsx("div",{className:"login-root",children:r.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[r.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),r.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),r.jsxs("div",{className:"login-inner",children:[r.jsxs("form",{onSubmit:g,children:[r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"username",children:"Usuario"}),r.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"password",children:"Contrasea"}),r.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),r.jsx("div",{children:r.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&r.jsx("p",{style:{marginTop:12},children:d}),r.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",r.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function P0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),r.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function G0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!0),[d,h]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,x]=S.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=S.useState(()=>{try{const T=localStorage.getItem("user");if(T)return JSON.parse(T).username||"usuario"}catch{}return"usuario"});S.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(T=>T.json()).then(T=>{const q=T&&Array.isArray(T.ingresos)?T.ingresos:[],B=localStorage.getItem("ingresosEfectivo");let Y=[];try{B&&(Y=JSON.parse(B))}catch{}const E=[...q,...Y];s(E)}).catch(()=>{const T=localStorage.getItem("ingresosEfectivo");try{T&&s(JSON.parse(T))}catch{s([])}}).finally(()=>u(!1))},[]);function N(T){localStorage.setItem("ingresosEfectivo",JSON.stringify(T))}function O(T){if(T.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const q=a.length?Math.max(...a.map(E=>E.id))+1:1,B={id:q,factura:d||`F-${q}`,motivo:g,monto:Number(m),fechaHora:new Date(_).toISOString(),usuario:b},Y=[...a,B];s(Y),N(Y),h(""),p(""),v(""),x(new Date().toISOString().slice(0,16))}return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?r.jsx("p",{children:"Cargando..."}):r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),r.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),r.jsx("tbody",{children:a.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(T=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:{padding:8},children:T.factura}),r.jsx("td",{style:{padding:8},children:T.motivo}),r.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",T.monto.toFixed(2)]}),r.jsx("td",{style:{padding:8},children:new Date(T.fechaHora).toLocaleString()}),r.jsx("td",{style:{padding:8},children:T.usuario})]},T.id))})]})})]}),r.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),r.jsxs("form",{onSubmit:O,style:{display:"grid",gap:8},children:[r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",r.jsx("input",{value:d,onChange:T=>h(T.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",r.jsx("input",{value:g,onChange:T=>p(T.target.value),className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",r.jsx("input",{value:m,onChange:T=>v(T.target.value===""?"":Number(T.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",r.jsx("input",{value:_,onChange:T=>x(T.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",r.jsx("input",{value:b,onChange:T=>w(T.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[r.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),r.jsx("button",{type:"button",onClick:()=>{h(""),p(""),v(""),x(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function K0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!1),[d,h]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(!1),[_,x]=S.useState(!1),[b,w]=S.useState(null),N=async()=>{u(!0);try{const{data:Q,error:ge}=await te.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(ge)throw ge;const xe=Array.isArray(Q)?Q:[],L=Array.from(new Set(xe.map(C=>C.cliente_id).filter(Boolean)));let X={};if(L.length>0)try{const{data:C}=await te.from("clientes").select("id,nombre").in("id",L);if(Array.isArray(C))for(const k of C)X[String(k.id)]=k.nombre||""}catch(C){console.warn("Error cargando nombres de clientes:",C)}const ne=xe.map(C=>({...C,cliente_nombre:X[String(C.cliente_id)]||null}));s(ne)}catch(Q){console.warn("Error cargando cotizaciones:",Q),s([])}u(!1)};S.useEffect(()=>{N()},[]);const[O,T]=S.useState(null),[q,B]=S.useState(null),[Y,E]=S.useState(""),M=async Q=>{h(Q);try{const{data:ge,error:xe}=await te.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",Q).maybeSingle();if(xe&&console.warn("Error cargando cabecera de cotizacion",xe),T(ge||null),ge&&ge.cliente_id)try{const{data:ne}=await te.from("clientes").select("id,nombre").eq("id",ge.cliente_id).maybeSingle();B(ne?.nombre||null)}catch{B(null)}else B(null);const{data:L,error:X}=await te.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Q);if(X)throw X;p(Array.isArray(L)?L:[]),v(!0)}catch(ge){console.warn("Error cargando detalles de cotizacion",ge),p([])}},D=async Q=>{try{const{data:ge,error:xe}=await te.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Q.id),L=Array.isArray(ge)?ge:[],X={header:Q,detalles:L};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(X))}catch(ne){console.warn("No se pudo escribir localStorage",ne)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:X}))}catch{}o()}catch(ge){console.warn("Error cargando detalles para editar",ge)}},V=async Q=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:ge}=await te.from("cotizaciones_detalle").delete().eq("cotizacion_id",Q);ge&&console.warn("Error eliminando detalles:",ge);const{error:xe}=await te.from("cotizaciones").delete().eq("id",Q);if(xe)throw xe;N()}catch(ge){console.warn("Error eliminando cotizacion:",ge)}},ye=async()=>{if(b)try{const Q={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:ge}=await te.from("cotizaciones").update(Q).eq("id",b.id);if(ge&&console.warn("Error actualizando cotizacion:",ge),b.id){const{error:xe}=await te.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);xe&&console.warn("Error borrando detalles antiguos:",xe);const L=g.map(ne=>({...ne,cotizacion_id:b.id})),{error:X}=await te.from("cotizaciones_detalle").insert(L);X&&console.warn("Error insertando detalles actualizados:",X)}x(!1),N()}catch(Q){console.warn("Error guardando cotizacion editada:",Q)}};return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),r.jsxs("div",{children:[r.jsx("button",{onClick:N,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),r.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),r.jsx("input",{placeholder:"Nmero o cliente",value:Y,onChange:Q=>E(Q.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),r.jsx("button",{onClick:()=>E(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?r.jsx("div",{children:"Cargando..."}):a.length===0?r.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Nmero"}),r.jsx("th",{style:{padding:8},children:"Fecha"}),r.jsx("th",{style:{padding:8},children:"Usuario"}),r.jsx("th",{style:{padding:8},children:"Cliente ID"}),r.jsx("th",{style:{padding:8},children:"Total"}),r.jsx("th",{style:{padding:8},children:"Estado"}),r.jsx("th",{style:{padding:8},children:"Acciones"})]})}),r.jsx("tbody",{children:a.filter(Q=>{if(!Y)return!0;const ge=Y.toLowerCase(),xe=(Q.numero_cotizacion||"").toLowerCase(),L=(Q.cliente_nombre||"")?.toLowerCase(),X=(Q.usuario||"").toLowerCase();return xe.includes(ge)||L.includes(ge)||X.includes(ge)}).map(Q=>r.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[r.jsx("td",{style:{padding:8},children:Q.numero_cotizacion||""}),r.jsx("td",{style:{padding:8},children:Q.fecha_cotizacion?new Date(Q.fecha_cotizacion).toLocaleString():""}),r.jsx("td",{style:{padding:8},children:Q.usuario||""}),r.jsx("td",{style:{padding:8},children:Q.cliente_nombre||(Q.cliente_id?String(Q.cliente_id):"")}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.total||0).toFixed(2)]}),r.jsx("td",{style:{padding:8},children:Q.estado||""}),r.jsxs("td",{style:{padding:8},children:[r.jsx("button",{onClick:()=>M(Q.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(Q.estado||"").toLowerCase()==="aceptada"?r.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):r.jsx("button",{onClick:()=>D(Q),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),r.jsx("button",{onClick:()=>V(Q.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},Q.id))})]})]}),m&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),r.jsx("button",{onClick:()=>{v(!1),p([]),h(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[O&&r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Nmero:"})," ",O.numero_cotizacion]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Fecha:"})," ",O.fecha_cotizacion?new Date(O.fecha_cotizacion).toLocaleString():""]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Usuario:"})," ",O.usuario]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Cliente:"})," ",q??(O.cliente_id?String(O.cliente_id):"C/F")]})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Subtotal:"})," L ",Number(O.subtotal||0).toFixed(2)]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Impuesto:"})," L ",Number(O.impuesto||0).toFixed(2)]}),r.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[r.jsx("strong",{children:"Total:"})," L ",Number(O.total||0).toFixed(2)]})]})]}),r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Descripcin"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio U."}),r.jsx("th",{style:{padding:8},children:"Subtotal"}),r.jsx("th",{style:{padding:8},children:"Descuento"}),r.jsx("th",{style:{padding:8},children:"Total"})]})}),r.jsx("tbody",{children:g.map((Q,ge)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:Q.descripcion}),r.jsx("td",{style:{padding:8},children:Q.cantidad}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.precio_unitario||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.subtotal||(Q.precio_unitario||0)*(Q.cantidad||0)).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.descuento||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.total||(Q.subtotal||0)-(Q.descuento||0)).toFixed(2)]})]},ge))})]})]})]})}),_&&b&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),r.jsx("button",{onClick:()=>{x(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Cliente"}),r.jsx("input",{value:b.cliente||"",onChange:Q=>w({...b,cliente:Q.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"RTN"}),r.jsx("input",{value:b.rtn||"",onChange:Q=>w({...b,rtn:Q.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"SKU"}),r.jsx("th",{style:{padding:8},children:"Nombre"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio"}),r.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),r.jsx("tbody",{children:g.map((Q,ge)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:Q.sku}),r.jsx("td",{style:{padding:8},children:Q.nombre}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:Q.cantidad||0,onChange:xe=>{const L=Number(xe.target.value||0),X=[...g];X[ge]={...X[ge],cantidad:L},p(X)},style:{width:80,padding:6}})}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:Q.precio_unitario||0,onChange:xe=>{const L=Number(xe.target.value||0),X=[...g];X[ge]={...X[ge],precio_unitario:L},p(X)},style:{width:120,padding:6}})}),r.jsxs("td",{style:{padding:8},children:["L ",Number((Q.precio_unitario||0)*(Q.cantidad||0)).toFixed(2)]})]},ge))})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:()=>{x(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:ye,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function Y0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),r.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function J0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function F0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function Q0({open:o,onClose:a,onSelect:s}){const[l,u]=S.useState(""),[d,h]=S.useState(!1),[g,p]=S.useState([]);return S.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{h(!0);try{const{data:v,error:_}=await te.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(_)throw _;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&h(!1)}})(),()=>{m=!1}},[o]),S.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{h(!0);try{const v=String(l||"").trim();let _;if(v===""?_=await te.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):_=await te.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),_.error)throw _.error;p(Array.isArray(_.data)?_.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{h(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:r.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),r.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),r.jsx("th",{style:{padding:8}})]})}),r.jsxs("tbody",{children:[g.map(m=>r.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[r.jsx("td",{style:{padding:8},children:m.rtn}),r.jsx("td",{style:{padding:8},children:m.nombre}),r.jsx("td",{style:{padding:8},children:m.telefono}),r.jsx("td",{style:{padding:8},children:m.correo_electronico}),r.jsx("td",{style:{padding:8},children:r.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function X0({open:o,onClose:a,totalDue:s,onConfirm:l}){const[u,d]=S.useState(0),[h,g]=S.useState(0),[p,m]=S.useState(0);S.useEffect(()=>{o||(d(0),g(0),m(0))},[o]);const v=Number((Number(u)+Number(h)+Number(p)).toFixed(2)),_=Number((s-v).toFixed(2)),x=v>=s&&v>0,b=()=>{const w=[];u>0&&w.push(`efectivo:(${u.toFixed(2)})`),h>0&&w.push(`tarjeta:(${h.toFixed(2)})`),p>0&&w.push(`transferencia:(${p.toFixed(2)})`);const N=w.join(",");l({efectivo:u,tarjeta:h,transferencia:p,totalPaid:v,tipoPagoString:N}),a()};return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",r.jsxs("strong",{children:["L ",s.toFixed(2)]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Efectivo"}),r.jsx("input",{type:"number",value:u,onChange:w=>d(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Tarjeta"}),r.jsx("input",{type:"number",value:h,onChange:w=>g(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Transferencia"}),r.jsx("input",{type:"number",value:p,onChange:w=>m(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:r.jsxs("div",{children:[r.jsx("label",{children:"Total ingresado"}),r.jsxs("div",{style:{padding:8,borderRadius:6,border:"1px solid #e6edf3"},children:["L ",v.toFixed(2)]})]})})]}),r.jsx("div",{style:{marginTop:12},children:_>0?r.jsxs("div",{style:{color:"#ef4444"},children:["Falta: L ",_.toFixed(2)]}):r.jsxs("div",{style:{color:"#16a34a"},children:["Pago completo. Cambio/Exceso: L ",Math.abs(_).toFixed(2)]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:b,className:"btn-opaque",disabled:!x,style:{background:x?"#16a34a":"gray",color:"white"},children:"Confirmar pago"})]})]})]})}):null}function Z0({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:h}){return r.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:u}),r.jsx("th",{style:u,children:"Imagen"}),r.jsx("th",{style:u,children:"SKU"}),r.jsx("th",{style:u,children:"Nombre"}),r.jsx("th",{style:u,children:"Categora"}),r.jsx("th",{style:u,children:"Precio"}),r.jsx("th",{style:u,children:"Stock"}),r.jsx("th",{style:u,children:"Accin"})]})}),r.jsx("tbody",{children:o.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:d,children:r.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),r.jsx("td",{style:d,children:a[String(g.id)]?r.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?r.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),r.jsx("td",{style:d,children:r.jsx("code",{style:h,children:g.sku})}),r.jsx("td",{style:d,children:r.jsx("strong",{children:g.nombre})}),r.jsx("td",{style:d,children:r.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),r.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return r.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,_=v?p<1?"Agotado":"Sin precio":"Agregar";return r.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:_})})()})]},g.id))})]})})}function W0({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:h,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:_}){return r.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&r.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&r.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[r.jsx("span",{children:"Subtotal:"}),r.jsxs("span",{children:["L",u.toFixed(2)]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",color:"#16a34a",fontWeight:500},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsxs("div",{children:["ISV (",(h*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((x,b)=>x+(b.isv||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto 18%: ",r.jsxs("strong",{children:["L",Number(d.reduce((x,b)=>x+(b.imp18||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto turstico (",(p*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((x,b)=>x+(b.tur||0),0)).toFixed(2)]})]})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[r.jsx("span",{children:"TOTAL:"}),r.jsxs("span",{children:["L",m.toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:[r.jsxs("div",{children:["Tax rates: ISV ",(h*100).toFixed(2),"%, 18% ",(g*100).toFixed(2),"%, Tur ",(p*100).toFixed(2),"%"]}),r.jsxs("details",{style:{marginTop:6},children:[r.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),r.jsx("div",{style:{marginTop:8},children:d.map(x=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[r.jsxs("div",{style:{color:"#0f172a"},children:[x.nombre,"  L",x.price.toFixed(2)]}),r.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",x.isv.toFixed(2),"  18%: L",x.imp18.toFixed(2),"  Tur: L",x.tur.toFixed(2)]})]},String(x.id)))})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[r.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),r.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?r.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):r.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(x=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",x.producto.sku,"] ",x.producto.nombre]}),r.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(x.producto.precio||0).toFixed(2)," c/u"]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("button",{onClick:()=>a(x.producto.id,-1),style:_,children:""}),r.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:x.cantidad}),r.jsx("button",{onClick:()=>a(x.producto.id,1),style:_,children:"+"}),r.jsx("button",{onClick:()=>s(x.producto.id),style:{..._,background:"#ef4444"},children:""})]})]},x.producto.id))})]})}function e_({userName:o,userRole:a,userId:s,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:h}){const[g,p]=S.useState(!1),m=S.useRef(null);return S.useEffect(()=>{function v(_){m.current&&!m.current.contains(_.target)&&p(!1)}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]),r.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[r.jsx("h1",{style:{margin:0,fontSize:"1.4rem",fontWeight:600},children:"Solutecc  -  Caja"}),r.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[r.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),r.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""}),s!=null&&r.jsxs("div",{style:{fontSize:"0.75rem",color:"#cbd5e1",marginTop:2},children:["ID: ",String(s)]})]}),r.jsxs("div",{style:{position:"relative"},ref:m,children:[r.jsx("button",{onClick:()=>p(v=>!v),"aria-expanded":g,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),g&&r.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[r.jsx("button",{onClick:()=>{p(!1),d()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),r.jsx("button",{onClick:()=>{p(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),r.jsx("button",{onClick:()=>{p(!1),h("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),r.jsx("button",{onClick:()=>{p(!1),h("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),r.jsx("button",{onClick:()=>{p(!1),h("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),r.jsx("button",{onClick:()=>{p(!1),h("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),r.jsx("button",{onClick:()=>{p(!1),h("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),r.jsx("button",{onClick:()=>{p(!1),h("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function t_({open:o,onClose:a,width:s=520,children:l,zIndex:u=9999}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:r.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:s,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})}):null}function n_({open:o,onClose:a,caiInfo:s,onRefresh:l}){const[u,d]=Tu.useState(!1);return r.jsx(t_,{open:o,onClose:a,width:520,children:r.jsxs("div",{children:[r.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),r.jsxs("div",{style:{color:"#475569",marginTop:8},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"CAI:"})," ",s?.cai??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Identificador:"})," ",s?.identificador??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango desde:"})," ",s?.rango_de??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango hasta:"})," ",s?.rango_hasta??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Fecha lmite emisin:"})," ",s?.fecha_vencimiento??s?.fecha_limite_emision??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Secuencia actual:"})," ",s?.secuencia_actual??"-"]})]}),r.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),r.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(h){console.debug("Error calling onRefresh from DatosFacturaModal:",h)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function a_({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),r.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?r.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):r.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),r.jsxs("div",{style:{flex:1},children:[r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"SKU:"})," ",a.sku]}),r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),r.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),r.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:r.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):r.jsx("div",{children:r.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function i_({open:o,onClose:a,onCancel:s,onSave:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),r.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function r_({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:h,taxRate:g,taxableSubtotal:p}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:"Elige si la factura ser para Cliente Final o para un Cliente registrado. Cliente Final genera una factura inmediata lista para imprimir. Cliente Normal permite ingresar datos del cliente."}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[r.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Factura para consumidor final. No requiere RTN."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar nombre y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar razn social y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]})]})]}),r.jsxs("div",{style:{width:220,borderLeft:"1px dashed #e6edf3",paddingLeft:16,display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontWeight:700},children:"Resumen"}),r.jsxs("div",{style:{color:"#475569"},children:["Items: ",r.jsx("strong",{children:d})]}),r.jsxs("div",{style:{color:"#475569"},children:["SubTotal: ",r.jsxs("strong",{children:["L ",h.toFixed(2)]})]}),r.jsxs("div",{style:{color:"#475569"},children:["ISV (",(g*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L ",(p*g).toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:18,fontWeight:800},children:["Total: L ",(h+p*g).toFixed(2)]}),r.jsx("div",{style:{marginTop:12,fontSize:12,color:"#94a3b8"},children:"Seleccione una opcin para continuar."})]})]})}):null}function s_({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:h,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:_,onTelefonoChange:x,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:N,onCancel:O,onOpenCreateCliente:T,onOpenPayment:q,paymentDone:B,submitClienteNormal:Y}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{value:l,onChange:E=>v(E.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&r.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),r.jsx("input",{value:u,onChange:E=>_(E.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx(Q0,{open:p,onClose:()=>m(!1),onSelect:E=>{}}),r.jsx("button",{onClick:O,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:T,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),B?r.jsx("button",{onClick:Y,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):r.jsx("button",{onClick:q,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function l_({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:h,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:_,onCreate:x}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",r.jsx("strong",{children:"juridico"}),"."]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),r.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),r.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),r.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),r.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{id:"exon",type:"checkbox",checked:h,onChange:b=>_(b.target.checked)}),r.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:async()=>{await x()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})}):null}async function o_(){try{const{data:o,error:a}=await te.from("empresa").select("*").limit(1).maybeSingle();if(a)throw a;const s=o||null;if(!s)return null;try{const l=s.logo;if(!l)s.logoUrl=null;else if(String(l).startsWith("http"))s.logoUrl=String(l);else{const u="logo";try{const h=(await te.storage.from(u).getPublicUrl(String(l)))?.data?.publicUrl??null;if(h)s.logoUrl=h;else{const g=await te.storage.from(u).createSignedUrl(String(l),3600);s.logoUrl=g?.data?.signedUrl??null}}catch{const h="https://sqwqlvsjtimallidxrsz.supabase.co";let g=String(l);g.startsWith(`${u}/`)&&(g=g.slice(u.length+1)),s.logoUrl=`${h}/storage/v1/object/public/${u}/${encodeURIComponent(g)}`}}}catch{s.logoUrl=null}return s}catch(o){return console.warn("getCompanyData error",o),null}}async function rp(o={},a="factura",s={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const P=await o_();P&&(l=l||P.nombre||P.comercio||l,u=u||P.rtn||u,d=d||P.direccion||P.direccion_fiscal||d,h=h||P.telefono||P.telefono_fijo||h,g=g||P.email||P.correo||g,p=p||P.logoUrl||P.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const P=await fetch(String(p),{mode:"cors"});if(P.ok){const se=await P.blob(),_e=await new Promise(Oe=>{const De=new FileReader;De.onloadend=()=>{Oe(typeof De.result=="string"?De.result:null)},De.onerror=()=>{Oe(null)},De.readAsDataURL(se)});_e&&(p=_e)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",_=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",x=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let P=o.caiInfo||null;if(!P&&typeof window<"u"){const se=window.localStorage.getItem("caiInfo");if(se)try{P=JSON.parse(se)}catch{P=null}}if(P&&(v=v||P.cai||P.CAI||"",_=_||P.fecha_vencimiento||P.fecha_limite_emision||"",x=x||P.rango_de||P.rangoDesde||"",b=b||P.rango_hasta||P.rangoHasta||"",w=w||P.identificador||"",!m))try{const se=P.identificador?String(P.identificador):"",_e=P.secuencia_actual!=null?String(P.secuencia_actual):P.rango_de!=null?String(P.rango_de):"",Oe=String(_e).replace(/[^0-9]/g,"")||"";let De=0;(P.rango_hasta||P.rango_de)&&(De=Math.max(String(P.rango_hasta||P.rango_de).length,Oe.length));const ze=Oe?String(Oe).padStart(De||Oe.length||1,"0"):"";m=(se||"")+(ze||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const N=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),O=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||s.identidad||"C/F",T=new Date().toLocaleString(),q=Array.isArray(s.carrito)?s.carrito:[],B=typeof s.subtotal=="number"?s.subtotal:q.reduce((P,se)=>P+Number(se.producto&&se.producto.precio||se.precio||0)*(se.cantidad||1),0),Y=typeof s.descuento=="number"?s.descuento:0,E=typeof s.exonerado=="number"?s.exonerado:0,M=typeof s.gravado=="number"?s.gravado:B,D=typeof s.exento=="number"?s.exento:0,V=typeof s.isvTotal=="number"?s.isvTotal:0,ye=typeof s.imp18Total=="number"?s.imp18Total:0,Q=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,ge=typeof s.total=="number"?s.total:null,xe=B+(V||0)+(ye||0)+(Q||0),L=ge??xe,X=L,ne=s.pagos||{},C=typeof ne.efectivo=="number"?ne.efectivo:typeof s.Efectivo=="number"?s.Efectivo:0,k=typeof ne.tarjeta=="number"?ne.tarjeta:typeof s.Tarjeta=="number"?s.Tarjeta:0,ee=typeof ne.transferencia=="number"?ne.transferencia:typeof s.Transferencia=="number"?s.Transferencia:0,me=typeof ne.totalPaid=="number"?ne.totalPaid:C+k+ee;let ve;if(typeof ne.cambio=="number")ve=ne.cambio;else if(typeof s.cambio=="number")ve=s.cambio;else{const P=Number(me)-Number(X||0);ve=isNaN(P)?0:P>0?P:0}const z=q.map(P=>{const se=String(P.producto&&(P.producto.nombre||P.producto.descripcion)||P.descripcion||P.nombre||""),_e=Number(P.cantidad||0),Oe=Number((P.producto&&(P.producto.precio??P.producto.precio_unitario))??P.precio_unitario??P.precio??0),De=!!(P.producto&&P.producto.exento)||!!P.exento,ze=!!(P.producto&&P.producto.aplica_impuesto_18)||!!P.aplica_impuesto_18,Le=!!(P.producto&&P.producto.aplica_impuesto_turistico)||!!P.aplica_impuesto_turistico,Ke=ze?s.tax18Rate??s.tax18??0:s.taxRate??s.tax??0,gt=Le?s.taxTouristRate??s.taxTourist??0:0,vt=(Number(Ke)||0)+(Number(gt)||0);let bt=Oe;!De&&vt>0&&(bt=Oe/(1+vt));const Ot=Number(bt||0).toFixed(2),Jt=bt*_e,dt=Number(Jt||0).toFixed(2);return`<tr><td>${P.producto&&P.producto.sku||P.sku||""} ${se}</td><td style="text-align:center">${_e}</td><td style="text-align:right">L ${Ot}</td><td style="text-align:right">L ${dt}</td></tr>`}).join(`
`),$=(Number(C)||0)+(Number(ee)||0)+(Number(k)||0)-(Number(ve)||0),F=isNaN($)?0:$,pe=c_(F);return`
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Factura Detallada</title>
	<style>
		/* === 1. Estilos Base y Reset de Impresin === */
		@page {
			size: letter;
			margin: 0.5in; /* Reducido a 0.5in para mejor uso del espacio */
		}

		* {
			/* Mantener la configuracin de negrita y espaciado ajustado para factura */
			font-weight: bold !important;
			letter-spacing: 0 !important;
			word-spacing: 0 !important;
			margin: 0;
			padding: 0;
			line-height: 1.2 !important; /* Ligeramente aumentado para legibilidad */
			box-sizing: border-box;
		}

		body {
			font-family: 'Arial', sans-serif;
			font-size: 10px;
			color: #000;
			margin: 0;
			padding: 0;
		}

		/* === 2. Estructura Principal === */
		.factura-container {
			width: 100%;
			max-width: 8.5in;
			margin: 0 auto;
			padding: 0.25in; /* Espaciado interno general */
		}

		.divider {
			border: none;
			border-top: 1px solid #000;
			margin: 5px 0;
		}

		/* === 3. Encabezado de Factura === */
		.header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 10px;
		}

		.header img {
			width: 200px; /* Tamao ajustado para armona */
			height: auto;
			object-fit: contain;
			margin-right: 20px;
		}

		.header-title {
			font-size: 35px; /* Reducido ligeramente para balance */
			color: #0066CC;
			text-align: right;
			flex-grow: 1;
		}

		/* === 4. Secciones de Informacin === */
		.info-section h3, .info-section p {
			font-size: 11px;
			margin-bottom: 2px;
		}

		.info-dates {
			text-align: right;
			margin-bottom: 5px;
		}
		
		.info-dates p {
			font-size: 10px;
			margin: 1px 0;
		}

		/* === 5. Tabla de Productos === */
		.tabla {
			width: 100%;
			border-collapse: collapse;
			margin-top: 8px;
			font-size: 10px;
		}

		.tabla th, .tabla td {
			border: 1px solid #000;
			padding: 4px 6px; /* Aumentado para mejor legibilidad */
			text-align: left;
		}

		.tabla th {
			background-color: #555; /* Oscurecido a un gris ms formal */
			color: white;
			text-transform: uppercase;
		}

		.tabla td:nth-child(2), .tabla td:nth-child(3), .tabla td:nth-child(4) {
			text-align: right; /* Alineacin de nmeros */
		}

		/* === 6. Totales y Pagos === */
		.totals-section {
			margin-top: 5px;
			display: grid;
			grid-template-columns: 1fr 1fr; /* Para asegurar alineacin de etiquetas y valores */
			gap: 2px 0;
		}

		.totals-section p {
			display: contents; /* Permite que el span .right se alinee al final de la columna */
		}

		.totals-section span.label {
			text-align: left;
			padding-left: 2px;
		}

		.totals-section span.value {
			text-align: right;
			padding-right: 2px;
		}
		
		.total-final {
			font-size: 11px;
			margin-top: 5px;
			border-top: 1px solid #000;
			padding-top: 3px;
		}

		/* === 7. Pie de Factura === */
		.footer-info {
			text-align: center;
			margin-top: 10px;
			font-size: 10px;
		}
		
		.letras {
			font-size: 11px;
			margin: 5px 0;
			text-align: center;
		}

		.firma-section {
			margin-top: 15px;
			display: flex;
			justify-content: space-around;
			text-align: center;
		}

		.copias-info {
			text-align: center;
			margin-top: 8px;
		}

		.final-message {
			font-size: 10px;
			text-align: center;
			margin-top: 10px;
		}
		
		/* === 8. Media Print Overrides (Mejorado) === */
		@media print {
			.tabla th {
				/* Asegurar colores de encabezado de tabla en la impresin */
				background-color: #555 !important;
				color: white !important;
				-webkit-print-color-adjust: exact;
				print-color-adjust: exact;
			}
			.factura-container {
				box-shadow: none;
				border-radius: 0;
			}
			/* Se puede aadir ms ajustes si la impresin recorta elementos */
		}

			/* Forzar que navegadores impriman colores de fondo y estilos exactos */
			html, body, .factura-container, .header, .header-title, .header-title-container, .tabla, .tabla th, .totals-section, .total-final, .footer-info {
				-webkit-print-color-adjust: exact !important;
				print-color-adjust: exact !important;
				color-adjust: exact !important;
			}

			/* Reforzar en la regla de impresin para asegurar compatibilidad */
			@media print {
				.header-title { color: #0066CC !important; }
				.tabla th { background-color: #555 !important; color: #fff !important; }
				.totals-section, .total-final { background-color: transparent !important; }
			}
			.header-title-container {
    text-align: right;
}

.numero-factura {
    font-size: 24px;   /* Tamao grande */
    color: #000;       /* Negro */
    margin-top: -5px;  /* Ajuste opcional para acercarlo al ttulo */
}

	</style>
</head>
<body>
	<main class="factura-container">

		<header class="header">
    <img src="${p}" alt="Logo del Comercio" />
    <div class="header-title-container">
        <h1 class="header-title">FACTURA</h1>
        <h2 class="numero-factura">No. ${m}</h2>
    </div>
</header>

		<hr class="divider" />

		<section class="info-section">
			<h3>${l}</h3>
			<p>RTN: ${u}</p>
			<p>Direccin: ${d}</p>
			<p>Telfono: ${h}</p>
			<p>Email: ${g}</p>
		</section>
		<hr class="divider" />

		<section class="info-dates">
			<p>Fecha y hora: ${T}</p>
			<p>Factura No: ${m}</p>
			<p>CAI: ${v}</p>
			<p>Fecha lmite de emisin: ${_}</p>
			<p>Rango autorizado: ${w?w+" "+x+" al "+w+" "+b:x+" al "+b}</p>
		</section>
		<hr class="divider" />

		<section class="info-section">
			<p>Cliente: ${N}</p>
			<p>RTN Cliente: ${O}</p>
		</section>
		<hr class="divider" />

		<section class="details-section">
			<table class="tabla">
				<thead>
					<tr>
						<th>Descripcin</th>
						<th style="width: 10%;">Cant</th>
							<th style="width: 15%;">Precio unitario</th>
							<th style="width: 15%;">Total</th>
					</tr>
				</thead>
				<tbody>
					${z} </tbody>
			</table>
		</section>
		<hr class="divider" />

	<section class="totals-section">
    <span class="label">Descuento:</span> <span class="value">L ${Y.toFixed(2)}</span>
    <span class="label">Sub Total Exonerado:</span> <span class="value">L ${Number(E).toFixed(2)}</span>
    <span class="label">Sub Total Gravado:</span> <span class="value">L ${Number(M).toFixed(2)}</span>
    <span class="label">Sub Total Exento:</span> <span class="value">L ${Number(D).toFixed(2)}</span>
    <span class="label">Tasa Turstica 4%:</span> <span class="value">L ${Number(Q).toFixed(2)}</span>
    <span class="label">ISV 15%:</span> <span class="value">L ${Number(V).toFixed(2)}</span>
    <span class="label">ISV 18%:</span> <span class="value">L ${Number(ye).toFixed(2)}</span>
</section>

<section class="transaccion-section"><hr class="divider" />
    <span class="label">TOTAL TRANSACCIN:</span>
    <span class="value">L ${Number(L).toFixed(2)}</span>
</section>

<hr class="divider" />


		<section class="totals-section total-final">
			<span class="label">**TOTAL FACTURA:**</span> <span class="value">**L ${X.toFixed(2)}**</span>
			<span class="label">Efectivo:</span> <span class="value">L ${Number(C).toFixed(2)}</span>
			<span class="label">Tarjeta:</span> <span class="value">L ${Number(k).toFixed(2)}</span>
			<span class="label">Transferencia:</span> <span class="value">L ${Number(ee).toFixed(2)}</span>
			<span class="label">Cambio:</span> <span class="value">L ${Number(ve).toFixed(2)}</span>
		</section>
		<hr class="divider" />

		<footer class="footer-info">
			<div class="letras">
				<p>Total Pagado: L ${F.toFixed(2)}</p>
				<p>*** ${pe} Lempiras ***</p>
			</div>
			<hr class="divider" />
			
			<div class="firma-section">
				<p>Firma del Cliente: ______________________</p>
				<p>Firma del Emisor: ______________________</p>
			</div>
			
			<div class="copias-info">
				<p>Original: Cliente | Copia: Obligado tributario emisor</p>
			</div>
			
			<div class="final-message">
				<h5>Para cualquier reclamo debe presentar su factura</h5>
				<h5>Gracias por su compra!</h5>
				<h5>LA FACTURA ES BENEFICIO DE TODOS EXJALA!</h5>
			</div>
		</footer>

	</main>
</body>
</html>`}function c_(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const _=Math.floor(v/10),x=v%10;return s[_]+(x?" y "+a[x]:"")}if(v<1e3){const _=Math.floor(v/100),x=v%100;return(_===1&&x===0?"cien":l[_]||"")+(x?" "+u(x):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let _=u(v);m===2&&v===1&&(_="un"),h.unshift(_+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}function u_({onLogout:o}){S.useEffect(()=>{const H=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=H||""}},[]);const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,h]=S.useState(""),[g,p]=S.useState("Todas"),[m,v]=S.useState(.15),[_,x]=S.useState(0),[b,w]=S.useState(0),N=["Todas",...Array.from(new Set(a.map(H=>H.categoria)))],O=a.filter(H=>(String(H.nombre||"").toLowerCase().includes(d.toLowerCase())||String(H.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||H.categoria===g)),T=l.reduce((H,ae)=>H+Number(ae.producto.precio||0)*ae.cantidad,0);let q=0,B=0,Y=0;for(const H of l){const ae=Number(H.producto.precio||0)*H.cantidad,be=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,ue=!!H.producto.aplica_impuesto_turistico;if(be)continue;const fe=oe?_||0:m||0,de=ue&&b||0,je=(Number(fe)||0)+(Number(de)||0);if(je<=0)continue;const Z=ae-ae/(1+je);oe?B+=Z*(fe/je):q+=Z*(fe/je),ue&&(Y+=Z*(de/je))}const E=T,M=Math.max(0,T-(q+B+Y)),D=l.map(H=>{const ae=Number(H.producto.precio||0)*H.cantidad,be=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,ue=!!H.producto.aplica_impuesto_turistico;if(be)return{id:H.producto.id,nombre:H.producto.nombre,price:ae,isv:0,imp18:0,tur:0,totalTax:0};const fe=oe?_||0:m||0,de=ue&&b||0,je=(Number(fe)||0)+(Number(de)||0);if(je<=0)return{id:H.producto.id,nombre:H.producto.nombre,price:ae,isv:0,imp18:0,tur:0,totalTax:0};const Z=ae-ae/(1+je),he=oe?0:Z*(fe/je),Ne=oe?Z*(fe/je):0,Ce=ue?Z*(de/je):0;return{id:H.producto.id,nombre:H.producto.nombre,price:ae,isv:he,imp18:Ne,tur:Ce,totalTax:he+Ne+Ce}}),V=H=>{const ae=Number(H.stock??0),be=Number(H.precio??0);ae<1||be<=0||u(oe=>oe.find(fe=>fe.producto.id===H.id)?oe.map(fe=>fe.producto.id===H.id?{...fe,cantidad:fe.cantidad+1}:fe):[...oe,{producto:H,cantidad:1}])},ye=(H,ae)=>{u(be=>be.map(oe=>{if(String(oe.producto.id)===String(H)){const ue=oe.cantidad+ae;return ue>0?{...oe,cantidad:ue}:oe}return oe}).filter(oe=>oe.cantidad>0))},Q=H=>{u(ae=>ae.filter(be=>String(be.producto.id)!==String(H)))},ge=()=>u([]),[xe,L]=S.useState(!1),[X,ne]=S.useState("factura"),[C,k]=S.useState(!1),[ee,me]=S.useState(null),[ve,A]=S.useState(null),[z,$]=S.useState(!1),[F,pe]=S.useState(!1),[re,P]=S.useState(""),[se,_e]=S.useState(""),Oe=S.useRef(null),De=S.useRef(null),[ze,Le]=S.useState("final"),[Ke,gt]=S.useState(""),[vt,bt]=S.useState(""),[Ot,Jt]=S.useState(!1),[dt,et]=S.useState(!1),[Da,di]=S.useState(!1),[Vt,cr]=S.useState(!1),[ur,fi]=S.useState(null),[hi,us]=S.useState(!1),ds=async H=>{if(_e(H),!H||String(H).trim()===""){P("");return}try{if(ze==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",H);const{data:ue,error:fe}=await te.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",H).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:ue,error:fe}),!fe&&ue&&ue.nombre){P(ue.nombre||""),gt(ue.telefono||""),bt(ue.correo_electronico||""),Jt(!!ue.exonerado),setTimeout(()=>{try{De.current?.focus()}catch{}},50);return}else{P(""),gt(""),bt(""),Jt(!1);return}}const ae="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",H);const{data:be,error:oe}=await te.from(ae).select("nombre").eq("rtn",H).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:be,error:oe}),!oe&&be&&be.nombre?(P(be.nombre||""),setTimeout(()=>{try{De.current?.focus()}catch{}},50)):P("")}catch(ae){console.warn("Error buscando cliente por RTN:",ae)}},Hl=H=>{if(H==="cotizacion"){ne("cotizacion"),L(!0);return}ne(H),L(!0)},Vl=async(H={})=>{try{if(!l||l.length===0)return null;const ae=Un(),be=q,oe=B,ue=Y,fe=Number(be||0)+Number(oe||0)+Number(ue||0),de=ae+fe;let je=H.cliente_id??null;if(!je&&H.rtn)try{const{data:st,error:ot}=await te.from("clientes").select("id").eq("rtn",H.rtn).maybeSingle();!ot&&st&&st.id&&(je=st.id)}catch{}const Z=qa||"system",he=String(Math.floor(Math.random()*9e5)+1e5),Ne={cliente_id:je,usuario:Z,numero_cotizacion:he,validez_dias:30,subtotal:ae,impuesto:fe,total:de,estado:"pendiente"};let Ce=H.cotizacion_id??ve;if(Ce){const st={cliente_id:Ne.cliente_id||null,usuario:Ne.usuario,validez_dias:Ne.validez_dias,subtotal:Ne.subtotal,impuesto:Ne.impuesto,total:Ne.total,estado:Ne.estado},{error:ot}=await te.from("cotizaciones").update(st).eq("id",Ce);if(ot)return console.warn("Error actualizando cotizacion:",ot),null}else{const{data:st,error:ot}=await te.from("cotizaciones").insert([Ne]).select("id").maybeSingle();if(ot)return console.warn("Error insertando cotizacion:",ot),null;if(Ce=st?.id||null,!Ce)return null}const Ie=l.map(st=>{const ot=Number(st.producto.precio||0),ft=Number(st.cantidad||0),gn=!!st.producto.exento,Ft=!!st.producto.aplica_impuesto_18,nn=!!st.producto.aplica_impuesto_turistico,Kt=gn||Ft?0:ot*(m||0)*ft,vi=gn?0:Ft?ot*(_||0)*ft:0,Ia=gn?0:nn?ot*(b||0)*ft:0,pn=ot*ft,Be=pn+Kt+vi+Ia;return{cotizacion_id:Ce,producto_id:st.producto.id||null,descripcion:st.producto.nombre||"",cantidad:ft,precio_unitario:ot,subtotal:pn,descuento:0,total:Be}});try{await te.from("cotizaciones_detalle").delete().eq("cotizacion_id",Ce)}catch{}const{error:Mn}=await te.from("cotizaciones_detalle").insert(Ie);return Mn?console.warn("Error insertando cotizaciones_detalle:",Mn):console.debug("Cotizacion guardada id=",Ce),Ce}catch(ae){return console.warn("Error guardando cotizacion:",ae),null}},Un=()=>{const H=l.reduce((ue,fe)=>ue+Number(fe.producto.precio||0)*fe.cantidad,0);let ae=0,be=0,oe=0;for(const ue of l){const fe=Number(ue.producto.precio||0)*ue.cantidad,de=!!ue.producto.exento,je=!!ue.producto.aplica_impuesto_18,Z=!!ue.producto.aplica_impuesto_turistico;if(de)continue;const he=je?_||0:m||0,Ne=Z&&b||0,Ce=(Number(he)||0)+(Number(Ne)||0);if(Ce<=0)continue;const Ie=fe-fe/(1+Ce);je?be+=Ie*(he/Ce):ae+=Ie*(he/Ce),Z&&(oe+=Ie*(Ne/Ce))}return Math.max(0,H-(ae+be+oe))},$t=()=>l.reduce((H,ae)=>H+(ae.producto.exento?0:Number(ae.producto.precio||0)*ae.cantidad),0),zn=async()=>{Le("final"),P("Consumidor Final"),_e("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),us(!0),di(!0),L(!1)},Pt=()=>{Le("normal"),P(""),_e(""),cr(!1),fi(null),$(!0),L(!1)},$l=()=>{Le("juridico"),P(""),_e(""),cr(!1),fi(null),$(!0),L(!1)},Pl=async(H,ae,be)=>{const oe=await rp({cliente:H,rtn:ae},X,{carrito:l,subtotal:Un(),isvTotal:q,imp18Total:B,impTouristTotal:Y,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,pagos:be});if(X==="factura"&&ve)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",ve);const{error:fe}=await te.from("cotizaciones").update({estado:"aceptada"}).eq("id",ve);if(fe)console.warn("Error marcando cotizacion (pre-print):",fe);else try{A(null)}catch{}}catch(fe){console.warn("Error marcacion pre-print:",fe)}if(X==="factura")try{let fe=null,de=null;try{const je=localStorage.getItem("user"),Z=je?JSON.parse(je):null;de=Z&&(Z.id||Z.user?.id||Z.sub||Z.user_id)?Z.id||Z.user?.id||Z.sub||Z.user_id:null;const he=Z&&(Z.username||Z.user?.username||Z.name||Z.user?.name)?Z.username||Z.user?.username||Z.name||Z.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",je),console.debug("PV: CAI lookup - parsed user object:",Z),console.debug("PV: CAI lookup - extracted userId:",de,"typeof",typeof de),console.debug("PV: CAI lookup - extracted userNameFromStorage:",he),de){const Ne=typeof de=="string"&&/^\d+$/.test(de)?Number(de):de;try{const{data:Ce,error:Ie}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Ne).order("id",{ascending:!1}).limit(1);!Ie&&Array.isArray(Ce)&&Ce.length>0&&(fe=Ce[0])}catch(Ce){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Ce)}}if(!fe&&he)try{const{data:Ne,error:Ce}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",he).order("id",{ascending:!1}).limit(1);!Ce&&Array.isArray(Ne)&&Ne.length>0&&(fe=Ne[0])}catch(Ne){console.debug("PV: CAI lookup by cajero failed:",Ne)}}catch(je){console.debug("No se pudo cargar CAI desde frontend:",je)}await fs({clienteName:H,rtn:ae,paymentPayload:be,caiData:fe,usuarioId:de})}catch(fe){console.warn("Error preparando venta antes de imprimir:",fe),alert("Error preparando venta antes de imprimir: "+String(fe))}const ue=window.open("","_blank");if(ue){ue.document.open(),ue.document.write(oe),ue.document.close();const fe=()=>{try{ue.focus(),ue.print()}catch(je){console.warn("Error during print (finalize):",je)}setTimeout(()=>{try{ue.close()}catch{}},800)},de=()=>{try{const je=ue.document.images;if(je&&je.length>0){let Z=0;for(let he=0;he<je.length;he++){const Ne=je[he];Ne.complete?Z++:(Ne.addEventListener("load",()=>{Z++,Z===je.length&&fe()}),Ne.addEventListener("error",()=>{Z++,Z===je.length&&fe()}))}Z===je.length&&fe()}else fe()}catch{try{ue.addEventListener("load",fe)}catch{}setTimeout(fe,1e3)}};try{ue.document.readyState==="complete"?de():(ue.addEventListener("load",de),setTimeout(de,1500))}catch{setTimeout(de,800)}}X==="factura"&&(ge(),await Ba()),X==="cotizacion"&&(me({cliente:H,rtn:ae}),k(!0))},fs=async({clienteName:H,rtn:ae,paymentPayload:be,caiData:oe,usuarioId:ue})=>{if(!l||l.length===0)return null;const fe=be&&be.tipoPagoString?String(be.tipoPagoString):"",de=be&&be.totalPaid?Number(be.totalPaid||0):0,je=de>Number(E||0)?de-Number(E||0):0;let Z=String(Math.floor(Math.random()*9e5)+1e5);const he=yi||oe||null;let Ne=null,Ce=0,Ie=null,Mn=null;if(he&&(he.rango_de!==void 0||he.secuencia_actual!==void 0))try{const Be=he.rango_de!=null?String(he.rango_de):"",Xe=he.rango_hasta!=null?String(he.rango_hasta):"",Rt=he.secuencia_actual!=null?String(he.secuencia_actual):"",Re=Number(String(Be).replace(/[^0-9]/g,""))||0,tt=Number(String(Xe).replace(/[^0-9]/g,""))||0,qt=Number(String(Rt).replace(/[^0-9]/g,""))||Re||0;Ce=Math.max((Xe||Be||"").length,String(qt).length,1),Mn=String(qt).padStart(Ce,"0"),Z=(he.identificador?String(he.identificador):"")+Mn;const $n=qt+1;Ne=$n,Ie=String($n).padStart(Ce,"0")}catch(Be){console.debug("Error computing factura from caiInfoState, falling back to random:",Be)}const st={rtn:ae||null,nombre_cliente:H||null,usuario:qa||"system",factura:Z,tipo_pago:fe,subtotal:Number(M||0),impuesto:Number(q+B+Y||0),total:Number(E||0),estado:"pagada",cambio:String(Number(je).toFixed(2)),cai:he?.cai??null,rango_desde:(he&&he.identificador?String(he.identificador):"")+(he?.rango_de!=null?String(he.rango_de):"")||null,rango_hasta:(he&&he.identificador?String(he.identificador):"")+(he?.rango_hasta!=null?String(he.rango_hasta):"")||null,fecha_limite_emision:he?.fecha_vencimiento??he?.fecha_limite_emision??null};let ot=null,ft=null;try{const Be=await te.from("ventas").insert([st]).select("id, factura");ot=Be.data??Be,ft=Be.error??null}catch(Be){ft=Be}if(console.debug("Insert venta response:",{ventaInsRaw:ot,ventaErr:ft}),ft){const Be=String(ft&&(ft.message||ft.msg||ft.details)||""),Xe=ft&&ft.code?String(ft.code):"";if(Xe==="PGRST204"||Be.includes("Could not find the")||/column .* of 'ventas'/.test(Be)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:Be,code:Xe});const Re={...st};delete Re.cai,delete Re.rango_desde,delete Re.rango_hasta,delete Re.fecha_limite_emision;try{const tt=await te.from("ventas").insert([Re]).select("id, factura");if(ot=tt.data??tt,ft=tt.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:ot,ventaErr:ft}),ft)throw ft}catch(tt){throw console.error("Fallback insert also failed:",tt),tt}}else throw ft}const gn=Array.isArray(ot)?ot[0]:ot;let Ft=gn?gn.id||gn.id:null;if(!Ft)try{const{data:Be,error:Xe}=await te.from("ventas").select("id").eq("factura",Z).maybeSingle();Xe&&console.debug("Error buscando venta por factura (fallback):",Xe),Be&&Be.id&&(Ft=Be.id)}catch(Be){console.debug("fallback lookup error",Be)}if(!Ft)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",ot),null;const nn=l.map(Be=>{const Xe=Number(Be.producto.precio||0),Rt=Number(Be.cantidad||0),Re=Xe*Rt,tt=0,qt=Re-tt;return{venta_id:Ft,factura:Z,producto_id:Be.producto.id,cantidad:Rt,precio_unitario:Xe,subtotal:Re,descuento:tt,total:qt}});if(oe&&ue&&(Be=>typeof Be=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Be))(ue))try{const Be=l.map(Re=>({producto_id:String(Re.producto.id),cantidad:Number(Re.cantidad||0),precio_unitario:Number(Re.producto.precio||0),subtotal:Number((Number(Re.producto.precio||0)*Re.cantidad).toFixed(6)),descuento:0,total:Number((Number(Re.producto.precio||0)*Re.cantidad).toFixed(6))})),{data:Xe,error:Rt}=await te.rpc("create_venta_with_detalle",{p_usuario_id:ue,p_usuario:qa||ue,p_rtn:ae||null,p_nombre_cliente:H||null,p_tipo_pago:fe,p_subtotal:Number(M||0),p_impuesto:Number(q+B+Y||0),p_total:Number(E||0),p_cambio:String(Number(je).toFixed(2)),p_detalles:Be});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:Xe,rpcErr:Rt}),Rt)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",Rt);else if(Xe&&Array.isArray(Xe)&&Xe.length>0){const Re=Xe[0];try{if(he&&he.id!=null)try{const{data:tt,error:qt}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",he.id).maybeSingle();if(!qt&&tt){Dn(tt);try{localStorage.setItem("caiInfo",JSON.stringify(tt))}catch{}}}catch(tt){console.debug("Error refreshing cai after RPC:",tt)}}catch(tt){console.debug("Error during post-RPC cai refresh:",tt)}return Re.venta_id||Re.venta_id===0?Re.venta_id:Ft}else if(Xe&&Xe.venta_id){try{if(he&&he.id!=null)try{const{data:Re,error:tt}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",he.id).maybeSingle();if(!tt&&Re){Dn(Re);try{localStorage.setItem("caiInfo",JSON.stringify(Re))}catch{}}}catch(Re){console.debug("Error refreshing cai after RPC (scalar):",Re)}}catch(Re){console.debug("Error during post-RPC cai refresh (scalar):",Re)}return Xe.venta_id}}catch(Be){console.warn("Error calling RPC create_venta_with_detalle:",Be)}else oe&&ue&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",ue);const{data:vi,error:Ia}=await te.from("ventas_detalle").insert(nn).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:vi,detErr:Ia}),Ia)throw Ia;const pn=he&&(he.id||he.id===0)?he.id:null;if(pn!=null&&Ne!=null)try{const Be=Ie??String(Ne);try{const Xe=he?.rango_hasta!=null?String(he.rango_hasta):"",Rt=Number(Xe.replace(/[^0-9]/g,""))||null,Re=Number(String(Be).replace(/[^0-9]/g,""))||null;if(Rt!=null&&Re!=null&&Re>Rt)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:Re,rangoHastaNum:Rt});else{const{error:tt}=await te.from("cai").update({secuencia_actual:Be}).eq("id",pn);if(tt)console.debug("Error updating cai.secuencia_actual (manual path):",tt);else{console.debug("Updated cai.secuencia_actual to",Be,"for cai id",pn);try{const qt={...he||{},secuencia_actual:Be};Dn(qt);try{localStorage.setItem("caiInfo",JSON.stringify(qt))}catch{}}catch(qt){console.debug("Error updating local caiInfoState/localStorage:",qt)}}}}catch(Xe){console.debug("Validation error while checking rango_hasta:",Xe);const{error:Rt}=await te.from("cai").update({secuencia_actual:Be}).eq("id",pn);if(Rt)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",Rt);else{console.debug("Updated cai.secuencia_actual to",Be,"for cai id",pn);try{const Re={...he||{},secuencia_actual:Be};Dn(Re);try{localStorage.setItem("caiInfo",JSON.stringify(Re))}catch{}}catch(Re){console.debug("Error updating local caiInfoState/localStorage (after validation):",Re)}}}}catch(Be){console.debug("Exception updating cai.secuencia_actual:",Be)}return Ft},Ba=async()=>{if(X==="factura"&&ve)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",ve);const{error:H}=await te.from("cotizaciones").update({estado:"aceptada"}).eq("id",ve);H?console.warn("Error marcando cotizacion como facturado:",H):console.debug("Cotizacion marcada como facturado:",ve)}catch(H){console.warn("Error procesando cotizacion tras facturar",H)}};S.useEffect(()=>{z&&setTimeout(()=>{try{Oe.current?.focus()}catch{}},80)},[z]);const gi=async()=>{try{if(se&&re){const oe={rtn:se,nombre:re},{error:ue}=await te.from("clientenatural").upsert(oe,{onConflict:"rtn"});ue&&console.warn("Error guardando clientenatural:",ue)}}catch(oe){console.warn("Error upsert clientenatural:",oe)}try{if(se&&re)if(ze==="juridico"){const{data:oe,error:ue}=await te.from("clientes").select("id").eq("rtn",se).eq("tipo_cliente","juridico").maybeSingle();if(ue&&console.warn("Error buscando cliente juridico:",ue),oe&&oe.id){const{error:fe}=await te.from("clientes").update({nombre:re,telefono:Ke||null,correo_electronico:vt||null,exonerado:Ot}).eq("id",oe.id);fe&&console.warn("Error actualizando cliente juridico:",fe)}else{const{error:fe}=await te.from("clientes").insert([{nombre:re,rtn:se,telefono:Ke||null,correo_electronico:vt||null,tipo_cliente:"juridico",exonerado:Ot}]);fe&&console.warn("Error insertando cliente juridico:",fe)}}else{const oe={rtn:se,nombre:re},{error:ue}=await te.from("clientenatural").upsert(oe,{onConflict:"rtn"});ue&&console.warn("Error guardando clientenatural:",ue)}}catch(oe){console.warn("Error upsert cliente:",oe)}const H=await rp({cliente:re||"Cliente",rtn:se||""},X,{carrito:l,subtotal:Un(),isvTotal:q,imp18Total:B,impTouristTotal:Y,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,pagos:ur});if(X==="factura"&&ve)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",ve);const{error:oe}=await te.from("cotizaciones").update({estado:"aceptada"}).eq("id",ve);if(oe)console.warn("Error marcando cotizacion como facturado (pre-print):",oe);else{console.debug("Cotizacion marcada como facturado (pre-print):",ve);try{A(null)}catch{}}}catch(oe){console.warn("Error marcacion pre-print:",oe)}if(X==="factura")try{let oe=null,ue=null;try{const fe=localStorage.getItem("user"),de=fe?JSON.parse(fe):null;ue=de&&(de.id||de.user?.id||de.sub||de.user_id)?de.id||de.user?.id||de.sub||de.user_id:null;const je=de&&(de.username||de.user?.username||de.name||de.user?.name)?de.username||de.user?.username||de.name||de.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",fe),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",de),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",ue,"typeof",typeof ue),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",je),ue){const Z=typeof ue=="string"&&/^\d+$/.test(ue)?Number(ue):ue;try{const{data:he,error:Ne}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Z).order("id",{ascending:!1}).limit(1);!Ne&&Array.isArray(he)&&he.length>0&&(oe=he[0])}catch(he){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",he)}}if(!oe&&je)try{const{data:Z,error:he}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",je).order("id",{ascending:!1}).limit(1);!he&&Array.isArray(Z)&&Z.length>0&&(oe=Z[0])}catch(Z){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",Z)}}catch(fe){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",fe)}await fs({clienteName:re||"Cliente",rtn:se||null,paymentPayload:ur,caiData:oe,usuarioId:ue})}catch(oe){console.warn("Error insertando venta en flujo cliente normal:",oe)}const ae=window.open("","_blank");if(ae){ae.document.open(),ae.document.write(H),ae.document.close();const oe=()=>{try{ae.focus(),ae.print()}catch(fe){console.warn("Error during print (cliente normal):",fe)}setTimeout(()=>{try{ae.close()}catch{}},800)},ue=()=>{try{const fe=ae.document.images;if(fe&&fe.length>0){let de=0;for(let je=0;je<fe.length;je++){const Z=fe[je];Z.complete?de++:(Z.addEventListener("load",()=>{de++,de===fe.length&&oe()}),Z.addEventListener("error",()=>{de++,de===fe.length&&oe()}))}de===fe.length&&oe()}else oe()}catch{try{ae.addEventListener("load",oe)}catch{}setTimeout(oe,1e3)}};try{ae.document.readyState==="complete"?ue():(ae.addEventListener("load",ue),setTimeout(ue,1500))}catch{setTimeout(ue,800)}}await(async()=>{X==="factura"&&(ge(),await Ba()),X==="cotizacion"&&(me({cliente:re||"Cliente",rtn:se||null}),k(!0))})(),$(!1)},[hn,Gt]=S.useState(null),[Ma,La]=S.useState([]),[Gl,pi]=S.useState(!1),[dr,Vn]=S.useState(null);S.useEffect(()=>{fetch("/data-base/inventario.json").then(async H=>{if(!H.ok)return console.warn("inventario.json no disponible, status",H.status),null;const ae=H.headers.get("content-type")||"";if(!ae.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",ae),null;try{return await H.json()}catch(be){return console.warn("Error parseando inventario.json:",be),null}}).then(H=>{H&&Array.isArray(H.items)&&La(H.items),console.log("inventario cargado:",H&&H.items?H.items.length:0)}).catch(H=>{console.warn("Error cargando inventario:",H)})},[]),S.useEffect(()=>{let H=!0;return(async()=>{try{const{data:ae,error:be}=await te.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(be)throw be;const oe=Array.isArray(ae)?ae:[],ue=oe.map(Z=>String(Z.id));if(ue.length===0){H&&s([]);return}const fe={};try{const{data:Z,error:he}=await te.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(he)throw he;if(console.debug("PV: precios total rows",Array.isArray(Z)?Z.length:0),Array.isArray(Z))for(const Ne of Z){const Ce=String(Ne.producto_id);fe[Ce]||(fe[Ce]=Number(Ne.precio||0))}}catch(Z){console.warn("Error cargando precios en PV:",Z)}let de={};try{const{data:Z,error:he}=await te.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",ue);if(he)throw he;const Ne=Array.isArray(Z)?Z:[];de={},ue.forEach(Ce=>de[Ce]=0);for(const Ce of Ne){const Ie=String(Ce.producto_id),Mn=Number(Ce.cantidad)||0,st=String(Ce.tipo_de_movimiento||"").toUpperCase();st==="ENTRADA"?de[Ie]=(de[Ie]||0)+Mn:st==="SALIDA"&&(de[Ie]=(de[Ie]||0)-Mn)}}catch(Z){console.warn("Error cargando registro_de_inventario en PV:",Z),de={},ue.forEach(he=>de[he]=0)}console.debug("PV: priceMap sample",Object.keys(fe).slice(0,5).map(Z=>[Z,fe[Z]]));const je=oe.map(Z=>({id:String(Z.id),sku:Z.sku,nombre:Z.nombre,categoria:Z.categoria,imagen:Z.imagen,precio:fe[String(Z.id)]!==void 0?fe[String(Z.id)]:Z.precio!==void 0?Number(Z.precio):0,exento:Z.exento===!0||String(Z.exento)==="true"||Number(Z.exento)===1||!1,aplica_impuesto_18:Z.aplica_impuesto_18===!0||String(Z.aplica_impuesto_18)==="true"||Number(Z.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:Z.aplica_impuesto_turistico===!0||String(Z.aplica_impuesto_turistico)==="true"||Number(Z.aplica_impuesto_turistico)===1||!1,stock:Number((de[String(Z.id)]||0).toFixed(2))}));H&&s(je)}catch(ae){console.warn("Error cargando productos desde inventario:",ae),H&&s([])}})(),()=>{H=!1}},[]),S.useEffect(()=>{const H=be=>{try{const oe=be||(()=>{const de=localStorage.getItem("cotizacion_to_load");return de?JSON.parse(de):null})();if(!oe)return;try{A(oe.header&&oe.header.id?String(oe.header.id):null)}catch{}const fe=(Array.isArray(oe.detalles)?oe.detalles:[]).map(de=>{const je=a.find(he=>String(he.id)===String(de.producto_id));return{producto:je?{...je}:{id:String(de.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:de.sku??void 0,nombre:de.descripcion||de.nombre||"Artculo",precio:Number(de.precio_unitario||de.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(de.cantidad||1)}});fe.length>0&&u(fe);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};H();const ae=be=>{try{H(be.detail)}catch{}};return window.addEventListener("cotizacion:load",ae),()=>{window.removeEventListener("cotizacion:load",ae)}},[a]);const[qa,hs]=S.useState(null),[gs,ps]=S.useState(null),[mi,fr]=S.useState(null),[yi,Dn]=S.useState(null),[Bn,jt]=S.useState(!1),[Ut,oa]=S.useState({}),hr=async()=>{try{let H=null;try{const ae=localStorage.getItem("user"),be=ae?JSON.parse(ae):null;let oe=mi??(be&&(be.id||be.user?.id||be.sub||be.user_id)?be.id||be.user?.id||be.sub||be.user_id:null);const ue=qa??(be&&(be.username||be.user?.username||be.name||be.user?.name)?be.username||be.user?.username||be.name||be.user?.name:null),fe=oe!=null&&typeof oe=="string"&&/^\d+$/.test(oe)?Number(oe):oe;if(fe!=null)try{const{data:de,error:je}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",fe).order("id",{ascending:!1}).limit(1);!je&&Array.isArray(de)&&de.length>0&&(H=de[0])}catch(de){console.debug("refreshCaiInfo: lookup by usuario_id failed:",de)}if(!H&&ue)try{const{data:de,error:je}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",ue).order("id",{ascending:!1}).limit(1);!je&&Array.isArray(de)&&de.length>0&&(H=de[0])}catch(de){console.debug("refreshCaiInfo: lookup by cajero failed:",de)}}catch(ae){console.debug("refreshCaiInfo: error building lookup params",ae)}if(H){Dn(H);try{localStorage.setItem("caiInfo",JSON.stringify(H))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",H)}}catch(H){console.debug("refreshCaiInfo: unexpected error",H)}};S.useEffect(()=>{try{const H=localStorage.getItem("user");if(H){const ae=JSON.parse(H);hs(ae.username||ae.name||null),ps(ae.role||null);let be=null;try{be=ae&&(ae.id||ae.user?.id||ae.sub||ae.user_id)?ae.id||ae.user?.id||ae.sub||ae.user_id:null,fr(be??null),console.debug("PV: localStorage.user parsed:",ae),console.debug("PV: extracted userId for CAI/RPC usage:",be)}catch(oe){console.debug("PV: error parsing localStorage.user for debug:",oe)}try{const oe=localStorage.getItem("caiInfo");if(oe){const ue=JSON.parse(oe);Dn(ue),console.debug("PV: loaded caiInfo from localStorage:",ue),(async()=>{try{if(!(ue&&ue.rango_de!==void 0&&ue.rango_hasta!==void 0&&ue.fecha_vencimiento!==void 0&&ue.secuencia_actual!==void 0)){const de=ae&&(ae.username||ae.user?.username||ae.name||ae.user?.name)?ae.username||ae.user?.username||ae.name||ae.user?.name:null,je=be&&typeof be=="string"&&/^\d+$/.test(be)?Number(be):be;let Z=null;try{if(je!=null){const{data:he,error:Ne}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",je).order("id",{ascending:!1}).limit(1);!Ne&&Array.isArray(he)&&he.length>0&&(Z=he[0])}}catch(he){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",he)}if(!Z&&de)try{const{data:he,error:Ne}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",de).order("id",{ascending:!1}).limit(1);!Ne&&Array.isArray(he)&&he.length>0&&(Z=he[0])}catch(he){console.debug("PV: refetch CAI by cajero failed:",he)}if(Z){Dn(Z);try{localStorage.setItem("caiInfo",JSON.stringify(Z))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",Z)}}}catch(fe){console.debug("PV: error trying to refresh caiInfo:",fe)}})()}}catch(oe){console.debug("PV: error parsing localStorage.caiInfo:",oe)}}}catch{}},[]),S.useEffect(()=>{let H=!0;return(async()=>{try{const{data:ae,error:be}=await te.from("impuesto").select("id, impuesto_venta");if(be)throw be;if(!ae||!Array.isArray(ae))return;const oe=je=>{const Z=ae.find(Ce=>Number(Ce.id)===je);if(!Z)return null;const he=Z.impuesto_venta;if(he==null)return null;const Ne=Number(he);return Number.isNaN(Ne)?null:Ne>1?Ne/100:Ne},ue=oe(1),fe=oe(2),de=oe(3);if(H){let je=ue,Z=fe,he=de;try{if((je===null||je===0)&&H){const Ce=(await te.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Ie=Ce==null?null:Number(Ce);Ie!=null&&!Number.isNaN(Ie)&&(je=Ie>1?Ie/100:Ie)}if((Z===null||Z===0)&&H){const Ce=(await te.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Ie=Ce==null?null:Number(Ce);Ie!=null&&!Number.isNaN(Ie)&&(Z=Ie>1?Ie/100:Ie)}if((he===null||he===0)&&H){const Ce=(await te.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Ie=Ce==null?null:Number(Ce);Ie!=null&&!Number.isNaN(Ie)&&(he=Ie>1?Ie/100:Ie)}}catch(Ne){console.warn("PV: fallback single-id impuesto fetch failed",Ne)}(je===null||je===0)&&(je=.15),(Z===null||Z===0)&&(Z=.18),(he===null||he===0)&&(he=.04),v(je),x(Z),w(he),console.debug("PV: impuestos raw rows",ae),console.debug("PV: resolved tax rates",{taxRate:je,tax18Rate:Z,taxTouristRate:he})}}catch(ae){console.warn("Error cargando impuesto en PV:",ae)}})(),()=>{H=!1}},[]);const Kl=H=>{console.log("openUbicacion",H,"entradasCount",Ma.length);let ae=null;try{ae=a.find(oe=>String(oe.sku||"")===String(H)||String(oe.id)===String(H))||null}catch{ae=null}if(ae){const oe=Number(ae.stock??0),ue={id:ae.id,producto:ae.nombre||"",sku:ae.sku||"",imagen:ae.imagen||null,descripcion:ae.descripcion||"",ubicacion:ae.ubicacion||null,cantidad:oe};Vn(ue),pi(!0);return}const be=Ma.find(oe=>oe.sku===H)||null;console.log("entrada encontrada",be),Vn(be),pi(!0)};if(S.useEffect(()=>{let H=!0;return(async()=>{try{const ae="inventario",be={};await Promise.all((a||[]).map(async oe=>{const ue=oe.imagen;if(!ue){be[String(oe.id)]=null;return}const fe=String(ue);if(fe.startsWith("http")){be[String(oe.id)]=fe;return}let de=fe;const je=String(fe).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);je&&(de=decodeURIComponent(je[2]));try{const Z=await te.storage.from(ae).getPublicUrl(de),he=Z?.data?.publicUrl||Z?.data?.publicURL||null;if(he){be[String(oe.id)]=he;return}}catch{}try{const he=(await te.storage.from(ae).createSignedUrl(de,604800))?.data?.signedUrl??null;be[String(oe.id)]=he}catch{be[String(oe.id)]=null}})),H&&oa(be)}catch(ae){console.warn("Error resolviendo imgenes en PV",ae)}})(),()=>{H=!1}},[a]),hn){if(hn==="DevolucionCaja")return r.jsx(P0,{onBack:()=>Gt(null)});if(hn==="IngresoEfectivo")return r.jsx(G0,{onBack:()=>Gt(null)});if(hn==="CotizacionesGuardadas")return r.jsx(K0,{onBack:()=>Gt(null)});if(hn==="PedidosEnLinea")return r.jsx(Y0,{onBack:()=>Gt(null)});if(hn==="CorteCajaParcial")return r.jsx(J0,{onBack:()=>Gt(null)});if(hn==="CorteCajaTotal")return r.jsx(F0,{onBack:()=>Gt(null)})}return r.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[r.jsx(e_,{userName:qa,userRole:gs,userId:mi,caiInfo:yi,onLogout:o,onNavigate:H=>Gt(H),onOpenDatosFactura:()=>jt(!0)}),r.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[r.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:H=>h(H.target.value),onKeyDown:H=>{if(H.key==="Enter"){const ae=String(d||"").trim().toLowerCase();if(!ae)return;const oe=O.find(ue=>String(ue.sku||"").toLowerCase()===ae)||O[0];if(oe){const ue=Number(oe.stock??0),fe=Number(oe.precio??0);ue>=1&&fe>0?V(oe):console.debug("No se puede agregar por stock/precio",{id:oe.id,stockNum:ue,precioNum:fe})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),r.jsx("select",{value:g,onChange:H=>p(H.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:N.map(H=>r.jsx("option",{value:H,children:H},H))})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:r.jsx(Z0,{productos:O,imageUrls:Ut,agregarAlCarrito:V,openUbicacion:Kl,thStyle:d_,tdStyle:f_,skuStyle:h_})}),r.jsx(W0,{carrito:l,actualizarCantidad:ye,eliminarDelCarrito:Q,vaciarCarrito:ge,subtotal:M,perItemTaxes:D,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,openSelector:Hl,btnStyle:g_})]})]}),r.jsx(a_,{open:Gl,selectedEntrada:dr,onClose:()=>{pi(!1),Vn(null)},imageUrls:Ut}),r.jsx(X0,{open:Da,totalDue:E,onClose:()=>di(!1),onConfirm:async H=>{if(fi(H),cr(!0),hi)try{us(!1),await Pl("Consumidor Final","C/F",H)}catch(ae){console.warn("Error facturando despus del pago:",ae)}di(!1)}}),r.jsx(i_,{open:C,onClose:()=>k(!1),onCancel:()=>{k(!1),me(null)},onSave:async()=>{k(!1);try{const H=await Vl(ee||{});H&&A(String(H))}catch(H){console.warn("Error guardando cotizacion desde confirm modal",H)}me(null)}}),r.jsx(r_,{open:xe,onClose:()=>L(!1),doFacturaClienteFinal:zn,doFacturaClienteNormal:Pt,doFacturaClienteJuridico:$l,carritoLength:l.length,subtotal:Un(),taxRate:m,taxableSubtotal:$t()}),r.jsx(s_,{open:z,onClose:()=>$(!1),clienteTipo:ze,clienteRTN:se,clienteNombre:re,clienteTelefono:Ke,clienteCorreo:vt,clienteExonerado:Ot,clienteSearchOpen:F,setClienteSearchOpen:H=>pe(H),onRTNChange:H=>ds(H),onNombreChange:H=>P(H),onTelefonoChange:H=>gt(H),onCorreoChange:H=>bt(H),onExoneradoChange:H=>Jt(H),onCreateCliente:()=>et(!0),onCancel:()=>$(!1),onOpenCreateCliente:()=>et(!0),onOpenPayment:()=>di(!0),paymentDone:Vt,submitClienteNormal:gi}),r.jsx(l_,{open:dt,onClose:()=>et(!1),clienteRTN:se,clienteNombre:re,clienteTelefono:Ke,clienteCorreo:vt,clienteExonerado:Ot,onChangeRTN:H=>_e(H),onChangeNombre:H=>P(H),onChangeTelefono:H=>gt(H),onChangeCorreo:H=>bt(H),onChangeExonerado:H=>Jt(H),onCreate:async()=>{try{if(!re||!se)return;const{data:H,error:ae}=await te.from("clientes").select("id").eq("rtn",se).maybeSingle();if(ae&&console.warn("Error buscando cliente al crear:",ae),H&&H.id){const{error:be}=await te.from("clientes").update({nombre:re,telefono:Ke||null,correo_electronica:vt||null,tipo_cliente:"juridico",exonerado:Ot}).eq("id",H.id);be&&console.warn("Error actualizando cliente al crear:",be)}else{const{error:be}=await te.from("clientes").insert([{nombre:re,rtn:se,telefono:Ke||null,correo_electronica:vt||null,tipo_cliente:"juridico",exonerado:Ot}]);be&&console.warn("Error insertando cliente al crear:",be)}}catch(H){console.warn("Error creando cliente juridico:",H)}et(!1)}}),r.jsx(n_,{open:Bn,onClose:()=>jt(!1),caiInfo:yi,onRefresh:hr})]})}const d_={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},f_={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},h_={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},g_={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},sp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function p_({title:o,children:a}){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:o}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function m_(){const[o,a]=S.useState(null);return S.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Ventas (ltimos das)"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Flujo de caja"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Inventario por categora"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Promedios"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):r.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const y_="modulepreload",v_=function(o){return"/"+o},lp={},Cn=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(_=>Promise.resolve(_).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};var h=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=v_(v),v in lp)return;lp[v]=!0;const _=v.endsWith(".css"),x=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${x}`))return;const b=document.createElement("link");if(b.rel=_?"stylesheet":y_,_||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),_)return new Promise((w,N)=>{b.addEventListener("load",w),b.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function am({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:h="Cancelar"}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),r.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:h}),r.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function b_(){const[o,a]=S.useState(null),[s,l]=S.useState(!1),[u,d]=S.useState(!1),[h,g]=S.useState({}),[p,m]=S.useState(null),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,N]=S.useState(!1),[O,T]=S.useState(null),[q,B]=S.useState(null),[Y,E]=S.useState(!1),[M,D]=S.useState(""),[V,ye]=S.useState(""),[Q,ge]=S.useState(null),[xe,L]=S.useState(null);S.useEffect(()=>{let z=!0;return(async()=>{l(!0);try{const $=(await Cn(async()=>{const{default:re}=await Promise.resolve().then(()=>En);return{default:re}},void 0)).default,{data:F,error:pe}=await $.from("empresa").select("*").limit(1).single();if(!z)return;if(pe)throw pe;if(F){a(F),g(F);try{localStorage.setItem("companyData",JSON.stringify(F))}catch{}l(!1);return}}catch($){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",$)}try{const $=localStorage.getItem("companyData");if($){a(JSON.parse($)),g(JSON.parse($)),l(!1);return}}catch{}try{const $=await fetch("/data-base/company.json");if(!$.ok)throw new Error("no json");const F=await $.json();if(!z)return;a(F),g(F)}catch{z&&a(null)}finally{z&&l(!1)}})(),()=>{z=!1}},[]),S.useEffect(()=>{o&&g(o)},[o]),S.useEffect(()=>{try{const z=localStorage.getItem("pendingCompanySave");if(z){const $=JSON.parse(z);_(!0),b($.payload??null),N(!!$.needsLogo)}}catch{}},[]),S.useEffect(()=>{let z=!0;return(async()=>{try{if(!o||!o.logo){z&&ge(null);return}const $=String(o.logo);if($.startsWith("http")){z&&ge($);return}const F=(await Cn(async()=>{const{default:Oe}=await Promise.resolve().then(()=>En);return{default:Oe}},void 0)).default,pe="logo",P=(await F.storage.from(pe).getPublicUrl($))?.data?.publicUrl??null;if(P){z&&ge(P);return}const _e=(await F.storage.from(pe).createSignedUrl($,3600))?.data?.signedUrl??null;if(_e){z&&ge(_e);return}z&&ge(null)}catch($){console.warn("Error resolving company logo URL",$),z&&ge(null)}})(),()=>{z=!1}},[o?.logo]),S.useEffect(()=>{let z=!0;return(async()=>{try{if(p){z&&L(p);return}const $=h?.logo;if(!$){z&&L(null);return}const F=String($);if(F.startsWith("http")){z&&L(F);return}const pe=(await Cn(async()=>{const{default:De}=await Promise.resolve().then(()=>En);return{default:De}},void 0)).default,re="logo",se=(await pe.storage.from(re).getPublicUrl(F))?.data?.publicUrl??null;if(se){z&&L(se);return}const Oe=(await pe.storage.from(re).createSignedUrl(F,3600))?.data?.signedUrl??null;if(Oe){z&&L(Oe);return}z&&L(null)}catch($){console.warn("Error resolving edit logo URL",$),z&&L(null)}})(),()=>{z=!1}},[h?.logo,p]);function X(){d(!0),g(o||{})}function ne(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function C(z){const{name:$,value:F}=z.target;g(pe=>({...pe,[$]:F}))}function k(z){const $=z.target.files?.[0]??null;if(g(F=>({...F,logoFile:$})),$)try{const F=URL.createObjectURL($);m(F)}catch{m(null)}else m(null)}function ee(z=!1){const $="logo",F="https://sqwqlvsjtimallidxrsz.supabase.co";if(z){if(p)return p;const P=h?.logo;if(!P)return"/logo192.png";if(String(P).startsWith("http"))return String(P);let se=String(P);return se.startsWith(`${$}/`)&&(se=se.slice($.length+1)),`${F}/storage/v1/object/public/${$}/${encodeURIComponent(se)}`}if(!o)return"/logo192.png";const pe=o.logo;if(!pe)return"/logo192.png";if(String(pe).startsWith("http"))return String(pe);let re=String(pe);return re.startsWith(`${$}/`)&&(re=re.slice($.length+1)),`${F}/storage/v1/object/public/${$}/${encodeURIComponent(re)}`}async function me(){try{const z=(await Cn(async()=>{const{default:se}=await Promise.resolve().then(()=>En);return{default:se}},void 0)).default,$={...h||{}};let F=null;const pe=se=>{if(!se)return null;if(!se.startsWith("http"))return se;const _e=se.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return _e?decodeURIComponent(_e[2]):null},re=o?.logo??null;try{const se=h&&h.logoFile instanceof File?h.logoFile:null,_e="logo";if(se){const De=`logo/${$.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${se.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,ze=await z.storage.from(_e).upload(De,se,{upsert:!0});if(ze.error)throw ze.error;const Le=ze.data?.path??De;F=Le,$.logo=Le}}catch(se){console.warn("Logo upload error",se)}try{$.logoFile&&delete $.logoFile}catch{}let P=null;try{if(o&&o.id){const{data:se,error:_e}=await z.from("empresa").update($).eq("id",o.id).select("*");if(_e)throw _e;P=Array.isArray(se)?se[0]??null:se}else{const{data:se,error:_e}=await z.from("empresa").insert($).select("*");if(_e)throw _e;P=Array.isArray(se)?se[0]??null:se}try{if(F){const se=pe(re);if(se&&se!==F){const Oe=await z.storage.from("logo").remove([se]);Oe.error&&console.warn("Failed to remove old company logo after DB update",Oe.error)}}}catch(se){console.warn("Error removing old logo after DB success",se)}}catch(se){try{if(F){const Oe=await z.storage.from("logo").remove([F]);Oe.error&&console.warn("Failed to remove uploaded logo after DB error",Oe.error)}}catch(_e){console.warn("Error cleaning uploaded logo after DB failure",_e)}throw se}a(P),g(P);try{console.debug("Empresa guardada, logo field:",P?.logo)}catch{}try{B(P?.logo??null)}catch{}try{D("Datos guardados"),ye("Los datos de la empresa se guardaron correctamente."),E(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(P))}catch{}d(!1)}catch(z){console.error("Error guardando empresa en Supabase",z);try{T(z?.message||String(z))}catch{}try{const $={...h||{}};$.logoFile&&delete $.logoFile;const F=!!(h&&h.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:$,needsLogo:F,ts:Date.now()})),_(!0),b($),N(F),a(h);try{localStorage.setItem("companyData",JSON.stringify(h))}catch{}d(!1),D("Guardado localmente"),ye("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),E(!0)}catch($){console.error("Error saving locally",$)}}}async function ve(){const z=x;if(!z){D("Sin pendientes"),ye("No hay datos pendientes para enviar"),E(!0);return}try{const $=(await Cn(async()=>{const{default:pe}=await Promise.resolve().then(()=>En);return{default:pe}},void 0)).default;let F=null;if(z.id){const{data:pe,error:re}=await $.from("empresa").update(z).eq("id",z.id).select("*");if(re)throw re;F=Array.isArray(pe)?pe[0]??null:pe}else{const{data:pe,error:re}=await $.from("empresa").insert(z).select("*");if(re)throw re;F=Array.isArray(pe)?pe[0]??null:pe}localStorage.removeItem("pendingCompanySave"),_(!1),b(null),N(!1),a(F),g(F),D("Sincronizado"),ye("Los datos pendientes se sincronizaron con Supabase correctamente."),E(!0)}catch($){console.error("Error reenviando datos pendientes",$),D("Error al reenviar"),ye("No se pudo reenviar los datos a Supabase: "+($?.message||String($))),E(!0)}}function A(){try{localStorage.removeItem("pendingCompanySave"),_(!1),b(null),N(!1),D("Pendiente descartado"),ye("El guardado pendiente fue descartado."),E(!0)}catch{}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?r.jsx("div",{children:"Cargando datos de la empresa..."}):o?r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?r.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",O?r.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(O)]}):null,w?r.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn-primary",onClick:ve,children:"Reintentar guardar en Supabase"}),r.jsx("button",{className:"btn-opaque",onClick:A,children:"Descartar pendiente"})]})]})}):null,q?r.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[r.jsx("strong",{children:"Logo guardado:"}),r.jsxs("div",{style:{marginTop:6},children:[r.jsx("a",{href:ee(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),r.jsx("div",{style:{color:"#374151",fontSize:12},children:String(q)})]})]}):null,r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:r.jsx("img",{src:u?xe??ee(!0):Q??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),r.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"RTN:"})," ",u?r.jsx("input",{name:"rtn",value:h.rtn||"",onChange:C,className:"input"}):o.rtn]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Telfono:"})," ",u?r.jsx("input",{name:"telefono",value:h.telefono||"",onChange:C,className:"input"}):o.telefono]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Correo:"})," ",u?r.jsx("input",{name:"email",value:h.email||"",onChange:C,className:"input"}):o.email]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Direccin:"})," ",u?r.jsx("textarea",{name:"direccion",value:h.direccion||"",onChange:C,className:"input",style:{minHeight:64}}):o.direccion]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Logo (archivo o URL):"}),u?r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[r.jsx("input",{type:"file",accept:"image/*",onChange:k}),r.jsx("input",{name:"logo",value:h.logo||"",onChange:C,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):r.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?r.jsxs("div",{style:{marginTop:8},children:[r.jsx("small",{children:"Preview:"}),r.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:me,className:"btn-primary",children:"Guardar"}),r.jsx("button",{type:"button",onClick:ne,className:"btn-opaque",children:"Cancelar"})]}):r.jsx(r.Fragment,{children:r.jsx("button",{type:"button",onClick:X,className:"btn-primary",children:"Actualizar datos"})})})]}),r.jsx("div",{style:{flex:1,minWidth:320},children:r.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:r.jsx("img",{src:u?xe??ee(!0):Q??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),r.jsxs("p",{style:{margin:0},children:["RTN: ",r.jsx("strong",{children:o.rtn})]}),r.jsxs("p",{style:{margin:0},children:["Telfono: ",r.jsx("strong",{children:o.telefono})]}),r.jsxs("p",{style:{marginTop:8},children:["Correo: ",r.jsx("strong",{children:o.email})]}),r.jsxs("p",{style:{marginTop:8},children:["Direccin: ",r.jsx("strong",{children:o.direccion})]})]})})]}):r.jsx("div",{children:"No se encontraron datos de la empresa."}),r.jsx(am,{open:Y,title:M,message:V,onClose:()=>E(!1)})]})}function __(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function x_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[x,b]=S.useState(""),[w,N]=S.useState(null),[O,T]=S.useState(""),[q,B]=S.useState(""),[Y,E]=S.useState("");async function M(){l(!0),d(null);try{const{data:L,error:X}=await te.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(X)throw X;a(Array.isArray(L)?L:[])}catch(L){d(L?.message||String(L)),a([])}finally{l(!1)}}async function D(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const L={username:p,password:v,role:"cajero"};x&&(L.nombre_usuario=x);const{error:X}=await te.from("users").insert(L);if(X)throw X;m(""),_(""),b(""),await M()}catch(L){d(L?.message||String(L))}finally{l(!1)}}function V(L){N(L.id),T(L.username||""),E(L.nombre_usuario||""),B(""),d(null)}function ye(){N(null),T(""),B(""),E(""),d(null)}async function Q(){if(w!=null){if(!O)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const L={username:O};q&&(L.password=q),L.nombre_usuario=Y||null;const{error:X}=await te.from("users").update(L).eq("id",w);if(X)throw X;ye(),await M()}catch(L){d(L?.message||String(L))}finally{l(!1)}}}async function ge(L,X){if(X!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:ne}=await te.from("users").delete().eq("id",L);if(ne)throw ne;await M()}catch(ne){d(ne?.message||String(ne))}finally{l(!1)}}}S.useEffect(()=>{let L=!0;return(async()=>L&&await M())(),()=>{L=!1}},[]);const xe=o.filter(L=>{if(!h)return!0;const X=h.toLowerCase();return(L.username||"").toLowerCase().includes(X)||(String(L.id)||"").includes(X)||(L.role||"").toLowerCase().includes(X)||(L.nombre_usuario||"").toLowerCase().includes(X)});return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[r.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:h,onChange:L=>g(L.target.value),style:{minWidth:220}}),r.jsx("button",{onClick:()=>M(),className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${xe.length} usuarios`}),r.jsx("div",{style:{width:"100%",height:8}}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:L=>m(L.target.value)}),r.jsx("input",{placeholder:"Nombre",className:"input",value:x,onChange:L=>b(L.target.value)}),r.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:L=>_(L.target.value)}),r.jsx("button",{onClick:()=>D(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?r.jsx("div",{style:{color:"red",marginBottom:12},children:u}):r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"})]})}),r.jsx("tbody",{children:xe.map(L=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:L.id}),r.jsx("td",{style:{minWidth:180},children:w===L.id?r.jsx("input",{className:"input",value:O,onChange:X=>T(X.target.value)}):L.username||"-"}),r.jsx("td",{style:{minWidth:180},children:w===L.id?r.jsx("input",{className:"input",value:Y,onChange:X=>E(X.target.value)}):L.nombre_usuario||"-"}),r.jsx("td",{style:{width:220},children:w===L.id?r.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:q,onChange:X=>B(X.target.value)}):L.role||"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:w===L.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Q(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),r.jsx("button",{onClick:()=>ye(),className:"btn-opaque",children:"Cancelar"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>V(L),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),L.role==="cajero"?r.jsx("button",{onClick:()=>ge(L.id,L.role),className:"btn-danger",children:"Eliminar"}):r.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},L.id))})]}),xe.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function j_({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:h}){const[g,p]=S.useState(null),[m,v]=S.useState(null),[_,x]=S.useState(!1),[b,w]=S.useState(null),[N,O]=S.useState(""),[T,q]=S.useState(""),[B,Y]=S.useState(""),[E,M]=S.useState(""),[D,V]=S.useState(null),[ye,Q]=S.useState(""),[ge,xe]=S.useState(!1),[L,X]=S.useState(null);if(S.useEffect(()=>{if(!o||!s)return;w(s.caja??null),O(s.cai??""),Q(s.identificador??""),q(s.rango_de??""),Y(s.rango_hasta??""),M(s.fecha_vencimiento??""),V(s.secuencia_actual??null);const C=s.cajero??null;if(C){const k=l.find(ee=>ee.username===C||ee.nombre_usuario===C);k?(p(k.id),v(null),x(!1)):(p(null),v(C),x(!0))}else p(null),v(null),x(!1);X(null)},[o,s,l]),!o||!s)return null;async function ne(){if(!s){X("Registro invlido");return}if(b!=null&&(b<1||b>5)){X("La caja debe estar entre 1 y 5");return}xe(!0),X(null);try{const C={cai:N??null,identificador:ye??null,rango_de:T??null,rango_hasta:B??null,fecha_vencimiento:E??null,secuencia_actual:D??null,caja:b??null};if(g!=null){const k=l.find(ee=>ee.id===g);C.cajero=k?k.username:null,C.usuario_id=k?k.id:null}else C.cajero=m??null,C.usuario_id=null;await h(s.id,C),a()}catch(C){X(C?.message||String(C))}finally{xe(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:N,onChange:C=>O(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),r.jsx("input",{className:"input",value:ye,onChange:C=>Q(C.target.value),placeholder:"Identificador (opcional)"}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:T,onChange:C=>q(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:B,onChange:C=>Y(C.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:E,onChange:C=>M(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),r.jsx("input",{className:"input",value:D??"",onChange:C=>V(C.target.value===""?null:C.target.value),placeholder:"0"}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):_?"__custom__":"",onChange:C=>{const k=C.target.value;k===""?(p(null),v(null),x(!1)):k==="__custom__"?(p(null),x(!0)):/^\d+$/.test(k)&&(p(Number(k)),v(null),x(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(C=>r.jsxs("option",{value:String(C.id),children:[C.username,C.nombre_usuario?`  ${C.nombre_usuario}`:""]},C.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),_&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:C=>{v(C.target.value),p(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:C=>w(C.target.value===""?null:Number(C.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(C=>r.jsx("option",{value:C,children:C},C))]})]})]})]})]}),L&&r.jsx("div",{style:{color:"red",marginTop:12},children:L}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:ge,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ne,disabled:ge,style:{width:"auto",padding:"8px 14px"},children:ge?"Guardando...":"Guardar"})]})]})})}function S_({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[h,g]=S.useState(null),[p,m]=S.useState(null),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,N]=S.useState(""),[O,T]=S.useState(""),[q,B]=S.useState(""),[Y,E]=S.useState(""),[M,D]=S.useState(null),[V,ye]=S.useState(""),[Q,ge]=S.useState(!1),[xe,L]=S.useState(null);if(!o)return null;async function X(){const ne=[];if(w||ne.push("CAI"),O||ne.push("Rango Desde"),q||ne.push("Rango Hasta"),Y||ne.push("Fecha de Vencimiento"),x==null&&ne.push("Caja"),h==null&&!p&&ne.push("Cajero"),ne.length>0){L(`Campos obligatorios faltantes: ${ne.join(", ")}`);return}if(x!=null&&(x<1||x>5)){L("La caja debe estar entre 1 y 5");return}ge(!0),L(null);try{const C={cai:w??null,identificador:V??null,rango_de:O??null,rango_hasta:q??null,fecha_vencimiento:Y??null,secuencia_actual:M??null,caja:x??null};if(h!=null){const k=s.find(ee=>ee.id===h);C.cajero=k?k.username:null,C.usuario_id=k?k.id:null}else C.cajero=p??null,C.usuario_id=null;await d(C),a()}catch(C){L(C?.message||String(C))}finally{ge(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:w,onChange:ne=>N(ne.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),r.jsx("input",{className:"input",value:V,onChange:ne=>ye(ne.target.value),placeholder:"Identificador (opcional)"}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:O,onChange:ne=>T(ne.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:q,onChange:ne=>B(ne.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:Y,onChange:ne=>E(ne.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),r.jsx("input",{className:"input",value:M??"",onChange:ne=>D(ne.target.value===""?null:ne.target.value),placeholder:"0"}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:h!=null?String(h):v?"__custom__":"",onChange:ne=>{const C=ne.target.value;C===""?(g(null),m(null),_(!1)):C==="__custom__"?(g(null),_(!0)):/^\d+$/.test(C)&&(g(Number(C)),m(null),_(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(ne=>r.jsxs("option",{value:String(ne.id),children:[ne.username,ne.nombre_usuario?`  ${ne.nombre_usuario}`:""]},ne.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:ne=>{m(ne.target.value),g(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:x??"",onChange:ne=>b(ne.target.value===""?null:Number(ne.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(ne=>r.jsx("option",{value:ne,children:ne},ne))]})]})]})]})]}),xe&&r.jsx("div",{style:{color:"red",marginTop:12},children:xe}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:Q,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:X,disabled:Q,style:{width:"auto",padding:"8px 14px"},children:Q?"Creando...":"Crear"})]})]})})}function w_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState([]),[p,m]=S.useState(null),[v,_]=S.useState(!1),[x,b]=S.useState(!1);async function w(){l(!0),d(null);try{const{data:E,error:M}=await te.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(M)throw M;a(Array.isArray(E)?E:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}async function N(){try{const{data:E}=await te.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),N()},[]);const O=new Set(o.filter(E=>E.cajero).map(E=>String(E.cajero))),T=new Set(o.filter(E=>E.caja!=null).map(E=>Number(E.caja)));function q(E){m(E),_(!0),d(null)}function B(){_(!1),m(null)}async function Y(E,M){l(!0),d(null);try{const{error:D}=await te.from("cai").update(M).eq("id",E);if(D)throw D;await w()}catch(D){throw d(D?.message||String(D)),D}finally{l(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"CAI"}),r.jsx("th",{children:"Identificador"}),r.jsx("th",{children:"Rango Desde"}),r.jsx("th",{children:"Rango Hasta"}),r.jsx("th",{children:"Vencimiento"}),r.jsx("th",{children:"Secuencia actual"}),r.jsx("th",{children:"Cajero"}),r.jsx("th",{children:"Usuario ID"}),r.jsx("th",{children:"Caja"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:200},children:E.cai}),r.jsx("td",{style:{minWidth:160},children:E.identificador??"-"}),r.jsx("td",{children:E.rango_de}),r.jsx("td",{children:E.rango_hasta}),r.jsx("td",{children:E.fecha_vencimiento}),r.jsx("td",{children:E.secuencia_actual??"-"}),r.jsx("td",{style:{minWidth:180},children:E.cajero||"-"}),r.jsx("td",{style:{minWidth:160},children:E.usuario_id??"-"}),r.jsx("td",{style:{width:120},children:E.caja??"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>q(E),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},E.id))})]}),o.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),r.jsx(j_,{open:v,onClose:B,row:p,cajeros:h,availableCajeros:p?h.filter(E=>!O.has(E.username)||E.username===p.cajero):h.filter(E=>!O.has(E.username)),availableCajas:p?[1,2,3,4,5].filter(E=>!T.has(E)||E===p.caja):[1,2,3,4,5].filter(E=>!T.has(E)),onSave:Y}),r.jsx(S_,{open:x,onClose:()=>b(!1),cajeros:h,availableCajeros:h.filter(E=>!O.has(E.username)),availableCajas:[1,2,3,4,5].filter(E=>!T.has(E)),onCreate:async E=>{l(!0),d(null);try{const{error:M}=await te.from("cai").insert(E);if(M)throw M;await w(),b(!1)}catch(M){throw d(M?.message||String(M)),M}finally{l(!1)}}})]})}function E_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function C_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),r.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Mu=cp();function T_({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,h]=Tu.useState(!1);if(!o)return null;const g=async()=>{try{h(!0),await u()}finally{h(!1)}};return Mu.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("p",{children:s}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),r.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function A_({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[h,g]=S.useState({}),[p,m]=S.useState(!1),[v,_]=S.useState(null);if(S.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?_(l.imagen):_(null)},[l,o]),!o)return null;const x=(O,T)=>{g(q=>({...q,[O]:T}))},b=async O=>{O.preventDefault();try{m(!0),await d(h)}finally{m(!1)}},w=O=>O==="creado_en"?null:O==="id"?r.jsx("input",{className:"input",value:h[O]??"",readOnly:!0}):O.includes("publicacion")||O.includes("exento")||O.includes("aplica_impuesto")||O==="publicacion_web"?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("label",{className:"switch",children:[r.jsx("input",{type:"checkbox",checked:!!h[O],onChange:T=>x(O,T.target.checked)}),r.jsx("span",{className:"slider"})]}),r.jsx("span",{style:{fontSize:13},children:h[O]?"S":"No"})]}):O.includes("categoria")||O.includes("marca")?r.jsx("input",{type:"text",className:"input",value:h[O]??"",onChange:T=>x(O,T.target.value===""?null:T.target.value)}):O==="imagen"?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?r.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,r.jsx("input",{type:"file",accept:"image/*",onChange:T=>{const q=T.target.files&&T.target.files[0];if(x(O,q??null),q)try{const B=URL.createObjectURL(q);_(B)}catch{_(null)}else _(null)}}),v?r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{x(O,null),_(null)},children:"Eliminar imagen"}):null]}):r.jsx("input",{className:"input",value:h[O]??"",onChange:T=>x(O,T.target.value)}),N=r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsxs("form",{onSubmit:b,children:[r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(O=>r.jsxs("label",{style:{display:"block"},children:[r.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(O).replace(/_/g," ").toUpperCase()}),w(O)]},O))}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Mu.createPortal(N,typeof document<"u"&&document.body||document.createElement("div"))}function N_({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const h=a||{},[g,p]=S.useState(null),[m,v]=S.useState(null),[_,x]=S.useState(null),[b,w]=S.useState(null);return S.useEffect(()=>{let N=!0;return(async()=>{const T=typeof h.imagen=="string"?h.imagen:null;if(!T){N&&p(null);return}if(T.startsWith("http")){N&&(p(T),x(T));return}let q=T;const B=String(T).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);B&&(q=decodeURIComponent(B[2]));const Y="inventario";try{const E=(await Cn(async()=>{const{default:Q}=await Promise.resolve().then(()=>En);return{default:Q}},void 0)).default,M=await E.storage.from(Y).getPublicUrl(q),D=M?.data?.publicUrl||M?.data?.publicURL||null;if(D){N&&(p(D),x(D));return}const V=await E.storage.from(Y).createSignedUrl(q,3600*24*7);if(V.error){console.warn("ProductDetailModal createSignedUrl error",V.error),N&&p(null);return}const ye=V.data?.signedUrl??null;N&&(p(ye),x(ye))}catch(E){console.error("ProductDetailModal resolve error",E),N&&p(null)}})(),()=>{N=!1}},[h]),S.useEffect(()=>{let N=!0;return(async()=>{if(w(null),!!_)try{const T=await fetch(_,{method:"HEAD"});if(!N)return;w(`HEAD ${T.status} ${T.statusText} - content-type: ${T.headers.get("content-type")}`)}catch(T){if(!N)return;w(`FETCH_ERROR: ${String(T)}`)}})(),()=>{N=!1}},[_]),Mu.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:s}),r.jsxs("div",{style:{display:"flex",gap:18},children:[r.jsx("div",{style:{flex:1},children:r.jsx("table",{style:{width:"100%"},children:r.jsx("tbody",{children:Object.keys(h).map(N=>{const O=h[N];return N==="imagen"&&typeof O=="string"?null:r.jsxs("tr",{children:[r.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(N).replace(/_/g," ").toUpperCase()}),r.jsx("td",{style:{padding:6},children:String(O??"-")})]},N)})})})}),r.jsx("div",{style:{width:280,textAlign:"center"},children:g?r.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:N=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?r.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),r.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):r.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(h),children:"Editar"}),r.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(h.id),children:"Eliminar"}),r.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function O_({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:h,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:_=[]}){const[x,b]=S.useState(null),[w,N]=S.useState(!1),[O,T]=S.useState(null),[q,B]=S.useState(""),[Y,E]=S.useState(!1),[M,D]=S.useState("add"),[V,ye]=S.useState({}),[Q,ge]=S.useState(!1),[xe,L]=S.useState(null),[X,ne]=S.useState(!1),[C,k]=S.useState(null),ee=S.useRef(!0),me=async()=>{N(!0),T(null);try{const re=(await Cn(async()=>{const{default:Oe}=await Promise.resolve().then(()=>En);return{default:Oe}},void 0)).default,P=a||"*";let se=re.from(o).select(P).limit(l);h&&(Array.isArray(h)?h:String(h).split(",").map(De=>De.trim()).filter(Boolean)).forEach(De=>{const ze=De.split(" ").map(gt=>gt.trim()).filter(Boolean),Le=ze[0],Ke=ze[1]?ze[1].toLowerCase():"asc";se=se.order(Le,{ascending:Ke!=="desc"})}),g&&Object.entries(g).forEach(([Oe,De])=>{De==null||De===""||(se=se.eq(Oe,De))});const _e=await se;if(console.debug("SupabaseTable fetch result for",o,_e),!ee.current)return;if(_e.error)throw _e.error;b(Array.isArray(_e.data)?_e.data:[])}catch(re){console.error("SupabaseTable error",re),T(re?.message||String(re)),b([])}finally{ee.current&&N(!1)}};S.useEffect(()=>(ee.current=!0,me(),()=>{ee.current=!1}),[o,a,l]);const ve=S.useMemo(()=>u&&u.length>0?u:!x||x.length===0?[]:Object.keys(x[0]),[u,x]),A=S.useMemo(()=>{if(!x)return null;const re=(q||"").toString().trim().toLowerCase();if(!re)return x;const P=d&&d.length>0?d:ve;return x.filter(se=>P.some(_e=>{const Oe=se?.[_e];return Oe==null?!1:String(Oe).toLowerCase().includes(re)}))},[x,q,d,ve]),z=()=>{p&&(D("add"),ye({}),E(!0))},$=re=>{m&&(D("edit"),ye(re),E(!0))},F=async re=>{const P=(await Cn(async()=>{const{default:se}=await Promise.resolve().then(()=>En);return{default:se}},void 0)).default;try{const se="inventario",_e={...re},Oe=M==="edit"?V?.imagen??null:null,De=ze=>{if(!ze)return null;if(!ze.startsWith("http"))return ze;const Le=ze.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Le?decodeURIComponent(Le[2]):null};if(_e.imagen&&_e.imagen instanceof File){const ze=_e.imagen,Le=_e.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Ke=`${o}/${Le}/${Date.now()}_${ze.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,gt=await P.storage.from(se).upload(Ke,ze,{upsert:!0});if(gt.error)throw gt.error;const vt=gt.data?.path??Ke;_e.imagen=vt;try{const bt=De(Oe);if(bt&&bt!==vt){const Ot=await P.storage.from(se).remove([bt]);Ot.error&&console.warn("Failed to remove old image",Ot.error)}}catch(bt){console.warn("Error removing old image",bt)}}if(M==="edit"&&(_e.imagen==null||_e.imagen===""))try{const ze=De(V?.imagen??null);if(ze){const Le=await P.storage.from(se).remove([ze]);Le.error&&console.warn("Failed to remove old image on clear",Le.error)}}catch(ze){console.warn("Error removing old image on clear",ze)}if(M==="add"){const{error:ze}=await P.from(o).insert([_e]);if(ze)throw ze}else{const ze=_e.id,Le={..._e};delete Le.id;const{error:Ke}=await P.from(o).update(Le).eq("id",ze);if(Ke)throw Ke}E(!1),await me()}catch(se){console.error("Error saving",se),T(se?.message||String(se))}},pe=async()=>{if(xe==null)return;const re=(await Cn(async()=>{const{default:P}=await Promise.resolve().then(()=>En);return{default:P}},void 0)).default;try{if(!v)return;try{const se="inventario",_e=x?.find(Le=>Le.id===xe),Oe=Le=>{if(!Le)return null;if(!Le.startsWith("http"))return Le;const Ke=Le.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Ke?decodeURIComponent(Ke[2]):null},De=_e?.imagen??null,ze=Oe(De);if(ze){const Le=await re.storage.from(se).remove([ze]);Le.error&&console.warn("Failed to remove image on delete",Le.error)}}catch(se){console.warn("Error removing image before delete",se)}const{error:P}=await re.from(o).delete().eq("id",xe);if(P)throw P;ge(!1),L(null),await me()}catch(P){console.error("Error deleting",P),T(P?.message||String(P))}};return r.jsxs("div",{style:{padding:18},children:[s?r.jsx("h2",{style:{marginTop:0},children:s}):null,r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("input",{placeholder:"Buscar...",value:q,onChange:re=>B(re.target.value),className:"input",style:{minWidth:240}}),r.jsx("button",{onClick:()=>{T(null),B(""),me()},className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto"},children:r.jsx("button",{onClick:z,className:"btn-primary",children:"Agregar"})})]}),w&&r.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),O&&r.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",O]}),!w&&x&&x.length===0&&r.jsxs("div",{children:["No hay registros en la tabla ",r.jsx("strong",{children:o}),"."]}),!w&&A&&A.length>0&&r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[ve.map(re=>r.jsx("th",{children:String(re).replace(/_/g," ").toUpperCase()},re)),r.jsx("th",{style:{width:140},children:"Acciones"})]})}),r.jsx("tbody",{children:A.map((re,P)=>r.jsxs("tr",{children:[ve.map(se=>{if(se==="imagen"){const _e=re?.imagen??null;return _e||console.debug("SupabaseTable: row has no imagen for id",re?.id,re),r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:_e?r.jsx(im,{src:String(_e)}):r.jsx("span",{style:{color:"#6b7280"},children:"-"})},se)}return r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:R_(re[se])},se)}),r.jsx("td",{className:"admin-actions",children:r.jsx("button",{className:"btn-opaque",onClick:()=>{k(re),ne(!0)},children:"Ver"})})]},re.id??P))})]})}),r.jsx(A_,{open:Y,title:M==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:ve.filter(re=>!_.includes(re)),initialData:V,onClose:()=>E(!1),onSave:F}),r.jsx(N_,{open:X,data:C,title:`Detalle de ${o}`,onClose:()=>ne(!1),onEdit:re=>{ne(!1),$(re)},onDeleteClick:re=>{ne(!1),L(re),ge(!0)}}),r.jsx(T_,{open:Q,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>ge(!1),onConfirm:pe})]})}function R_(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return r.jsx(im,{src:o})}return String(o)}function im({src:o}){const[a,s]=S.useState(null),[l,u]=S.useState(null);return S.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await Cn(async()=>{const{default:N}=await Promise.resolve().then(()=>En);return{default:N}},void 0)).default,v="inventario",_=await m.storage.from(v).getPublicUrl(g),x=_?.data?.publicUrl||_?.data?.publicURL||null;if(x){d&&s(x);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const w=b.data?.signedUrl??null;d&&s(w)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?r.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:r.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function k_(){const[o,a]=S.useState(null),[s,l]=S.useState(""),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,m]=S.useState([]);return S.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await Cn(async()=>{const{default:D}=await Promise.resolve().then(()=>En);return{default:D}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],N=new Set(w.map(D=>D.categoria??"").filter(Boolean)),O=new Set(w.map(D=>D.marca??"").filter(Boolean)),T=w.length,q=w.filter(D=>!!D.publicacion_web).length,B=D=>{if(D==null)return!1;if(typeof D=="boolean")return D===!0;if(typeof D=="number")return D===1;const V=String(D).toLowerCase().trim();return V==="1"||V==="true"||V==="t"||V==="si"||V==="s"||V==="yes"},Y=w.filter(D=>B(D.exento)).length,E=w.filter(D=>B(D.aplica_impuesto_18)).length,M=w.filter(D=>B(D.aplica_impuesto_turistico)).length;a({categorias:N.size,marcas:O.size,items:T,publicadas:q,exentos:Y,aplica_impuesto_18:E,aplica_impuesto_turistico:M}),g(Array.from(N).sort()),m(Array.from(O).sort())}catch(x){console.error("Error loading inventario summary",x)}})(),()=>{v=!1}},[]),r.jsxs("div",{children:[r.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[r.jsx(ri,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),r.jsx(ri,{label:"Marcas",value:o?String(o.marcas):"..."}),r.jsx(ri,{label:"Items",value:o?String(o.items):"..."}),r.jsx(ri,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),r.jsx(ri,{label:"Exentos",value:o?String(o.exentos):"..."}),r.jsx(ri,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),r.jsx(ri,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),r.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),h.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),r.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),p.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),r.jsx(O_,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function ri({label:o,value:a}){return r.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),r.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function U_({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,h]=S.useState(null),[g,p]=S.useState(""),[m,v]=S.useState(!1),[_,x]=S.useState(null),[b,w]=S.useState(null),[N,O]=S.useState(null),[T,q]=S.useState(null),[B,Y]=S.useState(null),[E,M]=S.useState(null),[D,V]=S.useState(null),[ye,Q]=S.useState(null),[ge,xe]=S.useState(null),[L,X]=S.useState(!1);S.useEffect(()=>{o&&(h(null),p(""),w(null),O(null),q(null),Q(null),xe(null),x(null))},[o]);async function ne(){const k=[];if(d||k.push("Producto"),g||k.push("Precio"),k.length>0){x(`Faltan campos: ${k.join(", ")}`);return}const ee=Number(g);if(isNaN(ee)||ee<0){x("Precio invlido");return}v(!0),x(null);try{await u({producto_id:d,precio:g});try{const me={};if(B!==null&&(me.exento=B),E!==null&&(me.aplica_impuesto_18=E),D!==null&&(me.aplica_impuesto_turistico=D),Object.keys(me).length>0){const{error:ve}=await te.from("inventario").update(me).eq("id",d);ve&&console.warn("Error actualizando inventario flags:",ve)}}catch(me){console.warn("Error al persistir flags en inventario:",me)}a()}catch(me){x(me?.message||String(me))}finally{v(!1)}}function C(k){return k?Number(k.replace(",",".")):NaN}return S.useEffect(()=>{let k=!0;async function ee(){if(w(null),O(null),q(null),Q(null),xe(null),!d)return;const me=C(g);if(!isNaN(me)){X(!0);try{const{data:ve,error:A}=await te.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(A)throw A;const z=Array.isArray(ve)?ve.map(dt=>Number(dt.costo_unitario)).filter(dt=>!isNaN(dt)):[],$=z.length>0?z.reduce((dt,et)=>dt+et,0)/z.length:0;if(!k)return;w($);let F=!1,pe=!1,re=!1;try{const{data:dt,error:et}=await te.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!et&&dt&&(F=!!dt.exento,pe=!!dt.aplica_impuesto_18,re=!!dt.aplica_impuesto_turistico,B===null&&Y(F),E===null&&M(pe),D===null&&V(re))}catch{}const{data:P}=await te.from("impuesto").select("id, impuesto_venta"),se={};Array.isArray(P)&&P.forEach(dt=>{se[String(dt.id)]=Number(dt.impuesto_venta)});const _e=B!==null?B:F,Oe=E!==null?E:pe,De=D!==null?D:re;let ze=0;_e?ze=0:Oe?ze=se[2]??se[1]??0:ze=se[1]??0;let Le=0;De&&(Le=se[3]??0);const Ke=(ze||0)+(Le||0),gt=Ke>1?Ke/100:Ke,vt=me*gt;O(Ke),q(vt);const bt=me-$,Ot=$>0?bt/$*100:null;Q(Ot);const Jt=me>0?(me-$-vt)/me*100:null;xe(Jt)}catch{}finally{k&&X(!1)}}}return ee(),()=>{k=!1}},[d,g,B,E,D]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:d??"",onChange:k=>h(k.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(k=>r.jsx("option",{value:k.id,children:k.nombre},k.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!B,onChange:k=>Y(k.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!E,onChange:k=>M(k.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!D,onChange:k=>V(k.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:g,onChange:k=>p(k.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:T==null?"":T.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:ye==null?"":ye.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:ge==null?"":ge.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&r.jsx("div",{style:{color:"red",marginTop:12},children:_}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ne,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function z_({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[h,g]=S.useState(null),[p,m]=S.useState(""),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,N]=S.useState(null),[O,T]=S.useState(null),[q,B]=S.useState(null),[Y,E]=S.useState(null),[M,D]=S.useState(null),[V,ye]=S.useState(null),[Q,ge]=S.useState(null),[xe,L]=S.useState(null),[X,ne]=S.useState(!1);S.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const ee=Number(s.precio);m(isNaN(ee)?String(s.precio):ee.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function C(ee){return ee?Number(ee.replace(",",".")):NaN}if(S.useEffect(()=>{let ee=!0;async function me(){if(N(null),T(null),B(null),ge(null),L(null),!o||!s||!h)return;const ve=C(p);if(!isNaN(ve)){ne(!0);try{const{data:A,error:z}=await te.from("compras_detalle").select("costo_unitario").eq("producto_id",h);if(z)throw z;const $=Array.isArray(A)?A.map(et=>Number(et.costo_unitario)).filter(et=>!isNaN(et)):[],F=$.length>0?$.reduce((et,Da)=>et+Da,0)/$.length:0;if(!ee)return;N(F);let pe=!1,re=!1,P=!1;try{const{data:et,error:Da}=await te.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",h).single();!Da&&et&&(pe=!!et.exento,re=!!et.aplica_impuesto_18,P=!!et.aplica_impuesto_turistico,Y===null&&E(pe),M===null&&D(re),V===null&&ye(P))}catch{}const{data:se}=await te.from("impuesto").select("id, impuesto_venta"),_e={};Array.isArray(se)&&se.forEach(et=>_e[String(et.id)]=Number(et.impuesto_venta));const Oe=Y!==null?Y:pe,De=M!==null?M:re,ze=V!==null?V:P;let Le=0;Oe?Le=0:De?Le=_e[2]??_e[1]??0:Le=_e[1]??0;let Ke=0;ze&&(Ke=_e[3]??0);const gt=(Le||0)+(Ke||0),vt=gt>1?gt/100:gt,bt=ve*vt;T(gt),B(bt);const Ot=ve-F,Jt=F>0?Ot/F*100:null;ge(Jt);const dt=ve>0?(ve-F-bt)/ve*100:null;L(dt)}catch{}finally{ee&&ne(!1)}}}return me(),()=>{ee=!1}},[o,s,h,p,Y,M,V]),!o||!s)return null;async function k(){const ee=[];if(h||ee.push("Producto"),p||ee.push("Precio"),ee.length>0){b(`Faltan campos: ${ee.join(", ")}`);return}const me=Number(p);if(isNaN(me)||me<0){b("Precio invlido");return}_(!0),b(null);try{const ve=s.id;await d(ve,{producto_id:h,precio:p});try{const A={};if(Y!==null&&(A.exento=Y),M!==null&&(A.aplica_impuesto_18=M),V!==null&&(A.aplica_impuesto_turistico=V),Object.keys(A).length>0&&h){const{error:z}=await te.from("inventario").update(A).eq("id",h);z&&console.warn("Error actualizando inventario flags:",z)}}catch(A){console.warn("Error al persistir flags en inventario:",A)}a()}catch(ve){b(ve?.message||String(ve))}finally{_(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:h??"",onChange:ee=>g(ee.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(ee=>r.jsx("option",{value:ee.id,children:ee.nombre},ee.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!Y,onChange:ee=>E(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!M,onChange:ee=>D(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!V,onChange:ee=>ye(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:p,onChange:ee=>m(ee.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:q==null?"":q.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:Q==null?"":Q.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:xe==null?"":xe.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&r.jsx("div",{style:{color:"red",marginTop:12},children:x}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:k,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function D_(){const[o,a]=S.useState([]),[s,l]=S.useState([]),[u,d]=S.useState(!1),[h,g]=S.useState(null),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[x,b]=S.useState(null);async function w(){d(!0),g(null);try{const{data:E,error:M}=await te.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(M)throw M;a(Array.isArray(E)?E:[])}catch(E){g(E?.message||String(E)),a([])}finally{d(!1)}}async function N(){try{const{data:E}=await te.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),N()},[]);const O=new Set(o.map(E=>String(E.producto_id))),T=s.filter(E=>!O.has(E.id));function q(E){b(E),_(!0),g(null)}async function B(E){d(!0),g(null);try{const{error:M}=await te.from("precios").insert(E);if(M)throw M;try{const D={producto_id:E.producto_id,precio:E.precio},{error:V}=await te.from("precios_historico").insert(D);V&&console.warn("No se pudo insertar en precios_historico",V)}catch(D){console.warn("Error registrando precios_historico",D)}await w()}catch(M){throw g(M?.message||String(M)),M}finally{d(!1)}}async function Y(E,M){d(!0),g(null);try{const{error:D}=await te.from("precios").update(M).eq("id",E);if(D)throw D;let V=M.producto_id,ye=M.precio;if(!V||ye===void 0)try{const{data:Q}=await te.from("precios").select("producto_id, precio").eq("id",E).limit(1).single();Q&&(V=V||Q.producto_id,ye=ye===void 0?Q.precio:ye)}catch{}try{if(V&&ye!==void 0){const Q={producto_id:V,precio:ye},{error:ge}=await te.from("precios_historico").insert(Q);ge&&console.warn("No se pudo insertar en precios_historico",ge)}}catch(Q){console.warn("Error registrando precios_historico",Q)}await w()}catch(D){throw g(D?.message||String(D)),D}finally{d(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{w(),N()},children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),h&&r.jsx("div",{style:{color:"red",marginBottom:12},children:h}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:220},children:s.find(M=>M.id===E.producto_id)?.nombre||E.producto_id}),r.jsx("td",{children:E.precio}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>q(E),children:"Editar"})})]},E.id))})]})}),r.jsx(U_,{open:p,onClose:()=>m(!1),products:T,onCreate:async E=>{await B(E),m(!1)}}),r.jsx(z_,{open:v,onClose:()=>{_(!1),b(null)},row:x,products:s,availableProducts:[...s.filter(E=>!O.has(E.id)),...x?s.filter(E=>E.id===x.producto_id):[]],onSave:async(E,M)=>{await Y(E,M),_(!1),b(null)}})]})}function B_(){const[o,a]=S.useState(""),[s,l]=S.useState([]),[u,d]=S.useState(null),[h,g]=S.useState([]),[p,m]=S.useState(!1),[v,_]=S.useState(null);async function x(){if(_(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:N}=await te.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(N)throw N;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const O=w[0].id;d(O),await b(O)}}catch(w){_(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),_(null);try{const{data:N,error:O}=await te.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(O)throw O;g(Array.isArray(N)?N:[])}catch(N){_(N?.message||String(N)),g([])}finally{m(!1)}}return S.useEffect(()=>{u&&b(u)},[u]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>x(),children:"Buscar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${h.length} registros`})]}),v&&r.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),r.jsx("ul",{children:s.map(w=>r.jsxs("li",{style:{marginBottom:6},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),r.jsx("strong",{children:w.nombre})," ",r.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Actualizacion"})]})}),r.jsx("tbody",{children:h.map(w=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(w.id)}),r.jsx("td",{style:{minWidth:220},children:s.find(N=>N.id===w.producto_id)?.nombre||w.producto_id}),r.jsx("td",{children:Number(w.precio).toFixed(2)}),r.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function M_(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,m]=S.useState({}),[v,_]=S.useState({}),[x,b]=S.useState(!1),[w,N]=S.useState(null);async function O(){b(!0),N(null);try{let T=te.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(T=T.ilike("sku",`%${o}%`)),s&&(T=T.ilike("marca",`%${s}%`)),u&&(T=T.ilike("modelo",`%${u}%`));const{data:q,error:B}=await T.order("nombre",{ascending:!0});if(B)throw B;const Y=Array.isArray(q)?q:[];g(Y);const E=Y.map(Q=>Q.id);if(E.length===0){m({});return}const{data:M,error:D}=await te.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",E);if(D)throw D;const V=Array.isArray(M)?M:[],ye={};for(const Q of Y)ye[String(Q.id)]=0;for(const Q of V){const ge=String(Q.producto_id),xe=Number(Q.cantidad)||0,L=String(Q.tipo_de_movimiento||"").toUpperCase();ye.hasOwnProperty(ge)||(ye[ge]=0),L==="ENTRADA"?ye[ge]=(ye[ge]||0)+xe:L==="SALIDA"&&(ye[ge]=(ye[ge]||0)-xe)}for(const Q of Object.keys(ye))ye[Q]=Number((ye[Q]||0).toFixed(2));m(ye);try{const Q=(await Cn(async()=>{const{default:L}=await Promise.resolve().then(()=>En);return{default:L}},void 0)).default,ge="inventario",xe={};await Promise.all(Y.map(async L=>{const X=L.imagen;if(!X){xe[String(L.id)]=null;return}const ne=String(X);if(ne.startsWith("http")){xe[String(L.id)]=ne;return}let C=ne;const k=String(ne).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);k&&(C=decodeURIComponent(k[2]));try{const ee=await Q.storage.from(ge).getPublicUrl(C),me=ee?.data?.publicUrl||ee?.data?.publicURL||null;if(me){xe[String(L.id)]=me;return}}catch{}try{const me=(await Q.storage.from(ge).createSignedUrl(C,604800))?.data?.signedUrl??null;xe[String(L.id)]=me}catch{xe[String(L.id)]=null}})),_(xe)}catch{}}catch(T){N(T?.message||String(T)),g([]),m({})}finally{b(!1)}}return S.useEffect(()=>{O()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Stock"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:T=>a(T.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:T=>l(T.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:T=>d(T.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>O(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),O()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:x?"Cargando...":`${h.length} productos`})]}),w&&r.jsx("div",{style:{color:"red",marginBottom:12},children:w}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Imagen"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Marca"}),r.jsx("th",{children:"Modelo"}),r.jsx("th",{children:"Descripcin"}),r.jsx("th",{children:"Stock"})]})}),r.jsx("tbody",{children:h.map(T=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:v[String(T.id)]?r.jsx("img",{src:encodeURI(v[String(T.id)]),alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:q=>{q.currentTarget.src=""}}):T.imagen?r.jsx("img",{src:T.imagen,alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:q=>{q.currentTarget.src=""}}):""}),r.jsx("td",{children:T.sku||""}),r.jsx("td",{children:T.marca||""}),r.jsx("td",{children:T.modelo||""}),r.jsx("td",{style:{maxWidth:320},children:T.descripcion||""}),r.jsx("td",{style:{textAlign:"right"},children:p[String(T.id)]!=null?String(p[String(T.id)]):"0"})]},T.id))})]})]})]})}function L_(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,m]=S.useState([]),[v,_]=S.useState(!1),[x,b]=S.useState([]),[w,N]=S.useState({}),[O,T]=S.useState(!1),[q,B]=S.useState(null);async function Y(){T(!0),B(null),b([]);try{let V=null;if(o||s||u){let X=te.from("inventario").select("id").order("nombre",{ascending:!0});o&&(X=X.ilike("sku",`%${o}%`)),s&&(X=X.ilike("marca",`%${s}%`)),u&&(X=X.ilike("categoria",`%${u}%`));const{data:ne,error:C}=await X;if(C)throw C;if(V=Array.isArray(ne)?ne.map(k=>String(k.id)):[],V.length===0){b([]),N({}),T(!1);return}}let ye=te.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(V&&(ye=ye.in("producto_id",V)),v){const X=new Date(Date.now()-864e5).toISOString();ye=ye.gte("fecha_salida",X)}ye=ye.order("fecha_salida",{ascending:!1});const{data:Q,error:ge}=await ye;if(ge)throw ge;const xe=Array.isArray(Q)?Q.map(X=>({id:X.id,producto_id:String(X.producto_id),cantidad:Number(X.cantidad),tipo_de_movimiento:X.tipo_de_movimiento,referencia:X.referencia,usuario:X.usuario,fecha_salida:X.fecha_salida})):[];b(xe);const L=Array.from(new Set(xe.map(X=>X.producto_id))).filter(Boolean);if(L.length>0){const{data:X}=await te.from("inventario").select("id, nombre, sku, marca, categoria").in("id",L),ne={};Array.isArray(X)&&X.forEach(C=>{ne[String(C.id)]={id:C.id,nombre:C.nombre,sku:C.sku,marca:C.marca,categoria:C.categoria}}),N(ne)}else N({})}catch(V){B(V?.message||String(V)),b([])}finally{T(!1)}}async function E(){try{const{data:V,error:ye}=await te.from("inventario").select("marca, categoria");if(ye)throw ye;const Q=new Set,ge=new Set;Array.isArray(V)&&V.forEach(xe=>{xe.marca&&Q.add(String(xe.marca)),xe.categoria&&ge.add(String(xe.categoria))}),g(Array.from(Q).sort()),m(Array.from(ge).sort())}catch(V){console.warn("Error loading filter options",V)}}S.useEffect(()=>{Y(),E()},[]);const M=x.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="ENTRADA"),D=x.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="SALIDA");return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:V=>a(V.target.value)}),r.jsxs("select",{className:"input",value:s,onChange:V=>l(V.target.value),children:[r.jsx("option",{value:"",children:"-- Marca (todas) --"}),h.map(V=>r.jsx("option",{value:V,children:V},V))]}),r.jsxs("select",{className:"input",value:u,onChange:V=>d(V.target.value),children:[r.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(V=>r.jsx("option",{value:V,children:V},V))]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:v,onChange:V=>_(V.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>Y(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),_(!1),Y()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:O?"Cargando...":`${x.length} registros`})]}),q&&r.jsx("div",{style:{color:"red",marginBottom:12},children:q}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Entradas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:M.map(V=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(V.id)}),r.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),r.jsx("td",{children:w[V.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),r.jsx("td",{children:V.referencia||""}),r.jsx("td",{children:V.usuario||""}),r.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]}),r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Salidas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:D.map(V=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(V.id)}),r.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),r.jsx("td",{children:w[V.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),r.jsx("td",{children:V.referencia||""}),r.jsx("td",{children:V.usuario||""}),r.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]})]})]})}function q_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),r.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function I_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),r.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function H_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function V_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function $_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function P_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function G_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function K_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),r.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function Y_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),r.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function J_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),r.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function F_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),r.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function Q_({open:o,onClose:a,onCreate:s}){const[l,u]=S.useState(""),[d,h]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,x]=S.useState(""),[b,w]=S.useState(""),[N,O]=S.useState(!0),[T,q]=S.useState(!1),[B,Y]=S.useState(null);if(!o)return null;async function E(){const M=[];if(l.trim()||M.push("Nombre"),M.length){Y(`Faltan campos: ${M.join(", ")}`);return}q(!0),Y(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:b||void 0,activo:N}),u(""),h(""),p(""),v(""),x(""),w(""),O(!0),a()}catch(D){Y(D?.message||String(D))}finally{q(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:l,onChange:M=>u(M.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:d,onChange:M=>h(M.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:g,onChange:M=>p(M.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:m,onChange:M=>v(M.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:_,onChange:M=>x(M.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:b,onChange:M=>w(M.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:N,onChange:M=>O(M.target.checked)})," ","Activo"]})]}),B&&r.jsx("div",{style:{color:"red",marginTop:12},children:B}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:T,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:E,disabled:T,style:{width:"auto",padding:"8px 14px"},children:T?"Creando...":"Crear"})]})]})})}function X_({open:o,onClose:a,row:s,onSave:l}){const[u,d]=S.useState(""),[h,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[x,b]=S.useState(""),[w,N]=S.useState(""),[O,T]=S.useState(!0),[q,B]=S.useState(!1),[Y,E]=S.useState(null);if(S.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),_(s.correo||""),b(s.direccion||""),N(s.tipo_proveedor||""),T(s.activo??!0),E(null))},[o,s]),!o||!s)return null;async function M(){if(!s){E("No hay fila seleccionada");return}const D=[];if(u.trim()||D.push("Nombre"),D.length){E(`Faltan campos: ${D.join(", ")}`);return}B(!0),E(null);try{await l(s.id,{nombre:u.trim(),rtn:h.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:w||void 0,activo:O}),a()}catch(V){E(V?.message||String(V))}finally{B(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:u,onChange:D=>d(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:h,onChange:D=>g(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:p,onChange:D=>m(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:v,onChange:D=>_(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:x,onChange:D=>b(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:w,onChange:D=>N(D.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:O,onChange:D=>T(D.target.checked)})," ","Activo"]})]}),Y&&r.jsx("div",{style:{color:"red",marginTop:12},children:Y}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:q,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:M,disabled:q,style:{width:"auto",padding:"8px 14px"},children:q?"Guardando...":"Guardar"})]})]})})}function Z_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(""),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,N]=S.useState(!1),[O,T]=S.useState(null);async function q(M){l(!0),d(null);try{let D=null,V=null;if(M&&M.trim()){const Q=`%${M.trim()}%`,ge=await te.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${Q},rtn.ilike.${Q}`).order("id",{ascending:!0});D=ge.data,V=ge.error}else{const ye=await te.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});D=ye.data,V=ye.error}if(V)throw V;a(Array.isArray(D)?D:[])}catch(D){d(D?.message||String(D)),a([])}finally{l(!1)}}S.useEffect(()=>{q()},[]),S.useEffect(()=>{const M=setTimeout(()=>{q(h)},350);return()=>clearTimeout(M)},[h]);async function B(M){l(!0),d(null);try{const D={...M};if(delete D.id,D.rtn){const{data:ye,error:Q}=await te.from("proveedores").select("id, nombre").eq("rtn",D.rtn).limit(1);if(Q)throw Q;if(Array.isArray(ye)&&ye.length>0)throw new Error(`Ya existe un proveedor con RTN ${D.rtn}`)}const{error:V}=await te.from("proveedores").insert(D);if(V)throw V;await q()}catch(D){throw String(D).includes("Ya existe un proveedor")?d(String(D)):D?.code==="23505"||String(D).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(D?.message||String(D)),D}finally{l(!1)}}async function Y(M,D){l(!0),d(null);try{const{error:V}=await te.from("proveedores").update(D).eq("id",M);if(V)throw V;await q()}catch(V){throw d(V?.message||String(V)),V}finally{l(!1)}}async function E(){if(O){l(!0),d(null);try{const{error:M}=await te.from("proveedores").delete().eq("id",O.id);if(M)throw M;N(!1),T(null),await q()}catch(M){d(M?.message||String(M))}finally{l(!1)}}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>q(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),r.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:h,onChange:M=>g(M.target.value),style:{width:260}}),r.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),q()},children:"Limpiar"})]}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"RTN"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Telfono"}),r.jsx("th",{children:"Correo"}),r.jsx("th",{children:"Direccin"}),r.jsx("th",{children:"Tipo"}),r.jsx("th",{children:"Activo"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(M=>r.jsxs("tr",{children:[r.jsx("td",{children:M.rtn||""}),r.jsx("td",{style:{minWidth:180},children:M.nombre}),r.jsx("td",{children:M.telefono||""}),r.jsx("td",{children:M.correo||""}),r.jsx("td",{children:M.direccion||""}),r.jsx("td",{children:M.tipo_proveedor||""}),r.jsx("td",{children:M.activo?"S":"No"}),r.jsxs("td",{style:{whiteSpace:"nowrap"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{b(M),_(!0)},children:"Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>{T(M),N(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},M.id))})]})}),r.jsx(Q_,{open:p,onClose:()=>m(!1),onCreate:async M=>{await B(M),m(!1)}}),r.jsx(X_,{open:v,onClose:()=>{_(!1),b(null)},row:x,onSave:async(M,D)=>{await Y(M,D),_(!1),b(null)}}),r.jsx(am,{open:w,title:O?`Eliminar proveedor ${O.nombre}`:"Eliminar proveedor",message:O?`Confirma eliminar al proveedor ${O.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await E()},onCancel:()=>{N(!1),T(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function W_({open:o,onClose:a,onCreated:s}){const[l,u]=S.useState([]),[d,h]=S.useState([]),[g,p]=S.useState(0),[m,v]=S.useState(null),[_,x]=S.useState(""),[b,w]=S.useState("factura"),[N,O]=S.useState([]),[T,q]=S.useState(null),[B,Y]=S.useState(1),[E,M]=S.useState(null),[D,V]=S.useState(!1),[ye,Q]=S.useState(null);if(S.useEffect(()=>{o&&(async()=>{try{const k=await te.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(k.data)?k.data:[])}catch{}try{const k=await te.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});h(Array.isArray(k.data)?k.data:[])}catch{}try{const k=await te.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),ee=Array.isArray(k.data)&&k.data.length>0?k.data[0]:null,me=ee?Number(ee.impuesto_venta):0;p(me)}catch{}})()},[o]),!o)return null;function ge(){v(null),x(""),w("factura"),O([]),q(null),Y(1),M(null),Q(null)}function xe(){if(!T){Q("Selecciona un producto");return}if(!E||E<=0){Q("Costo unitario invlido");return}if(!B||B<=0){Q("Cantidad invlida");return}const k=l.find(me=>me.id===T),ee=me=>{if(me==null)return!1;if(typeof me=="boolean")return me===!0;if(typeof me=="number")return me===1;const ve=String(me).toLowerCase().trim();return ve==="1"||ve==="true"||ve==="t"||ve==="si"||ve==="s"||ve==="yes"};O(me=>[...me,{producto_id:T,nombre:k?.nombre||"",cantidad:B,costo_unitario:E,exento:ee(k?.exento)}]),q(null),Y(1),M(null),Q(null)}function L(k){O(ee=>ee.filter((me,ve)=>ve!==k))}function X(){const k=g,ee=k>1?k/100:k;let me=0,ve=0,A=0;for(const z of N){const $=z.cantidad*z.costo_unitario;let F=0,pe=$;z.exento||(F=$*ee,pe=$-F),me+=pe,ve+=F,A+=$}return{subtotal:me,impuesto:ve,total:A}}async function ne(){if(Q(null),!m){Q("Selecciona un proveedor");return}if(N.length===0){Q("Agrega al menos un producto");return}V(!0);try{const{subtotal:k,impuesto:ee,total:me}=X(),ve={proveedor_id:m,numero_documento:_||null,tipo_documento:b||null,subtotal:k,impuesto:ee,total:me,usuario:null},A=await te.from("compras").insert(ve).select("id").single();if(A.error)throw A.error;const z=A.data.id,$=N.map(pe=>({compra_id:z,producto_id:pe.producto_id,cantidad:pe.cantidad,costo_unitario:pe.costo_unitario})),F=await te.from("compras_detalle").insert($);if(F.error)throw await te.from("compras").delete().eq("id",z),F.error;try{const pe=_?`Compra - ${_}`:`Compra ${z}`;let re="sistema";try{const Oe=localStorage.getItem("user");if(Oe){const De=JSON.parse(Oe);re=De.username?`${De.username}${De.role?` (${De.role})`:""}`:String(De)}}catch{}const P=new Date().toISOString(),se=N.map(Oe=>({producto_id:Oe.producto_id,cantidad:Oe.cantidad,tipo_de_movimiento:"ENTRADA",referencia:pe,usuario:re,fecha_salida:P})),_e=await te.from("registro_de_inventario").insert(se);_e.error&&(console.warn("Error registrando en registro_de_inventario",_e.error),Q("Compra guardada, pero fall el registro en inventario: "+_e.error.message))}catch(pe){console.warn("Registro inventario fallo",pe)}ge(),a(),s&&s()}catch(k){Q(k?.message||String(k))}finally{V(!1)}}const C=X();return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),r.jsxs("select",{className:"input",value:m??"",onChange:k=>v(k.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(k=>r.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),r.jsx("input",{className:"input",value:_,onChange:k=>x(k.target.value)}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),r.jsx("input",{className:"input",value:b,onChange:k=>w(k.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:T??"",onChange:k=>q(k.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(k=>r.jsx("option",{value:k.id,children:k.nombre},k.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:k=>Y(Number(k.target.value))}),r.jsx("input",{className:"input",type:"number",style:{width:120},value:E??"",onChange:k=>M(Number(k.target.value)),placeholder:"Costo unitario"}),r.jsx("button",{className:"btn-primary",onClick:xe,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:N.map((k,ee)=>{const me=k.cantidad*k.costo_unitario,ve=g>1?g/100:g,A=k.exento?0:me*ve,z=k.exento?me:me-A;return r.jsxs("tr",{children:[r.jsx("td",{children:k.nombre}),r.jsx("td",{children:k.cantidad}),r.jsx("td",{children:k.costo_unitario.toFixed(2)}),r.jsx("td",{children:A.toFixed(2)}),r.jsx("td",{children:z.toFixed(2)}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>L(ee),children:"Quitar"})})]},`${k.producto_id}-${ee}`)})})]})})]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:["Subtotal: ",r.jsx("strong",{children:C.subtotal.toFixed(2)})]}),r.jsxs("div",{children:["Impuesto: ",r.jsx("strong",{children:C.impuesto.toFixed(2)})]}),r.jsxs("div",{children:["Total: ",r.jsx("strong",{children:C.total.toFixed(2)})]})]})}),ye&&r.jsx("div",{style:{color:"red",marginTop:12},children:ye}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{ge(),a()},disabled:D,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ne,disabled:D,children:D?"Guardando...":"Confirmar compra"})]})]})})}function ex({open:o,compraId:a,onClose:s}){const[l,u]=S.useState([]),[d,h]=S.useState({}),[g,p]=S.useState({}),[m,v]=S.useState(0),[_,x]=S.useState(!1);return S.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{x(!0);try{const{data:w,error:N}=await te.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(N)throw N;const O=Array.isArray(w)?w:[];if(!b)return;u(O);const T=Array.from(new Set(O.map(q=>q.producto_id))).filter(Boolean);if(T.length>0){const{data:q}=await te.from("inventario").select("id, nombre, exento").in("id",T),B={},Y={};Array.isArray(q)&&q.forEach(E=>{B[String(E.id)]={id:E.id,nombre:E.nombre},Y[String(E.id)]=E.exento===!0||E.exento===1||String(E.exento).toLowerCase()==="true"}),b&&(h(B),p(Y))}else h({});try{const{data:q}=await te.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),B=Array.isArray(q)&&q.length>0?q[0]:null,Y=B?Number(B.impuesto_venta):0;b&&v(Y)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&x(!1)}})(),()=>{b=!1}},[o,a]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),r.jsx("div",{style:{marginTop:8},children:_?r.jsx("div",{children:"Cargando..."}):r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),N=Number(b.costo_unitario),O=w*N,T=m>1?m/100:m,q=g[String(b.producto_id)]===!0,B=q?0:O*T,Y=q?O:O-B;return r.jsxs("tr",{children:[r.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),r.jsx("td",{children:w.toFixed(2)}),r.jsx("td",{children:N.toFixed(2)}),r.jsx("td",{children:B.toFixed(2)}),r.jsx("td",{children:Y.toFixed(2)}),r.jsx("td",{children:O.toFixed(2)})]},String(b.id))})}),r.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,N)=>{const O=Number(N.cantidad),T=Number(N.costo_unitario),q=O*T,B=m>1?m/100:m,Y=g[String(N.producto_id)]===!0,E=Y?0:q*B,M=Y?q:q-E;return w.subtotal+=M,w.impuesto+=E,w.total+=q,w},{subtotal:0,impuesto:0,total:0});return r.jsxs("tr",{children:[r.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),r.jsx("td",{children:b.impuesto.toFixed(2)}),r.jsx("td",{children:b.subtotal.toFixed(2)}),r.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function tx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(!1),[p,m]=S.useState(!1),[v,_]=S.useState(null),[x,b]=S.useState([]),[w,N]=S.useState(""),[O,T]=S.useState(""),[q,B]=S.useState(!1);async function Y(){l(!0),d(null);try{let E=te.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const V=Number(w);isNaN(V)?E=E.eq("proveedor_id",w):E=E.eq("proveedor_id",V)}if(O&&(E=E.ilike("numero_documento",`%${O}%`)),q){const V=new Date(Date.now()-864e5).toISOString();E=E.gte("fecha_compra",V)}const{data:M,error:D}=await E.order("id",{ascending:!1});if(D)throw D;a(Array.isArray(M)?M:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}return S.useEffect(()=>{Y()},[]),S.useEffect(()=>{let E=!0;return(async()=>{try{const{data:M}=await te.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!E)return;b(Array.isArray(M)?M:[])}catch{}})(),()=>{E=!1}},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:w,onChange:E=>N(E.target.value),children:[r.jsx("option",{value:"",children:"-- proveedor (todos) --"}),x.map(E=>r.jsx("option",{value:String(E.id),children:E.nombre},String(E.id)))]}),r.jsx("input",{className:"input",placeholder:"Nmero documento",value:O,onChange:E=>T(E.target.value)}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:q,onChange:E=>B(E.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>Y(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{N(""),T(""),B(!1),Y()},children:"Limpiar"})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>Y(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),r.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(E.id)}),r.jsx("td",{children:String(E.proveedor_id)}),r.jsx("td",{children:E.numero_documento||""}),r.jsx("td",{children:E.fecha_compra||""}),r.jsx("td",{children:E.subtotal||""}),r.jsx("td",{children:E.impuesto||""}),r.jsx("td",{children:E.total||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{_(E.id),m(!0)},children:"Detalle"})})]},String(E.id)))})]})}),r.jsx(W_,{open:h,onClose:()=>g(!1),onCreated:()=>{g(!1),Y()}}),r.jsx(ex,{open:p,compraId:v,onClose:()=>{m(!1),_(null)}})]})}function nx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(!1),[p,m]=S.useState(null);async function v(){l(!0),d(null);try{const{data:_,error:x}=await te.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(x)throw x;a(Array.isArray(_)?_.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(_){d(_?.message||String(_)),a([])}finally{l(!1)}}return S.useEffect(()=>{v()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),r.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(_=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(_.id)}),r.jsx("td",{children:String(_.proveedor_id||"")}),r.jsx("td",{children:_.numero_documento||""}),r.jsx("td",{children:_.usuario||""}),r.jsx("td",{children:_.fecha||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>m(_.id),children:"Detalle"})})]},String(_.id)))})]})}),h&&r.jsx(ax,{onClose:()=>{g(!1),v()}}),p&&r.jsx(ix,{id:p,onClose:()=>{m(null),v()}})]})}function ax({onClose:o}){const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,h]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(null),[_,x]=S.useState(null),[b,w]=S.useState(""),[N,O]=S.useState([]),[T,q]=S.useState(null),[B,Y]=S.useState(1),[E,M]=S.useState(!1),[D,V]=S.useState(null);S.useEffect(()=>{(async()=>{try{const L=await te.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(L.data)?L.data:[])}catch{}try{const L=await te.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(L.data)?L.data:[])}catch{}})()},[]);async function ye(){if(b){V(null);try{const{data:L,error:X}=await te.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(X)throw X;if(!L){V("No se encontr compra con ese nmero de documento");return}h(L.id),v(L.proveedor_id);try{const{data:F}=await te.from("proveedores").select("id, nombre").eq("id",L.proveedor_id).limit(1).single();F&&F.nombre&&x(F.nombre)}catch{}const{data:ne}=await te.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",L.id),C=Array.isArray(ne)?ne:[],{data:k}=await te.from("devoluciones_proveedores").select("id").eq("numero_documento",b),ee=Array.isArray(k)?k.map(F=>F.id):[];let me={};if(ee.length>0){const{data:F}=await te.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",ee);Array.isArray(F)&&F.forEach(pe=>{const re=String(pe.producto_id);me[re]=(me[re]||0)+Number(pe.cantidad)})}const ve=C.map(F=>F.producto_id),{data:A}=await te.from("inventario").select("id, nombre, sku").in("id",ve),z={};Array.isArray(A)&&A.forEach(F=>{z[String(F.id)]=F});const $=C.map(F=>{const pe=String(F.producto_id),re=Number(F.cantidad),P=me[pe]||0,se=Math.max(0,re-P);return{producto_id:pe,nombre:z[pe]?.nombre||pe,sku:z[pe]?.sku,purchased:re,returned:P,available:se,costo_unitario:Number(F.costo_unitario||0)}});p($),u($.map(F=>({id:F.producto_id,nombre:F.nombre,sku:F.sku})))}catch(L){V(L?.message||String(L))}}}function Q(){if(!T){V("Selecciona un producto");return}if(!B||B<=0){V("Cantidad invlida");return}const L=l.find(ne=>ne.id===T),X=g.find(ne=>ne.producto_id===T);if(X&&B>X.available){V(`Cantidad excede disponible para devolucin (${X.available})`);return}O(ne=>[...ne,{producto_id:T,nombre:L?.nombre,cantidad:B}]),q(null),Y(1),V(null),X&&(p(ne=>ne.map(C=>C.producto_id===X.producto_id?{...C,available:Math.max(0,C.available-B)}:C)),u(ne=>ne.map(C=>(C.id===X.producto_id,C))))}function ge(L){O(X=>X.filter((ne,C)=>C!==L))}async function xe(){if(V(null),!m){V("Selecciona un proveedor");return}if(N.length===0){V("Agrega al menos un producto");return}M(!0);try{const L={proveedor_id:m,numero_documento:b||null,usuario:null},X=await te.from("devoluciones_proveedores").insert(L).select("id").single();if(X.error)throw X.error;const ne=X.data.id;try{const C=N.map(ee=>({devolucion_id:ne,producto_id:ee.producto_id,cantidad:ee.cantidad})),k=await te.from("devoluciones_proveedores_detalle").insert(C);k.error&&console.warn("No se pudo insertar detalles de devolucin",k.error)}catch(C){console.warn("Detalles tabla puede no existir",C)}try{const C=b?`Devolucin - ${b}`:`Devolucin ${ne}`;let k="sistema";try{const A=localStorage.getItem("user");if(A){const z=JSON.parse(A);k=z.username?`${z.username}${z.role?` (${z.role})`:""}`:String(z)}}catch{}const ee=new Date().toISOString(),me=N.map(A=>({producto_id:A.producto_id,cantidad:A.cantidad,tipo_de_movimiento:"SALIDA",referencia:C,usuario:k,fecha_salida:ee})),ve=await te.from("registro_de_inventario").insert(me);ve.error&&(console.warn("Error registrando en registro_de_inventario",ve.error),V("Devolucin guardada, pero fall el registro en inventario: "+ve.error.message))}catch(C){console.warn("Registro inventario fallo",C)}o()}catch(L){V(L?.message||String(L))}finally{M(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?r.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:_||String(m||"")}):r.jsxs("select",{className:"input",value:m??"",onChange:L=>v(L.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(L=>r.jsx("option",{value:L.id,children:L.nombre},String(L.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{className:"input",value:b,onChange:L=>w(L.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>ye(),children:"Buscar compra"})]}),d&&r.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&r.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[r.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[r.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Comprado"}),r.jsx("th",{children:"Devuelto"}),r.jsx("th",{children:"Disponible"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:g.map(L=>r.jsxs("tr",{children:[r.jsx("td",{children:L.nombre}),r.jsx("td",{style:{textAlign:"right"},children:Number(L.purchased).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(L.returned).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(L.available).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>{q(L.producto_id),Y(L.available||1)},children:"Usar"})})]},L.producto_id))})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:T??"",onChange:L=>q(L.target.value||null),disabled:!!d,children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(L=>r.jsx("option",{value:L.id,children:L.nombre},L.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:L=>{const X=Number(L.target.value),ne=g.find(C=>C.producto_id===T);if(ne){const C=Number(ne.available||0);return isNaN(X)||X<1?Y(1):X>C?Y(C):Y(X)}Y(X)},min:1,max:T?g.find(L=>L.producto_id===T)?.available??void 0:void 0,disabled:(()=>{const L=g.find(X=>X.producto_id===T);return!!L&&Number(L.available||0)<=1})()}),r.jsx("button",{className:"btn-primary",onClick:Q,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:N.map((L,X)=>r.jsxs("tr",{children:[r.jsx("td",{children:L.nombre}),r.jsx("td",{style:{textAlign:"right"},children:L.cantidad}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>ge(X),children:"Quitar"})})]},`${L.producto_id}-${X}`))})]})})]})]}),D&&r.jsx("div",{style:{color:"red",marginTop:12},children:D}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:o,disabled:E,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:xe,disabled:E,children:E?"Guardando...":"Registrar devolucin"})]})]})})}function ix({id:o,onClose:a}){const[s,l]=S.useState([]),[u,d]=S.useState(!1),[h,g]=S.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await te.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const _=Array.isArray(m)?m:[];if(_.length>0){const x=_.map(N=>N.producto_id),{data:b}=await te.from("inventario").select("id, nombre, sku").in("id",x),w={};Array.isArray(b)&&b.forEach(N=>{w[String(N.id)]=N}),l(_.map(N=>({producto:w[String(N.producto_id)]?.nombre||String(N.producto_id),cantidad:N.cantidad})))}else{const{data:x}=await te.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(x)?x:[],w=b.map(T=>T.producto_id),{data:N}=await te.from("inventario").select("id, nombre, sku").in("id",w),O={};Array.isArray(N)&&N.forEach(T=>{O[String(T.id)]=T}),l(b.map(T=>({producto:O[String(T.producto_id)]?.nombre||String(T.producto_id),cantidad:T.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return S.useEffect(()=>{p()},[o]),r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&r.jsx("div",{children:"Cargando..."}),h&&r.jsx("div",{style:{color:"red"},children:h}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"})]})}),r.jsx("tbody",{children:s.map((m,v)=>r.jsxs("tr",{children:[r.jsx("td",{children:m.producto}),r.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const rx={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function sx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,m]=S.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await te.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};S.useEffect(()=>{v()},[]);const _=(b,w)=>{a(N=>N.map(O=>O.id===b?{...O,impuesto_venta:w}:O))},x=async b=>{const w=o.find(N=>N.id===b);if(w){d(b),m(null);try{const N={impuesto_venta:w.impuesto_venta??null},{error:O}=await te.from("impuesto").update(N).eq("id",b);if(O)throw O;await v()}catch(N){console.warn("Error guardando impuesto:",N),m(String(N.message||N))}finally{d(null)}}};return r.jsxs("div",{children:[r.jsx("h2",{children:"Impuestos"}),r.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?r.jsx("div",{children:"Cargando..."}):r.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>r.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8},children:rx[b.id]??`Impuesto #${b.id}`}),r.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),r.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>_(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:h!==b.id}),r.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:h===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[r.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),r.jsx("div",{style:{display:"flex",gap:8},children:h===b.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:()=>x(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):r.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&r.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&r.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const lx={dashboard:m_,datos:b_,usuarios_internal:x_,usuarios_web:__,cai:w_,facturas:E_,historial_facturas:C_,inventario_productos:k_,precios_productos:D_,precios_historico:B_,stock:M_,inventario_salidas:L_,inventario_categorias:q_,proveedores:Z_,caja_sesiones:I_,caja_movimientos:H_,rep_ventas:V_,rep_devoluciones:$_,rep_ingresos_egresos:P_,rep_compras:G_,compras_main:tx,devoluciones_proveedores:nx,rep_export:K_,cuentas_contables:Y_,libro_diario:J_,auditoria:F_,impuestos:sx};function ox({onLogout:o}){const[a,s]=S.useState("dashboard"),[l,u]=S.useState(null),[d,h]=S.useState({}),g=l||a,p=lx[g],v=(x=>{for(const b of sp){if(b.id===x)return b.label;if(b.children){const w=b.children.find(N=>N.id===x);if(w)return w.label}}return"Panel de Administracin"})(g),_=x=>{if(x.id==="salir")return o();x.children&&x.children.length>0?(h(b=>({...b,[x.id]:!b[x.id]})),(x.id!==a||!l)&&(s(x.id),u(x.children[0].id))):(s(x.id),u(null))};return r.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[r.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[r.jsx("strong",{children:"Panel Admin"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),r.jsx("nav",{children:sp.map(x=>r.jsxs("div",{style:{marginBottom:6},children:[r.jsxs("div",{onClick:()=>_(x),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===x.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[r.jsx("span",{children:x.label}),Array.isArray(x.children)&&x.children.length>0?r.jsx("span",{style:{marginLeft:8},children:d[x.id]?"":""}):null]}),Array.isArray(x.children)&&x.children.length>0&&d[x.id]&&r.jsx("div",{style:{marginLeft:12,marginTop:6},children:x.children.map(b=>r.jsx("div",{onClick:()=>{s(x.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},x.id))})]}),r.jsx("main",{style:{flex:1,padding:24},children:p?r.jsx(p,{}):r.jsx(p_,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function cx(){const[o,a]=S.useState(null);S.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return r.jsxs("div",{children:[!o&&r.jsx($0,{onLogin:s}),o&&o.role==="cajero"&&r.jsx(u_,{onLogout:l}),o&&o.role==="admin"&&r.jsx(ox,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&r.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[r.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),r.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',r.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),r.jsx("div",{style:{marginTop:18},children:r.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class ux extends Tu.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[r.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}_v.createRoot(document.getElementById("root")).render(r.jsx(ux,{children:r.jsx(cx,{})}));
