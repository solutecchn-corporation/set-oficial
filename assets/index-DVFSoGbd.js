function hv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function fp(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function gv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var su={exports:{}},cs={};var wg;function pv(){if(wg)return cs;wg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var h=null;if(d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:h,ref:u!==void 0?u:null,props:d}}return cs.Fragment=a,cs.jsx=s,cs.jsxs=s,cs}var Eg;function mv(){return Eg||(Eg=1,su.exports=pv()),su.exports}var i=mv(),lu={exports:{}},us={},ou={exports:{}},cu={};var Cg;function yv(){return Cg||(Cg=1,(function(o){function a(E,U){var Z=E.length;E.push(U);e:for(;0<Z;){var ge=Z-1>>>1,_e=E[ge];if(0<u(_e,U))E[ge]=U,E[Z]=_e,Z=ge;else break e}}function s(E){return E.length===0?null:E[0]}function l(E){if(E.length===0)return null;var U=E[0],Z=E.pop();if(Z!==U){E[0]=Z;e:for(var ge=0,_e=E.length,A=_e>>>1;ge<A;){var D=2*(ge+1)-1,O=E[D],F=D+1,se=E[F];if(0>u(O,Z))F<_e&&0>u(se,O)?(E[ge]=se,E[F]=Z,ge=F):(E[ge]=O,E[D]=Z,ge=D);else if(F<_e&&0>u(se,Z))E[ge]=se,E[F]=Z,ge=F;else break e}}return U}function u(E,U){var Z=E.sortIndex-U.sortIndex;return Z!==0?Z:E.id-U.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();o.unstable_now=function(){return h.now()-g}}var p=[],m=[],v=1,x=null,_=3,b=!1,w=!1,N=!1,R=!1,T=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(E){for(var U=s(m);U!==null;){if(U.callback===null)l(m);else if(U.startTime<=E)l(m),U.sortIndex=U.expirationTime,a(p,U);else break;U=s(m)}}function C(E){if(N=!1,G(E),!w)if(s(p)!==null)w=!0,L||(L=!0,je());else{var U=s(m);U!==null&&X(C,U.startTime-E)}}var L=!1,B=-1,P=5,ve=-1;function J(){return R?!0:!(o.unstable_now()-ve<P)}function oe(){if(R=!1,L){var E=o.unstable_now();ve=E;var U=!0;try{e:{w=!1,N&&(N=!1,$(B),B=-1),b=!0;var Z=_;try{t:{for(G(E),x=s(p);x!==null&&!(x.expirationTime>E&&J());){var ge=x.callback;if(typeof ge=="function"){x.callback=null,_=x.priorityLevel;var _e=ge(x.expirationTime<=E);if(E=o.unstable_now(),typeof _e=="function"){x.callback=_e,G(E),U=!0;break t}x===s(p)&&l(p),G(E)}else l(p);x=s(p)}if(x!==null)U=!0;else{var A=s(m);A!==null&&X(C,A.startTime-E),U=!1}}break e}finally{x=null,_=Z,b=!1}U=void 0}}finally{U?je():L=!1}}}var je;if(typeof M=="function")je=function(){M(oe)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,ee=I.port2;I.port1.onmessage=oe,je=function(){ee.postMessage(null)}}else je=function(){T(oe,0)};function X(E,U){B=T(function(){E(o.unstable_now())},U)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(E){E.callback=null},o.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<E?Math.floor(1e3/E):5},o.unstable_getCurrentPriorityLevel=function(){return _},o.unstable_next=function(E){switch(_){case 1:case 2:case 3:var U=3;break;default:U=_}var Z=_;_=U;try{return E()}finally{_=Z}},o.unstable_requestPaint=function(){R=!0},o.unstable_runWithPriority=function(E,U){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var Z=_;_=E;try{return U()}finally{_=Z}},o.unstable_scheduleCallback=function(E,U,Z){var ge=o.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ge+Z:ge):Z=ge,E){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=Z+_e,E={id:v++,callback:U,priorityLevel:E,startTime:Z,expirationTime:_e,sortIndex:-1},Z>ge?(E.sortIndex=Z,a(m,E),s(p)===null&&E===s(m)&&(N?($(B),B=-1):N=!0,X(C,Z-ge))):(E.sortIndex=_e,a(p,E),w||b||(w=!0,L||(L=!0,je()))),E},o.unstable_shouldYield=J,o.unstable_wrapCallback=function(E){var U=_;return function(){var Z=_;_=U;try{return E.apply(this,arguments)}finally{_=Z}}}})(cu)),cu}var Tg;function vv(){return Tg||(Tg=1,ou.exports=yv()),ou.exports}var uu={exports:{}},Me={};var Ag;function bv(){if(Ag)return Me;Ag=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),_=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=_&&A[_]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,R={};function T(A,D,O){this.props=A,this.context=D,this.refs=R,this.updater=O||w}T.prototype.isReactComponent={},T.prototype.setState=function(A,D){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,D,"setState")},T.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function $(){}$.prototype=T.prototype;function M(A,D,O){this.props=A,this.context=D,this.refs=R,this.updater=O||w}var G=M.prototype=new $;G.constructor=M,N(G,T.prototype),G.isPureReactComponent=!0;var C=Array.isArray;function L(){}var B={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function ve(A,D,O){var F=O.ref;return{$$typeof:o,type:A,key:D,ref:F!==void 0?F:null,props:O}}function J(A,D){return ve(A.type,D,A.props)}function oe(A){return typeof A=="object"&&A!==null&&A.$$typeof===o}function je(A){var D={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(O){return D[O]})}var I=/\/+/g;function ee(A,D){return typeof A=="object"&&A!==null&&A.key!=null?je(""+A.key):D.toString(36)}function X(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(L,L):(A.status="pending",A.then(function(D){A.status==="pending"&&(A.status="fulfilled",A.value=D)},function(D){A.status==="pending"&&(A.status="rejected",A.reason=D)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function E(A,D,O,F,se){var fe=typeof A;(fe==="undefined"||fe==="boolean")&&(A=null);var k=!1;if(A===null)k=!0;else switch(fe){case"bigint":case"string":case"number":k=!0;break;case"object":switch(A.$$typeof){case o:case a:k=!0;break;case v:return k=A._init,E(k(A._payload),D,O,F,se)}}if(k)return se=se(A),k=F===""?"."+ee(A,0):F,C(se)?(O="",k!=null&&(O=k.replace(I,"$&/")+"/"),E(se,D,O,"",function(Se){return Se})):se!=null&&(oe(se)&&(se=J(se,O+(se.key==null||A&&A.key===se.key?"":(""+se.key).replace(I,"$&/")+"/")+k)),D.push(se)),1;k=0;var te=F===""?".":F+":";if(C(A))for(var pe=0;pe<A.length;pe++)F=A[pe],fe=te+ee(F,pe),k+=E(F,D,O,fe,se);else if(pe=b(A),typeof pe=="function")for(A=pe.call(A),pe=0;!(F=A.next()).done;)F=F.value,fe=te+ee(F,pe++),k+=E(F,D,O,fe,se);else if(fe==="object"){if(typeof A.then=="function")return E(X(A),D,O,F,se);throw D=String(A),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return k}function U(A,D,O){if(A==null)return A;var F=[],se=0;return E(A,F,"","",function(fe){return D.call(O,fe,se++)}),F}function Z(A){if(A._status===-1){var D=A._result;D=D(),D.then(function(O){(A._status===0||A._status===-1)&&(A._status=1,A._result=O)},function(O){(A._status===0||A._status===-1)&&(A._status=2,A._result=O)}),A._status===-1&&(A._status=0,A._result=D)}if(A._status===1)return A._result.default;throw A._result}var ge=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},_e={map:U,forEach:function(A,D,O){U(A,function(){D.apply(this,arguments)},O)},count:function(A){var D=0;return U(A,function(){D++}),D},toArray:function(A){return U(A,function(D){return D})||[]},only:function(A){if(!oe(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return Me.Activity=x,Me.Children=_e,Me.Component=T,Me.Fragment=s,Me.Profiler=u,Me.PureComponent=M,Me.StrictMode=l,Me.Suspense=p,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Me.__COMPILER_RUNTIME={__proto__:null,c:function(A){return B.H.useMemoCache(A)}},Me.cache=function(A){return function(){return A.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(A,D,O){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var F=N({},A.props),se=A.key;if(D!=null)for(fe in D.key!==void 0&&(se=""+D.key),D)!P.call(D,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&D.ref===void 0||(F[fe]=D[fe]);var fe=arguments.length-2;if(fe===1)F.children=O;else if(1<fe){for(var k=Array(fe),te=0;te<fe;te++)k[te]=arguments[te+2];F.children=k}return ve(A.type,se,F)},Me.createContext=function(A){return A={$$typeof:h,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:d,_context:A},A},Me.createElement=function(A,D,O){var F,se={},fe=null;if(D!=null)for(F in D.key!==void 0&&(fe=""+D.key),D)P.call(D,F)&&F!=="key"&&F!=="__self"&&F!=="__source"&&(se[F]=D[F]);var k=arguments.length-2;if(k===1)se.children=O;else if(1<k){for(var te=Array(k),pe=0;pe<k;pe++)te[pe]=arguments[pe+2];se.children=te}if(A&&A.defaultProps)for(F in k=A.defaultProps,k)se[F]===void 0&&(se[F]=k[F]);return ve(A,fe,se)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(A){return{$$typeof:g,render:A}},Me.isValidElement=oe,Me.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:Z}},Me.memo=function(A,D){return{$$typeof:m,type:A,compare:D===void 0?null:D}},Me.startTransition=function(A){var D=B.T,O={};B.T=O;try{var F=A(),se=B.S;se!==null&&se(O,F),typeof F=="object"&&F!==null&&typeof F.then=="function"&&F.then(L,ge)}catch(fe){ge(fe)}finally{D!==null&&O.types!==null&&(D.types=O.types),B.T=D}},Me.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Me.use=function(A){return B.H.use(A)},Me.useActionState=function(A,D,O){return B.H.useActionState(A,D,O)},Me.useCallback=function(A,D){return B.H.useCallback(A,D)},Me.useContext=function(A){return B.H.useContext(A)},Me.useDebugValue=function(){},Me.useDeferredValue=function(A,D){return B.H.useDeferredValue(A,D)},Me.useEffect=function(A,D){return B.H.useEffect(A,D)},Me.useEffectEvent=function(A){return B.H.useEffectEvent(A)},Me.useId=function(){return B.H.useId()},Me.useImperativeHandle=function(A,D,O){return B.H.useImperativeHandle(A,D,O)},Me.useInsertionEffect=function(A,D){return B.H.useInsertionEffect(A,D)},Me.useLayoutEffect=function(A,D){return B.H.useLayoutEffect(A,D)},Me.useMemo=function(A,D){return B.H.useMemo(A,D)},Me.useOptimistic=function(A,D){return B.H.useOptimistic(A,D)},Me.useReducer=function(A,D,O){return B.H.useReducer(A,D,O)},Me.useRef=function(A){return B.H.useRef(A)},Me.useState=function(A){return B.H.useState(A)},Me.useSyncExternalStore=function(A,D,O){return B.H.useSyncExternalStore(A,D,O)},Me.useTransition=function(){return B.H.useTransition()},Me.version="19.2.0",Me}var Ng;function Uu(){return Ng||(Ng=1,uu.exports=bv()),uu.exports}var du={exports:{}},$t={};var Rg;function xv(){if(Rg)return $t;Rg=1;var o=Uu();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:x==null?null:""+x,children:p,containerInfo:m,implementation:v}}var h=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return $t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,$t.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},$t.flushSync=function(p){var m=h.T,v=l.p;try{if(h.T=null,l.p=2,p)return p()}finally{h.T=m,l.p=v,l.d.f()}},$t.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},$t.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},$t.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:x,integrity:_,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},$t.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},$t.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},$t.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},$t.requestFormReset=function(p){l.d.r(p)},$t.unstable_batchedUpdates=function(p,m){return p(m)},$t.useFormState=function(p,m,v){return h.H.useFormState(p,m,v)},$t.useFormStatus=function(){return h.H.useHostTransitionStatus()},$t.version="19.2.0",$t}var Og;function hp(){if(Og)return du.exports;Og=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),du.exports=xv(),du.exports}var kg;function _v(){if(kg)return us;kg=1;var o=vv(),a=Uu(),s=hp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,r=t;;){var c=n.return;if(c===null)break;var f=c.alternate;if(f===null){if(r=c.return,r!==null){n=r;continue}break}if(c.child===f.child){for(f=c.child;f;){if(f===n)return p(c),e;if(f===r)return p(c),t;f=f.sibling}throw Error(l(188))}if(n.return!==r.return)n=c,r=f;else{for(var y=!1,S=c.child;S;){if(S===n){y=!0,n=c,r=f;break}if(S===r){y=!0,r=c,n=f;break}S=S.sibling}if(!y){for(S=f.child;S;){if(S===n){y=!0,n=f,r=c;break}if(S===r){y=!0,r=f,n=c;break}S=S.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==r)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,_=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),M=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),ve=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),oe=Symbol.iterator;function je(e){return e===null||typeof e!="object"?null:(e=oe&&e[oe]||e["@@iterator"],typeof e=="function"?e:null)}var I=Symbol.for("react.client.reference");function ee(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===I?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case N:return"Fragment";case T:return"Profiler";case R:return"StrictMode";case C:return"Suspense";case L:return"SuspenseList";case ve:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case M:return e.displayName||"Context";case $:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case B:return t=e.displayName||null,t!==null?t:ee(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return ee(e(t))}catch{}}return null}var X=Array.isArray,E=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},ge=[],_e=-1;function A(e){return{current:e}}function D(e){0>_e||(e.current=ge[_e],ge[_e]=null,_e--)}function O(e,t){_e++,ge[_e]=e.current,e.current=t}var F=A(null),se=A(null),fe=A(null),k=A(null);function te(e,t){switch(O(fe,t),O(se,e),O(F,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Kh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Kh(t),e=Yh(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}D(F),O(F,e)}function pe(){D(F),D(se),D(fe)}function Se(e){e.memoizedState!==null&&O(k,e);var t=F.current,n=Yh(t,e.type);t!==n&&(O(se,e),O(F,n))}function Re(e){se.current===e&&(D(F),D(se)),k.current===e&&(D(k),rs._currentValue=Z)}var De,qe;function Je(e){if(De===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);De=t&&t[1]||"",qe=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+De+e+qe}var pt=!1;function mt(e,t){if(!e||pt)return"";pt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var ue=function(){throw Error()};if(Object.defineProperty(ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ue,[])}catch(W){var Q=W}Reflect.construct(e,[],ue)}else{try{ue.call()}catch(W){Q=W}e.call(ue.prototype)}}else{try{throw Error()}catch(W){Q=W}(ue=e())&&typeof ue.catch=="function"&&ue.catch(function(){})}}catch(W){if(W&&Q&&typeof W.stack=="string")return[W.stack,Q.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=r.DetermineComponentFrameRoot(),y=f[0],S=f[1];if(y&&S){var z=y.split(`
`),Y=S.split(`
`);for(c=r=0;r<z.length&&!z[r].includes("DetermineComponentFrameRoot");)r++;for(;c<Y.length&&!Y[c].includes("DetermineComponentFrameRoot");)c++;if(r===z.length||c===Y.length)for(r=z.length-1,c=Y.length-1;1<=r&&0<=c&&z[r]!==Y[c];)c--;for(;1<=r&&0<=c;r--,c--)if(z[r]!==Y[c]){if(r!==1||c!==1)do if(r--,c--,0>c||z[r]!==Y[c]){var re=`
`+z[r].replace(" at new "," at ");return e.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",e.displayName)),re}while(1<=r&&0<=c);break}}}finally{pt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Je(n):""}function dt(e,t){switch(e.tag){case 26:case 27:case 5:return Je(e.type);case 16:return Je("Lazy");case 13:return e.child!==t&&t!==null?Je("Suspense Fallback"):Je("Suspense");case 19:return Je("SuspenseList");case 0:case 15:return mt(e.type,!1);case 11:return mt(e.type.render,!1);case 1:return mt(e.type,!0);case 31:return Je("Activity");default:return""}}function Et(e){try{var t="",n=null;do t+=dt(e,n),n=e,e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var It=Object.prototype.hasOwnProperty,et=o.unstable_scheduleCallback,nt=o.unstable_cancelCallback,$a=o.unstable_shouldYield,vi=o.unstable_requestPaint,Vt=o.unstable_now,bi=o.unstable_getCurrentPriorityLevel,vs=o.unstable_ImmediatePriority,xi=o.unstable_UserBlockingPriority,Pa=o.unstable_NormalPriority,yr=o.unstable_LowPriority,bs=o.unstable_IdlePriority,xs=o.log,_i=o.unstable_setDisableYieldValue,ca=null,Gt=null;function En(e){if(typeof xs=="function"&&_i(e),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(ca,e)}catch{}}var Ft=Math.clz32?Math.clz32:ji,eo=Math.log,to=Math.LN2;function ji(e){return e>>>=0,e===0?32:31-(eo(e)/to|0)|0}var Si=256,wi=262144,Ei=4194304;function qn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ci(e,t,n){var r=e.pendingLanes;if(r===0)return 0;var c=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var S=r&134217727;return S!==0?(r=S&~f,r!==0?c=qn(r):(y&=S,y!==0?c=qn(y):n||(n=S&~e,n!==0&&(c=qn(n))))):(S=r&~f,S!==0?c=qn(S):y!==0?c=qn(y):n||(n=r&~e,n!==0&&(c=qn(n)))),c===0?0:t!==0&&t!==c&&(t&f)===0&&(f=c&-c,n=t&-t,f>=n||f===32&&(n&4194048)!==0)?t:c}function ua(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function _s(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function js(){var e=Ei;return Ei<<=1,(Ei&62914560)===0&&(Ei=4194304),e}function Cn(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function nn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ss(e,t,n,r,c,f){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var S=e.entanglements,z=e.expirationTimes,Y=e.hiddenUpdates;for(n=y&~n;0<n;){var re=31-Ft(n),ue=1<<re;S[re]=0,z[re]=-1;var Q=Y[re];if(Q!==null)for(Y[re]=null,re=0;re<Q.length;re++){var W=Q[re];W!==null&&(W.lane&=-536870913)}n&=~ue}r!==0&&ws(e,r,0),f!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function ws(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Ft(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|n&261930}function Es(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ft(n),c=1<<r;c&t|e[r]&t&&(e[r]|=t),n&=~c}}function Ti(e,t){var n=t&-t;return n=(n&42)!==0?1:vr(n),(n&(e.suspendedLanes|t))!==0?0:n}function vr(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Va(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function br(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:yg(e.type))}function In(e,t){var n=U.p;try{return U.p=e,t()}finally{U.p=n}}var zn=Math.random().toString(36).slice(2),Ot="__reactFiber$"+zn,Ht="__reactProps$"+zn,Hn="__reactContainer$"+zn,xr="__reactEvents$"+zn,_r="__reactListeners$"+zn,$n="__reactHandles$"+zn,Cs="__reactResources$"+zn,da="__reactMarker$"+zn;function Ai(e){delete e[Ot],delete e[Ht],delete e[xr],delete e[_r],delete e[$n]}function fa(e){var t=e[Ot];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Hn]||n[Ot]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=tg(e);e!==null;){if(n=e[Ot])return n;e=tg(e)}return t}e=n,n=e.parentNode}return null}function ha(e){if(e=e[Ot]||e[Hn]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Ga(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function H(e){var t=e[Cs];return t||(t=e[Cs]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function ae(e){e[da]=!0}var xe=new Set,ie={};function he(e,t){ce(e,t),ce(e+"Capture",t)}function ce(e,t){for(ie[e]=t,e=0;e<t.length;e++)xe.add(t[e])}var ye=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),be={},me={};function de(e){return It.call(me,e)?!0:It.call(be,e)?!1:ye.test(e)?me[e]=!0:(be[e]=!0,!1)}function we(e,t,n){if(de(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Ae(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Le(e,t,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+r)}}function ft(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function bt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function yt(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var c=r.get,f=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ct(e){if(!e._valueTracker){var t=bt(e)?"checked":"value";e._valueTracker=yt(e,t,""+e[t])}}function Un(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=bt(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Kt(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Fa=/[\n"\\]/g;function Yt(e){return e.replace(Fa,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ka(e,t,n,r,c,f,y,S){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+ft(t)):e.value!==""+ft(t)&&(e.value=""+ft(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?hn(e,y,ft(t)):n!=null?hn(e,y,ft(n)):r!=null&&e.removeAttribute("value"),c==null&&f!=null&&(e.defaultChecked=!!f),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.name=""+ft(S):e.removeAttribute("name")}function ga(e,t,n,r,c,f,y,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||n!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){ct(e);return}n=n!=null?""+ft(n):"",t=t!=null?""+ft(t):n,S||t===e.value||(e.value=t),e.defaultValue=t}r=r??c,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=S?e.checked:!!r,e.defaultChecked=!!r,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),ct(e)}function hn(e,t,n){t==="number"&&Kt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ee(e,t,n,r){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ft(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,r&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Ie(e,t,n){if(t!=null&&(t=""+ft(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+ft(n):""}function Qe(e,t,n,r){if(t==null){if(r!=null){if(n!=null)throw Error(l(92));if(X(r)){if(1<r.length)throw Error(l(93));r=r[0]}n=r}n==null&&(n=""),t=n}n=ft(t),e.defaultValue=n,r=e.textContent,r===n&&r!==""&&r!==null&&(e.value=r),ct(e)}function Te(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Pe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xe(e,t,n){var r=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?r?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":r?e.setProperty(t,n):typeof n!="number"||n===0||Pe.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function pa(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var r in n)!n.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var c in t)r=t[c],t.hasOwnProperty(c)&&n[c]!==r&&Xe(e,c,r)}else for(var f in t)t.hasOwnProperty(f)&&Xe(e,f,t[f])}function Pn(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),um=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ts(e){return um.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Vn(){}var no=null;function ao(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ni=null,Ri=null;function Gu(e){var t=ha(e);if(t&&(e=t.stateNode)){var n=e[Ht]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ka(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var c=r[Ht]||null;if(!c)throw Error(l(90));Ka(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)r=n[t],r.form===e.form&&Un(r)}break e;case"textarea":Ie(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Ee(e,!!n.multiple,t,!1)}}}var io=!1;function Fu(e,t,n){if(io)return e(t,n);io=!0;try{var r=e(t);return r}finally{if(io=!1,(Ni!==null||Ri!==null)&&(gl(),Ni&&(t=Ni,e=Ri,Ri=Ni=null,Gu(t),e)))for(t=0;t<e.length;t++)Gu(e[t])}}function jr(e,t){var n=e.stateNode;if(n===null)return null;var r=n[Ht]||null;if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ro=!1;if(Gn)try{var Sr={};Object.defineProperty(Sr,"passive",{get:function(){ro=!0}}),window.addEventListener("test",Sr,Sr),window.removeEventListener("test",Sr,Sr)}catch{ro=!1}var ma=null,so=null,As=null;function Ku(){if(As)return As;var e,t=so,n=t.length,r,c="value"in ma?ma.value:ma.textContent,f=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(r=1;r<=y&&t[n-r]===c[f-r];r++);return As=c.slice(e,1<r?1-r:void 0)}function Ns(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Rs(){return!0}function Yu(){return!1}function Qt(e){function t(n,r,c,f,y){this._reactName=n,this._targetInst=c,this.type=r,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(n=e[S],this[S]=n?n(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Rs:Yu,this.isPropagationStopped=Yu,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Rs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Rs)},persist:function(){},isPersistent:Rs}),t}var Ya={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Os=Qt(Ya),wr=x({},Ya,{view:0,detail:0}),dm=Qt(wr),lo,oo,Er,ks=x({},wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Er&&(Er&&e.type==="mousemove"?(lo=e.screenX-Er.screenX,oo=e.screenY-Er.screenY):oo=lo=0,Er=e),lo)},movementY:function(e){return"movementY"in e?e.movementY:oo}}),Ju=Qt(ks),fm=x({},ks,{dataTransfer:0}),hm=Qt(fm),gm=x({},wr,{relatedTarget:0}),co=Qt(gm),pm=x({},Ya,{animationName:0,elapsedTime:0,pseudoElement:0}),mm=Qt(pm),ym=x({},Ya,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vm=Qt(ym),bm=x({},Ya,{data:0}),Qu=Qt(bm),xm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_m={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=jm[e])?!!t[e]:!1}function uo(){return Sm}var wm=x({},wr,{key:function(e){if(e.key){var t=xm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ns(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_m[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uo,charCode:function(e){return e.type==="keypress"?Ns(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ns(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Em=Qt(wm),Cm=x({},ks,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xu=Qt(Cm),Tm=x({},wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uo}),Am=Qt(Tm),Nm=x({},Ya,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rm=Qt(Nm),Om=x({},ks,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),km=Qt(Om),zm=x({},Ya,{newState:0,oldState:0}),Um=Qt(zm),Dm=[9,13,27,32],fo=Gn&&"CompositionEvent"in window,Cr=null;Gn&&"documentMode"in document&&(Cr=document.documentMode);var Bm=Gn&&"TextEvent"in window&&!Cr,Zu=Gn&&(!fo||Cr&&8<Cr&&11>=Cr),Wu=" ",ed=!1;function td(e,t){switch(e){case"keyup":return Dm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Oi=!1;function Lm(e,t){switch(e){case"compositionend":return nd(t);case"keypress":return t.which!==32?null:(ed=!0,Wu);case"textInput":return e=t.data,e===Wu&&ed?null:e;default:return null}}function Mm(e,t){if(Oi)return e==="compositionend"||!fo&&td(e,t)?(e=Ku(),As=so=ma=null,Oi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Zu&&t.locale!=="ko"?null:t.data;default:return null}}var qm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ad(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qm[e.type]:t==="textarea"}function id(e,t,n,r){Ni?Ri?Ri.push(r):Ri=[r]:Ni=r,t=_l(t,"onChange"),0<t.length&&(n=new Os("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Tr=null,Ar=null;function Im(e){Hh(e,0)}function zs(e){var t=Ga(e);if(Un(t))return e}function rd(e,t){if(e==="change")return t}var sd=!1;if(Gn){var ho;if(Gn){var go="oninput"in document;if(!go){var ld=document.createElement("div");ld.setAttribute("oninput","return;"),go=typeof ld.oninput=="function"}ho=go}else ho=!1;sd=ho&&(!document.documentMode||9<document.documentMode)}function od(){Tr&&(Tr.detachEvent("onpropertychange",cd),Ar=Tr=null)}function cd(e){if(e.propertyName==="value"&&zs(Ar)){var t=[];id(t,Ar,e,ao(e)),Fu(Im,t)}}function Hm(e,t,n){e==="focusin"?(od(),Tr=t,Ar=n,Tr.attachEvent("onpropertychange",cd)):e==="focusout"&&od()}function $m(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zs(Ar)}function Pm(e,t){if(e==="click")return zs(t)}function Vm(e,t){if(e==="input"||e==="change")return zs(t)}function Gm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var an=typeof Object.is=="function"?Object.is:Gm;function Nr(e,t){if(an(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var c=n[r];if(!It.call(t,c)||!an(e[c],t[c]))return!1}return!0}function ud(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dd(e,t){var n=ud(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ud(n)}}function fd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?fd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function hd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Kt(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Kt(e.document)}return t}function po(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Fm=Gn&&"documentMode"in document&&11>=document.documentMode,ki=null,mo=null,Rr=null,yo=!1;function gd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;yo||ki==null||ki!==Kt(r)||(r=ki,"selectionStart"in r&&po(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Rr&&Nr(Rr,r)||(Rr=r,r=_l(mo,"onSelect"),0<r.length&&(t=new Os("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ki)))}function Ja(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var zi={animationend:Ja("Animation","AnimationEnd"),animationiteration:Ja("Animation","AnimationIteration"),animationstart:Ja("Animation","AnimationStart"),transitionrun:Ja("Transition","TransitionRun"),transitionstart:Ja("Transition","TransitionStart"),transitioncancel:Ja("Transition","TransitionCancel"),transitionend:Ja("Transition","TransitionEnd")},vo={},pd={};Gn&&(pd=document.createElement("div").style,"AnimationEvent"in window||(delete zi.animationend.animation,delete zi.animationiteration.animation,delete zi.animationstart.animation),"TransitionEvent"in window||delete zi.transitionend.transition);function Qa(e){if(vo[e])return vo[e];if(!zi[e])return e;var t=zi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in pd)return vo[e]=t[n];return e}var md=Qa("animationend"),yd=Qa("animationiteration"),vd=Qa("animationstart"),Km=Qa("transitionrun"),Ym=Qa("transitionstart"),Jm=Qa("transitioncancel"),bd=Qa("transitionend"),xd=new Map,bo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");bo.push("scrollEnd");function Tn(e,t){xd.set(e,t),he(t,[e])}var Us=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},gn=[],Ui=0,xo=0;function Ds(){for(var e=Ui,t=xo=Ui=0;t<e;){var n=gn[t];gn[t++]=null;var r=gn[t];gn[t++]=null;var c=gn[t];gn[t++]=null;var f=gn[t];if(gn[t++]=null,r!==null&&c!==null){var y=r.pending;y===null?c.next=c:(c.next=y.next,y.next=c),r.pending=c}f!==0&&_d(n,c,f)}}function Bs(e,t,n,r){gn[Ui++]=e,gn[Ui++]=t,gn[Ui++]=n,gn[Ui++]=r,xo|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function _o(e,t,n,r){return Bs(e,t,n,r),Ls(e)}function Xa(e,t){return Bs(e,null,null,t),Ls(e)}function _d(e,t,n){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n);for(var c=!1,f=e.return;f!==null;)f.childLanes|=n,r=f.alternate,r!==null&&(r.childLanes|=n),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(c=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,c&&t!==null&&(c=31-Ft(n),e=f.hiddenUpdates,r=e[c],r===null?e[c]=[t]:r.push(t),t.lane=n|536870912),f):null}function Ls(e){if(50<Zr)throw Zr=0,Rc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Di={};function Qm(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(e,t,n,r){return new Qm(e,t,n,r)}function jo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Fn(e,t){var n=e.alternate;return n===null?(n=rn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function jd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ms(e,t,n,r,c,f){var y=0;if(r=e,typeof e=="function")jo(e)&&(y=1);else if(typeof e=="string")y=tv(e,n,F.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ve:return e=rn(31,n,t,c),e.elementType=ve,e.lanes=f,e;case N:return Za(n.children,c,f,t);case R:y=8,c|=24;break;case T:return e=rn(12,n,t,c|2),e.elementType=T,e.lanes=f,e;case C:return e=rn(13,n,t,c),e.elementType=C,e.lanes=f,e;case L:return e=rn(19,n,t,c),e.elementType=L,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:y=10;break e;case $:y=9;break e;case G:y=11;break e;case B:y=14;break e;case P:y=16,r=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),r=null}return t=rn(y,n,t,c),t.elementType=e,t.type=r,t.lanes=f,t}function Za(e,t,n,r){return e=rn(7,e,r,t),e.lanes=n,e}function So(e,t,n){return e=rn(6,e,null,t),e.lanes=n,e}function Sd(e){var t=rn(18,null,null,0);return t.stateNode=e,t}function wo(e,t,n){return t=rn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var wd=new WeakMap;function pn(e,t){if(typeof e=="object"&&e!==null){var n=wd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Et(t)},wd.set(e,t),t)}return{value:e,source:t,stack:Et(t)}}var Bi=[],Li=0,qs=null,Or=0,mn=[],yn=0,ya=null,Dn=1,Bn="";function Kn(e,t){Bi[Li++]=Or,Bi[Li++]=qs,qs=e,Or=t}function Ed(e,t,n){mn[yn++]=Dn,mn[yn++]=Bn,mn[yn++]=ya,ya=e;var r=Dn;e=Bn;var c=32-Ft(r)-1;r&=~(1<<c),n+=1;var f=32-Ft(t)+c;if(30<f){var y=c-c%5;f=(r&(1<<y)-1).toString(32),r>>=y,c-=y,Dn=1<<32-Ft(t)+c|n<<c|r,Bn=f+e}else Dn=1<<f|n<<c|r,Bn=e}function Eo(e){e.return!==null&&(Kn(e,1),Ed(e,1,0))}function Co(e){for(;e===qs;)qs=Bi[--Li],Bi[Li]=null,Or=Bi[--Li],Bi[Li]=null;for(;e===ya;)ya=mn[--yn],mn[yn]=null,Bn=mn[--yn],mn[yn]=null,Dn=mn[--yn],mn[yn]=null}function Cd(e,t){mn[yn++]=Dn,mn[yn++]=Bn,mn[yn++]=ya,Dn=t.id,Bn=t.overflow,ya=e}var Dt=null,ht=null,Ye=!1,va=null,vn=!1,To=Error(l(519));function ba(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kr(pn(t,e)),To}function Td(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ot]=e,t[Ht]=r,n){case"dialog":Ge("cancel",t),Ge("close",t);break;case"iframe":case"object":case"embed":Ge("load",t);break;case"video":case"audio":for(n=0;n<es.length;n++)Ge(es[n],t);break;case"source":Ge("error",t);break;case"img":case"image":case"link":Ge("error",t),Ge("load",t);break;case"details":Ge("toggle",t);break;case"input":Ge("invalid",t),ga(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Ge("invalid",t);break;case"textarea":Ge("invalid",t),Qe(t,r.value,r.defaultValue,r.children)}n=r.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||r.suppressHydrationWarning===!0||Gh(t.textContent,n)?(r.popover!=null&&(Ge("beforetoggle",t),Ge("toggle",t)),r.onScroll!=null&&Ge("scroll",t),r.onScrollEnd!=null&&Ge("scrollend",t),r.onClick!=null&&(t.onclick=Vn),t=!0):t=!1,t||ba(e,!0)}function Ad(e){for(Dt=e.return;Dt;)switch(Dt.tag){case 5:case 31:case 13:vn=!1;return;case 27:case 3:vn=!0;return;default:Dt=Dt.return}}function Mi(e){if(e!==Dt)return!1;if(!Ye)return Ad(e),Ye=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Gc(e.type,e.memoizedProps)),n=!n),n&&ht&&ba(e),Ad(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ht=eg(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ht=eg(e)}else t===27?(t=ht,za(e.type)?(e=Qc,Qc=null,ht=e):ht=t):ht=Dt?xn(e.stateNode.nextSibling):null;return!0}function Wa(){ht=Dt=null,Ye=!1}function Ao(){var e=va;return e!==null&&(en===null?en=e:en.push.apply(en,e),va=null),e}function kr(e){va===null?va=[e]:va.push(e)}var No=A(null),ei=null,Yn=null;function xa(e,t,n){O(No,t._currentValue),t._currentValue=n}function Jn(e){e._currentValue=No.current,D(No)}function Ro(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Oo(e,t,n,r){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){var y=c.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=c;for(var z=0;z<t.length;z++)if(S.context===t[z]){f.lanes|=n,S=f.alternate,S!==null&&(S.lanes|=n),Ro(f.return,n,e),r||(y=null);break e}f=S.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,f=y.alternate,f!==null&&(f.lanes|=n),Ro(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function qi(e,t,n,r){e=null;for(var c=t,f=!1;c!==null;){if(!f){if((c.flags&524288)!==0)f=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var S=c.type;an(c.pendingProps.value,y.value)||(e!==null?e.push(S):e=[S])}}else if(c===k.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(rs):e=[rs])}c=c.return}e!==null&&Oo(t,e,n,r),t.flags|=262144}function Is(e){for(e=e.firstContext;e!==null;){if(!an(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ti(e){ei=e,Yn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Bt(e){return Nd(ei,e)}function Hs(e,t){return ei===null&&ti(e),Nd(e,t)}function Nd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Yn===null){if(e===null)throw Error(l(308));Yn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Yn=Yn.next=t;return n}var Xm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Zm=o.unstable_scheduleCallback,Wm=o.unstable_NormalPriority,Ct={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ko(){return{controller:new Xm,data:new Map,refCount:0}}function zr(e){e.refCount--,e.refCount===0&&Zm(Wm,function(){e.controller.abort()})}var Ur=null,zo=0,Ii=0,Hi=null;function ey(e,t){if(Ur===null){var n=Ur=[];zo=0,Ii=Bc(),Hi={status:"pending",value:void 0,then:function(r){n.push(r)}}}return zo++,t.then(Rd,Rd),t}function Rd(){if(--zo===0&&Ur!==null){Hi!==null&&(Hi.status="fulfilled");var e=Ur;Ur=null,Ii=0,Hi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function ty(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(r.status="rejected",r.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),r}var Od=E.S;E.S=function(e,t){ph=Vt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&ey(e,t),Od!==null&&Od(e,t)};var ni=A(null);function Uo(){var e=ni.current;return e!==null?e:ot.pooledCache}function $s(e,t){t===null?O(ni,ni.current):O(ni,t.pool)}function kd(){var e=Uo();return e===null?null:{parent:Ct._currentValue,pool:e}}var $i=Error(l(460)),Do=Error(l(474)),Ps=Error(l(542)),Vs={then:function(){}};function zd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Ud(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Vn,Vn),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Bd(e),e;default:if(typeof t.status=="string")t.then(Vn,Vn);else{if(e=ot,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(r){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=r}},function(r){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Bd(e),e}throw ii=t,$i}}function ai(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(ii=n,$i):n}}var ii=null;function Dd(){if(ii===null)throw Error(l(459));var e=ii;return ii=null,e}function Bd(e){if(e===$i||e===Ps)throw Error(l(483))}var Pi=null,Dr=0;function Gs(e){var t=Dr;return Dr+=1,Pi===null&&(Pi=[]),Ud(Pi,e,t)}function Br(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Fs(e,t){throw t.$$typeof===_?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Ld(e){function t(V,q){if(e){var K=V.deletions;K===null?(V.deletions=[q],V.flags|=16):K.push(q)}}function n(V,q){if(!e)return null;for(;q!==null;)t(V,q),q=q.sibling;return null}function r(V){for(var q=new Map;V!==null;)V.key!==null?q.set(V.key,V):q.set(V.index,V),V=V.sibling;return q}function c(V,q){return V=Fn(V,q),V.index=0,V.sibling=null,V}function f(V,q,K){return V.index=K,e?(K=V.alternate,K!==null?(K=K.index,K<q?(V.flags|=67108866,q):K):(V.flags|=67108866,q)):(V.flags|=1048576,q)}function y(V){return e&&V.alternate===null&&(V.flags|=67108866),V}function S(V,q,K,le){return q===null||q.tag!==6?(q=So(K,V.mode,le),q.return=V,q):(q=c(q,K),q.return=V,q)}function z(V,q,K,le){var ze=K.type;return ze===N?re(V,q,K.props.children,le,K.key):q!==null&&(q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===P&&ai(ze)===q.type)?(q=c(q,K.props),Br(q,K),q.return=V,q):(q=Ms(K.type,K.key,K.props,null,V.mode,le),Br(q,K),q.return=V,q)}function Y(V,q,K,le){return q===null||q.tag!==4||q.stateNode.containerInfo!==K.containerInfo||q.stateNode.implementation!==K.implementation?(q=wo(K,V.mode,le),q.return=V,q):(q=c(q,K.children||[]),q.return=V,q)}function re(V,q,K,le,ze){return q===null||q.tag!==7?(q=Za(K,V.mode,le,ze),q.return=V,q):(q=c(q,K),q.return=V,q)}function ue(V,q,K){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=So(""+q,V.mode,K),q.return=V,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case b:return K=Ms(q.type,q.key,q.props,null,V.mode,K),Br(K,q),K.return=V,K;case w:return q=wo(q,V.mode,K),q.return=V,q;case P:return q=ai(q),ue(V,q,K)}if(X(q)||je(q))return q=Za(q,V.mode,K,null),q.return=V,q;if(typeof q.then=="function")return ue(V,Gs(q),K);if(q.$$typeof===M)return ue(V,Hs(V,q),K);Fs(V,q)}return null}function Q(V,q,K,le){var ze=q!==null?q.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return ze!==null?null:S(V,q,""+K,le);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case b:return K.key===ze?z(V,q,K,le):null;case w:return K.key===ze?Y(V,q,K,le):null;case P:return K=ai(K),Q(V,q,K,le)}if(X(K)||je(K))return ze!==null?null:re(V,q,K,le,null);if(typeof K.then=="function")return Q(V,q,Gs(K),le);if(K.$$typeof===M)return Q(V,q,Hs(V,K),le);Fs(V,K)}return null}function W(V,q,K,le,ze){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return V=V.get(K)||null,S(q,V,""+le,ze);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case b:return V=V.get(le.key===null?K:le.key)||null,z(q,V,le,ze);case w:return V=V.get(le.key===null?K:le.key)||null,Y(q,V,le,ze);case P:return le=ai(le),W(V,q,K,le,ze)}if(X(le)||je(le))return V=V.get(K)||null,re(q,V,le,ze,null);if(typeof le.then=="function")return W(V,q,K,Gs(le),ze);if(le.$$typeof===M)return W(V,q,K,Hs(q,le),ze);Fs(q,le)}return null}function Ce(V,q,K,le){for(var ze=null,Ze=null,Ne=q,$e=q=0,Ke=null;Ne!==null&&$e<K.length;$e++){Ne.index>$e?(Ke=Ne,Ne=null):Ke=Ne.sibling;var We=Q(V,Ne,K[$e],le);if(We===null){Ne===null&&(Ne=Ke);break}e&&Ne&&We.alternate===null&&t(V,Ne),q=f(We,q,$e),Ze===null?ze=We:Ze.sibling=We,Ze=We,Ne=Ke}if($e===K.length)return n(V,Ne),Ye&&Kn(V,$e),ze;if(Ne===null){for(;$e<K.length;$e++)Ne=ue(V,K[$e],le),Ne!==null&&(q=f(Ne,q,$e),Ze===null?ze=Ne:Ze.sibling=Ne,Ze=Ne);return Ye&&Kn(V,$e),ze}for(Ne=r(Ne);$e<K.length;$e++)Ke=W(Ne,V,$e,K[$e],le),Ke!==null&&(e&&Ke.alternate!==null&&Ne.delete(Ke.key===null?$e:Ke.key),q=f(Ke,q,$e),Ze===null?ze=Ke:Ze.sibling=Ke,Ze=Ke);return e&&Ne.forEach(function(Ma){return t(V,Ma)}),Ye&&Kn(V,$e),ze}function Ue(V,q,K,le){if(K==null)throw Error(l(151));for(var ze=null,Ze=null,Ne=q,$e=q=0,Ke=null,We=K.next();Ne!==null&&!We.done;$e++,We=K.next()){Ne.index>$e?(Ke=Ne,Ne=null):Ke=Ne.sibling;var Ma=Q(V,Ne,We.value,le);if(Ma===null){Ne===null&&(Ne=Ke);break}e&&Ne&&Ma.alternate===null&&t(V,Ne),q=f(Ma,q,$e),Ze===null?ze=Ma:Ze.sibling=Ma,Ze=Ma,Ne=Ke}if(We.done)return n(V,Ne),Ye&&Kn(V,$e),ze;if(Ne===null){for(;!We.done;$e++,We=K.next())We=ue(V,We.value,le),We!==null&&(q=f(We,q,$e),Ze===null?ze=We:Ze.sibling=We,Ze=We);return Ye&&Kn(V,$e),ze}for(Ne=r(Ne);!We.done;$e++,We=K.next())We=W(Ne,V,$e,We.value,le),We!==null&&(e&&We.alternate!==null&&Ne.delete(We.key===null?$e:We.key),q=f(We,q,$e),Ze===null?ze=We:Ze.sibling=We,Ze=We);return e&&Ne.forEach(function(fv){return t(V,fv)}),Ye&&Kn(V,$e),ze}function lt(V,q,K,le){if(typeof K=="object"&&K!==null&&K.type===N&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case b:e:{for(var ze=K.key;q!==null;){if(q.key===ze){if(ze=K.type,ze===N){if(q.tag===7){n(V,q.sibling),le=c(q,K.props.children),le.return=V,V=le;break e}}else if(q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===P&&ai(ze)===q.type){n(V,q.sibling),le=c(q,K.props),Br(le,K),le.return=V,V=le;break e}n(V,q);break}else t(V,q);q=q.sibling}K.type===N?(le=Za(K.props.children,V.mode,le,K.key),le.return=V,V=le):(le=Ms(K.type,K.key,K.props,null,V.mode,le),Br(le,K),le.return=V,V=le)}return y(V);case w:e:{for(ze=K.key;q!==null;){if(q.key===ze)if(q.tag===4&&q.stateNode.containerInfo===K.containerInfo&&q.stateNode.implementation===K.implementation){n(V,q.sibling),le=c(q,K.children||[]),le.return=V,V=le;break e}else{n(V,q);break}else t(V,q);q=q.sibling}le=wo(K,V.mode,le),le.return=V,V=le}return y(V);case P:return K=ai(K),lt(V,q,K,le)}if(X(K))return Ce(V,q,K,le);if(je(K)){if(ze=je(K),typeof ze!="function")throw Error(l(150));return K=ze.call(K),Ue(V,q,K,le)}if(typeof K.then=="function")return lt(V,q,Gs(K),le);if(K.$$typeof===M)return lt(V,q,Hs(V,K),le);Fs(V,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,q!==null&&q.tag===6?(n(V,q.sibling),le=c(q,K),le.return=V,V=le):(n(V,q),le=So(K,V.mode,le),le.return=V,V=le),y(V)):n(V,q)}return function(V,q,K,le){try{Dr=0;var ze=lt(V,q,K,le);return Pi=null,ze}catch(Ne){if(Ne===$i||Ne===Ps)throw Ne;var Ze=rn(29,Ne,null,V.mode);return Ze.lanes=le,Ze.return=V,Ze}finally{}}}var ri=Ld(!0),Md=Ld(!1),_a=!1;function Bo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Lo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ja(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Sa(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(tt&2)!==0){var c=r.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),r.pending=t,t=Ls(e),_d(e,null,n),t}return Bs(e,r,t,n),Ls(e)}function Lr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Es(e,n)}}function Mo(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var c=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};f===null?c=f=y:f=f.next=y,n=n.next}while(n!==null);f===null?c=f=t:f=f.next=t}else c=f=t;n={baseState:r.baseState,firstBaseUpdate:c,lastBaseUpdate:f,shared:r.shared,callbacks:r.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var qo=!1;function Mr(){if(qo){var e=Hi;if(e!==null)throw e}}function qr(e,t,n,r){qo=!1;var c=e.updateQueue;_a=!1;var f=c.firstBaseUpdate,y=c.lastBaseUpdate,S=c.shared.pending;if(S!==null){c.shared.pending=null;var z=S,Y=z.next;z.next=null,y===null?f=Y:y.next=Y,y=z;var re=e.alternate;re!==null&&(re=re.updateQueue,S=re.lastBaseUpdate,S!==y&&(S===null?re.firstBaseUpdate=Y:S.next=Y,re.lastBaseUpdate=z))}if(f!==null){var ue=c.baseState;y=0,re=Y=z=null,S=f;do{var Q=S.lane&-536870913,W=Q!==S.lane;if(W?(Fe&Q)===Q:(r&Q)===Q){Q!==0&&Q===Ii&&(qo=!0),re!==null&&(re=re.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ce=e,Ue=S;Q=t;var lt=n;switch(Ue.tag){case 1:if(Ce=Ue.payload,typeof Ce=="function"){ue=Ce.call(lt,ue,Q);break e}ue=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Ue.payload,Q=typeof Ce=="function"?Ce.call(lt,ue,Q):Ce,Q==null)break e;ue=x({},ue,Q);break e;case 2:_a=!0}}Q=S.callback,Q!==null&&(e.flags|=64,W&&(e.flags|=8192),W=c.callbacks,W===null?c.callbacks=[Q]:W.push(Q))}else W={lane:Q,tag:S.tag,payload:S.payload,callback:S.callback,next:null},re===null?(Y=re=W,z=ue):re=re.next=W,y|=Q;if(S=S.next,S===null){if(S=c.shared.pending,S===null)break;W=S,S=W.next,W.next=null,c.lastBaseUpdate=W,c.shared.pending=null}}while(!0);re===null&&(z=ue),c.baseState=z,c.firstBaseUpdate=Y,c.lastBaseUpdate=re,f===null&&(c.shared.lanes=0),Aa|=y,e.lanes=y,e.memoizedState=ue}}function qd(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function Id(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)qd(n[e],t)}var Vi=A(null),Ks=A(0);function Hd(e,t){e=ia,O(Ks,e),O(Vi,t),ia=e|t.baseLanes}function Io(){O(Ks,ia),O(Vi,Vi.current)}function Ho(){ia=Ks.current,D(Vi),D(Ks)}var sn=A(null),bn=null;function wa(e){var t=e.alternate;O(St,St.current&1),O(sn,e),bn===null&&(t===null||Vi.current!==null||t.memoizedState!==null)&&(bn=e)}function $o(e){O(St,St.current),O(sn,e),bn===null&&(bn=e)}function $d(e){e.tag===22?(O(St,St.current),O(sn,e),bn===null&&(bn=e)):Ea()}function Ea(){O(St,St.current),O(sn,sn.current)}function ln(e){D(sn),bn===e&&(bn=null),D(St)}var St=A(0);function Ys(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Yc(n)||Jc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qn=0,He=null,rt=null,Tt=null,Js=!1,Gi=!1,si=!1,Qs=0,Ir=0,Fi=null,ny=0;function _t(){throw Error(l(321))}function Po(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!an(e[n],t[n]))return!1;return!0}function Vo(e,t,n,r,c,f){return Qn=f,He=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,E.H=e===null||e.memoizedState===null?Cf:rc,si=!1,f=n(r,c),si=!1,Gi&&(f=Vd(t,n,r,c)),Pd(e),f}function Pd(e){E.H=Pr;var t=rt!==null&&rt.next!==null;if(Qn=0,Tt=rt=He=null,Js=!1,Ir=0,Fi=null,t)throw Error(l(300));e===null||At||(e=e.dependencies,e!==null&&Is(e)&&(At=!0))}function Vd(e,t,n,r){He=e;var c=0;do{if(Gi&&(Fi=null),Ir=0,Gi=!1,25<=c)throw Error(l(301));if(c+=1,Tt=rt=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}E.H=Tf,f=t(n,r)}while(Gi);return f}function ay(){var e=E.H,t=e.useState()[0];return t=typeof t.then=="function"?Hr(t):t,e=e.useState()[0],(rt!==null?rt.memoizedState:null)!==e&&(He.flags|=1024),t}function Go(){var e=Qs!==0;return Qs=0,e}function Fo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Ko(e){if(Js){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Js=!1}Qn=0,Tt=rt=He=null,Gi=!1,Ir=Qs=0,Fi=null}function Jt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?He.memoizedState=Tt=e:Tt=Tt.next=e,Tt}function wt(){if(rt===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=rt.next;var t=Tt===null?He.memoizedState:Tt.next;if(t!==null)Tt=t,rt=e;else{if(e===null)throw He.alternate===null?Error(l(467)):Error(l(310));rt=e,e={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},Tt===null?He.memoizedState=Tt=e:Tt=Tt.next=e}return Tt}function Xs(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hr(e){var t=Ir;return Ir+=1,Fi===null&&(Fi=[]),e=Ud(Fi,e,t),t=He,(Tt===null?t.memoizedState:Tt.next)===null&&(t=t.alternate,E.H=t===null||t.memoizedState===null?Cf:rc),e}function Zs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Hr(e);if(e.$$typeof===M)return Bt(e)}throw Error(l(438,String(e)))}function Yo(e){var t=null,n=He.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var r=He.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Xs(),He.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=J;return t.index++,n}function Xn(e,t){return typeof t=="function"?t(e):t}function Ws(e){var t=wt();return Jo(t,rt,e)}function Jo(e,t,n){var r=e.queue;if(r===null)throw Error(l(311));r.lastRenderedReducer=n;var c=e.baseQueue,f=r.pending;if(f!==null){if(c!==null){var y=c.next;c.next=f.next,f.next=y}t.baseQueue=c=f,r.pending=null}if(f=e.baseState,c===null)e.memoizedState=f;else{t=c.next;var S=y=null,z=null,Y=t,re=!1;do{var ue=Y.lane&-536870913;if(ue!==Y.lane?(Fe&ue)===ue:(Qn&ue)===ue){var Q=Y.revertLane;if(Q===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),ue===Ii&&(re=!0);else if((Qn&Q)===Q){Y=Y.next,Q===Ii&&(re=!0);continue}else ue={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},z===null?(S=z=ue,y=f):z=z.next=ue,He.lanes|=Q,Aa|=Q;ue=Y.action,si&&n(f,ue),f=Y.hasEagerState?Y.eagerState:n(f,ue)}else Q={lane:ue,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},z===null?(S=z=Q,y=f):z=z.next=Q,He.lanes|=ue,Aa|=ue;Y=Y.next}while(Y!==null&&Y!==t);if(z===null?y=f:z.next=S,!an(f,e.memoizedState)&&(At=!0,re&&(n=Hi,n!==null)))throw n;e.memoizedState=f,e.baseState=y,e.baseQueue=z,r.lastRenderedState=f}return c===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Qo(e){var t=wt(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var r=n.dispatch,c=n.pending,f=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do f=e(f,y.action),y=y.next;while(y!==c);an(f,t.memoizedState)||(At=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,r]}function Gd(e,t,n){var r=He,c=wt(),f=Ye;if(f){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!an((rt||c).memoizedState,n);if(y&&(c.memoizedState=n,At=!0),c=c.queue,Wo(Yd.bind(null,r,c,e),[e]),c.getSnapshot!==t||y||Tt!==null&&Tt.memoizedState.tag&1){if(r.flags|=2048,Ki(9,{destroy:void 0},Kd.bind(null,r,c,n,t),null),ot===null)throw Error(l(349));f||(Qn&127)!==0||Fd(r,t,n)}return n}function Fd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=He.updateQueue,t===null?(t=Xs(),He.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Kd(e,t,n,r){t.value=n,t.getSnapshot=r,Jd(t)&&Qd(e)}function Yd(e,t,n){return n(function(){Jd(t)&&Qd(e)})}function Jd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!an(e,n)}catch{return!0}}function Qd(e){var t=Xa(e,2);t!==null&&tn(t,e,2)}function Xo(e){var t=Jt();if(typeof e=="function"){var n=e;if(e=n(),si){En(!0);try{n()}finally{En(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:e},t}function Xd(e,t,n,r){return e.baseState=n,Jo(e,rt,typeof r=="function"?r:Xn)}function iy(e,t,n,r,c){if(nl(e))throw Error(l(485));if(e=t.action,e!==null){var f={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};E.T!==null?n(!0):f.isTransition=!1,r(f),n=t.pending,n===null?(f.next=t.pending=f,Zd(t,f)):(f.next=n.next,t.pending=n.next=f)}}function Zd(e,t){var n=t.action,r=t.payload,c=e.state;if(t.isTransition){var f=E.T,y={};E.T=y;try{var S=n(c,r),z=E.S;z!==null&&z(y,S),Wd(e,t,S)}catch(Y){Zo(e,t,Y)}finally{f!==null&&y.types!==null&&(f.types=y.types),E.T=f}}else try{f=n(c,r),Wd(e,t,f)}catch(Y){Zo(e,t,Y)}}function Wd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(r){ef(e,t,r)},function(r){return Zo(e,t,r)}):ef(e,t,n)}function ef(e,t,n){t.status="fulfilled",t.value=n,tf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Zd(e,n)))}function Zo(e,t,n){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=n,tf(t),t=t.next;while(t!==r)}e.action=null}function tf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function nf(e,t){return t}function af(e,t){if(Ye){var n=ot.formState;if(n!==null){e:{var r=He;if(Ye){if(ht){t:{for(var c=ht,f=vn;c.nodeType!==8;){if(!f){c=null;break t}if(c=xn(c.nextSibling),c===null){c=null;break t}}f=c.data,c=f==="F!"||f==="F"?c:null}if(c){ht=xn(c.nextSibling),r=c.data==="F!";break e}}ba(r)}r=!1}r&&(t=n[0])}}return n=Jt(),n.memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nf,lastRenderedState:t},n.queue=r,n=Sf.bind(null,He,r),r.dispatch=n,r=Xo(!1),f=ic.bind(null,He,!1,r.queue),r=Jt(),c={state:t,dispatch:null,action:e,pending:null},r.queue=c,n=iy.bind(null,He,c,f,n),c.dispatch=n,r.memoizedState=e,[t,n,!1]}function rf(e){var t=wt();return sf(t,rt,e)}function sf(e,t,n){if(t=Jo(e,t,nf)[0],e=Ws(Xn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=Hr(t)}catch(y){throw y===$i?Ps:y}else r=t;t=wt();var c=t.queue,f=c.dispatch;return n!==t.memoizedState&&(He.flags|=2048,Ki(9,{destroy:void 0},ry.bind(null,c,n),null)),[r,f,e]}function ry(e,t){e.action=t}function lf(e){var t=wt(),n=rt;if(n!==null)return sf(t,n,e);wt(),t=t.memoizedState,n=wt();var r=n.queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Ki(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},t=He.updateQueue,t===null&&(t=Xs(),He.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function of(){return wt().memoizedState}function el(e,t,n,r){var c=Jt();He.flags|=e,c.memoizedState=Ki(1|t,{destroy:void 0},n,r===void 0?null:r)}function tl(e,t,n,r){var c=wt();r=r===void 0?null:r;var f=c.memoizedState.inst;rt!==null&&r!==null&&Po(r,rt.memoizedState.deps)?c.memoizedState=Ki(t,f,n,r):(He.flags|=e,c.memoizedState=Ki(1|t,f,n,r))}function cf(e,t){el(8390656,8,e,t)}function Wo(e,t){tl(2048,8,e,t)}function sy(e){He.flags|=4;var t=He.updateQueue;if(t===null)t=Xs(),He.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function uf(e){var t=wt().memoizedState;return sy({ref:t,nextImpl:e}),function(){if((tt&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function df(e,t){return tl(4,2,e,t)}function ff(e,t){return tl(4,4,e,t)}function hf(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gf(e,t,n){n=n!=null?n.concat([e]):null,tl(4,4,hf.bind(null,t,e),n)}function ec(){}function pf(e,t){var n=wt();t=t===void 0?null:t;var r=n.memoizedState;return t!==null&&Po(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function mf(e,t){var n=wt();t=t===void 0?null:t;var r=n.memoizedState;if(t!==null&&Po(t,r[1]))return r[0];if(r=e(),si){En(!0);try{e()}finally{En(!1)}}return n.memoizedState=[r,t],r}function tc(e,t,n){return n===void 0||(Qn&1073741824)!==0&&(Fe&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=yh(),He.lanes|=e,Aa|=e,n)}function yf(e,t,n,r){return an(n,t)?n:Vi.current!==null?(e=tc(e,n,r),an(e,t)||(At=!0),e):(Qn&42)===0||(Qn&1073741824)!==0&&(Fe&261930)===0?(At=!0,e.memoizedState=n):(e=yh(),He.lanes|=e,Aa|=e,t)}function vf(e,t,n,r,c){var f=U.p;U.p=f!==0&&8>f?f:8;var y=E.T,S={};E.T=S,ic(e,!1,t,n);try{var z=c(),Y=E.S;if(Y!==null&&Y(S,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var re=ty(z,r);$r(e,t,re,un(e))}else $r(e,t,r,un(e))}catch(ue){$r(e,t,{then:function(){},status:"rejected",reason:ue},un())}finally{U.p=f,y!==null&&S.types!==null&&(y.types=S.types),E.T=y}}function ly(){}function nc(e,t,n,r){if(e.tag!==5)throw Error(l(476));var c=bf(e).queue;vf(e,c,t,Z,n===null?ly:function(){return xf(e),n(r)})}function bf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:Z},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function xf(e){var t=bf(e);t.next===null&&(t=e.alternate.memoizedState),$r(e,t.next.queue,{},un())}function ac(){return Bt(rs)}function _f(){return wt().memoizedState}function jf(){return wt().memoizedState}function oy(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=un();e=ja(n);var r=Sa(t,e,n);r!==null&&(tn(r,t,n),Lr(r,t,n)),t={cache:ko()},e.payload=t;return}t=t.return}}function cy(e,t,n){var r=un();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},nl(e)?wf(t,n):(n=_o(e,t,n,r),n!==null&&(tn(n,e,r),Ef(n,t,r)))}function Sf(e,t,n){var r=un();$r(e,t,n,r)}function $r(e,t,n,r){var c={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(nl(e))wf(t,c);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,S=f(y,n);if(c.hasEagerState=!0,c.eagerState=S,an(S,y))return Bs(e,t,c,0),ot===null&&Ds(),!1}catch{}finally{}if(n=_o(e,t,c,r),n!==null)return tn(n,e,r),Ef(n,t,r),!0}return!1}function ic(e,t,n,r){if(r={lane:2,revertLane:Bc(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},nl(e)){if(t)throw Error(l(479))}else t=_o(e,n,r,2),t!==null&&tn(t,e,2)}function nl(e){var t=e.alternate;return e===He||t!==null&&t===He}function wf(e,t){Gi=Js=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ef(e,t,n){if((n&4194048)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Es(e,n)}}var Pr={readContext:Bt,use:Zs,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useLayoutEffect:_t,useInsertionEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useSyncExternalStore:_t,useId:_t,useHostTransitionStatus:_t,useFormState:_t,useActionState:_t,useOptimistic:_t,useMemoCache:_t,useCacheRefresh:_t};Pr.useEffectEvent=_t;var Cf={readContext:Bt,use:Zs,useCallback:function(e,t){return Jt().memoizedState=[e,t===void 0?null:t],e},useContext:Bt,useEffect:cf,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,el(4194308,4,hf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return el(4194308,4,e,t)},useInsertionEffect:function(e,t){el(4,2,e,t)},useMemo:function(e,t){var n=Jt();t=t===void 0?null:t;var r=e();if(si){En(!0);try{e()}finally{En(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Jt();if(n!==void 0){var c=n(t);if(si){En(!0);try{n(t)}finally{En(!1)}}}else c=t;return r.memoizedState=r.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},r.queue=e,e=e.dispatch=cy.bind(null,He,e),[r.memoizedState,e]},useRef:function(e){var t=Jt();return e={current:e},t.memoizedState=e},useState:function(e){e=Xo(e);var t=e.queue,n=Sf.bind(null,He,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:ec,useDeferredValue:function(e,t){var n=Jt();return tc(n,e,t)},useTransition:function(){var e=Xo(!1);return e=vf.bind(null,He,e.queue,!0,!1),Jt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=He,c=Jt();if(Ye){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),ot===null)throw Error(l(349));(Fe&127)!==0||Fd(r,t,n)}c.memoizedState=n;var f={value:n,getSnapshot:t};return c.queue=f,cf(Yd.bind(null,r,f,e),[e]),r.flags|=2048,Ki(9,{destroy:void 0},Kd.bind(null,r,f,n,t),null),n},useId:function(){var e=Jt(),t=ot.identifierPrefix;if(Ye){var n=Bn,r=Dn;n=(r&~(1<<32-Ft(r)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Qs++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=ny++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ac,useFormState:af,useActionState:af,useOptimistic:function(e){var t=Jt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ic.bind(null,He,!0,n),n.dispatch=t,[e,t]},useMemoCache:Yo,useCacheRefresh:function(){return Jt().memoizedState=oy.bind(null,He)},useEffectEvent:function(e){var t=Jt(),n={impl:e};return t.memoizedState=n,function(){if((tt&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},rc={readContext:Bt,use:Zs,useCallback:pf,useContext:Bt,useEffect:Wo,useImperativeHandle:gf,useInsertionEffect:df,useLayoutEffect:ff,useMemo:mf,useReducer:Ws,useRef:of,useState:function(){return Ws(Xn)},useDebugValue:ec,useDeferredValue:function(e,t){var n=wt();return yf(n,rt.memoizedState,e,t)},useTransition:function(){var e=Ws(Xn)[0],t=wt().memoizedState;return[typeof e=="boolean"?e:Hr(e),t]},useSyncExternalStore:Gd,useId:_f,useHostTransitionStatus:ac,useFormState:rf,useActionState:rf,useOptimistic:function(e,t){var n=wt();return Xd(n,rt,e,t)},useMemoCache:Yo,useCacheRefresh:jf};rc.useEffectEvent=uf;var Tf={readContext:Bt,use:Zs,useCallback:pf,useContext:Bt,useEffect:Wo,useImperativeHandle:gf,useInsertionEffect:df,useLayoutEffect:ff,useMemo:mf,useReducer:Qo,useRef:of,useState:function(){return Qo(Xn)},useDebugValue:ec,useDeferredValue:function(e,t){var n=wt();return rt===null?tc(n,e,t):yf(n,rt.memoizedState,e,t)},useTransition:function(){var e=Qo(Xn)[0],t=wt().memoizedState;return[typeof e=="boolean"?e:Hr(e),t]},useSyncExternalStore:Gd,useId:_f,useHostTransitionStatus:ac,useFormState:lf,useActionState:lf,useOptimistic:function(e,t){var n=wt();return rt!==null?Xd(n,rt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Yo,useCacheRefresh:jf};Tf.useEffectEvent=uf;function sc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:x({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var lc={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=un(),c=ja(r);c.payload=t,n!=null&&(c.callback=n),t=Sa(e,c,r),t!==null&&(tn(t,e,r),Lr(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=un(),c=ja(r);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=Sa(e,c,r),t!==null&&(tn(t,e,r),Lr(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=un(),r=ja(n);r.tag=2,t!=null&&(r.callback=t),t=Sa(e,r,n),t!==null&&(tn(t,e,n),Lr(t,e,n))}};function Af(e,t,n,r,c,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,f,y):t.prototype&&t.prototype.isPureReactComponent?!Nr(n,r)||!Nr(c,f):!0}function Nf(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&lc.enqueueReplaceState(t,t.state,null)}function li(e,t){var n=t;if("ref"in t){n={};for(var r in t)r!=="ref"&&(n[r]=t[r])}if(e=e.defaultProps){n===t&&(n=x({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Rf(e){Us(e)}function Of(e){console.error(e)}function kf(e){Us(e)}function al(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function zf(e,t,n){try{var r=e.onCaughtError;r(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function oc(e,t,n){return n=ja(n),n.tag=3,n.payload={element:null},n.callback=function(){al(e,t)},n}function Uf(e){return e=ja(e),e.tag=3,e}function Df(e,t,n,r){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var f=r.value;e.payload=function(){return c(f)},e.callback=function(){zf(t,n,r)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){zf(t,n,r),typeof c!="function"&&(Na===null?Na=new Set([this]):Na.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})})}function uy(e,t,n,r,c){if(n.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=n.alternate,t!==null&&qi(t,n,c,!0),n=sn.current,n!==null){switch(n.tag){case 31:case 13:return bn===null?pl():n.alternate===null&&jt===0&&(jt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,r===Vs?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([r]):t.add(r),zc(e,r,c)),!1;case 22:return n.flags|=65536,r===Vs?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([r]):n.add(r)),zc(e,r,c)),!1}throw Error(l(435,n.tag))}return zc(e,r,c),pl(),!1}if(Ye)return t=sn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,r!==To&&(e=Error(l(422),{cause:r}),kr(pn(e,n)))):(r!==To&&(t=Error(l(423),{cause:r}),kr(pn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,r=pn(r,n),c=oc(e.stateNode,r,c),Mo(e,c),jt!==4&&(jt=2)),!1;var f=Error(l(520),{cause:r});if(f=pn(f,n),Xr===null?Xr=[f]:Xr.push(f),jt!==4&&(jt=2),t===null)return!0;r=pn(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=oc(n.stateNode,r,e),Mo(n,e),!1;case 1:if(t=n.type,f=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Na===null||!Na.has(f))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Uf(c),Df(c,e,n,r),Mo(n,c),!1}n=n.return}while(n!==null);return!1}var cc=Error(l(461)),At=!1;function Lt(e,t,n,r){t.child=e===null?Md(t,null,n,r):ri(t,e.child,n,r)}function Bf(e,t,n,r,c){n=n.render;var f=t.ref;if("ref"in r){var y={};for(var S in r)S!=="ref"&&(y[S]=r[S])}else y=r;return ti(t),r=Vo(e,t,n,y,f,c),S=Go(),e!==null&&!At?(Fo(e,t,c),Zn(e,t,c)):(Ye&&S&&Eo(t),t.flags|=1,Lt(e,t,r,c),t.child)}function Lf(e,t,n,r,c){if(e===null){var f=n.type;return typeof f=="function"&&!jo(f)&&f.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=f,Mf(e,t,f,r,c)):(e=Ms(n.type,null,r,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!yc(e,c)){var y=f.memoizedProps;if(n=n.compare,n=n!==null?n:Nr,n(y,r)&&e.ref===t.ref)return Zn(e,t,c)}return t.flags|=1,e=Fn(f,r),e.ref=t.ref,e.return=t,t.child=e}function Mf(e,t,n,r,c){if(e!==null){var f=e.memoizedProps;if(Nr(f,r)&&e.ref===t.ref)if(At=!1,t.pendingProps=r=f,yc(e,c))(e.flags&131072)!==0&&(At=!0);else return t.lanes=e.lanes,Zn(e,t,c)}return uc(e,t,n,r,c)}function qf(e,t,n,r){var c=r.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;r=c&~f}else r=0,t.child=null;return If(e,t,f,n,r)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&$s(t,f!==null?f.cachePool:null),f!==null?Hd(t,f):Io(),$d(t);else return r=t.lanes=536870912,If(e,t,f!==null?f.baseLanes|n:n,n,r)}else f!==null?($s(t,f.cachePool),Hd(t,f),Ea(),t.memoizedState=null):(e!==null&&$s(t,null),Io(),Ea());return Lt(e,t,c,n),t.child}function Vr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function If(e,t,n,r,c){var f=Uo();return f=f===null?null:{parent:Ct._currentValue,pool:f},t.memoizedState={baseLanes:n,cachePool:f},e!==null&&$s(t,null),Io(),$d(t),e!==null&&qi(e,t,r,!0),t.childLanes=c,null}function il(e,t){return t=sl({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Hf(e,t,n){return ri(t,e.child,null,n),e=il(t,t.pendingProps),e.flags|=2,ln(t),t.memoizedState=null,e}function dy(e,t,n){var r=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ye){if(r.mode==="hidden")return e=il(t,r),t.lanes=536870912,Vr(null,e);if($o(t),(e=ht)?(e=Wh(e,vn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ya!==null?{id:Dn,overflow:Bn}:null,retryLane:536870912,hydrationErrors:null},n=Sd(e),n.return=t,t.child=n,Dt=t,ht=null)):e=null,e===null)throw ba(t);return t.lanes=536870912,null}return il(t,r)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if($o(t),c)if(t.flags&256)t.flags&=-257,t=Hf(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(At||qi(e,t,n,!1),c=(n&e.childLanes)!==0,At||c){if(r=ot,r!==null&&(y=Ti(r,n),y!==0&&y!==f.retryLane))throw f.retryLane=y,Xa(e,y),tn(r,e,y),cc;pl(),t=Hf(e,t,n)}else e=f.treeContext,ht=xn(y.nextSibling),Dt=t,Ye=!0,va=null,vn=!1,e!==null&&Cd(t,e),t=il(t,r),t.flags|=4096;return t}return e=Fn(e.child,{mode:r.mode,children:r.children}),e.ref=t.ref,t.child=e,e.return=t,e}function rl(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function uc(e,t,n,r,c){return ti(t),n=Vo(e,t,n,r,void 0,c),r=Go(),e!==null&&!At?(Fo(e,t,c),Zn(e,t,c)):(Ye&&r&&Eo(t),t.flags|=1,Lt(e,t,n,c),t.child)}function $f(e,t,n,r,c,f){return ti(t),t.updateQueue=null,n=Vd(t,r,n,c),Pd(e),r=Go(),e!==null&&!At?(Fo(e,t,f),Zn(e,t,f)):(Ye&&r&&Eo(t),t.flags|=1,Lt(e,t,n,f),t.child)}function Pf(e,t,n,r,c){if(ti(t),t.stateNode===null){var f=Di,y=n.contextType;typeof y=="object"&&y!==null&&(f=Bt(y)),f=new n(r,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=lc,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=r,f.state=t.memoizedState,f.refs={},Bo(t),y=n.contextType,f.context=typeof y=="object"&&y!==null?Bt(y):Di,f.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(sc(t,n,y,r),f.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&lc.enqueueReplaceState(f,f.state,null),qr(t,r,f,c),Mr(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(e===null){f=t.stateNode;var S=t.memoizedProps,z=li(n,S);f.props=z;var Y=f.context,re=n.contextType;y=Di,typeof re=="object"&&re!==null&&(y=Bt(re));var ue=n.getDerivedStateFromProps;re=typeof ue=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=t.pendingProps!==S,re||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||Y!==y)&&Nf(t,f,r,y),_a=!1;var Q=t.memoizedState;f.state=Q,qr(t,r,f,c),Mr(),Y=t.memoizedState,S||Q!==Y||_a?(typeof ue=="function"&&(sc(t,n,ue,r),Y=t.memoizedState),(z=_a||Af(t,n,z,r,Q,Y,y))?(re||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=Y),f.props=r,f.state=Y,f.context=y,r=z):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{f=t.stateNode,Lo(e,t),y=t.memoizedProps,re=li(n,y),f.props=re,ue=t.pendingProps,Q=f.context,Y=n.contextType,z=Di,typeof Y=="object"&&Y!==null&&(z=Bt(Y)),S=n.getDerivedStateFromProps,(Y=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==ue||Q!==z)&&Nf(t,f,r,z),_a=!1,Q=t.memoizedState,f.state=Q,qr(t,r,f,c),Mr();var W=t.memoizedState;y!==ue||Q!==W||_a||e!==null&&e.dependencies!==null&&Is(e.dependencies)?(typeof S=="function"&&(sc(t,n,S,r),W=t.memoizedState),(re=_a||Af(t,n,re,r,Q,W,z)||e!==null&&e.dependencies!==null&&Is(e.dependencies))?(Y||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(r,W,z),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(r,W,z)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=W),f.props=r,f.state=W,f.context=z,r=re):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=1024),r=!1)}return f=r,rl(e,t),r=(t.flags&128)!==0,f||r?(f=t.stateNode,n=r&&typeof n.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&r?(t.child=ri(t,e.child,null,c),t.child=ri(t,null,n,c)):Lt(e,t,n,c),t.memoizedState=f.state,e=t.child):e=Zn(e,t,c),e}function Vf(e,t,n,r){return Wa(),t.flags|=256,Lt(e,t,n,r),t.child}var dc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fc(e){return{baseLanes:e,cachePool:kd()}}function hc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=cn),e}function Gf(e,t,n){var r=t.pendingProps,c=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(St.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ye){if(c?wa(t):Ea(),(e=ht)?(e=Wh(e,vn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ya!==null?{id:Dn,overflow:Bn}:null,retryLane:536870912,hydrationErrors:null},n=Sd(e),n.return=t,t.child=n,Dt=t,ht=null)):e=null,e===null)throw ba(t);return Jc(e)?t.lanes=32:t.lanes=536870912,null}var S=r.children;return r=r.fallback,c?(Ea(),c=t.mode,S=sl({mode:"hidden",children:S},c),r=Za(r,c,n,null),S.return=t,r.return=t,S.sibling=r,t.child=S,r=t.child,r.memoizedState=fc(n),r.childLanes=hc(e,y,n),t.memoizedState=dc,Vr(null,r)):(wa(t),gc(t,S))}var z=e.memoizedState;if(z!==null&&(S=z.dehydrated,S!==null)){if(f)t.flags&256?(wa(t),t.flags&=-257,t=pc(e,t,n)):t.memoizedState!==null?(Ea(),t.child=e.child,t.flags|=128,t=null):(Ea(),S=r.fallback,c=t.mode,r=sl({mode:"visible",children:r.children},c),S=Za(S,c,n,null),S.flags|=2,r.return=t,S.return=t,r.sibling=S,t.child=r,ri(t,e.child,null,n),r=t.child,r.memoizedState=fc(n),r.childLanes=hc(e,y,n),t.memoizedState=dc,t=Vr(null,r));else if(wa(t),Jc(S)){if(y=S.nextSibling&&S.nextSibling.dataset,y)var Y=y.dgst;y=Y,r=Error(l(419)),r.stack="",r.digest=y,kr({value:r,source:null,stack:null}),t=pc(e,t,n)}else if(At||qi(e,t,n,!1),y=(n&e.childLanes)!==0,At||y){if(y=ot,y!==null&&(r=Ti(y,n),r!==0&&r!==z.retryLane))throw z.retryLane=r,Xa(e,r),tn(y,e,r),cc;Yc(S)||pl(),t=pc(e,t,n)}else Yc(S)?(t.flags|=192,t.child=e.child,t=null):(e=z.treeContext,ht=xn(S.nextSibling),Dt=t,Ye=!0,va=null,vn=!1,e!==null&&Cd(t,e),t=gc(t,r.children),t.flags|=4096);return t}return c?(Ea(),S=r.fallback,c=t.mode,z=e.child,Y=z.sibling,r=Fn(z,{mode:"hidden",children:r.children}),r.subtreeFlags=z.subtreeFlags&65011712,Y!==null?S=Fn(Y,S):(S=Za(S,c,n,null),S.flags|=2),S.return=t,r.return=t,r.sibling=S,t.child=r,Vr(null,r),r=t.child,S=e.child.memoizedState,S===null?S=fc(n):(c=S.cachePool,c!==null?(z=Ct._currentValue,c=c.parent!==z?{parent:z,pool:z}:c):c=kd(),S={baseLanes:S.baseLanes|n,cachePool:c}),r.memoizedState=S,r.childLanes=hc(e,y,n),t.memoizedState=dc,Vr(e.child,r)):(wa(t),n=e.child,e=n.sibling,n=Fn(n,{mode:"visible",children:r.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function gc(e,t){return t=sl({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function sl(e,t){return e=rn(22,e,null,t),e.lanes=0,e}function pc(e,t,n){return ri(t,e.child,null,n),e=gc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ff(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Ro(e.return,t,n)}function mc(e,t,n,r,c,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:c,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=r,y.tail=n,y.tailMode=c,y.treeForkCount=f)}function Kf(e,t,n){var r=t.pendingProps,c=r.revealOrder,f=r.tail;r=r.children;var y=St.current,S=(y&2)!==0;if(S?(y=y&1|2,t.flags|=128):y&=1,O(St,y),Lt(e,t,r,n),r=Ye?Or:0,!S&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ff(e,n,t);else if(e.tag===19)Ff(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Ys(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),mc(t,!1,c,n,f,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Ys(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}mc(t,!0,n,null,f,r);break;case"together":mc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function Zn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Aa|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(qi(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Fn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Fn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function yc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Is(e)))}function fy(e,t,n){switch(t.tag){case 3:te(t,t.stateNode.containerInfo),xa(t,Ct,e.memoizedState.cache),Wa();break;case 27:case 5:Se(t);break;case 4:te(t,t.stateNode.containerInfo);break;case 10:xa(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,$o(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(wa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Gf(e,t,n):(wa(t),e=Zn(e,t,n),e!==null?e.sibling:null);wa(t);break;case 19:var c=(e.flags&128)!==0;if(r=(n&t.childLanes)!==0,r||(qi(e,t,n,!1),r=(n&t.childLanes)!==0),c){if(r)return Kf(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),O(St,St.current),r)break;return null;case 22:return t.lanes=0,qf(e,t,n,t.pendingProps);case 24:xa(t,Ct,e.memoizedState.cache)}return Zn(e,t,n)}function Yf(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)At=!0;else{if(!yc(e,n)&&(t.flags&128)===0)return At=!1,fy(e,t,n);At=(e.flags&131072)!==0}else At=!1,Ye&&(t.flags&1048576)!==0&&Ed(t,Or,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ai(t.elementType),t.type=e,typeof e=="function")jo(e)?(r=li(e,r),t.tag=1,t=Pf(null,t,e,r,n)):(t.tag=0,t=uc(null,t,e,r,n));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=Bf(null,t,e,r,n);break e}else if(c===B){t.tag=14,t=Lf(null,t,e,r,n);break e}}throw t=ee(e)||e,Error(l(306,t,""))}}return t;case 0:return uc(e,t,t.type,t.pendingProps,n);case 1:return r=t.type,c=li(r,t.pendingProps),Pf(e,t,r,c,n);case 3:e:{if(te(t,t.stateNode.containerInfo),e===null)throw Error(l(387));r=t.pendingProps;var f=t.memoizedState;c=f.element,Lo(e,t),qr(t,r,null,n);var y=t.memoizedState;if(r=y.cache,xa(t,Ct,r),r!==f.cache&&Oo(t,[Ct],n,!0),Mr(),r=y.element,f.isDehydrated)if(f={element:r,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Vf(e,t,r,n);break e}else if(r!==c){c=pn(Error(l(424)),t),kr(c),t=Vf(e,t,r,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ht=xn(e.firstChild),Dt=t,Ye=!0,va=null,vn=!0,n=Md(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Wa(),r===c){t=Zn(e,t,n);break e}Lt(e,t,r,n)}t=t.child}return t;case 26:return rl(e,t),e===null?(n=rg(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ye||(n=t.type,e=t.pendingProps,r=jl(fe.current).createElement(n),r[Ot]=t,r[Ht]=e,Mt(r,n,e),ae(r),t.stateNode=r):t.memoizedState=rg(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Se(t),e===null&&Ye&&(r=t.stateNode=ng(t.type,t.pendingProps,fe.current),Dt=t,vn=!0,c=ht,za(t.type)?(Qc=c,ht=xn(r.firstChild)):ht=c),Lt(e,t,t.pendingProps.children,n),rl(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ye&&((c=r=ht)&&(r=$y(r,t.type,t.pendingProps,vn),r!==null?(t.stateNode=r,Dt=t,ht=xn(r.firstChild),vn=!1,c=!0):c=!1),c||ba(t)),Se(t),c=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,r=f.children,Gc(c,f)?r=null:y!==null&&Gc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Vo(e,t,ay,null,null,n),rs._currentValue=c),rl(e,t),Lt(e,t,r,n),t.child;case 6:return e===null&&Ye&&((e=n=ht)&&(n=Py(n,t.pendingProps,vn),n!==null?(t.stateNode=n,Dt=t,ht=null,e=!0):e=!1),e||ba(t)),null;case 13:return Gf(e,t,n);case 4:return te(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ri(t,null,r,n):Lt(e,t,r,n),t.child;case 11:return Bf(e,t,t.type,t.pendingProps,n);case 7:return Lt(e,t,t.pendingProps,n),t.child;case 8:return Lt(e,t,t.pendingProps.children,n),t.child;case 12:return Lt(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,xa(t,t.type,r.value),Lt(e,t,r.children,n),t.child;case 9:return c=t.type._context,r=t.pendingProps.children,ti(t),c=Bt(c),r=r(c),t.flags|=1,Lt(e,t,r,n),t.child;case 14:return Lf(e,t,t.type,t.pendingProps,n);case 15:return Mf(e,t,t.type,t.pendingProps,n);case 19:return Kf(e,t,n);case 31:return dy(e,t,n);case 22:return qf(e,t,n,t.pendingProps);case 24:return ti(t),r=Bt(Ct),e===null?(c=Uo(),c===null&&(c=ot,f=ko(),c.pooledCache=f,f.refCount++,f!==null&&(c.pooledCacheLanes|=n),c=f),t.memoizedState={parent:r,cache:c},Bo(t),xa(t,Ct,c)):((e.lanes&n)!==0&&(Lo(e,t),qr(t,null,null,n),Mr()),c=e.memoizedState,f=t.memoizedState,c.parent!==r?(c={parent:r,cache:r},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),xa(t,Ct,r)):(r=f.cache,xa(t,Ct,r),r!==c.cache&&Oo(t,[Ct],n,!0))),Lt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Wn(e){e.flags|=4}function vc(e,t,n,r,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(_h())e.flags|=8192;else throw ii=Vs,Do}else e.flags&=-16777217}function Jf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!ug(t))if(_h())e.flags|=8192;else throw ii=Vs,Do}function ll(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?js():536870912,e.lanes|=t,Xi|=t)}function Gr(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function gt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags&65011712,r|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags,r|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function hy(e,t,n){var r=t.pendingProps;switch(Co(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(t),null;case 1:return gt(t),null;case 3:return n=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Jn(Ct),pe(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Mi(t)?Wn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Ao())),gt(t),null;case 26:var c=t.type,f=t.memoizedState;return e===null?(Wn(t),f!==null?(gt(t),Jf(t,f)):(gt(t),vc(t,c,null,r,n))):f?f!==e.memoizedState?(Wn(t),gt(t),Jf(t,f)):(gt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==r&&Wn(t),gt(t),vc(t,c,e,r,n)),null;case 27:if(Re(t),n=fe.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Wn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return gt(t),null}e=F.current,Mi(t)?Td(t):(e=ng(c,r,n),t.stateNode=e,Wn(t))}return gt(t),null;case 5:if(Re(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Wn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return gt(t),null}if(f=F.current,Mi(t))Td(t);else{var y=jl(fe.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof r.is=="string"?y.createElement("select",{is:r.is}):y.createElement("select"),r.multiple?f.multiple=!0:r.size&&(f.size=r.size);break;default:f=typeof r.is=="string"?y.createElement(c,{is:r.is}):y.createElement(c)}}f[Ot]=t,f[Ht]=r;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(Mt(f,c,r),c){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Wn(t)}}return gt(t),vc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&Wn(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(l(166));if(e=fe.current,Mi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,c=Dt,c!==null)switch(c.tag){case 27:case 5:r=c.memoizedProps}e[Ot]=t,e=!!(e.nodeValue===n||r!==null&&r.suppressHydrationWarning===!0||Gh(e.nodeValue,n)),e||ba(t,!0)}else e=jl(e).createTextNode(r),e[Ot]=t,t.stateNode=e}return gt(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(r=Mi(t),n!==null){if(e===null){if(!r)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[Ot]=t}else Wa(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;gt(t),e=!1}else n=Ao(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(ln(t),t):(ln(t),null);if((t.flags&128)!==0)throw Error(l(558))}return gt(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Mi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[Ot]=t}else Wa(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;gt(t),c=!1}else c=Ao(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(ln(t),t):(ln(t),null)}return ln(t),(t.flags&128)!==0?(t.lanes=n,t):(n=r!==null,e=e!==null&&e.memoizedState!==null,n&&(r=t.child,c=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(c=r.alternate.memoizedState.cachePool.pool),f=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),f!==c&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ll(t,t.updateQueue),gt(t),null);case 4:return pe(),e===null&&Ic(t.stateNode.containerInfo),gt(t),null;case 10:return Jn(t.type),gt(t),null;case 19:if(D(St),r=t.memoizedState,r===null)return gt(t),null;if(c=(t.flags&128)!==0,f=r.rendering,f===null)if(c)Gr(r,!1);else{if(jt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=Ys(e),f!==null){for(t.flags|=128,Gr(r,!1),e=f.updateQueue,t.updateQueue=e,ll(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)jd(n,e),n=n.sibling;return O(St,St.current&1|2),Ye&&Kn(t,r.treeForkCount),t.child}e=e.sibling}r.tail!==null&&Vt()>fl&&(t.flags|=128,c=!0,Gr(r,!1),t.lanes=4194304)}else{if(!c)if(e=Ys(f),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,ll(t,e),Gr(r,!0),r.tail===null&&r.tailMode==="hidden"&&!f.alternate&&!Ye)return gt(t),null}else 2*Vt()-r.renderingStartTime>fl&&n!==536870912&&(t.flags|=128,c=!0,Gr(r,!1),t.lanes=4194304);r.isBackwards?(f.sibling=t.child,t.child=f):(e=r.last,e!==null?e.sibling=f:t.child=f,r.last=f)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Vt(),e.sibling=null,n=St.current,O(St,c?n&1|2:n&1),Ye&&Kn(t,r.treeForkCount),e):(gt(t),null);case 22:case 23:return ln(t),Ho(),r=t.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?(n&536870912)!==0&&(t.flags&128)===0&&(gt(t),t.subtreeFlags&6&&(t.flags|=8192)):gt(t),n=t.updateQueue,n!==null&&ll(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),e!==null&&D(ni),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Jn(Ct),gt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function gy(e,t){switch(Co(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Jn(Ct),pe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Re(t),null;case 31:if(t.memoizedState!==null){if(ln(t),t.alternate===null)throw Error(l(340));Wa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(ln(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Wa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return D(St),null;case 4:return pe(),null;case 10:return Jn(t.type),null;case 22:case 23:return ln(t),Ho(),e!==null&&D(ni),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Jn(Ct),null;case 25:return null;default:return null}}function Qf(e,t){switch(Co(t),t.tag){case 3:Jn(Ct),pe();break;case 26:case 27:case 5:Re(t);break;case 4:pe();break;case 31:t.memoizedState!==null&&ln(t);break;case 13:ln(t);break;case 19:D(St);break;case 10:Jn(t.type);break;case 22:case 23:ln(t),Ho(),e!==null&&D(ni);break;case 24:Jn(Ct)}}function Fr(e,t){try{var n=t.updateQueue,r=n!==null?n.lastEffect:null;if(r!==null){var c=r.next;n=c;do{if((n.tag&e)===e){r=void 0;var f=n.create,y=n.inst;r=f(),y.destroy=r}n=n.next}while(n!==c)}}catch(S){it(t,t.return,S)}}function Ca(e,t,n){try{var r=t.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&e)===e){var y=r.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,c=t;var z=n,Y=S;try{Y()}catch(re){it(c,z,re)}}}r=r.next}while(r!==f)}}catch(re){it(t,t.return,re)}}function Xf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Id(t,n)}catch(r){it(e,e.return,r)}}}function Zf(e,t,n){n.props=li(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){it(e,t,r)}}function Kr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof n=="function"?e.refCleanup=n(r):n.current=r}}catch(c){it(e,t,c)}}function Ln(e,t){var n=e.ref,r=e.refCleanup;if(n!==null)if(typeof r=="function")try{r()}catch(c){it(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){it(e,t,c)}else n.current=null}function Wf(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(c){it(e,e.return,c)}}function bc(e,t,n){try{var r=e.stateNode;By(r,e.type,n,t),r[Ht]=t}catch(c){it(e,e.return,c)}}function eh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&za(e.type)||e.tag===4}function xc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||eh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&za(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _c(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Vn));else if(r!==4&&(r===27&&za(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(_c(e,t,n),e=e.sibling;e!==null;)_c(e,t,n),e=e.sibling}function ol(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(r===27&&za(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(ol(e,t,n),e=e.sibling;e!==null;)ol(e,t,n),e=e.sibling}function th(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Mt(t,r,n),t[Ot]=e,t[Ht]=n}catch(f){it(e,e.return,f)}}var ea=!1,Nt=!1,jc=!1,nh=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function py(e,t){if(e=e.containerInfo,Pc=Nl,e=hd(e),po(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var c=r.anchorOffset,f=r.focusNode;r=r.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var y=0,S=-1,z=-1,Y=0,re=0,ue=e,Q=null;t:for(;;){for(var W;ue!==n||c!==0&&ue.nodeType!==3||(S=y+c),ue!==f||r!==0&&ue.nodeType!==3||(z=y+r),ue.nodeType===3&&(y+=ue.nodeValue.length),(W=ue.firstChild)!==null;)Q=ue,ue=W;for(;;){if(ue===e)break t;if(Q===n&&++Y===c&&(S=y),Q===f&&++re===r&&(z=y),(W=ue.nextSibling)!==null)break;ue=Q,Q=ue.parentNode}ue=W}n=S===-1||z===-1?null:{start:S,end:z}}else n=null}n=n||{start:0,end:0}}else n=null;for(Vc={focusedElem:e,selectionRange:n},Nl=!1,Ut=t;Ut!==null;)if(t=Ut,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ut=e;else for(;Ut!==null;){switch(t=Ut,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,n=t,c=f.memoizedProps,f=f.memoizedState,r=n.stateNode;try{var Ce=li(n.type,c);e=r.getSnapshotBeforeUpdate(Ce,f),r.__reactInternalSnapshotBeforeUpdate=e}catch(Ue){it(n,n.return,Ue)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Kc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Kc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Ut=e;break}Ut=t.return}}function ah(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:na(e,n),r&4&&Fr(5,n);break;case 1:if(na(e,n),r&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){it(n,n.return,y)}else{var c=li(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){it(n,n.return,y)}}r&64&&Xf(n),r&512&&Kr(n,n.return);break;case 3:if(na(e,n),r&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Id(e,t)}catch(y){it(n,n.return,y)}}break;case 27:t===null&&r&4&&th(n);case 26:case 5:na(e,n),t===null&&r&4&&Wf(n),r&512&&Kr(n,n.return);break;case 12:na(e,n);break;case 31:na(e,n),r&4&&sh(e,n);break;case 13:na(e,n),r&4&&lh(e,n),r&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=wy.bind(null,n),Vy(e,n))));break;case 22:if(r=n.memoizedState!==null||ea,!r){t=t!==null&&t.memoizedState!==null||Nt,c=ea;var f=Nt;ea=r,(Nt=t)&&!f?aa(e,n,(n.subtreeFlags&8772)!==0):na(e,n),ea=c,Nt=f}break;case 30:break;default:na(e,n)}}function ih(e){var t=e.alternate;t!==null&&(e.alternate=null,ih(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Ai(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var vt=null,Xt=!1;function ta(e,t,n){for(n=n.child;n!==null;)rh(e,t,n),n=n.sibling}function rh(e,t,n){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(ca,n)}catch{}switch(n.tag){case 26:Nt||Ln(n,t),ta(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Nt||Ln(n,t);var r=vt,c=Xt;za(n.type)&&(vt=n.stateNode,Xt=!1),ta(e,t,n),ns(n.stateNode),vt=r,Xt=c;break;case 5:Nt||Ln(n,t);case 6:if(r=vt,c=Xt,vt=null,ta(e,t,n),vt=r,Xt=c,vt!==null)if(Xt)try{(vt.nodeType===9?vt.body:vt.nodeName==="HTML"?vt.ownerDocument.body:vt).removeChild(n.stateNode)}catch(f){it(n,t,f)}else try{vt.removeChild(n.stateNode)}catch(f){it(n,t,f)}break;case 18:vt!==null&&(Xt?(e=vt,Xh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),rr(e)):Xh(vt,n.stateNode));break;case 4:r=vt,c=Xt,vt=n.stateNode.containerInfo,Xt=!0,ta(e,t,n),vt=r,Xt=c;break;case 0:case 11:case 14:case 15:Ca(2,n,t),Nt||Ca(4,n,t),ta(e,t,n);break;case 1:Nt||(Ln(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"&&Zf(n,t,r)),ta(e,t,n);break;case 21:ta(e,t,n);break;case 22:Nt=(r=Nt)||n.memoizedState!==null,ta(e,t,n),Nt=r;break;default:ta(e,t,n)}}function sh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{rr(e)}catch(n){it(t,t.return,n)}}}function lh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{rr(e)}catch(n){it(t,t.return,n)}}function my(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new nh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new nh),t;default:throw Error(l(435,e.tag))}}function cl(e,t){var n=my(e);t.forEach(function(r){if(!n.has(r)){n.add(r);var c=Ey.bind(null,e,r);r.then(c,c)}})}function Zt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var c=n[r],f=e,y=t,S=y;e:for(;S!==null;){switch(S.tag){case 27:if(za(S.type)){vt=S.stateNode,Xt=!1;break e}break;case 5:vt=S.stateNode,Xt=!1;break e;case 3:case 4:vt=S.stateNode.containerInfo,Xt=!0;break e}S=S.return}if(vt===null)throw Error(l(160));rh(f,y,c),vt=null,Xt=!1,f=c.alternate,f!==null&&(f.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)oh(t,e),t=t.sibling}var An=null;function oh(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Zt(t,e),Wt(e),r&4&&(Ca(3,e,e.return),Fr(3,e),Ca(5,e,e.return));break;case 1:Zt(t,e),Wt(e),r&512&&(Nt||n===null||Ln(n,n.return)),r&64&&ea&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?r:n.concat(r))));break;case 26:var c=An;if(Zt(t,e),Wt(e),r&512&&(Nt||n===null||Ln(n,n.return)),r&4){var f=n!==null?n.memoizedState:null;if(r=e.memoizedState,n===null)if(r===null)if(e.stateNode===null){e:{r=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(r){case"title":f=c.getElementsByTagName("title")[0],(!f||f[da]||f[Ot]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=c.createElement(r),c.head.insertBefore(f,c.querySelector("head > title"))),Mt(f,r,n),f[Ot]=e,ae(f),r=f;break e;case"link":var y=og("link","href",c).get(r+(n.href||""));if(y){for(var S=0;S<y.length;S++)if(f=y[S],f.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&f.getAttribute("rel")===(n.rel==null?null:n.rel)&&f.getAttribute("title")===(n.title==null?null:n.title)&&f.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(S,1);break t}}f=c.createElement(r),Mt(f,r,n),c.head.appendChild(f);break;case"meta":if(y=og("meta","content",c).get(r+(n.content||""))){for(S=0;S<y.length;S++)if(f=y[S],f.getAttribute("content")===(n.content==null?null:""+n.content)&&f.getAttribute("name")===(n.name==null?null:n.name)&&f.getAttribute("property")===(n.property==null?null:n.property)&&f.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&f.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(S,1);break t}}f=c.createElement(r),Mt(f,r,n),c.head.appendChild(f);break;default:throw Error(l(468,r))}f[Ot]=e,ae(f),r=f}e.stateNode=r}else cg(c,e.type,e.stateNode);else e.stateNode=lg(c,r,e.memoizedProps);else f!==r?(f===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):f.count--,r===null?cg(c,e.type,e.stateNode):lg(c,r,e.memoizedProps)):r===null&&e.stateNode!==null&&bc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Zt(t,e),Wt(e),r&512&&(Nt||n===null||Ln(n,n.return)),n!==null&&r&4&&bc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Zt(t,e),Wt(e),r&512&&(Nt||n===null||Ln(n,n.return)),e.flags&32){c=e.stateNode;try{Te(c,"")}catch(Ce){it(e,e.return,Ce)}}r&4&&e.stateNode!=null&&(c=e.memoizedProps,bc(e,c,n!==null?n.memoizedProps:c)),r&1024&&(jc=!0);break;case 6:if(Zt(t,e),Wt(e),r&4){if(e.stateNode===null)throw Error(l(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(Ce){it(e,e.return,Ce)}}break;case 3:if(El=null,c=An,An=Sl(t.containerInfo),Zt(t,e),An=c,Wt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{rr(t.containerInfo)}catch(Ce){it(e,e.return,Ce)}jc&&(jc=!1,ch(e));break;case 4:r=An,An=Sl(e.stateNode.containerInfo),Zt(t,e),Wt(e),An=r;break;case 12:Zt(t,e),Wt(e);break;case 31:Zt(t,e),Wt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,cl(e,r)));break;case 13:Zt(t,e),Wt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(dl=Vt()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,cl(e,r)));break;case 22:c=e.memoizedState!==null;var z=n!==null&&n.memoizedState!==null,Y=ea,re=Nt;if(ea=Y||c,Nt=re||z,Zt(t,e),Nt=re,ea=Y,Wt(e),r&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||z||ea||Nt||oi(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){z=n=t;try{if(f=z.stateNode,c)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{S=z.stateNode;var ue=z.memoizedProps.style,Q=ue!=null&&ue.hasOwnProperty("display")?ue.display:null;S.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(Ce){it(z,z.return,Ce)}}}else if(t.tag===6){if(n===null){z=t;try{z.stateNode.nodeValue=c?"":z.memoizedProps}catch(Ce){it(z,z.return,Ce)}}}else if(t.tag===18){if(n===null){z=t;try{var W=z.stateNode;c?Zh(W,!0):Zh(z.stateNode,!1)}catch(Ce){it(z,z.return,Ce)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(n=r.retryQueue,n!==null&&(r.retryQueue=null,cl(e,n))));break;case 19:Zt(t,e),Wt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,cl(e,r)));break;case 30:break;case 21:break;default:Zt(t,e),Wt(e)}}function Wt(e){var t=e.flags;if(t&2){try{for(var n,r=e.return;r!==null;){if(eh(r)){n=r;break}r=r.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,f=xc(e);ol(e,f,c);break;case 5:var y=n.stateNode;n.flags&32&&(Te(y,""),n.flags&=-33);var S=xc(e);ol(e,S,y);break;case 3:case 4:var z=n.stateNode.containerInfo,Y=xc(e);_c(e,Y,z);break;default:throw Error(l(161))}}catch(re){it(e,e.return,re)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ch(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;ch(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function na(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)ah(e,t.alternate,t),t=t.sibling}function oi(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ca(4,t,t.return),oi(t);break;case 1:Ln(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Zf(t,t.return,n),oi(t);break;case 27:ns(t.stateNode);case 26:case 5:Ln(t,t.return),oi(t);break;case 22:t.memoizedState===null&&oi(t);break;case 30:oi(t);break;default:oi(t)}e=e.sibling}}function aa(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,c=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:aa(c,f,n),Fr(4,f);break;case 1:if(aa(c,f,n),r=f,c=r.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(Y){it(r,r.return,Y)}if(r=f,c=r.updateQueue,c!==null){var S=r.stateNode;try{var z=c.shared.hiddenCallbacks;if(z!==null)for(c.shared.hiddenCallbacks=null,c=0;c<z.length;c++)qd(z[c],S)}catch(Y){it(r,r.return,Y)}}n&&y&64&&Xf(f),Kr(f,f.return);break;case 27:th(f);case 26:case 5:aa(c,f,n),n&&r===null&&y&4&&Wf(f),Kr(f,f.return);break;case 12:aa(c,f,n);break;case 31:aa(c,f,n),n&&y&4&&sh(c,f);break;case 13:aa(c,f,n),n&&y&4&&lh(c,f);break;case 22:f.memoizedState===null&&aa(c,f,n),Kr(f,f.return);break;case 30:break;default:aa(c,f,n)}t=t.sibling}}function Sc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&zr(n))}function wc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&zr(e))}function Nn(e,t,n,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)uh(e,t,n,r),t=t.sibling}function uh(e,t,n,r){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Nn(e,t,n,r),c&2048&&Fr(9,t);break;case 1:Nn(e,t,n,r);break;case 3:Nn(e,t,n,r),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&zr(e)));break;case 12:if(c&2048){Nn(e,t,n,r),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,S=f.onPostCommit;typeof S=="function"&&S(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(z){it(t,t.return,z)}}else Nn(e,t,n,r);break;case 31:Nn(e,t,n,r);break;case 13:Nn(e,t,n,r);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?Nn(e,t,n,r):Yr(e,t):f._visibility&2?Nn(e,t,n,r):(f._visibility|=2,Yi(e,t,n,r,(t.subtreeFlags&10256)!==0||!1)),c&2048&&Sc(y,t);break;case 24:Nn(e,t,n,r),c&2048&&wc(t.alternate,t);break;default:Nn(e,t,n,r)}}function Yi(e,t,n,r,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,S=n,z=r,Y=y.flags;switch(y.tag){case 0:case 11:case 15:Yi(f,y,S,z,c),Fr(8,y);break;case 23:break;case 22:var re=y.stateNode;y.memoizedState!==null?re._visibility&2?Yi(f,y,S,z,c):Yr(f,y):(re._visibility|=2,Yi(f,y,S,z,c)),c&&Y&2048&&Sc(y.alternate,y);break;case 24:Yi(f,y,S,z,c),c&&Y&2048&&wc(y.alternate,y);break;default:Yi(f,y,S,z,c)}t=t.sibling}}function Yr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,r=t,c=r.flags;switch(r.tag){case 22:Yr(n,r),c&2048&&Sc(r.alternate,r);break;case 24:Yr(n,r),c&2048&&wc(r.alternate,r);break;default:Yr(n,r)}t=t.sibling}}var Jr=8192;function Ji(e,t,n){if(e.subtreeFlags&Jr)for(e=e.child;e!==null;)dh(e,t,n),e=e.sibling}function dh(e,t,n){switch(e.tag){case 26:Ji(e,t,n),e.flags&Jr&&e.memoizedState!==null&&nv(n,An,e.memoizedState,e.memoizedProps);break;case 5:Ji(e,t,n);break;case 3:case 4:var r=An;An=Sl(e.stateNode.containerInfo),Ji(e,t,n),An=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=Jr,Jr=16777216,Ji(e,t,n),Jr=r):Ji(e,t,n));break;default:Ji(e,t,n)}}function fh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Qr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];Ut=r,gh(r,e)}fh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)hh(e),e=e.sibling}function hh(e){switch(e.tag){case 0:case 11:case 15:Qr(e),e.flags&2048&&Ca(9,e,e.return);break;case 3:Qr(e);break;case 12:Qr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,ul(e)):Qr(e);break;default:Qr(e)}}function ul(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];Ut=r,gh(r,e)}fh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ca(8,t,t.return),ul(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,ul(t));break;default:ul(t)}e=e.sibling}}function gh(e,t){for(;Ut!==null;){var n=Ut;switch(n.tag){case 0:case 11:case 15:Ca(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var r=n.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:zr(n.memoizedState.cache)}if(r=n.child,r!==null)r.return=n,Ut=r;else e:for(n=e;Ut!==null;){r=Ut;var c=r.sibling,f=r.return;if(ih(r),r===n){Ut=null;break e}if(c!==null){c.return=f,Ut=c;break e}Ut=f}}}var yy={getCacheForType:function(e){var t=Bt(Ct),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Bt(Ct).controller.signal}},vy=typeof WeakMap=="function"?WeakMap:Map,tt=0,ot=null,Ve=null,Fe=0,at=0,on=null,Ta=!1,Qi=!1,Ec=!1,ia=0,jt=0,Aa=0,ci=0,Cc=0,cn=0,Xi=0,Xr=null,en=null,Tc=!1,dl=0,ph=0,fl=1/0,hl=null,Na=null,kt=0,Ra=null,Zi=null,ra=0,Ac=0,Nc=null,mh=null,Zr=0,Rc=null;function un(){return(tt&2)!==0&&Fe!==0?Fe&-Fe:E.T!==null?Bc():br()}function yh(){if(cn===0)if((Fe&536870912)===0||Ye){var e=wi;wi<<=1,(wi&3932160)===0&&(wi=262144),cn=e}else cn=536870912;return e=sn.current,e!==null&&(e.flags|=32),cn}function tn(e,t,n){(e===ot&&(at===2||at===9)||e.cancelPendingCommit!==null)&&(Wi(e,0),Oa(e,Fe,cn,!1)),nn(e,n),((tt&2)===0||e!==ot)&&(e===ot&&((tt&2)===0&&(ci|=n),jt===4&&Oa(e,Fe,cn,!1)),Mn(e))}function vh(e,t,n){if((tt&6)!==0)throw Error(l(327));var r=!n&&(t&127)===0&&(t&e.expiredLanes)===0||ua(e,t),c=r?_y(e,t):kc(e,t,!0),f=r;do{if(c===0){Qi&&!r&&Oa(e,t,0,!1);break}else{if(n=e.current.alternate,f&&!by(n)){c=kc(e,t,!1),f=!1;continue}if(c===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var S=e;c=Xr;var z=S.current.memoizedState.isDehydrated;if(z&&(Wi(S,y).flags|=256),y=kc(S,y,!1),y!==2){if(Ec&&!z){S.errorRecoveryDisabledLanes|=f,ci|=f,c=4;break e}f=en,en=c,f!==null&&(en===null?en=f:en.push.apply(en,f))}c=y}if(f=!1,c!==2)continue}}if(c===1){Wi(e,0),Oa(e,t,0,!0);break}e:{switch(r=e,f=c,f){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Oa(r,t,cn,!Ta);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=dl+300-Vt(),10<c)){if(Oa(r,t,cn,!Ta),Ci(r,0,!0)!==0)break e;ra=t,r.timeoutHandle=Jh(bh.bind(null,r,n,en,hl,Tc,t,cn,ci,Xi,Ta,f,"Throttled",-0,0),c);break e}bh(r,n,en,hl,Tc,t,cn,ci,Xi,Ta,f,null,-0,0)}}break}while(!0);Mn(e)}function bh(e,t,n,r,c,f,y,S,z,Y,re,ue,Q,W){if(e.timeoutHandle=-1,ue=t.subtreeFlags,ue&8192||(ue&16785408)===16785408){ue={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vn},dh(t,f,ue);var Ce=(f&62914560)===f?dl-Vt():(f&4194048)===f?ph-Vt():0;if(Ce=av(ue,Ce),Ce!==null){ra=f,e.cancelPendingCommit=Ce(Th.bind(null,e,t,f,n,r,c,y,S,z,re,ue,null,Q,W)),Oa(e,f,y,!Y);return}}Th(e,t,f,n,r,c,y,S,z)}function by(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var r=0;r<n.length;r++){var c=n[r],f=c.getSnapshot;c=c.value;try{if(!an(f(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Oa(e,t,n,r){t&=~Cc,t&=~ci,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var c=t;0<c;){var f=31-Ft(c),y=1<<f;r[f]=-1,c&=~y}n!==0&&ws(e,n,t)}function gl(){return(tt&6)===0?(Wr(0),!1):!0}function Oc(){if(Ve!==null){if(at===0)var e=Ve.return;else e=Ve,Yn=ei=null,Ko(e),Pi=null,Dr=0,e=Ve;for(;e!==null;)Qf(e.alternate,e),e=e.return;Ve=null}}function Wi(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,qy(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),ra=0,Oc(),ot=e,Ve=n=Fn(e.current,null),Fe=t,at=0,on=null,Ta=!1,Qi=ua(e,t),Ec=!1,Xi=cn=Cc=ci=Aa=jt=0,en=Xr=null,Tc=!1,(t&8)!==0&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var c=31-Ft(r),f=1<<c;t|=e[c],r&=~f}return ia=t,Ds(),n}function xh(e,t){He=null,E.H=Pr,t===$i||t===Ps?(t=Dd(),at=3):t===Do?(t=Dd(),at=4):at=t===cc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,on=t,Ve===null&&(jt=1,al(e,pn(t,e.current)))}function _h(){var e=sn.current;return e===null?!0:(Fe&4194048)===Fe?bn===null:(Fe&62914560)===Fe||(Fe&536870912)!==0?e===bn:!1}function jh(){var e=E.H;return E.H=Pr,e===null?Pr:e}function Sh(){var e=E.A;return E.A=yy,e}function pl(){jt=4,Ta||(Fe&4194048)!==Fe&&sn.current!==null||(Qi=!0),(Aa&134217727)===0&&(ci&134217727)===0||ot===null||Oa(ot,Fe,cn,!1)}function kc(e,t,n){var r=tt;tt|=2;var c=jh(),f=Sh();(ot!==e||Fe!==t)&&(hl=null,Wi(e,t)),t=!1;var y=jt;e:do try{if(at!==0&&Ve!==null){var S=Ve,z=on;switch(at){case 8:Oc(),y=6;break e;case 3:case 2:case 9:case 6:sn.current===null&&(t=!0);var Y=at;if(at=0,on=null,er(e,S,z,Y),n&&Qi){y=0;break e}break;default:Y=at,at=0,on=null,er(e,S,z,Y)}}xy(),y=jt;break}catch(re){xh(e,re)}while(!0);return t&&e.shellSuspendCounter++,Yn=ei=null,tt=r,E.H=c,E.A=f,Ve===null&&(ot=null,Fe=0,Ds()),y}function xy(){for(;Ve!==null;)wh(Ve)}function _y(e,t){var n=tt;tt|=2;var r=jh(),c=Sh();ot!==e||Fe!==t?(hl=null,fl=Vt()+500,Wi(e,t)):Qi=ua(e,t);e:do try{if(at!==0&&Ve!==null){t=Ve;var f=on;t:switch(at){case 1:at=0,on=null,er(e,t,f,1);break;case 2:case 9:if(zd(f)){at=0,on=null,Eh(t);break}t=function(){at!==2&&at!==9||ot!==e||(at=7),Mn(e)},f.then(t,t);break e;case 3:at=7;break e;case 4:at=5;break e;case 7:zd(f)?(at=0,on=null,Eh(t)):(at=0,on=null,er(e,t,f,7));break;case 5:var y=null;switch(Ve.tag){case 26:y=Ve.memoizedState;case 5:case 27:var S=Ve;if(y?ug(y):S.stateNode.complete){at=0,on=null;var z=S.sibling;if(z!==null)Ve=z;else{var Y=S.return;Y!==null?(Ve=Y,ml(Y)):Ve=null}break t}}at=0,on=null,er(e,t,f,5);break;case 6:at=0,on=null,er(e,t,f,6);break;case 8:Oc(),jt=6;break e;default:throw Error(l(462))}}jy();break}catch(re){xh(e,re)}while(!0);return Yn=ei=null,E.H=r,E.A=c,tt=n,Ve!==null?0:(ot=null,Fe=0,Ds(),jt)}function jy(){for(;Ve!==null&&!$a();)wh(Ve)}function wh(e){var t=Yf(e.alternate,e,ia);e.memoizedProps=e.pendingProps,t===null?ml(e):Ve=t}function Eh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=$f(n,t,t.pendingProps,t.type,void 0,Fe);break;case 11:t=$f(n,t,t.pendingProps,t.type.render,t.ref,Fe);break;case 5:Ko(t);default:Qf(n,t),t=Ve=jd(t,ia),t=Yf(n,t,ia)}e.memoizedProps=e.pendingProps,t===null?ml(e):Ve=t}function er(e,t,n,r){Yn=ei=null,Ko(t),Pi=null,Dr=0;var c=t.return;try{if(uy(e,c,t,n,Fe)){jt=1,al(e,pn(n,e.current)),Ve=null;return}}catch(f){if(c!==null)throw Ve=c,f;jt=1,al(e,pn(n,e.current)),Ve=null;return}t.flags&32768?(Ye||r===1?e=!0:Qi||(Fe&536870912)!==0?e=!1:(Ta=e=!0,(r===2||r===9||r===3||r===6)&&(r=sn.current,r!==null&&r.tag===13&&(r.flags|=16384))),Ch(t,e)):ml(t)}function ml(e){var t=e;do{if((t.flags&32768)!==0){Ch(t,Ta);return}e=t.return;var n=hy(t.alternate,t,ia);if(n!==null){Ve=n;return}if(t=t.sibling,t!==null){Ve=t;return}Ve=t=e}while(t!==null);jt===0&&(jt=5)}function Ch(e,t){do{var n=gy(e.alternate,e);if(n!==null){n.flags&=32767,Ve=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ve=e;return}Ve=e=n}while(e!==null);jt=6,Ve=null}function Th(e,t,n,r,c,f,y,S,z){e.cancelPendingCommit=null;do yl();while(kt!==0);if((tt&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(f=t.lanes|t.childLanes,f|=xo,Ss(e,n,f,y,S,z),e===ot&&(Ve=ot=null,Fe=0),Zi=t,Ra=e,ra=n,Ac=f,Nc=c,mh=r,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Cy(Pa,function(){return kh(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||r){r=E.T,E.T=null,c=U.p,U.p=2,y=tt,tt|=4;try{py(e,t,n)}finally{tt=y,U.p=c,E.T=r}}kt=1,Ah(),Nh(),Rh()}}function Ah(){if(kt===1){kt=0;var e=Ra,t=Zi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=E.T,E.T=null;var r=U.p;U.p=2;var c=tt;tt|=4;try{oh(t,e);var f=Vc,y=hd(e.containerInfo),S=f.focusedElem,z=f.selectionRange;if(y!==S&&S&&S.ownerDocument&&fd(S.ownerDocument.documentElement,S)){if(z!==null&&po(S)){var Y=z.start,re=z.end;if(re===void 0&&(re=Y),"selectionStart"in S)S.selectionStart=Y,S.selectionEnd=Math.min(re,S.value.length);else{var ue=S.ownerDocument||document,Q=ue&&ue.defaultView||window;if(Q.getSelection){var W=Q.getSelection(),Ce=S.textContent.length,Ue=Math.min(z.start,Ce),lt=z.end===void 0?Ue:Math.min(z.end,Ce);!W.extend&&Ue>lt&&(y=lt,lt=Ue,Ue=y);var V=dd(S,Ue),q=dd(S,lt);if(V&&q&&(W.rangeCount!==1||W.anchorNode!==V.node||W.anchorOffset!==V.offset||W.focusNode!==q.node||W.focusOffset!==q.offset)){var K=ue.createRange();K.setStart(V.node,V.offset),W.removeAllRanges(),Ue>lt?(W.addRange(K),W.extend(q.node,q.offset)):(K.setEnd(q.node,q.offset),W.addRange(K))}}}}for(ue=[],W=S;W=W.parentNode;)W.nodeType===1&&ue.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<ue.length;S++){var le=ue[S];le.element.scrollLeft=le.left,le.element.scrollTop=le.top}}Nl=!!Pc,Vc=Pc=null}finally{tt=c,U.p=r,E.T=n}}e.current=t,kt=2}}function Nh(){if(kt===2){kt=0;var e=Ra,t=Zi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=E.T,E.T=null;var r=U.p;U.p=2;var c=tt;tt|=4;try{ah(e,t.alternate,t)}finally{tt=c,U.p=r,E.T=n}}kt=3}}function Rh(){if(kt===4||kt===3){kt=0,vi();var e=Ra,t=Zi,n=ra,r=mh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?kt=5:(kt=0,Zi=Ra=null,Oh(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Na=null),Va(n),t=t.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(ca,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=E.T,c=U.p,U.p=2,E.T=null;try{for(var f=e.onRecoverableError,y=0;y<r.length;y++){var S=r[y];f(S.value,{componentStack:S.stack})}}finally{E.T=t,U.p=c}}(ra&3)!==0&&yl(),Mn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===Rc?Zr++:(Zr=0,Rc=e):Zr=0,Wr(0)}}function Oh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,zr(t)))}function yl(){return Ah(),Nh(),Rh(),kh()}function kh(){if(kt!==5)return!1;var e=Ra,t=Ac;Ac=0;var n=Va(ra),r=E.T,c=U.p;try{U.p=32>n?32:n,E.T=null,n=Nc,Nc=null;var f=Ra,y=ra;if(kt=0,Zi=Ra=null,ra=0,(tt&6)!==0)throw Error(l(331));var S=tt;if(tt|=4,hh(f.current),uh(f,f.current,y,n),tt=S,Wr(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(ca,f)}catch{}return!0}finally{U.p=c,E.T=r,Oh(e,t)}}function zh(e,t,n){t=pn(n,t),t=oc(e.stateNode,t,2),e=Sa(e,t,2),e!==null&&(nn(e,2),Mn(e))}function it(e,t,n){if(e.tag===3)zh(e,e,n);else for(;t!==null;){if(t.tag===3){zh(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Na===null||!Na.has(r))){e=pn(n,e),n=Uf(2),r=Sa(t,n,2),r!==null&&(Df(n,r,t,e),nn(r,2),Mn(r));break}}t=t.return}}function zc(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new vy;var c=new Set;r.set(t,c)}else c=r.get(t),c===void 0&&(c=new Set,r.set(t,c));c.has(n)||(Ec=!0,c.add(n),e=Sy.bind(null,e,t,n),t.then(e,e))}function Sy(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ot===e&&(Fe&n)===n&&(jt===4||jt===3&&(Fe&62914560)===Fe&&300>Vt()-dl?(tt&2)===0&&Wi(e,0):Cc|=n,Xi===Fe&&(Xi=0)),Mn(e)}function Uh(e,t){t===0&&(t=js()),e=Xa(e,t),e!==null&&(nn(e,t),Mn(e))}function wy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Uh(e,n)}function Ey(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(l(314))}r!==null&&r.delete(t),Uh(e,n)}function Cy(e,t){return et(e,t)}var vl=null,tr=null,Uc=!1,bl=!1,Dc=!1,ka=0;function Mn(e){e!==tr&&e.next===null&&(tr===null?vl=tr=e:tr=tr.next=e),bl=!0,Uc||(Uc=!0,Ay())}function Wr(e,t){if(!Dc&&bl){Dc=!0;do for(var n=!1,r=vl;r!==null;){if(e!==0){var c=r.pendingLanes;if(c===0)var f=0;else{var y=r.suspendedLanes,S=r.pingedLanes;f=(1<<31-Ft(42|e)+1)-1,f&=c&~(y&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(n=!0,Mh(r,f))}else f=Fe,f=Ci(r,r===ot?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(f&3)===0||ua(r,f)||(n=!0,Mh(r,f));r=r.next}while(n);Dc=!1}}function Ty(){Dh()}function Dh(){bl=Uc=!1;var e=0;ka!==0&&My()&&(e=ka);for(var t=Vt(),n=null,r=vl;r!==null;){var c=r.next,f=Bh(r,t);f===0?(r.next=null,n===null?vl=c:n.next=c,c===null&&(tr=n)):(n=r,(e!==0||(f&3)!==0)&&(bl=!0)),r=c}kt!==0&&kt!==5||Wr(e),ka!==0&&(ka=0)}function Bh(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,c=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Ft(f),S=1<<y,z=c[y];z===-1?((S&n)===0||(S&r)!==0)&&(c[y]=_s(S,t)):z<=t&&(e.expiredLanes|=S),f&=~S}if(t=ot,n=Fe,n=Ci(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,n===0||e===t&&(at===2||at===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&nt(r),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||ua(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(r!==null&&nt(r),Va(n)){case 2:case 8:n=xi;break;case 32:n=Pa;break;case 268435456:n=bs;break;default:n=Pa}return r=Lh.bind(null,e),n=et(n,r),e.callbackPriority=t,e.callbackNode=n,t}return r!==null&&r!==null&&nt(r),e.callbackPriority=2,e.callbackNode=null,2}function Lh(e,t){if(kt!==0&&kt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(yl()&&e.callbackNode!==n)return null;var r=Fe;return r=Ci(e,e===ot?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(vh(e,r,t),Bh(e,Vt()),e.callbackNode!=null&&e.callbackNode===n?Lh.bind(null,e):null)}function Mh(e,t){if(yl())return null;vh(e,t,!0)}function Ay(){Iy(function(){(tt&6)!==0?et(vs,Ty):Dh()})}function Bc(){if(ka===0){var e=Ii;e===0&&(e=Si,Si<<=1,(Si&261888)===0&&(Si=256)),ka=e}return ka}function qh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ts(""+e)}function Ih(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ny(e,t,n,r,c){if(t==="submit"&&n&&n.stateNode===c){var f=qh((c[Ht]||null).action),y=r.submitter;y&&(t=(t=y[Ht]||null)?qh(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var S=new Os("action","action",null,r,c);e.push({event:S,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(ka!==0){var z=y?Ih(c,y):new FormData(c);nc(n,{pending:!0,data:z,method:c.method,action:f},null,z)}}else typeof f=="function"&&(S.preventDefault(),z=y?Ih(c,y):new FormData(c),nc(n,{pending:!0,data:z,method:c.method,action:f},f,z))},currentTarget:c}]})}}for(var Lc=0;Lc<bo.length;Lc++){var Mc=bo[Lc],Ry=Mc.toLowerCase(),Oy=Mc[0].toUpperCase()+Mc.slice(1);Tn(Ry,"on"+Oy)}Tn(md,"onAnimationEnd"),Tn(yd,"onAnimationIteration"),Tn(vd,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(Km,"onTransitionRun"),Tn(Ym,"onTransitionStart"),Tn(Jm,"onTransitionCancel"),Tn(bd,"onTransitionEnd"),ce("onMouseEnter",["mouseout","mouseover"]),ce("onMouseLeave",["mouseout","mouseover"]),ce("onPointerEnter",["pointerout","pointerover"]),ce("onPointerLeave",["pointerout","pointerover"]),he("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),he("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),he("onBeforeInput",["compositionend","keypress","textInput","paste"]),he("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),he("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),he("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var es="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ky=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(es));function Hh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],c=r.event;r=r.listeners;e:{var f=void 0;if(t)for(var y=r.length-1;0<=y;y--){var S=r[y],z=S.instance,Y=S.currentTarget;if(S=S.listener,z!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=Y;try{f(c)}catch(re){Us(re)}c.currentTarget=null,f=z}else for(y=0;y<r.length;y++){if(S=r[y],z=S.instance,Y=S.currentTarget,S=S.listener,z!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=Y;try{f(c)}catch(re){Us(re)}c.currentTarget=null,f=z}}}}function Ge(e,t){var n=t[xr];n===void 0&&(n=t[xr]=new Set);var r=e+"__bubble";n.has(r)||($h(t,e,2,!1),n.add(r))}function qc(e,t,n){var r=0;t&&(r|=4),$h(n,e,r,t)}var xl="_reactListening"+Math.random().toString(36).slice(2);function Ic(e){if(!e[xl]){e[xl]=!0,xe.forEach(function(n){n!=="selectionchange"&&(ky.has(n)||qc(n,!1,e),qc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xl]||(t[xl]=!0,qc("selectionchange",!1,t))}}function $h(e,t,n,r){switch(yg(t)){case 2:var c=sv;break;case 8:c=lv;break;default:c=tu}n=c.bind(null,t,n,e),c=void 0,!ro||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),r?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Hc(e,t,n,r,c){var f=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var y=r.tag;if(y===3||y===4){var S=r.stateNode.containerInfo;if(S===c)break;if(y===4)for(y=r.return;y!==null;){var z=y.tag;if((z===3||z===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;S!==null;){if(y=fa(S),y===null)return;if(z=y.tag,z===5||z===6||z===26||z===27){r=f=y;continue e}S=S.parentNode}}r=r.return}Fu(function(){var Y=f,re=ao(n),ue=[];e:{var Q=xd.get(e);if(Q!==void 0){var W=Os,Ce=e;switch(e){case"keypress":if(Ns(n)===0)break e;case"keydown":case"keyup":W=Em;break;case"focusin":Ce="focus",W=co;break;case"focusout":Ce="blur",W=co;break;case"beforeblur":case"afterblur":W=co;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=Ju;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=hm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=Am;break;case md:case yd:case vd:W=mm;break;case bd:W=Rm;break;case"scroll":case"scrollend":W=dm;break;case"wheel":W=km;break;case"copy":case"cut":case"paste":W=vm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=Xu;break;case"toggle":case"beforetoggle":W=Um}var Ue=(t&4)!==0,lt=!Ue&&(e==="scroll"||e==="scrollend"),V=Ue?Q!==null?Q+"Capture":null:Q;Ue=[];for(var q=Y,K;q!==null;){var le=q;if(K=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||K===null||V===null||(le=jr(q,V),le!=null&&Ue.push(ts(q,le,K))),lt)break;q=q.return}0<Ue.length&&(Q=new W(Q,Ce,null,n,re),ue.push({event:Q,listeners:Ue}))}}if((t&7)===0){e:{if(Q=e==="mouseover"||e==="pointerover",W=e==="mouseout"||e==="pointerout",Q&&n!==no&&(Ce=n.relatedTarget||n.fromElement)&&(fa(Ce)||Ce[Hn]))break e;if((W||Q)&&(Q=re.window===re?re:(Q=re.ownerDocument)?Q.defaultView||Q.parentWindow:window,W?(Ce=n.relatedTarget||n.toElement,W=Y,Ce=Ce?fa(Ce):null,Ce!==null&&(lt=d(Ce),Ue=Ce.tag,Ce!==lt||Ue!==5&&Ue!==27&&Ue!==6)&&(Ce=null)):(W=null,Ce=Y),W!==Ce)){if(Ue=Ju,le="onMouseLeave",V="onMouseEnter",q="mouse",(e==="pointerout"||e==="pointerover")&&(Ue=Xu,le="onPointerLeave",V="onPointerEnter",q="pointer"),lt=W==null?Q:Ga(W),K=Ce==null?Q:Ga(Ce),Q=new Ue(le,q+"leave",W,n,re),Q.target=lt,Q.relatedTarget=K,le=null,fa(re)===Y&&(Ue=new Ue(V,q+"enter",Ce,n,re),Ue.target=K,Ue.relatedTarget=lt,le=Ue),lt=le,W&&Ce)t:{for(Ue=zy,V=W,q=Ce,K=0,le=V;le;le=Ue(le))K++;le=0;for(var ze=q;ze;ze=Ue(ze))le++;for(;0<K-le;)V=Ue(V),K--;for(;0<le-K;)q=Ue(q),le--;for(;K--;){if(V===q||q!==null&&V===q.alternate){Ue=V;break t}V=Ue(V),q=Ue(q)}Ue=null}else Ue=null;W!==null&&Ph(ue,Q,W,Ue,!1),Ce!==null&&lt!==null&&Ph(ue,lt,Ce,Ue,!0)}}e:{if(Q=Y?Ga(Y):window,W=Q.nodeName&&Q.nodeName.toLowerCase(),W==="select"||W==="input"&&Q.type==="file")var Ze=rd;else if(ad(Q))if(sd)Ze=Vm;else{Ze=$m;var Ne=Hm}else W=Q.nodeName,!W||W.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?Y&&Pn(Y.elementType)&&(Ze=rd):Ze=Pm;if(Ze&&(Ze=Ze(e,Y))){id(ue,Ze,n,re);break e}Ne&&Ne(e,Q,Y),e==="focusout"&&Y&&Q.type==="number"&&Y.memoizedProps.value!=null&&hn(Q,"number",Q.value)}switch(Ne=Y?Ga(Y):window,e){case"focusin":(ad(Ne)||Ne.contentEditable==="true")&&(ki=Ne,mo=Y,Rr=null);break;case"focusout":Rr=mo=ki=null;break;case"mousedown":yo=!0;break;case"contextmenu":case"mouseup":case"dragend":yo=!1,gd(ue,n,re);break;case"selectionchange":if(Fm)break;case"keydown":case"keyup":gd(ue,n,re)}var $e;if(fo)e:{switch(e){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else Oi?td(e,n)&&(Ke="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ke="onCompositionStart");Ke&&(Zu&&n.locale!=="ko"&&(Oi||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&Oi&&($e=Ku()):(ma=re,so="value"in ma?ma.value:ma.textContent,Oi=!0)),Ne=_l(Y,Ke),0<Ne.length&&(Ke=new Qu(Ke,e,null,n,re),ue.push({event:Ke,listeners:Ne}),$e?Ke.data=$e:($e=nd(n),$e!==null&&(Ke.data=$e)))),($e=Bm?Lm(e,n):Mm(e,n))&&(Ke=_l(Y,"onBeforeInput"),0<Ke.length&&(Ne=new Qu("onBeforeInput","beforeinput",null,n,re),ue.push({event:Ne,listeners:Ke}),Ne.data=$e)),Ny(ue,e,Y,n,re)}Hh(ue,t)})}function ts(e,t,n){return{instance:e,listener:t,currentTarget:n}}function _l(e,t){for(var n=t+"Capture",r=[];e!==null;){var c=e,f=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||f===null||(c=jr(e,n),c!=null&&r.unshift(ts(e,c,f)),c=jr(e,t),c!=null&&r.push(ts(e,c,f))),e.tag===3)return r;e=e.return}return[]}function zy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Ph(e,t,n,r,c){for(var f=t._reactName,y=[];n!==null&&n!==r;){var S=n,z=S.alternate,Y=S.stateNode;if(S=S.tag,z!==null&&z===r)break;S!==5&&S!==26&&S!==27||Y===null||(z=Y,c?(Y=jr(n,f),Y!=null&&y.unshift(ts(n,Y,z))):c||(Y=jr(n,f),Y!=null&&y.push(ts(n,Y,z)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var Uy=/\r\n?/g,Dy=/\u0000|\uFFFD/g;function Vh(e){return(typeof e=="string"?e:""+e).replace(Uy,`
`).replace(Dy,"")}function Gh(e,t){return t=Vh(t),Vh(e)===t}function st(e,t,n,r,c,f){switch(n){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||Te(e,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&Te(e,""+r);break;case"className":Ae(e,"class",r);break;case"tabIndex":Ae(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":Ae(e,n,r);break;case"style":pa(e,r,f);break;case"data":if(t!=="object"){Ae(e,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=Ts(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(n==="formAction"?(t!=="input"&&st(e,t,"name",c.name,c,null),st(e,t,"formEncType",c.formEncType,c,null),st(e,t,"formMethod",c.formMethod,c,null),st(e,t,"formTarget",c.formTarget,c,null)):(st(e,t,"encType",c.encType,c,null),st(e,t,"method",c.method,c,null),st(e,t,"target",c.target,c,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=Ts(""+r),e.setAttribute(n,r);break;case"onClick":r!=null&&(e.onclick=Vn);break;case"onScroll":r!=null&&Ge("scroll",e);break;case"onScrollEnd":r!=null&&Ge("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(n=r.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}n=Ts(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":r===!0?e.setAttribute(n,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Ge("beforetoggle",e),Ge("toggle",e),we(e,"popover",r);break;case"xlinkActuate":Le(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":Le(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":Le(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":Le(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":Le(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":Le(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":Le(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":Le(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":Le(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":we(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=cm.get(n)||n,we(e,n,r))}}function $c(e,t,n,r,c,f){switch(n){case"style":pa(e,r,f);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(n=r.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof r=="string"?Te(e,r):(typeof r=="number"||typeof r=="bigint")&&Te(e,""+r);break;case"onScroll":r!=null&&Ge("scroll",e);break;case"onScrollEnd":r!=null&&Ge("scrollend",e);break;case"onClick":r!=null&&(e.onclick=Vn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ie.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),f=e[Ht]||null,f=f!=null?f[n]:null,typeof f=="function"&&e.removeEventListener(t,f,c),typeof r=="function")){typeof f!="function"&&f!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,c);break e}n in e?e[n]=r:r===!0?e.setAttribute(n,""):we(e,n,r)}}}function Mt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",e),Ge("load",e);var r=!1,c=!1,f;for(f in n)if(n.hasOwnProperty(f)){var y=n[f];if(y!=null)switch(f){case"src":r=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:st(e,t,f,y,n,null)}}c&&st(e,t,"srcSet",n.srcSet,n,null),r&&st(e,t,"src",n.src,n,null);return;case"input":Ge("invalid",e);var S=f=y=c=null,z=null,Y=null;for(r in n)if(n.hasOwnProperty(r)){var re=n[r];if(re!=null)switch(r){case"name":c=re;break;case"type":y=re;break;case"checked":z=re;break;case"defaultChecked":Y=re;break;case"value":f=re;break;case"defaultValue":S=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(l(137,t));break;default:st(e,t,r,re,n,null)}}ga(e,f,S,z,Y,y,c,!1);return;case"select":Ge("invalid",e),r=y=f=null;for(c in n)if(n.hasOwnProperty(c)&&(S=n[c],S!=null))switch(c){case"value":f=S;break;case"defaultValue":y=S;break;case"multiple":r=S;default:st(e,t,c,S,n,null)}t=f,n=y,e.multiple=!!r,t!=null?Ee(e,!!r,t,!1):n!=null&&Ee(e,!!r,n,!0);return;case"textarea":Ge("invalid",e),f=c=r=null;for(y in n)if(n.hasOwnProperty(y)&&(S=n[y],S!=null))switch(y){case"value":r=S;break;case"defaultValue":c=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(l(91));break;default:st(e,t,y,S,n,null)}Qe(e,r,c,f);return;case"option":for(z in n)if(n.hasOwnProperty(z)&&(r=n[z],r!=null))switch(z){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:st(e,t,z,r,n,null)}return;case"dialog":Ge("beforetoggle",e),Ge("toggle",e),Ge("cancel",e),Ge("close",e);break;case"iframe":case"object":Ge("load",e);break;case"video":case"audio":for(r=0;r<es.length;r++)Ge(es[r],e);break;case"image":Ge("error",e),Ge("load",e);break;case"details":Ge("toggle",e);break;case"embed":case"source":case"link":Ge("error",e),Ge("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in n)if(n.hasOwnProperty(Y)&&(r=n[Y],r!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:st(e,t,Y,r,n,null)}return;default:if(Pn(t)){for(re in n)n.hasOwnProperty(re)&&(r=n[re],r!==void 0&&$c(e,t,re,r,n,void 0));return}}for(S in n)n.hasOwnProperty(S)&&(r=n[S],r!=null&&st(e,t,S,r,n,null))}function By(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,f=null,y=null,S=null,z=null,Y=null,re=null;for(W in n){var ue=n[W];if(n.hasOwnProperty(W)&&ue!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":z=ue;default:r.hasOwnProperty(W)||st(e,t,W,null,r,ue)}}for(var Q in r){var W=r[Q];if(ue=n[Q],r.hasOwnProperty(Q)&&(W!=null||ue!=null))switch(Q){case"type":f=W;break;case"name":c=W;break;case"checked":Y=W;break;case"defaultChecked":re=W;break;case"value":y=W;break;case"defaultValue":S=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(l(137,t));break;default:W!==ue&&st(e,t,Q,W,r,ue)}}Ka(e,y,S,z,Y,re,f,c);return;case"select":W=y=S=Q=null;for(f in n)if(z=n[f],n.hasOwnProperty(f)&&z!=null)switch(f){case"value":break;case"multiple":W=z;default:r.hasOwnProperty(f)||st(e,t,f,null,r,z)}for(c in r)if(f=r[c],z=n[c],r.hasOwnProperty(c)&&(f!=null||z!=null))switch(c){case"value":Q=f;break;case"defaultValue":S=f;break;case"multiple":y=f;default:f!==z&&st(e,t,c,f,r,z)}t=S,n=y,r=W,Q!=null?Ee(e,!!n,Q,!1):!!r!=!!n&&(t!=null?Ee(e,!!n,t,!0):Ee(e,!!n,n?[]:"",!1));return;case"textarea":W=Q=null;for(S in n)if(c=n[S],n.hasOwnProperty(S)&&c!=null&&!r.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:st(e,t,S,null,r,c)}for(y in r)if(c=r[y],f=n[y],r.hasOwnProperty(y)&&(c!=null||f!=null))switch(y){case"value":Q=c;break;case"defaultValue":W=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==f&&st(e,t,y,c,r,f)}Ie(e,Q,W);return;case"option":for(var Ce in n)if(Q=n[Ce],n.hasOwnProperty(Ce)&&Q!=null&&!r.hasOwnProperty(Ce))switch(Ce){case"selected":e.selected=!1;break;default:st(e,t,Ce,null,r,Q)}for(z in r)if(Q=r[z],W=n[z],r.hasOwnProperty(z)&&Q!==W&&(Q!=null||W!=null))switch(z){case"selected":e.selected=Q&&typeof Q!="function"&&typeof Q!="symbol";break;default:st(e,t,z,Q,r,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in n)Q=n[Ue],n.hasOwnProperty(Ue)&&Q!=null&&!r.hasOwnProperty(Ue)&&st(e,t,Ue,null,r,Q);for(Y in r)if(Q=r[Y],W=n[Y],r.hasOwnProperty(Y)&&Q!==W&&(Q!=null||W!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(l(137,t));break;default:st(e,t,Y,Q,r,W)}return;default:if(Pn(t)){for(var lt in n)Q=n[lt],n.hasOwnProperty(lt)&&Q!==void 0&&!r.hasOwnProperty(lt)&&$c(e,t,lt,void 0,r,Q);for(re in r)Q=r[re],W=n[re],!r.hasOwnProperty(re)||Q===W||Q===void 0&&W===void 0||$c(e,t,re,Q,r,W);return}}for(var V in n)Q=n[V],n.hasOwnProperty(V)&&Q!=null&&!r.hasOwnProperty(V)&&st(e,t,V,null,r,Q);for(ue in r)Q=r[ue],W=n[ue],!r.hasOwnProperty(ue)||Q===W||Q==null&&W==null||st(e,t,ue,Q,r,W)}function Fh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ly(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var c=n[r],f=c.transferSize,y=c.initiatorType,S=c.duration;if(f&&S&&Fh(y)){for(y=0,S=c.responseEnd,r+=1;r<n.length;r++){var z=n[r],Y=z.startTime;if(Y>S)break;var re=z.transferSize,ue=z.initiatorType;re&&Fh(ue)&&(z=z.responseEnd,y+=re*(z<S?1:(S-Y)/(z-Y)))}if(--r,t+=8*(f+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Pc=null,Vc=null;function jl(e){return e.nodeType===9?e:e.ownerDocument}function Kh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Yh(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Gc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Fc=null;function My(){var e=window.event;return e&&e.type==="popstate"?e===Fc?!1:(Fc=e,!0):(Fc=null,!1)}var Jh=typeof setTimeout=="function"?setTimeout:void 0,qy=typeof clearTimeout=="function"?clearTimeout:void 0,Qh=typeof Promise=="function"?Promise:void 0,Iy=typeof queueMicrotask=="function"?queueMicrotask:typeof Qh<"u"?function(e){return Qh.resolve(null).then(e).catch(Hy)}:Jh;function Hy(e){setTimeout(function(){throw e})}function za(e){return e==="head"}function Xh(e,t){var n=t,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(r===0){e.removeChild(c),rr(t);return}r--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")r++;else if(n==="html")ns(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,ns(n);for(var f=n.firstChild;f;){var y=f.nextSibling,S=f.nodeName;f[da]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||n.removeChild(f),f=y}}else n==="body"&&ns(e.ownerDocument.body);n=c}while(n);rr(t)}function Zh(e,t){var n=e;e=0;do{var r=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=r}while(n)}function Kc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Kc(n),Ai(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function $y(e,t,n,r){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[da])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=xn(e.nextSibling),e===null)break}return null}function Py(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=xn(e.nextSibling),e===null))return null;return e}function Wh(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=xn(e.nextSibling),e===null))return null;return e}function Yc(e){return e.data==="$?"||e.data==="$~"}function Jc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Vy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function xn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Qc=null;function eg(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return xn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function tg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function ng(e,t,n){switch(t=jl(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function ns(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ai(e)}var _n=new Map,ag=new Set;function Sl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var sa=U.d;U.d={f:Gy,r:Fy,D:Ky,C:Yy,L:Jy,m:Qy,X:Zy,S:Xy,M:Wy};function Gy(){var e=sa.f(),t=gl();return e||t}function Fy(e){var t=ha(e);t!==null&&t.tag===5&&t.type==="form"?xf(t):sa.r(e)}var nr=typeof document>"u"?null:document;function ig(e,t,n){var r=nr;if(r&&typeof t=="string"&&t){var c=Yt(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),ag.has(c)||(ag.add(c),e={rel:e,crossOrigin:n,href:t},r.querySelector(c)===null&&(t=r.createElement("link"),Mt(t,"link",e),ae(t),r.head.appendChild(t)))}}function Ky(e){sa.D(e),ig("dns-prefetch",e,null)}function Yy(e,t){sa.C(e,t),ig("preconnect",e,t)}function Jy(e,t,n){sa.L(e,t,n);var r=nr;if(r&&e&&t){var c='link[rel="preload"][as="'+Yt(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+Yt(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+Yt(n.imageSizes)+'"]')):c+='[href="'+Yt(e)+'"]';var f=c;switch(t){case"style":f=ar(e);break;case"script":f=ir(e)}_n.has(f)||(e=x({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),_n.set(f,e),r.querySelector(c)!==null||t==="style"&&r.querySelector(as(f))||t==="script"&&r.querySelector(is(f))||(t=r.createElement("link"),Mt(t,"link",e),ae(t),r.head.appendChild(t)))}}function Qy(e,t){sa.m(e,t);var n=nr;if(n&&e){var r=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+Yt(r)+'"][href="'+Yt(e)+'"]',f=c;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=ir(e)}if(!_n.has(f)&&(e=x({rel:"modulepreload",href:e},t),_n.set(f,e),n.querySelector(c)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(is(f)))return}r=n.createElement("link"),Mt(r,"link",e),ae(r),n.head.appendChild(r)}}}function Xy(e,t,n){sa.S(e,t,n);var r=nr;if(r&&e){var c=H(r).hoistableStyles,f=ar(e);t=t||"default";var y=c.get(f);if(!y){var S={loading:0,preload:null};if(y=r.querySelector(as(f)))S.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},n),(n=_n.get(f))&&Xc(e,n);var z=y=r.createElement("link");ae(z),Mt(z,"link",e),z._p=new Promise(function(Y,re){z.onload=Y,z.onerror=re}),z.addEventListener("load",function(){S.loading|=1}),z.addEventListener("error",function(){S.loading|=2}),S.loading|=4,wl(y,t,r)}y={type:"stylesheet",instance:y,count:1,state:S},c.set(f,y)}}}function Zy(e,t){sa.X(e,t);var n=nr;if(n&&e){var r=H(n).hoistableScripts,c=ir(e),f=r.get(c);f||(f=n.querySelector(is(c)),f||(e=x({src:e,async:!0},t),(t=_n.get(c))&&Zc(e,t),f=n.createElement("script"),ae(f),Mt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},r.set(c,f))}}function Wy(e,t){sa.M(e,t);var n=nr;if(n&&e){var r=H(n).hoistableScripts,c=ir(e),f=r.get(c);f||(f=n.querySelector(is(c)),f||(e=x({src:e,async:!0,type:"module"},t),(t=_n.get(c))&&Zc(e,t),f=n.createElement("script"),ae(f),Mt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},r.set(c,f))}}function rg(e,t,n,r){var c=(c=fe.current)?Sl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=ar(n.href),n=H(c).hoistableStyles,r=n.get(t),r||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=ar(n.href);var f=H(c).hoistableStyles,y=f.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=c.querySelector(as(e)))&&!f._p&&(y.instance=f,y.state.loading=5),_n.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},_n.set(e,n),f||ev(c,e,n,y.state))),t&&r===null)throw Error(l(528,""));return y}if(t&&r!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=ir(n),n=H(c).hoistableScripts,r=n.get(t),r||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function ar(e){return'href="'+Yt(e)+'"'}function as(e){return'link[rel="stylesheet"]['+e+"]"}function sg(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function ev(e,t,n,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),Mt(t,"link",n),ae(t),e.head.appendChild(t))}function ir(e){return'[src="'+Yt(e)+'"]'}function is(e){return"script[async]"+e}function lg(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+Yt(n.href)+'"]');if(r)return t.instance=r,ae(r),r;var c=x({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),ae(r),Mt(r,"style",c),wl(r,n.precedence,e),t.instance=r;case"stylesheet":c=ar(n.href);var f=e.querySelector(as(c));if(f)return t.state.loading|=4,t.instance=f,ae(f),f;r=sg(n),(c=_n.get(c))&&Xc(r,c),f=(e.ownerDocument||e).createElement("link"),ae(f);var y=f;return y._p=new Promise(function(S,z){y.onload=S,y.onerror=z}),Mt(f,"link",r),t.state.loading|=4,wl(f,n.precedence,e),t.instance=f;case"script":return f=ir(n.src),(c=e.querySelector(is(f)))?(t.instance=c,ae(c),c):(r=n,(c=_n.get(f))&&(r=x({},n),Zc(r,c)),e=e.ownerDocument||e,c=e.createElement("script"),ae(c),Mt(c,"link",r),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(r=t.instance,t.state.loading|=4,wl(r,n.precedence,e));return t.instance}function wl(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=r.length?r[r.length-1]:null,f=c,y=0;y<r.length;y++){var S=r[y];if(S.dataset.precedence===t)f=S;else if(f!==c)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Xc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Zc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var El=null;function og(e,t,n){if(El===null){var r=new Map,c=El=new Map;c.set(n,r)}else c=El,r=c.get(n),r||(r=new Map,c.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var f=n[c];if(!(f[da]||f[Ot]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var S=r.get(y);S?S.push(f):r.set(y,[f])}}return r}function cg(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function tv(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ug(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function nv(e,t,n,r){if(n.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=ar(r.href),f=t.querySelector(as(c));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Cl.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=f,ae(f);return}f=t.ownerDocument||t,r=sg(r),(c=_n.get(c))&&Xc(r,c),f=f.createElement("link"),ae(f);var y=f;y._p=new Promise(function(S,z){y.onload=S,y.onerror=z}),Mt(f,"link",r),n.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=Cl.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Wc=0;function av(e,t){return e.stylesheets&&e.count===0&&Al(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&Al(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&Wc===0&&(Wc=62500*Ly());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Al(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>Wc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(c)}}:null}function Cl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Al(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Tl=null;function Al(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Tl=new Map,t.forEach(iv,e),Tl=null,Cl.call(e))}function iv(e,t){if(!(t.state.loading&4)){var n=Tl.get(e);if(n)var r=n.get(null);else{n=new Map,Tl.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<c.length;f++){var y=c[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),r=y)}r&&n.set(null,r)}c=t.instance,y=c.getAttribute("data-precedence"),f=n.get(y)||r,f===r&&n.set(null,c),n.set(y,c),this.count++,r=Cl.bind(this),c.addEventListener("load",r),c.addEventListener("error",r),f?f.parentNode.insertBefore(c,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var rs={$$typeof:M,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function rv(e,t,n,r,c,f,y,S,z){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Cn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cn(0),this.hiddenUpdates=Cn(null),this.identifierPrefix=r,this.onUncaughtError=c,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function dg(e,t,n,r,c,f,y,S,z,Y,re,ue){return e=new rv(e,t,n,y,z,Y,re,ue,S),t=1,f===!0&&(t|=24),f=rn(3,null,null,t),e.current=f,f.stateNode=e,t=ko(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:r,isDehydrated:n,cache:t},Bo(f),e}function fg(e){return e?(e=Di,e):Di}function hg(e,t,n,r,c,f){c=fg(c),r.context===null?r.context=c:r.pendingContext=c,r=ja(t),r.payload={element:n},f=f===void 0?null:f,f!==null&&(r.callback=f),n=Sa(e,r,t),n!==null&&(tn(n,e,t),Lr(n,e,t))}function gg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function eu(e,t){gg(e,t),(e=e.alternate)&&gg(e,t)}function pg(e){if(e.tag===13||e.tag===31){var t=Xa(e,67108864);t!==null&&tn(t,e,67108864),eu(e,67108864)}}function mg(e){if(e.tag===13||e.tag===31){var t=un();t=vr(t);var n=Xa(e,t);n!==null&&tn(n,e,t),eu(e,t)}}var Nl=!0;function sv(e,t,n,r){var c=E.T;E.T=null;var f=U.p;try{U.p=2,tu(e,t,n,r)}finally{U.p=f,E.T=c}}function lv(e,t,n,r){var c=E.T;E.T=null;var f=U.p;try{U.p=8,tu(e,t,n,r)}finally{U.p=f,E.T=c}}function tu(e,t,n,r){if(Nl){var c=nu(r);if(c===null)Hc(e,t,r,Rl,n),vg(e,r);else if(cv(c,e,t,n,r))r.stopPropagation();else if(vg(e,r),t&4&&-1<ov.indexOf(e)){for(;c!==null;){var f=ha(c);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=qn(f.pendingLanes);if(y!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var z=1<<31-Ft(y);S.entanglements[1]|=z,y&=~z}Mn(f),(tt&6)===0&&(fl=Vt()+500,Wr(0))}}break;case 31:case 13:S=Xa(f,2),S!==null&&tn(S,f,2),gl(),eu(f,2)}if(f=nu(r),f===null&&Hc(e,t,r,Rl,n),f===c)break;c=f}c!==null&&r.stopPropagation()}else Hc(e,t,r,null,n)}}function nu(e){return e=ao(e),au(e)}var Rl=null;function au(e){if(Rl=null,e=fa(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=h(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Rl=e,null}function yg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bi()){case vs:return 2;case xi:return 8;case Pa:case yr:return 32;case bs:return 268435456;default:return 32}default:return 32}}var iu=!1,Ua=null,Da=null,Ba=null,ss=new Map,ls=new Map,La=[],ov="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vg(e,t){switch(e){case"focusin":case"focusout":Ua=null;break;case"dragenter":case"dragleave":Da=null;break;case"mouseover":case"mouseout":Ba=null;break;case"pointerover":case"pointerout":ss.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ls.delete(t.pointerId)}}function os(e,t,n,r,c,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:f,targetContainers:[c]},t!==null&&(t=ha(t),t!==null&&pg(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function cv(e,t,n,r,c){switch(t){case"focusin":return Ua=os(Ua,e,t,n,r,c),!0;case"dragenter":return Da=os(Da,e,t,n,r,c),!0;case"mouseover":return Ba=os(Ba,e,t,n,r,c),!0;case"pointerover":var f=c.pointerId;return ss.set(f,os(ss.get(f)||null,e,t,n,r,c)),!0;case"gotpointercapture":return f=c.pointerId,ls.set(f,os(ls.get(f)||null,e,t,n,r,c)),!0}return!1}function bg(e){var t=fa(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){e.blockedOn=t,In(e.priority,function(){mg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,In(e.priority,function(){mg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ol(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=nu(e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);no=r,n.target.dispatchEvent(r),no=null}else return t=ha(n),t!==null&&pg(t),e.blockedOn=n,!1;t.shift()}return!0}function xg(e,t,n){Ol(e)&&n.delete(t)}function uv(){iu=!1,Ua!==null&&Ol(Ua)&&(Ua=null),Da!==null&&Ol(Da)&&(Da=null),Ba!==null&&Ol(Ba)&&(Ba=null),ss.forEach(xg),ls.forEach(xg)}function kl(e,t){e.blockedOn===t&&(e.blockedOn=null,iu||(iu=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,uv)))}var zl=null;function _g(e){zl!==e&&(zl=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){zl===e&&(zl=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],c=e[t+2];if(typeof r!="function"){if(au(r||n)===null)continue;break}var f=ha(n);f!==null&&(e.splice(t,3),t-=3,nc(f,{pending:!0,data:c,method:n.method,action:r},r,c))}}))}function rr(e){function t(z){return kl(z,e)}Ua!==null&&kl(Ua,e),Da!==null&&kl(Da,e),Ba!==null&&kl(Ba,e),ss.forEach(t),ls.forEach(t);for(var n=0;n<La.length;n++){var r=La[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<La.length&&(n=La[0],n.blockedOn===null);)bg(n),n.blockedOn===null&&La.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(r=0;r<n.length;r+=3){var c=n[r],f=n[r+1],y=c[Ht]||null;if(typeof f=="function")y||_g(n);else if(y){var S=null;if(f&&f.hasAttribute("formAction")){if(c=f,y=f[Ht]||null)S=y.formAction;else if(au(c)!==null)continue}else S=y.action;typeof S=="function"?n[r+1]=S:(n.splice(r,3),r-=3),_g(n)}}}function jg(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function ru(e){this._internalRoot=e}Ul.prototype.render=ru.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,r=un();hg(n,r,e,t,null,null)},Ul.prototype.unmount=ru.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hg(e.current,2,null,e,null,null),gl(),t[Hn]=null}};function Ul(e){this._internalRoot=e}Ul.prototype.unstable_scheduleHydration=function(e){if(e){var t=br();e={blockedOn:null,target:e,priority:t};for(var n=0;n<La.length&&t!==0&&t<La[n].priority;n++);La.splice(n,0,e),n===0&&bg(e)}};var Sg=a.version;if(Sg!=="19.2.0")throw Error(l(527,Sg,"19.2.0"));U.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var dv={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:E,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dl.isDisabled&&Dl.supportsFiber)try{ca=Dl.inject(dv),Gt=Dl}catch{}}return us.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,r="",c=Rf,f=Of,y=kf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=dg(e,1,!1,null,null,n,r,null,c,f,y,jg),e[Hn]=t.current,Ic(e),new ru(t)},us.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var r=!1,c="",f=Rf,y=Of,S=kf,z=null;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(S=n.onRecoverableError),n.formState!==void 0&&(z=n.formState)),t=dg(e,1,!0,t,n??null,r,c,z,f,y,S,jg),t.context=fg(null),n=t.current,r=un(),r=vr(r),c=ja(r),c.callback=null,Sa(n,c,r),n=r,t.current.lanes=n,nn(t,n),Mn(t),e[Hn]=t.current,Ic(e),new Ul(t)},us.version="19.2.0",us}var zg;function jv(){if(zg)return lu.exports;zg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),lu.exports=_v(),lu.exports}var Sv=jv(),j=Uu();const Ql=fp(j);var _u=function(o,a){return _u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},_u(o,a)};function gp(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");_u(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var Gl=function(){return Gl=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},Gl.apply(this,arguments)};function pr(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function pp(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(h=o[g])&&(d=(u<3?h(d):u>3?h(a,s,d):h(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function mp(o,a){return function(s,l){a(s,l,o)}}function yp(o,a,s,l,u,d){function h(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),x,_=!1,b=s.length-1;b>=0;b--){var w={};for(var N in l)w[N]=N==="access"?{}:l[N];for(var N in l.access)w.access[N]=l.access[N];w.addInitializer=function(T){if(_)throw new TypeError("Cannot add initializers after decoration has completed");d.push(h(T||null))};var R=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(R===void 0)continue;if(R===null||typeof R!="object")throw new TypeError("Object expected");(x=h(R.get))&&(v.get=x),(x=h(R.set))&&(v.set=x),(x=h(R.init))&&u.unshift(x)}else(x=h(R))&&(g==="field"?u.unshift(x):v[p]=x)}m&&Object.defineProperty(m,l.name,v),_=!0}function vp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function bp(o){return typeof o=="symbol"?o:"".concat(o)}function xp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function _p(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function Oe(o,a,s,l){function u(d){return d instanceof s?d:new s(function(h){h(d)})}return new(s||(s=Promise))(function(d,h){function g(v){try{m(l.next(v))}catch(x){h(x)}}function p(v){try{m(l.throw(v))}catch(x){h(x)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function jp(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=g(0),h.throw=g(1),h.return=g(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;h&&(h=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Xl=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function Sp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&Xl(a,o,s)}function Fl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Du(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],h;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){h={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(h)throw h.error}}return d}function wp(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(Du(arguments[a]));return o}function Ep(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],h=0,g=d.length;h<g;h++,u++)l[u]=d[h];return l}function Cp(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function gr(o){return this instanceof gr?(this.v=o,this):new gr(o)}function Tp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",h),u[Symbol.asyncIterator]=function(){return this},u;function h(b){return function(w){return Promise.resolve(w).then(b,x)}}function g(b,w){l[b]&&(u[b]=function(N){return new Promise(function(R,T){d.push([b,N,R,T])>1||p(b,N)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(N){_(d[0][3],N)}}function m(b){b.value instanceof gr?Promise.resolve(b.value.v).then(v,x):_(d[0][2],b)}function v(b){p("next",b)}function x(b){p("throw",b)}function _(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function Ap(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(h){return(s=!s)?{value:gr(o[u](h)),done:!1}:d?d(h):h}:d}}function Np(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Fl=="function"?Fl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(h){return new Promise(function(g,p){h=o[d](h),u(g,p,h.done,h.value)})}}function u(d,h,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},h)}}function Rp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var wv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},ju=function(o){return ju=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},ju(o)};function Op(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=ju(o),l=0;l<s.length;l++)s[l]!=="default"&&Xl(a,o,s[l]);return wv(a,o),a}function kp(o){return o&&o.__esModule?o:{default:o}}function zp(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function Up(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Dp(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function Bp(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var Ev=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Lp(o){function a(d){o.error=o.hasError?new Ev(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(h){return a(h),u()})}else l|=1}catch(h){a(h)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function Mp(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,h){return l?a?".jsx":".js":u&&(!d||!h)?s:u+d+"."+h.toLowerCase()+"js"}):o}const Cv={__extends:gp,__assign:Gl,__rest:pr,__decorate:pp,__param:mp,__esDecorate:yp,__runInitializers:vp,__propKey:bp,__setFunctionName:xp,__metadata:_p,__awaiter:Oe,__generator:jp,__createBinding:Xl,__exportStar:Sp,__values:Fl,__read:Du,__spread:wp,__spreadArrays:Ep,__spreadArray:Cp,__await:gr,__asyncGenerator:Tp,__asyncDelegator:Ap,__asyncValues:Np,__makeTemplateObject:Rp,__importStar:Op,__importDefault:kp,__classPrivateFieldGet:zp,__classPrivateFieldSet:Up,__classPrivateFieldIn:Dp,__addDisposableResource:Bp,__disposeResources:Lp,__rewriteRelativeImportExtension:Mp},Tv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Bp,get __assign(){return Gl},__asyncDelegator:Ap,__asyncGenerator:Tp,__asyncValues:Np,__await:gr,__awaiter:Oe,__classPrivateFieldGet:zp,__classPrivateFieldIn:Dp,__classPrivateFieldSet:Up,__createBinding:Xl,__decorate:pp,__disposeResources:Lp,__esDecorate:yp,__exportStar:Sp,__extends:gp,__generator:jp,__importDefault:kp,__importStar:Op,__makeTemplateObject:Rp,__metadata:_p,__param:mp,__propKey:bp,__read:Du,__rest:pr,__rewriteRelativeImportExtension:Mp,__runInitializers:vp,__setFunctionName:xp,__spread:wp,__spreadArray:Cp,__spreadArrays:Ep,__values:Fl,default:Cv},Symbol.toStringTag,{value:"Module"})),Av=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Bu extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Nv extends Bu{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Ug extends Bu{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Dg extends Bu{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var Su;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Su||(Su={}));class Rv{constructor(a,{headers:s={},customFetch:l,region:u=Su.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Av(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return Oe(this,arguments,void 0,function*(s,l={}){var u;let d,h;try{const{headers:g,method:p,body:m,signal:v,timeout:x}=l;let _={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${s}`);b&&b!=="any"&&(_["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let N;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",N=m):typeof m=="string"?(_["Content-Type"]="text/plain",N=m):typeof FormData<"u"&&m instanceof FormData?N=m:(_["Content-Type"]="application/json",N=JSON.stringify(m)):N=m;let R=v;x&&(h=new AbortController,d=setTimeout(()=>h.abort(),x),v?(R=h.signal,v.addEventListener("abort",()=>h.abort())):R=h.signal);const T=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),g),body:N,signal:R}).catch(C=>{throw new Nv(C)}),$=T.headers.get("x-relay-error");if($&&$==="true")throw new Ug(T);if(!T.ok)throw new Dg(T);let M=((u=T.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),G;return M==="application/json"?G=yield T.json():M==="application/octet-stream"||M==="application/pdf"?G=yield T.blob():M==="text/event-stream"?G=T:M==="multipart/form-data"?G=yield T.formData():G=yield T.text(),{data:G,error:null,response:T}}catch(g){return{data:null,error:g,response:g instanceof Dg||g instanceof Ug?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Pt={};const mr=gv(Tv);var Bl={},Ll={},Ml={},ql={},Il={},Hl={},Bg;function qp(){if(Bg)return Hl;Bg=1,Object.defineProperty(Hl,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Hl.default=o,Hl}var Lg;function Ip(){if(Lg)return Il;Lg=1,Object.defineProperty(Il,"__esModule",{value:!0});const a=mr.__importDefault(qp());class s{constructor(u){var d,h;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(h=u.isMaybeSingle)!==null&&h!==void 0?h:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,x,_;let b=null,w=null,N=null,R=p.status,T=p.statusText;if(p.ok){if(this.method!=="HEAD"){const C=await p.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=C:w=JSON.parse(C))}const M=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),G=(x=p.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");M&&G&&G.length>1&&(N=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,N=null,R=406,T="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const M=await p.text();try{b=JSON.parse(M),Array.isArray(b)&&p.status===404&&(w=[],b=null,R=200,T="OK")}catch{p.status===404&&M===""?(R=204,T="No Content"):b={message:M}}if(b&&this.isMaybeSingle&&(!((_=b?.details)===null||_===void 0)&&_.includes("0 rows"))&&(b=null,R=200,T="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:N,status:R,statusText:T}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,x;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(x=p?.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Il.default=s,Il}var Mg;function Hp(){if(Mg)return ql;Mg=1,Object.defineProperty(ql,"__esModule",{value:!0});const a=mr.__importDefault(Ip());class s extends a.default{select(u){let d=!1;const h=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",h),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:h,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:h=d}={}){const g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:h,referencedTable:g=h}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:h=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const x=[u?"analyze":null,d?"verbose":null,h?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),_=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${_}"; options=${x};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return ql.default=s,ql}var qg;function Lu(){if(qg)return Ml;qg=1,Object.defineProperty(Ml,"__esModule",{value:!0});const a=mr.__importDefault(Hp()),s=new RegExp("[,()]");class l extends a.default{eq(d,h){return this.url.searchParams.append(d,`eq.${h}`),this}neq(d,h){return this.url.searchParams.append(d,`neq.${h}`),this}gt(d,h){return this.url.searchParams.append(d,`gt.${h}`),this}gte(d,h){return this.url.searchParams.append(d,`gte.${h}`),this}lt(d,h){return this.url.searchParams.append(d,`lt.${h}`),this}lte(d,h){return this.url.searchParams.append(d,`lte.${h}`),this}like(d,h){return this.url.searchParams.append(d,`like.${h}`),this}likeAllOf(d,h){return this.url.searchParams.append(d,`like(all).{${h.join(",")}}`),this}likeAnyOf(d,h){return this.url.searchParams.append(d,`like(any).{${h.join(",")}}`),this}ilike(d,h){return this.url.searchParams.append(d,`ilike.${h}`),this}ilikeAllOf(d,h){return this.url.searchParams.append(d,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(d,h){return this.url.searchParams.append(d,`ilike(any).{${h.join(",")}}`),this}is(d,h){return this.url.searchParams.append(d,`is.${h}`),this}in(d,h){const g=Array.from(new Set(h)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cs.{${h.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(h)}`),this}containedBy(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cd.{${h.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(h)}`),this}rangeGt(d,h){return this.url.searchParams.append(d,`sr.${h}`),this}rangeGte(d,h){return this.url.searchParams.append(d,`nxl.${h}`),this}rangeLt(d,h){return this.url.searchParams.append(d,`sl.${h}`),this}rangeLte(d,h){return this.url.searchParams.append(d,`nxr.${h}`),this}rangeAdjacent(d,h){return this.url.searchParams.append(d,`adj.${h}`),this}overlaps(d,h){return typeof h=="string"?this.url.searchParams.append(d,`ov.${h}`):this.url.searchParams.append(d,`ov.{${h.join(",")}}`),this}textSearch(d,h,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${h}`),this}match(d){return Object.entries(d).forEach(([h,g])=>{this.url.searchParams.append(h,`eq.${g}`)}),this}not(d,h,g){return this.url.searchParams.append(d,`not.${h}.${g}`),this}or(d,{foreignTable:h,referencedTable:g=h}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,h,g){return this.url.searchParams.append(d,`${h}.${g}`),this}}return Ml.default=l,Ml}var Ig;function $p(){if(Ig)return Ll;Ig=1,Object.defineProperty(Ll,"__esModule",{value:!0});const a=mr.__importDefault(Lu());class s{constructor(u,{headers:d={},schema:h,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=h,this.fetch=g}select(u,d){const{head:h=!1,count:g}=d??{},p=h?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:h=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(m.length>0){const v=[...new Set(m)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:h=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${h?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const x=u.reduce((_,b)=>_.concat(Object.keys(b)),[]);if(x.length>0){const _=[...new Set(x)].map(b=>`"${b}"`);this.url.searchParams.set("columns",_.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var h;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}delete({count:u}={}){var d;const h="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Ll.default=s,Ll}var Hg;function Ov(){if(Hg)return Bl;Hg=1,Object.defineProperty(Bl,"__esModule",{value:!0});const o=mr,a=o.__importDefault($p()),s=o.__importDefault(Lu());class l{constructor(d,{headers:h={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(h),this.schemaName=g,this.fetch=p}from(d){const h=new URL(`${this.url}/${d}`);return new a.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,h={},{head:g=!1,get:p=!1,count:m}={}){var v;let x;const _=new URL(`${this.url}/rpc/${d}`);let b;g||p?(x=g?"HEAD":"GET",Object.entries(h).filter(([N,R])=>R!==void 0).map(([N,R])=>[N,Array.isArray(R)?`{${R.join(",")}}`:`${R}`]).forEach(([N,R])=>{_.searchParams.append(N,R)})):(x="POST",b=h);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new s.default({method:x,url:_,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return Bl.default=l,Bl}var $g;function kv(){if($g)return Pt;$g=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.PostgrestError=Pt.PostgrestBuilder=Pt.PostgrestTransformBuilder=Pt.PostgrestFilterBuilder=Pt.PostgrestQueryBuilder=Pt.PostgrestClient=void 0;const o=mr,a=o.__importDefault(Ov());Pt.PostgrestClient=a.default;const s=o.__importDefault($p());Pt.PostgrestQueryBuilder=s.default;const l=o.__importDefault(Lu());Pt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Hp());Pt.PostgrestTransformBuilder=u.default;const d=o.__importDefault(Ip());Pt.PostgrestBuilder=d.default;const h=o.__importDefault(qp());return Pt.PostgrestError=h.default,Pt.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:h.default},Pt}var Pp=kv();const Vp=fp(Pp),zv=hv({__proto__:null,default:Vp},[Pp]),{PostgrestClient:Uv,PostgrestQueryBuilder:p_,PostgrestFilterBuilder:m_,PostgrestTransformBuilder:y_,PostgrestBuilder:v_,PostgrestError:b_}=Vp||zv;class Dv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const Bv="2.81.1",Lv=`realtime-js/${Bv}`,Gp="1.0.0",Mv="2.0.0",Pg=Gp,wu=1e4,qv=1e3,Iv=100;var gi;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(gi||(gi={}));var zt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(zt||(zt={}));var jn;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(jn||(jn={}));var Eu;(function(o){o.websocket="websocket"})(Eu||(Eu={}));var pi;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(pi||(pi={}));class Hv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:h}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(l,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(d,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(u,_=>m.setUint8(v++,_.charCodeAt(0)));var x=new Uint8Array(p.byteLength+h.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(h),p.byteLength),x.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(v),_=0;x.setUint8(_++,this.KINDS.userBroadcastPush),x.setUint8(_++,u.length),x.setUint8(_++,d.length),x.setUint8(_++,h.length),x.setUint8(_++,g.length),x.setUint8(_++,this.BINARY_ENCODING),Array.from(u,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(d,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(h,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(g,w=>x.setUint8(_++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,x=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,_=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(_),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,h.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,R=>b.setUint8(w++,R.charCodeAt(0))),Array.from(d,R=>b.setUint8(w++,R.charCodeAt(0))),Array.from(h,R=>b.setUint8(w++,R.charCodeAt(0))),Array.from(g,R=>b.setUint8(w++,R.charCodeAt(0)));var N=new Uint8Array(_.byteLength+v.byteLength);return N.set(new Uint8Array(_),0),N.set(new Uint8Array(v),_.byteLength),N.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,h,g,p]=l;return s({join_ref:u,ref:d,topic:h,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+h));g=g+h;const x=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:x}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:_,response:b};return{join_ref:m,ref:v,topic:x,event:jn.reply,payload:w}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let h=this.HEADER_LENGTH+2;const g=l.decode(a.slice(h,h+u));h=h+u;const p=l.decode(a.slice(h,h+d));h=h+d;const m=JSON.parse(l.decode(a.slice(h,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(_)):_,w={type:this.BROADCAST,event:v,payload:b};return h>0&&(w.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Fp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ut;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(ut||(ut={}));const Vg=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,h)=>(d[h]=$v(h,o,a,u),d),{}):{}},$v=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,h=s[o];return d&&!l.includes(d)?Kp(d,h):Cu(h)},Kp=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return Fv(a,s)}switch(o){case ut.bool:return Pv(a);case ut.float4:case ut.float8:case ut.int2:case ut.int4:case ut.int8:case ut.numeric:case ut.oid:return Vv(a);case ut.json:case ut.jsonb:return Gv(a);case ut.timestamp:return Kv(a);case ut.abstime:case ut.date:case ut.daterange:case ut.int4range:case ut.int8range:case ut.money:case ut.reltime:case ut.text:case ut.time:case ut.timestamptz:case ut.timetz:case ut.tsrange:case ut.tstzrange:return Cu(a);default:return Cu(a)}},Cu=o=>o,Pv=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Vv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Gv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},Fv=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const h=o.slice(1,s);try{d=JSON.parse("["+h+"]")}catch{d=h?h.split(","):[]}return d.map(g=>Kp(a,g))}return o},Kv=o=>typeof o=="string"?o.replace(" ","T"):o,Yp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class fu{constructor(a,s,l={},u=wu){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Gg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Gg||(Gg={}));class fs{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fs.syncState(this.state,u,d,h),this.pendingDiffs.forEach(p=>{this.state=fs.syncDiff(this.state,p,d,h)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=fs.syncDiff(this.state,u,d,h),g())}),this.onJoin((u,d,h)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:h})}),this.onLeave((u,d,h)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),h=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{h[m]||(p[m]=v)}),this.map(h,(m,v)=>{const x=d[m];if(x){const _=v.map(R=>R.presence_ref),b=x.map(R=>R.presence_ref),w=v.filter(R=>b.indexOf(R.presence_ref)<0),N=x.filter(R=>_.indexOf(R.presence_ref)<0);w.length>0&&(g[m]=w),N.length>0&&(p[m]=N)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:h}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const x=a[g].map(b=>b.presence_ref),_=v.filter(b=>x.indexOf(b.presence_ref)<0);a[g].unshift(..._)}l(g,v,p)}),this.map(h,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(x=>x.presence_ref);m=m.filter(x=>v.indexOf(x.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Fg;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Fg||(Fg={}));var hs;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(hs||(hs={}));var la;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(la||(la={}));class Mu{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new fu(this,jn.join,this.params,this.timeout),this.rejoinTimer=new Fp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=zt.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(jn.reply,{},(h,g)=>{this._trigger(this._replyEventName(g),h)}),this.presence=new fs(this),this.broadcastEndpointURL=Yp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==zt.closed){const{config:{broadcast:h,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[hs.PRESENCE]&&this.bindings[hs.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,x={},_={broadcast:h,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(la.CHANNEL_ERROR,b)),this._onClose(()=>a?.(la.CLOSED)),this.updateJoinPayload(Object.assign({config:_},x)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(la.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,R=(w=N?.length)!==null&&w!==void 0?w:0,T=[];for(let $=0;$<R;$++){const M=N[$],{filter:{event:G,schema:C,table:L,filter:B}}=M,P=b&&b[$];if(P&&P.event===G&&P.schema===C&&P.table===L&&P.filter===B)T.push(Object.assign(Object.assign({},M),{id:P.id}));else{this.unsubscribe(),this.state=zt.errored,a?.(la.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,a&&a(la.SUBSCRIBED);return}}).receive("error",b=>{this.state=zt.errored,a?.(la.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(la.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===zt.joined&&a===hs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const h={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:h}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:h,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var h,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(h=this.params)===null||h===void 0?void 0:h.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=zt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(jn.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new fu(this,jn.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=zt.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),h=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),h}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new fu(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Iv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const h=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=jn;if(l&&[g,p,m,v].indexOf(h)>=0&&l!==this._joinRef())return;let _=this._onMessage(h,s,l);if(s&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,N,R;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((R=(N=b.filter)===null||N===void 0?void 0:N.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===h}).map(b=>b.callback(_,l)):(d=this.bindings[h])===null||d===void 0||d.filter(b=>{var w,N,R,T,$,M;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in b){const G=b.id,C=(w=b.filter)===null||w===void 0?void 0:w.event;return G&&((N=s.ids)===null||N===void 0?void 0:N.includes(G))&&(C==="*"||C?.toLocaleLowerCase()===((R=s.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))}else{const G=($=(T=b?.filter)===null||T===void 0?void 0:T.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return G==="*"||G===((M=s?.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===h}).map(b=>{if(typeof _=="object"&&"ids"in _){const w=_.data,{schema:N,table:R,commit_timestamp:T,type:$,errors:M}=w;_=Object.assign(Object.assign({},{schema:N,table:R,commit_timestamp:T,eventType:$,new:{},old:{},errors:M}),this._getPayloadRecords(w))}b.callback(_,l)})}_isClosed(){return this.state===zt.closed}_isJoined(){return this.state===zt.joined}_isJoining(){return this.state===zt.joining}_isLeaving(){return this.state===zt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Mu.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(jn.close,{},a)}_onError(a){this._on(jn.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=zt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Vg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Vg(a.columns,a.old_record)),s}}const hu=()=>{},$l={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Yv=[1e3,2e3,5e3,1e4],Jv=1e4,Qv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Xv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=wu,this.transport=null,this.heartbeatIntervalMs=$l.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=hu,this.ref=0,this.reconnectTimer=null,this.vsn=Pg,this.logger=hu,this.conn=null,this.sendBuffer=[],this.serializer=new Hv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${Eu.websocket}`,this.httpEndpoint=Yp(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Dv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case gi.connecting:return pi.Connecting;case gi.open:return pi.Open;case gi.closing:return pi.Closing;default:return pi.Closed}}isConnected(){return this.connectionState()===pi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Mu(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,h=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(qv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},$l.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:h}=s,g=h?`(${h})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,h)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===gi.open||this.conn.readyState===gi.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(jn.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Qv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:Lv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(jn.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Fp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$l.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,h,g,p,m,v,x,_,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:wu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:$l.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(h=a?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:hu,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Pg,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Yv[w-1]||Jv),this.vsn){case Gp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,N)=>N(JSON.stringify(w))),this.decode=(x=a?.decode)!==null&&x!==void 0?x:((w,N)=>N(JSON.parse(w)));break;case Mv:this.encode=(_=a?.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class qu extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function xt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Zv extends qu{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Tu extends qu{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const Iu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Wv=()=>Response,Au=o=>{if(Array.isArray(o))return o.map(s=>Au(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=Au(l)}),a},eb=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},gu=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},tb=(o,a,s)=>Oe(void 0,void 0,void 0,function*(){const l=yield Wv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,h=u?.statusCode||d+"";a(new Zv(gu(u),d,h))}).catch(u=>{a(new Tu(gu(u),u))}):a(new Tu(gu(o),o))}),nb=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(eb(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function ys(o,a,s,l,u,d){return Oe(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,nb(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>tb(p,g,l))})})}function gs(o,a,s,l){return Oe(this,void 0,void 0,function*(){return ys(o,"GET",a,s,l)})}function kn(o,a,s,l,u){return Oe(this,void 0,void 0,function*(){return ys(o,"POST",a,l,u,s)})}function Nu(o,a,s,l,u){return Oe(this,void 0,void 0,function*(){return ys(o,"PUT",a,l,u,s)})}function ab(o,a,s,l){return Oe(this,void 0,void 0,function*(){return ys(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function Hu(o,a,s,l,u){return Oe(this,void 0,void 0,function*(){return ys(o,"DELETE",a,l,u,s)})}class ib{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return Oe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(xt(a))return{data:null,error:a};throw a}})}}var Jp;class rb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Jp]="BlobDownloadBuilder",this.promise=null}asStream(){return new ib(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Oe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(xt(a))return{data:null,error:a};throw a}})}}Jp=Symbol.toStringTag;const sb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class lb{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=Iu(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return Oe(this,void 0,void 0,function*(){try{let d;const h=Object.assign(Object.assign({},Kg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",h.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!h.duplex&&(h.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),x=yield(a=="PUT"?Nu:kn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:m,id:x.Id,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(xt(d))return{data:null,error:d};throw d}})}upload(a,s,l){return Oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return Oe(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),h=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${h}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:Kg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const x=yield Nu(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:x.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(xt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return Oe(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield kn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),h=new URL(this.url+d.url),g=h.searchParams.get("token");if(!g)throw new qu("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(xt(l))return{data:null,error:l};throw l}})}update(a,s,l){return Oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return Oe(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(xt(u))return{data:null,error:u};throw u}})}copy(a,s,l){return Oe(this,void 0,void 0,function*(){try{return{data:{path:(yield kn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(xt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return Oe(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield kn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const h=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${h}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(xt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return Oe(this,void 0,void 0,function*(){try{const u=yield kn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(xt(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),h=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>gs(this.fetch,`${this.url}/${u}/${g}${h}`,{headers:this.headers,noResolveJson:!0});return new rb(p,this.shouldThrowOnError)}info(a){return Oe(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield gs(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Au(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(xt(l))return{data:null,error:l};throw l}})}exists(a){return Oe(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield ab(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(xt(l)&&l instanceof Tu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Hu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}list(a,s,l){return Oe(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},sb),s),{prefix:a||""});return{data:yield kn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(xt(u))return{data:null,error:u};throw u}})}listV2(a,s){return Oe(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield kn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(xt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const Qp="2.81.1",Xp={"X-Client-Info":`storage-js/${Qp}`};class ob{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Xp),s),this.fetch=Iu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return Oe(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield gs(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}getBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield gs(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}createBucket(a){return Oe(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(xt(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return Oe(this,void 0,void 0,function*(){try{return{data:yield Nu(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(xt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Hu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class cb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Xp),s),this.fetch=Iu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}listBuckets(a){return Oe(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield gs(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Hu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(xt(s))return{data:null,error:s};throw s}})}}const $u={"X-Client-Info":`storage-js/${Qp}`,"Content-Type":"application/json"};class Zp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function dn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class pu extends Zp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ub extends Zp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Yg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Yg||(Yg={}));const Pu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),db=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Jg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),fb=(o,a,s)=>Oe(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(h=>{const g=h?.statusCode||h?.code||u+"";a(new pu(Jg(h),u,g))}).catch(()=>{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new pu(g,u,h))});else{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new pu(g,u,h))}}else a(new ub(Jg(o),o))}),hb=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(db(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function gb(o,a,s,l,u,d){return Oe(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,hb(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>h(p)).catch(p=>fb(p,g,l))})})}function fn(o,a,s,l,u){return Oe(this,void 0,void 0,function*(){return gb(o,"POST",a,l,u,s)})}class pb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$u),s),this.fetch=Pu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return Oe(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}getIndex(a,s){return Oe(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dn(l))return{data:null,error:l};throw l}})}listIndexes(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return Oe(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dn(l))return{data:null,error:l};throw l}})}}class mb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$u),s),this.fetch=Pu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return Oe(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield fn(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}getVectors(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}listVectors(a){return Oe(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield fn(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}queryVectors(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}deleteVectors(a){return Oe(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield fn(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}}class yb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$u),s),this.fetch=Pu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}getBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}listBuckets(){return Oe(this,arguments,void 0,function*(a={}){try{return{data:yield fn(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:(yield fn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dn(s))return{data:null,error:s};throw s}})}}class vb extends yb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new bb(this.url,this.headers,a,this.fetch)}}class bb extends pb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Oe(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Oe(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Oe(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Oe(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new xb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class xb extends mb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Oe(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Oe(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Oe(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Oe(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Oe(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class _b extends ob{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new lb(this.url,this.headers,a,this.fetch)}get vectors(){return new vb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new cb(this.url+"/iceberg",this.headers,this.fetch)}}const jb="2.81.1";let ds="";typeof Deno<"u"?ds="deno":typeof document<"u"?ds="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ds="react-native":ds="node";const Sb={"X-Client-Info":`supabase-js-${ds}/${jb}`},wb={headers:Sb},Eb={schema:"public"},Cb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Tb={},Ab=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Nb=()=>Headers,Rb=(o,a,s)=>{const l=Ab(s),u=Nb();return async(d,h)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(h?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},h),{headers:m}))}};function Ob(o){return o.endsWith("/")?o:o+"/"}function kb(o,a){var s,l;const{db:u,auth:d,realtime:h,global:g}=o,{db:p,auth:m,realtime:v,global:x}=a,_={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),h),storage:{},global:Object.assign(Object.assign(Object.assign({},x),g),{headers:Object.assign(Object.assign({},(s=x?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?_.accessToken=o.accessToken:delete _.accessToken,_}function zb(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ob(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Wp="2.81.1",dr=30*1e3,Ru=3,mu=Ru*dr,Ub="http://localhost:9999",Db="supabase.auth.token",Bb={"X-Client-Info":`gotrue-js/${Wp}`},Ou="X-Supabase-Api-Version",em={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Lb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Mb=600*1e3;class ps extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function ke(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class qb extends ps{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function Ib(o){return ke(o)&&o.name==="AuthApiError"}class mi extends ps{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class Ha extends ps{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class Rn extends Ha{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Hb(o){return ke(o)&&o.name==="AuthSessionMissingError"}class sr extends Ha{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pl extends Ha{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Vl extends Ha{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $b(o){return ke(o)&&o.name==="AuthImplicitGrantRedirectError"}class Qg extends Ha{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ku extends Ha{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function yu(o){return ke(o)&&o.name==="AuthRetryableFetchError"}class Xg extends Ha{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class zu extends Ha{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const Kl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zg=` 	
\r=`.split(""),Pb=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Zg.length;a+=1)o[Zg[a].charCodeAt(0)]=-2;for(let a=0;a<Kl.length;a+=1)o[Kl[a].charCodeAt(0)]=a;return o})();function Wg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Kl[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Kl[l]),a.queuedBits-=6}}function tm(o,a,s){const l=Pb[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function ep(o){const a=[],s=h=>{a.push(String.fromCodePoint(h))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=h=>{Fb(h,l,s)};for(let h=0;h<o.length;h+=1)tm(o.charCodeAt(h),u,d);return a.join("")}function Vb(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Gb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Vb(l,a)}}function Fb(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function hr(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)tm(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Kb(o){const a=[];return Gb(o,s=>a.push(s)),new Uint8Array(a)}function yi(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Wg(u,s,l)),Wg(null,s,l),a.join("")}function Yb(o){return Math.round(Date.now()/1e3)+o}function Jb(){return Symbol("auth-callback")}const qt=()=>typeof window<"u"&&typeof document<"u",ui={tested:!1,writable:!1},nm=()=>{if(!qt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ui.tested)return ui.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ui.tested=!0,ui.writable=!0}catch{ui.tested=!0,ui.writable=!1}return ui.writable};function Qb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const am=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Xb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",fr=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},di=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},qa=async(o,a)=>{await o.removeItem(a)};class Zl{constructor(){this.promise=new Zl.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Zl.promiseConstructor=Promise;function vu(o){const a=o.split(".");if(a.length!==3)throw new zu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!Lb.test(a[l]))throw new zu("JWT not in base64url format");return{header:JSON.parse(ep(a[0])),payload:JSON.parse(ep(a[1])),signature:hr(a[2]),raw:{header:a[0],payload:a[1]}}}async function Zb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Wb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const h=await o(d);if(!a(d,null,h)){l(h);return}}catch(h){if(!a(d,h)){u(h);return}}})()})}function e0(o){return("0"+o.toString(16)).substr(-2)}function t0(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,e0).join("")}async function n0(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function a0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await n0(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lr(o,a,s=!1){const l=t0();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await fr(o,`${a}-code-verifier`,u);const d=await a0(l);return[d,l===d?"plain":"s256"]}const i0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function r0(o){const a=o.headers.get(Ou);if(!a||!a.match(i0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function s0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function l0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const o0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function or(o){if(!o0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function bu(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function c0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function tp(o){return JSON.parse(JSON.stringify(o))}const hi=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),u0=[502,503,504];async function np(o){var a;if(!Xb(o))throw new ku(hi(o),0);if(u0.includes(o.status))throw new ku(hi(o),o.status);let s;try{s=await o.json()}catch(d){throw new mi(hi(d),d)}let l;const u=r0(o);if(u&&u.getTime()>=em["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Xg(hi(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new Rn}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,h)=>d&&typeof h=="string",!0))throw new Xg(hi(s),o.status,s.weak_password.reasons);throw new qb(hi(s),o.status||500,l)}const d0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Be(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[Ou]||(d[Ou]=em["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const h=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(h.redirect_to=l.redirectTo);const g=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await f0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function f0(o,a,s,l,u,d){const h=d0(a,l,u,d);let g;try{g=await o(s,Object.assign({},h))}catch(p){throw console.error(p),new ku(hi(p),0)}if(g.ok||await np(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await np(p)}}function On(o){var a;let s=null;p0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Yb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function ap(o){const a=On(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Ia(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function h0(o){return{data:o,error:null}}function g0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,h=pr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},h);return{data:{properties:g,user:p},error:null}}function ip(o){return o}function p0(o){return o.access_token&&o.refresh_token&&o.expires_in}const xu=["global","local","others"];class m0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=am(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=xu[0]){if(xu.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${xu.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(ke(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Ia})}catch(l){if(ke(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=pr(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:g0,redirectTo:s?.redirectTo})}catch(s){if(ke(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Ia})}catch(s){if(ke(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ip});if(v.error)throw v.error;const x=await v.json(),_=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(w.split(";")[1].split("=")[1]);m[`${R}Page`]=N}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(ke(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){or(a);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Ia})}catch(s){if(ke(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){or(a);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:Ia})}catch(l){if(ke(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){or(a);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:Ia})}catch(l){if(ke(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){or(a.userId);try{const{data:s,error:l}=await Be(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _deleteFactor(a){or(a.userId),or(a.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ip});if(v.error)throw v.error;const x=await v.json(),_=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(w.split(";")[1].split("=")[1]);m[`${R}Page`]=N}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(ke(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(ke(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ke(s))return{data:null,error:s};throw s}}}function rp(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const cr={debug:!!(globalThis&&nm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class im extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class y0 extends im{}async function v0(o,a,s){cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),cr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new y0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(cr.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function b0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function rm(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function x0(o){return parseInt(o,16)}function _0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function j0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:h,notBefore:g,requestId:p,resources:m,scheme:v,uri:x,version:_}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=rm(o.address),w=v?`${v}://${l}`:l,N=o.statement?`${o.statement}
`:"",R=`${w} wants you to sign in with your Ethereum account:
${b}

${N}`;let T=`URI: ${x}
Version: ${_}
Chain ID: ${s}${h?`
Nonce: ${h}`:""}
Issued At: ${d.toISOString()}`;if(u&&(T+=`
Expiration Time: ${u.toISOString()}`),g&&(T+=`
Not Before: ${g.toISOString()}`),p&&(T+=`
Request ID: ${p}`),m){let $=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);$+=`
- ${M}`}T+=$}return`${R}
${T}`}class Rt extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Yl extends Rt{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function S0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Rt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Rt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Rt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new Rt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Rt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Rt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Rt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Rt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const h=window.location.hostname;if(sm(h)){if(d.rp.id!==h)return new Rt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Rt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Rt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Rt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Rt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function w0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Rt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Rt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(sm(l)){if(s.rpId!==l)return new Rt({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Rt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Rt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Rt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class E0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const C0=new E0;function T0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=pr(o,["challenge","user","excludeCredentials"]),d=hr(a).buffer,h=Object.assign(Object.assign({},s),{id:hr(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:h});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:hr(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function A0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=pr(o,["challenge","allowCredentials"]),u=hr(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const g=s[h];d.allowCredentials[h]=Object.assign(Object.assign({},g),{id:hr(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function N0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:yi(new Uint8Array(o.response.attestationObject)),clientDataJSON:yi(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function R0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:yi(new Uint8Array(u.authenticatorData)),clientDataJSON:yi(new Uint8Array(u.clientDataJSON)),signature:yi(new Uint8Array(u.signature)),userHandle:u.userHandle?yi(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function sm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function sp(){var o,a;return!!(qt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function O0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Yl("Browser returned unexpected credential type",a)}:{data:null,error:new Yl("Empty credential response",a)}}catch(a){return{data:null,error:S0({error:a,options:o})}}}async function k0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Yl("Browser returned unexpected credential type",a)}:{data:null,error:new Yl("Empty credential response",a)}}catch(a){return{data:null,error:w0({error:a,options:o})}}}const z0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},U0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Jl(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const h=u[d];if(h!==void 0)if(Array.isArray(h))l[d]=h;else if(s(h))l[d]=h;else if(a(h)){const g=l[d];a(g)?l[d]=Jl(g,h):l[d]=Jl(h)}else l[d]=h}return l}function D0(o,a){return Jl(z0,o,a||{})}function B0(o,a){return Jl(U0,o,a||{})}class L0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:h,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!h)return{data:null,error:g};const p=u??C0.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=D0(h.webauthn.credential_options.publicKey,d?.create),{data:v,error:x}=await O0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}case"request":{const m=B0(h.webauthn.credential_options.publicKey,d?.request),{data:v,error:x}=await k0(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}}}catch(h){return ke(h)?{data:null,error:h}:{data:null,error:new mi("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new ps("rpId is required for WebAuthn authentication")};try{if(!sp())return{data:null,error:new mi("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!h)return{data:null,error:g};const{webauthn:p}=h;return this._verify({factorId:a,challengeId:h.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(h){return ke(h)?{data:null,error:h}:{data:null,error:new mi("Unexpected error in authenticate",h)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new ps("rpId is required for WebAuthn registration")};try{if(!sp())return{data:null,error:new mi("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this._enroll({friendlyName:a});if(!h)return await this.client.mfa.listFactors().then(v=>{var x;return(x=v.data)===null||x===void 0?void 0:x.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===a&&_.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:h.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(h){return ke(h)?{data:null,error:h}:{data:null,error:new mi("Unexpected error in register",h)}}}}b0();const M0={url:Ub,storageKey:Db,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Bb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function lp(o,a,s){return await s()}const ur={};class ms{get jwks(){var a,s;return(s=(a=ur[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){ur[this.storageKey]=Object.assign(Object.assign({},ur[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=ur[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){ur[this.storageKey]=Object.assign(Object.assign({},ur[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},M0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=ms.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,ms.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&qt()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new m0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=am(d.fetch),this.lock=d.lock||lp,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:qt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=v0:this.lock=lp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new L0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:nm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=rp(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=rp(this.memoryStorage)),qt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Wp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(qt()&&(s=Qb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),qt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),$b(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:h,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",h,"redirect type",g),await this._saveSession(h),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return ke(s)?this._returnResult({error:s}):this._returnResult({error:new mi("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:On}),{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(ke(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:x,options:_}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await lr(this.storage,this.storageKey)),d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_?.emailRedirectTo,body:{email:v,password:x,data:(s=_?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:_?.captchaToken},code_challenge:b,code_challenge_method:w},xform:On})}else if("phone"in a){const{phone:v,password:x,options:_}=a;d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(l=_?.data)!==null&&l!==void 0?l:{},channel:(u=_?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:_?.captchaToken}},xform:On})}else throw new Pl("You must provide either an email or phone number and a password");const{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(ke(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:h,options:g}=a;s=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ap})}else if("phone"in a){const{phone:d,password:h,options:g}=a;s=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ap})}else throw new Pl("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new sr;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,h,g,p,m,v,x,_;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:N,wallet:R,statement:T,options:$}=a;let M;if(qt())if(typeof R=="object")M=R;else{const ve=window;if("ethereum"in ve&&typeof ve.ethereum=="object"&&"request"in ve.ethereum&&typeof ve.ethereum.request=="function")M=ve.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!$?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=R}const G=new URL((s=$?.url)!==null&&s!==void 0?s:window.location.href),C=await M.request({method:"eth_requestAccounts"}).then(ve=>ve).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=rm(C[0]);let B=(l=$?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!B){const ve=await M.request({method:"eth_chainId"});B=x0(ve)}const P={domain:G.host,address:L,statement:T,uri:G.href,version:"1",chainId:B,nonce:(u=$?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(h=(d=$?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(g=$?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=$?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=$?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=$?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=j0(P),w=await M.request({method:"personal_sign",params:[_0(b),L]})}try{const{data:N,error:R}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(_=a.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:On});if(R)throw R;if(!N||!N.session||!N.user){const T=new sr;return this._returnResult({data:{user:null,session:null},error:T})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:R})}catch(N){if(ke(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async signInWithSolana(a){var s,l,u,d,h,g,p,m,v,x,_,b;let w,N;if("message"in a)w=a.message,N=a.signature;else{const{chain:R,wallet:T,statement:$,options:M}=a;let G;if(qt())if(typeof T=="object")G=T;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))G=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=T}const C=new URL((s=M?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in G&&G.signIn){const L=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M?.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),$?{statement:$}:null));let B;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")B=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)B=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in B&&"signature"in B&&(typeof B.signedMessage=="string"||B.signedMessage instanceof Uint8Array)&&B.signature instanceof Uint8Array)w=typeof B.signedMessage=="string"?B.signedMessage:new TextDecoder().decode(B.signedMessage),N=B.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${C.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...$?["",$,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(u=(l=M?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=M?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((h=M?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((g=M?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((p=M?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((x=(v=M?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",...M.signInWithSolana.resources.map(B=>`- ${B}`)]:[]].join(`
`);const L=await G.signMessage(new TextEncoder().encode(w),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=L}}try{const{data:R,error:T}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:yi(N)},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:On});if(T)throw T;if(!R||!R.session||!R.user){const $=new sr;return this._returnResult({data:{user:null,session:null},error:$})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:T})}catch(R){if(ke(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async _exchangeCodeForSession(a){const s=await di(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:h}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:On});if(await qa(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!d||!d.session||!d.user){const g=new sr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:h})}catch(d){if(ke(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:h}=a,g=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:h,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:On}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new sr;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,h;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await lr(this.storage,this.storageKey));const{error:x}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(h=p?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new Pl("You must provide either an email or phone number.")}catch(g){if(ke(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:h,error:g}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:On});if(g)throw g;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,m=h.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(ke(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,h;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await lr(this.storage,this.storageKey));const m=await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:h0});return!((d=m.data)===null||d===void 0)&&d.url&&qt()&&!(!((h=a.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(ke(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new Rn;const{error:u}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(ke(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:h}=await Be(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:h,error:g}=await Be(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:g})}throw new Pl("You must provide either an email or phone number and a type")}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await di(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<mu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const h=await di(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=bu()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};a.user=c0(a.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Ia}):await this._useSession(async s=>{var l,u,d;const{data:h,error:g}=s;if(g)throw g;return!(!((l=h.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Rn}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Ia})})}catch(s){if(ke(s))return Hb(s)&&(await this._removeSession(),await qa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new Rn;const h=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await lr(this.storage,this.storageKey));const{data:m,error:v}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:h.access_token,xform:Ia});if(v)throw v;return h.user=m.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(l){if(ke(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new Rn;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:h}=vu(a.access_token);if(h.exp&&(l=h.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(ke(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:h,error:g}=s;if(g)throw g;a=(l=h.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new Rn;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!qt())throw new Vl("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Vl(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Qg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vl("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Qg("No code detected.");const{data:$,error:M}=await this._exchangeCodeForSession(a.code);if(M)throw M;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:$.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:h,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!h||!m)throw new Vl("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(g);let _=v+x;p&&(_=parseInt(p));const b=_-v;b*1e3<=dr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const w=_-x;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,_,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,_,v);const{data:N,error:R}=await this._getUser(d);if(R)throw R;const T={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:x,expires_at:_,refresh_token:h,token_type:m,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:a.type},error:null})}catch(l){if(ke(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await di(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const h=(l=u.session)===null||l===void 0?void 0:l.access_token;if(h){const{error:g}=await this.admin.signOut(h,a);if(g&&!(Ib(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await qa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Jb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:h}=s;if(h)throw h;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await lr(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(ke(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var h,g,p,m,v;const{data:x,error:_}=d;if(_)throw _;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=x.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return qt()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(ke(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:h,provider:g,token:p,access_token:m,nonce:v}=a,x=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:On}),{data:_,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new sr}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:b}))}catch(u){if(ke(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)throw h;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Wb(async u=>(u>0&&await Zb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:On})),(u,d)=>{const h=200*Math.pow(2,u);return d&&yu(d)&&Date.now()+h-l<dr})}catch(l){if(this._debug(s,"error",l),ke(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),qt()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await di(this.storage,this.storageKey);if(u&&this.userStorage){let h=await di(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:u.user},await fr(this.userStorage,this.storageKey+"-user",h)),u.user=(a=h?.user)!==null&&a!==void 0?a:bu()}else if(u&&!u.user&&!u.user){const h=await di(this.storage,this.storageKey+"-user");h&&h?.user?(u.user=h.user,await qa(this.storage,this.storageKey+"-user"),await fr(this.storage,this.storageKey,u)):u.user=bu()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<mu;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${mu}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:h}=await this._callRefreshToken(u.refresh_token);h&&(console.error(h),yu(h)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:g}=await this._getUser(u.access_token);!g&&h?.user?(u.user=h.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(l,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new Rn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Zl;const{data:d,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!d.session)throw new Rn;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),ke(d)){const h={data:null,error:d};return yu(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(h),h}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],h=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(h),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await fr(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=tp(u);await fr(this.storage,this.storageKey,d)}else{const u=tp(s);await fr(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await qa(this.storage,this.storageKey),await qa(this.storage,this.storageKey+"-code-verifier"),await qa(this.storage,this.storageKey+"-user"),this.userStorage&&await qa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&qt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),dr);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/dr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${dr}ms, refresh threshold is ${Ru} ticks`),u<=Ru&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof im)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,h]=await lr(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(h)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Be(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)return this._returnResult({data:null,error:h});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?N0(a.webauthn.credential_response):R0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Be(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=await Be(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(h.error)return h;const{data:g}=h;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:T0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:A0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=vu(l.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Be(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new Rn})})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new Rn});const h=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&qt()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(ke(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new Rn});const h=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&qt()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(ke(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Mb>u)return l;const{data:d,error:h}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:h,raw:{header:g,payload:p}}=vu(l);s?.allowExpired||s0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:h},error:null}}const v=l0(u.alg),x=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,h,Kb(`${g}.${p}`)))throw new zu("Invalid JWT signature");return{data:{claims:d,header:u,signature:h},error:null}}catch(l){if(ke(l))return this._returnResult({data:null,error:l});throw l}}}ms.nextInstanceID={};const q0=ms;class I0 extends q0{constructor(a){super(a)}}class H0{constructor(a,s,l){var u,d,h;this.supabaseUrl=a,this.supabaseKey=s;const g=zb(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:Eb,realtime:Tb,auth:Object.assign(Object.assign({},Cb),{storageKey:p}),global:wb},v=kb(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(x,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,v.global.fetch),this.fetch=Rb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new Uv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new _b(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Rv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:h,flowType:g,lock:p,debug:m,throwOnError:v},x,_){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new I0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),x),storageKey:h,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Xv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const $0=(o,a,s)=>new H0(o,a,s);function P0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}P0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const V0="https://sqwqlvsjtimallidxrsz.supabase.co",G0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",ne=$0(V0,G0,{auth:{persistSession:!1}}),Sn=Object.freeze(Object.defineProperty({__proto__:null,default:ne,supabase:ne},Symbol.toStringTag,{value:"Module"}));async function Wl(){try{const{data:o,error:a}=await ne.from("empresa").select("*").limit(1).maybeSingle();if(a)throw a;const s=o||null;if(!s)return null;try{const l=s.logo;if(!l)s.logoUrl=null;else if(String(l).startsWith("http"))s.logoUrl=String(l);else{const u="logo";try{const h=(await ne.storage.from(u).getPublicUrl(String(l)))?.data?.publicUrl??null;if(h)s.logoUrl=h;else{const g=await ne.storage.from(u).createSignedUrl(String(l),3600);s.logoUrl=g?.data?.signedUrl??null}}catch{const h="https://sqwqlvsjtimallidxrsz.supabase.co";let g=String(l);g.startsWith(`${u}/`)&&(g=g.slice(u.length+1)),s.logoUrl=`${h}/storage/v1/object/public/${u}/${encodeURIComponent(g)}`}}}catch{s.logoUrl=null}return s}catch(o){return console.warn("getCompanyData error",o),null}}function F0({onLogin:o}){const[a,s]=j.useState(""),[l,u]=j.useState(""),[d,h]=j.useState(null);async function g(p){p.preventDefault(),h(null);try{const{data:m,error:v}=await ne.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){h("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){h("Credenciales invlidas");return}const x=m;if(x.password===l){const _={id:x.id,username:x.username,role:x.role};localStorage.setItem("user",JSON.stringify(_));try{console.debug("Login: stored localStorage.user =",_)}catch{}try{if(x.role==="cajero"){const{data:b,error:w}=await ne.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",x.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}h("Inicio de sesin correcto"),typeof o=="function"&&o()}else h("Credenciales invlidas")}catch(m){h(m.message||"Error al consultar la base de datos")}}return i.jsx("div",{className:"login-root",children:i.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[i.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),i.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),i.jsxs("div",{className:"login-inner",children:[i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"username",children:"Usuario"}),i.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"password",children:"Contrasea"}),i.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),i.jsx("div",{children:i.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&i.jsx("p",{style:{marginTop:12},children:d}),i.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",i.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function K0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),i.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function Y0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!0),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,_]=j.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=j.useState(()=>{try{const T=localStorage.getItem("user");if(T)return JSON.parse(T).username||"usuario"}catch{}return"usuario"});j.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(T=>T.json()).then(T=>{const $=T&&Array.isArray(T.ingresos)?T.ingresos:[],M=localStorage.getItem("ingresosEfectivo");let G=[];try{M&&(G=JSON.parse(M))}catch{}const C=[...$,...G];s(C)}).catch(()=>{const T=localStorage.getItem("ingresosEfectivo");try{T&&s(JSON.parse(T))}catch{s([])}}).finally(()=>u(!1))},[]);function N(T){localStorage.setItem("ingresosEfectivo",JSON.stringify(T))}function R(T){if(T.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const $=a.length?Math.max(...a.map(C=>C.id))+1:1,M={id:$,factura:d||`F-${$}`,motivo:g,monto:Number(m),fechaHora:new Date(x).toISOString(),usuario:b},G=[...a,M];s(G),N(G),h(""),p(""),v(""),_(new Date().toISOString().slice(0,16))}return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?i.jsx("p",{children:"Cargando..."}):i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),i.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),i.jsx("tbody",{children:a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(T=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:{padding:8},children:T.factura}),i.jsx("td",{style:{padding:8},children:T.motivo}),i.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",T.monto.toFixed(2)]}),i.jsx("td",{style:{padding:8},children:new Date(T.fechaHora).toLocaleString()}),i.jsx("td",{style:{padding:8},children:T.usuario})]},T.id))})]})})]}),i.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),i.jsxs("form",{onSubmit:R,style:{display:"grid",gap:8},children:[i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",i.jsx("input",{value:d,onChange:T=>h(T.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",i.jsx("input",{value:g,onChange:T=>p(T.target.value),className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",i.jsx("input",{value:m,onChange:T=>v(T.target.value===""?"":Number(T.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",i.jsx("input",{value:x,onChange:T=>_(T.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",i.jsx("input",{value:b,onChange:T=>w(T.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[i.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),i.jsx("button",{type:"button",onClick:()=>{h(""),p(""),v(""),_(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function J0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!1),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(!1),[x,_]=j.useState(!1),[b,w]=j.useState(null),N=async()=>{u(!0);try{const{data:J,error:oe}=await ne.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(oe)throw oe;const je=Array.isArray(J)?J:[],I=Array.from(new Set(je.map(E=>E.cliente_id).filter(Boolean)));let ee={};if(I.length>0)try{const{data:E}=await ne.from("clientes").select("id,nombre").in("id",I);if(Array.isArray(E))for(const U of E)ee[String(U.id)]=U.nombre||""}catch(E){console.warn("Error cargando nombres de clientes:",E)}const X=je.map(E=>({...E,cliente_nombre:ee[String(E.cliente_id)]||null}));s(X)}catch(J){console.warn("Error cargando cotizaciones:",J),s([])}u(!1)};j.useEffect(()=>{N()},[]);const[R,T]=j.useState(null),[$,M]=j.useState(null),[G,C]=j.useState(""),L=async J=>{h(J);try{const{data:oe,error:je}=await ne.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",J).maybeSingle();if(je&&console.warn("Error cargando cabecera de cotizacion",je),T(oe||null),oe&&oe.cliente_id)try{const{data:X}=await ne.from("clientes").select("id,nombre").eq("id",oe.cliente_id).maybeSingle();M(X?.nombre||null)}catch{M(null)}else M(null);const{data:I,error:ee}=await ne.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J);if(ee)throw ee;p(Array.isArray(I)?I:[]),v(!0)}catch(oe){console.warn("Error cargando detalles de cotizacion",oe),p([])}},B=async J=>{try{const{data:oe,error:je}=await ne.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J.id),I=Array.isArray(oe)?oe:[],ee={header:J,detalles:I};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(ee))}catch(X){console.warn("No se pudo escribir localStorage",X)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:ee}))}catch{}o()}catch(oe){console.warn("Error cargando detalles para editar",oe)}},P=async J=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:oe}=await ne.from("cotizaciones_detalle").delete().eq("cotizacion_id",J);oe&&console.warn("Error eliminando detalles:",oe);const{error:je}=await ne.from("cotizaciones").delete().eq("id",J);if(je)throw je;N()}catch(oe){console.warn("Error eliminando cotizacion:",oe)}},ve=async()=>{if(b)try{const J={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:oe}=await ne.from("cotizaciones").update(J).eq("id",b.id);if(oe&&console.warn("Error actualizando cotizacion:",oe),b.id){const{error:je}=await ne.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);je&&console.warn("Error borrando detalles antiguos:",je);const I=g.map(X=>({...X,cotizacion_id:b.id})),{error:ee}=await ne.from("cotizaciones_detalle").insert(I);ee&&console.warn("Error insertando detalles actualizados:",ee)}_(!1),N()}catch(J){console.warn("Error guardando cotizacion editada:",J)}};return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),i.jsxs("div",{children:[i.jsx("button",{onClick:N,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),i.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),i.jsx("input",{placeholder:"Nmero o cliente",value:G,onChange:J=>C(J.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),i.jsx("button",{onClick:()=>C(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?i.jsx("div",{children:"Cargando..."}):a.length===0?i.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Nmero"}),i.jsx("th",{style:{padding:8},children:"Fecha"}),i.jsx("th",{style:{padding:8},children:"Usuario"}),i.jsx("th",{style:{padding:8},children:"Cliente ID"}),i.jsx("th",{style:{padding:8},children:"Total"}),i.jsx("th",{style:{padding:8},children:"Estado"}),i.jsx("th",{style:{padding:8},children:"Acciones"})]})}),i.jsx("tbody",{children:a.filter(J=>{if(!G)return!0;const oe=G.toLowerCase(),je=(J.numero_cotizacion||"").toLowerCase(),I=(J.cliente_nombre||"")?.toLowerCase(),ee=(J.usuario||"").toLowerCase();return je.includes(oe)||I.includes(oe)||ee.includes(oe)}).map(J=>i.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[i.jsx("td",{style:{padding:8},children:J.numero_cotizacion||""}),i.jsx("td",{style:{padding:8},children:J.fecha_cotizacion?new Date(J.fecha_cotizacion).toLocaleString():""}),i.jsx("td",{style:{padding:8},children:J.usuario||""}),i.jsx("td",{style:{padding:8},children:J.cliente_nombre||(J.cliente_id?String(J.cliente_id):"")}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||0).toFixed(2)]}),i.jsx("td",{style:{padding:8},children:J.estado||""}),i.jsxs("td",{style:{padding:8},children:[i.jsx("button",{onClick:()=>L(J.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(J.estado||"").toLowerCase()==="aceptada"?i.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):i.jsx("button",{onClick:()=>B(J),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),i.jsx("button",{onClick:()=>P(J.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},J.id))})]})]}),m&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),i.jsx("button",{onClick:()=>{v(!1),p([]),h(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[R&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[i.jsxs("div",{children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Nmero:"})," ",R.numero_cotizacion]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Fecha:"})," ",R.fecha_cotizacion?new Date(R.fecha_cotizacion).toLocaleString():""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Usuario:"})," ",R.usuario]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Cliente:"})," ",$??(R.cliente_id?String(R.cliente_id):"C/F")]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Subtotal:"})," L ",Number(R.subtotal||0).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Impuesto:"})," L ",Number(R.impuesto||0).toFixed(2)]}),i.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[i.jsx("strong",{children:"Total:"})," L ",Number(R.total||0).toFixed(2)]})]})]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Descripcin"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio U."}),i.jsx("th",{style:{padding:8},children:"Subtotal"}),i.jsx("th",{style:{padding:8},children:"Descuento"}),i.jsx("th",{style:{padding:8},children:"Total"})]})}),i.jsx("tbody",{children:g.map((J,oe)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:J.descripcion}),i.jsx("td",{style:{padding:8},children:J.cantidad}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.precio_unitario||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.subtotal||(J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.descuento||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||(J.subtotal||0)-(J.descuento||0)).toFixed(2)]})]},oe))})]})]})]})}),x&&b&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),i.jsx("button",{onClick:()=>{_(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{children:"Cliente"}),i.jsx("input",{value:b.cliente||"",onChange:J=>w({...b,cliente:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),i.jsxs("div",{children:[i.jsx("label",{children:"RTN"}),i.jsx("input",{value:b.rtn||"",onChange:J=>w({...b,rtn:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"SKU"}),i.jsx("th",{style:{padding:8},children:"Nombre"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio"}),i.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),i.jsx("tbody",{children:g.map((J,oe)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:J.sku}),i.jsx("td",{style:{padding:8},children:J.nombre}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:J.cantidad||0,onChange:je=>{const I=Number(je.target.value||0),ee=[...g];ee[oe]={...ee[oe],cantidad:I},p(ee)},style:{width:80,padding:6}})}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:J.precio_unitario||0,onChange:je=>{const I=Number(je.target.value||0),ee=[...g];ee[oe]={...ee[oe],precio_unitario:I},p(ee)},style:{width:120,padding:6}})}),i.jsxs("td",{style:{padding:8},children:["L ",Number((J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]})]},oe))})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:()=>{_(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:ve,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function Q0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),i.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function X0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function Z0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function oa({children:o,style:a,className:s}){const[l,u]=j.useState(!1);j.useEffect(()=>{const h=setTimeout(()=>u(!0),10);return()=>clearTimeout(h)},[]);const d={transform:l?"scale(1)":"scale(0.94)",opacity:l?1:0,transition:"transform 180ms cubic-bezier(.2,.9,.2,1), opacity 160ms ease",transformOrigin:"center center"};return i.jsx("div",{className:s,style:{...d,...a},children:o})}function W0({open:o,onClose:a,onSelect:s}){const[l,u]=j.useState(""),[d,h]=j.useState(!1),[g,p]=j.useState([]);return j.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{h(!0);try{const{data:v,error:x}=await ne.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(x)throw x;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&h(!1)}})(),()=>{m=!1}},[o]),j.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{h(!0);try{const v=String(l||"").trim();let x;if(v===""?x=await ne.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):x=await ne.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),x.error)throw x.error;p(Array.isArray(x.data)?x.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{h(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:i.jsx(oa,{children:i.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),i.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),i.jsx("th",{style:{padding:8}})]})}),i.jsxs("tbody",{children:[g.map(m=>i.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[i.jsx("td",{style:{padding:8},children:m.rtn}),i.jsx("td",{style:{padding:8},children:m.nombre}),i.jsx("td",{style:{padding:8},children:m.telefono}),i.jsx("td",{style:{padding:8},children:m.correo_electronico}),i.jsx("td",{style:{padding:8},children:i.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})})}):null}function ex({open:o,onClose:a,totalDue:s,onConfirm:l,exchangeRate:u}){const[d,h]=j.useState([]),[g,p]=j.useState("efectivo"),[m,v]=j.useState(0),[x,_]=j.useState(""),[b,w]=j.useState(""),[N,R]=j.useState(""),[T,$]=j.useState(""),[M,G]=j.useState(""),[C,L]=j.useState(0),[B,P]=j.useState(null),[ve,J]=j.useState(!1);j.useEffect(()=>{o||(h([]),p("efectivo"),v(0),_(""),w(""),R(""),$(""),G(""),P(null),J(!1))},[o]);const oe=O=>{const F=Number(O);return Number.isFinite(F)?Number(F.toFixed(2)):0},je=()=>{const O=oe(m);if(O<=0)return;const F={id:String(Date.now())+Math.random().toString(36).slice(2,7),tipo:g,monto:O,usd_monto:g==="dolares"?Number((C||0).toFixed(2)):void 0,banco:x||void 0,tarjeta:b||void 0,factura:N||void 0,autorizador:T||void 0,referencia:M||void 0};h(se=>[...se,F]),v(0),_(""),w(""),R(""),$(""),G("")},I=O=>{h(F=>F.filter(se=>se.id!==O))},ee=d.filter(O=>O.tipo==="efectivo").reduce((O,F)=>O+F.monto,0),X=d.filter(O=>O.tipo==="tarjeta").reduce((O,F)=>O+F.monto,0),E=d.filter(O=>O.tipo==="transferencia").reduce((O,F)=>O+F.monto,0),U=d.filter(O=>O.tipo==="dolares").reduce((O,F)=>O+F.monto,0),Z=Number((ee+X+E+U).toFixed(2)),ge=Number((s-Z).toFixed(2)),_e=Z>=s&&Z>0,A=O=>new Intl.NumberFormat("es-HN",{style:"currency",currency:"HNL"}).format(O).replace("HNL","L"),D=()=>{(async()=>{const O=[];ee>0&&O.push(`efectivo:(${ee.toFixed(2)})`),X>0&&O.push(`tarjeta:(${X.toFixed(2)})`),E>0&&O.push(`transferencia:(${E.toFixed(2)})`);const F=O.join(",");try{J(!0),await new Promise(se=>setTimeout(se,1500)),await l({efectivo:ee,tarjeta:X,transferencia:E,totalPaid:Z,tipoPagoString:F,pagos:d})}catch(se){console.warn("Error en handleConfirm:",se)}finally{try{J(!1)}catch{}try{a()}catch{}}})()};return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:i.jsx(oa,{children:i.jsxs("div",{style:{width:1100,maxWidth:"99%",background:"white",borderRadius:10,padding:16,maxHeight:"94vh",overflow:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:10,display:"grid",gridTemplateColumns:"1fr 420px",gap:14,fontSize:13},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",i.jsx("strong",{children:A(s)})]}),i.jsx("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:6,marginBottom:12,fontSize:13},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #efefef"},children:[i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Monto"}),i.jsx("th",{children:"Detalles"}),i.jsx("th",{})]})}),i.jsxs("tbody",{children:[d.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,style:{padding:12,color:"#666"},children:"No hay pagos registrados"})}),d.map(O=>i.jsxs("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[i.jsx("td",{style:{padding:"6px 4px"},children:O.tipo}),i.jsx("td",{style:{padding:"6px 4px"},children:A(O.monto)}),i.jsxs("td",{style:{padding:"6px 4px",fontSize:12},children:[O.tipo==="efectivo"&&i.jsx("span",{children:""}),O.tipo==="tarjeta"&&i.jsxs("span",{children:[O.banco||"-"," / ",O.tarjeta||"-"," / ",O.factura||"-"]}),O.tipo==="transferencia"&&i.jsxs("span",{children:[O.banco||"-"," / ",O.referencia||"-"]})]}),i.jsx("td",{style:{padding:"8px 4px",textAlign:"right"},children:i.jsx("button",{onClick:()=>P(O.id),className:"btn-opaque","aria-label":"Eliminar pago",title:"Eliminar pago",style:{background:"transparent",border:"none",padding:6,cursor:"pointer",color:"#ef4444"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",focusable:"false",children:[i.jsx("polyline",{points:"3 6 5 6 21 6"}),i.jsx("path",{d:"M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"}),i.jsx("path",{d:"M10 11v6"}),i.jsx("path",{d:"M14 11v6"}),i.jsx("path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"})]})})})]},O.id))]})]})}),i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:8,fontSize:13},children:[i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Efectivo"}),i.jsx("div",{style:{fontWeight:600},children:A(ee)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Tarjeta"}),i.jsx("div",{style:{fontWeight:600},children:A(X)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Transferencia"}),i.jsx("div",{style:{fontWeight:600},children:A(E)})]}),i.jsxs("div",{style:{marginLeft:"auto",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Total ingresado"}),i.jsx("div",{style:{fontWeight:700},children:A(Z)}),i.jsx("div",{style:{marginTop:6,color:ge>0?"#ef4444":"#16a34a"},children:ge>0?`Falta ${A(ge)}`:`Cambio ${A(Math.abs(ge))}`})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:10,fontSize:13},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de pago"}),i.jsxs("select",{value:g,onChange:O=>{p(O.target.value),v(0),L(0),_(""),w(""),R(""),$(""),G("")},style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"efectivo",children:"Efectivo"}),i.jsx("option",{value:"tarjeta",children:"Tarjeta"}),i.jsx("option",{value:"transferencia",children:"Transferencia"}),i.jsx("option",{value:"dolares",children:"Dlares"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Monto"}),g==="dolares"?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"$"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:C,onChange:O=>{const F=oe(O.target.value);L(F);const se=Number((F*u).toFixed(2));v(se)},style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"L (convertido)"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:m,readOnly:!0,style:{width:"100%",padding:6,borderRadius:6,fontSize:13,background:"#f9fafb"}})]})]}):i.jsx("input",{type:"number",min:0,step:"0.01",value:m,onChange:O=>v(oe(O.target.value)),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),g==="dolares"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de cambio (Lps por $)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("div",{style:{fontSize:14,fontWeight:600},children:[u.toFixed(2)," L"]}),i.jsx("div",{style:{fontSize:13,color:"#666"},children:"(Editable en el encabezado de Punto de Ventas)"})]})]}),g==="efectivo"&&i.jsx("div",{style:{fontSize:13,color:"#444",marginBottom:8},children:'Pago en efectivo: solo indique el monto y presione "Agregar".'}),g==="tarjeta"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:O=>_(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras "}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente "}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas "}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda "}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores "}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tarjeta (ltimos 4)"}),i.jsx("input",{value:b,onChange:O=>w(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Factura"}),i.jsx("input",{value:N,onChange:O=>R(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Autorizador"}),i.jsx("input",{value:T,onChange:O=>$(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]})]}),g==="transferencia"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:O=>_(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras  (Banco de Amrica Central Honduras)"}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente  Banocc"}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas  (Banco del Pas)"}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda  Davi"}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores  BanTrab"}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Referencia"}),i.jsx("input",{value:M,onChange:O=>G(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:10},children:[i.jsx("button",{onClick:je,className:"btn-opaque",style:{background:"#0ea5a4",color:"white",padding:"6px 10px",borderRadius:6,fontSize:13},children:"Agregar"}),i.jsx("button",{onClick:()=>{v(s-Z)},className:"btn-opaque",style:{background:"transparent",fontSize:13},children:"Exacto"})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",fontSize:13,padding:"6px 10px"},children:"Cancelar"}),i.jsx("button",{onClick:D,className:"btn-opaque",disabled:!_e,style:{background:_e?"#16a34a":"gray",color:"white",fontSize:13,padding:"6px 12px"},children:"Registrar y guardar venta"})]}),B&&i.jsx("div",{role:"dialog","aria-modal":"true",onClick:()=>P(null),style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3},children:i.jsxs("div",{onClick:O=>O.stopPropagation(),style:{width:360,background:"white",borderRadius:8,padding:14,boxShadow:"0 10px 30px rgba(0,0,0,0.15)",position:"relative"},children:[i.jsx("button",{"aria-label":"Cerrar",title:"Cerrar",onClick:()=>P(null),style:{position:"absolute",right:8,top:8,background:"transparent",border:"none",padding:6,cursor:"pointer",color:"#666"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),i.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Confirmar eliminacin"}),i.jsx("div",{style:{marginBottom:12},children:"Eliminar este pago? Esta accin no se puede deshacer."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{onClick:()=>P(null),className:"btn-opaque",style:{background:"transparent",padding:"6px 10px"},children:"Cancelar"}),i.jsx("button",{onClick:()=>{B&&(I(B),P(null))},className:"btn-opaque",style:{background:"#ef4444",color:"white",padding:"6px 10px"},children:"Eliminar"})]})]})}),ve&&i.jsx("div",{role:"status","aria-live":"polite",style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:12500,background:"rgba(2,6,23,0.6)"},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.98)",padding:18,borderRadius:10,display:"flex",flexDirection:"column",alignItems:"center",gap:12,boxShadow:"0 10px 30px rgba(0,0,0,0.25)"},children:[i.jsx("svg",{width:"56",height:"56",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:i.jsxs("g",{transform:"translate(0,0)",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#e6edf3",strokeWidth:"3",fill:"none"}),i.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"#0ea5a4",strokeWidth:"3",strokeLinecap:"round",children:i.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 12 12",to:"360 12 12",dur:"1s",repeatCount:"indefinite"})})]})}),i.jsx("div",{style:{fontSize:15,fontWeight:700},children:"Generando factura"})]})})]})})}):null}function tx({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:h}){return i.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:i.jsxs("tr",{children:[i.jsx("th",{style:u}),i.jsx("th",{style:u,children:"Imagen"}),i.jsx("th",{style:u,children:"SKU"}),i.jsx("th",{style:u,children:"Nombre"}),i.jsx("th",{style:u,children:"Categora"}),i.jsx("th",{style:u,children:"Precio"}),i.jsx("th",{style:u,children:"Stock"}),i.jsx("th",{style:u,children:"Accin"})]})}),i.jsx("tbody",{children:o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:d,children:i.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),i.jsx("td",{style:d,children:a[String(g.id)]?i.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?i.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),i.jsx("td",{style:d,children:i.jsx("code",{style:h,children:g.sku})}),i.jsx("td",{style:d,children:i.jsx("strong",{children:g.nombre})}),i.jsx("td",{style:d,children:i.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),i.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return i.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,x=v?p<1?"Agotado":"Sin precio":"Agregar";return i.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:x})})()})]},g.id))})]})})}function nx({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:h,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:x}){return i.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&i.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&i.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[i.jsx("span",{children:"TOTAL:"}),i.jsxs("span",{children:["L",m.toFixed(2)]})]})," ",i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["L",u.toFixed(2)]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[i.jsxs("div",{children:["ISV (",h*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.isv||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto 18%: ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.imp18||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto turstico (",p*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.tur||0),0)).toFixed(2)]})]})]})}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:i.jsxs("details",{style:{marginTop:6},children:[i.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),i.jsx("div",{style:{marginTop:8},children:d.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[i.jsxs("div",{style:{color:"#0f172a"},children:[_.nombre,"  L",_.price.toFixed(2)]}),i.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",_.isv.toFixed(2),"  18%: L",_.imp18.toFixed(2),"  Tur: L",_.tur.toFixed(2)]})]},String(_.id)))})]})}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[i.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),i.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?i.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):i.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",_.producto.sku,"] ",_.producto.nombre]}),i.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(_.producto.precio||0).toFixed(2)," c/u"]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("button",{onClick:()=>a(_.producto.id,-1),style:x,children:""}),i.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:_.cantidad}),i.jsx("button",{onClick:()=>a(_.producto.id,1),style:x,children:"+"}),i.jsx("button",{onClick:()=>s(_.producto.id),style:{...x,background:"#ef4444"},children:""})]})]},_.producto.id))})]})}function ax({userName:o,userRole:a,userId:s,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:h,onPrintFormatChange:g,onOpenCajaConfig:p,printFormat:m}){const[v,x]=j.useState(!1),[_,b]=j.useState(!1),w=j.useRef(null),[N,R]=j.useState(null),[T,$]=j.useState(null);return j.useEffect(()=>{function M(G){w.current&&!w.current.contains(G.target)&&x(!1)}return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]),j.useEffect(()=>{let M=!0;return(async()=>{try{const G=await Wl();if(!M||!G)return;const C=G.nombre||G.comercio||G.name||null,L=G.logoUrl||G.logo||null;C&&R(String(C)),L&&$(String(L))}catch{}})(),()=>{M=!1}},[]),i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        .pv-zoom-modal { animation: pv-zoom-in 220ms ease-out both; transform-origin: center; }
        @keyframes pv-zoom-in {
          from { opacity: 0; transform: scale(0.96) translateY(-6px); }
          to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .pv-backdrop { background: rgba(2,6,23,0.6); }
        .pv-logout-title { font-size: 1.05rem; font-weight: 800; }
        .pv-logout-body { color: #334155; margin-top: 6px; margin-bottom: 10px; }
      `}),i.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[T?i.jsx("img",{src:T,alt:"logo",style:{width:40,height:40,objectFit:"contain",borderRadius:6}}):null,i.jsx("div",{style:{margin:0,fontSize:"1.05rem",fontWeight:700},children:N||"Punto de Ventas"})]}),i.jsx("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:i.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""})}),i.jsxs("div",{style:{position:"relative"},ref:w,children:[i.jsx("button",{onClick:()=>x(M=>!M),"aria-expanded":v,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),v&&i.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[i.jsx("button",{onClick:()=>{x(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),i.jsx("button",{onClick:()=>{x(!1),p&&p()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Configuracin de caja"}),i.jsx("button",{onClick:()=>{x(!1),h("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),i.jsx("button",{onClick:()=>{x(!1),h("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),i.jsx("button",{onClick:()=>{x(!1),h("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),i.jsx("button",{onClick:()=>{x(!1),h("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),i.jsx("button",{onClick:()=>{x(!1),h("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),i.jsx("button",{onClick:()=>{x(!1),h("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"}),i.jsx("button",{onClick:()=>{x(!1),b(!0)},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"})]}),_&&i.jsx("div",{role:"dialog","aria-modal":"true",className:"pv-backdrop",style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3},onClick:()=>b(!1),children:i.jsxs("div",{onClick:M=>M.stopPropagation(),className:"pv-zoom-modal",style:{width:380,background:"white",borderRadius:10,padding:18,boxShadow:"0 18px 40px rgba(2,6,23,0.35)"},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsxs("div",{children:[i.jsx("div",{className:"pv-logout-title",children:"Confirmar cierre de sesin"}),i.jsx("div",{className:"pv-logout-body",children:" Deseas continuar?"})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:()=>b(!1),className:"btn-opaque",style:{background:"transparent",padding:"8px 12px",borderRadius:8},children:"Cancelar"}),i.jsx("button",{onClick:()=>{b(!1);try{d()}catch{}},className:"btn-opaque",style:{background:"#ef4444",color:"white",padding:"8px 12px",borderRadius:8},children:"Cerrar sesin"})]})]})})]})]})]})}function ix({open:o,onClose:a,printFormat:s,onPrintFormatChange:l,exchangeRate:u,onExchangeRateChange:d}){const[h,g]=j.useState(u||0),[p,m]=j.useState(s||"carta");if(j.useEffect(()=>{g(u||0)},[u,o]),j.useEffect(()=>{m(s||"carta")},[s,o]),!o)return null;const v=()=>{try{l(p)}catch{}try{d(Number((h||0).toFixed(2)))}catch{}a()};return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3},children:i.jsx(oa,{children:i.jsxs("div",{style:{width:420,background:"white",borderRadius:10,padding:16,boxShadow:"0 8px 30px rgba(0,0,0,0.2)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h4",{style:{margin:0},children:"Configuracin de caja"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cerrar"})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{style:{display:"block",marginBottom:8},children:"Impresin"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("button",{onClick:()=>m("carta"),className:"btn-opaque",style:{padding:"6px 10px",background:p==="carta"?"#0ea5e9":"transparent",color:p==="carta"?"white":"#0b1724"},children:"Carta"}),i.jsx("button",{onClick:()=>m("cinta"),className:"btn-opaque",style:{padding:"6px 10px",background:p==="cinta"?"#0ea5e9":"transparent",color:p==="cinta"?"white":"#0b1724"},children:"Cinta"})]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{style:{display:"block",marginBottom:8},children:"Tipo de cambio Lps / $"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:h,onChange:x=>g(Number(x.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:v,className:"btn-opaque",style:{background:"#16a34a",color:"white"},children:"Guardar"})]})]})})})}function rx({open:o,onClose:a,width:s=520,children:l,zIndex:u=9999}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:i.jsx(oa,{children:i.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:s,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})})}):null}function sx({open:o,onClose:a,caiInfo:s,onRefresh:l}){const[u,d]=Ql.useState(!1);return i.jsx(rx,{open:o,onClose:a,width:520,children:i.jsxs("div",{children:[i.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),i.jsxs("div",{style:{color:"#475569",marginTop:8},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"CAI:"})," ",s?.cai??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Identificador:"})," ",s?.identificador??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango desde:"})," ",s?.rango_de??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango hasta:"})," ",s?.rango_hasta??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Fecha lmite emisin:"})," ",s?.fecha_vencimiento??s?.fecha_limite_emision??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Secuencia actual:"})," ",s?.secuencia_actual??"-"]})]}),i.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),i.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(h){console.debug("Error calling onRefresh from DatosFacturaModal:",h)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function lx({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(oa,{children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),i.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?i.jsx("div",{children:i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?i.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):i.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),i.jsxs("div",{style:{flex:1},children:[i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"SKU:"})," ",a.sku]}),i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),i.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),i.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:i.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):i.jsx("div",{children:i.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})})}):null}function ox({open:o,onClose:a,onCancel:s,onSave:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(oa,{children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),i.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})})}):null}function cx({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:h,taxRate:g,taxableSubtotal:p}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(oa,{children:i.jsx("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[i.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Consumidor final"})]}),i.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar datos del cliente"})]}),i.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Razn social / RTN"})]})]})]})})})}):null}function ux({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:h,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:x,onTelefonoChange:_,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:N,onCancel:R,onOpenCreateCliente:T,onOpenPayment:$,paymentDone:M,submitClienteNormal:G}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(oa,{children:i.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{value:l,onChange:C=>v(C.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&i.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),i.jsx("input",{value:u,onChange:C=>x(C.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx(W0,{open:p,onClose:()=>m(!1),onSelect:C=>{try{if(C&&typeof C=="object"){const L=C.rtn||"",B=C.nombre||"",P=C.telefono||"",ve=C.correo_electronico||"",J=!!C.exonerado;try{v(String(L||""))}catch{}try{x(String(B||""))}catch{}try{_(String(P||""))}catch{}try{b(String(ve||""))}catch{}try{w(!!J)}catch{}}}catch{}m(!1)}}),i.jsx("button",{onClick:R,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:T,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),M?i.jsx("button",{onClick:G,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):i.jsx("button",{onClick:$,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})})}):null}function dx({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:h,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:x,onCreate:_}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(oa,{children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",i.jsx("strong",{children:"juridico"}),"."]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),i.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),i.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),i.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),i.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{id:"exon",type:"checkbox",checked:h,onChange:b=>x(b.target.checked)}),i.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:async()=>{await _()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})})}):null}async function op(o={},a="factura",s={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const k=await Wl();k&&(l=l||k.nombre||k.comercio||l,u=u||k.rtn||u,d=d||k.direccion||k.direccion_fiscal||d,h=h||k.telefono||k.telefono_fijo||h,g=g||k.email||k.correo||g,p=p||k.logoUrl||k.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const k=await fetch(String(p),{mode:"cors"});if(k.ok){const te=await k.blob(),pe=await new Promise(Se=>{const Re=new FileReader;Re.onloadend=()=>{Se(typeof Re.result=="string"?Re.result:null)},Re.onerror=()=>{Se(null)},Re.readAsDataURL(te)});pe&&(p=pe)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let k=o.caiInfo||null;if(!k&&typeof window<"u"){const te=window.localStorage.getItem("caiInfo");if(te)try{k=JSON.parse(te)}catch{k=null}}if(k&&(v=v||k.cai||k.CAI||"",x=x||k.fecha_vencimiento||k.fecha_limite_emision||"",_=_||k.rango_de||k.rangoDesde||"",b=b||k.rango_hasta||k.rangoHasta||"",w=w||k.identificador||"",!m))try{const te=k.identificador?String(k.identificador):"",pe=k.secuencia_actual!=null?String(k.secuencia_actual):k.rango_de!=null?String(k.rango_de):"",Se=String(pe).replace(/[^0-9]/g,"")||"";let Re=0;(k.rango_hasta||k.rango_de)&&(Re=Math.max(String(k.rango_hasta||k.rango_de).length,Se.length));const De=Se?String(Se).padStart(Re||Se.length||1,"0"):"";m=(te||"")+(De||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const N=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),R=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||s.identidad||"C/F",T=new Date().toLocaleString(),$=Array.isArray(s.carrito)?s.carrito:[],M=typeof s.subtotal=="number"?s.subtotal:$.reduce((k,te)=>k+Number(te.producto&&te.producto.precio||te.precio||0)*(te.cantidad||1),0),G=typeof s.descuento=="number"?s.descuento:0,C=typeof s.exonerado=="number"?s.exonerado:0,L=typeof s.gravado=="number"?s.gravado:M,B=typeof s.exento=="number"?s.exento:0,P=typeof s.isvTotal=="number"?s.isvTotal:0,ve=typeof s.imp18Total=="number"?s.imp18Total:0,J=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,oe=typeof s.total=="number"?s.total:null,je=M+(P||0)+(ve||0)+(J||0),I=oe??je,ee=I,X=s.pagos||{},E=typeof X.efectivo=="number"?X.efectivo:typeof s.Efectivo=="number"?s.Efectivo:0,U=typeof X.tarjeta=="number"?X.tarjeta:typeof s.Tarjeta=="number"?s.Tarjeta:0,Z=typeof X.transferencia=="number"?X.transferencia:typeof s.Transferencia=="number"?s.Transferencia:0,ge=typeof X.totalPaid=="number"?X.totalPaid:E+U+Z;let _e;if(typeof X.cambio=="number")_e=X.cambio;else if(typeof s.cambio=="number")_e=s.cambio;else{const k=Number(ge)-Number(ee||0);_e=isNaN(k)?0:k>0?k:0}const D=$.map(k=>{const te=String(k.producto&&(k.producto.nombre||k.producto.descripcion)||k.descripcion||k.nombre||""),pe=Number(k.cantidad||0),Se=Number((k.producto&&(k.producto.precio??k.producto.precio_unitario))??k.precio_unitario??k.precio??0),Re=!!(k.producto&&k.producto.exento)||!!k.exento,De=!!(k.producto&&k.producto.aplica_impuesto_18)||!!k.aplica_impuesto_18,qe=!!(k.producto&&k.producto.aplica_impuesto_turistico)||!!k.aplica_impuesto_turistico,Je=De?s.tax18Rate??s.tax18??0:s.taxRate??s.tax??0,pt=qe?s.taxTouristRate??s.taxTourist??0:0,mt=(Number(Je)||0)+(Number(pt)||0);let dt=Se;!Re&&mt>0&&(dt=Se/(1+mt));const Et=Number(dt||0).toFixed(2),It=dt*pe,et=Number(It||0).toFixed(2);return`<tr><td>${k.producto&&k.producto.sku||k.sku||""} ${te}</td><td style="text-align:center">${pe}</td><td style="text-align:right">L ${Et}</td><td style="text-align:right">L ${et}</td></tr>`}).join(`
`),O=(Number(E)||0)+(Number(Z)||0)+(Number(U)||0)-(Number(_e)||0),F=isNaN(O)?0:O,se=fx(F);return`
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Factura Detallada</title>
	<style>
		/* === 1. Estilos Base y Reset de Impresin === */
		@page {
			size: letter;
			margin: 0.5in; /* Reducido a 0.5in para mejor uso del espacio */
		}

		* {
			/* Mantener la configuracin de negrita y espaciado ajustado para factura */
			font-weight: bold !important;
			letter-spacing: 0 !important;
			word-spacing: 0 !important;
			margin: 0;
			padding: 0;
			line-height: 1.2 !important; /* Ligeramente aumentado para legibilidad */
			box-sizing: border-box;
		}

		body {
			font-family: 'Arial', sans-serif;
			font-size: 10px;
			color: #000;
			margin: 0;
			padding: 0;
		}

		/* === 2. Estructura Principal === */
		.factura-container {
			width: 100%;
			max-width: 8.5in;
			margin: 0 auto;
			padding: 0.25in; /* Espaciado interno general */
		}

		.divider {
			border: none;
			border-top: 1px solid #000;
			margin: 5px 0;
		}

		/* === 3. Encabezado de Factura === */
		.header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 10px;
		}

		.header img {
			width: 200px; /* Tamao ajustado para armona */
			height: auto;
			object-fit: contain;
			margin-right: 20px;
		}

		.header-title {
			font-size: 35px; /* Reducido ligeramente para balance */
			color: #0066CC;
			text-align: right;
			flex-grow: 1;
		}

		/* === 4. Secciones de Informacin === */
		.info-section h3, .info-section p {
			font-size: 11px;
			margin-bottom: 2px;
		}

		.info-dates {
			text-align: right;
			margin-bottom: 5px;
		}
		
		.info-dates p {
			font-size: 10px;
			margin: 1px 0;
		}

		/* === 5. Tabla de Productos === */
		.tabla {
			width: 100%;
			border-collapse: collapse;
			margin-top: 8px;
			font-size: 10px;
		}

		.tabla th, .tabla td {
			border: 1px solid #000;
			padding: 4px 6px; /* Aumentado para mejor legibilidad */
			text-align: left;
		}

		.tabla th {
			background-color: #555; /* Oscurecido a un gris ms formal */
			color: white;
			text-transform: uppercase;
		}

		.tabla td:nth-child(2), .tabla td:nth-child(3), .tabla td:nth-child(4) {
			text-align: right; /* Alineacin de nmeros */
		}

		/* === 6. Totales y Pagos === */
		.totals-section {
			margin-top: 5px;
			display: grid;
			grid-template-columns: 1fr 1fr; /* Para asegurar alineacin de etiquetas y valores */
			gap: 2px 0;
		}

		.totals-section p {
			display: contents; /* Permite que el span .right se alinee al final de la columna */
		}

		.totals-section span.label {
			text-align: left;
			padding-left: 2px;
		}

		.totals-section span.value {
			text-align: right;
			padding-right: 2px;
		}
		
		.total-final {
			font-size: 11px;
			margin-top: 5px;
			border-top: 1px solid #000;
			padding-top: 3px;
		}

		/* === 7. Pie de Factura === */
		.footer-info {
			text-align: center;
			margin-top: 10px;
			font-size: 10px;
		}
		
		.letras {
			font-size: 11px;
			margin: 5px 0;
			text-align: center;
		}

		.firma-section {
			margin-top: 15px;
			display: flex;
			justify-content: space-around;
			text-align: center;
		}

		.copias-info {
			text-align: center;
			margin-top: 8px;
		}

		.final-message {
			font-size: 10px;
			text-align: center;
			margin-top: 10px;
		}
		
		/* === 8. Media Print Overrides (Mejorado) === */
		@media print {
			.tabla th {
				/* Asegurar colores de encabezado de tabla en la impresin */
				background-color: #555 !important;
				color: white !important;
				-webkit-print-color-adjust: exact;
				print-color-adjust: exact;
			}
			.factura-container {
				box-shadow: none;
				border-radius: 0;
			}
			/* Se puede aadir ms ajustes si la impresin recorta elementos */
		}

			/* Forzar que navegadores impriman colores de fondo y estilos exactos */
			html, body, .factura-container, .header, .header-title, .header-title-container, .tabla, .tabla th, .totals-section, .total-final, .footer-info {
				-webkit-print-color-adjust: exact !important;
				print-color-adjust: exact !important;
				color-adjust: exact !important;
			}

			/* Reforzar en la regla de impresin para asegurar compatibilidad */
			@media print {
				.header-title { color: #0066CC !important; }
				.tabla th { background-color: #555 !important; color: #fff !important; }
				.totals-section, .total-final { background-color: transparent !important; }
			}
			.header-title-container {
    text-align: right;
}

.numero-factura {
    font-size: 24px;   /* Tamao grande */
    color: #000;       /* Negro */
    margin-top: -5px;  /* Ajuste opcional para acercarlo al ttulo */
}

	</style>
</head>
<body>
	<main class="factura-container">

		<header class="header">
    <img src="${p}" alt="Logo del Comercio" />
    <div class="header-title-container">
        <h1 class="header-title">FACTURA</h1>
        <h2 class="numero-factura">No. ${m}</h2>
    </div>
</header>

		<hr class="divider" />

		<section class="info-section">
			<h3>${l}</h3>
			<p>RTN: ${u}</p>
			<p>Direccin: ${d}</p>
			<p>Telfono: ${h}</p>
			<p>Email: ${g}</p>
		</section>
		<hr class="divider" />

		<section class="info-dates">
			<p>Fecha y hora: ${T}</p>
			<p>Factura No: ${m}</p>
			<p>CAI: ${v}</p>
			<p>Fecha lmite de emisin: ${x}</p>
			<p>Rango autorizado: ${w?w+" "+_+" al "+w+" "+b:_+" al "+b}</p>
		</section>
		<hr class="divider" />

		<section class="info-section">
			<p>Cliente: ${N}</p>
			<p>RTN Cliente: ${R}</p>
		</section>
		<hr class="divider" />

		<section class="details-section">
			<table class="tabla">
				<thead>
					<tr>
						<th>Descripcin</th>
						<th style="width: 10%;">Cant</th>
							<th style="width: 15%;">Precio unitario</th>
							<th style="width: 15%;">Total</th>
					</tr>
				</thead>
				<tbody>
					${D} </tbody>
			</table>
		</section>
		<hr class="divider" />

	<section class="totals-section">
    <span class="label">Descuento:</span> <span class="value">L ${G.toFixed(2)}</span>
    <span class="label">Sub Total Exonerado:</span> <span class="value">L ${Number(C).toFixed(2)}</span>
    <span class="label">Sub Total Gravado:</span> <span class="value">L ${Number(L).toFixed(2)}</span>
    <span class="label">Sub Total Exento:</span> <span class="value">L ${Number(B).toFixed(2)}</span>
    <span class="label">Tasa Turstica 4%:</span> <span class="value">L ${Number(J).toFixed(2)}</span>
    <span class="label">ISV 15%:</span> <span class="value">L ${Number(P).toFixed(2)}</span>
    <span class="label">ISV 18%:</span> <span class="value">L ${Number(ve).toFixed(2)}</span>
</section>

<section class="transaccion-section"><hr class="divider" />
    <span class="label">TOTAL TRANSACCIN:</span>
    <span class="value">L ${Number(I).toFixed(2)}</span>
</section>

<hr class="divider" />


		<section class="totals-section total-final">
			<span class="label">**TOTAL FACTURA:**</span> <span class="value">**L ${ee.toFixed(2)}**</span>
			<span class="label">Efectivo:</span> <span class="value">L ${Number(E).toFixed(2)}</span>
			<span class="label">Tarjeta:</span> <span class="value">L ${Number(U).toFixed(2)}</span>
			<span class="label">Transferencia:</span> <span class="value">L ${Number(Z).toFixed(2)}</span>
			<span class="label">Cambio:</span> <span class="value">L ${Number(_e).toFixed(2)}</span>
		</section>
		<hr class="divider" />

		<footer class="footer-info">
			<div class="letras">
				<p>Total Pagado: L ${F.toFixed(2)}</p>
				<p>*** ${se} Lempiras ***</p>
			</div>
			<hr class="divider" />
			
			<div class="firma-section">
				<p>Firma del Cliente: ______________________</p>
				<p>Firma del Emisor: ______________________</p>
			</div>
			
			<div class="copias-info">
				<p>Original: Cliente | Copia: Obligado tributario emisor</p>
			</div>
			
			<div class="final-message">
				<h5>Para cualquier reclamo debe presentar su factura</h5>
				<h5>Gracias por su compra!</h5>
				<h5>LA FACTURA ES BENEFICIO DE TODOS EXJALA!</h5>
			</div>
		</footer>

	</main>
</body>
</html>`}function fx(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const x=Math.floor(v/10),_=v%10;return s[x]+(_?" y "+a[_]:"")}if(v<1e3){const x=Math.floor(v/100),_=v%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let x=u(v);m===2&&v===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}async function cp(o={},a="factura",s={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const k=await Wl();k&&(l=l||k.nombre||k.comercio||l,u=u||k.rtn||u,d=d||k.direccion||k.direccion_fiscal||d,h=h||k.telefono||k.telefono_fijo||h,g=g||k.email||k.correo||g,p=p||k.logoUrl||k.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const k=await fetch(String(p),{mode:"cors"});if(k.ok){const te=await k.blob(),pe=await new Promise(Se=>{const Re=new FileReader;Re.onloadend=()=>{Se(typeof Re.result=="string"?Re.result:null)},Re.onerror=()=>{Se(null)},Re.readAsDataURL(te)});pe&&(p=pe)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let k=o.caiInfo||null;if(!k&&typeof window<"u"){const te=window.localStorage.getItem("caiInfo");if(te)try{k=JSON.parse(te)}catch{k=null}}if(k&&(v=v||k.cai||k.CAI||"",x=x||k.fecha_vencimiento||k.fecha_limite_emision||"",_=_||k.rango_de||k.rangoDesde||"",b=b||k.rango_hasta||k.rangoHasta||"",w=w||k.identificador||"",!m))try{const te=k.identificador?String(k.identificador):"",pe=k.secuencia_actual!=null?String(k.secuencia_actual):k.rango_de!=null?String(k.rango_de):"",Se=String(pe).replace(/[^0-9]/g,"")||"";let Re=0;(k.rango_hasta||k.rango_de)&&(Re=Math.max(String(k.rango_hasta||k.rango_de).length,Se.length));const De=Se?String(Se).padStart(Re||Se.length||1,"0"):"";m=(te||"")+(De||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const N=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),R=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||s.identidad||"C/F",T=new Date().toLocaleString(),$=Array.isArray(s.carrito)?s.carrito:[],M=typeof s.subtotal=="number"?s.subtotal:$.reduce((k,te)=>k+Number(te.producto&&te.producto.precio||te.precio||0)*(te.cantidad||1),0),G=typeof s.descuento=="number"?s.descuento:0,C=typeof s.exonerado=="number"?s.exonerado:0,L=typeof s.gravado=="number"?s.gravado:M,B=typeof s.exento=="number"?s.exento:0,P=typeof s.isvTotal=="number"?s.isvTotal:0,ve=typeof s.imp18Total=="number"?s.imp18Total:0,J=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,oe=typeof s.total=="number"?s.total:null,je=M+(P||0)+(ve||0)+(J||0),I=oe??je,ee=I,X=s.pagos||{},E=typeof X.efectivo=="number"?X.efectivo:typeof s.Efectivo=="number"?s.Efectivo:0,U=typeof X.tarjeta=="number"?X.tarjeta:typeof s.Tarjeta=="number"?s.Tarjeta:0,Z=typeof X.transferencia=="number"?X.transferencia:typeof s.Transferencia=="number"?s.Transferencia:0,ge=typeof X.totalPaid=="number"?X.totalPaid:E+U+Z;let _e;if(typeof X.cambio=="number")_e=X.cambio;else if(typeof s.cambio=="number")_e=s.cambio;else{const k=Number(ge)-Number(ee||0);_e=isNaN(k)?0:k>0?k:0}const D=$.map(k=>{const te=String(k.producto&&(k.producto.nombre||k.producto.descripcion)||k.descripcion||k.nombre||""),pe=Number(k.cantidad||0),Se=Number((k.producto&&(k.producto.precio??k.producto.precio_unitario))??k.precio_unitario??k.precio??0),Re=!!(k.producto&&k.producto.exento)||!!k.exento,De=!!(k.producto&&k.producto.aplica_impuesto_18)||!!k.aplica_impuesto_18,qe=!!(k.producto&&k.producto.aplica_impuesto_turistico)||!!k.aplica_impuesto_turistico,Je=De?s.tax18Rate??s.tax18??0:s.taxRate??s.tax??0,pt=qe?s.taxTouristRate??s.taxTourist??0:0,mt=(Number(Je)||0)+(Number(pt)||0);let dt=Se;!Re&&mt>0&&(dt=Se/(1+mt));const Et=Number(dt||0).toFixed(2),It=dt*pe,et=Number(It||0).toFixed(2);return`<tr><td>${k.producto&&k.producto.sku||k.sku||""} ${te}</td><td style="text-align:center">${pe}</td><td style="text-align:right">L ${Et}</td><td style="text-align:right">L ${et}</td></tr>`}).join(`
`),O=(Number(E)||0)+(Number(Z)||0)+(Number(U)||0)-(Number(_e)||0),F=isNaN(O)?0:O,se=hx(F);return`<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Factura Cinta</title>

<style>
    body {
        font-family: monospace;
        font-size: 12px;
        width: 260px; /* tamao para impresora trmica 58mm */
        margin: 0 auto;
        padding: 0;
    }

    .center { text-align: center; }
    .line { border-top: 1px dashed #000; margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 2px 0; }
    th { border-bottom: 1px solid #000; }
    .right { text-align: right; }
    .left { text-align: left; }
    .bold { font-weight: bold; }
</style>
</head>

<body>

<div class="center">
    <img src="${p}" alt="logo" style="width:120px; height:auto;" />
</div>

<div class="center bold">FACTURA</div>
<div class="center">No. ${m}</div>

<div class="line"></div>

<div class="center bold">${l}</div>
<p>RTN: ${u}</p>
<p>Direccin: ${d}</p>
<p>Tel: ${h}</p>
<p>Email: ${g}</p>

<div class="line"></div>

<p>Fecha/Hora: ${T}</p>
<p>CAI: ${v}</p>
<p>F. Lmite: ${x}</p>
<p>Rango:  
${w?w+" "+_+" al "+w+" "+b:_+" al "+b}</p>

<div class="line"></div>

<p>Cliente: ${N}</p>
<p>RTN Cliente: ${R}</p>

<div class="line"></div>

<table>
    <thead>
        <tr>
            <th class="left">Descripcin</th>
            <th class="right">Cant</th>
            <th class="right">P.U</th>
            <th class="right">Total</th>
        </tr>
    </thead>
    <tbody>
        ${D}
    </tbody>
</table>

<div class="line"></div>

<p>Descuento: <span class="right">L ${G.toFixed(2)}</span></p>
<p>SubT Exonerado: <span class="right">L ${Number(C).toFixed(2)}</span></p>
<p>SubT Gravado: <span class="right">L ${Number(L).toFixed(2)}</span></p>
<p>SubT Exento: <span class="right">L ${Number(B).toFixed(2)}</span></p>
<p>Tasa Turstica 4%: <span class="right">L ${Number(J).toFixed(2)}</span></p>
<p>ISV 15%: <span class="right">L ${Number(P).toFixed(2)}</span></p>
<p>ISV 18%: <span class="right">L ${Number(ve).toFixed(2)}</span></p>

<div class="line"></div>

<p class="bold">TOTAL TRANSACCIN:
   <span class="right bold">L ${Number(I).toFixed(2)}</span>
</p>

<div class="line"></div>

<p class="bold">TOTAL FACTURA :
   <span class="right bold">L ${ee.toFixed(2)}</span>
</p>

<p>Efectivo: <span class="right">L ${Number(E).toFixed(2)}</span></p>
<p>Tarjeta: <span class="right">L ${Number(U).toFixed(2)}</span></p>
<p>Transferencia: <span class="right">L ${Number(Z).toFixed(2)}</span></p>
<p>Cambio: <span class="right">L ${Number(_e).toFixed(2)}</span></p>

<div class="line"></div>

<div class="center">
    <p>Total Pagado: L ${F.toFixed(2)}</p>
    <p>*** ${se} Lempiras ***</p>
</div>

<div class="line"></div>

<p>Firma Cliente: ____________________</p>
<p>Firma Emisor: _____________________</p>

<div class="center">
    <p>Original: Cliente</p>
    <p>Copia: Obligado tributario emisor</p>
</div>

<div class="center">
    <p>Para cualquier reclamo debe<br/>presentar su factura</p>
    <p>Gracias por su compra!</p>
    <p>LA FACTURA ES BENEFICIO DE TODOS,<br/>EXJALA!</p>
</div>

</body>
</html>
`}function hx(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const x=Math.floor(v/10),_=v%10;return s[x]+(_?" y "+a[_]:"")}if(v<1e3){const x=Math.floor(v/100),_=v%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let x=u(v);m===2&&v===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}function gx({onLogout:o}){j.useEffect(()=>{const H=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=H||""}},[]);const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(""),[g,p]=j.useState("Todas"),[m,v]=j.useState(.15),[x,_]=j.useState(0),[b,w]=j.useState(0),[N,R]=j.useState(26.27),T=["Todas",...Array.from(new Set(a.map(H=>H.categoria)))],$=a.filter(H=>(String(H.nombre||"").toLowerCase().includes(d.toLowerCase())||String(H.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||H.categoria===g)),M=l.reduce((H,ae)=>H+Number(ae.producto.precio||0)*ae.cantidad,0);let G=0,C=0,L=0;for(const H of l){const ae=Number(H.producto.precio||0)*H.cantidad,xe=!!H.producto.exento,ie=!!H.producto.aplica_impuesto_18,he=!!H.producto.aplica_impuesto_turistico;if(xe)continue;const ce=ie?x||0:m||0,ye=he&&b||0,be=(Number(ce)||0)+(Number(ye)||0);if(be<=0)continue;const me=ae-ae/(1+be);ie?C+=me*(ce/be):G+=me*(ce/be),he&&(L+=me*(ye/be))}const B=M,P=Math.max(0,M-(G+C+L)),ve=l.map(H=>{const ae=Number(H.producto.precio||0)*H.cantidad,xe=!!H.producto.exento,ie=!!H.producto.aplica_impuesto_18,he=!!H.producto.aplica_impuesto_turistico;if(xe)return{id:H.producto.id,nombre:H.producto.nombre,price:ae,isv:0,imp18:0,tur:0,totalTax:0};const ce=ie?x||0:m||0,ye=he&&b||0,be=(Number(ce)||0)+(Number(ye)||0);if(be<=0)return{id:H.producto.id,nombre:H.producto.nombre,price:ae,isv:0,imp18:0,tur:0,totalTax:0};const me=ae-ae/(1+be),de=ie?0:me*(ce/be),we=ie?me*(ce/be):0,Ae=he?me*(ye/be):0;return{id:H.producto.id,nombre:H.producto.nombre,price:ae,isv:de,imp18:we,tur:Ae,totalTax:de+we+Ae}}),J=H=>{const ae=Number(H.stock??0),xe=Number(H.precio??0);ae<1||xe<=0||u(ie=>ie.find(ce=>ce.producto.id===H.id)?ie.map(ce=>ce.producto.id===H.id?{...ce,cantidad:ce.cantidad+1}:ce):[...ie,{producto:H,cantidad:1}])},oe=(H,ae)=>{u(xe=>xe.map(ie=>{if(String(ie.producto.id)===String(H)){const he=ie.cantidad+ae;return he>0?{...ie,cantidad:he}:ie}return ie}).filter(ie=>ie.cantidad>0))},je=H=>{u(ae=>ae.filter(xe=>String(xe.producto.id)!==String(H)))},I=()=>u([]),[ee,X]=j.useState(!1),[E,U]=j.useState("factura"),[Z,ge]=j.useState(!1),[_e,A]=j.useState(null),[D,O]=j.useState(null),[F,se]=j.useState(!1),[fe,k]=j.useState(!1),[te,pe]=j.useState(""),[Se,Re]=j.useState(""),De=j.useRef(null),qe=j.useRef(null),[Je,pt]=j.useState("final"),[mt,dt]=j.useState(""),[Et,It]=j.useState(""),[et,nt]=j.useState(!1),[$a,vi]=j.useState(!1),[Vt,bi]=j.useState(!1),[vs,xi]=j.useState(!1),[Pa,yr]=j.useState(null),[bs,xs]=j.useState(!1),[_i,ca]=j.useState("carta"),[Gt,En]=j.useState(!1),Ft=async H=>{if(Re(H),!H||String(H).trim()===""){pe("");return}try{if(Je==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",H);const{data:he,error:ce}=await ne.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",H).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:he,error:ce}),!ce&&he&&he.nombre){pe(he.nombre||""),dt(he.telefono||""),It(he.correo_electronico||""),nt(!!he.exonerado),setTimeout(()=>{try{qe.current?.focus()}catch{}},50);return}else{pe(""),dt(""),It(""),nt(!1);return}}const ae="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",H);const{data:xe,error:ie}=await ne.from(ae).select("nombre").eq("rtn",H).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:xe,error:ie}),!ie&&xe&&xe.nombre?(pe(xe.nombre||""),setTimeout(()=>{try{qe.current?.focus()}catch{}},50)):pe("")}catch(ae){console.warn("Error buscando cliente por RTN:",ae)}},eo=H=>{if(H==="cotizacion"){U("cotizacion"),X(!0);return}U(H),X(!0)},to=async(H={})=>{try{if(!l||l.length===0)return null;const ae=ji(),xe=G,ie=C,he=L,ce=Number(xe||0)+Number(ie||0)+Number(he||0),ye=ae+ce;let be=H.cliente_id??null;if(!be&&H.rtn)try{const{data:bt,error:yt}=await ne.from("clientes").select("id").eq("rtn",H.rtn).maybeSingle();!yt&&bt&&bt.id&&(be=bt.id)}catch{}const me=In||"system",de=String(Math.floor(Math.random()*9e5)+1e5),we={cliente_id:be,usuario:me,numero_cotizacion:de,validez_dias:30,subtotal:ae,impuesto:ce,total:ye,estado:"pendiente"};let Ae=H.cotizacion_id??D;if(Ae){const bt={cliente_id:we.cliente_id||null,usuario:we.usuario,validez_dias:we.validez_dias,subtotal:we.subtotal,impuesto:we.impuesto,total:we.total,estado:we.estado},{error:yt}=await ne.from("cotizaciones").update(bt).eq("id",Ae);if(yt)return console.warn("Error actualizando cotizacion:",yt),null}else{const{data:bt,error:yt}=await ne.from("cotizaciones").insert([we]).select("id").maybeSingle();if(yt)return console.warn("Error insertando cotizacion:",yt),null;if(Ae=bt?.id||null,!Ae)return null}const Le=l.map(bt=>{const yt=Number(bt.producto.precio||0),ct=Number(bt.cantidad||0),Un=!!bt.producto.exento,Kt=!!bt.producto.aplica_impuesto_18,Fa=!!bt.producto.aplica_impuesto_turistico,Yt=Un||Kt?0:yt*(m||0)*ct,Ka=Un?0:Kt?yt*(x||0)*ct:0,ga=Un?0:Fa?yt*(b||0)*ct:0,hn=yt*ct,Ee=hn+Yt+Ka+ga;return{cotizacion_id:Ae,producto_id:bt.producto.id||null,descripcion:bt.producto.nombre||"",cantidad:ct,precio_unitario:yt,subtotal:hn,descuento:0,total:Ee}});try{await ne.from("cotizaciones_detalle").delete().eq("cotizacion_id",Ae)}catch{}const{error:ft}=await ne.from("cotizaciones_detalle").insert(Le);return ft?console.warn("Error insertando cotizaciones_detalle:",ft):console.debug("Cotizacion guardada id=",Ae),Ae}catch(ae){return console.warn("Error guardando cotizacion:",ae),null}},ji=()=>{const H=l.reduce((he,ce)=>he+Number(ce.producto.precio||0)*ce.cantidad,0);let ae=0,xe=0,ie=0;for(const he of l){const ce=Number(he.producto.precio||0)*he.cantidad,ye=!!he.producto.exento,be=!!he.producto.aplica_impuesto_18,me=!!he.producto.aplica_impuesto_turistico;if(ye)continue;const de=be?x||0:m||0,we=me&&b||0,Ae=(Number(de)||0)+(Number(we)||0);if(Ae<=0)continue;const Le=ce-ce/(1+Ae);be?xe+=Le*(de/Ae):ae+=Le*(de/Ae),me&&(ie+=Le*(we/Ae))}return Math.max(0,H-(ae+xe+ie))},Si=()=>l.reduce((H,ae)=>H+(ae.producto.exento?0:Number(ae.producto.precio||0)*ae.cantidad),0),wi=async()=>{pt("final"),pe("Consumidor Final"),Re("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),xs(!0),bi(!0),X(!1)},Ei=()=>{pt("normal"),pe(""),Re(""),xi(!1),yr(null),se(!0),X(!1)},qn=()=>{pt("juridico"),pe(""),Re(""),xi(!1),yr(null),se(!0),X(!1)},Ci=async(H,ae,xe)=>{const he=await(_i==="cinta"?cp:op)({cliente:H,rtn:ae},E,{carrito:l,subtotal:ji(),isvTotal:G,imp18Total:C,impTouristTotal:L,taxRate:m,tax18Rate:x,taxTouristRate:b,total:B,pagos:xe});if(E==="factura"&&D)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",D);const{error:ce}=await ne.from("cotizaciones").update({estado:"aceptada"}).eq("id",D);if(ce)console.warn("Error marcando cotizacion (pre-print):",ce);else try{O(null)}catch{}}catch(ce){console.warn("Error marcacion pre-print:",ce)}if(E==="factura")try{let ce=null,ye=null;try{const be=localStorage.getItem("user"),me=be?JSON.parse(be):null;ye=me&&(me.id||me.user?.id||me.sub||me.user_id)?me.id||me.user?.id||me.sub||me.user_id:null;const de=me&&(me.username||me.user?.username||me.name||me.user?.name)?me.username||me.user?.username||me.name||me.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",be),console.debug("PV: CAI lookup - parsed user object:",me),console.debug("PV: CAI lookup - extracted userId:",ye,"typeof",typeof ye),console.debug("PV: CAI lookup - extracted userNameFromStorage:",de),ye){const we=typeof ye=="string"&&/^\d+$/.test(ye)?Number(ye):ye;try{const{data:Ae,error:Le}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",we).order("id",{ascending:!1}).limit(1);!Le&&Array.isArray(Ae)&&Ae.length>0&&(ce=Ae[0])}catch(Ae){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Ae)}}if(!ce&&de)try{const{data:we,error:Ae}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",de).order("id",{ascending:!1}).limit(1);!Ae&&Array.isArray(we)&&we.length>0&&(ce=we[0])}catch(we){console.debug("PV: CAI lookup by cajero failed:",we)}}catch(be){console.debug("No se pudo cargar CAI desde frontend:",be)}await ua({clienteName:H,rtn:ae,paymentPayload:xe,caiData:ce,usuarioId:ye})}catch(ce){console.warn("Error preparando venta antes de imprimir:",ce),alert("Error preparando venta antes de imprimir: "+String(ce))}try{const ce=document.createElement("iframe");ce.style.position="fixed",ce.style.right="0",ce.style.bottom="0",ce.style.width="0",ce.style.height="0",ce.style.border="0",ce.style.overflow="hidden",ce.setAttribute("aria-hidden","true"),document.body.appendChild(ce);const ye=ce.contentWindow,be=ce.contentDocument||ce.contentWindow?.document;if(!be||!ye)try{document.body.removeChild(ce)}catch{}else{be.open(),be.write(he),be.close();const me=()=>{try{ye.focus(),ye.print()}catch(we){console.warn("Error during iframe print (finalize):",we)}setTimeout(()=>{try{document.body.removeChild(ce)}catch{}},800)},de=()=>{try{const we=be.images;if(we&&we.length>0){let Ae=0;for(let Le=0;Le<we.length;Le++){const ft=we[Le];ft.complete?Ae++:(ft.addEventListener("load",()=>{Ae++,Ae===we.length&&me()}),ft.addEventListener("error",()=>{Ae++,Ae===we.length&&me()}))}Ae===we.length&&me()}else me()}catch{try{ye.addEventListener("load",me)}catch{}setTimeout(me,1e3)}};try{be.readyState==="complete"?de():(ye.addEventListener("load",de),setTimeout(de,1500))}catch{setTimeout(de,800)}}}catch(ce){console.warn("Direct print failed, falling back to opening new window",ce);const ye=window.open("","_blank");ye&&(ye.document.open(),ye.document.write(he),ye.document.close(),setTimeout(()=>{try{ye.print(),ye.close()}catch{}},800))}E==="factura"&&(I(),await _s()),E==="cotizacion"&&(A({cliente:H,rtn:ae}),ge(!0))},ua=async({clienteName:H,rtn:ae,paymentPayload:xe,caiData:ie,usuarioId:he})=>{if(!l||l.length===0)return null;const ce=xe&&xe.tipoPagoString?String(xe.tipoPagoString):"",ye=xe&&xe.totalPaid?Number(xe.totalPaid||0):0,be=ye>Number(B||0)?ye-Number(B||0):0;let me=String(Math.floor(Math.random()*9e5)+1e5);const de=_r||ie||null;let we=null,Ae=0,Le=null,ft=null;if(de&&(de.rango_de!==void 0||de.secuencia_actual!==void 0))try{const Ee=de.rango_de!=null?String(de.rango_de):"",Ie=de.rango_hasta!=null?String(de.rango_hasta):"",Qe=de.secuencia_actual!=null?String(de.secuencia_actual):"",Te=Number(String(Ee).replace(/[^0-9]/g,""))||0,Pe=Number(String(Ie).replace(/[^0-9]/g,""))||0,Xe=Number(String(Qe).replace(/[^0-9]/g,""))||Te||0;Ae=Math.max((Ie||Ee||"").length,String(Xe).length,1),ft=String(Xe).padStart(Ae,"0"),me=(de.identificador?String(de.identificador):"")+ft;const Pn=Xe+1;we=Pn,Le=String(Pn).padStart(Ae,"0")}catch(Ee){console.debug("Error computing factura from caiInfoState, falling back to random:",Ee)}const bt={rtn:ae||null,nombre_cliente:H||null,usuario:In||"system",factura:me,tipo_pago:ce,subtotal:Number(P||0),impuesto:Number(G+C+L||0),total:Number(B||0),estado:"pagada",cambio:String(Number(be).toFixed(2)),cai:de?.cai??null,rango_desde:(de&&de.identificador?String(de.identificador):"")+(de?.rango_de!=null?String(de.rango_de):"")||null,rango_hasta:(de&&de.identificador?String(de.identificador):"")+(de?.rango_hasta!=null?String(de.rango_hasta):"")||null,fecha_limite_emision:de?.fecha_vencimiento??de?.fecha_limite_emision??null};let yt=null,ct=null;try{const Ee=await ne.from("ventas").insert([bt]).select("id, factura");yt=Ee.data??Ee,ct=Ee.error??null}catch(Ee){ct=Ee}if(console.debug("Insert venta response:",{ventaInsRaw:yt,ventaErr:ct}),ct){const Ee=String(ct&&(ct.message||ct.msg||ct.details)||""),Ie=ct&&ct.code?String(ct.code):"";if(Ie==="PGRST204"||Ee.includes("Could not find the")||/column .* of 'ventas'/.test(Ee)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:Ee,code:Ie});const Te={...bt};delete Te.cai,delete Te.rango_desde,delete Te.rango_hasta,delete Te.fecha_limite_emision;try{const Pe=await ne.from("ventas").insert([Te]).select("id, factura");if(yt=Pe.data??Pe,ct=Pe.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:yt,ventaErr:ct}),ct)throw ct}catch(Pe){throw console.error("Fallback insert also failed:",Pe),Pe}}else throw ct}const Un=Array.isArray(yt)?yt[0]:yt;let Kt=Un?Un.id||Un.id:null;if(!Kt)try{const{data:Ee,error:Ie}=await ne.from("ventas").select("id").eq("factura",me).maybeSingle();Ie&&console.debug("Error buscando venta por factura (fallback):",Ie),Ee&&Ee.id&&(Kt=Ee.id)}catch(Ee){console.debug("fallback lookup error",Ee)}if(!Kt)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",yt),null;const Fa=l.map(Ee=>{const Ie=Number(Ee.producto.precio||0),Qe=Number(Ee.cantidad||0),Te=Ie*Qe,Pe=0,Xe=Te-Pe;return{venta_id:Kt,factura:me,producto_id:Ee.producto.id,cantidad:Qe,precio_unitario:Ie,subtotal:Te,descuento:Pe,total:Xe}});if(ie&&he&&(Ee=>typeof Ee=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Ee))(he))try{const Ee=l.map(Te=>({producto_id:String(Te.producto.id),cantidad:Number(Te.cantidad||0),precio_unitario:Number(Te.producto.precio||0),subtotal:Number((Number(Te.producto.precio||0)*Te.cantidad).toFixed(6)),descuento:0,total:Number((Number(Te.producto.precio||0)*Te.cantidad).toFixed(6))})),{data:Ie,error:Qe}=await ne.rpc("create_venta_with_detalle",{p_usuario_id:he,p_usuario:In||he,p_rtn:ae||null,p_nombre_cliente:H||null,p_tipo_pago:ce,p_subtotal:Number(P||0),p_impuesto:Number(G+C+L||0),p_total:Number(B||0),p_cambio:String(Number(be).toFixed(2)),p_detalles:Ee});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:Ie,rpcErr:Qe}),Qe)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",Qe);else if(Ie&&Array.isArray(Ie)&&Ie.length>0){const Te=Ie[0];try{if(de&&de.id!=null)try{const{data:Pe,error:Xe}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",de.id).maybeSingle();if(!Xe&&Pe){$n(Pe);try{localStorage.setItem("caiInfo",JSON.stringify(Pe))}catch{}}}catch(Pe){console.debug("Error refreshing cai after RPC:",Pe)}}catch(Pe){console.debug("Error during post-RPC cai refresh:",Pe)}return Te.venta_id||Te.venta_id===0?Te.venta_id:Kt}else if(Ie&&Ie.venta_id){try{if(de&&de.id!=null)try{const{data:Te,error:Pe}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",de.id).maybeSingle();if(!Pe&&Te){$n(Te);try{localStorage.setItem("caiInfo",JSON.stringify(Te))}catch{}}}catch(Te){console.debug("Error refreshing cai after RPC (scalar):",Te)}}catch(Te){console.debug("Error during post-RPC cai refresh (scalar):",Te)}return Ie.venta_id}}catch(Ee){console.warn("Error calling RPC create_venta_with_detalle:",Ee)}else ie&&he&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",he);const{data:Ka,error:ga}=await ne.from("ventas_detalle").insert(Fa).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:Ka,detErr:ga}),ga)throw ga;try{const Ee=`venta: ${me}`;let Ie=In||"sistema";try{const Pe=localStorage.getItem("user");if(Pe){const Xe=JSON.parse(Pe);Ie=Xe&&(Xe.username||Xe.user?.username||Xe.name||Xe.user?.name)?Xe.username||Xe.user?.username||Xe.name||Xe.user?.name:String(Xe)}}catch{}const Qe=new Date().toISOString(),Te=Fa.map(Pe=>({producto_id:Pe.producto_id,cantidad:Pe.cantidad,tipo_de_movimiento:"SALIDA",referencia:Ee,usuario:Ie,fecha_salida:Qe}));if(Te.length>0){const{data:Pe,error:Xe}=await ne.from("registro_de_inventario").insert(Te).select("id");Xe?console.warn("Error registrando salida en registro_de_inventario:",Xe):console.debug("Registro_de_inventario inserciones (salida):",Pe)}}catch(Ee){console.warn("Excepcin registrando salidas en registro_de_inventario:",Ee)}try{const Ee={};for(const Ie of Fa){const Qe=String(Ie.producto_id),Te=Number(Ie.cantidad||0);Ee[Qe]||(Ee[Qe]=0),Ee[Qe]+=Te}for(const Ie of Object.keys(Ee))try{const Qe=Number(Ee[Ie]||0);if(Qe<=0)continue;const{data:Te,error:Pe}=await ne.from("inventario").select("stock").eq("id",Ie).maybeSingle();if(Pe){console.warn("Error leyendo stock de inventario para producto",Ie,Pe);continue}const Xe=Te&&Te.stock!=null?Number(Te.stock):0,pa=Math.max(0,Xe-Qe),{error:Pn}=await ne.from("inventario").update({stock:pa}).eq("id",Ie);Pn?console.warn("Error actualizando stock para producto",Ie,Pn):console.debug("Stock actualizado para producto",Ie,"de",Xe,"a",pa)}catch(Qe){console.warn("Excepcin actualizando stock para producto",Ie,Qe)}}catch(Ee){console.warn("Excepcin agregada en proceso de actualizacin de stock:",Ee)}try{if(xe&&Array.isArray(xe.pagos)&&xe.pagos.length>0){const Ee=xe.pagos.map(Te=>({venta_id:Kt,tipo:Te.tipo,monto:Number(Te.monto||0),banco:Te.banco||null,tarjeta:Te.tarjeta||null,factura:me||Te.factura||null,autorizador:Te.autorizador||null,referencia:Te.referencia||null,meta:Te.meta||null,created_by:typeof he=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(he)?he:null})),{data:Ie,error:Qe}=await ne.from("pagos").insert(Ee).select("id");Qe?console.warn("Error insertando pagos en tabla pagos:",Qe):console.debug("Pagos insertados:",Ie)}}catch(Ee){console.warn("Excepcin insertando pagos:",Ee)}const hn=de&&(de.id||de.id===0)?de.id:null;if(hn!=null&&we!=null)try{const Ee=Le??String(we);try{const Ie=de?.rango_hasta!=null?String(de.rango_hasta):"",Qe=Number(Ie.replace(/[^0-9]/g,""))||null,Te=Number(String(Ee).replace(/[^0-9]/g,""))||null;if(Qe!=null&&Te!=null&&Te>Qe)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:Te,rangoHastaNum:Qe});else{const{error:Pe}=await ne.from("cai").update({secuencia_actual:Ee}).eq("id",hn);if(Pe)console.debug("Error updating cai.secuencia_actual (manual path):",Pe);else{console.debug("Updated cai.secuencia_actual to",Ee,"for cai id",hn);try{const Xe={...de||{},secuencia_actual:Ee};$n(Xe);try{localStorage.setItem("caiInfo",JSON.stringify(Xe))}catch{}}catch(Xe){console.debug("Error updating local caiInfoState/localStorage:",Xe)}}}}catch(Ie){console.debug("Validation error while checking rango_hasta:",Ie);const{error:Qe}=await ne.from("cai").update({secuencia_actual:Ee}).eq("id",hn);if(Qe)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",Qe);else{console.debug("Updated cai.secuencia_actual to",Ee,"for cai id",hn);try{const Te={...de||{},secuencia_actual:Ee};$n(Te);try{localStorage.setItem("caiInfo",JSON.stringify(Te))}catch{}}catch(Te){console.debug("Error updating local caiInfoState/localStorage (after validation):",Te)}}}}catch(Ee){console.debug("Exception updating cai.secuencia_actual:",Ee)}try{await br()}catch(Ee){console.debug("refreshProducts after insertVenta failed",Ee)}return Kt},_s=async()=>{if(E==="factura"&&D)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",D);const{error:H}=await ne.from("cotizaciones").update({estado:"aceptada"}).eq("id",D);H?console.warn("Error marcando cotizacion como facturado:",H):console.debug("Cotizacion marcada como facturado:",D)}catch(H){console.warn("Error procesando cotizacion tras facturar",H)}};j.useEffect(()=>{F&&setTimeout(()=>{try{De.current?.focus()}catch{}},80)},[F]);const js=async()=>{try{if(Se&&te){const ie={rtn:Se,nombre:te},{error:he}=await ne.from("clientenatural").upsert(ie,{onConflict:"rtn"});he&&console.warn("Error guardando clientenatural:",he)}}catch(ie){console.warn("Error upsert clientenatural:",ie)}try{if(Se&&te)if(Je==="juridico"){const{data:ie,error:he}=await ne.from("clientes").select("id").eq("rtn",Se).eq("tipo_cliente","juridico").maybeSingle();if(he&&console.warn("Error buscando cliente juridico:",he),ie&&ie.id){const{error:ce}=await ne.from("clientes").update({nombre:te,telefono:mt||null,correo_electronico:Et||null,exonerado:et}).eq("id",ie.id);ce&&console.warn("Error actualizando cliente juridico:",ce)}else{const{error:ce}=await ne.from("clientes").insert([{nombre:te,rtn:Se,telefono:mt||null,correo_electronico:Et||null,tipo_cliente:"juridico",exonerado:et}]);ce&&console.warn("Error insertando cliente juridico:",ce)}}else{const ie={rtn:Se,nombre:te},{error:he}=await ne.from("clientenatural").upsert(ie,{onConflict:"rtn"});he&&console.warn("Error guardando clientenatural:",he)}}catch(ie){console.warn("Error upsert cliente:",ie)}const ae=await(_i==="cinta"?cp:op)({cliente:te||"Cliente",rtn:Se||""},E,{carrito:l,subtotal:ji(),isvTotal:G,imp18Total:C,impTouristTotal:L,taxRate:m,tax18Rate:x,taxTouristRate:b,total:B,pagos:Pa});if(E==="factura"&&D)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",D);const{error:ie}=await ne.from("cotizaciones").update({estado:"aceptada"}).eq("id",D);if(ie)console.warn("Error marcando cotizacion como facturado (pre-print):",ie);else{console.debug("Cotizacion marcada como facturado (pre-print):",D);try{O(null)}catch{}}}catch(ie){console.warn("Error marcacion pre-print:",ie)}if(E==="factura")try{let ie=null,he=null;try{const ce=localStorage.getItem("user"),ye=ce?JSON.parse(ce):null;he=ye&&(ye.id||ye.user?.id||ye.sub||ye.user_id)?ye.id||ye.user?.id||ye.sub||ye.user_id:null;const be=ye&&(ye.username||ye.user?.username||ye.name||ye.user?.name)?ye.username||ye.user?.username||ye.name||ye.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",ce),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",ye),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",he,"typeof",typeof he),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",be),he){const me=typeof he=="string"&&/^\d+$/.test(he)?Number(he):he;try{const{data:de,error:we}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",me).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(de)&&de.length>0&&(ie=de[0])}catch(de){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",de)}}if(!ie&&be)try{const{data:me,error:de}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",be).order("id",{ascending:!1}).limit(1);!de&&Array.isArray(me)&&me.length>0&&(ie=me[0])}catch(me){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",me)}}catch(ce){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",ce)}await ua({clienteName:te||"Cliente",rtn:Se||null,paymentPayload:Pa,caiData:ie,usuarioId:he})}catch(ie){console.warn("Error insertando venta en flujo cliente normal:",ie)}try{const ie=document.createElement("iframe");ie.style.position="fixed",ie.style.right="0",ie.style.bottom="0",ie.style.width="0",ie.style.height="0",ie.style.border="0",ie.style.overflow="hidden",ie.setAttribute("aria-hidden","true"),document.body.appendChild(ie);const he=ie.contentWindow,ce=ie.contentDocument||ie.contentWindow?.document;if(!ce||!he)try{document.body.removeChild(ie)}catch{}else{ce.open(),ce.write(ae),ce.close();const ye=()=>{try{he.focus(),he.print()}catch(me){console.warn("Error during iframe print (cliente normal):",me)}setTimeout(()=>{try{document.body.removeChild(ie)}catch{}},800)},be=()=>{try{const me=ce.images;if(me&&me.length>0){let de=0;for(let we=0;we<me.length;we++){const Ae=me[we];Ae.complete?de++:(Ae.addEventListener("load",()=>{de++,de===me.length&&ye()}),Ae.addEventListener("error",()=>{de++,de===me.length&&ye()}))}de===me.length&&ye()}else ye()}catch{try{he.addEventListener("load",ye)}catch{}setTimeout(ye,1e3)}};try{ce.readyState==="complete"?be():(he.addEventListener("load",be),setTimeout(be,1500))}catch{setTimeout(be,800)}}}catch(ie){console.warn("Direct print (cliente normal) failed, falling back to new window",ie);const he=window.open("","_blank");he&&(he.document.open(),he.document.write(ae),he.document.close(),setTimeout(()=>{try{he.print(),he.close()}catch{}},800))}await(async()=>{E==="factura"&&(I(),await _s()),E==="cotizacion"&&(A({cliente:te||"Cliente",rtn:Se||null}),ge(!0))})(),se(!1)},[Cn,nn]=j.useState(null),[Ss,ws]=j.useState([]),[Es,Ti]=j.useState(!1),[vr,Va]=j.useState(null);j.useEffect(()=>{fetch("/data-base/inventario.json").then(async H=>{if(!H.ok)return console.warn("inventario.json no disponible, status",H.status),null;const ae=H.headers.get("content-type")||"";if(!ae.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",ae),null;try{return await H.json()}catch(xe){return console.warn("Error parseando inventario.json:",xe),null}}).then(H=>{H&&Array.isArray(H.items)&&ws(H.items),console.log("inventario cargado:",H&&H.items?H.items.length:0)}).catch(H=>{console.warn("Error cargando inventario:",H)})},[]);const br=async()=>{try{const{data:H,error:ae}=await ne.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(ae)throw ae;const xe=Array.isArray(H)?H:[],ie=xe.map(be=>String(be.id));if(ie.length===0){s([]);return}const he={};try{const{data:be,error:me}=await ne.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(me)throw me;if(Array.isArray(be))for(const de of be){const we=String(de.producto_id);he[we]||(he[we]=Number(de.precio||0))}}catch(be){console.warn("Error cargando precios en PV:",be)}let ce={};try{const{data:be,error:me}=await ne.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",ie);if(me)throw me;const de=Array.isArray(be)?be:[];ce={},ie.forEach(we=>ce[we]=0);for(const we of de){const Ae=String(we.producto_id),Le=Number(we.cantidad)||0,ft=String(we.tipo_de_movimiento||"").toUpperCase();ft==="ENTRADA"?ce[Ae]=(ce[Ae]||0)+Le:ft==="SALIDA"&&(ce[Ae]=(ce[Ae]||0)-Le)}}catch(be){console.warn("Error cargando registro_de_inventario en PV:",be),ce={},ie.forEach(me=>ce[me]=0)}const ye=xe.map(be=>({id:String(be.id),sku:be.sku,nombre:be.nombre,categoria:be.categoria,imagen:be.imagen,precio:he[String(be.id)]!==void 0?he[String(be.id)]:be.precio!==void 0?Number(be.precio):0,exento:be.exento===!0||String(be.exento)==="true"||Number(be.exento)===1||!1,aplica_impuesto_18:be.aplica_impuesto_18===!0||String(be.aplica_impuesto_18)==="true"||Number(be.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:be.aplica_impuesto_turistico===!0||String(be.aplica_impuesto_turistico)==="true"||Number(be.aplica_impuesto_turistico)===1||!1,stock:Number((ce[String(be.id)]||0).toFixed(2))}));s(ye)}catch(H){console.warn("Error cargando productos desde inventario:",H),s([])}};j.useEffect(()=>{let H=!0;return br().catch(ae=>{H&&console.warn("refreshProducts error",ae)}),()=>{H=!1}},[]),j.useEffect(()=>{const H=xe=>{try{const ie=xe||(()=>{const ye=localStorage.getItem("cotizacion_to_load");return ye?JSON.parse(ye):null})();if(!ie)return;try{O(ie.header&&ie.header.id?String(ie.header.id):null)}catch{}const ce=(Array.isArray(ie.detalles)?ie.detalles:[]).map(ye=>{const be=a.find(de=>String(de.id)===String(ye.producto_id));return{producto:be?{...be}:{id:String(ye.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:ye.sku??void 0,nombre:ye.descripcion||ye.nombre||"Artculo",precio:Number(ye.precio_unitario||ye.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(ye.cantidad||1)}});ce.length>0&&u(ce);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};H();const ae=xe=>{try{H(xe.detail)}catch{}};return window.addEventListener("cotizacion:load",ae),()=>{window.removeEventListener("cotizacion:load",ae)}},[a]);const[In,zn]=j.useState(null),[Ot,Ht]=j.useState(null),[Hn,xr]=j.useState(null),[_r,$n]=j.useState(null),[Cs,da]=j.useState(!1),[Ai,fa]=j.useState({}),ha=async()=>{try{let H=null;try{const ae=localStorage.getItem("user"),xe=ae?JSON.parse(ae):null;let ie=Hn??(xe&&(xe.id||xe.user?.id||xe.sub||xe.user_id)?xe.id||xe.user?.id||xe.sub||xe.user_id:null);const he=In??(xe&&(xe.username||xe.user?.username||xe.name||xe.user?.name)?xe.username||xe.user?.username||xe.name||xe.user?.name:null),ce=ie!=null&&typeof ie=="string"&&/^\d+$/.test(ie)?Number(ie):ie;if(ce!=null)try{const{data:ye,error:be}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",ce).order("id",{ascending:!1}).limit(1);!be&&Array.isArray(ye)&&ye.length>0&&(H=ye[0])}catch(ye){console.debug("refreshCaiInfo: lookup by usuario_id failed:",ye)}if(!H&&he)try{const{data:ye,error:be}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",he).order("id",{ascending:!1}).limit(1);!be&&Array.isArray(ye)&&ye.length>0&&(H=ye[0])}catch(ye){console.debug("refreshCaiInfo: lookup by cajero failed:",ye)}}catch(ae){console.debug("refreshCaiInfo: error building lookup params",ae)}if(H){$n(H);try{localStorage.setItem("caiInfo",JSON.stringify(H))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",H)}}catch(H){console.debug("refreshCaiInfo: unexpected error",H)}};j.useEffect(()=>{try{const H=localStorage.getItem("user");if(H){const ae=JSON.parse(H);zn(ae.username||ae.name||null),Ht(ae.role||null);let xe=null;try{xe=ae&&(ae.id||ae.user?.id||ae.sub||ae.user_id)?ae.id||ae.user?.id||ae.sub||ae.user_id:null,xr(xe??null),console.debug("PV: localStorage.user parsed:",ae),console.debug("PV: extracted userId for CAI/RPC usage:",xe)}catch(ie){console.debug("PV: error parsing localStorage.user for debug:",ie)}try{const ie=localStorage.getItem("caiInfo");if(ie){const he=JSON.parse(ie);$n(he),console.debug("PV: loaded caiInfo from localStorage:",he),(async()=>{try{if(!(he&&he.rango_de!==void 0&&he.rango_hasta!==void 0&&he.fecha_vencimiento!==void 0&&he.secuencia_actual!==void 0)){const ye=ae&&(ae.username||ae.user?.username||ae.name||ae.user?.name)?ae.username||ae.user?.username||ae.name||ae.user?.name:null,be=xe&&typeof xe=="string"&&/^\d+$/.test(xe)?Number(xe):xe;let me=null;try{if(be!=null){const{data:de,error:we}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",be).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(de)&&de.length>0&&(me=de[0])}}catch(de){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",de)}if(!me&&ye)try{const{data:de,error:we}=await ne.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",ye).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(de)&&de.length>0&&(me=de[0])}catch(de){console.debug("PV: refetch CAI by cajero failed:",de)}if(me){$n(me);try{localStorage.setItem("caiInfo",JSON.stringify(me))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",me)}}}catch(ce){console.debug("PV: error trying to refresh caiInfo:",ce)}})()}}catch(ie){console.debug("PV: error parsing localStorage.caiInfo:",ie)}}}catch{}},[]),j.useEffect(()=>{let H=!0;return(async()=>{try{const{data:ae,error:xe}=await ne.from("impuesto").select("id, impuesto_venta");if(xe)throw xe;if(!ae||!Array.isArray(ae))return;const ie=be=>{const me=ae.find(Ae=>Number(Ae.id)===be);if(!me)return null;const de=me.impuesto_venta;if(de==null)return null;const we=Number(de);return Number.isNaN(we)?null:we>1?we/100:we},he=ie(1),ce=ie(2),ye=ie(3);if(H){let be=he,me=ce,de=ye;try{if((be===null||be===0)&&H){const Ae=(await ne.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Le=Ae==null?null:Number(Ae);Le!=null&&!Number.isNaN(Le)&&(be=Le>1?Le/100:Le)}if((me===null||me===0)&&H){const Ae=(await ne.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Le=Ae==null?null:Number(Ae);Le!=null&&!Number.isNaN(Le)&&(me=Le>1?Le/100:Le)}if((de===null||de===0)&&H){const Ae=(await ne.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Le=Ae==null?null:Number(Ae);Le!=null&&!Number.isNaN(Le)&&(de=Le>1?Le/100:Le)}}catch(we){console.warn("PV: fallback single-id impuesto fetch failed",we)}(be===null||be===0)&&(be=.15),(me===null||me===0)&&(me=.18),(de===null||de===0)&&(de=.04),v(be),_(me),w(de),console.debug("PV: impuestos raw rows",ae),console.debug("PV: resolved tax rates",{taxRate:be,tax18Rate:me,taxTouristRate:de})}}catch(ae){console.warn("Error cargando impuesto en PV:",ae)}})(),()=>{H=!1}},[]);const Ga=H=>{console.log("openUbicacion",H,"entradasCount",Ss.length);let ae=null;try{ae=a.find(ie=>String(ie.sku||"")===String(H)||String(ie.id)===String(H))||null}catch{ae=null}if(ae){const ie=Number(ae.stock??0),he={id:ae.id,producto:ae.nombre||"",sku:ae.sku||"",imagen:ae.imagen||null,descripcion:ae.descripcion||"",ubicacion:ae.ubicacion||null,cantidad:ie};Va(he),Ti(!0);return}const xe=Ss.find(ie=>ie.sku===H)||null;console.log("entrada encontrada",xe),Va(xe),Ti(!0)};if(j.useEffect(()=>{let H=!0;return(async()=>{try{const ae="inventario",xe={};await Promise.all((a||[]).map(async ie=>{const he=ie.imagen;if(!he){xe[String(ie.id)]=null;return}const ce=String(he);if(ce.startsWith("http")){xe[String(ie.id)]=ce;return}let ye=ce;const be=String(ce).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);be&&(ye=decodeURIComponent(be[2]));try{const me=await ne.storage.from(ae).getPublicUrl(ye),de=me?.data?.publicUrl||me?.data?.publicURL||null;if(de){xe[String(ie.id)]=de;return}}catch{}try{const de=(await ne.storage.from(ae).createSignedUrl(ye,604800))?.data?.signedUrl??null;xe[String(ie.id)]=de}catch{xe[String(ie.id)]=null}})),H&&fa(xe)}catch(ae){console.warn("Error resolviendo imgenes en PV",ae)}})(),()=>{H=!1}},[a]),Cn){if(Cn==="DevolucionCaja")return i.jsx(K0,{onBack:()=>nn(null)});if(Cn==="IngresoEfectivo")return i.jsx(Y0,{onBack:()=>nn(null)});if(Cn==="CotizacionesGuardadas")return i.jsx(J0,{onBack:()=>nn(null)});if(Cn==="PedidosEnLinea")return i.jsx(Q0,{onBack:()=>nn(null)});if(Cn==="CorteCajaParcial")return i.jsx(X0,{onBack:()=>nn(null)});if(Cn==="CorteCajaTotal")return i.jsx(Z0,{onBack:()=>nn(null)})}return i.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[i.jsx(ax,{userName:In,userRole:Ot,userId:Hn,caiInfo:_r,onLogout:o,onNavigate:H=>nn(H),onOpenDatosFactura:()=>da(!0),onPrintFormatChange:H=>ca(H),onOpenCajaConfig:()=>En(!0),printFormat:_i}),i.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[i.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:H=>h(H.target.value),onKeyDown:H=>{if(H.key==="Enter"){const ae=String(d||"").trim().toLowerCase();if(!ae)return;const ie=$.find(he=>String(he.sku||"").toLowerCase()===ae)||$[0];if(ie){const he=Number(ie.stock??0),ce=Number(ie.precio??0);he>=1&&ce>0?J(ie):console.debug("No se puede agregar por stock/precio",{id:ie.id,stockNum:he,precioNum:ce})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),i.jsx("select",{value:g,onChange:H=>p(H.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:T.map(H=>i.jsx("option",{value:H,children:H},H))})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:i.jsx(tx,{productos:$,imageUrls:Ai,agregarAlCarrito:J,openUbicacion:Ga,thStyle:px,tdStyle:mx,skuStyle:yx})}),i.jsx(nx,{carrito:l,actualizarCantidad:oe,eliminarDelCarrito:je,vaciarCarrito:I,subtotal:P,perItemTaxes:ve,taxRate:m,tax18Rate:x,taxTouristRate:b,total:B,openSelector:eo,btnStyle:vx})]})]}),i.jsx(lx,{open:Es,selectedEntrada:vr,onClose:()=>{Ti(!1),Va(null)},imageUrls:Ai}),i.jsx(ex,{open:Vt,totalDue:B,exchangeRate:N,onClose:()=>bi(!1),onConfirm:async H=>{if(yr(H),xi(!0),bs)try{xs(!1),await Ci("Consumidor Final","C/F",H)}catch(ae){console.warn("Error facturando despus del pago:",ae)}bi(!1)}}),i.jsx(Ql.Suspense,{fallback:null}),i.jsx(ix,{open:Gt,onClose:()=>En(!1),printFormat:_i,onPrintFormatChange:H=>ca(H),exchangeRate:N,onExchangeRateChange:H=>R(H)}),i.jsx(ox,{open:Z,onClose:()=>ge(!1),onCancel:()=>{ge(!1),A(null)},onSave:async()=>{ge(!1);try{const H=await to(_e||{});H&&O(String(H))}catch(H){console.warn("Error guardando cotizacion desde confirm modal",H)}A(null)}}),i.jsx(cx,{open:ee,onClose:()=>X(!1),doFacturaClienteFinal:wi,doFacturaClienteNormal:Ei,doFacturaClienteJuridico:qn,carritoLength:l.length,subtotal:ji(),taxRate:m,taxableSubtotal:Si()}),i.jsx(ux,{open:F,onClose:()=>se(!1),clienteTipo:Je,clienteRTN:Se,clienteNombre:te,clienteTelefono:mt,clienteCorreo:Et,clienteExonerado:et,clienteSearchOpen:fe,setClienteSearchOpen:H=>k(H),onRTNChange:H=>Ft(H),onNombreChange:H=>pe(H),onTelefonoChange:H=>dt(H),onCorreoChange:H=>It(H),onExoneradoChange:H=>nt(H),onCreateCliente:()=>vi(!0),onCancel:()=>se(!1),onOpenCreateCliente:()=>vi(!0),onOpenPayment:()=>bi(!0),paymentDone:vs,submitClienteNormal:js}),i.jsx(dx,{open:$a,onClose:()=>vi(!1),clienteRTN:Se,clienteNombre:te,clienteTelefono:mt,clienteCorreo:Et,clienteExonerado:et,onChangeRTN:H=>Re(H),onChangeNombre:H=>pe(H),onChangeTelefono:H=>dt(H),onChangeCorreo:H=>It(H),onChangeExonerado:H=>nt(H),onCreate:async()=>{try{if(!te||!Se)return;const{data:H,error:ae}=await ne.from("clientes").select("id").eq("rtn",Se).maybeSingle();if(ae&&console.warn("Error buscando cliente al crear:",ae),H&&H.id){const{error:xe}=await ne.from("clientes").update({nombre:te,telefono:mt||null,correo_electronica:Et||null,tipo_cliente:"juridico",exonerado:et}).eq("id",H.id);xe&&console.warn("Error actualizando cliente al crear:",xe)}else{const{error:xe}=await ne.from("clientes").insert([{nombre:te,rtn:Se,telefono:mt||null,correo_electronica:Et||null,tipo_cliente:"juridico",exonerado:et}]);xe&&console.warn("Error insertando cliente al crear:",xe)}}catch(H){console.warn("Error creando cliente juridico:",H)}vi(!1)}}),i.jsx(sx,{open:Cs,onClose:()=>da(!1),caiInfo:_r,onRefresh:ha})]})}const px={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},mx={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},yx={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},vx={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},up=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function bx({title:o,children:a}){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:o}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function xx(){const[o,a]=j.useState(null);return j.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Ventas (ltimos das)"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Flujo de caja"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Inventario por categora"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Promedios"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):i.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const _x="modulepreload",jx=function(o){return"/"+o},dp={},wn=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var h=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=jx(v),v in dp)return;dp[v]=!0;const x=v.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${_}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":_x,x||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),x)return new Promise((w,N)=>{b.addEventListener("load",w),b.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function lm({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:h="Cancelar"}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),i.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:h}),i.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function Sx(){const[o,a]=j.useState(null),[s,l]=j.useState(!1),[u,d]=j.useState(!1),[h,g]=j.useState({}),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,N]=j.useState(!1),[R,T]=j.useState(null),[$,M]=j.useState(null),[G,C]=j.useState(!1),[L,B]=j.useState(""),[P,ve]=j.useState(""),[J,oe]=j.useState(null),[je,I]=j.useState(null);j.useEffect(()=>{let D=!0;return(async()=>{l(!0);try{const O=(await wn(async()=>{const{default:fe}=await Promise.resolve().then(()=>Sn);return{default:fe}},void 0)).default,{data:F,error:se}=await O.from("empresa").select("*").limit(1).single();if(!D)return;if(se)throw se;if(F){a(F),g(F);try{localStorage.setItem("companyData",JSON.stringify(F))}catch{}l(!1);return}}catch(O){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",O)}try{const O=localStorage.getItem("companyData");if(O){a(JSON.parse(O)),g(JSON.parse(O)),l(!1);return}}catch{}try{const O=await fetch("/data-base/company.json");if(!O.ok)throw new Error("no json");const F=await O.json();if(!D)return;a(F),g(F)}catch{D&&a(null)}finally{D&&l(!1)}})(),()=>{D=!1}},[]),j.useEffect(()=>{o&&g(o)},[o]),j.useEffect(()=>{try{const D=localStorage.getItem("pendingCompanySave");if(D){const O=JSON.parse(D);x(!0),b(O.payload??null),N(!!O.needsLogo)}}catch{}},[]),j.useEffect(()=>{let D=!0;return(async()=>{try{if(!o||!o.logo){D&&oe(null);return}const O=String(o.logo);if(O.startsWith("http")){D&&oe(O);return}const F=(await wn(async()=>{const{default:Se}=await Promise.resolve().then(()=>Sn);return{default:Se}},void 0)).default,se="logo",k=(await F.storage.from(se).getPublicUrl(O))?.data?.publicUrl??null;if(k){D&&oe(k);return}const pe=(await F.storage.from(se).createSignedUrl(O,3600))?.data?.signedUrl??null;if(pe){D&&oe(pe);return}D&&oe(null)}catch(O){console.warn("Error resolving company logo URL",O),D&&oe(null)}})(),()=>{D=!1}},[o?.logo]),j.useEffect(()=>{let D=!0;return(async()=>{try{if(p){D&&I(p);return}const O=h?.logo;if(!O){D&&I(null);return}const F=String(O);if(F.startsWith("http")){D&&I(F);return}const se=(await wn(async()=>{const{default:Re}=await Promise.resolve().then(()=>Sn);return{default:Re}},void 0)).default,fe="logo",te=(await se.storage.from(fe).getPublicUrl(F))?.data?.publicUrl??null;if(te){D&&I(te);return}const Se=(await se.storage.from(fe).createSignedUrl(F,3600))?.data?.signedUrl??null;if(Se){D&&I(Se);return}D&&I(null)}catch(O){console.warn("Error resolving edit logo URL",O),D&&I(null)}})(),()=>{D=!1}},[h?.logo,p]);function ee(){d(!0),g(o||{})}function X(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function E(D){const{name:O,value:F}=D.target;g(se=>({...se,[O]:F}))}function U(D){const O=D.target.files?.[0]??null;if(g(F=>({...F,logoFile:O})),O)try{const F=URL.createObjectURL(O);m(F)}catch{m(null)}else m(null)}function Z(D=!1){const O="logo",F="https://sqwqlvsjtimallidxrsz.supabase.co";if(D){if(p)return p;const k=h?.logo;if(!k)return"/logo192.png";if(String(k).startsWith("http"))return String(k);let te=String(k);return te.startsWith(`${O}/`)&&(te=te.slice(O.length+1)),`${F}/storage/v1/object/public/${O}/${encodeURIComponent(te)}`}if(!o)return"/logo192.png";const se=o.logo;if(!se)return"/logo192.png";if(String(se).startsWith("http"))return String(se);let fe=String(se);return fe.startsWith(`${O}/`)&&(fe=fe.slice(O.length+1)),`${F}/storage/v1/object/public/${O}/${encodeURIComponent(fe)}`}async function ge(){try{const D=(await wn(async()=>{const{default:te}=await Promise.resolve().then(()=>Sn);return{default:te}},void 0)).default,O={...h||{}};let F=null;const se=te=>{if(!te)return null;if(!te.startsWith("http"))return te;const pe=te.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return pe?decodeURIComponent(pe[2]):null},fe=o?.logo??null;try{const te=h&&h.logoFile instanceof File?h.logoFile:null,pe="logo";if(te){const Re=`logo/${O.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${te.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,De=await D.storage.from(pe).upload(Re,te,{upsert:!0});if(De.error)throw De.error;const qe=De.data?.path??Re;F=qe,O.logo=qe}}catch(te){console.warn("Logo upload error",te)}try{O.logoFile&&delete O.logoFile}catch{}let k=null;try{if(o&&o.id){const{data:te,error:pe}=await D.from("empresa").update(O).eq("id",o.id).select("*");if(pe)throw pe;k=Array.isArray(te)?te[0]??null:te}else{const{data:te,error:pe}=await D.from("empresa").insert(O).select("*");if(pe)throw pe;k=Array.isArray(te)?te[0]??null:te}try{if(F){const te=se(fe);if(te&&te!==F){const Se=await D.storage.from("logo").remove([te]);Se.error&&console.warn("Failed to remove old company logo after DB update",Se.error)}}}catch(te){console.warn("Error removing old logo after DB success",te)}}catch(te){try{if(F){const Se=await D.storage.from("logo").remove([F]);Se.error&&console.warn("Failed to remove uploaded logo after DB error",Se.error)}}catch(pe){console.warn("Error cleaning uploaded logo after DB failure",pe)}throw te}a(k),g(k);try{console.debug("Empresa guardada, logo field:",k?.logo)}catch{}try{M(k?.logo??null)}catch{}try{B("Datos guardados"),ve("Los datos de la empresa se guardaron correctamente."),C(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(k))}catch{}d(!1)}catch(D){console.error("Error guardando empresa en Supabase",D);try{T(D?.message||String(D))}catch{}try{const O={...h||{}};O.logoFile&&delete O.logoFile;const F=!!(h&&h.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:O,needsLogo:F,ts:Date.now()})),x(!0),b(O),N(F),a(h);try{localStorage.setItem("companyData",JSON.stringify(h))}catch{}d(!1),B("Guardado localmente"),ve("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),C(!0)}catch(O){console.error("Error saving locally",O)}}}async function _e(){const D=_;if(!D){B("Sin pendientes"),ve("No hay datos pendientes para enviar"),C(!0);return}try{const O=(await wn(async()=>{const{default:se}=await Promise.resolve().then(()=>Sn);return{default:se}},void 0)).default;let F=null;if(D.id){const{data:se,error:fe}=await O.from("empresa").update(D).eq("id",D.id).select("*");if(fe)throw fe;F=Array.isArray(se)?se[0]??null:se}else{const{data:se,error:fe}=await O.from("empresa").insert(D).select("*");if(fe)throw fe;F=Array.isArray(se)?se[0]??null:se}localStorage.removeItem("pendingCompanySave"),x(!1),b(null),N(!1),a(F),g(F),B("Sincronizado"),ve("Los datos pendientes se sincronizaron con Supabase correctamente."),C(!0)}catch(O){console.error("Error reenviando datos pendientes",O),B("Error al reenviar"),ve("No se pudo reenviar los datos a Supabase: "+(O?.message||String(O))),C(!0)}}function A(){try{localStorage.removeItem("pendingCompanySave"),x(!1),b(null),N(!1),B("Pendiente descartado"),ve("El guardado pendiente fue descartado."),C(!0)}catch{}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?i.jsx("div",{children:"Cargando datos de la empresa..."}):o?i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?i.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",R?i.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(R)]}):null,w?i.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("button",{className:"btn-primary",onClick:_e,children:"Reintentar guardar en Supabase"}),i.jsx("button",{className:"btn-opaque",onClick:A,children:"Descartar pendiente"})]})]})}):null,$?i.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[i.jsx("strong",{children:"Logo guardado:"}),i.jsxs("div",{style:{marginTop:6},children:[i.jsx("a",{href:Z(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),i.jsx("div",{style:{color:"#374151",fontSize:12},children:String($)})]})]}):null,i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:i.jsx("img",{src:u?je??Z(!0):J??Z(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),i.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"RTN:"})," ",u?i.jsx("input",{name:"rtn",value:h.rtn||"",onChange:E,className:"input"}):o.rtn]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Telfono:"})," ",u?i.jsx("input",{name:"telefono",value:h.telefono||"",onChange:E,className:"input"}):o.telefono]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Correo:"})," ",u?i.jsx("input",{name:"email",value:h.email||"",onChange:E,className:"input"}):o.email]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Direccin:"})," ",u?i.jsx("textarea",{name:"direccion",value:h.direccion||"",onChange:E,className:"input",style:{minHeight:64}}):o.direccion]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Logo (archivo o URL):"}),u?i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[i.jsx("input",{type:"file",accept:"image/*",onChange:U}),i.jsx("input",{name:"logo",value:h.logo||"",onChange:E,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):i.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?i.jsxs("div",{style:{marginTop:8},children:[i.jsx("small",{children:"Preview:"}),i.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:ge,className:"btn-primary",children:"Guardar"}),i.jsx("button",{type:"button",onClick:X,className:"btn-opaque",children:"Cancelar"})]}):i.jsx(i.Fragment,{children:i.jsx("button",{type:"button",onClick:ee,className:"btn-primary",children:"Actualizar datos"})})})]}),i.jsx("div",{style:{flex:1,minWidth:320},children:i.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:i.jsx("img",{src:u?je??Z(!0):J??Z(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),i.jsxs("p",{style:{margin:0},children:["RTN: ",i.jsx("strong",{children:o.rtn})]}),i.jsxs("p",{style:{margin:0},children:["Telfono: ",i.jsx("strong",{children:o.telefono})]}),i.jsxs("p",{style:{marginTop:8},children:["Correo: ",i.jsx("strong",{children:o.email})]}),i.jsxs("p",{style:{marginTop:8},children:["Direccin: ",i.jsx("strong",{children:o.direccion})]})]})})]}):i.jsx("div",{children:"No se encontraron datos de la empresa."}),i.jsx(lm,{open:G,title:L,message:P,onClose:()=>C(!1)})]})}function wx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function Ex(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[_,b]=j.useState(""),[w,N]=j.useState(null),[R,T]=j.useState(""),[$,M]=j.useState(""),[G,C]=j.useState("");async function L(){l(!0),d(null);try{const{data:I,error:ee}=await ne.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(ee)throw ee;a(Array.isArray(I)?I:[])}catch(I){d(I?.message||String(I)),a([])}finally{l(!1)}}async function B(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const I={username:p,password:v,role:"cajero"};_&&(I.nombre_usuario=_);const{error:ee}=await ne.from("users").insert(I);if(ee)throw ee;m(""),x(""),b(""),await L()}catch(I){d(I?.message||String(I))}finally{l(!1)}}function P(I){N(I.id),T(I.username||""),C(I.nombre_usuario||""),M(""),d(null)}function ve(){N(null),T(""),M(""),C(""),d(null)}async function J(){if(w!=null){if(!R)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const I={username:R};$&&(I.password=$),I.nombre_usuario=G||null;const{error:ee}=await ne.from("users").update(I).eq("id",w);if(ee)throw ee;ve(),await L()}catch(I){d(I?.message||String(I))}finally{l(!1)}}}async function oe(I,ee){if(ee!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:X}=await ne.from("users").delete().eq("id",I);if(X)throw X;await L()}catch(X){d(X?.message||String(X))}finally{l(!1)}}}j.useEffect(()=>{let I=!0;return(async()=>I&&await L())(),()=>{I=!1}},[]);const je=o.filter(I=>{if(!h)return!0;const ee=h.toLowerCase();return(I.username||"").toLowerCase().includes(ee)||(String(I.id)||"").includes(ee)||(I.role||"").toLowerCase().includes(ee)||(I.nombre_usuario||"").toLowerCase().includes(ee)});return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[i.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:h,onChange:I=>g(I.target.value),style:{minWidth:220}}),i.jsx("button",{onClick:()=>L(),className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${je.length} usuarios`}),i.jsx("div",{style:{width:"100%",height:8}}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:I=>m(I.target.value)}),i.jsx("input",{placeholder:"Nombre",className:"input",value:_,onChange:I=>b(I.target.value)}),i.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:I=>x(I.target.value)}),i.jsx("button",{onClick:()=>B(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?i.jsx("div",{style:{color:"red",marginBottom:12},children:u}):i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Rol"})]})}),i.jsx("tbody",{children:je.map(I=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:I.id}),i.jsx("td",{style:{minWidth:180},children:w===I.id?i.jsx("input",{className:"input",value:R,onChange:ee=>T(ee.target.value)}):I.username||"-"}),i.jsx("td",{style:{minWidth:180},children:w===I.id?i.jsx("input",{className:"input",value:G,onChange:ee=>C(ee.target.value)}):I.nombre_usuario||"-"}),i.jsx("td",{style:{width:220},children:w===I.id?i.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:$,onChange:ee=>M(ee.target.value)}):I.role||"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:w===I.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>J(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),i.jsx("button",{onClick:()=>ve(),className:"btn-opaque",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>P(I),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),I.role==="cajero"?i.jsx("button",{onClick:()=>oe(I.id,I.role),className:"btn-danger",children:"Eliminar"}):i.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},I.id))})]}),je.length===0&&!s&&i.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function Cx({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:h}){const[g,p]=j.useState(null),[m,v]=j.useState(null),[x,_]=j.useState(!1),[b,w]=j.useState(null),[N,R]=j.useState(""),[T,$]=j.useState(""),[M,G]=j.useState(""),[C,L]=j.useState(""),[B,P]=j.useState(null),[ve,J]=j.useState(""),[oe,je]=j.useState(!1),[I,ee]=j.useState(null);if(j.useEffect(()=>{if(!o||!s)return;w(s.caja??null),R(s.cai??""),J(s.identificador??""),$(s.rango_de??""),G(s.rango_hasta??""),L(s.fecha_vencimiento??""),P(s.secuencia_actual??null);const E=s.cajero??null;if(E){const U=l.find(Z=>Z.username===E||Z.nombre_usuario===E);U?(p(U.id),v(null),_(!1)):(p(null),v(E),_(!0))}else p(null),v(null),_(!1);ee(null)},[o,s,l]),!o||!s)return null;async function X(){if(!s){ee("Registro invlido");return}if(b!=null&&(b<1||b>5)){ee("La caja debe estar entre 1 y 5");return}je(!0),ee(null);try{const E={cai:N??null,identificador:ve??null,rango_de:T??null,rango_hasta:M??null,fecha_vencimiento:C??null,secuencia_actual:B??null,caja:b??null};if(g!=null){const U=l.find(Z=>Z.id===g);E.cajero=U?U.username:null,E.usuario_id=U?U.id:null}else E.cajero=m??null,E.usuario_id=null;await h(s.id,E),a()}catch(E){ee(E?.message||String(E))}finally{je(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:N,onChange:E=>R(E.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:ve,onChange:E=>J(E.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:T,onChange:E=>$(E.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:M,onChange:E=>G(E.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:C,onChange:E=>L(E.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:B??"",onChange:E=>P(E.target.value===""?null:E.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):x?"__custom__":"",onChange:E=>{const U=E.target.value;U===""?(p(null),v(null),_(!1)):U==="__custom__"?(p(null),_(!0)):/^\d+$/.test(U)&&(p(Number(U)),v(null),_(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(E=>i.jsxs("option",{value:String(E.id),children:[E.username,E.nombre_usuario?`  ${E.nombre_usuario}`:""]},E.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),x&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:E=>{v(E.target.value),p(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:E=>w(E.target.value===""?null:Number(E.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(E=>i.jsx("option",{value:E,children:E},E))]})]})]})]})]}),I&&i.jsx("div",{style:{color:"red",marginTop:12},children:I}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:oe,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:X,disabled:oe,style:{width:"auto",padding:"8px 14px"},children:oe?"Guardando...":"Guardar"})]})]})})}function Tx({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[h,g]=j.useState(null),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,N]=j.useState(""),[R,T]=j.useState(""),[$,M]=j.useState(""),[G,C]=j.useState(""),[L,B]=j.useState(null),[P,ve]=j.useState(""),[J,oe]=j.useState(!1),[je,I]=j.useState(null);if(!o)return null;async function ee(){const X=[];if(w||X.push("CAI"),R||X.push("Rango Desde"),$||X.push("Rango Hasta"),G||X.push("Fecha de Vencimiento"),_==null&&X.push("Caja"),h==null&&!p&&X.push("Cajero"),X.length>0){I(`Campos obligatorios faltantes: ${X.join(", ")}`);return}if(_!=null&&(_<1||_>5)){I("La caja debe estar entre 1 y 5");return}oe(!0),I(null);try{const E={cai:w??null,identificador:P??null,rango_de:R??null,rango_hasta:$??null,fecha_vencimiento:G??null,secuencia_actual:L??null,caja:_??null};if(h!=null){const U=s.find(Z=>Z.id===h);E.cajero=U?U.username:null,E.usuario_id=U?U.id:null}else E.cajero=p??null,E.usuario_id=null;await d(E),a()}catch(E){I(E?.message||String(E))}finally{oe(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:w,onChange:X=>N(X.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:P,onChange:X=>ve(X.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:R,onChange:X=>T(X.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:$,onChange:X=>M(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:G,onChange:X=>C(X.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:L??"",onChange:X=>B(X.target.value===""?null:X.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:h!=null?String(h):v?"__custom__":"",onChange:X=>{const E=X.target.value;E===""?(g(null),m(null),x(!1)):E==="__custom__"?(g(null),x(!0)):/^\d+$/.test(E)&&(g(Number(E)),m(null),x(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(X=>i.jsxs("option",{value:String(X.id),children:[X.username,X.nombre_usuario?`  ${X.nombre_usuario}`:""]},X.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:X=>{m(X.target.value),g(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:_??"",onChange:X=>b(X.target.value===""?null:Number(X.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(X=>i.jsx("option",{value:X,children:X},X))]})]})]})]})]}),je&&i.jsx("div",{style:{color:"red",marginTop:12},children:je}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:J,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:ee,disabled:J,style:{width:"auto",padding:"8px 14px"},children:J?"Creando...":"Crear"})]})]})})}function Ax(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(!1);async function w(){l(!0),d(null);try{const{data:C,error:L}=await ne.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(C)?C:[])}catch(C){d(C?.message||String(C)),a([])}finally{l(!1)}}async function N(){try{const{data:C}=await ne.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(C)?C:[])}catch{}}j.useEffect(()=>{w(),N()},[]);const R=new Set(o.filter(C=>C.cajero).map(C=>String(C.cajero))),T=new Set(o.filter(C=>C.caja!=null).map(C=>Number(C.caja)));function $(C){m(C),x(!0),d(null)}function M(){x(!1),m(null)}async function G(C,L){l(!0),d(null);try{const{error:B}=await ne.from("cai").update(L).eq("id",C);if(B)throw B;await w()}catch(B){throw d(B?.message||String(B)),B}finally{l(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"CAI"}),i.jsx("th",{children:"Identificador"}),i.jsx("th",{children:"Rango Desde"}),i.jsx("th",{children:"Rango Hasta"}),i.jsx("th",{children:"Vencimiento"}),i.jsx("th",{children:"Secuencia actual"}),i.jsx("th",{children:"Cajero"}),i.jsx("th",{children:"Usuario ID"}),i.jsx("th",{children:"Caja"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(C=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:C.id}),i.jsx("td",{style:{minWidth:200},children:C.cai}),i.jsx("td",{style:{minWidth:160},children:C.identificador??"-"}),i.jsx("td",{children:C.rango_de}),i.jsx("td",{children:C.rango_hasta}),i.jsx("td",{children:C.fecha_vencimiento}),i.jsx("td",{children:C.secuencia_actual??"-"}),i.jsx("td",{style:{minWidth:180},children:C.cajero||"-"}),i.jsx("td",{style:{minWidth:160},children:C.usuario_id??"-"}),i.jsx("td",{style:{width:120},children:C.caja??"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx(i.Fragment,{children:i.jsx("button",{onClick:()=>$(C),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},C.id))})]}),o.length===0&&!s&&i.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),i.jsx(Cx,{open:v,onClose:M,row:p,cajeros:h,availableCajeros:p?h.filter(C=>!R.has(C.username)||C.username===p.cajero):h.filter(C=>!R.has(C.username)),availableCajas:p?[1,2,3,4,5].filter(C=>!T.has(C)||C===p.caja):[1,2,3,4,5].filter(C=>!T.has(C)),onSave:G}),i.jsx(Tx,{open:_,onClose:()=>b(!1),cajeros:h,availableCajeros:h.filter(C=>!R.has(C.username)),availableCajas:[1,2,3,4,5].filter(C=>!T.has(C)),onCreate:async C=>{l(!0),d(null);try{const{error:L}=await ne.from("cai").insert(C);if(L)throw L;await w(),b(!1)}catch(L){throw d(L?.message||String(L)),L}finally{l(!1)}}})]})}function Nx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function Rx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),i.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Vu=hp();function Ox({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,h]=Ql.useState(!1);if(!o)return null;const g=async()=>{try{h(!0),await u()}finally{h(!1)}};return Vu.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("p",{children:s}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),i.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function kx({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[h,g]=j.useState({}),[p,m]=j.useState(!1),[v,x]=j.useState(null);if(j.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?x(l.imagen):x(null)},[l,o]),!o)return null;const _=(R,T)=>{g($=>({...$,[R]:T}))},b=async R=>{R.preventDefault();try{m(!0),await d(h)}finally{m(!1)}},w=R=>R==="creado_en"?null:R==="id"?i.jsx("input",{className:"input",value:h[R]??"",readOnly:!0}):R.includes("publicacion")||R.includes("exento")||R.includes("aplica_impuesto")||R==="publicacion_web"?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("label",{className:"switch",children:[i.jsx("input",{type:"checkbox",checked:!!h[R],onChange:T=>_(R,T.target.checked)}),i.jsx("span",{className:"slider"})]}),i.jsx("span",{style:{fontSize:13},children:h[R]?"S":"No"})]}):R.includes("categoria")||R.includes("marca")?i.jsx("input",{type:"text",className:"input",value:h[R]??"",onChange:T=>_(R,T.target.value===""?null:T.target.value)}):R==="imagen"?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?i.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,i.jsx("input",{type:"file",accept:"image/*",onChange:T=>{const $=T.target.files&&T.target.files[0];if(_(R,$??null),$)try{const M=URL.createObjectURL($);x(M)}catch{x(null)}else x(null)}}),v?i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{_(R,null),x(null)},children:"Eliminar imagen"}):null]}):i.jsx("input",{className:"input",value:h[R]??"",onChange:T=>_(R,T.target.value)}),N=i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsxs("form",{onSubmit:b,children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(R=>i.jsxs("label",{style:{display:"block"},children:[i.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(R).replace(/_/g," ").toUpperCase()}),w(R)]},R))}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Vu.createPortal(N,typeof document<"u"&&document.body||document.createElement("div"))}function zx({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const h=a||{},[g,p]=j.useState(null),[m,v]=j.useState(null),[x,_]=j.useState(null),[b,w]=j.useState(null);return j.useEffect(()=>{let N=!0;return(async()=>{const T=typeof h.imagen=="string"?h.imagen:null;if(!T){N&&p(null);return}if(T.startsWith("http")){N&&(p(T),_(T));return}let $=T;const M=String(T).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);M&&($=decodeURIComponent(M[2]));const G="inventario";try{const C=(await wn(async()=>{const{default:J}=await Promise.resolve().then(()=>Sn);return{default:J}},void 0)).default,L=await C.storage.from(G).getPublicUrl($),B=L?.data?.publicUrl||L?.data?.publicURL||null;if(B){N&&(p(B),_(B));return}const P=await C.storage.from(G).createSignedUrl($,3600*24*7);if(P.error){console.warn("ProductDetailModal createSignedUrl error",P.error),N&&p(null);return}const ve=P.data?.signedUrl??null;N&&(p(ve),_(ve))}catch(C){console.error("ProductDetailModal resolve error",C),N&&p(null)}})(),()=>{N=!1}},[h]),j.useEffect(()=>{let N=!0;return(async()=>{if(w(null),!!x)try{const T=await fetch(x,{method:"HEAD"});if(!N)return;w(`HEAD ${T.status} ${T.statusText} - content-type: ${T.headers.get("content-type")}`)}catch(T){if(!N)return;w(`FETCH_ERROR: ${String(T)}`)}})(),()=>{N=!1}},[x]),Vu.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:s}),i.jsxs("div",{style:{display:"flex",gap:18},children:[i.jsx("div",{style:{flex:1},children:i.jsx("table",{style:{width:"100%"},children:i.jsx("tbody",{children:Object.keys(h).map(N=>{const R=h[N];return N==="imagen"&&typeof R=="string"?null:i.jsxs("tr",{children:[i.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(N).replace(/_/g," ").toUpperCase()}),i.jsx("td",{style:{padding:6},children:String(R??"-")})]},N)})})})}),i.jsx("div",{style:{width:280,textAlign:"center"},children:g?i.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:N=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?i.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[i.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),i.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):i.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(h),children:"Editar"}),i.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(h.id),children:"Eliminar"}),i.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function Ux({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:h,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:x=[]}){const[_,b]=j.useState(null),[w,N]=j.useState(!1),[R,T]=j.useState(null),[$,M]=j.useState(""),[G,C]=j.useState(!1),[L,B]=j.useState("add"),[P,ve]=j.useState({}),[J,oe]=j.useState(!1),[je,I]=j.useState(null),[ee,X]=j.useState(!1),[E,U]=j.useState(null),Z=j.useRef(!0),ge=async()=>{N(!0),T(null);try{const fe=(await wn(async()=>{const{default:Se}=await Promise.resolve().then(()=>Sn);return{default:Se}},void 0)).default,k=a||"*";let te=fe.from(o).select(k).limit(l);h&&(Array.isArray(h)?h:String(h).split(",").map(Re=>Re.trim()).filter(Boolean)).forEach(Re=>{const De=Re.split(" ").map(pt=>pt.trim()).filter(Boolean),qe=De[0],Je=De[1]?De[1].toLowerCase():"asc";te=te.order(qe,{ascending:Je!=="desc"})}),g&&Object.entries(g).forEach(([Se,Re])=>{Re==null||Re===""||(te=te.eq(Se,Re))});const pe=await te;if(console.debug("SupabaseTable fetch result for",o,pe),!Z.current)return;if(pe.error)throw pe.error;b(Array.isArray(pe.data)?pe.data:[])}catch(fe){console.error("SupabaseTable error",fe),T(fe?.message||String(fe)),b([])}finally{Z.current&&N(!1)}};j.useEffect(()=>(Z.current=!0,ge(),()=>{Z.current=!1}),[o,a,l]);const _e=j.useMemo(()=>u&&u.length>0?u:!_||_.length===0?[]:Object.keys(_[0]),[u,_]),A=j.useMemo(()=>{if(!_)return null;const fe=($||"").toString().trim().toLowerCase();if(!fe)return _;const k=d&&d.length>0?d:_e;return _.filter(te=>k.some(pe=>{const Se=te?.[pe];return Se==null?!1:String(Se).toLowerCase().includes(fe)}))},[_,$,d,_e]),D=()=>{p&&(B("add"),ve({}),C(!0))},O=fe=>{m&&(B("edit"),ve(fe),C(!0))},F=async fe=>{const k=(await wn(async()=>{const{default:te}=await Promise.resolve().then(()=>Sn);return{default:te}},void 0)).default;try{const te="inventario",pe={...fe},Se=L==="edit"?P?.imagen??null:null,Re=De=>{if(!De)return null;if(!De.startsWith("http"))return De;const qe=De.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return qe?decodeURIComponent(qe[2]):null};if(pe.imagen&&pe.imagen instanceof File){const De=pe.imagen,qe=pe.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Je=`${o}/${qe}/${Date.now()}_${De.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,pt=await k.storage.from(te).upload(Je,De,{upsert:!0});if(pt.error)throw pt.error;const mt=pt.data?.path??Je;pe.imagen=mt;try{const dt=Re(Se);if(dt&&dt!==mt){const Et=await k.storage.from(te).remove([dt]);Et.error&&console.warn("Failed to remove old image",Et.error)}}catch(dt){console.warn("Error removing old image",dt)}}if(L==="edit"&&(pe.imagen==null||pe.imagen===""))try{const De=Re(P?.imagen??null);if(De){const qe=await k.storage.from(te).remove([De]);qe.error&&console.warn("Failed to remove old image on clear",qe.error)}}catch(De){console.warn("Error removing old image on clear",De)}if(L==="add"){const{error:De}=await k.from(o).insert([pe]);if(De)throw De}else{const De=pe.id,qe={...pe};delete qe.id;const{error:Je}=await k.from(o).update(qe).eq("id",De);if(Je)throw Je}C(!1),await ge()}catch(te){console.error("Error saving",te),T(te?.message||String(te))}},se=async()=>{if(je==null)return;const fe=(await wn(async()=>{const{default:k}=await Promise.resolve().then(()=>Sn);return{default:k}},void 0)).default;try{if(!v)return;try{const te="inventario",pe=_?.find(qe=>qe.id===je),Se=qe=>{if(!qe)return null;if(!qe.startsWith("http"))return qe;const Je=qe.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Je?decodeURIComponent(Je[2]):null},Re=pe?.imagen??null,De=Se(Re);if(De){const qe=await fe.storage.from(te).remove([De]);qe.error&&console.warn("Failed to remove image on delete",qe.error)}}catch(te){console.warn("Error removing image before delete",te)}const{error:k}=await fe.from(o).delete().eq("id",je);if(k)throw k;oe(!1),I(null),await ge()}catch(k){console.error("Error deleting",k),T(k?.message||String(k))}};return i.jsxs("div",{style:{padding:18},children:[s?i.jsx("h2",{style:{marginTop:0},children:s}):null,i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("input",{placeholder:"Buscar...",value:$,onChange:fe=>M(fe.target.value),className:"input",style:{minWidth:240}}),i.jsx("button",{onClick:()=>{T(null),M(""),ge()},className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto"},children:i.jsx("button",{onClick:D,className:"btn-primary",children:"Agregar"})})]}),w&&i.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),R&&i.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",R]}),!w&&_&&_.length===0&&i.jsxs("div",{children:["No hay registros en la tabla ",i.jsx("strong",{children:o}),"."]}),!w&&A&&A.length>0&&i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[_e.map(fe=>i.jsx("th",{children:String(fe).replace(/_/g," ").toUpperCase()},fe)),i.jsx("th",{style:{width:140},children:"Acciones"})]})}),i.jsx("tbody",{children:A.map((fe,k)=>i.jsxs("tr",{children:[_e.map(te=>{if(te==="imagen"){const pe=fe?.imagen??null;return pe||console.debug("SupabaseTable: row has no imagen for id",fe?.id,fe),i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:pe?i.jsx(om,{src:String(pe)}):i.jsx("span",{style:{color:"#6b7280"},children:"-"})},te)}return i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:Dx(fe[te])},te)}),i.jsx("td",{className:"admin-actions",children:i.jsx("button",{className:"btn-opaque",onClick:()=>{U(fe),X(!0)},children:"Ver"})})]},fe.id??k))})]})}),i.jsx(kx,{open:G,title:L==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:_e.filter(fe=>!x.includes(fe)),initialData:P,onClose:()=>C(!1),onSave:F}),i.jsx(zx,{open:ee,data:E,title:`Detalle de ${o}`,onClose:()=>X(!1),onEdit:fe=>{X(!1),O(fe)},onDeleteClick:fe=>{X(!1),I(fe),oe(!0)}}),i.jsx(Ox,{open:J,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>oe(!1),onConfirm:se})]})}function Dx(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return i.jsx(om,{src:o})}return String(o)}function om({src:o}){const[a,s]=j.useState(null),[l,u]=j.useState(null);return j.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await wn(async()=>{const{default:N}=await Promise.resolve().then(()=>Sn);return{default:N}},void 0)).default,v="inventario",x=await m.storage.from(v).getPublicUrl(g),_=x?.data?.publicUrl||x?.data?.publicURL||null;if(_){d&&s(_);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const w=b.data?.signedUrl??null;d&&s(w)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?i.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:i.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function Bx(){const[o,a]=j.useState(null),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]);return j.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await wn(async()=>{const{default:B}=await Promise.resolve().then(()=>Sn);return{default:B}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],N=new Set(w.map(B=>B.categoria??"").filter(Boolean)),R=new Set(w.map(B=>B.marca??"").filter(Boolean)),T=w.length,$=w.filter(B=>!!B.publicacion_web).length,M=B=>{if(B==null)return!1;if(typeof B=="boolean")return B===!0;if(typeof B=="number")return B===1;const P=String(B).toLowerCase().trim();return P==="1"||P==="true"||P==="t"||P==="si"||P==="s"||P==="yes"},G=w.filter(B=>M(B.exento)).length,C=w.filter(B=>M(B.aplica_impuesto_18)).length,L=w.filter(B=>M(B.aplica_impuesto_turistico)).length;a({categorias:N.size,marcas:R.size,items:T,publicadas:$,exentos:G,aplica_impuesto_18:C,aplica_impuesto_turistico:L}),g(Array.from(N).sort()),m(Array.from(R).sort())}catch(_){console.error("Error loading inventario summary",_)}})(),()=>{v=!1}},[]),i.jsxs("div",{children:[i.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[i.jsx(fi,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),i.jsx(fi,{label:"Marcas",value:o?String(o.marcas):"..."}),i.jsx(fi,{label:"Items",value:o?String(o.items):"..."}),i.jsx(fi,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),i.jsx(fi,{label:"Exentos",value:o?String(o.exentos):"..."}),i.jsx(fi,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),i.jsx(fi,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),i.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),h.map(v=>i.jsx("option",{value:v,children:v},v))]})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),i.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),p.map(v=>i.jsx("option",{value:v,children:v},v))]})]}),i.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),i.jsx(Ux,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function fi({label:o,value:a}){return i.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),i.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function Lx({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,h]=j.useState(null),[g,p]=j.useState(""),[m,v]=j.useState(!1),[x,_]=j.useState(null),[b,w]=j.useState(null),[N,R]=j.useState(null),[T,$]=j.useState(null),[M,G]=j.useState(null),[C,L]=j.useState(null),[B,P]=j.useState(null),[ve,J]=j.useState(null),[oe,je]=j.useState(null),[I,ee]=j.useState(!1);j.useEffect(()=>{o&&(h(null),p(""),w(null),R(null),$(null),J(null),je(null),_(null))},[o]);async function X(){const U=[];if(d||U.push("Producto"),g||U.push("Precio"),U.length>0){_(`Faltan campos: ${U.join(", ")}`);return}const Z=Number(g);if(isNaN(Z)||Z<0){_("Precio invlido");return}v(!0),_(null);try{await u({producto_id:d,precio:g});try{const ge={};if(M!==null&&(ge.exento=M),C!==null&&(ge.aplica_impuesto_18=C),B!==null&&(ge.aplica_impuesto_turistico=B),Object.keys(ge).length>0){const{error:_e}=await ne.from("inventario").update(ge).eq("id",d);_e&&console.warn("Error actualizando inventario flags:",_e)}}catch(ge){console.warn("Error al persistir flags en inventario:",ge)}a()}catch(ge){_(ge?.message||String(ge))}finally{v(!1)}}function E(U){return U?Number(U.replace(",",".")):NaN}return j.useEffect(()=>{let U=!0;async function Z(){if(w(null),R(null),$(null),J(null),je(null),!d)return;const ge=E(g);if(!isNaN(ge)){ee(!0);try{const{data:_e,error:A}=await ne.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(A)throw A;const D=Array.isArray(_e)?_e.map(et=>Number(et.costo_unitario)).filter(et=>!isNaN(et)):[],O=D.length>0?D.reduce((et,nt)=>et+nt,0)/D.length:0;if(!U)return;w(O);let F=!1,se=!1,fe=!1;try{const{data:et,error:nt}=await ne.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!nt&&et&&(F=!!et.exento,se=!!et.aplica_impuesto_18,fe=!!et.aplica_impuesto_turistico,M===null&&G(F),C===null&&L(se),B===null&&P(fe))}catch{}const{data:k}=await ne.from("impuesto").select("id, impuesto_venta"),te={};Array.isArray(k)&&k.forEach(et=>{te[String(et.id)]=Number(et.impuesto_venta)});const pe=M!==null?M:F,Se=C!==null?C:se,Re=B!==null?B:fe;let De=0;pe?De=0:Se?De=te[2]??te[1]??0:De=te[1]??0;let qe=0;Re&&(qe=te[3]??0);const Je=(De||0)+(qe||0),pt=Je>1?Je/100:Je,mt=ge*pt;R(Je),$(mt);const dt=ge-O,Et=O>0?dt/O*100:null;J(Et);const It=ge>0?(ge-O-mt)/ge*100:null;je(It)}catch{}finally{U&&ee(!1)}}}return Z(),()=>{U=!1}},[d,g,M,C,B]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:d??"",onChange:U=>h(U.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(U=>i.jsx("option",{value:U.id,children:U.nombre},U.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!M,onChange:U=>G(U.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!C,onChange:U=>L(U.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!B,onChange:U=>P(U.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:g,onChange:U=>p(U.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:T==null?"":T.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:ve==null?"":ve.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:oe==null?"":oe.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&i.jsx("div",{style:{color:"red",marginTop:12},children:x}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:X,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function Mx({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[h,g]=j.useState(null),[p,m]=j.useState(""),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,N]=j.useState(null),[R,T]=j.useState(null),[$,M]=j.useState(null),[G,C]=j.useState(null),[L,B]=j.useState(null),[P,ve]=j.useState(null),[J,oe]=j.useState(null),[je,I]=j.useState(null),[ee,X]=j.useState(!1);j.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const Z=Number(s.precio);m(isNaN(Z)?String(s.precio):Z.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function E(Z){return Z?Number(Z.replace(",",".")):NaN}if(j.useEffect(()=>{let Z=!0;async function ge(){if(N(null),T(null),M(null),oe(null),I(null),!o||!s||!h)return;const _e=E(p);if(!isNaN(_e)){X(!0);try{const{data:A,error:D}=await ne.from("compras_detalle").select("costo_unitario").eq("producto_id",h);if(D)throw D;const O=Array.isArray(A)?A.map(nt=>Number(nt.costo_unitario)).filter(nt=>!isNaN(nt)):[],F=O.length>0?O.reduce((nt,$a)=>nt+$a,0)/O.length:0;if(!Z)return;N(F);let se=!1,fe=!1,k=!1;try{const{data:nt,error:$a}=await ne.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",h).single();!$a&&nt&&(se=!!nt.exento,fe=!!nt.aplica_impuesto_18,k=!!nt.aplica_impuesto_turistico,G===null&&C(se),L===null&&B(fe),P===null&&ve(k))}catch{}const{data:te}=await ne.from("impuesto").select("id, impuesto_venta"),pe={};Array.isArray(te)&&te.forEach(nt=>pe[String(nt.id)]=Number(nt.impuesto_venta));const Se=G!==null?G:se,Re=L!==null?L:fe,De=P!==null?P:k;let qe=0;Se?qe=0:Re?qe=pe[2]??pe[1]??0:qe=pe[1]??0;let Je=0;De&&(Je=pe[3]??0);const pt=(qe||0)+(Je||0),mt=pt>1?pt/100:pt,dt=_e*mt;T(pt),M(dt);const Et=_e-F,It=F>0?Et/F*100:null;oe(It);const et=_e>0?(_e-F-dt)/_e*100:null;I(et)}catch{}finally{Z&&X(!1)}}}return ge(),()=>{Z=!1}},[o,s,h,p,G,L,P]),!o||!s)return null;async function U(){const Z=[];if(h||Z.push("Producto"),p||Z.push("Precio"),Z.length>0){b(`Faltan campos: ${Z.join(", ")}`);return}const ge=Number(p);if(isNaN(ge)||ge<0){b("Precio invlido");return}x(!0),b(null);try{const _e=s.id;await d(_e,{producto_id:h,precio:p});try{const A={};if(G!==null&&(A.exento=G),L!==null&&(A.aplica_impuesto_18=L),P!==null&&(A.aplica_impuesto_turistico=P),Object.keys(A).length>0&&h){const{error:D}=await ne.from("inventario").update(A).eq("id",h);D&&console.warn("Error actualizando inventario flags:",D)}}catch(A){console.warn("Error al persistir flags en inventario:",A)}a()}catch(_e){b(_e?.message||String(_e))}finally{x(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:h??"",onChange:Z=>g(Z.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(Z=>i.jsx("option",{value:Z.id,children:Z.nombre},Z.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!G,onChange:Z=>C(Z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!L,onChange:Z=>B(Z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!P,onChange:Z=>ve(Z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:p,onChange:Z=>m(Z.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:$==null?"":$.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:J==null?"":J.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:je==null?"":je.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&i.jsx("div",{style:{color:"red",marginTop:12},children:_}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:U,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function qx(){const[o,a]=j.useState([]),[s,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[_,b]=j.useState(null);async function w(){d(!0),g(null);try{const{data:C,error:L}=await ne.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(C)?C:[])}catch(C){g(C?.message||String(C)),a([])}finally{d(!1)}}async function N(){try{const{data:C}=await ne.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(C)?C:[])}catch{}}j.useEffect(()=>{w(),N()},[]);const R=new Set(o.map(C=>String(C.producto_id))),T=s.filter(C=>!R.has(C.id));function $(C){b(C),x(!0),g(null)}async function M(C){d(!0),g(null);try{const{error:L}=await ne.from("precios").insert(C);if(L)throw L;try{const B={producto_id:C.producto_id,precio:C.precio},{error:P}=await ne.from("precios_historico").insert(B);P&&console.warn("No se pudo insertar en precios_historico",P)}catch(B){console.warn("Error registrando precios_historico",B)}await w()}catch(L){throw g(L?.message||String(L)),L}finally{d(!1)}}async function G(C,L){d(!0),g(null);try{const{error:B}=await ne.from("precios").update(L).eq("id",C);if(B)throw B;let P=L.producto_id,ve=L.precio;if(!P||ve===void 0)try{const{data:J}=await ne.from("precios").select("producto_id, precio").eq("id",C).limit(1).single();J&&(P=P||J.producto_id,ve=ve===void 0?J.precio:ve)}catch{}try{if(P&&ve!==void 0){const J={producto_id:P,precio:ve},{error:oe}=await ne.from("precios_historico").insert(J);oe&&console.warn("No se pudo insertar en precios_historico",oe)}}catch(J){console.warn("Error registrando precios_historico",J)}await w()}catch(B){throw g(B?.message||String(B)),B}finally{d(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{w(),N()},children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),h&&i.jsx("div",{style:{color:"red",marginBottom:12},children:h}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(C=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:C.id}),i.jsx("td",{style:{minWidth:220},children:s.find(L=>L.id===C.producto_id)?.nombre||C.producto_id}),i.jsx("td",{children:C.precio}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>$(C),children:"Editar"})})]},C.id))})]})}),i.jsx(Lx,{open:p,onClose:()=>m(!1),products:T,onCreate:async C=>{await M(C),m(!1)}}),i.jsx(Mx,{open:v,onClose:()=>{x(!1),b(null)},row:_,products:s,availableProducts:[...s.filter(C=>!R.has(C.id)),..._?s.filter(C=>C.id===_.producto_id):[]],onSave:async(C,L)=>{await G(C,L),x(!1),b(null)}})]})}function Ix(){const[o,a]=j.useState(""),[s,l]=j.useState([]),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(!1),[v,x]=j.useState(null);async function _(){if(x(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:N}=await ne.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(N)throw N;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const R=w[0].id;d(R),await b(R)}}catch(w){x(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),x(null);try{const{data:N,error:R}=await ne.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(R)throw R;g(Array.isArray(N)?N:[])}catch(N){x(N?.message||String(N)),g([])}finally{m(!1)}}return j.useEffect(()=>{u&&b(u)},[u]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>_(),children:"Buscar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${h.length} registros`})]}),v&&i.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),i.jsx("ul",{children:s.map(w=>i.jsxs("li",{style:{marginBottom:6},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),i.jsx("strong",{children:w.nombre})," ",i.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Actualizacion"})]})}),i.jsx("tbody",{children:h.map(w=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(w.id)}),i.jsx("td",{style:{minWidth:220},children:s.find(N=>N.id===w.producto_id)?.nombre||w.producto_id}),i.jsx("td",{children:Number(w.precio).toFixed(2)}),i.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function Hx(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState({}),[v,x]=j.useState({}),[_,b]=j.useState(!1),[w,N]=j.useState(null);async function R(){b(!0),N(null);try{let T=ne.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(T=T.ilike("sku",`%${o}%`)),s&&(T=T.ilike("marca",`%${s}%`)),u&&(T=T.ilike("modelo",`%${u}%`));const{data:$,error:M}=await T.order("nombre",{ascending:!0});if(M)throw M;const G=Array.isArray($)?$:[];g(G);const C=G.map(J=>J.id);if(C.length===0){m({});return}const{data:L,error:B}=await ne.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",C);if(B)throw B;const P=Array.isArray(L)?L:[],ve={};for(const J of G)ve[String(J.id)]=0;for(const J of P){const oe=String(J.producto_id),je=Number(J.cantidad)||0,I=String(J.tipo_de_movimiento||"").toUpperCase();ve.hasOwnProperty(oe)||(ve[oe]=0),I==="ENTRADA"?ve[oe]=(ve[oe]||0)+je:I==="SALIDA"&&(ve[oe]=(ve[oe]||0)-je)}for(const J of Object.keys(ve))ve[J]=Number((ve[J]||0).toFixed(2));m(ve);try{const J=(await wn(async()=>{const{default:I}=await Promise.resolve().then(()=>Sn);return{default:I}},void 0)).default,oe="inventario",je={};await Promise.all(G.map(async I=>{const ee=I.imagen;if(!ee){je[String(I.id)]=null;return}const X=String(ee);if(X.startsWith("http")){je[String(I.id)]=X;return}let E=X;const U=String(X).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);U&&(E=decodeURIComponent(U[2]));try{const Z=await J.storage.from(oe).getPublicUrl(E),ge=Z?.data?.publicUrl||Z?.data?.publicURL||null;if(ge){je[String(I.id)]=ge;return}}catch{}try{const ge=(await J.storage.from(oe).createSignedUrl(E,604800))?.data?.signedUrl??null;je[String(I.id)]=ge}catch{je[String(I.id)]=null}})),x(je)}catch{}}catch(T){N(T?.message||String(T)),g([]),m({})}finally{b(!1)}}return j.useEffect(()=>{R()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Stock"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:T=>a(T.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:T=>l(T.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:T=>d(T.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>R(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),R()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:_?"Cargando...":`${h.length} productos`})]}),w&&i.jsx("div",{style:{color:"red",marginBottom:12},children:w}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Imagen"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Marca"}),i.jsx("th",{children:"Modelo"}),i.jsx("th",{children:"Descripcin"}),i.jsx("th",{children:"Stock"})]})}),i.jsx("tbody",{children:h.map(T=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:v[String(T.id)]?i.jsx("img",{src:encodeURI(v[String(T.id)]),alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:$=>{$.currentTarget.src=""}}):T.imagen?i.jsx("img",{src:T.imagen,alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:$=>{$.currentTarget.src=""}}):""}),i.jsx("td",{children:T.sku||""}),i.jsx("td",{children:T.marca||""}),i.jsx("td",{children:T.modelo||""}),i.jsx("td",{style:{maxWidth:320},children:T.descripcion||""}),i.jsx("td",{style:{textAlign:"right"},children:p[String(T.id)]!=null?String(p[String(T.id)]):"0"})]},T.id))})]})]})]})}function $x(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]),[v,x]=j.useState(!1),[_,b]=j.useState([]),[w,N]=j.useState({}),[R,T]=j.useState(!1),[$,M]=j.useState(null);async function G(){T(!0),M(null),b([]);try{let P=null;if(o||s||u){let ee=ne.from("inventario").select("id").order("nombre",{ascending:!0});o&&(ee=ee.ilike("sku",`%${o}%`)),s&&(ee=ee.ilike("marca",`%${s}%`)),u&&(ee=ee.ilike("categoria",`%${u}%`));const{data:X,error:E}=await ee;if(E)throw E;if(P=Array.isArray(X)?X.map(U=>String(U.id)):[],P.length===0){b([]),N({}),T(!1);return}}let ve=ne.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(P&&(ve=ve.in("producto_id",P)),v){const ee=new Date(Date.now()-864e5).toISOString();ve=ve.gte("fecha_salida",ee)}ve=ve.order("fecha_salida",{ascending:!1});const{data:J,error:oe}=await ve;if(oe)throw oe;const je=Array.isArray(J)?J.map(ee=>({id:ee.id,producto_id:String(ee.producto_id),cantidad:Number(ee.cantidad),tipo_de_movimiento:ee.tipo_de_movimiento,referencia:ee.referencia,usuario:ee.usuario,fecha_salida:ee.fecha_salida})):[];b(je);const I=Array.from(new Set(je.map(ee=>ee.producto_id))).filter(Boolean);if(I.length>0){const{data:ee}=await ne.from("inventario").select("id, nombre, sku, marca, categoria").in("id",I),X={};Array.isArray(ee)&&ee.forEach(E=>{X[String(E.id)]={id:E.id,nombre:E.nombre,sku:E.sku,marca:E.marca,categoria:E.categoria}}),N(X)}else N({})}catch(P){M(P?.message||String(P)),b([])}finally{T(!1)}}async function C(){try{const{data:P,error:ve}=await ne.from("inventario").select("marca, categoria");if(ve)throw ve;const J=new Set,oe=new Set;Array.isArray(P)&&P.forEach(je=>{je.marca&&J.add(String(je.marca)),je.categoria&&oe.add(String(je.categoria))}),g(Array.from(J).sort()),m(Array.from(oe).sort())}catch(P){console.warn("Error loading filter options",P)}}j.useEffect(()=>{G(),C()},[]);const L=_.filter(P=>String(P.tipo_de_movimiento).toUpperCase()==="ENTRADA"),B=_.filter(P=>String(P.tipo_de_movimiento).toUpperCase()==="SALIDA");return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:P=>a(P.target.value)}),i.jsxs("select",{className:"input",value:s,onChange:P=>l(P.target.value),children:[i.jsx("option",{value:"",children:"-- Marca (todas) --"}),h.map(P=>i.jsx("option",{value:P,children:P},P))]}),i.jsxs("select",{className:"input",value:u,onChange:P=>d(P.target.value),children:[i.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(P=>i.jsx("option",{value:P,children:P},P))]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:v,onChange:P=>x(P.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),x(!1),G()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:R?"Cargando...":`${_.length} registros`})]}),$&&i.jsx("div",{style:{color:"red",marginBottom:12},children:$}),i.jsxs("div",{style:{display:"flex",gap:12},children:[i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Entradas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:L.map(P=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String(P.id)}),i.jsx("td",{style:{minWidth:120},children:w[P.producto_id]?.sku||P.producto_id}),i.jsx("td",{children:w[P.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number(P.cantidad).toFixed(2)}),i.jsx("td",{children:P.referencia||""}),i.jsx("td",{children:P.usuario||""}),i.jsx("td",{children:P.fecha_salida||""})]},String(P.id)))})]})]}),i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Salidas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:B.map(P=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String(P.id)}),i.jsx("td",{style:{minWidth:120},children:w[P.producto_id]?.sku||P.producto_id}),i.jsx("td",{children:w[P.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number(P.cantidad).toFixed(2)}),i.jsx("td",{children:P.referencia||""}),i.jsx("td",{children:P.usuario||""}),i.jsx("td",{children:P.fecha_salida||""})]},String(P.id)))})]})]})]})]})}function Px(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),i.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function Vx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),i.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function Gx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function Fx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function Kx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function Yx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function Jx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function Qx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),i.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function Xx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),i.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function Zx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),i.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function Wx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),i.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function e_({open:o,onClose:a,onCreate:s}){const[l,u]=j.useState(""),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,_]=j.useState(""),[b,w]=j.useState(""),[N,R]=j.useState(!0),[T,$]=j.useState(!1),[M,G]=j.useState(null);if(!o)return null;async function C(){const L=[];if(l.trim()||L.push("Nombre"),L.length){G(`Faltan campos: ${L.join(", ")}`);return}$(!0),G(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:b||void 0,activo:N}),u(""),h(""),p(""),v(""),_(""),w(""),R(!0),a()}catch(B){G(B?.message||String(B))}finally{$(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:l,onChange:L=>u(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:d,onChange:L=>h(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:g,onChange:L=>p(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:m,onChange:L=>v(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:x,onChange:L=>_(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:b,onChange:L=>w(L.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:N,onChange:L=>R(L.target.checked)})," ","Activo"]})]}),M&&i.jsx("div",{style:{color:"red",marginTop:12},children:M}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:T,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:C,disabled:T,style:{width:"auto",padding:"8px 14px"},children:T?"Creando...":"Crear"})]})]})})}function t_({open:o,onClose:a,row:s,onSave:l}){const[u,d]=j.useState(""),[h,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[_,b]=j.useState(""),[w,N]=j.useState(""),[R,T]=j.useState(!0),[$,M]=j.useState(!1),[G,C]=j.useState(null);if(j.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),x(s.correo||""),b(s.direccion||""),N(s.tipo_proveedor||""),T(s.activo??!0),C(null))},[o,s]),!o||!s)return null;async function L(){if(!s){C("No hay fila seleccionada");return}const B=[];if(u.trim()||B.push("Nombre"),B.length){C(`Faltan campos: ${B.join(", ")}`);return}M(!0),C(null);try{await l(s.id,{nombre:u.trim(),rtn:h.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:w||void 0,activo:R}),a()}catch(P){C(P?.message||String(P))}finally{M(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:u,onChange:B=>d(B.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:h,onChange:B=>g(B.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:p,onChange:B=>m(B.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:v,onChange:B=>x(B.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:_,onChange:B=>b(B.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:w,onChange:B=>N(B.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:R,onChange:B=>T(B.target.checked)})," ","Activo"]})]}),G&&i.jsx("div",{style:{color:"red",marginTop:12},children:G}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:$,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:L,disabled:$,style:{width:"auto",padding:"8px 14px"},children:$?"Guardando...":"Guardar"})]})]})})}function n_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,N]=j.useState(!1),[R,T]=j.useState(null);async function $(L){l(!0),d(null);try{let B=null,P=null;if(L&&L.trim()){const J=`%${L.trim()}%`,oe=await ne.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${J},rtn.ilike.${J}`).order("id",{ascending:!0});B=oe.data,P=oe.error}else{const ve=await ne.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});B=ve.data,P=ve.error}if(P)throw P;a(Array.isArray(B)?B:[])}catch(B){d(B?.message||String(B)),a([])}finally{l(!1)}}j.useEffect(()=>{$()},[]),j.useEffect(()=>{const L=setTimeout(()=>{$(h)},350);return()=>clearTimeout(L)},[h]);async function M(L){l(!0),d(null);try{const B={...L};if(delete B.id,B.rtn){const{data:ve,error:J}=await ne.from("proveedores").select("id, nombre").eq("rtn",B.rtn).limit(1);if(J)throw J;if(Array.isArray(ve)&&ve.length>0)throw new Error(`Ya existe un proveedor con RTN ${B.rtn}`)}const{error:P}=await ne.from("proveedores").insert(B);if(P)throw P;await $()}catch(B){throw String(B).includes("Ya existe un proveedor")?d(String(B)):B?.code==="23505"||String(B).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(B?.message||String(B)),B}finally{l(!1)}}async function G(L,B){l(!0),d(null);try{const{error:P}=await ne.from("proveedores").update(B).eq("id",L);if(P)throw P;await $()}catch(P){throw d(P?.message||String(P)),P}finally{l(!1)}}async function C(){if(R){l(!0),d(null);try{const{error:L}=await ne.from("proveedores").delete().eq("id",R.id);if(L)throw L;N(!1),T(null),await $()}catch(L){d(L?.message||String(L))}finally{l(!1)}}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>$(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),i.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:h,onChange:L=>g(L.target.value),style:{width:260}}),i.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),$()},children:"Limpiar"})]}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"RTN"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Telfono"}),i.jsx("th",{children:"Correo"}),i.jsx("th",{children:"Direccin"}),i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Activo"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(L=>i.jsxs("tr",{children:[i.jsx("td",{children:L.rtn||""}),i.jsx("td",{style:{minWidth:180},children:L.nombre}),i.jsx("td",{children:L.telefono||""}),i.jsx("td",{children:L.correo||""}),i.jsx("td",{children:L.direccion||""}),i.jsx("td",{children:L.tipo_proveedor||""}),i.jsx("td",{children:L.activo?"S":"No"}),i.jsxs("td",{style:{whiteSpace:"nowrap"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{b(L),x(!0)},children:"Editar"}),i.jsx("button",{className:"btn-danger",onClick:()=>{T(L),N(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},L.id))})]})}),i.jsx(e_,{open:p,onClose:()=>m(!1),onCreate:async L=>{await M(L),m(!1)}}),i.jsx(t_,{open:v,onClose:()=>{x(!1),b(null)},row:_,onSave:async(L,B)=>{await G(L,B),x(!1),b(null)}}),i.jsx(lm,{open:w,title:R?`Eliminar proveedor ${R.nombre}`:"Eliminar proveedor",message:R?`Confirma eliminar al proveedor ${R.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await C()},onCancel:()=>{N(!1),T(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function a_({open:o,onClose:a,onCreated:s}){const[l,u]=j.useState([]),[d,h]=j.useState([]),[g,p]=j.useState(0),[m,v]=j.useState(null),[x,_]=j.useState(""),[b,w]=j.useState("factura"),[N,R]=j.useState([]),[T,$]=j.useState(null),[M,G]=j.useState(1),[C,L]=j.useState(null),[B,P]=j.useState(!1),[ve,J]=j.useState(null);if(j.useEffect(()=>{o&&(async()=>{try{const U=await ne.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await ne.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});h(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await ne.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),Z=Array.isArray(U.data)&&U.data.length>0?U.data[0]:null,ge=Z?Number(Z.impuesto_venta):0;p(ge)}catch{}})()},[o]),!o)return null;function oe(){v(null),_(""),w("factura"),R([]),$(null),G(1),L(null),J(null)}function je(){if(!T){J("Selecciona un producto");return}if(!C||C<=0){J("Costo unitario invlido");return}if(!M||M<=0){J("Cantidad invlida");return}const U=l.find(ge=>ge.id===T),Z=ge=>{if(ge==null)return!1;if(typeof ge=="boolean")return ge===!0;if(typeof ge=="number")return ge===1;const _e=String(ge).toLowerCase().trim();return _e==="1"||_e==="true"||_e==="t"||_e==="si"||_e==="s"||_e==="yes"};R(ge=>[...ge,{producto_id:T,nombre:U?.nombre||"",cantidad:M,costo_unitario:C,exento:Z(U?.exento)}]),$(null),G(1),L(null),J(null)}function I(U){R(Z=>Z.filter((ge,_e)=>_e!==U))}function ee(){const U=g,Z=U>1?U/100:U;let ge=0,_e=0,A=0;for(const D of N){const O=D.cantidad*D.costo_unitario;let F=0,se=O;D.exento||(F=O*Z,se=O-F),ge+=se,_e+=F,A+=O}return{subtotal:ge,impuesto:_e,total:A}}async function X(){if(J(null),!m){J("Selecciona un proveedor");return}if(N.length===0){J("Agrega al menos un producto");return}P(!0);try{const{subtotal:U,impuesto:Z,total:ge}=ee(),_e={proveedor_id:m,numero_documento:x||null,tipo_documento:b||null,subtotal:U,impuesto:Z,total:ge,usuario:null},A=await ne.from("compras").insert(_e).select("id").single();if(A.error)throw A.error;const D=A.data.id,O=N.map(se=>({compra_id:D,producto_id:se.producto_id,cantidad:se.cantidad,costo_unitario:se.costo_unitario})),F=await ne.from("compras_detalle").insert(O);if(F.error)throw await ne.from("compras").delete().eq("id",D),F.error;try{const se=x?`Compra - ${x}`:`Compra ${D}`;let fe="sistema";try{const Se=localStorage.getItem("user");if(Se){const Re=JSON.parse(Se);fe=Re.username?`${Re.username}${Re.role?` (${Re.role})`:""}`:String(Re)}}catch{}const k=new Date().toISOString(),te=N.map(Se=>({producto_id:Se.producto_id,cantidad:Se.cantidad,tipo_de_movimiento:"ENTRADA",referencia:se,usuario:fe,fecha_salida:k})),pe=await ne.from("registro_de_inventario").insert(te);pe.error&&(console.warn("Error registrando en registro_de_inventario",pe.error),J("Compra guardada, pero fall el registro en inventario: "+pe.error.message))}catch(se){console.warn("Registro inventario fallo",se)}oe(),a(),s&&s()}catch(U){J(U?.message||String(U))}finally{P(!1)}}const E=ee();return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),i.jsxs("select",{className:"input",value:m??"",onChange:U=>v(U.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(U=>i.jsx("option",{value:U.id,children:U.nombre},String(U.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),i.jsx("input",{className:"input",value:x,onChange:U=>_(U.target.value)}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),i.jsx("input",{className:"input",value:b,onChange:U=>w(U.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:T??"",onChange:U=>$(U.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(U=>i.jsx("option",{value:U.id,children:U.nombre},U.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:U=>G(Number(U.target.value))}),i.jsx("input",{className:"input",type:"number",style:{width:120},value:C??"",onChange:U=>L(Number(U.target.value)),placeholder:"Costo unitario"}),i.jsx("button",{className:"btn-primary",onClick:je,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:N.map((U,Z)=>{const ge=U.cantidad*U.costo_unitario,_e=g>1?g/100:g,A=U.exento?0:ge*_e,D=U.exento?ge:ge-A;return i.jsxs("tr",{children:[i.jsx("td",{children:U.nombre}),i.jsx("td",{children:U.cantidad}),i.jsx("td",{children:U.costo_unitario.toFixed(2)}),i.jsx("td",{children:A.toFixed(2)}),i.jsx("td",{children:D.toFixed(2)}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>I(Z),children:"Quitar"})})]},`${U.producto_id}-${Z}`)})})]})})]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:["Subtotal: ",i.jsx("strong",{children:E.subtotal.toFixed(2)})]}),i.jsxs("div",{children:["Impuesto: ",i.jsx("strong",{children:E.impuesto.toFixed(2)})]}),i.jsxs("div",{children:["Total: ",i.jsx("strong",{children:E.total.toFixed(2)})]})]})}),ve&&i.jsx("div",{style:{color:"red",marginTop:12},children:ve}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{oe(),a()},disabled:B,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:X,disabled:B,children:B?"Guardando...":"Confirmar compra"})]})]})})}function i_({open:o,compraId:a,onClose:s}){const[l,u]=j.useState([]),[d,h]=j.useState({}),[g,p]=j.useState({}),[m,v]=j.useState(0),[x,_]=j.useState(!1);return j.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{_(!0);try{const{data:w,error:N}=await ne.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(N)throw N;const R=Array.isArray(w)?w:[];if(!b)return;u(R);const T=Array.from(new Set(R.map($=>$.producto_id))).filter(Boolean);if(T.length>0){const{data:$}=await ne.from("inventario").select("id, nombre, exento").in("id",T),M={},G={};Array.isArray($)&&$.forEach(C=>{M[String(C.id)]={id:C.id,nombre:C.nombre},G[String(C.id)]=C.exento===!0||C.exento===1||String(C.exento).toLowerCase()==="true"}),b&&(h(M),p(G))}else h({});try{const{data:$}=await ne.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),M=Array.isArray($)&&$.length>0?$[0]:null,G=M?Number(M.impuesto_venta):0;b&&v(G)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&_(!1)}})(),()=>{b=!1}},[o,a]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),i.jsx("div",{style:{marginTop:8},children:x?i.jsx("div",{children:"Cargando..."}):i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),N=Number(b.costo_unitario),R=w*N,T=m>1?m/100:m,$=g[String(b.producto_id)]===!0,M=$?0:R*T,G=$?R:R-M;return i.jsxs("tr",{children:[i.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),i.jsx("td",{children:w.toFixed(2)}),i.jsx("td",{children:N.toFixed(2)}),i.jsx("td",{children:M.toFixed(2)}),i.jsx("td",{children:G.toFixed(2)}),i.jsx("td",{children:R.toFixed(2)})]},String(b.id))})}),i.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,N)=>{const R=Number(N.cantidad),T=Number(N.costo_unitario),$=R*T,M=m>1?m/100:m,G=g[String(N.producto_id)]===!0,C=G?0:$*M,L=G?$:$-C;return w.subtotal+=L,w.impuesto+=C,w.total+=$,w},{subtotal:0,impuesto:0,total:0});return i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),i.jsx("td",{children:b.impuesto.toFixed(2)}),i.jsx("td",{children:b.subtotal.toFixed(2)}),i.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function r_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(!1),[v,x]=j.useState(null),[_,b]=j.useState([]),[w,N]=j.useState(""),[R,T]=j.useState(""),[$,M]=j.useState(!1);async function G(){l(!0),d(null);try{let C=ne.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const P=Number(w);isNaN(P)?C=C.eq("proveedor_id",w):C=C.eq("proveedor_id",P)}if(R&&(C=C.ilike("numero_documento",`%${R}%`)),$){const P=new Date(Date.now()-864e5).toISOString();C=C.gte("fecha_compra",P)}const{data:L,error:B}=await C.order("id",{ascending:!1});if(B)throw B;a(Array.isArray(L)?L:[])}catch(C){d(C?.message||String(C)),a([])}finally{l(!1)}}return j.useEffect(()=>{G()},[]),j.useEffect(()=>{let C=!0;return(async()=>{try{const{data:L}=await ne.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!C)return;b(Array.isArray(L)?L:[])}catch{}})(),()=>{C=!1}},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:w,onChange:C=>N(C.target.value),children:[i.jsx("option",{value:"",children:"-- proveedor (todos) --"}),_.map(C=>i.jsx("option",{value:String(C.id),children:C.nombre},String(C.id)))]}),i.jsx("input",{className:"input",placeholder:"Nmero documento",value:R,onChange:C=>T(C.target.value)}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:$,onChange:C=>M(C.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{N(""),T(""),M(!1),G()},children:"Limpiar"})]}),i.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),i.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:o.map(C=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(C.id)}),i.jsx("td",{children:String(C.proveedor_id)}),i.jsx("td",{children:C.numero_documento||""}),i.jsx("td",{children:C.fecha_compra||""}),i.jsx("td",{children:C.subtotal||""}),i.jsx("td",{children:C.impuesto||""}),i.jsx("td",{children:C.total||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{x(C.id),m(!0)},children:"Detalle"})})]},String(C.id)))})]})}),i.jsx(a_,{open:h,onClose:()=>g(!1),onCreated:()=>{g(!1),G()}}),i.jsx(i_,{open:p,compraId:v,onClose:()=>{m(!1),x(null)}})]})}function s_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(null);async function v(){l(!0),d(null);try{const{data:x,error:_}=await ne.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(_)throw _;a(Array.isArray(x)?x.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(x){d(x?.message||String(x)),a([])}finally{l(!1)}}return j.useEffect(()=>{v()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),i.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(x=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(x.id)}),i.jsx("td",{children:String(x.proveedor_id||"")}),i.jsx("td",{children:x.numero_documento||""}),i.jsx("td",{children:x.usuario||""}),i.jsx("td",{children:x.fecha||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>m(x.id),children:"Detalle"})})]},String(x.id)))})]})}),h&&i.jsx(l_,{onClose:()=>{g(!1),v()}}),p&&i.jsx(o_,{id:p,onClose:()=>{m(null),v()}})]})}function l_({onClose:o}){const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(null),[x,_]=j.useState(null),[b,w]=j.useState(""),[N,R]=j.useState([]),[T,$]=j.useState(null),[M,G]=j.useState(1),[C,L]=j.useState(!1),[B,P]=j.useState(null);j.useEffect(()=>{(async()=>{try{const I=await ne.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(I.data)?I.data:[])}catch{}try{const I=await ne.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(I.data)?I.data:[])}catch{}})()},[]);async function ve(){if(b){P(null);try{const{data:I,error:ee}=await ne.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(ee)throw ee;if(!I){P("No se encontr compra con ese nmero de documento");return}h(I.id),v(I.proveedor_id);try{const{data:F}=await ne.from("proveedores").select("id, nombre").eq("id",I.proveedor_id).limit(1).single();F&&F.nombre&&_(F.nombre)}catch{}const{data:X}=await ne.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",I.id),E=Array.isArray(X)?X:[],{data:U}=await ne.from("devoluciones_proveedores").select("id").eq("numero_documento",b),Z=Array.isArray(U)?U.map(F=>F.id):[];let ge={};if(Z.length>0){const{data:F}=await ne.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",Z);Array.isArray(F)&&F.forEach(se=>{const fe=String(se.producto_id);ge[fe]=(ge[fe]||0)+Number(se.cantidad)})}const _e=E.map(F=>F.producto_id),{data:A}=await ne.from("inventario").select("id, nombre, sku").in("id",_e),D={};Array.isArray(A)&&A.forEach(F=>{D[String(F.id)]=F});const O=E.map(F=>{const se=String(F.producto_id),fe=Number(F.cantidad),k=ge[se]||0,te=Math.max(0,fe-k);return{producto_id:se,nombre:D[se]?.nombre||se,sku:D[se]?.sku,purchased:fe,returned:k,available:te,costo_unitario:Number(F.costo_unitario||0)}});p(O),u(O.map(F=>({id:F.producto_id,nombre:F.nombre,sku:F.sku})))}catch(I){P(I?.message||String(I))}}}function J(){if(!T){P("Selecciona un producto");return}if(!M||M<=0){P("Cantidad invlida");return}const I=l.find(X=>X.id===T),ee=g.find(X=>X.producto_id===T);if(ee&&M>ee.available){P(`Cantidad excede disponible para devolucin (${ee.available})`);return}R(X=>[...X,{producto_id:T,nombre:I?.nombre,cantidad:M}]),$(null),G(1),P(null),ee&&(p(X=>X.map(E=>E.producto_id===ee.producto_id?{...E,available:Math.max(0,E.available-M)}:E)),u(X=>X.map(E=>(E.id===ee.producto_id,E))))}function oe(I){R(ee=>ee.filter((X,E)=>E!==I))}async function je(){if(P(null),!m){P("Selecciona un proveedor");return}if(N.length===0){P("Agrega al menos un producto");return}L(!0);try{const I={proveedor_id:m,numero_documento:b||null,usuario:null},ee=await ne.from("devoluciones_proveedores").insert(I).select("id").single();if(ee.error)throw ee.error;const X=ee.data.id;try{const E=N.map(Z=>({devolucion_id:X,producto_id:Z.producto_id,cantidad:Z.cantidad})),U=await ne.from("devoluciones_proveedores_detalle").insert(E);U.error&&console.warn("No se pudo insertar detalles de devolucin",U.error)}catch(E){console.warn("Detalles tabla puede no existir",E)}try{const E=b?`Devolucin - ${b}`:`Devolucin ${X}`;let U="sistema";try{const A=localStorage.getItem("user");if(A){const D=JSON.parse(A);U=D.username?`${D.username}${D.role?` (${D.role})`:""}`:String(D)}}catch{}const Z=new Date().toISOString(),ge=N.map(A=>({producto_id:A.producto_id,cantidad:A.cantidad,tipo_de_movimiento:"SALIDA",referencia:E,usuario:U,fecha_salida:Z})),_e=await ne.from("registro_de_inventario").insert(ge);_e.error&&(console.warn("Error registrando en registro_de_inventario",_e.error),P("Devolucin guardada, pero fall el registro en inventario: "+_e.error.message))}catch(E){console.warn("Registro inventario fallo",E)}o()}catch(I){P(I?.message||String(I))}finally{L(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?i.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:x||String(m||"")}):i.jsxs("select",{className:"input",value:m??"",onChange:I=>v(I.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(I=>i.jsx("option",{value:I.id,children:I.nombre},String(I.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{className:"input",value:b,onChange:I=>w(I.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>ve(),children:"Buscar compra"})]}),d&&i.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&i.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[i.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[i.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Comprado"}),i.jsx("th",{children:"Devuelto"}),i.jsx("th",{children:"Disponible"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:g.map(I=>i.jsxs("tr",{children:[i.jsx("td",{children:I.nombre}),i.jsx("td",{style:{textAlign:"right"},children:Number(I.purchased).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(I.returned).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(I.available).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>{$(I.producto_id),G(I.available||1)},children:"Usar"})})]},I.producto_id))})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:T??"",onChange:I=>$(I.target.value||null),disabled:!!d,children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(I=>i.jsx("option",{value:I.id,children:I.nombre},I.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:I=>{const ee=Number(I.target.value),X=g.find(E=>E.producto_id===T);if(X){const E=Number(X.available||0);return isNaN(ee)||ee<1?G(1):ee>E?G(E):G(ee)}G(ee)},min:1,max:T?g.find(I=>I.producto_id===T)?.available??void 0:void 0,disabled:(()=>{const I=g.find(ee=>ee.producto_id===T);return!!I&&Number(I.available||0)<=1})()}),i.jsx("button",{className:"btn-primary",onClick:J,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:N.map((I,ee)=>i.jsxs("tr",{children:[i.jsx("td",{children:I.nombre}),i.jsx("td",{style:{textAlign:"right"},children:I.cantidad}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>oe(ee),children:"Quitar"})})]},`${I.producto_id}-${ee}`))})]})})]})]}),B&&i.jsx("div",{style:{color:"red",marginTop:12},children:B}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:o,disabled:C,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:je,disabled:C,children:C?"Guardando...":"Registrar devolucin"})]})]})})}function o_({id:o,onClose:a}){const[s,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await ne.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const x=Array.isArray(m)?m:[];if(x.length>0){const _=x.map(N=>N.producto_id),{data:b}=await ne.from("inventario").select("id, nombre, sku").in("id",_),w={};Array.isArray(b)&&b.forEach(N=>{w[String(N.id)]=N}),l(x.map(N=>({producto:w[String(N.producto_id)]?.nombre||String(N.producto_id),cantidad:N.cantidad})))}else{const{data:_}=await ne.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(_)?_:[],w=b.map(T=>T.producto_id),{data:N}=await ne.from("inventario").select("id, nombre, sku").in("id",w),R={};Array.isArray(N)&&N.forEach(T=>{R[String(T.id)]=T}),l(b.map(T=>({producto:R[String(T.producto_id)]?.nombre||String(T.producto_id),cantidad:T.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return j.useEffect(()=>{p()},[o]),i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&i.jsx("div",{children:"Cargando..."}),h&&i.jsx("div",{style:{color:"red"},children:h}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"})]})}),i.jsx("tbody",{children:s.map((m,v)=>i.jsxs("tr",{children:[i.jsx("td",{children:m.producto}),i.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const c_={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function u_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(null),[p,m]=j.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await ne.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};j.useEffect(()=>{v()},[]);const x=(b,w)=>{a(N=>N.map(R=>R.id===b?{...R,impuesto_venta:w}:R))},_=async b=>{const w=o.find(N=>N.id===b);if(w){d(b),m(null);try{const N={impuesto_venta:w.impuesto_venta??null},{error:R}=await ne.from("impuesto").update(N).eq("id",b);if(R)throw R;await v()}catch(N){console.warn("Error guardando impuesto:",N),m(String(N.message||N))}finally{d(null)}}};return i.jsxs("div",{children:[i.jsx("h2",{children:"Impuestos"}),i.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?i.jsx("div",{children:"Cargando..."}):i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>i.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:c_[b.id]??`Impuesto #${b.id}`}),i.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),i.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>x(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:h!==b.id}),i.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:h===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[i.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),i.jsx("div",{style:{display:"flex",gap:8},children:h===b.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:()=>_(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):i.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&i.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&i.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const d_={dashboard:xx,datos:Sx,usuarios_internal:Ex,usuarios_web:wx,cai:Ax,facturas:Nx,historial_facturas:Rx,inventario_productos:Bx,precios_productos:qx,precios_historico:Ix,stock:Hx,inventario_salidas:$x,inventario_categorias:Px,proveedores:n_,caja_sesiones:Vx,caja_movimientos:Gx,rep_ventas:Fx,rep_devoluciones:Kx,rep_ingresos_egresos:Yx,rep_compras:Jx,compras_main:r_,devoluciones_proveedores:s_,rep_export:Qx,cuentas_contables:Xx,libro_diario:Zx,auditoria:Wx,impuestos:u_};function f_({onLogout:o}){const[a,s]=j.useState("dashboard"),[l,u]=j.useState(null),[d,h]=j.useState({}),g=l||a,p=d_[g],v=(_=>{for(const b of up){if(b.id===_)return b.label;if(b.children){const w=b.children.find(N=>N.id===_);if(w)return w.label}}return"Panel de Administracin"})(g),x=_=>{if(_.id==="salir")return o();_.children&&_.children.length>0?(h(b=>({...b,[_.id]:!b[_.id]})),(_.id!==a||!l)&&(s(_.id),u(_.children[0].id))):(s(_.id),u(null))};return i.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[i.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[i.jsx("strong",{children:"Panel Admin"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),i.jsx("nav",{children:up.map(_=>i.jsxs("div",{style:{marginBottom:6},children:[i.jsxs("div",{onClick:()=>x(_),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===_.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[i.jsx("span",{children:_.label}),Array.isArray(_.children)&&_.children.length>0?i.jsx("span",{style:{marginLeft:8},children:d[_.id]?"":""}):null]}),Array.isArray(_.children)&&_.children.length>0&&d[_.id]&&i.jsx("div",{style:{marginLeft:12,marginTop:6},children:_.children.map(b=>i.jsx("div",{onClick:()=>{s(_.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},_.id))})]}),i.jsx("main",{style:{flex:1,padding:24},children:p?i.jsx(p,{}):i.jsx(bx,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function h_(){const[o,a]=j.useState(null);j.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]),j.useEffect(()=>{let u=!0;return(async()=>{try{const d=await Wl();if(!u||!d)return;const h=d.nombre||d.comercio||d.name||"";h&&(document.title=String(h));const g=d.logoUrl||d.logo||null;if(g)try{let p=document.querySelector("link[rel~='icon']");p||(p=document.createElement("link"),p.rel="icon",document.getElementsByTagName("head")[0].appendChild(p)),p.href=String(g)}catch{}}catch{}})(),()=>{u=!1}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return i.jsxs("div",{children:[!o&&i.jsx(F0,{onLogin:s}),o&&o.role==="cajero"&&i.jsx(gx,{onLogout:l}),o&&o.role==="admin"&&i.jsx(f_,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&i.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[i.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),i.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',i.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),i.jsx("div",{style:{marginTop:18},children:i.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class g_ extends Ql.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[i.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}Sv.createRoot(document.getElementById("root")).render(i.jsx(g_,{children:i.jsx(h_,{})}));
