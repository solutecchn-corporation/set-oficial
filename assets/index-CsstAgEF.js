function dv(o,a){for(var r=0;r<a.length;r++){const l=a[r];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function r(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=r(u);fetch(u.href,d)}})();function op(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function fv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var r=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};r.prototype=a.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(r,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),r}var eu={exports:{}},es={};var xg;function hv(){if(xg)return es;xg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function r(l,u,d){var h=null;if(d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:h,ref:u!==void 0?u:null,props:d}}return es.Fragment=a,es.jsx=r,es.jsxs=r,es}var jg;function gv(){return jg||(jg=1,eu.exports=hv()),eu.exports}var s=gv(),tu={exports:{}},ts={},nu={exports:{}},au={};var Sg;function pv(){return Sg||(Sg=1,(function(o){function a(C,U){var ee=C.length;C.push(U);e:for(;0<ee;){var ge=ee-1>>>1,pe=C[ge];if(0<u(pe,U))C[ge]=U,C[ee]=pe,ee=ge;else break e}}function r(C){return C.length===0?null:C[0]}function l(C){if(C.length===0)return null;var U=C[0],ee=C.pop();if(ee!==U){C[0]=ee;e:for(var ge=0,pe=C.length,N=pe>>>1;ge<N;){var D=2*(ge+1)-1,P=C[D],J=D+1,he=C[J];if(0>u(P,ee))J<pe&&0>u(he,P)?(C[ge]=he,C[J]=ee,ge=J):(C[ge]=P,C[D]=ee,ge=D);else if(J<pe&&0>u(he,ee))C[ge]=he,C[J]=ee,ge=J;else break e}}return U}function u(C,U){var ee=C.sortIndex-U.sortIndex;return ee!==0?ee:C.id-U.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();o.unstable_now=function(){return h.now()-g}}var p=[],m=[],v=1,_=null,x=3,b=!1,w=!1,A=!1,R=!1,T=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function K(C){for(var U=r(m);U!==null;){if(U.callback===null)l(m);else if(U.startTime<=C)l(m),U.sortIndex=U.expirationTime,a(p,U);else break;U=r(m)}}function E(C){if(A=!1,K(C),!w)if(r(p)!==null)w=!0,M||(M=!0,xe());else{var U=r(m);U!==null&&W(E,U.startTime-C)}}var M=!1,L=-1,V=5,ye=-1;function Q(){return R?!0:!(o.unstable_now()-ye<V)}function fe(){if(R=!1,M){var C=o.unstable_now();ye=C;var U=!0;try{e:{w=!1,A&&(A=!1,I(L),L=-1),b=!0;var ee=x;try{t:{for(K(C),_=r(p);_!==null&&!(_.expirationTime>C&&Q());){var ge=_.callback;if(typeof ge=="function"){_.callback=null,x=_.priorityLevel;var pe=ge(_.expirationTime<=C);if(C=o.unstable_now(),typeof pe=="function"){_.callback=pe,K(C),U=!0;break t}_===r(p)&&l(p),K(C)}else l(p);_=r(p)}if(_!==null)U=!0;else{var N=r(m);N!==null&&W(E,N.startTime-C),U=!1}}break e}finally{_=null,x=ee,b=!1}U=void 0}}finally{U?xe():M=!1}}}var xe;if(typeof B=="function")xe=function(){B(fe)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,X=q.port2;q.port1.onmessage=fe,xe=function(){X.postMessage(null)}}else xe=function(){T(fe,0)};function W(C,U){L=T(function(){C(o.unstable_now())},U)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(C){C.callback=null},o.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<C?Math.floor(1e3/C):5},o.unstable_getCurrentPriorityLevel=function(){return x},o.unstable_next=function(C){switch(x){case 1:case 2:case 3:var U=3;break;default:U=x}var ee=x;x=U;try{return C()}finally{x=ee}},o.unstable_requestPaint=function(){R=!0},o.unstable_runWithPriority=function(C,U){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var ee=x;x=C;try{return U()}finally{x=ee}},o.unstable_scheduleCallback=function(C,U,ee){var ge=o.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ge+ee:ge):ee=ge,C){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ee+pe,C={id:v++,callback:U,priorityLevel:C,startTime:ee,expirationTime:pe,sortIndex:-1},ee>ge?(C.sortIndex=ee,a(m,C),r(p)===null&&C===r(m)&&(A?(I(L),L=-1):A=!0,W(E,ee-ge))):(C.sortIndex=pe,a(p,C),w||b||(w=!0,M||(M=!0,xe()))),C},o.unstable_shouldYield=Q,o.unstable_wrapCallback=function(C){var U=x;return function(){var ee=x;x=U;try{return C.apply(this,arguments)}finally{x=ee}}}})(au)),au}var wg;function mv(){return wg||(wg=1,nu.exports=pv()),nu.exports}var iu={exports:{}},Be={};var Eg;function yv(){if(Eg)return Be;Eg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),x=Symbol.iterator;function b(N){return N===null||typeof N!="object"?null:(N=x&&N[x]||N["@@iterator"],typeof N=="function"?N:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,R={};function T(N,D,P){this.props=N,this.context=D,this.refs=R,this.updater=P||w}T.prototype.isReactComponent={},T.prototype.setState=function(N,D){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,D,"setState")},T.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function I(){}I.prototype=T.prototype;function B(N,D,P){this.props=N,this.context=D,this.refs=R,this.updater=P||w}var K=B.prototype=new I;K.constructor=B,A(K,T.prototype),K.isPureReactComponent=!0;var E=Array.isArray;function M(){}var L={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function ye(N,D,P){var J=P.ref;return{$$typeof:o,type:N,key:D,ref:J!==void 0?J:null,props:P}}function Q(N,D){return ye(N.type,D,N.props)}function fe(N){return typeof N=="object"&&N!==null&&N.$$typeof===o}function xe(N){var D={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(P){return D[P]})}var q=/\/+/g;function X(N,D){return typeof N=="object"&&N!==null&&N.key!=null?xe(""+N.key):D.toString(36)}function W(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(M,M):(N.status="pending",N.then(function(D){N.status==="pending"&&(N.status="fulfilled",N.value=D)},function(D){N.status==="pending"&&(N.status="rejected",N.reason=D)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function C(N,D,P,J,he){var le=typeof N;(le==="undefined"||le==="boolean")&&(N=null);var O=!1;if(N===null)O=!0;else switch(le){case"bigint":case"string":case"number":O=!0;break;case"object":switch(N.$$typeof){case o:case a:O=!0;break;case v:return O=N._init,C(O(N._payload),D,P,J,he)}}if(O)return he=he(N),O=J===""?"."+X(N,0):J,E(he)?(P="",O!=null&&(P=O.replace(q,"$&/")+"/"),C(he,D,P,"",function(we){return we})):he!=null&&(fe(he)&&(he=Q(he,P+(he.key==null||N&&N.key===he.key?"":(""+he.key).replace(q,"$&/")+"/")+O)),D.push(he)),1;O=0;var te=J===""?".":J+":";if(E(N))for(var me=0;me<N.length;me++)J=N[me],le=te+X(J,me),O+=C(J,D,P,le,he);else if(me=b(N),typeof me=="function")for(N=me.call(N),me=0;!(J=N.next()).done;)J=J.value,le=te+X(J,me++),O+=C(J,D,P,le,he);else if(le==="object"){if(typeof N.then=="function")return C(W(N),D,P,J,he);throw D=String(N),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return O}function U(N,D,P){if(N==null)return N;var J=[],he=0;return C(N,J,"","",function(le){return D.call(P,le,he++)}),J}function ee(N){if(N._status===-1){var D=N._result;D=D(),D.then(function(P){(N._status===0||N._status===-1)&&(N._status=1,N._result=P)},function(P){(N._status===0||N._status===-1)&&(N._status=2,N._result=P)}),N._status===-1&&(N._status=0,N._result=D)}if(N._status===1)return N._result.default;throw N._result}var ge=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)},pe={map:U,forEach:function(N,D,P){U(N,function(){D.apply(this,arguments)},P)},count:function(N){var D=0;return U(N,function(){D++}),D},toArray:function(N){return U(N,function(D){return D})||[]},only:function(N){if(!fe(N))throw Error("React.Children.only expected to receive a single React element child.");return N}};return Be.Activity=_,Be.Children=pe,Be.Component=T,Be.Fragment=r,Be.Profiler=u,Be.PureComponent=B,Be.StrictMode=l,Be.Suspense=p,Be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Be.__COMPILER_RUNTIME={__proto__:null,c:function(N){return L.H.useMemoCache(N)}},Be.cache=function(N){return function(){return N.apply(null,arguments)}},Be.cacheSignal=function(){return null},Be.cloneElement=function(N,D,P){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var J=A({},N.props),he=N.key;if(D!=null)for(le in D.key!==void 0&&(he=""+D.key),D)!V.call(D,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&D.ref===void 0||(J[le]=D[le]);var le=arguments.length-2;if(le===1)J.children=P;else if(1<le){for(var O=Array(le),te=0;te<le;te++)O[te]=arguments[te+2];J.children=O}return ye(N.type,he,J)},Be.createContext=function(N){return N={$$typeof:h,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:d,_context:N},N},Be.createElement=function(N,D,P){var J,he={},le=null;if(D!=null)for(J in D.key!==void 0&&(le=""+D.key),D)V.call(D,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(he[J]=D[J]);var O=arguments.length-2;if(O===1)he.children=P;else if(1<O){for(var te=Array(O),me=0;me<O;me++)te[me]=arguments[me+2];he.children=te}if(N&&N.defaultProps)for(J in O=N.defaultProps,O)he[J]===void 0&&(he[J]=O[J]);return ye(N,le,he)},Be.createRef=function(){return{current:null}},Be.forwardRef=function(N){return{$$typeof:g,render:N}},Be.isValidElement=fe,Be.lazy=function(N){return{$$typeof:v,_payload:{_status:-1,_result:N},_init:ee}},Be.memo=function(N,D){return{$$typeof:m,type:N,compare:D===void 0?null:D}},Be.startTransition=function(N){var D=L.T,P={};L.T=P;try{var J=N(),he=L.S;he!==null&&he(P,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(M,ge)}catch(le){ge(le)}finally{D!==null&&P.types!==null&&(D.types=P.types),L.T=D}},Be.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Be.use=function(N){return L.H.use(N)},Be.useActionState=function(N,D,P){return L.H.useActionState(N,D,P)},Be.useCallback=function(N,D){return L.H.useCallback(N,D)},Be.useContext=function(N){return L.H.useContext(N)},Be.useDebugValue=function(){},Be.useDeferredValue=function(N,D){return L.H.useDeferredValue(N,D)},Be.useEffect=function(N,D){return L.H.useEffect(N,D)},Be.useEffectEvent=function(N){return L.H.useEffectEvent(N)},Be.useId=function(){return L.H.useId()},Be.useImperativeHandle=function(N,D,P){return L.H.useImperativeHandle(N,D,P)},Be.useInsertionEffect=function(N,D){return L.H.useInsertionEffect(N,D)},Be.useLayoutEffect=function(N,D){return L.H.useLayoutEffect(N,D)},Be.useMemo=function(N,D){return L.H.useMemo(N,D)},Be.useOptimistic=function(N,D){return L.H.useOptimistic(N,D)},Be.useReducer=function(N,D,P){return L.H.useReducer(N,D,P)},Be.useRef=function(N){return L.H.useRef(N)},Be.useState=function(N){return L.H.useState(N)},Be.useSyncExternalStore=function(N,D,P){return L.H.useSyncExternalStore(N,D,P)},Be.useTransition=function(){return L.H.useTransition()},Be.version="19.2.0",Be}var Cg;function Au(){return Cg||(Cg=1,iu.exports=yv()),iu.exports}var ru={exports:{}},Vt={};var Tg;function vv(){if(Tg)return Vt;Tg=1;var o=Au();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var l={d:{f:r,r:function(){throw Error(a(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:_==null?null:""+_,children:p,containerInfo:m,implementation:v}}var h=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Vt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Vt.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},Vt.flushSync=function(p){var m=h.T,v=l.p;try{if(h.T=null,l.p=2,p)return p()}finally{h.T=m,l.p=v,l.d.f()}},Vt.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},Vt.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Vt.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin),x=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:x,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:_,integrity:x,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Vt.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},Vt.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Vt.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},Vt.requestFormReset=function(p){l.d.r(p)},Vt.unstable_batchedUpdates=function(p,m){return p(m)},Vt.useFormState=function(p,m,v){return h.H.useFormState(p,m,v)},Vt.useFormStatus=function(){return h.H.useHostTransitionStatus()},Vt.version="19.2.0",Vt}var Ag;function cp(){if(Ag)return ru.exports;Ag=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),ru.exports=vv(),ru.exports}var Ng;function bv(){if(Ng)return ts;Ng=1;var o=mv(),a=Au(),r=cp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,i=t;;){var c=n.return;if(c===null)break;var f=c.alternate;if(f===null){if(i=c.return,i!==null){n=i;continue}break}if(c.child===f.child){for(f=c.child;f;){if(f===n)return p(c),e;if(f===i)return p(c),t;f=f.sibling}throw Error(l(188))}if(n.return!==i.return)n=c,i=f;else{for(var y=!1,j=c.child;j;){if(j===n){y=!0,n=c,i=f;break}if(j===i){y=!0,i=c,n=f;break}j=j.sibling}if(!y){for(j=f.child;j;){if(j===n){y=!0,n=f,i=c;break}if(j===i){y=!0,i=f,n=c;break}j=j.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==i)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var _=Object.assign,x=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),B=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),ye=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),fe=Symbol.iterator;function xe(e){return e===null||typeof e!="object"?null:(e=fe&&e[fe]||e["@@iterator"],typeof e=="function"?e:null)}var q=Symbol.for("react.client.reference");function X(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case A:return"Fragment";case T:return"Profiler";case R:return"StrictMode";case E:return"Suspense";case M:return"SuspenseList";case ye:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case B:return e.displayName||"Context";case I:return(e._context.displayName||"Context")+".Consumer";case K:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case L:return t=e.displayName||null,t!==null?t:X(e.type)||"Memo";case V:t=e._payload,e=e._init;try{return X(e(t))}catch{}}return null}var W=Array.isArray,C=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},ge=[],pe=-1;function N(e){return{current:e}}function D(e){0>pe||(e.current=ge[pe],ge[pe]=null,pe--)}function P(e,t){pe++,ge[pe]=e.current,e.current=t}var J=N(null),he=N(null),le=N(null),O=N(null);function te(e,t){switch(P(le,t),P(he,e),P(J,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Ph(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Ph(t),e=Gh(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}D(J),P(J,e)}function me(){D(J),D(he),D(le)}function we(e){e.memoizedState!==null&&P(O,e);var t=J.current,n=Gh(t,e.type);t!==n&&(P(he,e),P(J,n))}function Te(e){he.current===e&&(D(J),D(he)),O.current===e&&(D(O),Qr._currentValue=ee)}var ke,Le;function $e(e){if(ke===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ke=t&&t[1]||"",Le=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ke+e+Le}var ut=!1;function mt(e,t){if(!e||ut)return"";ut=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var de=function(){throw Error()};if(Object.defineProperty(de.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(de,[])}catch(Z){var F=Z}Reflect.construct(e,[],de)}else{try{de.call()}catch(Z){F=Z}e.call(de.prototype)}}else{try{throw Error()}catch(Z){F=Z}(de=e())&&typeof de.catch=="function"&&de.catch(function(){})}}catch(Z){if(Z&&F&&typeof Z.stack=="string")return[Z.stack,F.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=i.DetermineComponentFrameRoot(),y=f[0],j=f[1];if(y&&j){var k=y.split(`
`),Y=j.split(`
`);for(c=i=0;i<k.length&&!k[i].includes("DetermineComponentFrameRoot");)i++;for(;c<Y.length&&!Y[c].includes("DetermineComponentFrameRoot");)c++;if(i===k.length||c===Y.length)for(i=k.length-1,c=Y.length-1;1<=i&&0<=c&&k[i]!==Y[c];)c--;for(;1<=i&&0<=c;i--,c--)if(k[i]!==Y[c]){if(i!==1||c!==1)do if(i--,c--,0>c||k[i]!==Y[c]){var re=`
`+k[i].replace(" at new "," at ");return e.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",e.displayName)),re}while(1<=i&&0<=c);break}}}finally{ut=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?$e(n):""}function dt(e,t){switch(e.tag){case 26:case 27:case 5:return $e(e.type);case 16:return $e("Lazy");case 13:return e.child!==t&&t!==null?$e("Suspense Fallback"):$e("Suspense");case 19:return $e("SuspenseList");case 0:case 15:return mt(e.type,!1);case 11:return mt(e.type.render,!1);case 1:return mt(e.type,!0);case 31:return $e("Activity");default:return""}}function wt(e){try{var t="",n=null;do t+=dt(e,n),n=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var Ht=Object.prototype.hasOwnProperty,ot=o.unstable_scheduleCallback,Ze=o.unstable_cancelCallback,Ua=o.unstable_shouldYield,oi=o.unstable_requestPaint,Gt=o.unstable_now,ir=o.unstable_getCurrentPriorityLevel,rr=o.unstable_ImmediatePriority,ci=o.unstable_UserBlockingPriority,ui=o.unstable_NormalPriority,cs=o.unstable_LowPriority,sr=o.unstable_IdlePriority,Hl=o.log,$l=o.unstable_setDisableYieldValue,za=null,Kt=null;function tn(e){if(typeof Hl=="function"&&$l(e),Kt&&typeof Kt.setStrictMode=="function")try{Kt.setStrictMode(za,e)}catch{}}var Yt=Math.clz32?Math.clz32:Gl,Vl=Math.log,Pl=Math.LN2;function Gl(e){return e>>>=0,e===0?32:31-(Vl(e)/Pl|0)|0}var di=256,Da=262144,La=4194304;function Mn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function pn(e,t,n){var i=e.pendingLanes;if(i===0)return 0;var c=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var j=i&134217727;return j!==0?(i=j&~f,i!==0?c=Mn(i):(y&=j,y!==0?c=Mn(y):n||(n=j&~e,n!==0&&(c=Mn(n))))):(j=i&~f,j!==0?c=Mn(j):y!==0?c=Mn(y):n||(n=i&~e,n!==0&&(c=Mn(n)))),c===0?0:t!==0&&t!==c&&(t&f)===0&&(f=c&-c,n=t&-t,f>=n||f===32&&(n&4194048)!==0)?t:c}function nn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function us(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ds(){var e=La;return La<<=1,(La&62914560)===0&&(La=4194304),e}function lr(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function qn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Kl(e,t,n,i,c,f){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var j=e.entanglements,k=e.expirationTimes,Y=e.hiddenUpdates;for(n=y&~n;0<n;){var re=31-Yt(n),de=1<<re;j[re]=0,k[re]=-1;var F=Y[re];if(F!==null)for(Y[re]=null,re=0;re<F.length;re++){var Z=F[re];Z!==null&&(Z.lane&=-536870913)}n&=~de}i!==0&&fi(e,i,0),f!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function fi(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-Yt(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&261930}function ra(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Yt(n),c=1<<i;c&t|e[i]&t&&(e[i]|=t),n&=~c}}function fs(e,t){var n=t&-t;return n=(n&42)!==0?1:or(n),(n&(e.suspendedLanes|t))!==0?0:n}function or(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function cr(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ur(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:gg(e.type))}function hs(e,t){var n=U.p;try{return U.p=e,t()}finally{U.p=n}}var mn=Math.random().toString(36).slice(2),ft="__reactFiber$"+mn,$t="__reactProps$"+mn,In="__reactContainer$"+mn,hi="__reactEvents$"+mn,Yl="__reactListeners$"+mn,Fl="__reactHandles$"+mn,gs="__reactResources$"+mn,H="__reactMarker$"+mn;function ie(e){delete e[ft],delete e[$t],delete e[hi],delete e[Yl],delete e[Fl]}function _e(e){var t=e[ft];if(t)return t;for(var n=e.parentNode;n;){if(t=n[In]||n[ft]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Zh(e);e!==null;){if(n=e[ft])return n;e=Zh(e)}return t}e=n,n=e.parentNode}return null}function oe(e){if(e=e[ft]||e[In]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function be(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function ve(e){var t=e[gs];return t||(t=e[gs]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function se(e){e[H]=!0}var je=new Set,ue={};function ne(e,t){Oe(e,t),Oe(e+"Capture",t)}function Oe(e,t){for(ue[e]=t,e=0;e<t.length;e++)je.add(t[e])}var Ne=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},an={};function ht(e){return Ht.call(an,e)?!0:Ht.call(Me,e)?!1:Ne.test(e)?an[e]=!0:(Me[e]=!0,!1)}function rt(e,t,n){if(ht(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function st(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Dt(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function bt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function gi(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ps(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,f=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ba(e){if(!e._valueTracker){var t=gi(e)?"checked":"value";e._valueTracker=ps(e,t,""+e[t])}}function sa(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=gi(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function rn(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var De=/[\n"\\]/g;function Ve(e){return e.replace(De,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Et(e,t,n,i,c,f,y,j){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+bt(t)):e.value!==""+bt(t)&&(e.value=""+bt(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?tt(e,y,bt(t)):n!=null?tt(e,y,bt(n)):i!=null&&e.removeAttribute("value"),c==null&&f!=null&&(e.defaultChecked=!!f),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?e.name=""+bt(j):e.removeAttribute("name")}function qe(e,t,n,i,c,f,y,j){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||n!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){Ba(e);return}n=n!=null?""+bt(n):"",t=t!=null?""+bt(t):n,j||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=j?e.checked:!!i,e.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Ba(e)}function tt(e,t,n){t==="number"&&rn(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ct(e,t,n,i){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&i&&(e[n].defaultSelected=!0)}else{for(n=""+bt(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function dr(e,t,n){if(t!=null&&(t=""+bt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+bt(n):""}function fr(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(l(92));if(W(i)){if(1<i.length)throw Error(l(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=bt(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i),Ba(e)}function pi(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var sm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Iu(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||sm.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Hu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&n[c]!==i&&Iu(e,c,i)}else for(var f in t)t.hasOwnProperty(f)&&Iu(e,f,t[f])}function Jl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),om=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(e){return om.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Hn(){}var Ql=null;function Xl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var mi=null,yi=null;function $u(e){var t=oe(e);if(t&&(e=t.stateNode)){var n=e[$t]||null;e:switch(e=t.stateNode,t.type){case"input":if(Et(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Ve(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var c=i[$t]||null;if(!c)throw Error(l(90));Et(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&sa(i)}break e;case"textarea":dr(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Ct(e,!!n.multiple,t,!1)}}}var Zl=!1;function Vu(e,t,n){if(Zl)return e(t,n);Zl=!0;try{var i=e(t);return i}finally{if(Zl=!1,(mi!==null||yi!==null)&&(al(),mi&&(t=mi,e=yi,yi=mi=null,$u(t),e)))for(t=0;t<e.length;t++)$u(e[t])}}function hr(e,t){var n=e.stateNode;if(n===null)return null;var i=n[$t]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var $n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wl=!1;if($n)try{var gr={};Object.defineProperty(gr,"passive",{get:function(){Wl=!0}}),window.addEventListener("test",gr,gr),window.removeEventListener("test",gr,gr)}catch{Wl=!1}var la=null,eo=null,ys=null;function Pu(){if(ys)return ys;var e,t=eo,n=t.length,i,c="value"in la?la.value:la.textContent,f=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(i=1;i<=y&&t[n-i]===c[f-i];i++);return ys=c.slice(e,1<i?1-i:void 0)}function vs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bs(){return!0}function Gu(){return!1}function Jt(e){function t(n,i,c,f,y){this._reactName=n,this._targetInst=c,this.type=i,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(n=e[j],this[j]=n?n(f):f[j]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?bs:Gu,this.isPropagationStopped=Gu,this}return _(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),t}var Ma={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_s=Jt(Ma),pr=_({},Ma,{view:0,detail:0}),cm=Jt(pr),to,no,mr,xs=_({},pr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:io,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mr&&(mr&&e.type==="mousemove"?(to=e.screenX-mr.screenX,no=e.screenY-mr.screenY):no=to=0,mr=e),to)},movementY:function(e){return"movementY"in e?e.movementY:no}}),Ku=Jt(xs),um=_({},xs,{dataTransfer:0}),dm=Jt(um),fm=_({},pr,{relatedTarget:0}),ao=Jt(fm),hm=_({},Ma,{animationName:0,elapsedTime:0,pseudoElement:0}),gm=Jt(hm),pm=_({},Ma,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),mm=Jt(pm),ym=_({},Ma,{data:0}),Yu=Jt(ym),vm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_m={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_m[e])?!!t[e]:!1}function io(){return xm}var jm=_({},pr,{key:function(e){if(e.key){var t=vm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?bm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:io,charCode:function(e){return e.type==="keypress"?vs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Sm=Jt(jm),wm=_({},xs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fu=Jt(wm),Em=_({},pr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:io}),Cm=Jt(Em),Tm=_({},Ma,{propertyName:0,elapsedTime:0,pseudoElement:0}),Am=Jt(Tm),Nm=_({},xs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rm=Jt(Nm),Om=_({},Ma,{newState:0,oldState:0}),km=Jt(Om),Um=[9,13,27,32],ro=$n&&"CompositionEvent"in window,yr=null;$n&&"documentMode"in document&&(yr=document.documentMode);var zm=$n&&"TextEvent"in window&&!yr,Ju=$n&&(!ro||yr&&8<yr&&11>=yr),Qu=" ",Xu=!1;function Zu(e,t){switch(e){case"keyup":return Um.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vi=!1;function Dm(e,t){switch(e){case"compositionend":return Wu(t);case"keypress":return t.which!==32?null:(Xu=!0,Qu);case"textInput":return e=t.data,e===Qu&&Xu?null:e;default:return null}}function Lm(e,t){if(vi)return e==="compositionend"||!ro&&Zu(e,t)?(e=Pu(),ys=eo=la=null,vi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ju&&t.locale!=="ko"?null:t.data;default:return null}}var Bm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bm[e.type]:t==="textarea"}function td(e,t,n,i){mi?yi?yi.push(i):yi=[i]:mi=i,t=ul(t,"onChange"),0<t.length&&(n=new _s("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var vr=null,br=null;function Mm(e){Mh(e,0)}function js(e){var t=be(e);if(sa(t))return e}function nd(e,t){if(e==="change")return t}var ad=!1;if($n){var so;if($n){var lo="oninput"in document;if(!lo){var id=document.createElement("div");id.setAttribute("oninput","return;"),lo=typeof id.oninput=="function"}so=lo}else so=!1;ad=so&&(!document.documentMode||9<document.documentMode)}function rd(){vr&&(vr.detachEvent("onpropertychange",sd),br=vr=null)}function sd(e){if(e.propertyName==="value"&&js(br)){var t=[];td(t,br,e,Xl(e)),Vu(Mm,t)}}function qm(e,t,n){e==="focusin"?(rd(),vr=t,br=n,vr.attachEvent("onpropertychange",sd)):e==="focusout"&&rd()}function Im(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return js(br)}function Hm(e,t){if(e==="click")return js(t)}function $m(e,t){if(e==="input"||e==="change")return js(t)}function Vm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sn=typeof Object.is=="function"?Object.is:Vm;function _r(e,t){if(sn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var c=n[i];if(!Ht.call(t,c)||!sn(e[c],t[c]))return!1}return!0}function ld(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function od(e,t){var n=ld(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ld(n)}}function cd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ud(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=rn(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=rn(e.document)}return t}function oo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Pm=$n&&"documentMode"in document&&11>=document.documentMode,bi=null,co=null,xr=null,uo=!1;function dd(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;uo||bi==null||bi!==rn(i)||(i=bi,"selectionStart"in i&&oo(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),xr&&_r(xr,i)||(xr=i,i=ul(co,"onSelect"),0<i.length&&(t=new _s("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=bi)))}function qa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _i={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionrun:qa("Transition","TransitionRun"),transitionstart:qa("Transition","TransitionStart"),transitioncancel:qa("Transition","TransitionCancel"),transitionend:qa("Transition","TransitionEnd")},fo={},fd={};$n&&(fd=document.createElement("div").style,"AnimationEvent"in window||(delete _i.animationend.animation,delete _i.animationiteration.animation,delete _i.animationstart.animation),"TransitionEvent"in window||delete _i.transitionend.transition);function Ia(e){if(fo[e])return fo[e];if(!_i[e])return e;var t=_i[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in fd)return fo[e]=t[n];return e}var hd=Ia("animationend"),gd=Ia("animationiteration"),pd=Ia("animationstart"),Gm=Ia("transitionrun"),Km=Ia("transitionstart"),Ym=Ia("transitioncancel"),md=Ia("transitionend"),yd=new Map,ho="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ho.push("scrollEnd");function An(e,t){yd.set(e,t),ne(t,[e])}var Ss=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},yn=[],xi=0,go=0;function ws(){for(var e=xi,t=go=xi=0;t<e;){var n=yn[t];yn[t++]=null;var i=yn[t];yn[t++]=null;var c=yn[t];yn[t++]=null;var f=yn[t];if(yn[t++]=null,i!==null&&c!==null){var y=i.pending;y===null?c.next=c:(c.next=y.next,y.next=c),i.pending=c}f!==0&&vd(n,c,f)}}function Es(e,t,n,i){yn[xi++]=e,yn[xi++]=t,yn[xi++]=n,yn[xi++]=i,go|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function po(e,t,n,i){return Es(e,t,n,i),Cs(e)}function Ha(e,t){return Es(e,null,null,t),Cs(e)}function vd(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var c=!1,f=e.return;f!==null;)f.childLanes|=n,i=f.alternate,i!==null&&(i.childLanes|=n),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(c=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,c&&t!==null&&(c=31-Yt(n),e=f.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=n|536870912),f):null}function Cs(e){if(50<Vr)throw Vr=0,wc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var ji={};function Fm(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(e,t,n,i){return new Fm(e,t,n,i)}function mo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Vn(e,t){var n=e.alternate;return n===null?(n=ln(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function bd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ts(e,t,n,i,c,f){var y=0;if(i=e,typeof e=="function")mo(e)&&(y=1);else if(typeof e=="string")y=Wy(e,n,J.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ye:return e=ln(31,n,t,c),e.elementType=ye,e.lanes=f,e;case A:return $a(n.children,c,f,t);case R:y=8,c|=24;break;case T:return e=ln(12,n,t,c|2),e.elementType=T,e.lanes=f,e;case E:return e=ln(13,n,t,c),e.elementType=E,e.lanes=f,e;case M:return e=ln(19,n,t,c),e.elementType=M,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B:y=10;break e;case I:y=9;break e;case K:y=11;break e;case L:y=14;break e;case V:y=16,i=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),i=null}return t=ln(y,n,t,c),t.elementType=e,t.type=i,t.lanes=f,t}function $a(e,t,n,i){return e=ln(7,e,i,t),e.lanes=n,e}function yo(e,t,n){return e=ln(6,e,null,t),e.lanes=n,e}function _d(e){var t=ln(18,null,null,0);return t.stateNode=e,t}function vo(e,t,n){return t=ln(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var xd=new WeakMap;function vn(e,t){if(typeof e=="object"&&e!==null){var n=xd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:wt(t)},xd.set(e,t),t)}return{value:e,source:t,stack:wt(t)}}var Si=[],wi=0,As=null,jr=0,bn=[],_n=0,oa=null,zn=1,Dn="";function Pn(e,t){Si[wi++]=jr,Si[wi++]=As,As=e,jr=t}function jd(e,t,n){bn[_n++]=zn,bn[_n++]=Dn,bn[_n++]=oa,oa=e;var i=zn;e=Dn;var c=32-Yt(i)-1;i&=~(1<<c),n+=1;var f=32-Yt(t)+c;if(30<f){var y=c-c%5;f=(i&(1<<y)-1).toString(32),i>>=y,c-=y,zn=1<<32-Yt(t)+c|n<<c|i,Dn=f+e}else zn=1<<f|n<<c|i,Dn=e}function bo(e){e.return!==null&&(Pn(e,1),jd(e,1,0))}function _o(e){for(;e===As;)As=Si[--wi],Si[wi]=null,jr=Si[--wi],Si[wi]=null;for(;e===oa;)oa=bn[--_n],bn[_n]=null,Dn=bn[--_n],bn[_n]=null,zn=bn[--_n],bn[_n]=null}function Sd(e,t){bn[_n++]=zn,bn[_n++]=Dn,bn[_n++]=oa,zn=t.id,Dn=t.overflow,oa=e}var Lt=null,gt=null,Fe=!1,ca=null,xn=!1,xo=Error(l(519));function ua(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Sr(vn(t,e)),xo}function wd(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[ft]=e,t[$t]=i,n){case"dialog":Ge("cancel",t),Ge("close",t);break;case"iframe":case"object":case"embed":Ge("load",t);break;case"video":case"audio":for(n=0;n<Gr.length;n++)Ge(Gr[n],t);break;case"source":Ge("error",t);break;case"img":case"image":case"link":Ge("error",t),Ge("load",t);break;case"details":Ge("toggle",t);break;case"input":Ge("invalid",t),qe(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Ge("invalid",t);break;case"textarea":Ge("invalid",t),fr(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||$h(t.textContent,n)?(i.popover!=null&&(Ge("beforetoggle",t),Ge("toggle",t)),i.onScroll!=null&&Ge("scroll",t),i.onScrollEnd!=null&&Ge("scrollend",t),i.onClick!=null&&(t.onclick=Hn),t=!0):t=!1,t||ua(e,!0)}function Ed(e){for(Lt=e.return;Lt;)switch(Lt.tag){case 5:case 31:case 13:xn=!1;return;case 27:case 3:xn=!0;return;default:Lt=Lt.return}}function Ei(e){if(e!==Lt)return!1;if(!Fe)return Ed(e),Fe=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||qc(e.type,e.memoizedProps)),n=!n),n&&gt&&ua(e),Ed(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));gt=Xh(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));gt=Xh(e)}else t===27?(t=gt,wa(e.type)?(e=Pc,Pc=null,gt=e):gt=t):gt=Lt?Sn(e.stateNode.nextSibling):null;return!0}function Va(){gt=Lt=null,Fe=!1}function jo(){var e=ca;return e!==null&&(Wt===null?Wt=e:Wt.push.apply(Wt,e),ca=null),e}function Sr(e){ca===null?ca=[e]:ca.push(e)}var So=N(null),Pa=null,Gn=null;function da(e,t,n){P(So,t._currentValue),t._currentValue=n}function Kn(e){e._currentValue=So.current,D(So)}function wo(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Eo(e,t,n,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){var y=c.child;f=f.firstContext;e:for(;f!==null;){var j=f;f=c;for(var k=0;k<t.length;k++)if(j.context===t[k]){f.lanes|=n,j=f.alternate,j!==null&&(j.lanes|=n),wo(f.return,n,e),i||(y=null);break e}f=j.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,f=y.alternate,f!==null&&(f.lanes|=n),wo(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function Ci(e,t,n,i){e=null;for(var c=t,f=!1;c!==null;){if(!f){if((c.flags&524288)!==0)f=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var j=c.type;sn(c.pendingProps.value,y.value)||(e!==null?e.push(j):e=[j])}}else if(c===O.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Qr):e=[Qr])}c=c.return}e!==null&&Eo(t,e,n,i),t.flags|=262144}function Ns(e){for(e=e.firstContext;e!==null;){if(!sn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ga(e){Pa=e,Gn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Bt(e){return Cd(Pa,e)}function Rs(e,t){return Pa===null&&Ga(e),Cd(e,t)}function Cd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Gn===null){if(e===null)throw Error(l(308));Gn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Gn=Gn.next=t;return n}var Jm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Qm=o.unstable_scheduleCallback,Xm=o.unstable_NormalPriority,Tt={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Co(){return{controller:new Jm,data:new Map,refCount:0}}function wr(e){e.refCount--,e.refCount===0&&Qm(Xm,function(){e.controller.abort()})}var Er=null,To=0,Ti=0,Ai=null;function Zm(e,t){if(Er===null){var n=Er=[];To=0,Ti=Rc(),Ai={status:"pending",value:void 0,then:function(i){n.push(i)}}}return To++,t.then(Td,Td),t}function Td(){if(--To===0&&Er!==null){Ai!==null&&(Ai.status="fulfilled");var e=Er;Er=null,Ti=0,Ai=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Wm(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),i}var Ad=C.S;C.S=function(e,t){fh=Gt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Zm(e,t),Ad!==null&&Ad(e,t)};var Ka=N(null);function Ao(){var e=Ka.current;return e!==null?e:lt.pooledCache}function Os(e,t){t===null?P(Ka,Ka.current):P(Ka,t.pool)}function Nd(){var e=Ao();return e===null?null:{parent:Tt._currentValue,pool:e}}var Ni=Error(l(460)),No=Error(l(474)),ks=Error(l(542)),Us={then:function(){}};function Rd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Od(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Hn,Hn),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ud(e),e;default:if(typeof t.status=="string")t.then(Hn,Hn);else{if(e=lt,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ud(e),e}throw Fa=t,Ni}}function Ya(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Fa=n,Ni):n}}var Fa=null;function kd(){if(Fa===null)throw Error(l(459));var e=Fa;return Fa=null,e}function Ud(e){if(e===Ni||e===ks)throw Error(l(483))}var Ri=null,Cr=0;function zs(e){var t=Cr;return Cr+=1,Ri===null&&(Ri=[]),Od(Ri,e,t)}function Tr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ds(e,t){throw t.$$typeof===x?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function zd(e){function t($,z){if(e){var G=$.deletions;G===null?($.deletions=[z],$.flags|=16):G.push(z)}}function n($,z){if(!e)return null;for(;z!==null;)t($,z),z=z.sibling;return null}function i($){for(var z=new Map;$!==null;)$.key!==null?z.set($.key,$):z.set($.index,$),$=$.sibling;return z}function c($,z){return $=Vn($,z),$.index=0,$.sibling=null,$}function f($,z,G){return $.index=G,e?(G=$.alternate,G!==null?(G=G.index,G<z?($.flags|=67108866,z):G):($.flags|=67108866,z)):($.flags|=1048576,z)}function y($){return e&&$.alternate===null&&($.flags|=67108866),$}function j($,z,G,ce){return z===null||z.tag!==6?(z=yo(G,$.mode,ce),z.return=$,z):(z=c(z,G),z.return=$,z)}function k($,z,G,ce){var Re=G.type;return Re===A?re($,z,G.props.children,ce,G.key):z!==null&&(z.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===V&&Ya(Re)===z.type)?(z=c(z,G.props),Tr(z,G),z.return=$,z):(z=Ts(G.type,G.key,G.props,null,$.mode,ce),Tr(z,G),z.return=$,z)}function Y($,z,G,ce){return z===null||z.tag!==4||z.stateNode.containerInfo!==G.containerInfo||z.stateNode.implementation!==G.implementation?(z=vo(G,$.mode,ce),z.return=$,z):(z=c(z,G.children||[]),z.return=$,z)}function re($,z,G,ce,Re){return z===null||z.tag!==7?(z=$a(G,$.mode,ce,Re),z.return=$,z):(z=c(z,G),z.return=$,z)}function de($,z,G){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=yo(""+z,$.mode,G),z.return=$,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case b:return G=Ts(z.type,z.key,z.props,null,$.mode,G),Tr(G,z),G.return=$,G;case w:return z=vo(z,$.mode,G),z.return=$,z;case V:return z=Ya(z),de($,z,G)}if(W(z)||xe(z))return z=$a(z,$.mode,G,null),z.return=$,z;if(typeof z.then=="function")return de($,zs(z),G);if(z.$$typeof===B)return de($,Rs($,z),G);Ds($,z)}return null}function F($,z,G,ce){var Re=z!==null?z.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return Re!==null?null:j($,z,""+G,ce);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case b:return G.key===Re?k($,z,G,ce):null;case w:return G.key===Re?Y($,z,G,ce):null;case V:return G=Ya(G),F($,z,G,ce)}if(W(G)||xe(G))return Re!==null?null:re($,z,G,ce,null);if(typeof G.then=="function")return F($,z,zs(G),ce);if(G.$$typeof===B)return F($,z,Rs($,G),ce);Ds($,G)}return null}function Z($,z,G,ce,Re){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return $=$.get(G)||null,j(z,$,""+ce,Re);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:return $=$.get(ce.key===null?G:ce.key)||null,k(z,$,ce,Re);case w:return $=$.get(ce.key===null?G:ce.key)||null,Y(z,$,ce,Re);case V:return ce=Ya(ce),Z($,z,G,ce,Re)}if(W(ce)||xe(ce))return $=$.get(G)||null,re(z,$,ce,Re,null);if(typeof ce.then=="function")return Z($,z,G,zs(ce),Re);if(ce.$$typeof===B)return Z($,z,G,Rs(z,ce),Re);Ds(z,ce)}return null}function Se($,z,G,ce){for(var Re=null,Je=null,Ee=z,He=z=0,Ye=null;Ee!==null&&He<G.length;He++){Ee.index>He?(Ye=Ee,Ee=null):Ye=Ee.sibling;var Qe=F($,Ee,G[He],ce);if(Qe===null){Ee===null&&(Ee=Ye);break}e&&Ee&&Qe.alternate===null&&t($,Ee),z=f(Qe,z,He),Je===null?Re=Qe:Je.sibling=Qe,Je=Qe,Ee=Ye}if(He===G.length)return n($,Ee),Fe&&Pn($,He),Re;if(Ee===null){for(;He<G.length;He++)Ee=de($,G[He],ce),Ee!==null&&(z=f(Ee,z,He),Je===null?Re=Ee:Je.sibling=Ee,Je=Ee);return Fe&&Pn($,He),Re}for(Ee=i(Ee);He<G.length;He++)Ye=Z(Ee,$,He,G[He],ce),Ye!==null&&(e&&Ye.alternate!==null&&Ee.delete(Ye.key===null?He:Ye.key),z=f(Ye,z,He),Je===null?Re=Ye:Je.sibling=Ye,Je=Ye);return e&&Ee.forEach(function(Na){return t($,Na)}),Fe&&Pn($,He),Re}function Ue($,z,G,ce){if(G==null)throw Error(l(151));for(var Re=null,Je=null,Ee=z,He=z=0,Ye=null,Qe=G.next();Ee!==null&&!Qe.done;He++,Qe=G.next()){Ee.index>He?(Ye=Ee,Ee=null):Ye=Ee.sibling;var Na=F($,Ee,Qe.value,ce);if(Na===null){Ee===null&&(Ee=Ye);break}e&&Ee&&Na.alternate===null&&t($,Ee),z=f(Na,z,He),Je===null?Re=Na:Je.sibling=Na,Je=Na,Ee=Ye}if(Qe.done)return n($,Ee),Fe&&Pn($,He),Re;if(Ee===null){for(;!Qe.done;He++,Qe=G.next())Qe=de($,Qe.value,ce),Qe!==null&&(z=f(Qe,z,He),Je===null?Re=Qe:Je.sibling=Qe,Je=Qe);return Fe&&Pn($,He),Re}for(Ee=i(Ee);!Qe.done;He++,Qe=G.next())Qe=Z(Ee,$,He,Qe.value,ce),Qe!==null&&(e&&Qe.alternate!==null&&Ee.delete(Qe.key===null?He:Qe.key),z=f(Qe,z,He),Je===null?Re=Qe:Je.sibling=Qe,Je=Qe);return e&&Ee.forEach(function(uv){return t($,uv)}),Fe&&Pn($,He),Re}function it($,z,G,ce){if(typeof G=="object"&&G!==null&&G.type===A&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case b:e:{for(var Re=G.key;z!==null;){if(z.key===Re){if(Re=G.type,Re===A){if(z.tag===7){n($,z.sibling),ce=c(z,G.props.children),ce.return=$,$=ce;break e}}else if(z.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===V&&Ya(Re)===z.type){n($,z.sibling),ce=c(z,G.props),Tr(ce,G),ce.return=$,$=ce;break e}n($,z);break}else t($,z);z=z.sibling}G.type===A?(ce=$a(G.props.children,$.mode,ce,G.key),ce.return=$,$=ce):(ce=Ts(G.type,G.key,G.props,null,$.mode,ce),Tr(ce,G),ce.return=$,$=ce)}return y($);case w:e:{for(Re=G.key;z!==null;){if(z.key===Re)if(z.tag===4&&z.stateNode.containerInfo===G.containerInfo&&z.stateNode.implementation===G.implementation){n($,z.sibling),ce=c(z,G.children||[]),ce.return=$,$=ce;break e}else{n($,z);break}else t($,z);z=z.sibling}ce=vo(G,$.mode,ce),ce.return=$,$=ce}return y($);case V:return G=Ya(G),it($,z,G,ce)}if(W(G))return Se($,z,G,ce);if(xe(G)){if(Re=xe(G),typeof Re!="function")throw Error(l(150));return G=Re.call(G),Ue($,z,G,ce)}if(typeof G.then=="function")return it($,z,zs(G),ce);if(G.$$typeof===B)return it($,z,Rs($,G),ce);Ds($,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,z!==null&&z.tag===6?(n($,z.sibling),ce=c(z,G),ce.return=$,$=ce):(n($,z),ce=yo(G,$.mode,ce),ce.return=$,$=ce),y($)):n($,z)}return function($,z,G,ce){try{Cr=0;var Re=it($,z,G,ce);return Ri=null,Re}catch(Ee){if(Ee===Ni||Ee===ks)throw Ee;var Je=ln(29,Ee,null,$.mode);return Je.lanes=ce,Je.return=$,Je}finally{}}}var Ja=zd(!0),Dd=zd(!1),fa=!1;function Ro(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ha(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ga(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Xe&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=Cs(e),vd(e,null,n),t}return Es(e,i,t,n),Cs(e)}function Ar(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,ra(e,n)}}function ko(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var c=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};f===null?c=f=y:f=f.next=y,n=n.next}while(n!==null);f===null?c=f=t:f=f.next=t}else c=f=t;n={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:f,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Uo=!1;function Nr(){if(Uo){var e=Ai;if(e!==null)throw e}}function Rr(e,t,n,i){Uo=!1;var c=e.updateQueue;fa=!1;var f=c.firstBaseUpdate,y=c.lastBaseUpdate,j=c.shared.pending;if(j!==null){c.shared.pending=null;var k=j,Y=k.next;k.next=null,y===null?f=Y:y.next=Y,y=k;var re=e.alternate;re!==null&&(re=re.updateQueue,j=re.lastBaseUpdate,j!==y&&(j===null?re.firstBaseUpdate=Y:j.next=Y,re.lastBaseUpdate=k))}if(f!==null){var de=c.baseState;y=0,re=Y=k=null,j=f;do{var F=j.lane&-536870913,Z=F!==j.lane;if(Z?(Ke&F)===F:(i&F)===F){F!==0&&F===Ti&&(Uo=!0),re!==null&&(re=re.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var Se=e,Ue=j;F=t;var it=n;switch(Ue.tag){case 1:if(Se=Ue.payload,typeof Se=="function"){de=Se.call(it,de,F);break e}de=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ue.payload,F=typeof Se=="function"?Se.call(it,de,F):Se,F==null)break e;de=_({},de,F);break e;case 2:fa=!0}}F=j.callback,F!==null&&(e.flags|=64,Z&&(e.flags|=8192),Z=c.callbacks,Z===null?c.callbacks=[F]:Z.push(F))}else Z={lane:F,tag:j.tag,payload:j.payload,callback:j.callback,next:null},re===null?(Y=re=Z,k=de):re=re.next=Z,y|=F;if(j=j.next,j===null){if(j=c.shared.pending,j===null)break;Z=j,j=Z.next,Z.next=null,c.lastBaseUpdate=Z,c.shared.pending=null}}while(!0);re===null&&(k=de),c.baseState=k,c.firstBaseUpdate=Y,c.lastBaseUpdate=re,f===null&&(c.shared.lanes=0),ba|=y,e.lanes=y,e.memoizedState=de}}function Ld(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function Bd(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Ld(n[e],t)}var Oi=N(null),Ls=N(0);function Md(e,t){e=ta,P(Ls,e),P(Oi,t),ta=e|t.baseLanes}function zo(){P(Ls,ta),P(Oi,Oi.current)}function Do(){ta=Ls.current,D(Oi),D(Ls)}var on=N(null),jn=null;function pa(e){var t=e.alternate;P(jt,jt.current&1),P(on,e),jn===null&&(t===null||Oi.current!==null||t.memoizedState!==null)&&(jn=e)}function Lo(e){P(jt,jt.current),P(on,e),jn===null&&(jn=e)}function qd(e){e.tag===22?(P(jt,jt.current),P(on,e),jn===null&&(jn=e)):ma()}function ma(){P(jt,jt.current),P(on,on.current)}function cn(e){D(on),jn===e&&(jn=null),D(jt)}var jt=N(0);function Bs(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||$c(n)||Vc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yn=0,Ie=null,nt=null,At=null,Ms=!1,ki=!1,Qa=!1,qs=0,Or=0,Ui=null,ey=0;function _t(){throw Error(l(321))}function Bo(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sn(e[n],t[n]))return!1;return!0}function Mo(e,t,n,i,c,f){return Yn=f,Ie=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,C.H=e===null||e.memoizedState===null?Sf:Wo,Qa=!1,f=n(i,c),Qa=!1,ki&&(f=Hd(t,n,i,c)),Id(e),f}function Id(e){C.H=zr;var t=nt!==null&&nt.next!==null;if(Yn=0,At=nt=Ie=null,Ms=!1,Or=0,Ui=null,t)throw Error(l(300));e===null||Nt||(e=e.dependencies,e!==null&&Ns(e)&&(Nt=!0))}function Hd(e,t,n,i){Ie=e;var c=0;do{if(ki&&(Ui=null),Or=0,ki=!1,25<=c)throw Error(l(301));if(c+=1,At=nt=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}C.H=wf,f=t(n,i)}while(ki);return f}function ty(){var e=C.H,t=e.useState()[0];return t=typeof t.then=="function"?kr(t):t,e=e.useState()[0],(nt!==null?nt.memoizedState:null)!==e&&(Ie.flags|=1024),t}function qo(){var e=qs!==0;return qs=0,e}function Io(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Ho(e){if(Ms){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ms=!1}Yn=0,At=nt=Ie=null,ki=!1,Or=qs=0,Ui=null}function Ft(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return At===null?Ie.memoizedState=At=e:At=At.next=e,At}function St(){if(nt===null){var e=Ie.alternate;e=e!==null?e.memoizedState:null}else e=nt.next;var t=At===null?Ie.memoizedState:At.next;if(t!==null)At=t,nt=e;else{if(e===null)throw Ie.alternate===null?Error(l(467)):Error(l(310));nt=e,e={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},At===null?Ie.memoizedState=At=e:At=At.next=e}return At}function Is(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kr(e){var t=Or;return Or+=1,Ui===null&&(Ui=[]),e=Od(Ui,e,t),t=Ie,(At===null?t.memoizedState:At.next)===null&&(t=t.alternate,C.H=t===null||t.memoizedState===null?Sf:Wo),e}function Hs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return kr(e);if(e.$$typeof===B)return Bt(e)}throw Error(l(438,String(e)))}function $o(e){var t=null,n=Ie.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=Ie.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Is(),Ie.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=Q;return t.index++,n}function Fn(e,t){return typeof t=="function"?t(e):t}function $s(e){var t=St();return Vo(t,nt,e)}function Vo(e,t,n){var i=e.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=n;var c=e.baseQueue,f=i.pending;if(f!==null){if(c!==null){var y=c.next;c.next=f.next,f.next=y}t.baseQueue=c=f,i.pending=null}if(f=e.baseState,c===null)e.memoizedState=f;else{t=c.next;var j=y=null,k=null,Y=t,re=!1;do{var de=Y.lane&-536870913;if(de!==Y.lane?(Ke&de)===de:(Yn&de)===de){var F=Y.revertLane;if(F===0)k!==null&&(k=k.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),de===Ti&&(re=!0);else if((Yn&F)===F){Y=Y.next,F===Ti&&(re=!0);continue}else de={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},k===null?(j=k=de,y=f):k=k.next=de,Ie.lanes|=F,ba|=F;de=Y.action,Qa&&n(f,de),f=Y.hasEagerState?Y.eagerState:n(f,de)}else F={lane:de,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},k===null?(j=k=F,y=f):k=k.next=F,Ie.lanes|=de,ba|=de;Y=Y.next}while(Y!==null&&Y!==t);if(k===null?y=f:k.next=j,!sn(f,e.memoizedState)&&(Nt=!0,re&&(n=Ai,n!==null)))throw n;e.memoizedState=f,e.baseState=y,e.baseQueue=k,i.lastRenderedState=f}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Po(e){var t=St(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var i=n.dispatch,c=n.pending,f=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do f=e(f,y.action),y=y.next;while(y!==c);sn(f,t.memoizedState)||(Nt=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,i]}function $d(e,t,n){var i=Ie,c=St(),f=Fe;if(f){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!sn((nt||c).memoizedState,n);if(y&&(c.memoizedState=n,Nt=!0),c=c.queue,Yo(Gd.bind(null,i,c,e),[e]),c.getSnapshot!==t||y||At!==null&&At.memoizedState.tag&1){if(i.flags|=2048,zi(9,{destroy:void 0},Pd.bind(null,i,c,n,t),null),lt===null)throw Error(l(349));f||(Yn&127)!==0||Vd(i,t,n)}return n}function Vd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ie.updateQueue,t===null?(t=Is(),Ie.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Pd(e,t,n,i){t.value=n,t.getSnapshot=i,Kd(t)&&Yd(e)}function Gd(e,t,n){return n(function(){Kd(t)&&Yd(e)})}function Kd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sn(e,n)}catch{return!0}}function Yd(e){var t=Ha(e,2);t!==null&&en(t,e,2)}function Go(e){var t=Ft();if(typeof e=="function"){var n=e;if(e=n(),Qa){tn(!0);try{n()}finally{tn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:e},t}function Fd(e,t,n,i){return e.baseState=n,Vo(e,nt,typeof i=="function"?i:Fn)}function ny(e,t,n,i,c){if(Gs(e))throw Error(l(485));if(e=t.action,e!==null){var f={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};C.T!==null?n(!0):f.isTransition=!1,i(f),n=t.pending,n===null?(f.next=t.pending=f,Jd(t,f)):(f.next=n.next,t.pending=n.next=f)}}function Jd(e,t){var n=t.action,i=t.payload,c=e.state;if(t.isTransition){var f=C.T,y={};C.T=y;try{var j=n(c,i),k=C.S;k!==null&&k(y,j),Qd(e,t,j)}catch(Y){Ko(e,t,Y)}finally{f!==null&&y.types!==null&&(f.types=y.types),C.T=f}}else try{f=n(c,i),Qd(e,t,f)}catch(Y){Ko(e,t,Y)}}function Qd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Xd(e,t,i)},function(i){return Ko(e,t,i)}):Xd(e,t,n)}function Xd(e,t,n){t.status="fulfilled",t.value=n,Zd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Jd(e,n)))}function Ko(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,Zd(t),t=t.next;while(t!==i)}e.action=null}function Zd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Wd(e,t){return t}function ef(e,t){if(Fe){var n=lt.formState;if(n!==null){e:{var i=Ie;if(Fe){if(gt){t:{for(var c=gt,f=xn;c.nodeType!==8;){if(!f){c=null;break t}if(c=Sn(c.nextSibling),c===null){c=null;break t}}f=c.data,c=f==="F!"||f==="F"?c:null}if(c){gt=Sn(c.nextSibling),i=c.data==="F!";break e}}ua(i)}i=!1}i&&(t=n[0])}}return n=Ft(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wd,lastRenderedState:t},n.queue=i,n=_f.bind(null,Ie,i),i.dispatch=n,i=Go(!1),f=Zo.bind(null,Ie,!1,i.queue),i=Ft(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,n=ny.bind(null,Ie,c,f,n),c.dispatch=n,i.memoizedState=e,[t,n,!1]}function tf(e){var t=St();return nf(t,nt,e)}function nf(e,t,n){if(t=Vo(e,t,Wd)[0],e=$s(Fn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=kr(t)}catch(y){throw y===Ni?ks:y}else i=t;t=St();var c=t.queue,f=c.dispatch;return n!==t.memoizedState&&(Ie.flags|=2048,zi(9,{destroy:void 0},ay.bind(null,c,n),null)),[i,f,e]}function ay(e,t){e.action=t}function af(e){var t=St(),n=nt;if(n!==null)return nf(t,n,e);St(),t=t.memoizedState,n=St();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function zi(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},t=Ie.updateQueue,t===null&&(t=Is(),Ie.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function rf(){return St().memoizedState}function Vs(e,t,n,i){var c=Ft();Ie.flags|=e,c.memoizedState=zi(1|t,{destroy:void 0},n,i===void 0?null:i)}function Ps(e,t,n,i){var c=St();i=i===void 0?null:i;var f=c.memoizedState.inst;nt!==null&&i!==null&&Bo(i,nt.memoizedState.deps)?c.memoizedState=zi(t,f,n,i):(Ie.flags|=e,c.memoizedState=zi(1|t,f,n,i))}function sf(e,t){Vs(8390656,8,e,t)}function Yo(e,t){Ps(2048,8,e,t)}function iy(e){Ie.flags|=4;var t=Ie.updateQueue;if(t===null)t=Is(),Ie.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function lf(e){var t=St().memoizedState;return iy({ref:t,nextImpl:e}),function(){if((Xe&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function of(e,t){return Ps(4,2,e,t)}function cf(e,t){return Ps(4,4,e,t)}function uf(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function df(e,t,n){n=n!=null?n.concat([e]):null,Ps(4,4,uf.bind(null,t,e),n)}function Fo(){}function ff(e,t){var n=St();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&Bo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function hf(e,t){var n=St();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&Bo(t,i[1]))return i[0];if(i=e(),Qa){tn(!0);try{e()}finally{tn(!1)}}return n.memoizedState=[i,t],i}function Jo(e,t,n){return n===void 0||(Yn&1073741824)!==0&&(Ke&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=gh(),Ie.lanes|=e,ba|=e,n)}function gf(e,t,n,i){return sn(n,t)?n:Oi.current!==null?(e=Jo(e,n,i),sn(e,t)||(Nt=!0),e):(Yn&42)===0||(Yn&1073741824)!==0&&(Ke&261930)===0?(Nt=!0,e.memoizedState=n):(e=gh(),Ie.lanes|=e,ba|=e,t)}function pf(e,t,n,i,c){var f=U.p;U.p=f!==0&&8>f?f:8;var y=C.T,j={};C.T=j,Zo(e,!1,t,n);try{var k=c(),Y=C.S;if(Y!==null&&Y(j,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var re=Wm(k,i);Ur(e,t,re,fn(e))}else Ur(e,t,i,fn(e))}catch(de){Ur(e,t,{then:function(){},status:"rejected",reason:de},fn())}finally{U.p=f,y!==null&&j.types!==null&&(y.types=j.types),C.T=y}}function ry(){}function Qo(e,t,n,i){if(e.tag!==5)throw Error(l(476));var c=mf(e).queue;pf(e,c,t,ee,n===null?ry:function(){return yf(e),n(i)})}function mf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:ee},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function yf(e){var t=mf(e);t.next===null&&(t=e.alternate.memoizedState),Ur(e,t.next.queue,{},fn())}function Xo(){return Bt(Qr)}function vf(){return St().memoizedState}function bf(){return St().memoizedState}function sy(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=fn();e=ha(n);var i=ga(t,e,n);i!==null&&(en(i,t,n),Ar(i,t,n)),t={cache:Co()},e.payload=t;return}t=t.return}}function ly(e,t,n){var i=fn();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Gs(e)?xf(t,n):(n=po(e,t,n,i),n!==null&&(en(n,e,i),jf(n,t,i)))}function _f(e,t,n){var i=fn();Ur(e,t,n,i)}function Ur(e,t,n,i){var c={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gs(e))xf(t,c);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,j=f(y,n);if(c.hasEagerState=!0,c.eagerState=j,sn(j,y))return Es(e,t,c,0),lt===null&&ws(),!1}catch{}finally{}if(n=po(e,t,c,i),n!==null)return en(n,e,i),jf(n,t,i),!0}return!1}function Zo(e,t,n,i){if(i={lane:2,revertLane:Rc(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Gs(e)){if(t)throw Error(l(479))}else t=po(e,n,i,2),t!==null&&en(t,e,2)}function Gs(e){var t=e.alternate;return e===Ie||t!==null&&t===Ie}function xf(e,t){ki=Ms=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function jf(e,t,n){if((n&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,ra(e,n)}}var zr={readContext:Bt,use:Hs,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useLayoutEffect:_t,useInsertionEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useSyncExternalStore:_t,useId:_t,useHostTransitionStatus:_t,useFormState:_t,useActionState:_t,useOptimistic:_t,useMemoCache:_t,useCacheRefresh:_t};zr.useEffectEvent=_t;var Sf={readContext:Bt,use:Hs,useCallback:function(e,t){return Ft().memoizedState=[e,t===void 0?null:t],e},useContext:Bt,useEffect:sf,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Vs(4194308,4,uf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vs(4194308,4,e,t)},useInsertionEffect:function(e,t){Vs(4,2,e,t)},useMemo:function(e,t){var n=Ft();t=t===void 0?null:t;var i=e();if(Qa){tn(!0);try{e()}finally{tn(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Ft();if(n!==void 0){var c=n(t);if(Qa){tn(!0);try{n(t)}finally{tn(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=ly.bind(null,Ie,e),[i.memoizedState,e]},useRef:function(e){var t=Ft();return e={current:e},t.memoizedState=e},useState:function(e){e=Go(e);var t=e.queue,n=_f.bind(null,Ie,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Fo,useDeferredValue:function(e,t){var n=Ft();return Jo(n,e,t)},useTransition:function(){var e=Go(!1);return e=pf.bind(null,Ie,e.queue,!0,!1),Ft().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=Ie,c=Ft();if(Fe){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),lt===null)throw Error(l(349));(Ke&127)!==0||Vd(i,t,n)}c.memoizedState=n;var f={value:n,getSnapshot:t};return c.queue=f,sf(Gd.bind(null,i,f,e),[e]),i.flags|=2048,zi(9,{destroy:void 0},Pd.bind(null,i,f,n,t),null),n},useId:function(){var e=Ft(),t=lt.identifierPrefix;if(Fe){var n=Dn,i=zn;n=(i&~(1<<32-Yt(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=qs++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=ey++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Xo,useFormState:ef,useActionState:ef,useOptimistic:function(e){var t=Ft();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Zo.bind(null,Ie,!0,n),n.dispatch=t,[e,t]},useMemoCache:$o,useCacheRefresh:function(){return Ft().memoizedState=sy.bind(null,Ie)},useEffectEvent:function(e){var t=Ft(),n={impl:e};return t.memoizedState=n,function(){if((Xe&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},Wo={readContext:Bt,use:Hs,useCallback:ff,useContext:Bt,useEffect:Yo,useImperativeHandle:df,useInsertionEffect:of,useLayoutEffect:cf,useMemo:hf,useReducer:$s,useRef:rf,useState:function(){return $s(Fn)},useDebugValue:Fo,useDeferredValue:function(e,t){var n=St();return gf(n,nt.memoizedState,e,t)},useTransition:function(){var e=$s(Fn)[0],t=St().memoizedState;return[typeof e=="boolean"?e:kr(e),t]},useSyncExternalStore:$d,useId:vf,useHostTransitionStatus:Xo,useFormState:tf,useActionState:tf,useOptimistic:function(e,t){var n=St();return Fd(n,nt,e,t)},useMemoCache:$o,useCacheRefresh:bf};Wo.useEffectEvent=lf;var wf={readContext:Bt,use:Hs,useCallback:ff,useContext:Bt,useEffect:Yo,useImperativeHandle:df,useInsertionEffect:of,useLayoutEffect:cf,useMemo:hf,useReducer:Po,useRef:rf,useState:function(){return Po(Fn)},useDebugValue:Fo,useDeferredValue:function(e,t){var n=St();return nt===null?Jo(n,e,t):gf(n,nt.memoizedState,e,t)},useTransition:function(){var e=Po(Fn)[0],t=St().memoizedState;return[typeof e=="boolean"?e:kr(e),t]},useSyncExternalStore:$d,useId:vf,useHostTransitionStatus:Xo,useFormState:af,useActionState:af,useOptimistic:function(e,t){var n=St();return nt!==null?Fd(n,nt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:$o,useCacheRefresh:bf};wf.useEffectEvent=lf;function ec(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:_({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var tc={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=fn(),c=ha(i);c.payload=t,n!=null&&(c.callback=n),t=ga(e,c,i),t!==null&&(en(t,e,i),Ar(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=fn(),c=ha(i);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=ga(e,c,i),t!==null&&(en(t,e,i),Ar(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=fn(),i=ha(n);i.tag=2,t!=null&&(i.callback=t),t=ga(e,i,n),t!==null&&(en(t,e,n),Ar(t,e,n))}};function Ef(e,t,n,i,c,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,f,y):t.prototype&&t.prototype.isPureReactComponent?!_r(n,i)||!_r(c,f):!0}function Cf(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&tc.enqueueReplaceState(t,t.state,null)}function Xa(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=_({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Tf(e){Ss(e)}function Af(e){console.error(e)}function Nf(e){Ss(e)}function Ks(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Rf(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function nc(e,t,n){return n=ha(n),n.tag=3,n.payload={element:null},n.callback=function(){Ks(e,t)},n}function Of(e){return e=ha(e),e.tag=3,e}function kf(e,t,n,i){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var f=i.value;e.payload=function(){return c(f)},e.callback=function(){Rf(t,n,i)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Rf(t,n,i),typeof c!="function"&&(_a===null?_a=new Set([this]):_a.add(this));var j=i.stack;this.componentDidCatch(i.value,{componentStack:j!==null?j:""})})}function oy(e,t,n,i,c){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Ci(t,n,c,!0),n=on.current,n!==null){switch(n.tag){case 31:case 13:return jn===null?il():n.alternate===null&&xt===0&&(xt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,i===Us?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),Tc(e,i,c)),!1;case 22:return n.flags|=65536,i===Us?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),Tc(e,i,c)),!1}throw Error(l(435,n.tag))}return Tc(e,i,c),il(),!1}if(Fe)return t=on.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==xo&&(e=Error(l(422),{cause:i}),Sr(vn(e,n)))):(i!==xo&&(t=Error(l(423),{cause:i}),Sr(vn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=vn(i,n),c=nc(e.stateNode,i,c),ko(e,c),xt!==4&&(xt=2)),!1;var f=Error(l(520),{cause:i});if(f=vn(f,n),$r===null?$r=[f]:$r.push(f),xt!==4&&(xt=2),t===null)return!0;i=vn(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=nc(n.stateNode,i,e),ko(n,e),!1;case 1:if(t=n.type,f=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(_a===null||!_a.has(f))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Of(c),kf(c,e,n,i),ko(n,c),!1}n=n.return}while(n!==null);return!1}var ac=Error(l(461)),Nt=!1;function Mt(e,t,n,i){t.child=e===null?Dd(t,null,n,i):Ja(t,e.child,n,i)}function Uf(e,t,n,i,c){n=n.render;var f=t.ref;if("ref"in i){var y={};for(var j in i)j!=="ref"&&(y[j]=i[j])}else y=i;return Ga(t),i=Mo(e,t,n,y,f,c),j=qo(),e!==null&&!Nt?(Io(e,t,c),Jn(e,t,c)):(Fe&&j&&bo(t),t.flags|=1,Mt(e,t,i,c),t.child)}function zf(e,t,n,i,c){if(e===null){var f=n.type;return typeof f=="function"&&!mo(f)&&f.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=f,Df(e,t,f,i,c)):(e=Ts(n.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!dc(e,c)){var y=f.memoizedProps;if(n=n.compare,n=n!==null?n:_r,n(y,i)&&e.ref===t.ref)return Jn(e,t,c)}return t.flags|=1,e=Vn(f,i),e.ref=t.ref,e.return=t,t.child=e}function Df(e,t,n,i,c){if(e!==null){var f=e.memoizedProps;if(_r(f,i)&&e.ref===t.ref)if(Nt=!1,t.pendingProps=i=f,dc(e,c))(e.flags&131072)!==0&&(Nt=!0);else return t.lanes=e.lanes,Jn(e,t,c)}return ic(e,t,n,i,c)}function Lf(e,t,n,i){var c=i.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|n:n,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~f}else i=0,t.child=null;return Bf(e,t,f,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Os(t,f!==null?f.cachePool:null),f!==null?Md(t,f):zo(),qd(t);else return i=t.lanes=536870912,Bf(e,t,f!==null?f.baseLanes|n:n,n,i)}else f!==null?(Os(t,f.cachePool),Md(t,f),ma(),t.memoizedState=null):(e!==null&&Os(t,null),zo(),ma());return Mt(e,t,c,n),t.child}function Dr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bf(e,t,n,i,c){var f=Ao();return f=f===null?null:{parent:Tt._currentValue,pool:f},t.memoizedState={baseLanes:n,cachePool:f},e!==null&&Os(t,null),zo(),qd(t),e!==null&&Ci(e,t,i,!0),t.childLanes=c,null}function Ys(e,t){return t=Js({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Mf(e,t,n){return Ja(t,e.child,null,n),e=Ys(t,t.pendingProps),e.flags|=2,cn(t),t.memoizedState=null,e}function cy(e,t,n){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Fe){if(i.mode==="hidden")return e=Ys(t,i),t.lanes=536870912,Dr(null,e);if(Lo(t),(e=gt)?(e=Qh(e,xn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:oa!==null?{id:zn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,Lt=t,gt=null)):e=null,e===null)throw ua(t);return t.lanes=536870912,null}return Ys(t,i)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if(Lo(t),c)if(t.flags&256)t.flags&=-257,t=Mf(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(Nt||Ci(e,t,n,!1),c=(n&e.childLanes)!==0,Nt||c){if(i=lt,i!==null&&(y=fs(i,n),y!==0&&y!==f.retryLane))throw f.retryLane=y,Ha(e,y),en(i,e,y),ac;il(),t=Mf(e,t,n)}else e=f.treeContext,gt=Sn(y.nextSibling),Lt=t,Fe=!0,ca=null,xn=!1,e!==null&&Sd(t,e),t=Ys(t,i),t.flags|=4096;return t}return e=Vn(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Fs(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function ic(e,t,n,i,c){return Ga(t),n=Mo(e,t,n,i,void 0,c),i=qo(),e!==null&&!Nt?(Io(e,t,c),Jn(e,t,c)):(Fe&&i&&bo(t),t.flags|=1,Mt(e,t,n,c),t.child)}function qf(e,t,n,i,c,f){return Ga(t),t.updateQueue=null,n=Hd(t,i,n,c),Id(e),i=qo(),e!==null&&!Nt?(Io(e,t,f),Jn(e,t,f)):(Fe&&i&&bo(t),t.flags|=1,Mt(e,t,n,f),t.child)}function If(e,t,n,i,c){if(Ga(t),t.stateNode===null){var f=ji,y=n.contextType;typeof y=="object"&&y!==null&&(f=Bt(y)),f=new n(i,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=tc,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=i,f.state=t.memoizedState,f.refs={},Ro(t),y=n.contextType,f.context=typeof y=="object"&&y!==null?Bt(y):ji,f.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(ec(t,n,y,i),f.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&tc.enqueueReplaceState(f,f.state,null),Rr(t,i,f,c),Nr(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){f=t.stateNode;var j=t.memoizedProps,k=Xa(n,j);f.props=k;var Y=f.context,re=n.contextType;y=ji,typeof re=="object"&&re!==null&&(y=Bt(re));var de=n.getDerivedStateFromProps;re=typeof de=="function"||typeof f.getSnapshotBeforeUpdate=="function",j=t.pendingProps!==j,re||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(j||Y!==y)&&Cf(t,f,i,y),fa=!1;var F=t.memoizedState;f.state=F,Rr(t,i,f,c),Nr(),Y=t.memoizedState,j||F!==Y||fa?(typeof de=="function"&&(ec(t,n,de,i),Y=t.memoizedState),(k=fa||Ef(t,n,k,i,F,Y,y))?(re||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=Y),f.props=i,f.state=Y,f.context=y,i=k):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{f=t.stateNode,Oo(e,t),y=t.memoizedProps,re=Xa(n,y),f.props=re,de=t.pendingProps,F=f.context,Y=n.contextType,k=ji,typeof Y=="object"&&Y!==null&&(k=Bt(Y)),j=n.getDerivedStateFromProps,(Y=typeof j=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==de||F!==k)&&Cf(t,f,i,k),fa=!1,F=t.memoizedState,f.state=F,Rr(t,i,f,c),Nr();var Z=t.memoizedState;y!==de||F!==Z||fa||e!==null&&e.dependencies!==null&&Ns(e.dependencies)?(typeof j=="function"&&(ec(t,n,j,i),Z=t.memoizedState),(re=fa||Ef(t,n,re,i,F,Z,k)||e!==null&&e.dependencies!==null&&Ns(e.dependencies))?(Y||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(i,Z,k),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(i,Z,k)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=Z),f.props=i,f.state=Z,f.context=k,i=re):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&F===e.memoizedState||(t.flags|=1024),i=!1)}return f=i,Fs(e,t),i=(t.flags&128)!==0,f||i?(f=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&i?(t.child=Ja(t,e.child,null,c),t.child=Ja(t,null,n,c)):Mt(e,t,n,c),t.memoizedState=f.state,e=t.child):e=Jn(e,t,c),e}function Hf(e,t,n,i){return Va(),t.flags|=256,Mt(e,t,n,i),t.child}var rc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function sc(e){return{baseLanes:e,cachePool:Nd()}}function lc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=dn),e}function $f(e,t,n){var i=t.pendingProps,c=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(jt.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Fe){if(c?pa(t):ma(),(e=gt)?(e=Qh(e,xn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:oa!==null?{id:zn,overflow:Dn}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,Lt=t,gt=null)):e=null,e===null)throw ua(t);return Vc(e)?t.lanes=32:t.lanes=536870912,null}var j=i.children;return i=i.fallback,c?(ma(),c=t.mode,j=Js({mode:"hidden",children:j},c),i=$a(i,c,n,null),j.return=t,i.return=t,j.sibling=i,t.child=j,i=t.child,i.memoizedState=sc(n),i.childLanes=lc(e,y,n),t.memoizedState=rc,Dr(null,i)):(pa(t),oc(t,j))}var k=e.memoizedState;if(k!==null&&(j=k.dehydrated,j!==null)){if(f)t.flags&256?(pa(t),t.flags&=-257,t=cc(e,t,n)):t.memoizedState!==null?(ma(),t.child=e.child,t.flags|=128,t=null):(ma(),j=i.fallback,c=t.mode,i=Js({mode:"visible",children:i.children},c),j=$a(j,c,n,null),j.flags|=2,i.return=t,j.return=t,i.sibling=j,t.child=i,Ja(t,e.child,null,n),i=t.child,i.memoizedState=sc(n),i.childLanes=lc(e,y,n),t.memoizedState=rc,t=Dr(null,i));else if(pa(t),Vc(j)){if(y=j.nextSibling&&j.nextSibling.dataset,y)var Y=y.dgst;y=Y,i=Error(l(419)),i.stack="",i.digest=y,Sr({value:i,source:null,stack:null}),t=cc(e,t,n)}else if(Nt||Ci(e,t,n,!1),y=(n&e.childLanes)!==0,Nt||y){if(y=lt,y!==null&&(i=fs(y,n),i!==0&&i!==k.retryLane))throw k.retryLane=i,Ha(e,i),en(y,e,i),ac;$c(j)||il(),t=cc(e,t,n)}else $c(j)?(t.flags|=192,t.child=e.child,t=null):(e=k.treeContext,gt=Sn(j.nextSibling),Lt=t,Fe=!0,ca=null,xn=!1,e!==null&&Sd(t,e),t=oc(t,i.children),t.flags|=4096);return t}return c?(ma(),j=i.fallback,c=t.mode,k=e.child,Y=k.sibling,i=Vn(k,{mode:"hidden",children:i.children}),i.subtreeFlags=k.subtreeFlags&65011712,Y!==null?j=Vn(Y,j):(j=$a(j,c,n,null),j.flags|=2),j.return=t,i.return=t,i.sibling=j,t.child=i,Dr(null,i),i=t.child,j=e.child.memoizedState,j===null?j=sc(n):(c=j.cachePool,c!==null?(k=Tt._currentValue,c=c.parent!==k?{parent:k,pool:k}:c):c=Nd(),j={baseLanes:j.baseLanes|n,cachePool:c}),i.memoizedState=j,i.childLanes=lc(e,y,n),t.memoizedState=rc,Dr(e.child,i)):(pa(t),n=e.child,e=n.sibling,n=Vn(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function oc(e,t){return t=Js({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Js(e,t){return e=ln(22,e,null,t),e.lanes=0,e}function cc(e,t,n){return Ja(t,e.child,null,n),e=oc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Vf(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),wo(e.return,t,n)}function uc(e,t,n,i,c,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:c,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=n,y.tailMode=c,y.treeForkCount=f)}function Pf(e,t,n){var i=t.pendingProps,c=i.revealOrder,f=i.tail;i=i.children;var y=jt.current,j=(y&2)!==0;if(j?(y=y&1|2,t.flags|=128):y&=1,P(jt,y),Mt(e,t,i,n),i=Fe?jr:0,!j&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vf(e,n,t);else if(e.tag===19)Vf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Bs(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),uc(t,!1,c,n,f,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Bs(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}uc(t,!0,n,null,f,i);break;case"together":uc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function Jn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ba|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Ci(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Vn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Vn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function dc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Ns(e)))}function uy(e,t,n){switch(t.tag){case 3:te(t,t.stateNode.containerInfo),da(t,Tt,e.memoizedState.cache),Va();break;case 27:case 5:we(t);break;case 4:te(t,t.stateNode.containerInfo);break;case 10:da(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Lo(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(pa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?$f(e,t,n):(pa(t),e=Jn(e,t,n),e!==null?e.sibling:null);pa(t);break;case 19:var c=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Ci(e,t,n,!1),i=(n&t.childLanes)!==0),c){if(i)return Pf(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),P(jt,jt.current),i)break;return null;case 22:return t.lanes=0,Lf(e,t,n,t.pendingProps);case 24:da(t,Tt,e.memoizedState.cache)}return Jn(e,t,n)}function Gf(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Nt=!0;else{if(!dc(e,n)&&(t.flags&128)===0)return Nt=!1,uy(e,t,n);Nt=(e.flags&131072)!==0}else Nt=!1,Fe&&(t.flags&1048576)!==0&&jd(t,jr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=Ya(t.elementType),t.type=e,typeof e=="function")mo(e)?(i=Xa(e,i),t.tag=1,t=If(null,t,e,i,n)):(t.tag=0,t=ic(null,t,e,i,n));else{if(e!=null){var c=e.$$typeof;if(c===K){t.tag=11,t=Uf(null,t,e,i,n);break e}else if(c===L){t.tag=14,t=zf(null,t,e,i,n);break e}}throw t=X(e)||e,Error(l(306,t,""))}}return t;case 0:return ic(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,c=Xa(i,t.pendingProps),If(e,t,i,c,n);case 3:e:{if(te(t,t.stateNode.containerInfo),e===null)throw Error(l(387));i=t.pendingProps;var f=t.memoizedState;c=f.element,Oo(e,t),Rr(t,i,null,n);var y=t.memoizedState;if(i=y.cache,da(t,Tt,i),i!==f.cache&&Eo(t,[Tt],n,!0),Nr(),i=y.element,f.isDehydrated)if(f={element:i,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Hf(e,t,i,n);break e}else if(i!==c){c=vn(Error(l(424)),t),Sr(c),t=Hf(e,t,i,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(gt=Sn(e.firstChild),Lt=t,Fe=!0,ca=null,xn=!0,n=Dd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Va(),i===c){t=Jn(e,t,n);break e}Mt(e,t,i,n)}t=t.child}return t;case 26:return Fs(e,t),e===null?(n=ng(t.type,null,t.pendingProps,null))?t.memoizedState=n:Fe||(n=t.type,e=t.pendingProps,i=dl(le.current).createElement(n),i[ft]=t,i[$t]=e,qt(i,n,e),se(i),t.stateNode=i):t.memoizedState=ng(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return we(t),e===null&&Fe&&(i=t.stateNode=Wh(t.type,t.pendingProps,le.current),Lt=t,xn=!0,c=gt,wa(t.type)?(Pc=c,gt=Sn(i.firstChild)):gt=c),Mt(e,t,t.pendingProps.children,n),Fs(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Fe&&((c=i=gt)&&(i=Iy(i,t.type,t.pendingProps,xn),i!==null?(t.stateNode=i,Lt=t,gt=Sn(i.firstChild),xn=!1,c=!0):c=!1),c||ua(t)),we(t),c=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,i=f.children,qc(c,f)?i=null:y!==null&&qc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Mo(e,t,ty,null,null,n),Qr._currentValue=c),Fs(e,t),Mt(e,t,i,n),t.child;case 6:return e===null&&Fe&&((e=n=gt)&&(n=Hy(n,t.pendingProps,xn),n!==null?(t.stateNode=n,Lt=t,gt=null,e=!0):e=!1),e||ua(t)),null;case 13:return $f(e,t,n);case 4:return te(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Ja(t,null,i,n):Mt(e,t,i,n),t.child;case 11:return Uf(e,t,t.type,t.pendingProps,n);case 7:return Mt(e,t,t.pendingProps,n),t.child;case 8:return Mt(e,t,t.pendingProps.children,n),t.child;case 12:return Mt(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,da(t,t.type,i.value),Mt(e,t,i.children,n),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,Ga(t),c=Bt(c),i=i(c),t.flags|=1,Mt(e,t,i,n),t.child;case 14:return zf(e,t,t.type,t.pendingProps,n);case 15:return Df(e,t,t.type,t.pendingProps,n);case 19:return Pf(e,t,n);case 31:return cy(e,t,n);case 22:return Lf(e,t,n,t.pendingProps);case 24:return Ga(t),i=Bt(Tt),e===null?(c=Ao(),c===null&&(c=lt,f=Co(),c.pooledCache=f,f.refCount++,f!==null&&(c.pooledCacheLanes|=n),c=f),t.memoizedState={parent:i,cache:c},Ro(t),da(t,Tt,c)):((e.lanes&n)!==0&&(Oo(e,t),Rr(t,null,null,n),Nr()),c=e.memoizedState,f=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),da(t,Tt,i)):(i=f.cache,da(t,Tt,i),i!==c.cache&&Eo(t,[Tt],n,!0))),Mt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Qn(e){e.flags|=4}function fc(e,t,n,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(vh())e.flags|=8192;else throw Fa=Us,No}else e.flags&=-16777217}function Kf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!lg(t))if(vh())e.flags|=8192;else throw Fa=Us,No}function Qs(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ds():536870912,e.lanes|=t,Mi|=t)}function Lr(e,t){if(!Fe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function pt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function dy(e,t,n){var i=t.pendingProps;switch(_o(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(t),null;case 1:return pt(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Kn(Tt),me(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ei(t)?Qn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,jo())),pt(t),null;case 26:var c=t.type,f=t.memoizedState;return e===null?(Qn(t),f!==null?(pt(t),Kf(t,f)):(pt(t),fc(t,c,null,i,n))):f?f!==e.memoizedState?(Qn(t),pt(t),Kf(t,f)):(pt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&Qn(t),pt(t),fc(t,c,e,i,n)),null;case 27:if(Te(t),n=le.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Qn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return pt(t),null}e=J.current,Ei(t)?wd(t):(e=Wh(c,i,n),t.stateNode=e,Qn(t))}return pt(t),null;case 5:if(Te(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Qn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return pt(t),null}if(f=J.current,Ei(t))wd(t);else{var y=dl(le.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?f.multiple=!0:i.size&&(f.size=i.size);break;default:f=typeof i.is=="string"?y.createElement(c,{is:i.is}):y.createElement(c)}}f[ft]=t,f[$t]=i;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(qt(f,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Qn(t)}}return pt(t),fc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Qn(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(l(166));if(e=le.current,Ei(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,c=Lt,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[ft]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||$h(e.nodeValue,n)),e||ua(t,!0)}else e=dl(e).createTextNode(i),e[ft]=t,t.stateNode=e}return pt(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(i=Ei(t),n!==null){if(e===null){if(!i)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[ft]=t}else Va(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;pt(t),e=!1}else n=jo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(cn(t),t):(cn(t),null);if((t.flags&128)!==0)throw Error(l(558))}return pt(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Ei(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[ft]=t}else Va(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;pt(t),c=!1}else c=jo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(cn(t),t):(cn(t),null)}return cn(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,e=e!==null&&e.memoizedState!==null,n&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Qs(t,t.updateQueue),pt(t),null);case 4:return me(),e===null&&zc(t.stateNode.containerInfo),pt(t),null;case 10:return Kn(t.type),pt(t),null;case 19:if(D(jt),i=t.memoizedState,i===null)return pt(t),null;if(c=(t.flags&128)!==0,f=i.rendering,f===null)if(c)Lr(i,!1);else{if(xt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=Bs(e),f!==null){for(t.flags|=128,Lr(i,!1),e=f.updateQueue,t.updateQueue=e,Qs(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)bd(n,e),n=n.sibling;return P(jt,jt.current&1|2),Fe&&Pn(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Gt()>tl&&(t.flags|=128,c=!0,Lr(i,!1),t.lanes=4194304)}else{if(!c)if(e=Bs(f),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,Qs(t,e),Lr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!f.alternate&&!Fe)return pt(t),null}else 2*Gt()-i.renderingStartTime>tl&&n!==536870912&&(t.flags|=128,c=!0,Lr(i,!1),t.lanes=4194304);i.isBackwards?(f.sibling=t.child,t.child=f):(e=i.last,e!==null?e.sibling=f:t.child=f,i.last=f)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Gt(),e.sibling=null,n=jt.current,P(jt,c?n&1|2:n&1),Fe&&Pn(t,i.treeForkCount),e):(pt(t),null);case 22:case 23:return cn(t),Do(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(pt(t),t.subtreeFlags&6&&(t.flags|=8192)):pt(t),n=t.updateQueue,n!==null&&Qs(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&D(Ka),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Kn(Tt),pt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function fy(e,t){switch(_o(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Kn(Tt),me(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Te(t),null;case 31:if(t.memoizedState!==null){if(cn(t),t.alternate===null)throw Error(l(340));Va()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(cn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Va()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return D(jt),null;case 4:return me(),null;case 10:return Kn(t.type),null;case 22:case 23:return cn(t),Do(),e!==null&&D(Ka),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Kn(Tt),null;case 25:return null;default:return null}}function Yf(e,t){switch(_o(t),t.tag){case 3:Kn(Tt),me();break;case 26:case 27:case 5:Te(t);break;case 4:me();break;case 31:t.memoizedState!==null&&cn(t);break;case 13:cn(t);break;case 19:D(jt);break;case 10:Kn(t.type);break;case 22:case 23:cn(t),Do(),e!==null&&D(Ka);break;case 24:Kn(Tt)}}function Br(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var c=i.next;n=c;do{if((n.tag&e)===e){i=void 0;var f=n.create,y=n.inst;i=f(),y.destroy=i}n=n.next}while(n!==c)}}catch(j){et(t,t.return,j)}}function ya(e,t,n){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var f=c.next;i=f;do{if((i.tag&e)===e){var y=i.inst,j=y.destroy;if(j!==void 0){y.destroy=void 0,c=t;var k=n,Y=j;try{Y()}catch(re){et(c,k,re)}}}i=i.next}while(i!==f)}}catch(re){et(t,t.return,re)}}function Ff(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Bd(t,n)}catch(i){et(e,e.return,i)}}}function Jf(e,t,n){n.props=Xa(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){et(e,t,i)}}function Mr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof n=="function"?e.refCleanup=n(i):n.current=i}}catch(c){et(e,t,c)}}function Ln(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(c){et(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){et(e,t,c)}else n.current=null}function Qf(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(c){et(e,e.return,c)}}function hc(e,t,n){try{var i=e.stateNode;zy(i,e.type,n,t),i[$t]=t}catch(c){et(e,e.return,c)}}function Xf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&wa(e.type)||e.tag===4}function gc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Xf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&wa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pc(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Hn));else if(i!==4&&(i===27&&wa(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(pc(e,t,n),e=e.sibling;e!==null;)pc(e,t,n),e=e.sibling}function Xs(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(i===27&&wa(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Xs(e,t,n),e=e.sibling;e!==null;)Xs(e,t,n),e=e.sibling}function Zf(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);qt(t,i,n),t[ft]=e,t[$t]=n}catch(f){et(e,e.return,f)}}var Xn=!1,Rt=!1,mc=!1,Wf=typeof WeakSet=="function"?WeakSet:Set,zt=null;function hy(e,t){if(e=e.containerInfo,Bc=vl,e=ud(e),oo(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var c=i.anchorOffset,f=i.focusNode;i=i.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var y=0,j=-1,k=-1,Y=0,re=0,de=e,F=null;t:for(;;){for(var Z;de!==n||c!==0&&de.nodeType!==3||(j=y+c),de!==f||i!==0&&de.nodeType!==3||(k=y+i),de.nodeType===3&&(y+=de.nodeValue.length),(Z=de.firstChild)!==null;)F=de,de=Z;for(;;){if(de===e)break t;if(F===n&&++Y===c&&(j=y),F===f&&++re===i&&(k=y),(Z=de.nextSibling)!==null)break;de=F,F=de.parentNode}de=Z}n=j===-1||k===-1?null:{start:j,end:k}}else n=null}n=n||{start:0,end:0}}else n=null;for(Mc={focusedElem:e,selectionRange:n},vl=!1,zt=t;zt!==null;)if(t=zt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,zt=e;else for(;zt!==null;){switch(t=zt,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,n=t,c=f.memoizedProps,f=f.memoizedState,i=n.stateNode;try{var Se=Xa(n.type,c);e=i.getSnapshotBeforeUpdate(Se,f),i.__reactInternalSnapshotBeforeUpdate=e}catch(Ue){et(n,n.return,Ue)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Hc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Hc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,zt=e;break}zt=t.return}}function eh(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Wn(e,n),i&4&&Br(5,n);break;case 1:if(Wn(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){et(n,n.return,y)}else{var c=Xa(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){et(n,n.return,y)}}i&64&&Ff(n),i&512&&Mr(n,n.return);break;case 3:if(Wn(e,n),i&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Bd(e,t)}catch(y){et(n,n.return,y)}}break;case 27:t===null&&i&4&&Zf(n);case 26:case 5:Wn(e,n),t===null&&i&4&&Qf(n),i&512&&Mr(n,n.return);break;case 12:Wn(e,n);break;case 31:Wn(e,n),i&4&&ah(e,n);break;case 13:Wn(e,n),i&4&&ih(e,n),i&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=jy.bind(null,n),$y(e,n))));break;case 22:if(i=n.memoizedState!==null||Xn,!i){t=t!==null&&t.memoizedState!==null||Rt,c=Xn;var f=Rt;Xn=i,(Rt=t)&&!f?ea(e,n,(n.subtreeFlags&8772)!==0):Wn(e,n),Xn=c,Rt=f}break;case 30:break;default:Wn(e,n)}}function th(e){var t=e.alternate;t!==null&&(e.alternate=null,th(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&ie(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var yt=null,Qt=!1;function Zn(e,t,n){for(n=n.child;n!==null;)nh(e,t,n),n=n.sibling}function nh(e,t,n){if(Kt&&typeof Kt.onCommitFiberUnmount=="function")try{Kt.onCommitFiberUnmount(za,n)}catch{}switch(n.tag){case 26:Rt||Ln(n,t),Zn(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Rt||Ln(n,t);var i=yt,c=Qt;wa(n.type)&&(yt=n.stateNode,Qt=!1),Zn(e,t,n),Yr(n.stateNode),yt=i,Qt=c;break;case 5:Rt||Ln(n,t);case 6:if(i=yt,c=Qt,yt=null,Zn(e,t,n),yt=i,Qt=c,yt!==null)if(Qt)try{(yt.nodeType===9?yt.body:yt.nodeName==="HTML"?yt.ownerDocument.body:yt).removeChild(n.stateNode)}catch(f){et(n,t,f)}else try{yt.removeChild(n.stateNode)}catch(f){et(n,t,f)}break;case 18:yt!==null&&(Qt?(e=yt,Fh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Ki(e)):Fh(yt,n.stateNode));break;case 4:i=yt,c=Qt,yt=n.stateNode.containerInfo,Qt=!0,Zn(e,t,n),yt=i,Qt=c;break;case 0:case 11:case 14:case 15:ya(2,n,t),Rt||ya(4,n,t),Zn(e,t,n);break;case 1:Rt||(Ln(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Jf(n,t,i)),Zn(e,t,n);break;case 21:Zn(e,t,n);break;case 22:Rt=(i=Rt)||n.memoizedState!==null,Zn(e,t,n),Rt=i;break;default:Zn(e,t,n)}}function ah(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ki(e)}catch(n){et(t,t.return,n)}}}function ih(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ki(e)}catch(n){et(t,t.return,n)}}function gy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Wf),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Wf),t;default:throw Error(l(435,e.tag))}}function Zs(e,t){var n=gy(e);t.forEach(function(i){if(!n.has(i)){n.add(i);var c=Sy.bind(null,e,i);i.then(c,c)}})}function Xt(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var c=n[i],f=e,y=t,j=y;e:for(;j!==null;){switch(j.tag){case 27:if(wa(j.type)){yt=j.stateNode,Qt=!1;break e}break;case 5:yt=j.stateNode,Qt=!1;break e;case 3:case 4:yt=j.stateNode.containerInfo,Qt=!0;break e}j=j.return}if(yt===null)throw Error(l(160));nh(f,y,c),yt=null,Qt=!1,f=c.alternate,f!==null&&(f.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)rh(t,e),t=t.sibling}var Nn=null;function rh(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Xt(t,e),Zt(e),i&4&&(ya(3,e,e.return),Br(3,e),ya(5,e,e.return));break;case 1:Xt(t,e),Zt(e),i&512&&(Rt||n===null||Ln(n,n.return)),i&64&&Xn&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var c=Nn;if(Xt(t,e),Zt(e),i&512&&(Rt||n===null||Ln(n,n.return)),i&4){var f=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":f=c.getElementsByTagName("title")[0],(!f||f[H]||f[ft]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=c.createElement(i),c.head.insertBefore(f,c.querySelector("head > title"))),qt(f,i,n),f[ft]=e,se(f),i=f;break e;case"link":var y=rg("link","href",c).get(i+(n.href||""));if(y){for(var j=0;j<y.length;j++)if(f=y[j],f.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&f.getAttribute("rel")===(n.rel==null?null:n.rel)&&f.getAttribute("title")===(n.title==null?null:n.title)&&f.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(j,1);break t}}f=c.createElement(i),qt(f,i,n),c.head.appendChild(f);break;case"meta":if(y=rg("meta","content",c).get(i+(n.content||""))){for(j=0;j<y.length;j++)if(f=y[j],f.getAttribute("content")===(n.content==null?null:""+n.content)&&f.getAttribute("name")===(n.name==null?null:n.name)&&f.getAttribute("property")===(n.property==null?null:n.property)&&f.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&f.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(j,1);break t}}f=c.createElement(i),qt(f,i,n),c.head.appendChild(f);break;default:throw Error(l(468,i))}f[ft]=e,se(f),i=f}e.stateNode=i}else sg(c,e.type,e.stateNode);else e.stateNode=ig(c,i,e.memoizedProps);else f!==i?(f===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):f.count--,i===null?sg(c,e.type,e.stateNode):ig(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&hc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Xt(t,e),Zt(e),i&512&&(Rt||n===null||Ln(n,n.return)),n!==null&&i&4&&hc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Xt(t,e),Zt(e),i&512&&(Rt||n===null||Ln(n,n.return)),e.flags&32){c=e.stateNode;try{pi(c,"")}catch(Se){et(e,e.return,Se)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,hc(e,c,n!==null?n.memoizedProps:c)),i&1024&&(mc=!0);break;case 6:if(Xt(t,e),Zt(e),i&4){if(e.stateNode===null)throw Error(l(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(Se){et(e,e.return,Se)}}break;case 3:if(gl=null,c=Nn,Nn=fl(t.containerInfo),Xt(t,e),Nn=c,Zt(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Ki(t.containerInfo)}catch(Se){et(e,e.return,Se)}mc&&(mc=!1,sh(e));break;case 4:i=Nn,Nn=fl(e.stateNode.containerInfo),Xt(t,e),Zt(e),Nn=i;break;case 12:Xt(t,e),Zt(e);break;case 31:Xt(t,e),Zt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 13:Xt(t,e),Zt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(el=Gt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 22:c=e.memoizedState!==null;var k=n!==null&&n.memoizedState!==null,Y=Xn,re=Rt;if(Xn=Y||c,Rt=re||k,Xt(t,e),Rt=re,Xn=Y,Zt(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||k||Xn||Rt||Za(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){k=n=t;try{if(f=k.stateNode,c)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{j=k.stateNode;var de=k.memoizedProps.style,F=de!=null&&de.hasOwnProperty("display")?de.display:null;j.style.display=F==null||typeof F=="boolean"?"":(""+F).trim()}}catch(Se){et(k,k.return,Se)}}}else if(t.tag===6){if(n===null){k=t;try{k.stateNode.nodeValue=c?"":k.memoizedProps}catch(Se){et(k,k.return,Se)}}}else if(t.tag===18){if(n===null){k=t;try{var Z=k.stateNode;c?Jh(Z,!0):Jh(k.stateNode,!1)}catch(Se){et(k,k.return,Se)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,Zs(e,n))));break;case 19:Xt(t,e),Zt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 30:break;case 21:break;default:Xt(t,e),Zt(e)}}function Zt(e){var t=e.flags;if(t&2){try{for(var n,i=e.return;i!==null;){if(Xf(i)){n=i;break}i=i.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,f=gc(e);Xs(e,f,c);break;case 5:var y=n.stateNode;n.flags&32&&(pi(y,""),n.flags&=-33);var j=gc(e);Xs(e,j,y);break;case 3:case 4:var k=n.stateNode.containerInfo,Y=gc(e);pc(e,Y,k);break;default:throw Error(l(161))}}catch(re){et(e,e.return,re)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;sh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Wn(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)eh(e,t.alternate,t),t=t.sibling}function Za(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ya(4,t,t.return),Za(t);break;case 1:Ln(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Jf(t,t.return,n),Za(t);break;case 27:Yr(t.stateNode);case 26:case 5:Ln(t,t.return),Za(t);break;case 22:t.memoizedState===null&&Za(t);break;case 30:Za(t);break;default:Za(t)}e=e.sibling}}function ea(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:ea(c,f,n),Br(4,f);break;case 1:if(ea(c,f,n),i=f,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(Y){et(i,i.return,Y)}if(i=f,c=i.updateQueue,c!==null){var j=i.stateNode;try{var k=c.shared.hiddenCallbacks;if(k!==null)for(c.shared.hiddenCallbacks=null,c=0;c<k.length;c++)Ld(k[c],j)}catch(Y){et(i,i.return,Y)}}n&&y&64&&Ff(f),Mr(f,f.return);break;case 27:Zf(f);case 26:case 5:ea(c,f,n),n&&i===null&&y&4&&Qf(f),Mr(f,f.return);break;case 12:ea(c,f,n);break;case 31:ea(c,f,n),n&&y&4&&ah(c,f);break;case 13:ea(c,f,n),n&&y&4&&ih(c,f);break;case 22:f.memoizedState===null&&ea(c,f,n),Mr(f,f.return);break;case 30:break;default:ea(c,f,n)}t=t.sibling}}function yc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&wr(n))}function vc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&wr(e))}function Rn(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)lh(e,t,n,i),t=t.sibling}function lh(e,t,n,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Rn(e,t,n,i),c&2048&&Br(9,t);break;case 1:Rn(e,t,n,i);break;case 3:Rn(e,t,n,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&wr(e)));break;case 12:if(c&2048){Rn(e,t,n,i),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,j=f.onPostCommit;typeof j=="function"&&j(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(k){et(t,t.return,k)}}else Rn(e,t,n,i);break;case 31:Rn(e,t,n,i);break;case 13:Rn(e,t,n,i);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?Rn(e,t,n,i):qr(e,t):f._visibility&2?Rn(e,t,n,i):(f._visibility|=2,Di(e,t,n,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&yc(y,t);break;case 24:Rn(e,t,n,i),c&2048&&vc(t.alternate,t);break;default:Rn(e,t,n,i)}}function Di(e,t,n,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,j=n,k=i,Y=y.flags;switch(y.tag){case 0:case 11:case 15:Di(f,y,j,k,c),Br(8,y);break;case 23:break;case 22:var re=y.stateNode;y.memoizedState!==null?re._visibility&2?Di(f,y,j,k,c):qr(f,y):(re._visibility|=2,Di(f,y,j,k,c)),c&&Y&2048&&yc(y.alternate,y);break;case 24:Di(f,y,j,k,c),c&&Y&2048&&vc(y.alternate,y);break;default:Di(f,y,j,k,c)}t=t.sibling}}function qr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,c=i.flags;switch(i.tag){case 22:qr(n,i),c&2048&&yc(i.alternate,i);break;case 24:qr(n,i),c&2048&&vc(i.alternate,i);break;default:qr(n,i)}t=t.sibling}}var Ir=8192;function Li(e,t,n){if(e.subtreeFlags&Ir)for(e=e.child;e!==null;)oh(e,t,n),e=e.sibling}function oh(e,t,n){switch(e.tag){case 26:Li(e,t,n),e.flags&Ir&&e.memoizedState!==null&&ev(n,Nn,e.memoizedState,e.memoizedProps);break;case 5:Li(e,t,n);break;case 3:case 4:var i=Nn;Nn=fl(e.stateNode.containerInfo),Li(e,t,n),Nn=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Ir,Ir=16777216,Li(e,t,n),Ir=i):Li(e,t,n));break;default:Li(e,t,n)}}function ch(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Hr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];zt=i,dh(i,e)}ch(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)uh(e),e=e.sibling}function uh(e){switch(e.tag){case 0:case 11:case 15:Hr(e),e.flags&2048&&ya(9,e,e.return);break;case 3:Hr(e);break;case 12:Hr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Ws(e)):Hr(e);break;default:Hr(e)}}function Ws(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];zt=i,dh(i,e)}ch(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ya(8,t,t.return),Ws(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Ws(t));break;default:Ws(t)}e=e.sibling}}function dh(e,t){for(;zt!==null;){var n=zt;switch(n.tag){case 0:case 11:case 15:ya(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:wr(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,zt=i;else e:for(n=e;zt!==null;){i=zt;var c=i.sibling,f=i.return;if(th(i),i===n){zt=null;break e}if(c!==null){c.return=f,zt=c;break e}zt=f}}}var py={getCacheForType:function(e){var t=Bt(Tt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Bt(Tt).controller.signal}},my=typeof WeakMap=="function"?WeakMap:Map,Xe=0,lt=null,Pe=null,Ke=0,We=0,un=null,va=!1,Bi=!1,bc=!1,ta=0,xt=0,ba=0,Wa=0,_c=0,dn=0,Mi=0,$r=null,Wt=null,xc=!1,el=0,fh=0,tl=1/0,nl=null,_a=null,kt=0,xa=null,qi=null,na=0,jc=0,Sc=null,hh=null,Vr=0,wc=null;function fn(){return(Xe&2)!==0&&Ke!==0?Ke&-Ke:C.T!==null?Rc():ur()}function gh(){if(dn===0)if((Ke&536870912)===0||Fe){var e=Da;Da<<=1,(Da&3932160)===0&&(Da=262144),dn=e}else dn=536870912;return e=on.current,e!==null&&(e.flags|=32),dn}function en(e,t,n){(e===lt&&(We===2||We===9)||e.cancelPendingCommit!==null)&&(Ii(e,0),ja(e,Ke,dn,!1)),qn(e,n),((Xe&2)===0||e!==lt)&&(e===lt&&((Xe&2)===0&&(Wa|=n),xt===4&&ja(e,Ke,dn,!1)),Bn(e))}function ph(e,t,n){if((Xe&6)!==0)throw Error(l(327));var i=!n&&(t&127)===0&&(t&e.expiredLanes)===0||nn(e,t),c=i?by(e,t):Cc(e,t,!0),f=i;do{if(c===0){Bi&&!i&&ja(e,t,0,!1);break}else{if(n=e.current.alternate,f&&!yy(n)){c=Cc(e,t,!1),f=!1;continue}if(c===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var j=e;c=$r;var k=j.current.memoizedState.isDehydrated;if(k&&(Ii(j,y).flags|=256),y=Cc(j,y,!1),y!==2){if(bc&&!k){j.errorRecoveryDisabledLanes|=f,Wa|=f,c=4;break e}f=Wt,Wt=c,f!==null&&(Wt===null?Wt=f:Wt.push.apply(Wt,f))}c=y}if(f=!1,c!==2)continue}}if(c===1){Ii(e,0),ja(e,t,0,!0);break}e:{switch(i=e,f=c,f){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:ja(i,t,dn,!va);break e;case 2:Wt=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=el+300-Gt(),10<c)){if(ja(i,t,dn,!va),pn(i,0,!0)!==0)break e;na=t,i.timeoutHandle=Kh(mh.bind(null,i,n,Wt,nl,xc,t,dn,Wa,Mi,va,f,"Throttled",-0,0),c);break e}mh(i,n,Wt,nl,xc,t,dn,Wa,Mi,va,f,null,-0,0)}}break}while(!0);Bn(e)}function mh(e,t,n,i,c,f,y,j,k,Y,re,de,F,Z){if(e.timeoutHandle=-1,de=t.subtreeFlags,de&8192||(de&16785408)===16785408){de={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hn},oh(t,f,de);var Se=(f&62914560)===f?el-Gt():(f&4194048)===f?fh-Gt():0;if(Se=tv(de,Se),Se!==null){na=f,e.cancelPendingCommit=Se(wh.bind(null,e,t,f,n,i,c,y,j,k,re,de,null,F,Z)),ja(e,f,y,!Y);return}}wh(e,t,f,n,i,c,y,j,k)}function yy(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var c=n[i],f=c.getSnapshot;c=c.value;try{if(!sn(f(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ja(e,t,n,i){t&=~_c,t&=~Wa,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var f=31-Yt(c),y=1<<f;i[f]=-1,c&=~y}n!==0&&fi(e,n,t)}function al(){return(Xe&6)===0?(Pr(0),!1):!0}function Ec(){if(Pe!==null){if(We===0)var e=Pe.return;else e=Pe,Gn=Pa=null,Ho(e),Ri=null,Cr=0,e=Pe;for(;e!==null;)Yf(e.alternate,e),e=e.return;Pe=null}}function Ii(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,By(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),na=0,Ec(),lt=e,Pe=n=Vn(e.current,null),Ke=t,We=0,un=null,va=!1,Bi=nn(e,t),bc=!1,Mi=dn=_c=Wa=ba=xt=0,Wt=$r=null,xc=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-Yt(i),f=1<<c;t|=e[c],i&=~f}return ta=t,ws(),n}function yh(e,t){Ie=null,C.H=zr,t===Ni||t===ks?(t=kd(),We=3):t===No?(t=kd(),We=4):We=t===ac?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,un=t,Pe===null&&(xt=1,Ks(e,vn(t,e.current)))}function vh(){var e=on.current;return e===null?!0:(Ke&4194048)===Ke?jn===null:(Ke&62914560)===Ke||(Ke&536870912)!==0?e===jn:!1}function bh(){var e=C.H;return C.H=zr,e===null?zr:e}function _h(){var e=C.A;return C.A=py,e}function il(){xt=4,va||(Ke&4194048)!==Ke&&on.current!==null||(Bi=!0),(ba&134217727)===0&&(Wa&134217727)===0||lt===null||ja(lt,Ke,dn,!1)}function Cc(e,t,n){var i=Xe;Xe|=2;var c=bh(),f=_h();(lt!==e||Ke!==t)&&(nl=null,Ii(e,t)),t=!1;var y=xt;e:do try{if(We!==0&&Pe!==null){var j=Pe,k=un;switch(We){case 8:Ec(),y=6;break e;case 3:case 2:case 9:case 6:on.current===null&&(t=!0);var Y=We;if(We=0,un=null,Hi(e,j,k,Y),n&&Bi){y=0;break e}break;default:Y=We,We=0,un=null,Hi(e,j,k,Y)}}vy(),y=xt;break}catch(re){yh(e,re)}while(!0);return t&&e.shellSuspendCounter++,Gn=Pa=null,Xe=i,C.H=c,C.A=f,Pe===null&&(lt=null,Ke=0,ws()),y}function vy(){for(;Pe!==null;)xh(Pe)}function by(e,t){var n=Xe;Xe|=2;var i=bh(),c=_h();lt!==e||Ke!==t?(nl=null,tl=Gt()+500,Ii(e,t)):Bi=nn(e,t);e:do try{if(We!==0&&Pe!==null){t=Pe;var f=un;t:switch(We){case 1:We=0,un=null,Hi(e,t,f,1);break;case 2:case 9:if(Rd(f)){We=0,un=null,jh(t);break}t=function(){We!==2&&We!==9||lt!==e||(We=7),Bn(e)},f.then(t,t);break e;case 3:We=7;break e;case 4:We=5;break e;case 7:Rd(f)?(We=0,un=null,jh(t)):(We=0,un=null,Hi(e,t,f,7));break;case 5:var y=null;switch(Pe.tag){case 26:y=Pe.memoizedState;case 5:case 27:var j=Pe;if(y?lg(y):j.stateNode.complete){We=0,un=null;var k=j.sibling;if(k!==null)Pe=k;else{var Y=j.return;Y!==null?(Pe=Y,rl(Y)):Pe=null}break t}}We=0,un=null,Hi(e,t,f,5);break;case 6:We=0,un=null,Hi(e,t,f,6);break;case 8:Ec(),xt=6;break e;default:throw Error(l(462))}}_y();break}catch(re){yh(e,re)}while(!0);return Gn=Pa=null,C.H=i,C.A=c,Xe=n,Pe!==null?0:(lt=null,Ke=0,ws(),xt)}function _y(){for(;Pe!==null&&!Ua();)xh(Pe)}function xh(e){var t=Gf(e.alternate,e,ta);e.memoizedProps=e.pendingProps,t===null?rl(e):Pe=t}function jh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=qf(n,t,t.pendingProps,t.type,void 0,Ke);break;case 11:t=qf(n,t,t.pendingProps,t.type.render,t.ref,Ke);break;case 5:Ho(t);default:Yf(n,t),t=Pe=bd(t,ta),t=Gf(n,t,ta)}e.memoizedProps=e.pendingProps,t===null?rl(e):Pe=t}function Hi(e,t,n,i){Gn=Pa=null,Ho(t),Ri=null,Cr=0;var c=t.return;try{if(oy(e,c,t,n,Ke)){xt=1,Ks(e,vn(n,e.current)),Pe=null;return}}catch(f){if(c!==null)throw Pe=c,f;xt=1,Ks(e,vn(n,e.current)),Pe=null;return}t.flags&32768?(Fe||i===1?e=!0:Bi||(Ke&536870912)!==0?e=!1:(va=e=!0,(i===2||i===9||i===3||i===6)&&(i=on.current,i!==null&&i.tag===13&&(i.flags|=16384))),Sh(t,e)):rl(t)}function rl(e){var t=e;do{if((t.flags&32768)!==0){Sh(t,va);return}e=t.return;var n=dy(t.alternate,t,ta);if(n!==null){Pe=n;return}if(t=t.sibling,t!==null){Pe=t;return}Pe=t=e}while(t!==null);xt===0&&(xt=5)}function Sh(e,t){do{var n=fy(e.alternate,e);if(n!==null){n.flags&=32767,Pe=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Pe=e;return}Pe=e=n}while(e!==null);xt=6,Pe=null}function wh(e,t,n,i,c,f,y,j,k){e.cancelPendingCommit=null;do sl();while(kt!==0);if((Xe&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(f=t.lanes|t.childLanes,f|=go,Kl(e,n,f,y,j,k),e===lt&&(Pe=lt=null,Ke=0),qi=t,xa=e,na=n,jc=f,Sc=c,hh=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,wy(ui,function(){return Nh(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=C.T,C.T=null,c=U.p,U.p=2,y=Xe,Xe|=4;try{hy(e,t,n)}finally{Xe=y,U.p=c,C.T=i}}kt=1,Eh(),Ch(),Th()}}function Eh(){if(kt===1){kt=0;var e=xa,t=qi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=C.T,C.T=null;var i=U.p;U.p=2;var c=Xe;Xe|=4;try{rh(t,e);var f=Mc,y=ud(e.containerInfo),j=f.focusedElem,k=f.selectionRange;if(y!==j&&j&&j.ownerDocument&&cd(j.ownerDocument.documentElement,j)){if(k!==null&&oo(j)){var Y=k.start,re=k.end;if(re===void 0&&(re=Y),"selectionStart"in j)j.selectionStart=Y,j.selectionEnd=Math.min(re,j.value.length);else{var de=j.ownerDocument||document,F=de&&de.defaultView||window;if(F.getSelection){var Z=F.getSelection(),Se=j.textContent.length,Ue=Math.min(k.start,Se),it=k.end===void 0?Ue:Math.min(k.end,Se);!Z.extend&&Ue>it&&(y=it,it=Ue,Ue=y);var $=od(j,Ue),z=od(j,it);if($&&z&&(Z.rangeCount!==1||Z.anchorNode!==$.node||Z.anchorOffset!==$.offset||Z.focusNode!==z.node||Z.focusOffset!==z.offset)){var G=de.createRange();G.setStart($.node,$.offset),Z.removeAllRanges(),Ue>it?(Z.addRange(G),Z.extend(z.node,z.offset)):(G.setEnd(z.node,z.offset),Z.addRange(G))}}}}for(de=[],Z=j;Z=Z.parentNode;)Z.nodeType===1&&de.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<de.length;j++){var ce=de[j];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}vl=!!Bc,Mc=Bc=null}finally{Xe=c,U.p=i,C.T=n}}e.current=t,kt=2}}function Ch(){if(kt===2){kt=0;var e=xa,t=qi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=C.T,C.T=null;var i=U.p;U.p=2;var c=Xe;Xe|=4;try{eh(e,t.alternate,t)}finally{Xe=c,U.p=i,C.T=n}}kt=3}}function Th(){if(kt===4||kt===3){kt=0,oi();var e=xa,t=qi,n=na,i=hh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?kt=5:(kt=0,qi=xa=null,Ah(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(_a=null),cr(n),t=t.stateNode,Kt&&typeof Kt.onCommitFiberRoot=="function")try{Kt.onCommitFiberRoot(za,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=C.T,c=U.p,U.p=2,C.T=null;try{for(var f=e.onRecoverableError,y=0;y<i.length;y++){var j=i[y];f(j.value,{componentStack:j.stack})}}finally{C.T=t,U.p=c}}(na&3)!==0&&sl(),Bn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===wc?Vr++:(Vr=0,wc=e):Vr=0,Pr(0)}}function Ah(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,wr(t)))}function sl(){return Eh(),Ch(),Th(),Nh()}function Nh(){if(kt!==5)return!1;var e=xa,t=jc;jc=0;var n=cr(na),i=C.T,c=U.p;try{U.p=32>n?32:n,C.T=null,n=Sc,Sc=null;var f=xa,y=na;if(kt=0,qi=xa=null,na=0,(Xe&6)!==0)throw Error(l(331));var j=Xe;if(Xe|=4,uh(f.current),lh(f,f.current,y,n),Xe=j,Pr(0,!1),Kt&&typeof Kt.onPostCommitFiberRoot=="function")try{Kt.onPostCommitFiberRoot(za,f)}catch{}return!0}finally{U.p=c,C.T=i,Ah(e,t)}}function Rh(e,t,n){t=vn(n,t),t=nc(e.stateNode,t,2),e=ga(e,t,2),e!==null&&(qn(e,2),Bn(e))}function et(e,t,n){if(e.tag===3)Rh(e,e,n);else for(;t!==null;){if(t.tag===3){Rh(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(_a===null||!_a.has(i))){e=vn(n,e),n=Of(2),i=ga(t,n,2),i!==null&&(kf(n,i,t,e),qn(i,2),Bn(i));break}}t=t.return}}function Tc(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new my;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(n)||(bc=!0,c.add(n),e=xy.bind(null,e,t,n),t.then(e,e))}function xy(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,lt===e&&(Ke&n)===n&&(xt===4||xt===3&&(Ke&62914560)===Ke&&300>Gt()-el?(Xe&2)===0&&Ii(e,0):_c|=n,Mi===Ke&&(Mi=0)),Bn(e)}function Oh(e,t){t===0&&(t=ds()),e=Ha(e,t),e!==null&&(qn(e,t),Bn(e))}function jy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Oh(e,n)}function Sy(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(t),Oh(e,n)}function wy(e,t){return ot(e,t)}var ll=null,$i=null,Ac=!1,ol=!1,Nc=!1,Sa=0;function Bn(e){e!==$i&&e.next===null&&($i===null?ll=$i=e:$i=$i.next=e),ol=!0,Ac||(Ac=!0,Cy())}function Pr(e,t){if(!Nc&&ol){Nc=!0;do for(var n=!1,i=ll;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var f=0;else{var y=i.suspendedLanes,j=i.pingedLanes;f=(1<<31-Yt(42|e)+1)-1,f&=c&~(y&~j),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(n=!0,Dh(i,f))}else f=Ke,f=pn(i,i===lt?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(f&3)===0||nn(i,f)||(n=!0,Dh(i,f));i=i.next}while(n);Nc=!1}}function Ey(){kh()}function kh(){ol=Ac=!1;var e=0;Sa!==0&&Ly()&&(e=Sa);for(var t=Gt(),n=null,i=ll;i!==null;){var c=i.next,f=Uh(i,t);f===0?(i.next=null,n===null?ll=c:n.next=c,c===null&&($i=n)):(n=i,(e!==0||(f&3)!==0)&&(ol=!0)),i=c}kt!==0&&kt!==5||Pr(e),Sa!==0&&(Sa=0)}function Uh(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Yt(f),j=1<<y,k=c[y];k===-1?((j&n)===0||(j&i)!==0)&&(c[y]=us(j,t)):k<=t&&(e.expiredLanes|=j),f&=~j}if(t=lt,n=Ke,n=pn(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,n===0||e===t&&(We===2||We===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&Ze(i),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||nn(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&Ze(i),cr(n)){case 2:case 8:n=ci;break;case 32:n=ui;break;case 268435456:n=sr;break;default:n=ui}return i=zh.bind(null,e),n=ot(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&Ze(i),e.callbackPriority=2,e.callbackNode=null,2}function zh(e,t){if(kt!==0&&kt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(sl()&&e.callbackNode!==n)return null;var i=Ke;return i=pn(e,e===lt?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(ph(e,i,t),Uh(e,Gt()),e.callbackNode!=null&&e.callbackNode===n?zh.bind(null,e):null)}function Dh(e,t){if(sl())return null;ph(e,t,!0)}function Cy(){My(function(){(Xe&6)!==0?ot(rr,Ey):kh()})}function Rc(){if(Sa===0){var e=Ti;e===0&&(e=di,di<<=1,(di&261888)===0&&(di=256)),Sa=e}return Sa}function Lh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ms(""+e)}function Bh(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ty(e,t,n,i,c){if(t==="submit"&&n&&n.stateNode===c){var f=Lh((c[$t]||null).action),y=i.submitter;y&&(t=(t=y[$t]||null)?Lh(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var j=new _s("action","action",null,i,c);e.push({event:j,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Sa!==0){var k=y?Bh(c,y):new FormData(c);Qo(n,{pending:!0,data:k,method:c.method,action:f},null,k)}}else typeof f=="function"&&(j.preventDefault(),k=y?Bh(c,y):new FormData(c),Qo(n,{pending:!0,data:k,method:c.method,action:f},f,k))},currentTarget:c}]})}}for(var Oc=0;Oc<ho.length;Oc++){var kc=ho[Oc],Ay=kc.toLowerCase(),Ny=kc[0].toUpperCase()+kc.slice(1);An(Ay,"on"+Ny)}An(hd,"onAnimationEnd"),An(gd,"onAnimationIteration"),An(pd,"onAnimationStart"),An("dblclick","onDoubleClick"),An("focusin","onFocus"),An("focusout","onBlur"),An(Gm,"onTransitionRun"),An(Km,"onTransitionStart"),An(Ym,"onTransitionCancel"),An(md,"onTransitionEnd"),Oe("onMouseEnter",["mouseout","mouseover"]),Oe("onMouseLeave",["mouseout","mouseover"]),Oe("onPointerEnter",["pointerout","pointerover"]),Oe("onPointerLeave",["pointerout","pointerover"]),ne("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ne("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ne("onBeforeInput",["compositionend","keypress","textInput","paste"]),ne("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ne("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ne("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ry=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Gr));function Mh(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],c=i.event;i=i.listeners;e:{var f=void 0;if(t)for(var y=i.length-1;0<=y;y--){var j=i[y],k=j.instance,Y=j.currentTarget;if(j=j.listener,k!==f&&c.isPropagationStopped())break e;f=j,c.currentTarget=Y;try{f(c)}catch(re){Ss(re)}c.currentTarget=null,f=k}else for(y=0;y<i.length;y++){if(j=i[y],k=j.instance,Y=j.currentTarget,j=j.listener,k!==f&&c.isPropagationStopped())break e;f=j,c.currentTarget=Y;try{f(c)}catch(re){Ss(re)}c.currentTarget=null,f=k}}}}function Ge(e,t){var n=t[hi];n===void 0&&(n=t[hi]=new Set);var i=e+"__bubble";n.has(i)||(qh(t,e,2,!1),n.add(i))}function Uc(e,t,n){var i=0;t&&(i|=4),qh(n,e,i,t)}var cl="_reactListening"+Math.random().toString(36).slice(2);function zc(e){if(!e[cl]){e[cl]=!0,je.forEach(function(n){n!=="selectionchange"&&(Ry.has(n)||Uc(n,!1,e),Uc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cl]||(t[cl]=!0,Uc("selectionchange",!1,t))}}function qh(e,t,n,i){switch(gg(t)){case 2:var c=iv;break;case 8:c=rv;break;default:c=Jc}n=c.bind(null,t,n,e),c=void 0,!Wl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Dc(e,t,n,i,c){var f=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var j=i.stateNode.containerInfo;if(j===c)break;if(y===4)for(y=i.return;y!==null;){var k=y.tag;if((k===3||k===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;j!==null;){if(y=_e(j),y===null)return;if(k=y.tag,k===5||k===6||k===26||k===27){i=f=y;continue e}j=j.parentNode}}i=i.return}Vu(function(){var Y=f,re=Xl(n),de=[];e:{var F=yd.get(e);if(F!==void 0){var Z=_s,Se=e;switch(e){case"keypress":if(vs(n)===0)break e;case"keydown":case"keyup":Z=Sm;break;case"focusin":Se="focus",Z=ao;break;case"focusout":Se="blur",Z=ao;break;case"beforeblur":case"afterblur":Z=ao;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=dm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=Cm;break;case hd:case gd:case pd:Z=gm;break;case md:Z=Am;break;case"scroll":case"scrollend":Z=cm;break;case"wheel":Z=Rm;break;case"copy":case"cut":case"paste":Z=mm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=Fu;break;case"toggle":case"beforetoggle":Z=km}var Ue=(t&4)!==0,it=!Ue&&(e==="scroll"||e==="scrollend"),$=Ue?F!==null?F+"Capture":null:F;Ue=[];for(var z=Y,G;z!==null;){var ce=z;if(G=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||G===null||$===null||(ce=hr(z,$),ce!=null&&Ue.push(Kr(z,ce,G))),it)break;z=z.return}0<Ue.length&&(F=new Z(F,Se,null,n,re),de.push({event:F,listeners:Ue}))}}if((t&7)===0){e:{if(F=e==="mouseover"||e==="pointerover",Z=e==="mouseout"||e==="pointerout",F&&n!==Ql&&(Se=n.relatedTarget||n.fromElement)&&(_e(Se)||Se[In]))break e;if((Z||F)&&(F=re.window===re?re:(F=re.ownerDocument)?F.defaultView||F.parentWindow:window,Z?(Se=n.relatedTarget||n.toElement,Z=Y,Se=Se?_e(Se):null,Se!==null&&(it=d(Se),Ue=Se.tag,Se!==it||Ue!==5&&Ue!==27&&Ue!==6)&&(Se=null)):(Z=null,Se=Y),Z!==Se)){if(Ue=Ku,ce="onMouseLeave",$="onMouseEnter",z="mouse",(e==="pointerout"||e==="pointerover")&&(Ue=Fu,ce="onPointerLeave",$="onPointerEnter",z="pointer"),it=Z==null?F:be(Z),G=Se==null?F:be(Se),F=new Ue(ce,z+"leave",Z,n,re),F.target=it,F.relatedTarget=G,ce=null,_e(re)===Y&&(Ue=new Ue($,z+"enter",Se,n,re),Ue.target=G,Ue.relatedTarget=it,ce=Ue),it=ce,Z&&Se)t:{for(Ue=Oy,$=Z,z=Se,G=0,ce=$;ce;ce=Ue(ce))G++;ce=0;for(var Re=z;Re;Re=Ue(Re))ce++;for(;0<G-ce;)$=Ue($),G--;for(;0<ce-G;)z=Ue(z),ce--;for(;G--;){if($===z||z!==null&&$===z.alternate){Ue=$;break t}$=Ue($),z=Ue(z)}Ue=null}else Ue=null;Z!==null&&Ih(de,F,Z,Ue,!1),Se!==null&&it!==null&&Ih(de,it,Se,Ue,!0)}}e:{if(F=Y?be(Y):window,Z=F.nodeName&&F.nodeName.toLowerCase(),Z==="select"||Z==="input"&&F.type==="file")var Je=nd;else if(ed(F))if(ad)Je=$m;else{Je=Im;var Ee=qm}else Z=F.nodeName,!Z||Z.toLowerCase()!=="input"||F.type!=="checkbox"&&F.type!=="radio"?Y&&Jl(Y.elementType)&&(Je=nd):Je=Hm;if(Je&&(Je=Je(e,Y))){td(de,Je,n,re);break e}Ee&&Ee(e,F,Y),e==="focusout"&&Y&&F.type==="number"&&Y.memoizedProps.value!=null&&tt(F,"number",F.value)}switch(Ee=Y?be(Y):window,e){case"focusin":(ed(Ee)||Ee.contentEditable==="true")&&(bi=Ee,co=Y,xr=null);break;case"focusout":xr=co=bi=null;break;case"mousedown":uo=!0;break;case"contextmenu":case"mouseup":case"dragend":uo=!1,dd(de,n,re);break;case"selectionchange":if(Pm)break;case"keydown":case"keyup":dd(de,n,re)}var He;if(ro)e:{switch(e){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else vi?Zu(e,n)&&(Ye="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ye="onCompositionStart");Ye&&(Ju&&n.locale!=="ko"&&(vi||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&vi&&(He=Pu()):(la=re,eo="value"in la?la.value:la.textContent,vi=!0)),Ee=ul(Y,Ye),0<Ee.length&&(Ye=new Yu(Ye,e,null,n,re),de.push({event:Ye,listeners:Ee}),He?Ye.data=He:(He=Wu(n),He!==null&&(Ye.data=He)))),(He=zm?Dm(e,n):Lm(e,n))&&(Ye=ul(Y,"onBeforeInput"),0<Ye.length&&(Ee=new Yu("onBeforeInput","beforeinput",null,n,re),de.push({event:Ee,listeners:Ye}),Ee.data=He)),Ty(de,e,Y,n,re)}Mh(de,t)})}function Kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ul(e,t){for(var n=t+"Capture",i=[];e!==null;){var c=e,f=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||f===null||(c=hr(e,n),c!=null&&i.unshift(Kr(e,c,f)),c=hr(e,t),c!=null&&i.push(Kr(e,c,f))),e.tag===3)return i;e=e.return}return[]}function Oy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Ih(e,t,n,i,c){for(var f=t._reactName,y=[];n!==null&&n!==i;){var j=n,k=j.alternate,Y=j.stateNode;if(j=j.tag,k!==null&&k===i)break;j!==5&&j!==26&&j!==27||Y===null||(k=Y,c?(Y=hr(n,f),Y!=null&&y.unshift(Kr(n,Y,k))):c||(Y=hr(n,f),Y!=null&&y.push(Kr(n,Y,k)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var ky=/\r\n?/g,Uy=/\u0000|\uFFFD/g;function Hh(e){return(typeof e=="string"?e:""+e).replace(ky,`
`).replace(Uy,"")}function $h(e,t){return t=Hh(t),Hh(e)===t}function at(e,t,n,i,c,f){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||pi(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&pi(e,""+i);break;case"className":st(e,"class",i);break;case"tabIndex":st(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":st(e,n,i);break;case"style":Hu(e,i,f);break;case"data":if(t!=="object"){st(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(n==="formAction"?(t!=="input"&&at(e,t,"name",c.name,c,null),at(e,t,"formEncType",c.formEncType,c,null),at(e,t,"formMethod",c.formMethod,c,null),at(e,t,"formTarget",c.formTarget,c,null)):(at(e,t,"encType",c.encType,c,null),at(e,t,"method",c.method,c,null),at(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=Hn);break;case"onScroll":i!=null&&Ge("scroll",e);break;case"onScrollEnd":i!=null&&Ge("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=ms(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":Ge("beforetoggle",e),Ge("toggle",e),rt(e,"popover",i);break;case"xlinkActuate":Dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Dt(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Dt(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Dt(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Dt(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":rt(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=lm.get(n)||n,rt(e,n,i))}}function Lc(e,t,n,i,c,f){switch(n){case"style":Hu(e,i,f);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof i=="string"?pi(e,i):(typeof i=="number"||typeof i=="bigint")&&pi(e,""+i);break;case"onScroll":i!=null&&Ge("scroll",e);break;case"onScrollEnd":i!=null&&Ge("scrollend",e);break;case"onClick":i!=null&&(e.onclick=Hn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ue.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),f=e[$t]||null,f=f!=null?f[n]:null,typeof f=="function"&&e.removeEventListener(t,f,c),typeof i=="function")){typeof f!="function"&&f!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,c);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):rt(e,n,i)}}}function qt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",e),Ge("load",e);var i=!1,c=!1,f;for(f in n)if(n.hasOwnProperty(f)){var y=n[f];if(y!=null)switch(f){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:at(e,t,f,y,n,null)}}c&&at(e,t,"srcSet",n.srcSet,n,null),i&&at(e,t,"src",n.src,n,null);return;case"input":Ge("invalid",e);var j=f=y=c=null,k=null,Y=null;for(i in n)if(n.hasOwnProperty(i)){var re=n[i];if(re!=null)switch(i){case"name":c=re;break;case"type":y=re;break;case"checked":k=re;break;case"defaultChecked":Y=re;break;case"value":f=re;break;case"defaultValue":j=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(l(137,t));break;default:at(e,t,i,re,n,null)}}qe(e,f,j,k,Y,y,c,!1);return;case"select":Ge("invalid",e),i=y=f=null;for(c in n)if(n.hasOwnProperty(c)&&(j=n[c],j!=null))switch(c){case"value":f=j;break;case"defaultValue":y=j;break;case"multiple":i=j;default:at(e,t,c,j,n,null)}t=f,n=y,e.multiple=!!i,t!=null?Ct(e,!!i,t,!1):n!=null&&Ct(e,!!i,n,!0);return;case"textarea":Ge("invalid",e),f=c=i=null;for(y in n)if(n.hasOwnProperty(y)&&(j=n[y],j!=null))switch(y){case"value":i=j;break;case"defaultValue":c=j;break;case"children":f=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(l(91));break;default:at(e,t,y,j,n,null)}fr(e,i,c,f);return;case"option":for(k in n)if(n.hasOwnProperty(k)&&(i=n[k],i!=null))switch(k){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:at(e,t,k,i,n,null)}return;case"dialog":Ge("beforetoggle",e),Ge("toggle",e),Ge("cancel",e),Ge("close",e);break;case"iframe":case"object":Ge("load",e);break;case"video":case"audio":for(i=0;i<Gr.length;i++)Ge(Gr[i],e);break;case"image":Ge("error",e),Ge("load",e);break;case"details":Ge("toggle",e);break;case"embed":case"source":case"link":Ge("error",e),Ge("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in n)if(n.hasOwnProperty(Y)&&(i=n[Y],i!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:at(e,t,Y,i,n,null)}return;default:if(Jl(t)){for(re in n)n.hasOwnProperty(re)&&(i=n[re],i!==void 0&&Lc(e,t,re,i,n,void 0));return}}for(j in n)n.hasOwnProperty(j)&&(i=n[j],i!=null&&at(e,t,j,i,n,null))}function zy(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,f=null,y=null,j=null,k=null,Y=null,re=null;for(Z in n){var de=n[Z];if(n.hasOwnProperty(Z)&&de!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":k=de;default:i.hasOwnProperty(Z)||at(e,t,Z,null,i,de)}}for(var F in i){var Z=i[F];if(de=n[F],i.hasOwnProperty(F)&&(Z!=null||de!=null))switch(F){case"type":f=Z;break;case"name":c=Z;break;case"checked":Y=Z;break;case"defaultChecked":re=Z;break;case"value":y=Z;break;case"defaultValue":j=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(l(137,t));break;default:Z!==de&&at(e,t,F,Z,i,de)}}Et(e,y,j,k,Y,re,f,c);return;case"select":Z=y=j=F=null;for(f in n)if(k=n[f],n.hasOwnProperty(f)&&k!=null)switch(f){case"value":break;case"multiple":Z=k;default:i.hasOwnProperty(f)||at(e,t,f,null,i,k)}for(c in i)if(f=i[c],k=n[c],i.hasOwnProperty(c)&&(f!=null||k!=null))switch(c){case"value":F=f;break;case"defaultValue":j=f;break;case"multiple":y=f;default:f!==k&&at(e,t,c,f,i,k)}t=j,n=y,i=Z,F!=null?Ct(e,!!n,F,!1):!!i!=!!n&&(t!=null?Ct(e,!!n,t,!0):Ct(e,!!n,n?[]:"",!1));return;case"textarea":Z=F=null;for(j in n)if(c=n[j],n.hasOwnProperty(j)&&c!=null&&!i.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:at(e,t,j,null,i,c)}for(y in i)if(c=i[y],f=n[y],i.hasOwnProperty(y)&&(c!=null||f!=null))switch(y){case"value":F=c;break;case"defaultValue":Z=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==f&&at(e,t,y,c,i,f)}dr(e,F,Z);return;case"option":for(var Se in n)if(F=n[Se],n.hasOwnProperty(Se)&&F!=null&&!i.hasOwnProperty(Se))switch(Se){case"selected":e.selected=!1;break;default:at(e,t,Se,null,i,F)}for(k in i)if(F=i[k],Z=n[k],i.hasOwnProperty(k)&&F!==Z&&(F!=null||Z!=null))switch(k){case"selected":e.selected=F&&typeof F!="function"&&typeof F!="symbol";break;default:at(e,t,k,F,i,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in n)F=n[Ue],n.hasOwnProperty(Ue)&&F!=null&&!i.hasOwnProperty(Ue)&&at(e,t,Ue,null,i,F);for(Y in i)if(F=i[Y],Z=n[Y],i.hasOwnProperty(Y)&&F!==Z&&(F!=null||Z!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(l(137,t));break;default:at(e,t,Y,F,i,Z)}return;default:if(Jl(t)){for(var it in n)F=n[it],n.hasOwnProperty(it)&&F!==void 0&&!i.hasOwnProperty(it)&&Lc(e,t,it,void 0,i,F);for(re in i)F=i[re],Z=n[re],!i.hasOwnProperty(re)||F===Z||F===void 0&&Z===void 0||Lc(e,t,re,F,i,Z);return}}for(var $ in n)F=n[$],n.hasOwnProperty($)&&F!=null&&!i.hasOwnProperty($)&&at(e,t,$,null,i,F);for(de in i)F=i[de],Z=n[de],!i.hasOwnProperty(de)||F===Z||F==null&&Z==null||at(e,t,de,F,i,Z)}function Vh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Dy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var c=n[i],f=c.transferSize,y=c.initiatorType,j=c.duration;if(f&&j&&Vh(y)){for(y=0,j=c.responseEnd,i+=1;i<n.length;i++){var k=n[i],Y=k.startTime;if(Y>j)break;var re=k.transferSize,de=k.initiatorType;re&&Vh(de)&&(k=k.responseEnd,y+=re*(k<j?1:(j-Y)/(k-Y)))}if(--i,t+=8*(f+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Bc=null,Mc=null;function dl(e){return e.nodeType===9?e:e.ownerDocument}function Ph(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gh(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function qc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ic=null;function Ly(){var e=window.event;return e&&e.type==="popstate"?e===Ic?!1:(Ic=e,!0):(Ic=null,!1)}var Kh=typeof setTimeout=="function"?setTimeout:void 0,By=typeof clearTimeout=="function"?clearTimeout:void 0,Yh=typeof Promise=="function"?Promise:void 0,My=typeof queueMicrotask=="function"?queueMicrotask:typeof Yh<"u"?function(e){return Yh.resolve(null).then(e).catch(qy)}:Kh;function qy(e){setTimeout(function(){throw e})}function wa(e){return e==="head"}function Fh(e,t){var n=t,i=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(i===0){e.removeChild(c),Ki(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")Yr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Yr(n);for(var f=n.firstChild;f;){var y=f.nextSibling,j=f.nodeName;f[H]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&f.rel.toLowerCase()==="stylesheet"||n.removeChild(f),f=y}}else n==="body"&&Yr(e.ownerDocument.body);n=c}while(n);Ki(t)}function Jh(e,t){var n=e;e=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=i}while(n)}function Hc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Hc(n),ie(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Iy(e,t,n,i){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[H])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=Sn(e.nextSibling),e===null)break}return null}function Hy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Sn(e.nextSibling),e===null))return null;return e}function Qh(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=Sn(e.nextSibling),e===null))return null;return e}function $c(e){return e.data==="$?"||e.data==="$~"}function Vc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function $y(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function Sn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Pc=null;function Xh(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return Sn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function Zh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Wh(e,t,n){switch(t=dl(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Yr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);ie(e)}var wn=new Map,eg=new Set;function fl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var aa=U.d;U.d={f:Vy,r:Py,D:Gy,C:Ky,L:Yy,m:Fy,X:Qy,S:Jy,M:Xy};function Vy(){var e=aa.f(),t=al();return e||t}function Py(e){var t=oe(e);t!==null&&t.tag===5&&t.type==="form"?yf(t):aa.r(e)}var Vi=typeof document>"u"?null:document;function tg(e,t,n){var i=Vi;if(i&&typeof t=="string"&&t){var c=Ve(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),eg.has(c)||(eg.add(c),e={rel:e,crossOrigin:n,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),qt(t,"link",e),se(t),i.head.appendChild(t)))}}function Gy(e){aa.D(e),tg("dns-prefetch",e,null)}function Ky(e,t){aa.C(e,t),tg("preconnect",e,t)}function Yy(e,t,n){aa.L(e,t,n);var i=Vi;if(i&&e&&t){var c='link[rel="preload"][as="'+Ve(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+Ve(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+Ve(n.imageSizes)+'"]')):c+='[href="'+Ve(e)+'"]';var f=c;switch(t){case"style":f=Pi(e);break;case"script":f=Gi(e)}wn.has(f)||(e=_({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),wn.set(f,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(Fr(f))||t==="script"&&i.querySelector(Jr(f))||(t=i.createElement("link"),qt(t,"link",e),se(t),i.head.appendChild(t)))}}function Fy(e,t){aa.m(e,t);var n=Vi;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+Ve(i)+'"][href="'+Ve(e)+'"]',f=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Gi(e)}if(!wn.has(f)&&(e=_({rel:"modulepreload",href:e},t),wn.set(f,e),n.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Jr(f)))return}i=n.createElement("link"),qt(i,"link",e),se(i),n.head.appendChild(i)}}}function Jy(e,t,n){aa.S(e,t,n);var i=Vi;if(i&&e){var c=ve(i).hoistableStyles,f=Pi(e);t=t||"default";var y=c.get(f);if(!y){var j={loading:0,preload:null};if(y=i.querySelector(Fr(f)))j.loading=5;else{e=_({rel:"stylesheet",href:e,"data-precedence":t},n),(n=wn.get(f))&&Gc(e,n);var k=y=i.createElement("link");se(k),qt(k,"link",e),k._p=new Promise(function(Y,re){k.onload=Y,k.onerror=re}),k.addEventListener("load",function(){j.loading|=1}),k.addEventListener("error",function(){j.loading|=2}),j.loading|=4,hl(y,t,i)}y={type:"stylesheet",instance:y,count:1,state:j},c.set(f,y)}}}function Qy(e,t){aa.X(e,t);var n=Vi;if(n&&e){var i=ve(n).hoistableScripts,c=Gi(e),f=i.get(c);f||(f=n.querySelector(Jr(c)),f||(e=_({src:e,async:!0},t),(t=wn.get(c))&&Kc(e,t),f=n.createElement("script"),se(f),qt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},i.set(c,f))}}function Xy(e,t){aa.M(e,t);var n=Vi;if(n&&e){var i=ve(n).hoistableScripts,c=Gi(e),f=i.get(c);f||(f=n.querySelector(Jr(c)),f||(e=_({src:e,async:!0,type:"module"},t),(t=wn.get(c))&&Kc(e,t),f=n.createElement("script"),se(f),qt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},i.set(c,f))}}function ng(e,t,n,i){var c=(c=le.current)?fl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Pi(n.href),n=ve(c).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Pi(n.href);var f=ve(c).hoistableStyles,y=f.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=c.querySelector(Fr(e)))&&!f._p&&(y.instance=f,y.state.loading=5),wn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},wn.set(e,n),f||Zy(c,e,n,y.state))),t&&i===null)throw Error(l(528,""));return y}if(t&&i!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Gi(n),n=ve(c).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Pi(e){return'href="'+Ve(e)+'"'}function Fr(e){return'link[rel="stylesheet"]['+e+"]"}function ag(e){return _({},e,{"data-precedence":e.precedence,precedence:null})}function Zy(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),qt(t,"link",n),se(t),e.head.appendChild(t))}function Gi(e){return'[src="'+Ve(e)+'"]'}function Jr(e){return"script[async]"+e}function ig(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+Ve(n.href)+'"]');if(i)return t.instance=i,se(i),i;var c=_({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),se(i),qt(i,"style",c),hl(i,n.precedence,e),t.instance=i;case"stylesheet":c=Pi(n.href);var f=e.querySelector(Fr(c));if(f)return t.state.loading|=4,t.instance=f,se(f),f;i=ag(n),(c=wn.get(c))&&Gc(i,c),f=(e.ownerDocument||e).createElement("link"),se(f);var y=f;return y._p=new Promise(function(j,k){y.onload=j,y.onerror=k}),qt(f,"link",i),t.state.loading|=4,hl(f,n.precedence,e),t.instance=f;case"script":return f=Gi(n.src),(c=e.querySelector(Jr(f)))?(t.instance=c,se(c),c):(i=n,(c=wn.get(f))&&(i=_({},n),Kc(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),se(c),qt(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,hl(i,n.precedence,e));return t.instance}function hl(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,f=c,y=0;y<i.length;y++){var j=i[y];if(j.dataset.precedence===t)f=j;else if(f!==c)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Gc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Kc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var gl=null;function rg(e,t,n){if(gl===null){var i=new Map,c=gl=new Map;c.set(n,i)}else c=gl,i=c.get(n),i||(i=new Map,c.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var f=n[c];if(!(f[H]||f[ft]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var j=i.get(y);j?j.push(f):i.set(y,[f])}}return i}function sg(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Wy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function lg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function ev(e,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=Pi(i.href),f=t.querySelector(Fr(c));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=pl.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=f,se(f);return}f=t.ownerDocument||t,i=ag(i),(c=wn.get(c))&&Gc(i,c),f=f.createElement("link"),se(f);var y=f;y._p=new Promise(function(j,k){y.onload=j,y.onerror=k}),qt(f,"link",i),n.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=pl.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Yc=0;function tv(e,t){return e.stylesheets&&e.count===0&&yl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&Yc===0&&(Yc=62500*Dy());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>Yc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function pl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)yl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ml=null;function yl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ml=new Map,t.forEach(nv,e),ml=null,pl.call(e))}function nv(e,t){if(!(t.state.loading&4)){var n=ml.get(e);if(n)var i=n.get(null);else{n=new Map,ml.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<c.length;f++){var y=c[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),i=y)}i&&n.set(null,i)}c=t.instance,y=c.getAttribute("data-precedence"),f=n.get(y)||i,f===i&&n.set(null,c),n.set(y,c),this.count++,i=pl.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),f?f.parentNode.insertBefore(c,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Qr={$$typeof:B,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function av(e,t,n,i,c,f,y,j,k){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=lr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lr(0),this.hiddenUpdates=lr(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function og(e,t,n,i,c,f,y,j,k,Y,re,de){return e=new av(e,t,n,y,k,Y,re,de,j),t=1,f===!0&&(t|=24),f=ln(3,null,null,t),e.current=f,f.stateNode=e,t=Co(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:i,isDehydrated:n,cache:t},Ro(f),e}function cg(e){return e?(e=ji,e):ji}function ug(e,t,n,i,c,f){c=cg(c),i.context===null?i.context=c:i.pendingContext=c,i=ha(t),i.payload={element:n},f=f===void 0?null:f,f!==null&&(i.callback=f),n=ga(e,i,t),n!==null&&(en(n,e,t),Ar(n,e,t))}function dg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Fc(e,t){dg(e,t),(e=e.alternate)&&dg(e,t)}function fg(e){if(e.tag===13||e.tag===31){var t=Ha(e,67108864);t!==null&&en(t,e,67108864),Fc(e,67108864)}}function hg(e){if(e.tag===13||e.tag===31){var t=fn();t=or(t);var n=Ha(e,t);n!==null&&en(n,e,t),Fc(e,t)}}var vl=!0;function iv(e,t,n,i){var c=C.T;C.T=null;var f=U.p;try{U.p=2,Jc(e,t,n,i)}finally{U.p=f,C.T=c}}function rv(e,t,n,i){var c=C.T;C.T=null;var f=U.p;try{U.p=8,Jc(e,t,n,i)}finally{U.p=f,C.T=c}}function Jc(e,t,n,i){if(vl){var c=Qc(i);if(c===null)Dc(e,t,i,bl,n),pg(e,i);else if(lv(c,e,t,n,i))i.stopPropagation();else if(pg(e,i),t&4&&-1<sv.indexOf(e)){for(;c!==null;){var f=oe(c);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=Mn(f.pendingLanes);if(y!==0){var j=f;for(j.pendingLanes|=2,j.entangledLanes|=2;y;){var k=1<<31-Yt(y);j.entanglements[1]|=k,y&=~k}Bn(f),(Xe&6)===0&&(tl=Gt()+500,Pr(0))}}break;case 31:case 13:j=Ha(f,2),j!==null&&en(j,f,2),al(),Fc(f,2)}if(f=Qc(i),f===null&&Dc(e,t,i,bl,n),f===c)break;c=f}c!==null&&i.stopPropagation()}else Dc(e,t,i,null,n)}}function Qc(e){return e=Xl(e),Xc(e)}var bl=null;function Xc(e){if(bl=null,e=_e(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=h(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return bl=e,null}function gg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ir()){case rr:return 2;case ci:return 8;case ui:case cs:return 32;case sr:return 268435456;default:return 32}default:return 32}}var Zc=!1,Ea=null,Ca=null,Ta=null,Xr=new Map,Zr=new Map,Aa=[],sv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pg(e,t){switch(e){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":Ca=null;break;case"mouseover":case"mouseout":Ta=null;break;case"pointerover":case"pointerout":Xr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zr.delete(t.pointerId)}}function Wr(e,t,n,i,c,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:f,targetContainers:[c]},t!==null&&(t=oe(t),t!==null&&fg(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function lv(e,t,n,i,c){switch(t){case"focusin":return Ea=Wr(Ea,e,t,n,i,c),!0;case"dragenter":return Ca=Wr(Ca,e,t,n,i,c),!0;case"mouseover":return Ta=Wr(Ta,e,t,n,i,c),!0;case"pointerover":var f=c.pointerId;return Xr.set(f,Wr(Xr.get(f)||null,e,t,n,i,c)),!0;case"gotpointercapture":return f=c.pointerId,Zr.set(f,Wr(Zr.get(f)||null,e,t,n,i,c)),!0}return!1}function mg(e){var t=_e(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){e.blockedOn=t,hs(e.priority,function(){hg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,hs(e.priority,function(){hg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _l(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qc(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Ql=i,n.target.dispatchEvent(i),Ql=null}else return t=oe(n),t!==null&&fg(t),e.blockedOn=n,!1;t.shift()}return!0}function yg(e,t,n){_l(e)&&n.delete(t)}function ov(){Zc=!1,Ea!==null&&_l(Ea)&&(Ea=null),Ca!==null&&_l(Ca)&&(Ca=null),Ta!==null&&_l(Ta)&&(Ta=null),Xr.forEach(yg),Zr.forEach(yg)}function xl(e,t){e.blockedOn===t&&(e.blockedOn=null,Zc||(Zc=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,ov)))}var jl=null;function vg(e){jl!==e&&(jl=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){jl===e&&(jl=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(Xc(i||n)===null)continue;break}var f=oe(n);f!==null&&(e.splice(t,3),t-=3,Qo(f,{pending:!0,data:c,method:n.method,action:i},i,c))}}))}function Ki(e){function t(k){return xl(k,e)}Ea!==null&&xl(Ea,e),Ca!==null&&xl(Ca,e),Ta!==null&&xl(Ta,e),Xr.forEach(t),Zr.forEach(t);for(var n=0;n<Aa.length;n++){var i=Aa[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Aa.length&&(n=Aa[0],n.blockedOn===null);)mg(n),n.blockedOn===null&&Aa.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var c=n[i],f=n[i+1],y=c[$t]||null;if(typeof f=="function")y||vg(n);else if(y){var j=null;if(f&&f.hasAttribute("formAction")){if(c=f,y=f[$t]||null)j=y.formAction;else if(Xc(c)!==null)continue}else j=y.action;typeof j=="function"?n[i+1]=j:(n.splice(i,3),i-=3),vg(n)}}}function bg(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function Wc(e){this._internalRoot=e}Sl.prototype.render=Wc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,i=fn();ug(n,i,e,t,null,null)},Sl.prototype.unmount=Wc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ug(e.current,2,null,e,null,null),al(),t[In]=null}};function Sl(e){this._internalRoot=e}Sl.prototype.unstable_scheduleHydration=function(e){if(e){var t=ur();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Aa.length&&t!==0&&t<Aa[n].priority;n++);Aa.splice(n,0,e),n===0&&mg(e)}};var _g=a.version;if(_g!=="19.2.0")throw Error(l(527,_g,"19.2.0"));U.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var cv={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:C,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{za=wl.inject(cv),Kt=wl}catch{}}return ts.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,i="",c=Tf,f=Af,y=Nf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=og(e,1,!1,null,null,n,i,null,c,f,y,bg),e[In]=t.current,zc(e),new Wc(t)},ts.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var i=!1,c="",f=Tf,y=Af,j=Nf,k=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(j=n.onRecoverableError),n.formState!==void 0&&(k=n.formState)),t=og(e,1,!0,t,n??null,i,c,k,f,y,j,bg),t.context=cg(null),n=t.current,i=fn(),i=or(i),c=ha(i),c.callback=null,ga(n,c,i),n=i,t.current.lanes=n,qn(t,n),Bn(t),e[In]=t.current,zc(e),new Sl(t)},ts.version="19.2.0",ts}var Rg;function _v(){if(Rg)return tu.exports;Rg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),tu.exports=bv(),tu.exports}var xv=_v(),S=Au();const Nu=op(S);var pu=function(o,a){return pu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,l){r.__proto__=l}||function(r,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(r[u]=l[u])},pu(o,a)};function up(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");pu(o,a);function r(){this.constructor=o}o.prototype=a===null?Object.create(a):(r.prototype=a.prototype,new r)}var zl=function(){return zl=Object.assign||function(a){for(var r,l=1,u=arguments.length;l<u;l++){r=arguments[l];for(var d in r)Object.prototype.hasOwnProperty.call(r,d)&&(a[d]=r[d])}return a},zl.apply(this,arguments)};function nr(o,a){var r={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(r[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(r[l[u]]=o[l[u]]);return r}function dp(o,a,r,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,r):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,r,l);else for(var g=o.length-1;g>=0;g--)(h=o[g])&&(d=(u<3?h(d):u>3?h(a,r,d):h(a,r))||d);return u>3&&d&&Object.defineProperty(a,r,d),d}function fp(o,a){return function(r,l){a(r,l,o)}}function hp(o,a,r,l,u,d){function h(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),_,x=!1,b=r.length-1;b>=0;b--){var w={};for(var A in l)w[A]=A==="access"?{}:l[A];for(var A in l.access)w.access[A]=l.access[A];w.addInitializer=function(T){if(x)throw new TypeError("Cannot add initializers after decoration has completed");d.push(h(T||null))};var R=(0,r[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(R===void 0)continue;if(R===null||typeof R!="object")throw new TypeError("Object expected");(_=h(R.get))&&(v.get=_),(_=h(R.set))&&(v.set=_),(_=h(R.init))&&u.unshift(_)}else(_=h(R))&&(g==="field"?u.unshift(_):v[p]=_)}m&&Object.defineProperty(m,l.name,v),x=!0}function gp(o,a,r){for(var l=arguments.length>2,u=0;u<a.length;u++)r=l?a[u].call(o,r):a[u].call(o);return l?r:void 0}function pp(o){return typeof o=="symbol"?o:"".concat(o)}function mp(o,a,r){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:r?"".concat(r," ",a):a})}function yp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function Ce(o,a,r,l){function u(d){return d instanceof r?d:new r(function(h){h(d)})}return new(r||(r=Promise))(function(d,h){function g(v){try{m(l.next(v))}catch(_){h(_)}}function p(v){try{m(l.throw(v))}catch(_){h(_)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function vp(o,a){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=g(0),h.throw=g(1),h.return=g(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;h&&(h=0,m[0]&&(r=0)),r;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,u=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){r.label=m[1];break}if(m[0]===6&&r.label<d[1]){r.label=d[1],d=m;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(m);break}d[2]&&r.ops.pop(),r.trys.pop();continue}m=a.call(o,r)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var ql=Object.create?(function(o,a,r,l){l===void 0&&(l=r);var u=Object.getOwnPropertyDescriptor(a,r);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[r]}}),Object.defineProperty(o,l,u)}):(function(o,a,r,l){l===void 0&&(l=r),o[l]=a[r]});function bp(o,a){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(a,r)&&ql(a,o,r)}function Dl(o){var a=typeof Symbol=="function"&&Symbol.iterator,r=a&&o[a],l=0;if(r)return r.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ru(o,a){var r=typeof Symbol=="function"&&o[Symbol.iterator];if(!r)return o;var l=r.call(o),u,d=[],h;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){h={error:g}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(h)throw h.error}}return d}function _p(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(Ru(arguments[a]));return o}function xp(){for(var o=0,a=0,r=arguments.length;a<r;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<r;a++)for(var d=arguments[a],h=0,g=d.length;h<g;h++,u++)l[u]=d[h];return l}function jp(o,a,r){if(r||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function tr(o){return this instanceof tr?(this.v=o,this):new tr(o)}function Sp(o,a,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=r.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",h),u[Symbol.asyncIterator]=function(){return this},u;function h(b){return function(w){return Promise.resolve(w).then(b,_)}}function g(b,w){l[b]&&(u[b]=function(A){return new Promise(function(R,T){d.push([b,A,R,T])>1||p(b,A)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(A){x(d[0][3],A)}}function m(b){b.value instanceof tr?Promise.resolve(b.value.v).then(v,_):x(d[0][2],b)}function v(b){p("next",b)}function _(b){p("throw",b)}function x(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function wp(o){var a,r;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(h){return(r=!r)?{value:tr(o[u](h)),done:!1}:d?d(h):h}:d}}function Ep(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],r;return a?a.call(o):(o=typeof Dl=="function"?Dl(o):o[Symbol.iterator](),r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r);function l(d){r[d]=o[d]&&function(h){return new Promise(function(g,p){h=o[d](h),u(g,p,h.done,h.value)})}}function u(d,h,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},h)}}function Cp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var jv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},mu=function(o){return mu=Object.getOwnPropertyNames||function(a){var r=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(r[r.length]=l);return r},mu(o)};function Tp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var r=mu(o),l=0;l<r.length;l++)r[l]!=="default"&&ql(a,o,r[l]);return jv(a,o),a}function Ap(o){return o&&o.__esModule?o:{default:o}}function Np(o,a,r,l){if(r==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?l:r==="a"?l.call(o):l?l.value:a.get(o)}function Rp(o,a,r,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,r):u?u.value=r:a.set(o,r),r}function Op(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function kp(o,a,r){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],r&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:r})}else r&&o.stack.push({async:!0});return a}var Sv=typeof SuppressedError=="function"?SuppressedError:function(o,a,r){var l=new Error(r);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Up(o){function a(d){o.error=o.hasError?new Sv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var r,l=0;function u(){for(;r=o.stack.pop();)try{if(!r.async&&l===1)return l=0,o.stack.push(r),Promise.resolve().then(u);if(r.dispose){var d=r.dispose.call(r.value);if(r.async)return l|=2,Promise.resolve(d).then(u,function(h){return a(h),u()})}else l|=1}catch(h){a(h)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function zp(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,l,u,d,h){return l?a?".jsx":".js":u&&(!d||!h)?r:u+d+"."+h.toLowerCase()+"js"}):o}const wv={__extends:up,__assign:zl,__rest:nr,__decorate:dp,__param:fp,__esDecorate:hp,__runInitializers:gp,__propKey:pp,__setFunctionName:mp,__metadata:yp,__awaiter:Ce,__generator:vp,__createBinding:ql,__exportStar:bp,__values:Dl,__read:Ru,__spread:_p,__spreadArrays:xp,__spreadArray:jp,__await:tr,__asyncGenerator:Sp,__asyncDelegator:wp,__asyncValues:Ep,__makeTemplateObject:Cp,__importStar:Tp,__importDefault:Ap,__classPrivateFieldGet:Np,__classPrivateFieldSet:Rp,__classPrivateFieldIn:Op,__addDisposableResource:kp,__disposeResources:Up,__rewriteRelativeImportExtension:zp},Ev=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:kp,get __assign(){return zl},__asyncDelegator:wp,__asyncGenerator:Sp,__asyncValues:Ep,__await:tr,__awaiter:Ce,__classPrivateFieldGet:Np,__classPrivateFieldIn:Op,__classPrivateFieldSet:Rp,__createBinding:ql,__decorate:dp,__disposeResources:Up,__esDecorate:hp,__exportStar:bp,__extends:up,__generator:vp,__importDefault:Ap,__importStar:Tp,__makeTemplateObject:Cp,__metadata:yp,__param:fp,__propKey:pp,__read:Ru,__rest:nr,__rewriteRelativeImportExtension:zp,__runInitializers:gp,__setFunctionName:mp,__spread:_p,__spreadArray:jp,__spreadArrays:xp,__values:Dl,default:wv},Symbol.toStringTag,{value:"Module"})),Cv=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Ou extends Error{constructor(a,r="FunctionsError",l){super(a),this.name=r,this.context=l}}class Tv extends Ou{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Og extends Ou{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class kg extends Ou{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var yu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(yu||(yu={}));class Av{constructor(a,{headers:r={},customFetch:l,region:u=yu.Any}={}){this.url=a,this.headers=r,this.region=u,this.fetch=Cv(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return Ce(this,arguments,void 0,function*(r,l={}){var u;let d,h;try{const{headers:g,method:p,body:m,signal:v,timeout:_}=l;let x={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${r}`);b&&b!=="any"&&(x["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let A;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",A=m):typeof m=="string"?(x["Content-Type"]="text/plain",A=m):typeof FormData<"u"&&m instanceof FormData?A=m:(x["Content-Type"]="application/json",A=JSON.stringify(m)):A=m;let R=v;_&&(h=new AbortController,d=setTimeout(()=>h.abort(),_),v?(R=h.signal,v.addEventListener("abort",()=>h.abort())):R=h.signal);const T=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),g),body:A,signal:R}).catch(E=>{throw new Tv(E)}),I=T.headers.get("x-relay-error");if(I&&I==="true")throw new Og(T);if(!T.ok)throw new kg(T);let B=((u=T.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),K;return B==="application/json"?K=yield T.json():B==="application/octet-stream"||B==="application/pdf"?K=yield T.blob():B==="text/event-stream"?K=T:B==="multipart/form-data"?K=yield T.formData():K=yield T.text(),{data:K,error:null,response:T}}catch(g){return{data:null,error:g,response:g instanceof kg||g instanceof Og?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Pt={};const ar=fv(Ev);var El={},Cl={},Tl={},Al={},Nl={},Rl={},Ug;function Dp(){if(Ug)return Rl;Ug=1,Object.defineProperty(Rl,"__esModule",{value:!0});class o extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Rl.default=o,Rl}var zg;function Lp(){if(zg)return Nl;zg=1,Object.defineProperty(Nl,"__esModule",{value:!0});const a=ar.__importDefault(Dp());class r{constructor(u){var d,h;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(h=u.isMaybeSingle)!==null&&h!==void 0?h:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,_,x;let b=null,w=null,A=null,R=p.status,T=p.statusText;if(p.ok){if(this.method!=="HEAD"){const E=await p.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=E:w=JSON.parse(E))}const B=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),K=(_=p.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");B&&K&&K.length>1&&(A=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,A=null,R=406,T="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const B=await p.text();try{b=JSON.parse(B),Array.isArray(b)&&p.status===404&&(w=[],b=null,R=200,T="OK")}catch{p.status===404&&B===""?(R=204,T="No Content"):b={message:B}}if(b&&this.isMaybeSingle&&(!((x=b?.details)===null||x===void 0)&&x.includes("0 rows"))&&(b=null,R=200,T="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:A,status:R,statusText:T}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,_;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=p?.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Nl.default=r,Nl}var Dg;function Bp(){if(Dg)return Al;Dg=1,Object.defineProperty(Al,"__esModule",{value:!0});const a=ar.__importDefault(Lp());class r extends a.default{select(u){let d=!1;const h=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",h),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:h,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:h=d}={}){const g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:h,referencedTable:g=h}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:h=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const _=[u?"analyze":null,d?"verbose":null,h?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),x=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${x}"; options=${_};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return Al.default=r,Al}var Lg;function ku(){if(Lg)return Tl;Lg=1,Object.defineProperty(Tl,"__esModule",{value:!0});const a=ar.__importDefault(Bp()),r=new RegExp("[,()]");class l extends a.default{eq(d,h){return this.url.searchParams.append(d,`eq.${h}`),this}neq(d,h){return this.url.searchParams.append(d,`neq.${h}`),this}gt(d,h){return this.url.searchParams.append(d,`gt.${h}`),this}gte(d,h){return this.url.searchParams.append(d,`gte.${h}`),this}lt(d,h){return this.url.searchParams.append(d,`lt.${h}`),this}lte(d,h){return this.url.searchParams.append(d,`lte.${h}`),this}like(d,h){return this.url.searchParams.append(d,`like.${h}`),this}likeAllOf(d,h){return this.url.searchParams.append(d,`like(all).{${h.join(",")}}`),this}likeAnyOf(d,h){return this.url.searchParams.append(d,`like(any).{${h.join(",")}}`),this}ilike(d,h){return this.url.searchParams.append(d,`ilike.${h}`),this}ilikeAllOf(d,h){return this.url.searchParams.append(d,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(d,h){return this.url.searchParams.append(d,`ilike(any).{${h.join(",")}}`),this}is(d,h){return this.url.searchParams.append(d,`is.${h}`),this}in(d,h){const g=Array.from(new Set(h)).map(p=>typeof p=="string"&&r.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cs.{${h.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(h)}`),this}containedBy(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cd.{${h.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(h)}`),this}rangeGt(d,h){return this.url.searchParams.append(d,`sr.${h}`),this}rangeGte(d,h){return this.url.searchParams.append(d,`nxl.${h}`),this}rangeLt(d,h){return this.url.searchParams.append(d,`sl.${h}`),this}rangeLte(d,h){return this.url.searchParams.append(d,`nxr.${h}`),this}rangeAdjacent(d,h){return this.url.searchParams.append(d,`adj.${h}`),this}overlaps(d,h){return typeof h=="string"?this.url.searchParams.append(d,`ov.${h}`):this.url.searchParams.append(d,`ov.{${h.join(",")}}`),this}textSearch(d,h,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${h}`),this}match(d){return Object.entries(d).forEach(([h,g])=>{this.url.searchParams.append(h,`eq.${g}`)}),this}not(d,h,g){return this.url.searchParams.append(d,`not.${h}.${g}`),this}or(d,{foreignTable:h,referencedTable:g=h}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,h,g){return this.url.searchParams.append(d,`${h}.${g}`),this}}return Tl.default=l,Tl}var Bg;function Mp(){if(Bg)return Cl;Bg=1,Object.defineProperty(Cl,"__esModule",{value:!0});const a=ar.__importDefault(ku());class r{constructor(u,{headers:d={},schema:h,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=h,this.fetch=g}select(u,d){const{head:h=!1,count:g}=d??{},p=h?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(_=>/\s/.test(_)&&!m?"":(_==='"'&&(m=!m),_)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:h=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,_)=>v.concat(Object.keys(_)),[]);if(m.length>0){const v=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:h=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${h?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const _=u.reduce((x,b)=>x.concat(Object.keys(b)),[]);if(_.length>0){const x=[...new Set(_)].map(b=>`"${b}"`);this.url.searchParams.set("columns",x.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var h;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}delete({count:u}={}){var d;const h="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Cl.default=r,Cl}var Mg;function Nv(){if(Mg)return El;Mg=1,Object.defineProperty(El,"__esModule",{value:!0});const o=ar,a=o.__importDefault(Mp()),r=o.__importDefault(ku());class l{constructor(d,{headers:h={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(h),this.schemaName=g,this.fetch=p}from(d){const h=new URL(`${this.url}/${d}`);return new a.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,h={},{head:g=!1,get:p=!1,count:m}={}){var v;let _;const x=new URL(`${this.url}/rpc/${d}`);let b;g||p?(_=g?"HEAD":"GET",Object.entries(h).filter(([A,R])=>R!==void 0).map(([A,R])=>[A,Array.isArray(R)?`{${R.join(",")}}`:`${R}`]).forEach(([A,R])=>{x.searchParams.append(A,R)})):(_="POST",b=h);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new r.default({method:_,url:x,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return El.default=l,El}var qg;function Rv(){if(qg)return Pt;qg=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.PostgrestError=Pt.PostgrestBuilder=Pt.PostgrestTransformBuilder=Pt.PostgrestFilterBuilder=Pt.PostgrestQueryBuilder=Pt.PostgrestClient=void 0;const o=ar,a=o.__importDefault(Nv());Pt.PostgrestClient=a.default;const r=o.__importDefault(Mp());Pt.PostgrestQueryBuilder=r.default;const l=o.__importDefault(ku());Pt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Bp());Pt.PostgrestTransformBuilder=u.default;const d=o.__importDefault(Lp());Pt.PostgrestBuilder=d.default;const h=o.__importDefault(Dp());return Pt.PostgrestError=h.default,Pt.default={PostgrestClient:a.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:h.default},Pt}var qp=Rv();const Ip=op(qp),Ov=dv({__proto__:null,default:Ip},[qp]),{PostgrestClient:kv,PostgrestQueryBuilder:hx,PostgrestFilterBuilder:gx,PostgrestTransformBuilder:px,PostgrestBuilder:mx,PostgrestError:yx}=Ip||Ov;class Uv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const l=r.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let r=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(r+=`

Suggested solution: ${a.workaround}`),new Error(r)}static createWebSocket(a,r){const l=this.getWebSocketConstructor();return new l(a,r)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const zv="2.81.1",Dv=`realtime-js/${zv}`,Hp="1.0.0",Lv="2.0.0",Ig=Hp,vu=1e4,Bv=1e3,Mv=100;var ii;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(ii||(ii={}));var Ut;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Ut||(Ut={}));var En;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(En||(En={}));var bu;(function(o){o.websocket="websocket"})(bu||(bu={}));var ri;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(ri||(ri={}));class qv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,r){if(this._isArrayBuffer(a.payload))return r(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return r(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:r,ref:l,event:u,topic:d,payload:h}=a,g=this.META_LENGTH+r.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,r.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(r,x=>m.setUint8(v++,x.charCodeAt(0))),Array.from(l,x=>m.setUint8(v++,x.charCodeAt(0))),Array.from(d,x=>m.setUint8(v++,x.charCodeAt(0))),Array.from(u,x=>m.setUint8(v++,x.charCodeAt(0)));var _=new Uint8Array(p.byteLength+h.byteLength);return _.set(new Uint8Array(p),0),_.set(new Uint8Array(h),p.byteLength),_.buffer}_binaryEncodeUserBroadcastPush(a){var r;return this._isArrayBuffer((r=a.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var r,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(r=a.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let _=new DataView(v),x=0;_.setUint8(x++,this.KINDS.userBroadcastPush),_.setUint8(x++,u.length),_.setUint8(x++,d.length),_.setUint8(x++,h.length),_.setUint8(x++,g.length),_.setUint8(x++,this.BINARY_ENCODING),Array.from(u,w=>_.setUint8(x++,w.charCodeAt(0))),Array.from(d,w=>_.setUint8(x++,w.charCodeAt(0))),Array.from(h,w=>_.setUint8(x++,w.charCodeAt(0))),Array.from(g,w=>_.setUint8(x++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var r,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(r=a.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,_=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,x=new ArrayBuffer(this.HEADER_LENGTH+_);let b=new DataView(x),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,h.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,R=>b.setUint8(w++,R.charCodeAt(0))),Array.from(d,R=>b.setUint8(w++,R.charCodeAt(0))),Array.from(h,R=>b.setUint8(w++,R.charCodeAt(0))),Array.from(g,R=>b.setUint8(w++,R.charCodeAt(0)));var A=new Uint8Array(x.byteLength+v.byteLength);return A.set(new Uint8Array(x),0),A.set(new Uint8Array(v),x.byteLength),A.buffer}decode(a,r){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return r(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,h,g,p]=l;return r({join_ref:u,ref:d,topic:h,event:g,payload:p})}return r({})}_binaryDecode(a){const r=new DataView(a),l=r.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,r,u);case this.KINDS.reply:return this._decodeReply(a,r,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,r,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,r,u)}}_decodePush(a,r,l){const u=r.getUint8(1),d=r.getUint8(2),h=r.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+h));g=g+h;const _=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:_}}_decodeReply(a,r,l){const u=r.getUint8(1),d=r.getUint8(2),h=r.getUint8(3),g=r.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+h));p=p+h;const x=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:x,response:b};return{join_ref:m,ref:v,topic:_,event:En.reply,payload:w}}_decodeBroadcast(a,r,l){const u=r.getUint8(1),d=r.getUint8(2);let h=this.HEADER_LENGTH+2;const g=l.decode(a.slice(h,h+u));h=h+u;const p=l.decode(a.slice(h,h+d));h=h+d;const m=JSON.parse(l.decode(a.slice(h,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,r,l){const u=r.getUint8(1),d=r.getUint8(2),h=r.getUint8(3),g=r.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+h));p=p+h;const x=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(x)):x,w={type:this.BROADCAST,event:v,payload:b};return h>0&&(w.meta=JSON.parse(_)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var r;return a instanceof ArrayBuffer||((r=a?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class $p{constructor(a,r){this.callback=a,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ct;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(ct||(ct={}));const Hg=(o,a,r={})=>{var l;const u=(l=r.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,h)=>(d[h]=Iv(h,o,a,u),d),{}):{}},Iv=(o,a,r,l)=>{const u=a.find(g=>g.name===o),d=u?.type,h=r[o];return d&&!l.includes(d)?Vp(d,h):_u(h)},Vp=(o,a)=>{if(o.charAt(0)==="_"){const r=o.slice(1,o.length);return Pv(a,r)}switch(o){case ct.bool:return Hv(a);case ct.float4:case ct.float8:case ct.int2:case ct.int4:case ct.int8:case ct.numeric:case ct.oid:return $v(a);case ct.json:case ct.jsonb:return Vv(a);case ct.timestamp:return Gv(a);case ct.abstime:case ct.date:case ct.daterange:case ct.int4range:case ct.int8range:case ct.money:case ct.reltime:case ct.text:case ct.time:case ct.timestamptz:case ct.timetz:case ct.tsrange:case ct.tstzrange:return _u(a);default:return _u(a)}},_u=o=>o,Hv=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},$v=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Vv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},Pv=(o,a)=>{if(typeof o!="string")return o;const r=o.length-1,l=o[r];if(o[0]==="{"&&l==="}"){let d;const h=o.slice(1,r);try{d=JSON.parse("["+h+"]")}catch{d=h?h.split(","):[]}return d.map(g=>Vp(a,g))}return o},Gv=o=>typeof o=="string"?o.replace(" ","T"):o,Pp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class su{constructor(a,r,l={},u=vu){this.channel=a,this.event=r,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,r){var l;return this._hasReceived(a)&&r((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:r}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(r))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var $g;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})($g||($g={}));class as{constructor(a,r){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=as.syncState(this.state,u,d,h),this.pendingDiffs.forEach(p=>{this.state=as.syncDiff(this.state,p,d,h)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=as.syncDiff(this.state,u,d,h),g())}),this.onJoin((u,d,h)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:h})}),this.onLeave((u,d,h)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,r,l,u){const d=this.cloneDeep(a),h=this.transformState(r),g={},p={};return this.map(d,(m,v)=>{h[m]||(p[m]=v)}),this.map(h,(m,v)=>{const _=d[m];if(_){const x=v.map(R=>R.presence_ref),b=_.map(R=>R.presence_ref),w=v.filter(R=>b.indexOf(R.presence_ref)<0),A=_.filter(R=>x.indexOf(R.presence_ref)<0);w.length>0&&(g[m]=w),A.length>0&&(p[m]=A)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,r,l,u){const{joins:d,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const _=a[g].map(b=>b.presence_ref),x=v.filter(b=>_.indexOf(b.presence_ref)<0);a[g].unshift(...x)}l(g,v,p)}),this.map(h,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(_=>_.presence_ref);m=m.filter(_=>v.indexOf(_.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,r){return Object.getOwnPropertyNames(a).map(l=>r(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((r,l)=>{const u=a[l];return"metas"in u?r[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):r[l]=u,r},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Vg;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Vg||(Vg={}));var is;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(is||(is={}));var ia;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(ia||(ia={}));class Uu{constructor(a,r={config:{}},l){var u,d;if(this.topic=a,this.params=r,this.socket=l,this.bindings={},this.state=Ut.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new su(this,En.join,this.params,this.timeout),this.rejoinTimer=new $p(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ut.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ut.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this._on(En.reply,{},(h,g)=>{this._trigger(this._replyEventName(g),h)}),this.presence=new as(this),this.broadcastEndpointURL=Pp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,r=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Ut.closed){const{config:{broadcast:h,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[is.PRESENCE]&&this.bindings[is.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,_={},x={broadcast:h,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(ia.CHANNEL_ERROR,b)),this._onClose(()=>a?.(ia.CLOSED)),this.updateJoinPayload(Object.assign({config:x},_)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(ia.SUBSCRIBED);return}else{const A=this.bindings.postgres_changes,R=(w=A?.length)!==null&&w!==void 0?w:0,T=[];for(let I=0;I<R;I++){const B=A[I],{filter:{event:K,schema:E,table:M,filter:L}}=B,V=b&&b[I];if(V&&V.event===K&&V.schema===E&&V.table===M&&V.filter===L)T.push(Object.assign(Object.assign({},B),{id:V.id}));else{this.unsubscribe(),this.state=Ut.errored,a?.(ia.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,a&&a(ia.SUBSCRIBED);return}}).receive("error",b=>{this.state=Ut.errored,a?.(ia.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(ia.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,r={}){return await this.send({type:"presence",event:"track",payload:a},r.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,r,l){return this.state===Ut.joined&&a===is.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,r,l)}async httpSend(a,r,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const h={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:r,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,r={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:h}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:h,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=r.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var h,g,p;const m=this._push(a.type,a,r.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(h=this.params)===null||h===void 0?void 0:h.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=Ut.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(En.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new su(this,En.leave,{},a),l.receive("ok",()=>{r(),u("ok")}).receive("timeout",()=>{r(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ut.closed,this.bindings={}}async _fetchWithTimeout(a,r,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),h=await this.socket.fetch(a,Object.assign(Object.assign({},r),{signal:u.signal}));return clearTimeout(d),h}_push(a,r,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new su(this,a,r,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Mv){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(a,r,l){return r}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,r,l){var u,d;const h=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=En;if(l&&[g,p,m,v].indexOf(h)>=0&&l!==this._joinRef())return;let x=this._onMessage(h,r,l);if(r&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,A,R;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((R=(A=b.filter)===null||A===void 0?void 0:A.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===h}).map(b=>b.callback(x,l)):(d=this.bindings[h])===null||d===void 0||d.filter(b=>{var w,A,R,T,I,B;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in b){const K=b.id,E=(w=b.filter)===null||w===void 0?void 0:w.event;return K&&((A=r.ids)===null||A===void 0?void 0:A.includes(K))&&(E==="*"||E?.toLocaleLowerCase()===((R=r.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))}else{const K=(I=(T=b?.filter)===null||T===void 0?void 0:T.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return K==="*"||K===((B=r?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===h}).map(b=>{if(typeof x=="object"&&"ids"in x){const w=x.data,{schema:A,table:R,commit_timestamp:T,type:I,errors:B}=w;x=Object.assign(Object.assign({},{schema:A,table:R,commit_timestamp:T,eventType:I,new:{},old:{},errors:B}),this._getPayloadRecords(w))}b.callback(x,l)})}_isClosed(){return this.state===Ut.closed}_isJoined(){return this.state===Ut.joined}_isJoining(){return this.state===Ut.joining}_isLeaving(){return this.state===Ut.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,r,l){const u=a.toLocaleLowerCase(),d={type:u,filter:r,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,r){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Uu.isEqual(u.filter,r))})),this}static isEqual(a,r){if(Object.keys(a).length!==Object.keys(r).length)return!1;for(const l in a)if(a[l]!==r[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(En.close,{},a)}_onError(a){this._on(En.error,{},r=>a(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ut.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const r={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(r.new=Hg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(r.old=Hg(a.columns,a.old_record)),r}}const lu=()=>{},Ol={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Kv=[1e3,2e3,5e3,1e4],Yv=1e4,Fv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jv{constructor(a,r){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=vu,this.transport=null,this.heartbeatIntervalMs=Ol.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=lu,this.ref=0,this.reconnectTimer=null,this.vsn=Ig,this.logger=lu,this.conn=null,this.sendBuffer=[],this.serializer=new qv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=r?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${a}/${bu.websocket}`,this.httpEndpoint=Pp(a),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Uv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const r=a.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const r=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const a=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,r,l){this.logger(a,r,l)}connectionState(){switch(this.conn&&this.conn.readyState){case ii.connecting:return ri.Connecting;case ii.open:return ri.Open;case ii.closing:return ri.Closing;default:return ri.Closed}}isConnected(){return this.connectionState()===ri.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,r={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Uu(`realtime:${a}`,r,this);return this.channels.push(d),d}}push(a){const{topic:r,event:l,payload:u,ref:d}=a,h=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${r} ${l} (${d})`,u),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Bv,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Ol.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let r=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${a}"`),r.unsubscribe())}_remove(a){this.channels=this.channels.filter(r=>r.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:h}=r,g=h?`(${h})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,h)),this._triggerStateCallbacks("message",r)})}_clearTimer(a){var r;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ii.open||this.conn.readyState===ii.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var r;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(En.error))}_appendParams(a,r){if(Object.keys(r).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(r);return`${a}${l}${u}`}_workerObjectUrl(a){let r;if(a)r=a;else{const l=new Blob([Fv],{type:"application/javascript"});r=URL.createObjectURL(l)}return r}_setConnectionState(a,r=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(a=null){let r;a?r=a:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(l=>{const u={access_token:r,version:Dv};r&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(En.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${a}`,r)})}_triggerStateCallbacks(a,r){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(r)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new $p(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ol.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var r,l,u,d,h,g,p,m,v,_,x,b;switch(this.transport=(r=a?.transport)!==null&&r!==void 0?r:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:vu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Ol.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(h=a?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:lu,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Ig,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Kv[w-1]||Yv),this.vsn){case Hp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,A)=>A(JSON.stringify(w))),this.decode=(_=a?.decode)!==null&&_!==void 0?_:((w,A)=>A(JSON.parse(w)));break;case Lv:this.encode=(x=a?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class zu extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function vt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Qv extends zu{constructor(a,r,l){super(a),this.name="StorageApiError",this.status=r,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xu extends zu{constructor(a,r){super(a),this.name="StorageUnknownError",this.originalError=r}}const Du=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Xv=()=>Response,ju=o=>{if(Array.isArray(o))return o.map(r=>ju(r));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([r,l])=>{const u=r.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=ju(l)}),a},Zv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},ou=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},Wv=(o,a,r)=>Ce(void 0,void 0,void 0,function*(){const l=yield Xv();o instanceof l&&!r?.noResolveJson?o.json().then(u=>{const d=o.status||500,h=u?.statusCode||d+"";a(new Qv(ou(u),d,h))}).catch(u=>{a(new xu(ou(u),u))}):a(new xu(ou(o),o))}),eb=(o,a,r,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Zv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),r))};function os(o,a,r,l,u,d){return Ce(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(r,eb(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>Wv(p,g,l))})})}function rs(o,a,r,l){return Ce(this,void 0,void 0,function*(){return os(o,"GET",a,r,l)})}function Un(o,a,r,l,u){return Ce(this,void 0,void 0,function*(){return os(o,"POST",a,l,u,r)})}function Su(o,a,r,l,u){return Ce(this,void 0,void 0,function*(){return os(o,"PUT",a,l,u,r)})}function tb(o,a,r,l){return Ce(this,void 0,void 0,function*(){return os(o,"HEAD",a,Object.assign(Object.assign({},r),{noResolveJson:!0}),l)})}function Lu(o,a,r,l,u){return Ce(this,void 0,void 0,function*(){return os(o,"DELETE",a,l,u,r)})}class nb{constructor(a,r){this.downloadFn=a,this.shouldThrowOnError=r}then(a,r){return this.execute().then(a,r)}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(vt(a))return{data:null,error:a};throw a}})}}var Gp;class ab{constructor(a,r){this.downloadFn=a,this.shouldThrowOnError=r,this[Gp]="BlobDownloadBuilder",this.promise=null}asStream(){return new nb(this.downloadFn,this.shouldThrowOnError)}then(a,r){return this.getPromise().then(a,r)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ce(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(vt(a))return{data:null,error:a};throw a}})}}Gp=Symbol.toStringTag;const ib={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rb{constructor(a,r={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=r,this.bucketId=l,this.fetch=Du(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,r,l,u){return Ce(this,void 0,void 0,function*(){try{let d;const h=Object.assign(Object.assign({},Pg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",h.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!h.duplex&&(h.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(r),v=this._getFinalPath(m),_=yield(a=="PUT"?Su:Un)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:m,id:_.Id,fullPath:_.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(vt(d))return{data:null,error:d};throw d}})}upload(a,r,l){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,r,l)})}uploadToSignedUrl(a,r,l,u){return Ce(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),h=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${h}`);g.searchParams.set("token",r);try{let p;const m=Object.assign({upsert:Pg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const _=yield Su(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:_.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(vt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,r){return Ce(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);r?.upsert&&(u["x-upsert"]="true");const d=yield Un(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),h=new URL(this.url+d.url),g=h.searchParams.get("token");if(!g)throw new zu("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}update(a,r,l){return Ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,r,l)})}move(a,r,l){return Ce(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:r,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}copy(a,r,l){return Ce(this,void 0,void 0,function*(){try{return{data:{path:(yield Un(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:r,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,r,l){return Ce(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield Un(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:r},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const h=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${h}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,r,l){return Ce(this,void 0,void 0,function*(){try{const u=yield Un(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}download(a,r){const u=typeof r?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(r?.transform||{}),h=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>rs(this.fetch,`${this.url}/${u}/${g}${h}`,{headers:this.headers,noResolveJson:!0});return new ab(p,this.shouldThrowOnError)}info(a){return Ce(this,void 0,void 0,function*(){const r=this._getFinalPath(a);try{const l=yield rs(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:ju(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}exists(a){return Ce(this,void 0,void 0,function*(){const r=this._getFinalPath(a);try{return yield tb(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l)&&l instanceof xu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,r){const l=this._getFinalPath(a),u=[],d=r?.download?`download=${r.download===!0?"":r.download}`:"";d!==""&&u.push(d);const g=typeof r?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(r?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield Lu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}list(a,r,l){return Ce(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},ib),r),{prefix:a||""});return{data:yield Un(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}listV2(a,r){return Ce(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield Un(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},r),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const r=[];return a.width&&r.push(`width=${a.width}`),a.height&&r.push(`height=${a.height}`),a.resize&&r.push(`resize=${a.resize}`),a.format&&r.push(`format=${a.format}`),a.quality&&r.push(`quality=${a.quality}`),r.join("&")}}const Kp="2.81.1",Yp={"X-Client-Info":`storage-js/${Kp}`};class sb{constructor(a,r={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),r),this.fetch=Du(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return Ce(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(a);return{data:yield rs(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}getBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield rs(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}createBucket(a){return Ce(this,arguments,void 0,function*(r,l={public:!1}){try{return{data:yield Un(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}updateBucket(a,r){return Ce(this,void 0,void 0,function*(){try{return{data:yield Su(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}deleteBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield Lu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(a){const r={};return a&&("limit"in a&&(r.limit=String(a.limit)),"offset"in a&&(r.offset=String(a.offset)),a.search&&(r.search=a.search),a.sortColumn&&(r.sortColumn=a.sortColumn),a.sortOrder&&(r.sortOrder=a.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class lb{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),r),this.fetch=Du(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}listBuckets(a){return Ce(this,void 0,void 0,function*(){try{const r=new URLSearchParams;a?.limit!==void 0&&r.set("limit",a.limit.toString()),a?.offset!==void 0&&r.set("offset",a.offset.toString()),a?.sortColumn&&r.set("sortColumn",a.sortColumn),a?.sortOrder&&r.set("sortOrder",a.sortOrder),a?.search&&r.set("search",a.search);const l=r.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield rs(this.fetch,u,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}deleteBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield Lu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}}const Bu={"X-Client-Info":`storage-js/${Kp}`,"Content-Type":"application/json"};class Fp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function hn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class cu extends Fp{constructor(a,r,l){super(a),this.name="StorageVectorsApiError",this.status=r,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ob extends Fp{constructor(a,r){super(a),this.name="StorageVectorsUnknownError",this.originalError=r}}var Gg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Gg||(Gg={}));const Mu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),cb=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Kg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),ub=(o,a,r)=>Ce(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!r?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(h=>{const g=h?.statusCode||h?.code||u+"";a(new cu(Kg(h),u,g))}).catch(()=>{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new cu(g,u,h))});else{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new cu(g,u,h))}}else a(new ob(Kg(o),o))}),db=(o,a,r,l)=>{const u={method:o,headers:a?.headers||{}};return l?(cb(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),r)):u};function fb(o,a,r,l,u,d){return Ce(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(r,db(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>h(p)).catch(p=>ub(p,g,l))})})}function gn(o,a,r,l,u){return Ce(this,void 0,void 0,function*(){return fb(o,"POST",a,l,u,r)})}class hb{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Bu),r),this.fetch=Mu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return Ce(this,void 0,void 0,function*(){try{return{data:(yield gn(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}getIndex(a,r){return Ce(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:r},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(hn(l))return{data:null,error:l};throw l}})}listIndexes(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}deleteIndex(a,r){return Ce(this,void 0,void 0,function*(){try{return{data:(yield gn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:r},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(hn(l))return{data:null,error:l};throw l}})}}class gb{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Bu),r),this.fetch=Mu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return Ce(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield gn(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}getVectors(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}listVectors(a){return Ce(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield gn(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}queryVectors(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}deleteVectors(a){return Ce(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield gn(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}}class pb{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Bu),r),this.fetch=Mu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:(yield gn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}getBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:yield gn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}listBuckets(){return Ce(this,arguments,void 0,function*(a={}){try{return{data:yield gn(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}deleteBucket(a){return Ce(this,void 0,void 0,function*(){try{return{data:(yield gn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}})}}class mb extends pb{constructor(a,r={}){super(a,r.headers||{},r.fetch)}from(a){return new yb(this.url,this.headers,a,this.fetch)}}class yb extends hb{constructor(a,r,l,u){super(a,r,u),this.vectorBucketName=l}createIndex(a){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ce(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ce(this,arguments,void 0,function*(r={}){return a.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ce(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ce(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new vb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class vb extends gb{constructor(a,r,l,u,d){super(a,r,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ce(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ce(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ce(this,arguments,void 0,function*(r={}){return a.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ce(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ce(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class bb extends sb{constructor(a,r={},l,u){super(a,r,l,u)}from(a){return new rb(this.url,this.headers,a,this.fetch)}get vectors(){return new mb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new lb(this.url+"/iceberg",this.headers,this.fetch)}}const _b="2.81.1";let ns="";typeof Deno<"u"?ns="deno":typeof document<"u"?ns="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ns="react-native":ns="node";const xb={"X-Client-Info":`supabase-js-${ns}/${_b}`},jb={headers:xb},Sb={schema:"public"},wb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Eb={},Cb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Tb=()=>Headers,Ab=(o,a,r)=>{const l=Cb(r),u=Tb();return async(d,h)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(h?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},h),{headers:m}))}};function Nb(o){return o.endsWith("/")?o:o+"/"}function Rb(o,a){var r,l;const{db:u,auth:d,realtime:h,global:g}=o,{db:p,auth:m,realtime:v,global:_}=a,x={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),h),storage:{},global:Object.assign(Object.assign(Object.assign({},_),g),{headers:Object.assign(Object.assign({},(r=_?.headers)!==null&&r!==void 0?r:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?x.accessToken=o.accessToken:delete x.accessToken,x}function Ob(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Nb(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Jp="2.81.1",Zi=30*1e3,wu=3,uu=wu*Zi,kb="http://localhost:9999",Ub="supabase.auth.token",zb={"X-Client-Info":`gotrue-js/${Jp}`},Eu="X-Supabase-Api-Version",Qp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Db=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Lb=600*1e3;class ss extends Error{constructor(a,r,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=l}}function Ae(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Bb extends ss{constructor(a,r,l){super(a,r,l),this.name="AuthApiError",this.status=r,this.code=l}}function Mb(o){return Ae(o)&&o.name==="AuthApiError"}class si extends ss{constructor(a,r){super(a),this.name="AuthUnknownError",this.originalError=r}}class ka extends ss{constructor(a,r,l,u){super(a,l,u),this.name=r,this.status=l}}class On extends ka{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function qb(o){return Ae(o)&&o.name==="AuthSessionMissingError"}class Yi extends ka{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class kl extends ka{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Ul extends ka{constructor(a,r=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ib(o){return Ae(o)&&o.name==="AuthImplicitGrantRedirectError"}class Yg extends ka{constructor(a,r=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Cu extends ka{constructor(a,r){super(a,"AuthRetryableFetchError",r,void 0)}}function du(o){return Ae(o)&&o.name==="AuthRetryableFetchError"}class Fg extends ka{constructor(a,r,l){super(a,"AuthWeakPasswordError",r,"weak_password"),this.reasons=l}}class Tu extends ka{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ll="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jg=` 	
\r=`.split(""),Hb=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Jg.length;a+=1)o[Jg[a].charCodeAt(0)]=-2;for(let a=0;a<Ll.length;a+=1)o[Ll[a].charCodeAt(0)]=a;return o})();function Qg(o,a,r){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;r(Ll[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;r(Ll[l]),a.queuedBits-=6}}function Xp(o,a,r){const l=Hb[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)r(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Xg(o){const a=[],r=h=>{a.push(String.fromCodePoint(h))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=h=>{Pb(h,l,r)};for(let h=0;h<o.length;h+=1)Xp(o.charCodeAt(h),u,d);return a.join("")}function $b(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Vb(o,a){for(let r=0;r<o.length;r+=1){let l=o.charCodeAt(r);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(r+1)-56320&65535|u)+65536,r+=1}$b(l,a)}}function Pb(o,a,r){if(a.utf8seq===0){if(o<=127){r(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&r(a.codepoint)}}function er(o){const a=[],r={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)Xp(o.charCodeAt(u),r,l);return new Uint8Array(a)}function Gb(o){const a=[];return Vb(o,r=>a.push(r)),new Uint8Array(a)}function li(o){const a=[],r={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Qg(u,r,l)),Qg(null,r,l),a.join("")}function Kb(o){return Math.round(Date.now()/1e3)+o}function Yb(){return Symbol("auth-callback")}const It=()=>typeof window<"u"&&typeof document<"u",ei={tested:!1,writable:!1},Zp=()=>{if(!It())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ei.tested)return ei.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ei.tested=!0,ei.writable=!0}catch{ei.tested=!0,ei.writable=!1}return ei.writable};function Fb(o){const a={},r=new URL(o);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return r.searchParams.forEach((l,u)=>{a[u]=l}),a}const Wp=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Jb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",Wi=async(o,a,r)=>{await o.setItem(a,JSON.stringify(r))},ti=async(o,a)=>{const r=await o.getItem(a);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ra=async(o,a)=>{await o.removeItem(a)};class Il{constructor(){this.promise=new Il.promiseConstructor((a,r)=>{this.resolve=a,this.reject=r})}}Il.promiseConstructor=Promise;function fu(o){const a=o.split(".");if(a.length!==3)throw new Tu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!Db.test(a[l]))throw new Tu("JWT not in base64url format");return{header:JSON.parse(Xg(a[0])),payload:JSON.parse(Xg(a[1])),signature:er(a[2]),raw:{header:a[0],payload:a[1]}}}async function Qb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Xb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const h=await o(d);if(!a(d,null,h)){l(h);return}}catch(h){if(!a(d,h)){u(h);return}}})()})}function Zb(o){return("0"+o.toString(16)).substr(-2)}function Wb(){const a=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=r.length;let u="";for(let d=0;d<56;d++)u+=r.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Zb).join("")}async function e0(o){const r=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",r),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function t0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const r=await e0(o);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fi(o,a,r=!1){const l=Wb();let u=l;r&&(u+="/PASSWORD_RECOVERY"),await Wi(o,`${a}-code-verifier`,u);const d=await t0(l);return[d,l===d?"plain":"s256"]}const n0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function a0(o){const a=o.headers.get(Eu);if(!a||!a.match(n0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function i0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function r0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const s0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ji(o){if(!s0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function hu(){const o={};return new Proxy(o,{get:(a,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function l0(o,a){return new Proxy(o,{get:(r,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(r,l,u)}})}function Zg(o){return JSON.parse(JSON.stringify(o))}const ai=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),o0=[502,503,504];async function Wg(o){var a;if(!Jb(o))throw new Cu(ai(o),0);if(o0.includes(o.status))throw new Cu(ai(o),o.status);let r;try{r=await o.json()}catch(d){throw new si(ai(d),d)}let l;const u=a0(o);if(u&&u.getTime()>=Qp["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?l=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(l=r.error_code),l){if(l==="weak_password")throw new Fg(ai(r),o.status,((a=r.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new On}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((d,h)=>d&&typeof h=="string",!0))throw new Fg(ai(r),o.status,r.weak_password.reasons);throw new Bb(ai(r),o.status||500,l)}const c0=(o,a,r,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),r))};async function ze(o,a,r,l){var u;const d=Object.assign({},l?.headers);d[Eu]||(d[Eu]=Qp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const h=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(h.redirect_to=l.redirectTo);const g=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await u0(o,a,r+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function u0(o,a,r,l,u,d){const h=c0(a,l,u,d);let g;try{g=await o(r,Object.assign({},h))}catch(p){throw console.error(p),new Cu(ai(p),0)}if(g.ok||await Wg(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await Wg(p)}}function kn(o){var a;let r=null;h0(o)&&(r=Object.assign({},o),o.expires_at||(r.expires_at=Kb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:r,user:l},error:null}}function ep(o){const a=kn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((r,l)=>r&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Oa(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function d0(o){return{data:o,error:null}}function f0(o){const{action_link:a,email_otp:r,hashed_token:l,redirect_to:u,verification_type:d}=o,h=nr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:r,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},h);return{data:{properties:g,user:p},error:null}}function tp(o){return o}function h0(o){return o.access_token&&o.refresh_token&&o.expires_in}const gu=["global","local","others"];class g0{constructor({url:a="",headers:r={},fetch:l}){this.url=a,this.headers=r,this.fetch=Wp(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,r=gu[0]){if(gu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${gu.join(", ")}`);try{return await ze(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Ae(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,r={}){try{return await ze(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Oa})}catch(l){if(Ae(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:r}=a,l=nr(a,["options"]),u=Object.assign(Object.assign({},l),r);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await ze(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:f0,redirectTo:r?.redirectTo})}catch(r){if(Ae(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(a){try{return await ze(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Oa})}catch(r){if(Ae(r))return{data:{user:null},error:r};throw r}}async listUsers(a){var r,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await ze(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=a?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const _=await v.json(),x=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const A=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(w.split(";")[1].split("=")[1]);m[`${R}Page`]=A}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Ae(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){Ji(a);try{return await ze(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Oa})}catch(r){if(Ae(r))return{data:{user:null},error:r};throw r}}async updateUserById(a,r){Ji(a);try{return await ze(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:r,headers:this.headers,xform:Oa})}catch(l){if(Ae(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,r=!1){Ji(a);try{return await ze(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:r},xform:Oa})}catch(l){if(Ae(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){Ji(a.userId);try{const{data:r,error:l}=await ze(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:r,error:l}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _deleteFactor(a){Ji(a.userId),Ji(a.id);try{return{data:await ze(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _listOAuthClients(a){var r,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=a?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const _=await v.json(),x=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const A=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(w.split(";")[1].split("=")[1]);m[`${R}Page`]=A}),m.total=parseInt(x)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Ae(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _getOAuthClient(a){try{return await ze(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _updateOAuthClient(a,r){try{return await ze(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:r,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Ae(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await ze(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ae(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(a){try{return await ze(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ae(r))return{data:null,error:r};throw r}}}function np(o={}){return{getItem:a=>o[a]||null,setItem:(a,r)=>{o[a]=r},removeItem:a=>{delete o[a]}}}const Qi={debug:!!(globalThis&&Zp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class em extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class p0 extends em{}async function m0(o,a,r){Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await r()}finally{Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw Qi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new p0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Qi.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function y0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tm(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function v0(o){return parseInt(o,16)}function b0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function _0(o){var a;const{chainId:r,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:h,notBefore:g,requestId:p,resources:m,scheme:v,uri:_,version:x}=o;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!_)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=tm(o.address),w=v?`${v}://${l}`:l,A=o.statement?`${o.statement}
`:"",R=`${w} wants you to sign in with your Ethereum account:
${b}

${A}`;let T=`URI: ${_}
Version: ${x}
Chain ID: ${r}${h?`
Nonce: ${h}`:""}
Issued At: ${d.toISOString()}`;if(u&&(T+=`
Expiration Time: ${u.toISOString()}`),g&&(T+=`
Not Before: ${g.toISOString()}`),p&&(T+=`
Request ID: ${p}`),m){let I=`
Resources:`;for(const B of m){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);I+=`
- ${B}`}T+=I}return`${R}
${T}`}class Ot extends Error{constructor({message:a,code:r,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=r}}class Bl extends Ot{constructor(a,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:a}),this.name="WebAuthnUnknownError",this.originalError=r}}function x0({error:o,options:a}){var r,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Ot({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((r=d.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ot({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Ot({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new Ot({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Ot({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Ot({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Ot({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Ot({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const h=window.location.hostname;if(nm(h)){if(d.rp.id!==h)return new Ot({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ot({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Ot({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Ot({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ot({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function j0({error:o,options:a}){const{publicKey:r}=a;if(!r)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Ot({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Ot({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(nm(l)){if(r.rpId!==l)return new Ot({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ot({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Ot({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ot({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class S0{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const w0=new S0;function E0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:r,excludeCredentials:l}=o,u=nr(o,["challenge","user","excludeCredentials"]),d=er(a).buffer,h=Object.assign(Object.assign({},r),{id:er(r.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:h});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:er(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function C0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:r}=o,l=nr(o,["challenge","allowCredentials"]),u=er(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(r&&r.length>0){d.allowCredentials=new Array(r.length);for(let h=0;h<r.length;h++){const g=r[h];d.allowCredentials[h]=Object.assign(Object.assign({},g),{id:er(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function T0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const r=o;return{id:o.id,rawId:o.id,response:{attestationObject:li(new Uint8Array(o.response.attestationObject)),clientDataJSON:li(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=r.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function A0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const r=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:li(new Uint8Array(u.authenticatorData)),clientDataJSON:li(new Uint8Array(u.clientDataJSON)),signature:li(new Uint8Array(u.signature)),userHandle:u.userHandle?li(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=r.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function nm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function ap(){var o,a;return!!(It()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function N0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Bl("Browser returned unexpected credential type",a)}:{data:null,error:new Bl("Empty credential response",a)}}catch(a){return{data:null,error:x0({error:a,options:o})}}}async function R0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Bl("Browser returned unexpected credential type",a)}:{data:null,error:new Bl("Empty credential response",a)}}catch(a){return{data:null,error:j0({error:a,options:o})}}}const O0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},k0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ml(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),r=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const h=u[d];if(h!==void 0)if(Array.isArray(h))l[d]=h;else if(r(h))l[d]=h;else if(a(h)){const g=l[d];a(g)?l[d]=Ml(g,h):l[d]=Ml(h)}else l[d]=h}return l}function U0(o,a){return Ml(O0,o,a||{})}function z0(o,a){return Ml(k0,o,a||{})}class D0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:r,friendlyName:l,signal:u},d){try{const{data:h,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:r});if(!h)return{data:null,error:g};const p=u??w0.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=U0(h.webauthn.credential_options.publicKey,d?.create),{data:v,error:_}=await N0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}case"request":{const m=z0(h.webauthn.credential_options.publicKey,d?.request),{data:v,error:_}=await R0(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}}}catch(h){return Ae(h)?{data:null,error:h}:{data:null,error:new si("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:r,webauthn:l}){return this.client.mfa.verify({factorId:r,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!r)return{data:null,error:new ss("rpId is required for WebAuthn authentication")};try{if(!ap())return{data:null,error:new si("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this.challenge({factorId:a,webauthn:{rpId:r,rpOrigins:l},signal:u},{request:d});if(!h)return{data:null,error:g};const{webauthn:p}=h;return this._verify({factorId:a,challengeId:h.challengeId,webauthn:{type:p.type,rpId:r,rpOrigins:l,credential_response:p.credential_response}})}catch(h){return Ae(h)?{data:null,error:h}:{data:null,error:new si("Unexpected error in authenticate",h)}}}async _register({friendlyName:a,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!r)return{data:null,error:new ss("rpId is required for WebAuthn registration")};try{if(!ap())return{data:null,error:new si("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this._enroll({friendlyName:a});if(!h)return await this.client.mfa.listFactors().then(v=>{var _;return(_=v.data)===null||_===void 0?void 0:_.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===a&&x.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:r,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:h.id,challengeId:p.challengeId,webauthn:{rpId:r,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(h){return Ae(h)?{data:null,error:h}:{data:null,error:new si("Unexpected error in register",h)}}}}y0();const L0={url:kb,storageKey:Ub,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ip(o,a,r){return await r()}const Xi={};class ls{get jwks(){var a,r;return(r=(a=Xi[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(a){Xi[this.storageKey]=Object.assign(Object.assign({},Xi[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,r;return(r=(a=Xi[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){Xi[this.storageKey]=Object.assign(Object.assign({},Xi[this.storageKey]),{cachedAt:a})}constructor(a){var r,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},L0),a);if(this.storageKey=d.storageKey,this.instanceID=(r=ls.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ls.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&It()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new g0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Wp(d.fetch),this.lock=d.lock||ip,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:It()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=m0:this.lock=ip,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new D0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:Zp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=np(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=np(this.memoryStorage)),It()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Jp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let r={},l="none";if(It()&&(r=Fb(window.location.href),this._isImplicitGrantCallback(r)?l="implicit":await this._isPKCECallback(r)&&(l="pkce")),It()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(r,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Ib(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:h,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",h,"redirect type",g),await this._saveSession(h),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ae(r)?this._returnResult({error:r}):this._returnResult({error:new si("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var r,l,u;try{const d=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(r=a?.options)===null||r===void 0?void 0:r.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:kn}),{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ae(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var r,l,u;try{let d;if("email"in a){const{email:v,password:_,options:x}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await Fi(this.storage,this.storageKey)),d=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:v,password:_,data:(r=x?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:b,code_challenge_method:w},xform:kn})}else if("phone"in a){const{phone:v,password:_,options:x}=a;d=await ze(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:_,data:(l=x?.data)!==null&&l!==void 0?l:{},channel:(u=x?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:kn})}else throw new kl("You must provide either an email or phone number and a password");const{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ae(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let r;if("email"in a){const{email:d,password:h,options:g}=a;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else if("phone"in a){const{phone:d,password:h,options:g}=a;r=await ze(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else throw new kl("You must provide either an email or phone number and a password");const{data:l,error:u}=r;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Yi;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(a){var r,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(r=a.options)===null||r===void 0?void 0:r.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:r}=a;switch(r){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(a){var r,l,u,d,h,g,p,m,v,_,x;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:A,wallet:R,statement:T,options:I}=a;let B;if(It())if(typeof R=="object")B=R;else{const ye=window;if("ethereum"in ye&&typeof ye.ethereum=="object"&&"request"in ye.ethereum&&typeof ye.ethereum.request=="function")B=ye.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=R}const K=new URL((r=I?.url)!==null&&r!==void 0?r:window.location.href),E=await B.request({method:"eth_requestAccounts"}).then(ye=>ye).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const M=tm(E[0]);let L=(l=I?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!L){const ye=await B.request({method:"eth_chainId"});L=v0(ye)}const V={domain:K.host,address:M,statement:T,uri:K.href,version:"1",chainId:L,nonce:(u=I?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(h=(d=I?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(g=I?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=I?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=I?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=I?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=_0(V),w=await B.request({method:"personal_sign",params:[b0(b),M]})}try{const{data:A,error:R}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(x=a.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:kn});if(R)throw R;if(!A||!A.session||!A.user){const T=new Yi;return this._returnResult({data:{user:null,session:null},error:T})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:R})}catch(A){if(Ae(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async signInWithSolana(a){var r,l,u,d,h,g,p,m,v,_,x,b;let w,A;if("message"in a)w=a.message,A=a.signature;else{const{chain:R,wallet:T,statement:I,options:B}=a;let K;if(It())if(typeof T=="object")K=T;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))K=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=T}const E=new URL((r=B?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in K&&K.signIn){const M=await K.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),I?{statement:I}:null));let L;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")L=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)L=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)w=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),A=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in K)||typeof K.signMessage!="function"||!("publicKey"in K)||typeof K!="object"||!K.publicKey||!("toBase58"in K.publicKey)||typeof K.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,K.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(u=(l=B?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=B?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((h=B?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((g=B?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((p=B?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((m=B?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((_=(v=B?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||_===void 0)&&_.length?["Resources",...B.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const M=await K.signMessage(new TextEncoder().encode(w),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=M}}try{const{data:R,error:T}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:li(A)},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:kn});if(T)throw T;if(!R||!R.session||!R.user){const I=new Yi;return this._returnResult({data:{user:null,session:null},error:I})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:T})}catch(R){if(Ae(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async _exchangeCodeForSession(a){const r=await ti(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(r??"").split("/");try{const{data:d,error:h}=await ze(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:kn});if(await Ra(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!d||!d.session||!d.user){const g=new Yi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:h})}catch(d){if(Ae(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:r,provider:l,token:u,access_token:d,nonce:h}=a,g=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:h,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:kn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new Yi;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(a){var r,l,u,d,h;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Fi(this.storage,this.storageKey));const{error:_}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(r=p?.data)!==null&&r!==void 0?r:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:_})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await ze(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(h=p?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new kl("You must provide either an email or phone number.")}catch(g){if(Ae(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var r,l;try{let u,d;"options"in a&&(u=(r=a.options)===null||r===void 0?void 0:r.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:h,error:g}=await ze(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:kn});if(g)throw g;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,m=h.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(Ae(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var r,l,u,d,h;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Fi(this.storage,this.storageKey));const m=await ze(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(r=a.options)===null||r===void 0?void 0:r.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:d0});return!((d=m.data)===null||d===void 0)&&d.url&&It()&&!(!((h=a.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(Ae(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:r},error:l}=a;if(l)throw l;if(!r)throw new On;const{error:u}=await ze(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(Ae(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const r=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:h}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:h,error:g}=await ze(this.fetch,"POST",r,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:g})}throw new kl("You must provide either an email or phone number and a type")}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(a,r){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await r()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=r();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await a(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const r=await ti(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?a=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<uu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const h=await ti(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=hu()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};a.user=l0(a.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Oa}):await this._useSession(async r=>{var l,u,d;const{data:h,error:g}=r;if(g)throw g;return!(!((l=h.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new On}:await ze(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Oa})})}catch(r){if(Ae(r))return qb(r)&&(await this._removeSession(),await Ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(a,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,r))}async _updateUser(a,r={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new On;const h=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await Fi(this.storage,this.storageKey));const{data:m,error:v}=await ze(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:h.access_token,xform:Oa});if(v)throw v;return h.user=m.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(l){if(Ae(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new On;const r=Date.now()/1e3;let l=r,u=!0,d=null;const{payload:h}=fu(a.access_token);if(h.exp&&(l=h.exp,u=l<=r),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-r,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(r){if(Ae(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async r=>{var l;if(!a){const{data:h,error:g}=r;if(g)throw g;a=(l=h.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new On;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ae(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(a,r){try{if(!It())throw new Ul("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Ul(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Yg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ul("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Yg("No code detected.");const{data:I,error:B}=await this._exchangeCodeForSession(a.code);if(B)throw B;const K=new URL(window.location.href);return K.searchParams.delete("code"),window.history.replaceState(window.history.state,"",K.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:h,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!h||!m)throw new Ul("No session defined in URL");const v=Math.round(Date.now()/1e3),_=parseInt(g);let x=v+_;p&&(x=parseInt(p));const b=x-v;b*1e3<=Zi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${_}s`);const w=x-_;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,x,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,x,v);const{data:A,error:R}=await this._getUser(d);if(R)throw R;const T={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:_,expires_at:x,refresh_token:h,token_type:m,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:a.type},error:null})}catch(l){if(Ae(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const r=await ti(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&r)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async r=>{var l;const{data:u,error:d}=r;if(d)return this._returnResult({error:d});const h=(l=u.session)===null||l===void 0?void 0:l.access_token;if(h){const{error:g}=await this.admin.signOut(h,a);if(g&&!(Mb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await Ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const r=Yb(),l={id:r,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async r=>{var l,u;try{const{data:{session:d},error:h}=r;if(h)throw h;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,r={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Fi(this.storage,this.storageKey,!0));try{return await ze(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(d){if(Ae(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:r,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=r.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var r;try{const{data:l,error:u}=await this._useSession(async d=>{var h,g,p,m,v;const{data:_,error:x}=d;if(x)throw x;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await ze(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=_.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return It()&&!(!((r=a.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(Ae(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async r=>{var l;try{const{error:u,data:{session:d}}=r;if(u)throw u;const{options:h,provider:g,token:p,access_token:m,nonce:v}=a,_=await ze(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:kn}),{data:x,error:b}=_;return b?this._returnResult({data:{user:null,session:null},error:b}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Yi}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:b}))}catch(u){if(Ae(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async r=>{var l,u;const{data:d,error:h}=r;if(h)throw h;return await ze(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(a){const r=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(r,"begin");try{const l=Date.now();return await Xb(async u=>(u>0&&await Qb(200*Math.pow(2,u-1)),this._debug(r,"refreshing attempt",u),await ze(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:kn})),(u,d)=>{const h=200*Math.pow(2,u);return d&&du(d)&&Date.now()+h-l<Zi})}catch(l){if(this._debug(r,"error",l),Ae(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(r,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,r){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",r,"url",l),It()&&!r.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,r;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await ti(this.storage,this.storageKey);if(u&&this.userStorage){let h=await ti(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:u.user},await Wi(this.userStorage,this.storageKey+"-user",h)),u.user=(a=h?.user)!==null&&a!==void 0?a:hu()}else if(u&&!u.user&&!u.user){const h=await ti(this.storage,this.storageKey+"-user");h&&h?.user?(u.user=h.user,await Ra(this.storage,this.storageKey+"-user"),await Wi(this.storage,this.storageKey,u)):u.user=hu()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((r=u.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<uu;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${uu}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:h}=await this._callRefreshToken(u.refresh_token);h&&(console.error(h),du(h)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:g}=await this._getUser(u.access_token);!g&&h?.user?(u.user=h.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(l,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var r,l;if(!a)throw new On;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Il;const{data:d,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!d.session)throw new On;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),Ae(d)){const h={data:null,error:d};return du(d)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,r,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",r,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:r});const d=[],h=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,r)}catch(p){d.push(p)}});if(await Promise.all(h),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const r=Object.assign({},a),l=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&r.user&&await Wi(this.userStorage,this.storageKey+"-user",{user:r.user});const u=Object.assign({},r);delete u.user;const d=Zg(u);await Wi(this.storage,this.storageKey,d)}else{const u=Zg(r);await Wi(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await Ra(this.storage,this.storageKey),await Ra(this.storage,this.storageKey+"-code-verifier"),await Ra(this.storage,this.storageKey+"-user"),this.userStorage&&await Ra(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&It()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),Zi);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async r=>{const{data:{session:l}}=r;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/Zi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${Zi}ms, refresh threshold is ${wu} ticks`),u<=wu&&await this._callRefreshToken(l.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof em)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!It()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const r=`#_onVisibilityChanged(${a})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,r,l){const u=[`provider=${encodeURIComponent(r)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,h]=await Fi(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(h)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async r=>{var l;const{data:u,error:d}=r;return d?this._returnResult({data:null,error:d}):await ze(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(a){try{return await this._useSession(async r=>{var l,u;const{data:d,error:h}=r;if(h)return this._returnResult({data:null,error:h});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await ze(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var l;const{data:u,error:d}=r;if(d)return this._returnResult({data:null,error:d});const h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?T0(a.webauthn.credential_response):A0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await ze(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var l;const{data:u,error:d}=r;if(d)return this._returnResult({data:null,error:d});const h=await ze(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(h.error)return h;const{data:g}=h;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:E0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:C0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(a){const{data:r,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:r.id,code:a.code})}async _listFactors(){var a;const{data:{user:r},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=r?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,r;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=fu(l.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((r=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async r=>{const{data:{session:l},error:u}=r;return u?this._returnResult({data:null,error:u}):l?await ze(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new On})})}catch(r){if(Ae(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(a,r){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new On});const h=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&It()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(Ae(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,r){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new On});const h=await ze(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&It()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(Ae(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,r={keys:[]}){let l=r.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Lb>u)return l;const{data:d,error:h}=await ze(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,r={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:h,raw:{header:g,payload:p}}=fu(l);r?.allowExpired||i0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:h},error:null}}const v=r0(u.alg),_=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,_,h,Gb(`${g}.${p}`)))throw new Tu("Invalid JWT signature");return{data:{claims:d,header:u,signature:h},error:null}}catch(l){if(Ae(l))return this._returnResult({data:null,error:l});throw l}}}ls.nextInstanceID={};const B0=ls;class M0 extends B0{constructor(a){super(a)}}class q0{constructor(a,r,l){var u,d,h;this.supabaseUrl=a,this.supabaseKey=r;const g=Ob(a);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:Sb,realtime:Eb,auth:Object.assign(Object.assign({},wb),{storageKey:p}),global:jb},v=Rb(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,v.global.fetch),this.fetch=Ab(r,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(_=>this.realtime.setAuth(_)).catch(_=>console.warn("Failed to set initial Realtime auth token:",_)),this.rest=new kv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new bb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Av(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,r={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,r,l)}channel(a,r={config:{}}){return this.realtime.channel(a,r)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,r;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(r=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:r,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:h,flowType:g,lock:p,debug:m,throwOnError:v},_,x){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),_),storageKey:h,autoRefreshToken:a,persistSession:r,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Jv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,l)=>{this._handleTokenChanged(r,"CLIENT",l?.access_token)})}_handleTokenChanged(a,r,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const I0=(o,a,r)=>new q0(o,a,r);function H0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}H0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const $0="https://sqwqlvsjtimallidxrsz.supabase.co",V0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",ae=I0($0,V0,{auth:{persistSession:!1}}),Cn=Object.freeze(Object.defineProperty({__proto__:null,default:ae,supabase:ae},Symbol.toStringTag,{value:"Module"}));function P0({onLogin:o}){const[a,r]=S.useState(""),[l,u]=S.useState(""),[d,h]=S.useState(null);async function g(p){p.preventDefault(),h(null);try{const{data:m,error:v}=await ae.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){h("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){h("Credenciales invlidas");return}const _=m;if(_.password===l){const x={id:_.id,username:_.username,role:_.role};localStorage.setItem("user",JSON.stringify(x));try{console.debug("Login: stored localStorage.user =",x)}catch{}try{if(_.role==="cajero"){const{data:b,error:w}=await ae.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",_.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}h("Inicio de sesin correcto"),typeof o=="function"&&o()}else h("Credenciales invlidas")}catch(m){h(m.message||"Error al consultar la base de datos")}}return s.jsx("div",{className:"login-root",children:s.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[s.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),s.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),s.jsxs("div",{className:"login-inner",children:[s.jsxs("form",{onSubmit:g,children:[s.jsxs("div",{className:"form-field",children:[s.jsx("label",{htmlFor:"username",children:"Usuario"}),s.jsx("input",{id:"username",className:"input",value:a,onChange:p=>r(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),s.jsxs("div",{className:"form-field",children:[s.jsx("label",{htmlFor:"password",children:"Contrasea"}),s.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),s.jsx("div",{children:s.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&s.jsx("p",{style:{marginTop:12},children:d}),s.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",s.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function G0({onBack:o}){return s.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[s.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),s.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),s.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[s.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),s.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function K0({onBack:o}){const[a,r]=S.useState([]),[l,u]=S.useState(!0),[d,h]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,x]=S.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=S.useState(()=>{try{const T=localStorage.getItem("user");if(T)return JSON.parse(T).username||"usuario"}catch{}return"usuario"});S.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(T=>T.json()).then(T=>{const I=T&&Array.isArray(T.ingresos)?T.ingresos:[],B=localStorage.getItem("ingresosEfectivo");let K=[];try{B&&(K=JSON.parse(B))}catch{}const E=[...I,...K];r(E)}).catch(()=>{const T=localStorage.getItem("ingresosEfectivo");try{T&&r(JSON.parse(T))}catch{r([])}}).finally(()=>u(!1))},[]);function A(T){localStorage.setItem("ingresosEfectivo",JSON.stringify(T))}function R(T){if(T.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const I=a.length?Math.max(...a.map(E=>E.id))+1:1,B={id:I,factura:d||`F-${I}`,motivo:g,monto:Number(m),fechaHora:new Date(_).toISOString(),usuario:b},K=[...a,B];r(K),A(K),h(""),p(""),v(""),x(new Date().toISOString().slice(0,16))}return s.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[s.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),s.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[s.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[s.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?s.jsx("p",{children:"Cargando..."}):s.jsx("div",{style:{overflowX:"auto"},children:s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{style:{background:"#f1f5f9"},children:s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),s.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),s.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),s.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),s.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),s.jsx("tbody",{children:a.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(T=>s.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[s.jsx("td",{style:{padding:8},children:T.factura}),s.jsx("td",{style:{padding:8},children:T.motivo}),s.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",T.monto.toFixed(2)]}),s.jsx("td",{style:{padding:8},children:new Date(T.fechaHora).toLocaleString()}),s.jsx("td",{style:{padding:8},children:T.usuario})]},T.id))})]})})]}),s.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[s.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),s.jsxs("form",{onSubmit:R,style:{display:"grid",gap:8},children:[s.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",s.jsx("input",{value:d,onChange:T=>h(T.target.value),className:"input",style:{marginTop:6}})]}),s.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",s.jsx("input",{value:g,onChange:T=>p(T.target.value),className:"input",style:{marginTop:6},required:!0})]}),s.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",s.jsx("input",{value:m,onChange:T=>v(T.target.value===""?"":Number(T.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),s.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",s.jsx("input",{value:_,onChange:T=>x(T.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),s.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",s.jsx("input",{value:b,onChange:T=>w(T.target.value),className:"input",style:{marginTop:6}})]}),s.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[s.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),s.jsx("button",{type:"button",onClick:()=>{h(""),p(""),v(""),x(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function Y0({onBack:o}){const[a,r]=S.useState([]),[l,u]=S.useState(!1),[d,h]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(!1),[_,x]=S.useState(!1),[b,w]=S.useState(null),A=async()=>{u(!0);try{const{data:Q,error:fe}=await ae.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(fe)throw fe;const xe=Array.isArray(Q)?Q:[],q=Array.from(new Set(xe.map(C=>C.cliente_id).filter(Boolean)));let X={};if(q.length>0)try{const{data:C}=await ae.from("clientes").select("id,nombre").in("id",q);if(Array.isArray(C))for(const U of C)X[String(U.id)]=U.nombre||""}catch(C){console.warn("Error cargando nombres de clientes:",C)}const W=xe.map(C=>({...C,cliente_nombre:X[String(C.cliente_id)]||null}));r(W)}catch(Q){console.warn("Error cargando cotizaciones:",Q),r([])}u(!1)};S.useEffect(()=>{A()},[]);const[R,T]=S.useState(null),[I,B]=S.useState(null),[K,E]=S.useState(""),M=async Q=>{h(Q);try{const{data:fe,error:xe}=await ae.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",Q).maybeSingle();if(xe&&console.warn("Error cargando cabecera de cotizacion",xe),T(fe||null),fe&&fe.cliente_id)try{const{data:W}=await ae.from("clientes").select("id,nombre").eq("id",fe.cliente_id).maybeSingle();B(W?.nombre||null)}catch{B(null)}else B(null);const{data:q,error:X}=await ae.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Q);if(X)throw X;p(Array.isArray(q)?q:[]),v(!0)}catch(fe){console.warn("Error cargando detalles de cotizacion",fe),p([])}},L=async Q=>{try{const{data:fe,error:xe}=await ae.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Q.id),q=Array.isArray(fe)?fe:[],X={header:Q,detalles:q};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(X))}catch(W){console.warn("No se pudo escribir localStorage",W)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:X}))}catch{}o()}catch(fe){console.warn("Error cargando detalles para editar",fe)}},V=async Q=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:fe}=await ae.from("cotizaciones_detalle").delete().eq("cotizacion_id",Q);fe&&console.warn("Error eliminando detalles:",fe);const{error:xe}=await ae.from("cotizaciones").delete().eq("id",Q);if(xe)throw xe;A()}catch(fe){console.warn("Error eliminando cotizacion:",fe)}},ye=async()=>{if(b)try{const Q={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:fe}=await ae.from("cotizaciones").update(Q).eq("id",b.id);if(fe&&console.warn("Error actualizando cotizacion:",fe),b.id){const{error:xe}=await ae.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);xe&&console.warn("Error borrando detalles antiguos:",xe);const q=g.map(W=>({...W,cotizacion_id:b.id})),{error:X}=await ae.from("cotizaciones_detalle").insert(q);X&&console.warn("Error insertando detalles actualizados:",X)}x(!1),A()}catch(Q){console.warn("Error guardando cotizacion editada:",Q)}};return s.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[s.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),s.jsxs("div",{children:[s.jsx("button",{onClick:A,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),s.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),s.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[s.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),s.jsx("input",{placeholder:"Nmero o cliente",value:K,onChange:Q=>E(Q.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),s.jsx("button",{onClick:()=>E(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?s.jsx("div",{children:"Cargando..."}):a.length===0?s.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{children:s.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[s.jsx("th",{style:{padding:8},children:"Nmero"}),s.jsx("th",{style:{padding:8},children:"Fecha"}),s.jsx("th",{style:{padding:8},children:"Usuario"}),s.jsx("th",{style:{padding:8},children:"Cliente ID"}),s.jsx("th",{style:{padding:8},children:"Total"}),s.jsx("th",{style:{padding:8},children:"Estado"}),s.jsx("th",{style:{padding:8},children:"Acciones"})]})}),s.jsx("tbody",{children:a.filter(Q=>{if(!K)return!0;const fe=K.toLowerCase(),xe=(Q.numero_cotizacion||"").toLowerCase(),q=(Q.cliente_nombre||"")?.toLowerCase(),X=(Q.usuario||"").toLowerCase();return xe.includes(fe)||q.includes(fe)||X.includes(fe)}).map(Q=>s.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[s.jsx("td",{style:{padding:8},children:Q.numero_cotizacion||""}),s.jsx("td",{style:{padding:8},children:Q.fecha_cotizacion?new Date(Q.fecha_cotizacion).toLocaleString():""}),s.jsx("td",{style:{padding:8},children:Q.usuario||""}),s.jsx("td",{style:{padding:8},children:Q.cliente_nombre||(Q.cliente_id?String(Q.cliente_id):"")}),s.jsxs("td",{style:{padding:8},children:["L ",Number(Q.total||0).toFixed(2)]}),s.jsx("td",{style:{padding:8},children:Q.estado||""}),s.jsxs("td",{style:{padding:8},children:[s.jsx("button",{onClick:()=>M(Q.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(Q.estado||"").toLowerCase()==="aceptada"?s.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):s.jsx("button",{onClick:()=>L(Q),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),s.jsx("button",{onClick:()=>V(Q.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},Q.id))})]})]}),m&&s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),s.jsx("button",{onClick:()=>{v(!1),p([]),h(null)},className:"btn-opaque",children:"Cerrar"})]}),s.jsxs("div",{style:{marginTop:12},children:[R&&s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[s.jsxs("div",{children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Nmero:"})," ",R.numero_cotizacion]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Fecha:"})," ",R.fecha_cotizacion?new Date(R.fecha_cotizacion).toLocaleString():""]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Usuario:"})," ",R.usuario]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Cliente:"})," ",I??(R.cliente_id?String(R.cliente_id):"C/F")]})]}),s.jsxs("div",{style:{textAlign:"right"},children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Subtotal:"})," L ",Number(R.subtotal||0).toFixed(2)]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Impuesto:"})," L ",Number(R.impuesto||0).toFixed(2)]}),s.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[s.jsx("strong",{children:"Total:"})," L ",Number(R.total||0).toFixed(2)]})]})]}),s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{children:s.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[s.jsx("th",{style:{padding:8},children:"Descripcin"}),s.jsx("th",{style:{padding:8},children:"Cantidad"}),s.jsx("th",{style:{padding:8},children:"Precio U."}),s.jsx("th",{style:{padding:8},children:"Subtotal"}),s.jsx("th",{style:{padding:8},children:"Descuento"}),s.jsx("th",{style:{padding:8},children:"Total"})]})}),s.jsx("tbody",{children:g.map((Q,fe)=>s.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[s.jsx("td",{style:{padding:8},children:Q.descripcion}),s.jsx("td",{style:{padding:8},children:Q.cantidad}),s.jsxs("td",{style:{padding:8},children:["L ",Number(Q.precio_unitario||0).toFixed(2)]}),s.jsxs("td",{style:{padding:8},children:["L ",Number(Q.subtotal||(Q.precio_unitario||0)*(Q.cantidad||0)).toFixed(2)]}),s.jsxs("td",{style:{padding:8},children:["L ",Number(Q.descuento||0).toFixed(2)]}),s.jsxs("td",{style:{padding:8},children:["L ",Number(Q.total||(Q.subtotal||0)-(Q.descuento||0)).toFixed(2)]})]},fe))})]})]})]})}),_&&b&&s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),s.jsx("button",{onClick:()=>{x(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[s.jsxs("div",{children:[s.jsx("label",{children:"Cliente"}),s.jsx("input",{value:b.cliente||"",onChange:Q=>w({...b,cliente:Q.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),s.jsxs("div",{children:[s.jsx("label",{children:"RTN"}),s.jsx("input",{value:b.rtn||"",onChange:Q=>w({...b,rtn:Q.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),s.jsx("div",{style:{marginTop:12},children:s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{children:s.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[s.jsx("th",{style:{padding:8},children:"SKU"}),s.jsx("th",{style:{padding:8},children:"Nombre"}),s.jsx("th",{style:{padding:8},children:"Cantidad"}),s.jsx("th",{style:{padding:8},children:"Precio"}),s.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),s.jsx("tbody",{children:g.map((Q,fe)=>s.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[s.jsx("td",{style:{padding:8},children:Q.sku}),s.jsx("td",{style:{padding:8},children:Q.nombre}),s.jsx("td",{style:{padding:8},children:s.jsx("input",{type:"number",value:Q.cantidad||0,onChange:xe=>{const q=Number(xe.target.value||0),X=[...g];X[fe]={...X[fe],cantidad:q},p(X)},style:{width:80,padding:6}})}),s.jsx("td",{style:{padding:8},children:s.jsx("input",{type:"number",value:Q.precio_unitario||0,onChange:xe=>{const q=Number(xe.target.value||0),X=[...g];X[fe]={...X[fe],precio_unitario:q},p(X)},style:{width:120,padding:6}})}),s.jsxs("td",{style:{padding:8},children:["L ",Number((Q.precio_unitario||0)*(Q.cantidad||0)).toFixed(2)]})]},fe))})]})}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[s.jsx("button",{onClick:()=>{x(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),s.jsx("button",{onClick:ye,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function F0({onBack:o}){return s.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[s.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),s.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),s.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[s.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),s.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function J0({onBack:o}){return s.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[s.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),s.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),s.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[s.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),s.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function Q0({onBack:o}){return s.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[s.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),s.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),s.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[s.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),s.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function X0({open:o,onClose:a,onSelect:r}){const[l,u]=S.useState(""),[d,h]=S.useState(!1),[g,p]=S.useState([]);return S.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{h(!0);try{const{data:v,error:_}=await ae.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(_)throw _;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&h(!1)}})(),()=>{m=!1}},[o]),S.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{h(!0);try{const v=String(l||"").trim();let _;if(v===""?_=await ae.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):_=await ae.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),_.error)throw _.error;p(Array.isArray(_.data)?_.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{h(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:s.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),s.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),s.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),s.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),s.jsx("div",{style:{marginTop:12},children:s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{style:{background:"#f1f5f9"},children:s.jsxs("tr",{children:[s.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),s.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),s.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),s.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),s.jsx("th",{style:{padding:8}})]})}),s.jsxs("tbody",{children:[g.map(m=>s.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[s.jsx("td",{style:{padding:8},children:m.rtn}),s.jsx("td",{style:{padding:8},children:m.nombre}),s.jsx("td",{style:{padding:8},children:m.telefono}),s.jsx("td",{style:{padding:8},children:m.correo_electronico}),s.jsx("td",{style:{padding:8},children:s.jsx("button",{onClick:()=>{r(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&s.jsx("tr",{children:s.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function Z0({open:o,onClose:a,totalDue:r,onConfirm:l}){const[u,d]=S.useState(0),[h,g]=S.useState(0),[p,m]=S.useState(0);S.useEffect(()=>{o||(d(0),g(0),m(0))},[o]);const v=Number((Number(u)+Number(h)+Number(p)).toFixed(2)),_=Number((r-v).toFixed(2)),x=v>=r&&v>0,b=()=>{const w=[];u>0&&w.push(`efectivo:(${u.toFixed(2)})`),h>0&&w.push(`tarjeta:(${h.toFixed(2)})`),p>0&&w.push(`transferencia:(${p.toFixed(2)})`);const A=w.join(",");l({efectivo:u,tarjeta:h,transferencia:p,totalPaid:v,tipoPagoString:A}),a()};return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:s.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),s.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),s.jsxs("div",{style:{marginTop:12},children:[s.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",s.jsxs("strong",{children:["L ",r.toFixed(2)]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[s.jsxs("div",{children:[s.jsx("label",{children:"Efectivo"}),s.jsx("input",{type:"number",value:u,onChange:w=>d(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Tarjeta"}),s.jsx("input",{type:"number",value:h,onChange:w=>g(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),s.jsxs("div",{children:[s.jsx("label",{children:"Transferencia"}),s.jsx("input",{type:"number",value:p,onChange:w=>m(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),s.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:s.jsxs("div",{children:[s.jsx("label",{children:"Total ingresado"}),s.jsxs("div",{style:{padding:8,borderRadius:6,border:"1px solid #e6edf3"},children:["L ",v.toFixed(2)]})]})})]}),s.jsx("div",{style:{marginTop:12},children:_>0?s.jsxs("div",{style:{color:"#ef4444"},children:["Falta: L ",_.toFixed(2)]}):s.jsxs("div",{style:{color:"#16a34a"},children:["Pago completo. Cambio/Exceso: L ",Math.abs(_).toFixed(2)]})}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),s.jsx("button",{onClick:b,className:"btn-opaque",disabled:!x,style:{background:x?"#16a34a":"gray",color:"white"},children:"Confirmar pago"})]})]})]})}):null}function W0({productos:o,imageUrls:a,agregarAlCarrito:r,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:h}){return s.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:s.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[s.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:s.jsxs("tr",{children:[s.jsx("th",{style:u}),s.jsx("th",{style:u,children:"Imagen"}),s.jsx("th",{style:u,children:"SKU"}),s.jsx("th",{style:u,children:"Nombre"}),s.jsx("th",{style:u,children:"Categora"}),s.jsx("th",{style:u,children:"Precio"}),s.jsx("th",{style:u,children:"Stock"}),s.jsx("th",{style:u,children:"Accin"})]})}),s.jsx("tbody",{children:o.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>s.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[s.jsx("td",{style:d,children:s.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),s.jsx("td",{style:d,children:a[String(g.id)]?s.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?s.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),s.jsx("td",{style:d,children:s.jsx("code",{style:h,children:g.sku})}),s.jsx("td",{style:d,children:s.jsx("strong",{children:g.nombre})}),s.jsx("td",{style:d,children:s.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),s.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),s.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return s.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),s.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,_=v?p<1?"Agotado":"Sin precio":"Agregar";return s.jsx("button",{onClick:()=>r(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:_})})()})]},g.id))})]})})}function e_({carrito:o,actualizarCantidad:a,eliminarDelCarrito:r,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:h,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:_}){return s.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[s.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&s.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&s.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[s.jsx("span",{children:"Subtotal:"}),s.jsxs("span",{children:["L",u.toFixed(2)]})]}),s.jsx("div",{style:{display:"flex",justifyContent:"space-between",color:"#16a34a",fontWeight:500},children:s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[s.jsxs("div",{children:["ISV (",(h*100).toFixed(2),"%): ",s.jsxs("strong",{children:["L",Number(d.reduce((x,b)=>x+(b.isv||0),0)).toFixed(2)]})]}),s.jsxs("div",{children:["Impuesto 18%: ",s.jsxs("strong",{children:["L",Number(d.reduce((x,b)=>x+(b.imp18||0),0)).toFixed(2)]})]}),s.jsxs("div",{children:["Impuesto turstico (",(p*100).toFixed(2),"%): ",s.jsxs("strong",{children:["L",Number(d.reduce((x,b)=>x+(b.tur||0),0)).toFixed(2)]})]})]})}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[s.jsx("span",{children:"TOTAL:"}),s.jsxs("span",{children:["L",m.toFixed(2)]})]}),s.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:[s.jsxs("div",{children:["Tax rates: ISV ",(h*100).toFixed(2),"%, 18% ",(g*100).toFixed(2),"%, Tur ",(p*100).toFixed(2),"%"]}),s.jsxs("details",{style:{marginTop:6},children:[s.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),s.jsx("div",{style:{marginTop:8},children:d.map(x=>s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[s.jsxs("div",{style:{color:"#0f172a"},children:[x.nombre,"  L",x.price.toFixed(2)]}),s.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",x.isv.toFixed(2),"  18%: L",x.imp18.toFixed(2),"  Tur: L",x.tur.toFixed(2)]})]},String(x.id)))})]})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[s.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),s.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?s.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):s.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(x=>s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[s.jsxs("div",{style:{flex:1},children:[s.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",x.producto.sku,"] ",x.producto.nombre]}),s.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(x.producto.precio||0).toFixed(2)," c/u"]})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[s.jsx("button",{onClick:()=>a(x.producto.id,-1),style:_,children:""}),s.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:x.cantidad}),s.jsx("button",{onClick:()=>a(x.producto.id,1),style:_,children:"+"}),s.jsx("button",{onClick:()=>r(x.producto.id),style:{..._,background:"#ef4444"},children:""})]})]},x.producto.id))})]})}function t_({userName:o,userRole:a,userId:r,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:h,onPrintFormatChange:g,printFormat:p}){const[m,v]=S.useState(!1),_=S.useRef(null);return S.useEffect(()=>{function x(b){_.current&&!_.current.contains(b.target)&&v(!1)}return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),s.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[s.jsx("h1",{style:{margin:0,fontSize:"1.4rem",fontWeight:600},children:"Solutecc  -  Caja"}),s.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[s.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),s.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""}),r!=null&&s.jsxs("div",{style:{fontSize:"0.75rem",color:"#cbd5e1",marginTop:2},children:["ID: ",String(r)]})]}),s.jsxs("div",{style:{position:"relative"},ref:_,children:[s.jsxs("div",{style:{position:"absolute",right:120,top:10,display:"flex",alignItems:"center",gap:8},children:[s.jsx("label",{style:{color:"#e2e8f0",fontSize:12},children:"Impresin"}),s.jsxs("div",{style:{display:"flex",background:"#0b1724",padding:4,borderRadius:20},children:[s.jsx("button",{onClick:()=>{g&&g("carta")},className:"btn-opaque",style:{padding:"6px 8px",background:p==="carta"?"#0ea5e9":"transparent",color:"#e2e8f0",borderRadius:12},children:"Carta"}),s.jsx("button",{onClick:()=>{g&&g("cinta")},className:"btn-opaque",style:{padding:"6px 8px",background:p==="cinta"?"#0ea5e9":"transparent",color:"#e2e8f0",borderRadius:12},children:"Cinta"})]})]}),s.jsx("button",{onClick:()=>v(x=>!x),"aria-expanded":m,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),m&&s.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[s.jsx("button",{onClick:()=>{v(!1),d()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),s.jsx("button",{onClick:()=>{v(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),s.jsx("button",{onClick:()=>{v(!1),h("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),s.jsx("button",{onClick:()=>{v(!1),h("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),s.jsx("button",{onClick:()=>{v(!1),h("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),s.jsx("button",{onClick:()=>{v(!1),h("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),s.jsx("button",{onClick:()=>{v(!1),h("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),s.jsx("button",{onClick:()=>{v(!1),h("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function n_({open:o,onClose:a,width:r=520,children:l,zIndex:u=9999}){return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:s.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:r,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})}):null}function a_({open:o,onClose:a,caiInfo:r,onRefresh:l}){const[u,d]=Nu.useState(!1);return s.jsx(n_,{open:o,onClose:a,width:520,children:s.jsxs("div",{children:[s.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),s.jsxs("div",{style:{color:"#475569",marginTop:8},children:[s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"CAI:"})," ",r?.cai??"-"]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Identificador:"})," ",r?.identificador??"-"]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Rango desde:"})," ",r?.rango_de??"-"]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Rango hasta:"})," ",r?.rango_hasta??"-"]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Fecha lmite emisin:"})," ",r?.fecha_vencimiento??r?.fecha_limite_emision??"-"]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Secuencia actual:"})," ",r?.secuencia_actual??"-"]})]}),s.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[s.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),s.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(h){console.debug("Error calling onRefresh from DatosFacturaModal:",h)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function i_({open:o,selectedEntrada:a,onClose:r,imageUrls:l}){return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),s.jsx("button",{onClick:r,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?s.jsx("div",{children:s.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?s.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):s.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),s.jsxs("div",{style:{flex:1},children:[s.jsxs("p",{style:{margin:"6px 0"},children:[s.jsx("strong",{children:"SKU:"})," ",a.sku]}),s.jsxs("p",{style:{margin:"6px 0"},children:[s.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),s.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[s.jsxs("p",{style:{margin:0},children:[s.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),s.jsxs("p",{style:{margin:0},children:[s.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),s.jsxs("p",{style:{margin:0},children:[s.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),s.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:s.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):s.jsx("div",{children:s.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function r_({open:o,onClose:a,onCancel:r,onSave:l}){return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),s.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),s.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[s.jsx("button",{onClick:r,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),s.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function s_({open:o,onClose:a,doFacturaClienteFinal:r,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:h,taxRate:g,taxableSubtotal:p}){return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:[s.jsxs("div",{style:{flex:1},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),s.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),s.jsx("p",{style:{color:"#475569",marginTop:6},children:"Elige si la factura ser para Cliente Final o para un Cliente registrado. Cliente Final genera una factura inmediata lista para imprimir. Cliente Normal permite ingresar datos del cliente."}),s.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[s.jsxs("div",{onClick:r,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[s.jsx("div",{style:{fontSize:28},children:""}),s.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),s.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Factura para consumidor final. No requiere RTN."}),s.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),s.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[s.jsx("div",{style:{fontSize:28},children:""}),s.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),s.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar nombre y nmero de identificacin (RTN) para la factura."}),s.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),s.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[s.jsx("div",{style:{fontSize:28},children:""}),s.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),s.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar razn social y nmero de identificacin (RTN) para la factura."}),s.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]})]})]}),s.jsxs("div",{style:{width:220,borderLeft:"1px dashed #e6edf3",paddingLeft:16,display:"flex",flexDirection:"column",gap:8},children:[s.jsx("div",{style:{fontWeight:700},children:"Resumen"}),s.jsxs("div",{style:{color:"#475569"},children:["Items: ",s.jsx("strong",{children:d})]}),s.jsxs("div",{style:{color:"#475569"},children:["SubTotal: ",s.jsxs("strong",{children:["L ",h.toFixed(2)]})]}),s.jsxs("div",{style:{color:"#475569"},children:["ISV (",(g*100).toFixed(2),"%): ",s.jsxs("strong",{children:["L ",(p*g).toFixed(2)]})]}),s.jsxs("div",{style:{marginTop:8,fontSize:18,fontWeight:800},children:["Total: L ",(h+p*g).toFixed(2)]}),s.jsx("div",{style:{marginTop:12,fontSize:12,color:"#94a3b8"},children:"Seleccione una opcin para continuar."})]})]})}):null}function l_({open:o,onClose:a,clienteTipo:r,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:h,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:_,onTelefonoChange:x,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:A,onCancel:R,onOpenCreateCliente:T,onOpenPayment:I,paymentDone:B,submitClienteNormal:K}){return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsx("h3",{style:{margin:0},children:r==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),s.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),s.jsx("p",{style:{color:"#475569",marginTop:6},children:r==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[s.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("input",{value:l,onChange:E=>v(E.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),r==="juridico"&&s.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[s.jsx("label",{style:{fontSize:13,color:"#334155"},children:r==="juridico"?"Razn social":"Nombre completo"}),s.jsx("input",{value:u,onChange:E=>_(E.target.value),placeholder:r==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[s.jsx(X0,{open:p,onClose:()=>m(!1),onSelect:E=>{}}),s.jsx("button",{onClick:R,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),s.jsx("button",{onClick:T,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),B?s.jsx("button",{onClick:K,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):s.jsx("button",{onClick:I,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function o_({open:o,onClose:a,clienteRTN:r,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:h,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:_,onCreate:x}){return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[s.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),s.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),s.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",s.jsx("strong",{children:"juridico"}),"."]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[s.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),s.jsx("input",{value:r,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[s.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),s.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[s.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),s.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[s.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),s.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[s.jsx("input",{id:"exon",type:"checkbox",checked:h,onChange:b=>_(b.target.checked)}),s.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[s.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),s.jsx("button",{onClick:async()=>{await x()},className:"btn-opaque",style:{opacity:!l||!r?.6:1},disabled:!l||!r,children:"Crear cliente"})]})]})}):null}async function am(){try{const{data:o,error:a}=await ae.from("empresa").select("*").limit(1).maybeSingle();if(a)throw a;const r=o||null;if(!r)return null;try{const l=r.logo;if(!l)r.logoUrl=null;else if(String(l).startsWith("http"))r.logoUrl=String(l);else{const u="logo";try{const h=(await ae.storage.from(u).getPublicUrl(String(l)))?.data?.publicUrl??null;if(h)r.logoUrl=h;else{const g=await ae.storage.from(u).createSignedUrl(String(l),3600);r.logoUrl=g?.data?.signedUrl??null}}catch{const h="https://sqwqlvsjtimallidxrsz.supabase.co";let g=String(l);g.startsWith(`${u}/`)&&(g=g.slice(u.length+1)),r.logoUrl=`${h}/storage/v1/object/public/${u}/${encodeURIComponent(g)}`}}}catch{r.logoUrl=null}return r}catch(o){return console.warn("getCompanyData error",o),null}}async function rp(o={},a="factura",r={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const O=await am();O&&(l=l||O.nombre||O.comercio||l,u=u||O.rtn||u,d=d||O.direccion||O.direccion_fiscal||d,h=h||O.telefono||O.telefono_fijo||h,g=g||O.email||O.correo||g,p=p||O.logoUrl||O.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const O=await fetch(String(p),{mode:"cors"});if(O.ok){const te=await O.blob(),me=await new Promise(we=>{const Te=new FileReader;Te.onloadend=()=>{we(typeof Te.result=="string"?Te.result:null)},Te.onerror=()=>{we(null)},Te.readAsDataURL(te)});me&&(p=me)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",_=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",x=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let O=o.caiInfo||null;if(!O&&typeof window<"u"){const te=window.localStorage.getItem("caiInfo");if(te)try{O=JSON.parse(te)}catch{O=null}}if(O&&(v=v||O.cai||O.CAI||"",_=_||O.fecha_vencimiento||O.fecha_limite_emision||"",x=x||O.rango_de||O.rangoDesde||"",b=b||O.rango_hasta||O.rangoHasta||"",w=w||O.identificador||"",!m))try{const te=O.identificador?String(O.identificador):"",me=O.secuencia_actual!=null?String(O.secuencia_actual):O.rango_de!=null?String(O.rango_de):"",we=String(me).replace(/[^0-9]/g,"")||"";let Te=0;(O.rango_hasta||O.rango_de)&&(Te=Math.max(String(O.rango_hasta||O.rango_de).length,we.length));const ke=we?String(we).padStart(Te||we.length||1,"0"):"";m=(te||"")+(ke||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const A=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),R=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||r.identidad||"C/F",T=new Date().toLocaleString(),I=Array.isArray(r.carrito)?r.carrito:[],B=typeof r.subtotal=="number"?r.subtotal:I.reduce((O,te)=>O+Number(te.producto&&te.producto.precio||te.precio||0)*(te.cantidad||1),0),K=typeof r.descuento=="number"?r.descuento:0,E=typeof r.exonerado=="number"?r.exonerado:0,M=typeof r.gravado=="number"?r.gravado:B,L=typeof r.exento=="number"?r.exento:0,V=typeof r.isvTotal=="number"?r.isvTotal:0,ye=typeof r.imp18Total=="number"?r.imp18Total:0,Q=typeof r.impTouristTotal=="number"?r.impTouristTotal:0,fe=typeof r.total=="number"?r.total:null,xe=B+(V||0)+(ye||0)+(Q||0),q=fe??xe,X=q,W=r.pagos||{},C=typeof W.efectivo=="number"?W.efectivo:typeof r.Efectivo=="number"?r.Efectivo:0,U=typeof W.tarjeta=="number"?W.tarjeta:typeof r.Tarjeta=="number"?r.Tarjeta:0,ee=typeof W.transferencia=="number"?W.transferencia:typeof r.Transferencia=="number"?r.Transferencia:0,ge=typeof W.totalPaid=="number"?W.totalPaid:C+U+ee;let pe;if(typeof W.cambio=="number")pe=W.cambio;else if(typeof r.cambio=="number")pe=r.cambio;else{const O=Number(ge)-Number(X||0);pe=isNaN(O)?0:O>0?O:0}const D=I.map(O=>{const te=String(O.producto&&(O.producto.nombre||O.producto.descripcion)||O.descripcion||O.nombre||""),me=Number(O.cantidad||0),we=Number((O.producto&&(O.producto.precio??O.producto.precio_unitario))??O.precio_unitario??O.precio??0),Te=!!(O.producto&&O.producto.exento)||!!O.exento,ke=!!(O.producto&&O.producto.aplica_impuesto_18)||!!O.aplica_impuesto_18,Le=!!(O.producto&&O.producto.aplica_impuesto_turistico)||!!O.aplica_impuesto_turistico,$e=ke?r.tax18Rate??r.tax18??0:r.taxRate??r.tax??0,ut=Le?r.taxTouristRate??r.taxTourist??0:0,mt=(Number($e)||0)+(Number(ut)||0);let dt=we;!Te&&mt>0&&(dt=we/(1+mt));const wt=Number(dt||0).toFixed(2),Ht=dt*me,ot=Number(Ht||0).toFixed(2);return`<tr><td>${O.producto&&O.producto.sku||O.sku||""} ${te}</td><td style="text-align:center">${me}</td><td style="text-align:right">L ${wt}</td><td style="text-align:right">L ${ot}</td></tr>`}).join(`
`),P=(Number(C)||0)+(Number(ee)||0)+(Number(U)||0)-(Number(pe)||0),J=isNaN(P)?0:P,he=c_(J);return`
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Factura Detallada</title>
	<style>
		/* === 1. Estilos Base y Reset de Impresin === */
		@page {
			size: letter;
			margin: 0.5in; /* Reducido a 0.5in para mejor uso del espacio */
		}

		* {
			/* Mantener la configuracin de negrita y espaciado ajustado para factura */
			font-weight: bold !important;
			letter-spacing: 0 !important;
			word-spacing: 0 !important;
			margin: 0;
			padding: 0;
			line-height: 1.2 !important; /* Ligeramente aumentado para legibilidad */
			box-sizing: border-box;
		}

		body {
			font-family: 'Arial', sans-serif;
			font-size: 10px;
			color: #000;
			margin: 0;
			padding: 0;
		}

		/* === 2. Estructura Principal === */
		.factura-container {
			width: 100%;
			max-width: 8.5in;
			margin: 0 auto;
			padding: 0.25in; /* Espaciado interno general */
		}

		.divider {
			border: none;
			border-top: 1px solid #000;
			margin: 5px 0;
		}

		/* === 3. Encabezado de Factura === */
		.header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 10px;
		}

		.header img {
			width: 200px; /* Tamao ajustado para armona */
			height: auto;
			object-fit: contain;
			margin-right: 20px;
		}

		.header-title {
			font-size: 35px; /* Reducido ligeramente para balance */
			color: #0066CC;
			text-align: right;
			flex-grow: 1;
		}

		/* === 4. Secciones de Informacin === */
		.info-section h3, .info-section p {
			font-size: 11px;
			margin-bottom: 2px;
		}

		.info-dates {
			text-align: right;
			margin-bottom: 5px;
		}
		
		.info-dates p {
			font-size: 10px;
			margin: 1px 0;
		}

		/* === 5. Tabla de Productos === */
		.tabla {
			width: 100%;
			border-collapse: collapse;
			margin-top: 8px;
			font-size: 10px;
		}

		.tabla th, .tabla td {
			border: 1px solid #000;
			padding: 4px 6px; /* Aumentado para mejor legibilidad */
			text-align: left;
		}

		.tabla th {
			background-color: #555; /* Oscurecido a un gris ms formal */
			color: white;
			text-transform: uppercase;
		}

		.tabla td:nth-child(2), .tabla td:nth-child(3), .tabla td:nth-child(4) {
			text-align: right; /* Alineacin de nmeros */
		}

		/* === 6. Totales y Pagos === */
		.totals-section {
			margin-top: 5px;
			display: grid;
			grid-template-columns: 1fr 1fr; /* Para asegurar alineacin de etiquetas y valores */
			gap: 2px 0;
		}

		.totals-section p {
			display: contents; /* Permite que el span .right se alinee al final de la columna */
		}

		.totals-section span.label {
			text-align: left;
			padding-left: 2px;
		}

		.totals-section span.value {
			text-align: right;
			padding-right: 2px;
		}
		
		.total-final {
			font-size: 11px;
			margin-top: 5px;
			border-top: 1px solid #000;
			padding-top: 3px;
		}

		/* === 7. Pie de Factura === */
		.footer-info {
			text-align: center;
			margin-top: 10px;
			font-size: 10px;
		}
		
		.letras {
			font-size: 11px;
			margin: 5px 0;
			text-align: center;
		}

		.firma-section {
			margin-top: 15px;
			display: flex;
			justify-content: space-around;
			text-align: center;
		}

		.copias-info {
			text-align: center;
			margin-top: 8px;
		}

		.final-message {
			font-size: 10px;
			text-align: center;
			margin-top: 10px;
		}
		
		/* === 8. Media Print Overrides (Mejorado) === */
		@media print {
			.tabla th {
				/* Asegurar colores de encabezado de tabla en la impresin */
				background-color: #555 !important;
				color: white !important;
				-webkit-print-color-adjust: exact;
				print-color-adjust: exact;
			}
			.factura-container {
				box-shadow: none;
				border-radius: 0;
			}
			/* Se puede aadir ms ajustes si la impresin recorta elementos */
		}

			/* Forzar que navegadores impriman colores de fondo y estilos exactos */
			html, body, .factura-container, .header, .header-title, .header-title-container, .tabla, .tabla th, .totals-section, .total-final, .footer-info {
				-webkit-print-color-adjust: exact !important;
				print-color-adjust: exact !important;
				color-adjust: exact !important;
			}

			/* Reforzar en la regla de impresin para asegurar compatibilidad */
			@media print {
				.header-title { color: #0066CC !important; }
				.tabla th { background-color: #555 !important; color: #fff !important; }
				.totals-section, .total-final { background-color: transparent !important; }
			}
			.header-title-container {
    text-align: right;
}

.numero-factura {
    font-size: 24px;   /* Tamao grande */
    color: #000;       /* Negro */
    margin-top: -5px;  /* Ajuste opcional para acercarlo al ttulo */
}

	</style>
</head>
<body>
	<main class="factura-container">

		<header class="header">
    <img src="${p}" alt="Logo del Comercio" />
    <div class="header-title-container">
        <h1 class="header-title">FACTURA</h1>
        <h2 class="numero-factura">No. ${m}</h2>
    </div>
</header>

		<hr class="divider" />

		<section class="info-section">
			<h3>${l}</h3>
			<p>RTN: ${u}</p>
			<p>Direccin: ${d}</p>
			<p>Telfono: ${h}</p>
			<p>Email: ${g}</p>
		</section>
		<hr class="divider" />

		<section class="info-dates">
			<p>Fecha y hora: ${T}</p>
			<p>Factura No: ${m}</p>
			<p>CAI: ${v}</p>
			<p>Fecha lmite de emisin: ${_}</p>
			<p>Rango autorizado: ${w?w+" "+x+" al "+w+" "+b:x+" al "+b}</p>
		</section>
		<hr class="divider" />

		<section class="info-section">
			<p>Cliente: ${A}</p>
			<p>RTN Cliente: ${R}</p>
		</section>
		<hr class="divider" />

		<section class="details-section">
			<table class="tabla">
				<thead>
					<tr>
						<th>Descripcin</th>
						<th style="width: 10%;">Cant</th>
							<th style="width: 15%;">Precio unitario</th>
							<th style="width: 15%;">Total</th>
					</tr>
				</thead>
				<tbody>
					${D} </tbody>
			</table>
		</section>
		<hr class="divider" />

	<section class="totals-section">
    <span class="label">Descuento:</span> <span class="value">L ${K.toFixed(2)}</span>
    <span class="label">Sub Total Exonerado:</span> <span class="value">L ${Number(E).toFixed(2)}</span>
    <span class="label">Sub Total Gravado:</span> <span class="value">L ${Number(M).toFixed(2)}</span>
    <span class="label">Sub Total Exento:</span> <span class="value">L ${Number(L).toFixed(2)}</span>
    <span class="label">Tasa Turstica 4%:</span> <span class="value">L ${Number(Q).toFixed(2)}</span>
    <span class="label">ISV 15%:</span> <span class="value">L ${Number(V).toFixed(2)}</span>
    <span class="label">ISV 18%:</span> <span class="value">L ${Number(ye).toFixed(2)}</span>
</section>

<section class="transaccion-section"><hr class="divider" />
    <span class="label">TOTAL TRANSACCIN:</span>
    <span class="value">L ${Number(q).toFixed(2)}</span>
</section>

<hr class="divider" />


		<section class="totals-section total-final">
			<span class="label">**TOTAL FACTURA:**</span> <span class="value">**L ${X.toFixed(2)}**</span>
			<span class="label">Efectivo:</span> <span class="value">L ${Number(C).toFixed(2)}</span>
			<span class="label">Tarjeta:</span> <span class="value">L ${Number(U).toFixed(2)}</span>
			<span class="label">Transferencia:</span> <span class="value">L ${Number(ee).toFixed(2)}</span>
			<span class="label">Cambio:</span> <span class="value">L ${Number(pe).toFixed(2)}</span>
		</section>
		<hr class="divider" />

		<footer class="footer-info">
			<div class="letras">
				<p>Total Pagado: L ${J.toFixed(2)}</p>
				<p>*** ${he} Lempiras ***</p>
			</div>
			<hr class="divider" />
			
			<div class="firma-section">
				<p>Firma del Cliente: ______________________</p>
				<p>Firma del Emisor: ______________________</p>
			</div>
			
			<div class="copias-info">
				<p>Original: Cliente | Copia: Obligado tributario emisor</p>
			</div>
			
			<div class="final-message">
				<h5>Para cualquier reclamo debe presentar su factura</h5>
				<h5>Gracias por su compra!</h5>
				<h5>LA FACTURA ES BENEFICIO DE TODOS EXJALA!</h5>
			</div>
		</footer>

	</main>
</body>
</html>`}function c_(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],r=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const _=Math.floor(v/10),x=v%10;return r[_]+(x?" y "+a[x]:"")}if(v<1e3){const _=Math.floor(v/100),x=v%100;return(_===1&&x===0?"cien":l[_]||"")+(x?" "+u(x):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let _=u(v);m===2&&v===1&&(_="un"),h.unshift(_+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}async function u_(o={},a="factura",r={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const O=await am();O&&(l=l||O.nombre||O.comercio||l,u=u||O.rtn||u,d=d||O.direccion||O.direccion_fiscal||d,h=h||O.telefono||O.telefono_fijo||h,g=g||O.email||O.correo||g,p=p||O.logoUrl||O.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const O=await fetch(String(p),{mode:"cors"});if(O.ok){const te=await O.blob(),me=await new Promise(we=>{const Te=new FileReader;Te.onloadend=()=>{we(typeof Te.result=="string"?Te.result:null)},Te.onerror=()=>{we(null)},Te.readAsDataURL(te)});me&&(p=me)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",_=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",x=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let O=o.caiInfo||null;if(!O&&typeof window<"u"){const te=window.localStorage.getItem("caiInfo");if(te)try{O=JSON.parse(te)}catch{O=null}}if(O&&(v=v||O.cai||O.CAI||"",_=_||O.fecha_vencimiento||O.fecha_limite_emision||"",x=x||O.rango_de||O.rangoDesde||"",b=b||O.rango_hasta||O.rangoHasta||"",w=w||O.identificador||"",!m))try{const te=O.identificador?String(O.identificador):"",me=O.secuencia_actual!=null?String(O.secuencia_actual):O.rango_de!=null?String(O.rango_de):"",we=String(me).replace(/[^0-9]/g,"")||"";let Te=0;(O.rango_hasta||O.rango_de)&&(Te=Math.max(String(O.rango_hasta||O.rango_de).length,we.length));const ke=we?String(we).padStart(Te||we.length||1,"0"):"";m=(te||"")+(ke||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const A=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),R=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||r.identidad||"C/F",T=new Date().toLocaleString(),I=Array.isArray(r.carrito)?r.carrito:[],B=typeof r.subtotal=="number"?r.subtotal:I.reduce((O,te)=>O+Number(te.producto&&te.producto.precio||te.precio||0)*(te.cantidad||1),0),K=typeof r.descuento=="number"?r.descuento:0,E=typeof r.exonerado=="number"?r.exonerado:0,M=typeof r.gravado=="number"?r.gravado:B,L=typeof r.exento=="number"?r.exento:0,V=typeof r.isvTotal=="number"?r.isvTotal:0,ye=typeof r.imp18Total=="number"?r.imp18Total:0,Q=typeof r.impTouristTotal=="number"?r.impTouristTotal:0,fe=typeof r.total=="number"?r.total:null,xe=B+(V||0)+(ye||0)+(Q||0),q=fe??xe,X=q,W=r.pagos||{},C=typeof W.efectivo=="number"?W.efectivo:typeof r.Efectivo=="number"?r.Efectivo:0,U=typeof W.tarjeta=="number"?W.tarjeta:typeof r.Tarjeta=="number"?r.Tarjeta:0,ee=typeof W.transferencia=="number"?W.transferencia:typeof r.Transferencia=="number"?r.Transferencia:0,ge=typeof W.totalPaid=="number"?W.totalPaid:C+U+ee;let pe;if(typeof W.cambio=="number")pe=W.cambio;else if(typeof r.cambio=="number")pe=r.cambio;else{const O=Number(ge)-Number(X||0);pe=isNaN(O)?0:O>0?O:0}const D=I.map(O=>{const te=String(O.producto&&(O.producto.nombre||O.producto.descripcion)||O.descripcion||O.nombre||""),me=Number(O.cantidad||0),we=Number((O.producto&&(O.producto.precio??O.producto.precio_unitario))??O.precio_unitario??O.precio??0),Te=!!(O.producto&&O.producto.exento)||!!O.exento,ke=!!(O.producto&&O.producto.aplica_impuesto_18)||!!O.aplica_impuesto_18,Le=!!(O.producto&&O.producto.aplica_impuesto_turistico)||!!O.aplica_impuesto_turistico,$e=ke?r.tax18Rate??r.tax18??0:r.taxRate??r.tax??0,ut=Le?r.taxTouristRate??r.taxTourist??0:0,mt=(Number($e)||0)+(Number(ut)||0);let dt=we;!Te&&mt>0&&(dt=we/(1+mt));const wt=Number(dt||0).toFixed(2),Ht=dt*me,ot=Number(Ht||0).toFixed(2);return`<tr><td>${O.producto&&O.producto.sku||O.sku||""} ${te}</td><td style="text-align:center">${me}</td><td style="text-align:right">L ${wt}</td><td style="text-align:right">L ${ot}</td></tr>`}).join(`
`),P=(Number(C)||0)+(Number(ee)||0)+(Number(U)||0)-(Number(pe)||0),J=isNaN(P)?0:P,he=d_(J);return`<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Factura Cinta</title>

<style>
    body {
        font-family: monospace;
        font-size: 12px;
        width: 260px; /* tamao para impresora trmica 58mm */
        margin: 0 auto;
        padding: 0;
    }

    .center { text-align: center; }
    .line { border-top: 1px dashed #000; margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 2px 0; }
    th { border-bottom: 1px solid #000; }
    .right { text-align: right; }
    .left { text-align: left; }
    .bold { font-weight: bold; }
</style>
</head>

<body>

<div class="center">
    <img src="${p}" alt="logo" style="width:120px; height:auto;" />
</div>

<div class="center bold">FACTURA</div>
<div class="center">No. ${m}</div>

<div class="line"></div>

<div class="center bold">${l}</div>
<p>RTN: ${u}</p>
<p>Direccin: ${d}</p>
<p>Tel: ${h}</p>
<p>Email: ${g}</p>

<div class="line"></div>

<p>Fecha/Hora: ${T}</p>
<p>CAI: ${v}</p>
<p>F. Lmite: ${_}</p>
<p>Rango:  
${w?w+" "+x+" al "+w+" "+b:x+" al "+b}</p>

<div class="line"></div>

<p>Cliente: ${A}</p>
<p>RTN Cliente: ${R}</p>

<div class="line"></div>

<table>
    <thead>
        <tr>
            <th class="left">Descripcin</th>
            <th class="right">Cant</th>
            <th class="right">P.U</th>
            <th class="right">Total</th>
        </tr>
    </thead>
    <tbody>
        ${D}
    </tbody>
</table>

<div class="line"></div>

<p>Descuento: <span class="right">L ${K.toFixed(2)}</span></p>
<p>SubT Exonerado: <span class="right">L ${Number(E).toFixed(2)}</span></p>
<p>SubT Gravado: <span class="right">L ${Number(M).toFixed(2)}</span></p>
<p>SubT Exento: <span class="right">L ${Number(L).toFixed(2)}</span></p>
<p>Tasa Turstica 4%: <span class="right">L ${Number(Q).toFixed(2)}</span></p>
<p>ISV 15%: <span class="right">L ${Number(V).toFixed(2)}</span></p>
<p>ISV 18%: <span class="right">L ${Number(ye).toFixed(2)}</span></p>

<div class="line"></div>

<p class="bold">TOTAL TRANSACCIN:
   <span class="right bold">L ${Number(q).toFixed(2)}</span>
</p>

<div class="line"></div>

<p class="bold">TOTAL FACTURA :
   <span class="right bold">L ${X.toFixed(2)}</span>
</p>

<p>Efectivo: <span class="right">L ${Number(C).toFixed(2)}</span></p>
<p>Tarjeta: <span class="right">L ${Number(U).toFixed(2)}</span></p>
<p>Transferencia: <span class="right">L ${Number(ee).toFixed(2)}</span></p>
<p>Cambio: <span class="right">L ${Number(pe).toFixed(2)}</span></p>

<div class="line"></div>

<div class="center">
    <p>Total Pagado: L ${J.toFixed(2)}</p>
    <p>*** ${he} Lempiras ***</p>
</div>

<div class="line"></div>

<p>Firma Cliente: ____________________</p>
<p>Firma Emisor: _____________________</p>

<div class="center">
    <p>Original: Cliente</p>
    <p>Copia: Obligado tributario emisor</p>
</div>

<div class="center">
    <p>Para cualquier reclamo debe<br/>presentar su factura</p>
    <p>Gracias por su compra!</p>
    <p>LA FACTURA ES BENEFICIO DE TODOS,<br/>EXJALA!</p>
</div>

</body>
</html>
`}function d_(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],r=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const _=Math.floor(v/10),x=v%10;return r[_]+(x?" y "+a[x]:"")}if(v<1e3){const _=Math.floor(v/100),x=v%100;return(_===1&&x===0?"cien":l[_]||"")+(x?" "+u(x):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let _=u(v);m===2&&v===1&&(_="un"),h.unshift(_+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}function f_({onLogout:o}){S.useEffect(()=>{const H=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=H||""}},[]);const[a,r]=S.useState([]),[l,u]=S.useState([]),[d,h]=S.useState(""),[g,p]=S.useState("Todas"),[m,v]=S.useState(.15),[_,x]=S.useState(0),[b,w]=S.useState(0),A=["Todas",...Array.from(new Set(a.map(H=>H.categoria)))],R=a.filter(H=>(String(H.nombre||"").toLowerCase().includes(d.toLowerCase())||String(H.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||H.categoria===g)),T=l.reduce((H,ie)=>H+Number(ie.producto.precio||0)*ie.cantidad,0);let I=0,B=0,K=0;for(const H of l){const ie=Number(H.producto.precio||0)*H.cantidad,_e=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,be=!!H.producto.aplica_impuesto_turistico;if(_e)continue;const ve=oe?_||0:m||0,se=be&&b||0,je=(Number(ve)||0)+(Number(se)||0);if(je<=0)continue;const ue=ie-ie/(1+je);oe?B+=ue*(ve/je):I+=ue*(ve/je),be&&(K+=ue*(se/je))}const E=T,M=Math.max(0,T-(I+B+K)),L=l.map(H=>{const ie=Number(H.producto.precio||0)*H.cantidad,_e=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,be=!!H.producto.aplica_impuesto_turistico;if(_e)return{id:H.producto.id,nombre:H.producto.nombre,price:ie,isv:0,imp18:0,tur:0,totalTax:0};const ve=oe?_||0:m||0,se=be&&b||0,je=(Number(ve)||0)+(Number(se)||0);if(je<=0)return{id:H.producto.id,nombre:H.producto.nombre,price:ie,isv:0,imp18:0,tur:0,totalTax:0};const ue=ie-ie/(1+je),ne=oe?0:ue*(ve/je),Oe=oe?ue*(ve/je):0,Ne=be?ue*(se/je):0;return{id:H.producto.id,nombre:H.producto.nombre,price:ie,isv:ne,imp18:Oe,tur:Ne,totalTax:ne+Oe+Ne}}),V=H=>{const ie=Number(H.stock??0),_e=Number(H.precio??0);ie<1||_e<=0||u(oe=>oe.find(ve=>ve.producto.id===H.id)?oe.map(ve=>ve.producto.id===H.id?{...ve,cantidad:ve.cantidad+1}:ve):[...oe,{producto:H,cantidad:1}])},ye=(H,ie)=>{u(_e=>_e.map(oe=>{if(String(oe.producto.id)===String(H)){const be=oe.cantidad+ie;return be>0?{...oe,cantidad:be}:oe}return oe}).filter(oe=>oe.cantidad>0))},Q=H=>{u(ie=>ie.filter(_e=>String(_e.producto.id)!==String(H)))},fe=()=>u([]),[xe,q]=S.useState(!1),[X,W]=S.useState("factura"),[C,U]=S.useState(!1),[ee,ge]=S.useState(null),[pe,N]=S.useState(null),[D,P]=S.useState(!1),[J,he]=S.useState(!1),[le,O]=S.useState(""),[te,me]=S.useState(""),we=S.useRef(null),Te=S.useRef(null),[ke,Le]=S.useState("final"),[$e,ut]=S.useState(""),[mt,dt]=S.useState(""),[wt,Ht]=S.useState(!1),[ot,Ze]=S.useState(!1),[Ua,oi]=S.useState(!1),[Gt,ir]=S.useState(!1),[rr,ci]=S.useState(null),[ui,cs]=S.useState(!1),[sr,Hl]=S.useState("carta"),$l=async H=>{if(me(H),!H||String(H).trim()===""){O("");return}try{if(ke==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",H);const{data:be,error:ve}=await ae.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",H).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:be,error:ve}),!ve&&be&&be.nombre){O(be.nombre||""),ut(be.telefono||""),dt(be.correo_electronico||""),Ht(!!be.exonerado),setTimeout(()=>{try{Te.current?.focus()}catch{}},50);return}else{O(""),ut(""),dt(""),Ht(!1);return}}const ie="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",H);const{data:_e,error:oe}=await ae.from(ie).select("nombre").eq("rtn",H).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:_e,error:oe}),!oe&&_e&&_e.nombre?(O(_e.nombre||""),setTimeout(()=>{try{Te.current?.focus()}catch{}},50)):O("")}catch(ie){console.warn("Error buscando cliente por RTN:",ie)}},za=H=>{if(H==="cotizacion"){W("cotizacion"),q(!0);return}W(H),q(!0)},Kt=async(H={})=>{try{if(!l||l.length===0)return null;const ie=tn(),_e=I,oe=B,be=K,ve=Number(_e||0)+Number(oe||0)+Number(be||0),se=ie+ve;let je=H.cliente_id??null;if(!je&&H.rtn)try{const{data:ht,error:rt}=await ae.from("clientes").select("id").eq("rtn",H.rtn).maybeSingle();!rt&&ht&&ht.id&&(je=ht.id)}catch{}const ue=ra||"system",ne=String(Math.floor(Math.random()*9e5)+1e5),Oe={cliente_id:je,usuario:ue,numero_cotizacion:ne,validez_dias:30,subtotal:ie,impuesto:ve,total:se,estado:"pendiente"};let Ne=H.cotizacion_id??pe;if(Ne){const ht={cliente_id:Oe.cliente_id||null,usuario:Oe.usuario,validez_dias:Oe.validez_dias,subtotal:Oe.subtotal,impuesto:Oe.impuesto,total:Oe.total,estado:Oe.estado},{error:rt}=await ae.from("cotizaciones").update(ht).eq("id",Ne);if(rt)return console.warn("Error actualizando cotizacion:",rt),null}else{const{data:ht,error:rt}=await ae.from("cotizaciones").insert([Oe]).select("id").maybeSingle();if(rt)return console.warn("Error insertando cotizacion:",rt),null;if(Ne=ht?.id||null,!Ne)return null}const Me=l.map(ht=>{const rt=Number(ht.producto.precio||0),st=Number(ht.cantidad||0),Dt=!!ht.producto.exento,bt=!!ht.producto.aplica_impuesto_18,gi=!!ht.producto.aplica_impuesto_turistico,ps=Dt||bt?0:rt*(m||0)*st,Ba=Dt?0:bt?rt*(_||0)*st:0,sa=Dt?0:gi?rt*(b||0)*st:0,rn=rt*st,De=rn+ps+Ba+sa;return{cotizacion_id:Ne,producto_id:ht.producto.id||null,descripcion:ht.producto.nombre||"",cantidad:st,precio_unitario:rt,subtotal:rn,descuento:0,total:De}});try{await ae.from("cotizaciones_detalle").delete().eq("cotizacion_id",Ne)}catch{}const{error:an}=await ae.from("cotizaciones_detalle").insert(Me);return an?console.warn("Error insertando cotizaciones_detalle:",an):console.debug("Cotizacion guardada id=",Ne),Ne}catch(ie){return console.warn("Error guardando cotizacion:",ie),null}},tn=()=>{const H=l.reduce((be,ve)=>be+Number(ve.producto.precio||0)*ve.cantidad,0);let ie=0,_e=0,oe=0;for(const be of l){const ve=Number(be.producto.precio||0)*be.cantidad,se=!!be.producto.exento,je=!!be.producto.aplica_impuesto_18,ue=!!be.producto.aplica_impuesto_turistico;if(se)continue;const ne=je?_||0:m||0,Oe=ue&&b||0,Ne=(Number(ne)||0)+(Number(Oe)||0);if(Ne<=0)continue;const Me=ve-ve/(1+Ne);je?_e+=Me*(ne/Ne):ie+=Me*(ne/Ne),ue&&(oe+=Me*(Oe/Ne))}return Math.max(0,H-(ie+_e+oe))},Yt=()=>l.reduce((H,ie)=>H+(ie.producto.exento?0:Number(ie.producto.precio||0)*ie.cantidad),0),Vl=async()=>{Le("final"),O("Consumidor Final"),me("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),cs(!0),oi(!0),q(!1)},Pl=()=>{Le("normal"),O(""),me(""),ir(!1),ci(null),P(!0),q(!1)},Gl=()=>{Le("juridico"),O(""),me(""),ir(!1),ci(null),P(!0),q(!1)},di=async(H,ie,_e)=>{const be=await(sr==="cinta"?u_:rp)({cliente:H,rtn:ie},X,{carrito:l,subtotal:tn(),isvTotal:I,imp18Total:B,impTouristTotal:K,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,pagos:_e});if(X==="factura"&&pe)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",pe);const{error:se}=await ae.from("cotizaciones").update({estado:"aceptada"}).eq("id",pe);if(se)console.warn("Error marcando cotizacion (pre-print):",se);else try{N(null)}catch{}}catch(se){console.warn("Error marcacion pre-print:",se)}if(X==="factura")try{let se=null,je=null;try{const ue=localStorage.getItem("user"),ne=ue?JSON.parse(ue):null;je=ne&&(ne.id||ne.user?.id||ne.sub||ne.user_id)?ne.id||ne.user?.id||ne.sub||ne.user_id:null;const Oe=ne&&(ne.username||ne.user?.username||ne.name||ne.user?.name)?ne.username||ne.user?.username||ne.name||ne.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",ue),console.debug("PV: CAI lookup - parsed user object:",ne),console.debug("PV: CAI lookup - extracted userId:",je,"typeof",typeof je),console.debug("PV: CAI lookup - extracted userNameFromStorage:",Oe),je){const Ne=typeof je=="string"&&/^\d+$/.test(je)?Number(je):je;try{const{data:Me,error:an}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Ne).order("id",{ascending:!1}).limit(1);!an&&Array.isArray(Me)&&Me.length>0&&(se=Me[0])}catch(Me){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Me)}}if(!se&&Oe)try{const{data:Ne,error:Me}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",Oe).order("id",{ascending:!1}).limit(1);!Me&&Array.isArray(Ne)&&Ne.length>0&&(se=Ne[0])}catch(Ne){console.debug("PV: CAI lookup by cajero failed:",Ne)}}catch(ue){console.debug("No se pudo cargar CAI desde frontend:",ue)}await Da({clienteName:H,rtn:ie,paymentPayload:_e,caiData:se,usuarioId:je})}catch(se){console.warn("Error preparando venta antes de imprimir:",se),alert("Error preparando venta antes de imprimir: "+String(se))}const ve=window.open("","_blank");if(ve){ve.document.open(),ve.document.write(be),ve.document.close();const se=()=>{try{ve.focus(),ve.print()}catch(ue){console.warn("Error during print (finalize):",ue)}setTimeout(()=>{try{ve.close()}catch{}},800)},je=()=>{try{const ue=ve.document.images;if(ue&&ue.length>0){let ne=0;for(let Oe=0;Oe<ue.length;Oe++){const Ne=ue[Oe];Ne.complete?ne++:(Ne.addEventListener("load",()=>{ne++,ne===ue.length&&se()}),Ne.addEventListener("error",()=>{ne++,ne===ue.length&&se()}))}ne===ue.length&&se()}else se()}catch{try{ve.addEventListener("load",se)}catch{}setTimeout(se,1e3)}};try{ve.document.readyState==="complete"?je():(ve.addEventListener("load",je),setTimeout(je,1500))}catch{setTimeout(je,800)}}X==="factura"&&(fe(),await La()),X==="cotizacion"&&(ge({cliente:H,rtn:ie}),U(!0))},Da=async({clienteName:H,rtn:ie,paymentPayload:_e,caiData:oe,usuarioId:be})=>{if(!l||l.length===0)return null;const ve=_e&&_e.tipoPagoString?String(_e.tipoPagoString):"",se=_e&&_e.totalPaid?Number(_e.totalPaid||0):0,je=se>Number(E||0)?se-Number(E||0):0;let ue=String(Math.floor(Math.random()*9e5)+1e5);const ne=mn||oe||null;let Oe=null,Ne=0,Me=null,an=null;if(ne&&(ne.rango_de!==void 0||ne.secuencia_actual!==void 0))try{const De=ne.rango_de!=null?String(ne.rango_de):"",Ve=ne.rango_hasta!=null?String(ne.rango_hasta):"",Et=ne.secuencia_actual!=null?String(ne.secuencia_actual):"",qe=Number(String(De).replace(/[^0-9]/g,""))||0,tt=Number(String(Ve).replace(/[^0-9]/g,""))||0,Ct=Number(String(Et).replace(/[^0-9]/g,""))||qe||0;Ne=Math.max((Ve||De||"").length,String(Ct).length,1),an=String(Ct).padStart(Ne,"0"),ue=(ne.identificador?String(ne.identificador):"")+an;const fr=Ct+1;Oe=fr,Me=String(fr).padStart(Ne,"0")}catch(De){console.debug("Error computing factura from caiInfoState, falling back to random:",De)}const ht={rtn:ie||null,nombre_cliente:H||null,usuario:ra||"system",factura:ue,tipo_pago:ve,subtotal:Number(M||0),impuesto:Number(I+B+K||0),total:Number(E||0),estado:"pagada",cambio:String(Number(je).toFixed(2)),cai:ne?.cai??null,rango_desde:(ne&&ne.identificador?String(ne.identificador):"")+(ne?.rango_de!=null?String(ne.rango_de):"")||null,rango_hasta:(ne&&ne.identificador?String(ne.identificador):"")+(ne?.rango_hasta!=null?String(ne.rango_hasta):"")||null,fecha_limite_emision:ne?.fecha_vencimiento??ne?.fecha_limite_emision??null};let rt=null,st=null;try{const De=await ae.from("ventas").insert([ht]).select("id, factura");rt=De.data??De,st=De.error??null}catch(De){st=De}if(console.debug("Insert venta response:",{ventaInsRaw:rt,ventaErr:st}),st){const De=String(st&&(st.message||st.msg||st.details)||""),Ve=st&&st.code?String(st.code):"";if(Ve==="PGRST204"||De.includes("Could not find the")||/column .* of 'ventas'/.test(De)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:De,code:Ve});const qe={...ht};delete qe.cai,delete qe.rango_desde,delete qe.rango_hasta,delete qe.fecha_limite_emision;try{const tt=await ae.from("ventas").insert([qe]).select("id, factura");if(rt=tt.data??tt,st=tt.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:rt,ventaErr:st}),st)throw st}catch(tt){throw console.error("Fallback insert also failed:",tt),tt}}else throw st}const Dt=Array.isArray(rt)?rt[0]:rt;let bt=Dt?Dt.id||Dt.id:null;if(!bt)try{const{data:De,error:Ve}=await ae.from("ventas").select("id").eq("factura",ue).maybeSingle();Ve&&console.debug("Error buscando venta por factura (fallback):",Ve),De&&De.id&&(bt=De.id)}catch(De){console.debug("fallback lookup error",De)}if(!bt)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",rt),null;const gi=l.map(De=>{const Ve=Number(De.producto.precio||0),Et=Number(De.cantidad||0),qe=Ve*Et,tt=0,Ct=qe-tt;return{venta_id:bt,factura:ue,producto_id:De.producto.id,cantidad:Et,precio_unitario:Ve,subtotal:qe,descuento:tt,total:Ct}});if(oe&&be&&(De=>typeof De=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(De))(be))try{const De=l.map(qe=>({producto_id:String(qe.producto.id),cantidad:Number(qe.cantidad||0),precio_unitario:Number(qe.producto.precio||0),subtotal:Number((Number(qe.producto.precio||0)*qe.cantidad).toFixed(6)),descuento:0,total:Number((Number(qe.producto.precio||0)*qe.cantidad).toFixed(6))})),{data:Ve,error:Et}=await ae.rpc("create_venta_with_detalle",{p_usuario_id:be,p_usuario:ra||be,p_rtn:ie||null,p_nombre_cliente:H||null,p_tipo_pago:ve,p_subtotal:Number(M||0),p_impuesto:Number(I+B+K||0),p_total:Number(E||0),p_cambio:String(Number(je).toFixed(2)),p_detalles:De});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:Ve,rpcErr:Et}),Et)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",Et);else if(Ve&&Array.isArray(Ve)&&Ve.length>0){const qe=Ve[0];try{if(ne&&ne.id!=null)try{const{data:tt,error:Ct}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",ne.id).maybeSingle();if(!Ct&&tt){ft(tt);try{localStorage.setItem("caiInfo",JSON.stringify(tt))}catch{}}}catch(tt){console.debug("Error refreshing cai after RPC:",tt)}}catch(tt){console.debug("Error during post-RPC cai refresh:",tt)}return qe.venta_id||qe.venta_id===0?qe.venta_id:bt}else if(Ve&&Ve.venta_id){try{if(ne&&ne.id!=null)try{const{data:qe,error:tt}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",ne.id).maybeSingle();if(!tt&&qe){ft(qe);try{localStorage.setItem("caiInfo",JSON.stringify(qe))}catch{}}}catch(qe){console.debug("Error refreshing cai after RPC (scalar):",qe)}}catch(qe){console.debug("Error during post-RPC cai refresh (scalar):",qe)}return Ve.venta_id}}catch(De){console.warn("Error calling RPC create_venta_with_detalle:",De)}else oe&&be&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",be);const{data:Ba,error:sa}=await ae.from("ventas_detalle").insert(gi).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:Ba,detErr:sa}),sa)throw sa;const rn=ne&&(ne.id||ne.id===0)?ne.id:null;if(rn!=null&&Oe!=null)try{const De=Me??String(Oe);try{const Ve=ne?.rango_hasta!=null?String(ne.rango_hasta):"",Et=Number(Ve.replace(/[^0-9]/g,""))||null,qe=Number(String(De).replace(/[^0-9]/g,""))||null;if(Et!=null&&qe!=null&&qe>Et)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:qe,rangoHastaNum:Et});else{const{error:tt}=await ae.from("cai").update({secuencia_actual:De}).eq("id",rn);if(tt)console.debug("Error updating cai.secuencia_actual (manual path):",tt);else{console.debug("Updated cai.secuencia_actual to",De,"for cai id",rn);try{const Ct={...ne||{},secuencia_actual:De};ft(Ct);try{localStorage.setItem("caiInfo",JSON.stringify(Ct))}catch{}}catch(Ct){console.debug("Error updating local caiInfoState/localStorage:",Ct)}}}}catch(Ve){console.debug("Validation error while checking rango_hasta:",Ve);const{error:Et}=await ae.from("cai").update({secuencia_actual:De}).eq("id",rn);if(Et)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",Et);else{console.debug("Updated cai.secuencia_actual to",De,"for cai id",rn);try{const qe={...ne||{},secuencia_actual:De};ft(qe);try{localStorage.setItem("caiInfo",JSON.stringify(qe))}catch{}}catch(qe){console.debug("Error updating local caiInfoState/localStorage (after validation):",qe)}}}}catch(De){console.debug("Exception updating cai.secuencia_actual:",De)}return bt},La=async()=>{if(X==="factura"&&pe)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",pe);const{error:H}=await ae.from("cotizaciones").update({estado:"aceptada"}).eq("id",pe);H?console.warn("Error marcando cotizacion como facturado:",H):console.debug("Cotizacion marcada como facturado:",pe)}catch(H){console.warn("Error procesando cotizacion tras facturar",H)}};S.useEffect(()=>{D&&setTimeout(()=>{try{we.current?.focus()}catch{}},80)},[D]);const Mn=async()=>{try{if(te&&le){const oe={rtn:te,nombre:le},{error:be}=await ae.from("clientenatural").upsert(oe,{onConflict:"rtn"});be&&console.warn("Error guardando clientenatural:",be)}}catch(oe){console.warn("Error upsert clientenatural:",oe)}try{if(te&&le)if(ke==="juridico"){const{data:oe,error:be}=await ae.from("clientes").select("id").eq("rtn",te).eq("tipo_cliente","juridico").maybeSingle();if(be&&console.warn("Error buscando cliente juridico:",be),oe&&oe.id){const{error:ve}=await ae.from("clientes").update({nombre:le,telefono:$e||null,correo_electronico:mt||null,exonerado:wt}).eq("id",oe.id);ve&&console.warn("Error actualizando cliente juridico:",ve)}else{const{error:ve}=await ae.from("clientes").insert([{nombre:le,rtn:te,telefono:$e||null,correo_electronico:mt||null,tipo_cliente:"juridico",exonerado:wt}]);ve&&console.warn("Error insertando cliente juridico:",ve)}}else{const oe={rtn:te,nombre:le},{error:be}=await ae.from("clientenatural").upsert(oe,{onConflict:"rtn"});be&&console.warn("Error guardando clientenatural:",be)}}catch(oe){console.warn("Error upsert cliente:",oe)}const H=await rp({cliente:le||"Cliente",rtn:te||""},X,{carrito:l,subtotal:tn(),isvTotal:I,imp18Total:B,impTouristTotal:K,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,pagos:rr});if(X==="factura"&&pe)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",pe);const{error:oe}=await ae.from("cotizaciones").update({estado:"aceptada"}).eq("id",pe);if(oe)console.warn("Error marcando cotizacion como facturado (pre-print):",oe);else{console.debug("Cotizacion marcada como facturado (pre-print):",pe);try{N(null)}catch{}}}catch(oe){console.warn("Error marcacion pre-print:",oe)}if(X==="factura")try{let oe=null,be=null;try{const ve=localStorage.getItem("user"),se=ve?JSON.parse(ve):null;be=se&&(se.id||se.user?.id||se.sub||se.user_id)?se.id||se.user?.id||se.sub||se.user_id:null;const je=se&&(se.username||se.user?.username||se.name||se.user?.name)?se.username||se.user?.username||se.name||se.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",ve),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",se),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",be,"typeof",typeof be),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",je),be){const ue=typeof be=="string"&&/^\d+$/.test(be)?Number(be):be;try{const{data:ne,error:Oe}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",ue).order("id",{ascending:!1}).limit(1);!Oe&&Array.isArray(ne)&&ne.length>0&&(oe=ne[0])}catch(ne){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",ne)}}if(!oe&&je)try{const{data:ue,error:ne}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",je).order("id",{ascending:!1}).limit(1);!ne&&Array.isArray(ue)&&ue.length>0&&(oe=ue[0])}catch(ue){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",ue)}}catch(ve){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",ve)}await Da({clienteName:le||"Cliente",rtn:te||null,paymentPayload:rr,caiData:oe,usuarioId:be})}catch(oe){console.warn("Error insertando venta en flujo cliente normal:",oe)}const ie=window.open("","_blank");if(ie){ie.document.open(),ie.document.write(H),ie.document.close();const oe=()=>{try{ie.focus(),ie.print()}catch(ve){console.warn("Error during print (cliente normal):",ve)}setTimeout(()=>{try{ie.close()}catch{}},800)},be=()=>{try{const ve=ie.document.images;if(ve&&ve.length>0){let se=0;for(let je=0;je<ve.length;je++){const ue=ve[je];ue.complete?se++:(ue.addEventListener("load",()=>{se++,se===ve.length&&oe()}),ue.addEventListener("error",()=>{se++,se===ve.length&&oe()}))}se===ve.length&&oe()}else oe()}catch{try{ie.addEventListener("load",oe)}catch{}setTimeout(oe,1e3)}};try{ie.document.readyState==="complete"?be():(ie.addEventListener("load",be),setTimeout(be,1500))}catch{setTimeout(be,800)}}await(async()=>{X==="factura"&&(fe(),await La()),X==="cotizacion"&&(ge({cliente:le||"Cliente",rtn:te||null}),U(!0))})(),P(!1)},[pn,nn]=S.useState(null),[us,ds]=S.useState([]),[lr,qn]=S.useState(!1),[Kl,fi]=S.useState(null);S.useEffect(()=>{fetch("/data-base/inventario.json").then(async H=>{if(!H.ok)return console.warn("inventario.json no disponible, status",H.status),null;const ie=H.headers.get("content-type")||"";if(!ie.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",ie),null;try{return await H.json()}catch(_e){return console.warn("Error parseando inventario.json:",_e),null}}).then(H=>{H&&Array.isArray(H.items)&&ds(H.items),console.log("inventario cargado:",H&&H.items?H.items.length:0)}).catch(H=>{console.warn("Error cargando inventario:",H)})},[]),S.useEffect(()=>{let H=!0;return(async()=>{try{const{data:ie,error:_e}=await ae.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(_e)throw _e;const oe=Array.isArray(ie)?ie:[],be=oe.map(ue=>String(ue.id));if(be.length===0){H&&r([]);return}const ve={};try{const{data:ue,error:ne}=await ae.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(ne)throw ne;if(console.debug("PV: precios total rows",Array.isArray(ue)?ue.length:0),Array.isArray(ue))for(const Oe of ue){const Ne=String(Oe.producto_id);ve[Ne]||(ve[Ne]=Number(Oe.precio||0))}}catch(ue){console.warn("Error cargando precios en PV:",ue)}let se={};try{const{data:ue,error:ne}=await ae.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",be);if(ne)throw ne;const Oe=Array.isArray(ue)?ue:[];se={},be.forEach(Ne=>se[Ne]=0);for(const Ne of Oe){const Me=String(Ne.producto_id),an=Number(Ne.cantidad)||0,ht=String(Ne.tipo_de_movimiento||"").toUpperCase();ht==="ENTRADA"?se[Me]=(se[Me]||0)+an:ht==="SALIDA"&&(se[Me]=(se[Me]||0)-an)}}catch(ue){console.warn("Error cargando registro_de_inventario en PV:",ue),se={},be.forEach(ne=>se[ne]=0)}console.debug("PV: priceMap sample",Object.keys(ve).slice(0,5).map(ue=>[ue,ve[ue]]));const je=oe.map(ue=>({id:String(ue.id),sku:ue.sku,nombre:ue.nombre,categoria:ue.categoria,imagen:ue.imagen,precio:ve[String(ue.id)]!==void 0?ve[String(ue.id)]:ue.precio!==void 0?Number(ue.precio):0,exento:ue.exento===!0||String(ue.exento)==="true"||Number(ue.exento)===1||!1,aplica_impuesto_18:ue.aplica_impuesto_18===!0||String(ue.aplica_impuesto_18)==="true"||Number(ue.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:ue.aplica_impuesto_turistico===!0||String(ue.aplica_impuesto_turistico)==="true"||Number(ue.aplica_impuesto_turistico)===1||!1,stock:Number((se[String(ue.id)]||0).toFixed(2))}));H&&r(je)}catch(ie){console.warn("Error cargando productos desde inventario:",ie),H&&r([])}})(),()=>{H=!1}},[]),S.useEffect(()=>{const H=_e=>{try{const oe=_e||(()=>{const se=localStorage.getItem("cotizacion_to_load");return se?JSON.parse(se):null})();if(!oe)return;try{N(oe.header&&oe.header.id?String(oe.header.id):null)}catch{}const ve=(Array.isArray(oe.detalles)?oe.detalles:[]).map(se=>{const je=a.find(ne=>String(ne.id)===String(se.producto_id));return{producto:je?{...je}:{id:String(se.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:se.sku??void 0,nombre:se.descripcion||se.nombre||"Artculo",precio:Number(se.precio_unitario||se.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(se.cantidad||1)}});ve.length>0&&u(ve);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};H();const ie=_e=>{try{H(_e.detail)}catch{}};return window.addEventListener("cotizacion:load",ie),()=>{window.removeEventListener("cotizacion:load",ie)}},[a]);const[ra,fs]=S.useState(null),[or,cr]=S.useState(null),[ur,hs]=S.useState(null),[mn,ft]=S.useState(null),[$t,In]=S.useState(!1),[hi,Yl]=S.useState({}),Fl=async()=>{try{let H=null;try{const ie=localStorage.getItem("user"),_e=ie?JSON.parse(ie):null;let oe=ur??(_e&&(_e.id||_e.user?.id||_e.sub||_e.user_id)?_e.id||_e.user?.id||_e.sub||_e.user_id:null);const be=ra??(_e&&(_e.username||_e.user?.username||_e.name||_e.user?.name)?_e.username||_e.user?.username||_e.name||_e.user?.name:null),ve=oe!=null&&typeof oe=="string"&&/^\d+$/.test(oe)?Number(oe):oe;if(ve!=null)try{const{data:se,error:je}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",ve).order("id",{ascending:!1}).limit(1);!je&&Array.isArray(se)&&se.length>0&&(H=se[0])}catch(se){console.debug("refreshCaiInfo: lookup by usuario_id failed:",se)}if(!H&&be)try{const{data:se,error:je}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",be).order("id",{ascending:!1}).limit(1);!je&&Array.isArray(se)&&se.length>0&&(H=se[0])}catch(se){console.debug("refreshCaiInfo: lookup by cajero failed:",se)}}catch(ie){console.debug("refreshCaiInfo: error building lookup params",ie)}if(H){ft(H);try{localStorage.setItem("caiInfo",JSON.stringify(H))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",H)}}catch(H){console.debug("refreshCaiInfo: unexpected error",H)}};S.useEffect(()=>{try{const H=localStorage.getItem("user");if(H){const ie=JSON.parse(H);fs(ie.username||ie.name||null),cr(ie.role||null);let _e=null;try{_e=ie&&(ie.id||ie.user?.id||ie.sub||ie.user_id)?ie.id||ie.user?.id||ie.sub||ie.user_id:null,hs(_e??null),console.debug("PV: localStorage.user parsed:",ie),console.debug("PV: extracted userId for CAI/RPC usage:",_e)}catch(oe){console.debug("PV: error parsing localStorage.user for debug:",oe)}try{const oe=localStorage.getItem("caiInfo");if(oe){const be=JSON.parse(oe);ft(be),console.debug("PV: loaded caiInfo from localStorage:",be),(async()=>{try{if(!(be&&be.rango_de!==void 0&&be.rango_hasta!==void 0&&be.fecha_vencimiento!==void 0&&be.secuencia_actual!==void 0)){const se=ie&&(ie.username||ie.user?.username||ie.name||ie.user?.name)?ie.username||ie.user?.username||ie.name||ie.user?.name:null,je=_e&&typeof _e=="string"&&/^\d+$/.test(_e)?Number(_e):_e;let ue=null;try{if(je!=null){const{data:ne,error:Oe}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",je).order("id",{ascending:!1}).limit(1);!Oe&&Array.isArray(ne)&&ne.length>0&&(ue=ne[0])}}catch(ne){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",ne)}if(!ue&&se)try{const{data:ne,error:Oe}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",se).order("id",{ascending:!1}).limit(1);!Oe&&Array.isArray(ne)&&ne.length>0&&(ue=ne[0])}catch(ne){console.debug("PV: refetch CAI by cajero failed:",ne)}if(ue){ft(ue);try{localStorage.setItem("caiInfo",JSON.stringify(ue))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",ue)}}}catch(ve){console.debug("PV: error trying to refresh caiInfo:",ve)}})()}}catch(oe){console.debug("PV: error parsing localStorage.caiInfo:",oe)}}}catch{}},[]),S.useEffect(()=>{let H=!0;return(async()=>{try{const{data:ie,error:_e}=await ae.from("impuesto").select("id, impuesto_venta");if(_e)throw _e;if(!ie||!Array.isArray(ie))return;const oe=je=>{const ue=ie.find(Ne=>Number(Ne.id)===je);if(!ue)return null;const ne=ue.impuesto_venta;if(ne==null)return null;const Oe=Number(ne);return Number.isNaN(Oe)?null:Oe>1?Oe/100:Oe},be=oe(1),ve=oe(2),se=oe(3);if(H){let je=be,ue=ve,ne=se;try{if((je===null||je===0)&&H){const Ne=(await ae.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Me=Ne==null?null:Number(Ne);Me!=null&&!Number.isNaN(Me)&&(je=Me>1?Me/100:Me)}if((ue===null||ue===0)&&H){const Ne=(await ae.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Me=Ne==null?null:Number(Ne);Me!=null&&!Number.isNaN(Me)&&(ue=Me>1?Me/100:Me)}if((ne===null||ne===0)&&H){const Ne=(await ae.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Me=Ne==null?null:Number(Ne);Me!=null&&!Number.isNaN(Me)&&(ne=Me>1?Me/100:Me)}}catch(Oe){console.warn("PV: fallback single-id impuesto fetch failed",Oe)}(je===null||je===0)&&(je=.15),(ue===null||ue===0)&&(ue=.18),(ne===null||ne===0)&&(ne=.04),v(je),x(ue),w(ne),console.debug("PV: impuestos raw rows",ie),console.debug("PV: resolved tax rates",{taxRate:je,tax18Rate:ue,taxTouristRate:ne})}}catch(ie){console.warn("Error cargando impuesto en PV:",ie)}})(),()=>{H=!1}},[]);const gs=H=>{console.log("openUbicacion",H,"entradasCount",us.length);let ie=null;try{ie=a.find(oe=>String(oe.sku||"")===String(H)||String(oe.id)===String(H))||null}catch{ie=null}if(ie){const oe=Number(ie.stock??0),be={id:ie.id,producto:ie.nombre||"",sku:ie.sku||"",imagen:ie.imagen||null,descripcion:ie.descripcion||"",ubicacion:ie.ubicacion||null,cantidad:oe};fi(be),qn(!0);return}const _e=us.find(oe=>oe.sku===H)||null;console.log("entrada encontrada",_e),fi(_e),qn(!0)};if(S.useEffect(()=>{let H=!0;return(async()=>{try{const ie="inventario",_e={};await Promise.all((a||[]).map(async oe=>{const be=oe.imagen;if(!be){_e[String(oe.id)]=null;return}const ve=String(be);if(ve.startsWith("http")){_e[String(oe.id)]=ve;return}let se=ve;const je=String(ve).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);je&&(se=decodeURIComponent(je[2]));try{const ue=await ae.storage.from(ie).getPublicUrl(se),ne=ue?.data?.publicUrl||ue?.data?.publicURL||null;if(ne){_e[String(oe.id)]=ne;return}}catch{}try{const ne=(await ae.storage.from(ie).createSignedUrl(se,604800))?.data?.signedUrl??null;_e[String(oe.id)]=ne}catch{_e[String(oe.id)]=null}})),H&&Yl(_e)}catch(ie){console.warn("Error resolviendo imgenes en PV",ie)}})(),()=>{H=!1}},[a]),pn){if(pn==="DevolucionCaja")return s.jsx(G0,{onBack:()=>nn(null)});if(pn==="IngresoEfectivo")return s.jsx(K0,{onBack:()=>nn(null)});if(pn==="CotizacionesGuardadas")return s.jsx(Y0,{onBack:()=>nn(null)});if(pn==="PedidosEnLinea")return s.jsx(F0,{onBack:()=>nn(null)});if(pn==="CorteCajaParcial")return s.jsx(J0,{onBack:()=>nn(null)});if(pn==="CorteCajaTotal")return s.jsx(Q0,{onBack:()=>nn(null)})}return s.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[s.jsx(t_,{userName:ra,userRole:or,userId:ur,caiInfo:mn,onLogout:o,onNavigate:H=>nn(H),onOpenDatosFactura:()=>In(!0),onPrintFormatChange:H=>Hl(H),printFormat:sr}),s.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[s.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[s.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:H=>h(H.target.value),onKeyDown:H=>{if(H.key==="Enter"){const ie=String(d||"").trim().toLowerCase();if(!ie)return;const oe=R.find(be=>String(be.sku||"").toLowerCase()===ie)||R[0];if(oe){const be=Number(oe.stock??0),ve=Number(oe.precio??0);be>=1&&ve>0?V(oe):console.debug("No se puede agregar por stock/precio",{id:oe.id,stockNum:be,precioNum:ve})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),s.jsx("select",{value:g,onChange:H=>p(H.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:A.map(H=>s.jsx("option",{value:H,children:H},H))})]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[s.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:s.jsx(W0,{productos:R,imageUrls:hi,agregarAlCarrito:V,openUbicacion:gs,thStyle:h_,tdStyle:g_,skuStyle:p_})}),s.jsx(e_,{carrito:l,actualizarCantidad:ye,eliminarDelCarrito:Q,vaciarCarrito:fe,subtotal:M,perItemTaxes:L,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,openSelector:za,btnStyle:m_})]})]}),s.jsx(i_,{open:lr,selectedEntrada:Kl,onClose:()=>{qn(!1),fi(null)},imageUrls:hi}),s.jsx(Z0,{open:Ua,totalDue:E,onClose:()=>oi(!1),onConfirm:async H=>{if(ci(H),ir(!0),ui)try{cs(!1),await di("Consumidor Final","C/F",H)}catch(ie){console.warn("Error facturando despus del pago:",ie)}oi(!1)}}),s.jsx(r_,{open:C,onClose:()=>U(!1),onCancel:()=>{U(!1),ge(null)},onSave:async()=>{U(!1);try{const H=await Kt(ee||{});H&&N(String(H))}catch(H){console.warn("Error guardando cotizacion desde confirm modal",H)}ge(null)}}),s.jsx(s_,{open:xe,onClose:()=>q(!1),doFacturaClienteFinal:Vl,doFacturaClienteNormal:Pl,doFacturaClienteJuridico:Gl,carritoLength:l.length,subtotal:tn(),taxRate:m,taxableSubtotal:Yt()}),s.jsx(l_,{open:D,onClose:()=>P(!1),clienteTipo:ke,clienteRTN:te,clienteNombre:le,clienteTelefono:$e,clienteCorreo:mt,clienteExonerado:wt,clienteSearchOpen:J,setClienteSearchOpen:H=>he(H),onRTNChange:H=>$l(H),onNombreChange:H=>O(H),onTelefonoChange:H=>ut(H),onCorreoChange:H=>dt(H),onExoneradoChange:H=>Ht(H),onCreateCliente:()=>Ze(!0),onCancel:()=>P(!1),onOpenCreateCliente:()=>Ze(!0),onOpenPayment:()=>oi(!0),paymentDone:Gt,submitClienteNormal:Mn}),s.jsx(o_,{open:ot,onClose:()=>Ze(!1),clienteRTN:te,clienteNombre:le,clienteTelefono:$e,clienteCorreo:mt,clienteExonerado:wt,onChangeRTN:H=>me(H),onChangeNombre:H=>O(H),onChangeTelefono:H=>ut(H),onChangeCorreo:H=>dt(H),onChangeExonerado:H=>Ht(H),onCreate:async()=>{try{if(!le||!te)return;const{data:H,error:ie}=await ae.from("clientes").select("id").eq("rtn",te).maybeSingle();if(ie&&console.warn("Error buscando cliente al crear:",ie),H&&H.id){const{error:_e}=await ae.from("clientes").update({nombre:le,telefono:$e||null,correo_electronica:mt||null,tipo_cliente:"juridico",exonerado:wt}).eq("id",H.id);_e&&console.warn("Error actualizando cliente al crear:",_e)}else{const{error:_e}=await ae.from("clientes").insert([{nombre:le,rtn:te,telefono:$e||null,correo_electronica:mt||null,tipo_cliente:"juridico",exonerado:wt}]);_e&&console.warn("Error insertando cliente al crear:",_e)}}catch(H){console.warn("Error creando cliente juridico:",H)}Ze(!1)}}),s.jsx(a_,{open:$t,onClose:()=>In(!1),caiInfo:mn,onRefresh:Fl})]})}const h_={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},g_={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},p_={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},m_={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},sp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function y_({title:o,children:a}){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:o}),s.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function v_(){const[o,a]=S.useState(null);return S.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(r=>r.json()).then(r=>a(r)).catch(()=>a(null))},[]),s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),s.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[s.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[s.jsx("h3",{children:"Ventas (ltimos das)"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),s.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[s.jsx("h3",{children:"Flujo de caja"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),s.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[s.jsx("h3",{children:"Inventario por categora"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),s.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[s.jsx("h3",{children:"Promedios"}),s.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):s.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const b_="modulepreload",__=function(o){return"/"+o},lp={},Tn=function(a,r,l){let u=Promise.resolve();if(r&&r.length>0){let m=function(v){return Promise.all(v.map(_=>Promise.resolve(_).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};var h=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(r.map(v=>{if(v=__(v),v in lp)return;lp[v]=!0;const _=v.endsWith(".css"),x=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${x}`))return;const b=document.createElement("link");if(b.rel=_?"stylesheet":b_,_||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),_)return new Promise((w,A)=>{b.addEventListener("load",w),b.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function im({open:o,title:a="Confirmado",message:r="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:h="Cancelar"}){return o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:s.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[s.jsx("h3",{style:{marginTop:0},children:a}),s.jsx("div",{style:{marginTop:8,color:"#334155"},children:r}),s.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[s.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:h}),s.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function x_(){const[o,a]=S.useState(null),[r,l]=S.useState(!1),[u,d]=S.useState(!1),[h,g]=S.useState({}),[p,m]=S.useState(null),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,A]=S.useState(!1),[R,T]=S.useState(null),[I,B]=S.useState(null),[K,E]=S.useState(!1),[M,L]=S.useState(""),[V,ye]=S.useState(""),[Q,fe]=S.useState(null),[xe,q]=S.useState(null);S.useEffect(()=>{let D=!0;return(async()=>{l(!0);try{const P=(await Tn(async()=>{const{default:le}=await Promise.resolve().then(()=>Cn);return{default:le}},void 0)).default,{data:J,error:he}=await P.from("empresa").select("*").limit(1).single();if(!D)return;if(he)throw he;if(J){a(J),g(J);try{localStorage.setItem("companyData",JSON.stringify(J))}catch{}l(!1);return}}catch(P){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",P)}try{const P=localStorage.getItem("companyData");if(P){a(JSON.parse(P)),g(JSON.parse(P)),l(!1);return}}catch{}try{const P=await fetch("/data-base/company.json");if(!P.ok)throw new Error("no json");const J=await P.json();if(!D)return;a(J),g(J)}catch{D&&a(null)}finally{D&&l(!1)}})(),()=>{D=!1}},[]),S.useEffect(()=>{o&&g(o)},[o]),S.useEffect(()=>{try{const D=localStorage.getItem("pendingCompanySave");if(D){const P=JSON.parse(D);_(!0),b(P.payload??null),A(!!P.needsLogo)}}catch{}},[]),S.useEffect(()=>{let D=!0;return(async()=>{try{if(!o||!o.logo){D&&fe(null);return}const P=String(o.logo);if(P.startsWith("http")){D&&fe(P);return}const J=(await Tn(async()=>{const{default:we}=await Promise.resolve().then(()=>Cn);return{default:we}},void 0)).default,he="logo",O=(await J.storage.from(he).getPublicUrl(P))?.data?.publicUrl??null;if(O){D&&fe(O);return}const me=(await J.storage.from(he).createSignedUrl(P,3600))?.data?.signedUrl??null;if(me){D&&fe(me);return}D&&fe(null)}catch(P){console.warn("Error resolving company logo URL",P),D&&fe(null)}})(),()=>{D=!1}},[o?.logo]),S.useEffect(()=>{let D=!0;return(async()=>{try{if(p){D&&q(p);return}const P=h?.logo;if(!P){D&&q(null);return}const J=String(P);if(J.startsWith("http")){D&&q(J);return}const he=(await Tn(async()=>{const{default:Te}=await Promise.resolve().then(()=>Cn);return{default:Te}},void 0)).default,le="logo",te=(await he.storage.from(le).getPublicUrl(J))?.data?.publicUrl??null;if(te){D&&q(te);return}const we=(await he.storage.from(le).createSignedUrl(J,3600))?.data?.signedUrl??null;if(we){D&&q(we);return}D&&q(null)}catch(P){console.warn("Error resolving edit logo URL",P),D&&q(null)}})(),()=>{D=!1}},[h?.logo,p]);function X(){d(!0),g(o||{})}function W(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function C(D){const{name:P,value:J}=D.target;g(he=>({...he,[P]:J}))}function U(D){const P=D.target.files?.[0]??null;if(g(J=>({...J,logoFile:P})),P)try{const J=URL.createObjectURL(P);m(J)}catch{m(null)}else m(null)}function ee(D=!1){const P="logo",J="https://sqwqlvsjtimallidxrsz.supabase.co";if(D){if(p)return p;const O=h?.logo;if(!O)return"/logo192.png";if(String(O).startsWith("http"))return String(O);let te=String(O);return te.startsWith(`${P}/`)&&(te=te.slice(P.length+1)),`${J}/storage/v1/object/public/${P}/${encodeURIComponent(te)}`}if(!o)return"/logo192.png";const he=o.logo;if(!he)return"/logo192.png";if(String(he).startsWith("http"))return String(he);let le=String(he);return le.startsWith(`${P}/`)&&(le=le.slice(P.length+1)),`${J}/storage/v1/object/public/${P}/${encodeURIComponent(le)}`}async function ge(){try{const D=(await Tn(async()=>{const{default:te}=await Promise.resolve().then(()=>Cn);return{default:te}},void 0)).default,P={...h||{}};let J=null;const he=te=>{if(!te)return null;if(!te.startsWith("http"))return te;const me=te.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return me?decodeURIComponent(me[2]):null},le=o?.logo??null;try{const te=h&&h.logoFile instanceof File?h.logoFile:null,me="logo";if(te){const Te=`logo/${P.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${te.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,ke=await D.storage.from(me).upload(Te,te,{upsert:!0});if(ke.error)throw ke.error;const Le=ke.data?.path??Te;J=Le,P.logo=Le}}catch(te){console.warn("Logo upload error",te)}try{P.logoFile&&delete P.logoFile}catch{}let O=null;try{if(o&&o.id){const{data:te,error:me}=await D.from("empresa").update(P).eq("id",o.id).select("*");if(me)throw me;O=Array.isArray(te)?te[0]??null:te}else{const{data:te,error:me}=await D.from("empresa").insert(P).select("*");if(me)throw me;O=Array.isArray(te)?te[0]??null:te}try{if(J){const te=he(le);if(te&&te!==J){const we=await D.storage.from("logo").remove([te]);we.error&&console.warn("Failed to remove old company logo after DB update",we.error)}}}catch(te){console.warn("Error removing old logo after DB success",te)}}catch(te){try{if(J){const we=await D.storage.from("logo").remove([J]);we.error&&console.warn("Failed to remove uploaded logo after DB error",we.error)}}catch(me){console.warn("Error cleaning uploaded logo after DB failure",me)}throw te}a(O),g(O);try{console.debug("Empresa guardada, logo field:",O?.logo)}catch{}try{B(O?.logo??null)}catch{}try{L("Datos guardados"),ye("Los datos de la empresa se guardaron correctamente."),E(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(O))}catch{}d(!1)}catch(D){console.error("Error guardando empresa en Supabase",D);try{T(D?.message||String(D))}catch{}try{const P={...h||{}};P.logoFile&&delete P.logoFile;const J=!!(h&&h.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:P,needsLogo:J,ts:Date.now()})),_(!0),b(P),A(J),a(h);try{localStorage.setItem("companyData",JSON.stringify(h))}catch{}d(!1),L("Guardado localmente"),ye("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),E(!0)}catch(P){console.error("Error saving locally",P)}}}async function pe(){const D=x;if(!D){L("Sin pendientes"),ye("No hay datos pendientes para enviar"),E(!0);return}try{const P=(await Tn(async()=>{const{default:he}=await Promise.resolve().then(()=>Cn);return{default:he}},void 0)).default;let J=null;if(D.id){const{data:he,error:le}=await P.from("empresa").update(D).eq("id",D.id).select("*");if(le)throw le;J=Array.isArray(he)?he[0]??null:he}else{const{data:he,error:le}=await P.from("empresa").insert(D).select("*");if(le)throw le;J=Array.isArray(he)?he[0]??null:he}localStorage.removeItem("pendingCompanySave"),_(!1),b(null),A(!1),a(J),g(J),L("Sincronizado"),ye("Los datos pendientes se sincronizaron con Supabase correctamente."),E(!0)}catch(P){console.error("Error reenviando datos pendientes",P),L("Error al reenviar"),ye("No se pudo reenviar los datos a Supabase: "+(P?.message||String(P))),E(!0)}}function N(){try{localStorage.removeItem("pendingCompanySave"),_(!1),b(null),A(!1),L("Pendiente descartado"),ye("El guardado pendiente fue descartado."),E(!0)}catch{}}return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),r?s.jsx("div",{children:"Cargando datos de la empresa..."}):o?s.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[s.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?s.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[s.jsxs("div",{style:{flex:1},children:[s.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",R?s.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(R)]}):null,w?s.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{className:"btn-primary",onClick:pe,children:"Reintentar guardar en Supabase"}),s.jsx("button",{className:"btn-opaque",onClick:N,children:"Descartar pendiente"})]})]})}):null,I?s.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[s.jsx("strong",{children:"Logo guardado:"}),s.jsxs("div",{style:{marginTop:6},children:[s.jsx("a",{href:ee(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),s.jsx("div",{style:{color:"#374151",fontSize:12},children:String(I)})]})]}):null,s.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[s.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:s.jsx("img",{src:u?xe??ee(!0):Q??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),s.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),s.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"RTN:"})," ",u?s.jsx("input",{name:"rtn",value:h.rtn||"",onChange:C,className:"input"}):o.rtn]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Telfono:"})," ",u?s.jsx("input",{name:"telefono",value:h.telefono||"",onChange:C,className:"input"}):o.telefono]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Correo:"})," ",u?s.jsx("input",{name:"email",value:h.email||"",onChange:C,className:"input"}):o.email]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Direccin:"})," ",u?s.jsx("textarea",{name:"direccion",value:h.direccion||"",onChange:C,className:"input",style:{minHeight:64}}):o.direccion]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("strong",{children:"Logo (archivo o URL):"}),u?s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[s.jsx("input",{type:"file",accept:"image/*",onChange:U}),s.jsx("input",{name:"logo",value:h.logo||"",onChange:C,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):s.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?s.jsxs("div",{style:{marginTop:8},children:[s.jsx("small",{children:"Preview:"}),s.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),s.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:ge,className:"btn-primary",children:"Guardar"}),s.jsx("button",{type:"button",onClick:W,className:"btn-opaque",children:"Cancelar"})]}):s.jsx(s.Fragment,{children:s.jsx("button",{type:"button",onClick:X,className:"btn-primary",children:"Actualizar datos"})})})]}),s.jsx("div",{style:{flex:1,minWidth:320},children:s.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[s.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:s.jsx("img",{src:u?xe??ee(!0):Q??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),s.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),s.jsxs("p",{style:{margin:0},children:["RTN: ",s.jsx("strong",{children:o.rtn})]}),s.jsxs("p",{style:{margin:0},children:["Telfono: ",s.jsx("strong",{children:o.telefono})]}),s.jsxs("p",{style:{marginTop:8},children:["Correo: ",s.jsx("strong",{children:o.email})]}),s.jsxs("p",{style:{marginTop:8},children:["Direccin: ",s.jsx("strong",{children:o.direccion})]})]})})]}):s.jsx("div",{children:"No se encontraron datos de la empresa."}),s.jsx(im,{open:K,title:M,message:V,onClose:()=>E(!1)})]})}function j_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),s.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function S_(){const[o,a]=S.useState([]),[r,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[x,b]=S.useState(""),[w,A]=S.useState(null),[R,T]=S.useState(""),[I,B]=S.useState(""),[K,E]=S.useState("");async function M(){l(!0),d(null);try{const{data:q,error:X}=await ae.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(X)throw X;a(Array.isArray(q)?q:[])}catch(q){d(q?.message||String(q)),a([])}finally{l(!1)}}async function L(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const q={username:p,password:v,role:"cajero"};x&&(q.nombre_usuario=x);const{error:X}=await ae.from("users").insert(q);if(X)throw X;m(""),_(""),b(""),await M()}catch(q){d(q?.message||String(q))}finally{l(!1)}}function V(q){A(q.id),T(q.username||""),E(q.nombre_usuario||""),B(""),d(null)}function ye(){A(null),T(""),B(""),E(""),d(null)}async function Q(){if(w!=null){if(!R)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const q={username:R};I&&(q.password=I),q.nombre_usuario=K||null;const{error:X}=await ae.from("users").update(q).eq("id",w);if(X)throw X;ye(),await M()}catch(q){d(q?.message||String(q))}finally{l(!1)}}}async function fe(q,X){if(X!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:W}=await ae.from("users").delete().eq("id",q);if(W)throw W;await M()}catch(W){d(W?.message||String(W))}finally{l(!1)}}}S.useEffect(()=>{let q=!0;return(async()=>q&&await M())(),()=>{q=!1}},[]);const xe=o.filter(q=>{if(!h)return!0;const X=h.toLowerCase();return(q.username||"").toLowerCase().includes(X)||(String(q.id)||"").includes(X)||(q.role||"").toLowerCase().includes(X)||(q.nombre_usuario||"").toLowerCase().includes(X)});return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[s.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:h,onChange:q=>g(q.target.value),style:{minWidth:220}}),s.jsx("button",{onClick:()=>M(),className:"btn-opaque",children:"Recargar"}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${xe.length} usuarios`}),s.jsx("div",{style:{width:"100%",height:8}}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:q=>m(q.target.value)}),s.jsx("input",{placeholder:"Nombre",className:"input",value:x,onChange:q=>b(q.target.value)}),s.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:q=>_(q.target.value)}),s.jsx("button",{onClick:()=>L(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?s.jsx("div",{style:{color:"red",marginBottom:12},children:u}):s.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Usuario"}),s.jsx("th",{children:"Nombre"}),s.jsx("th",{children:"Rol"})]})}),s.jsx("tbody",{children:xe.map(q=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:80},children:q.id}),s.jsx("td",{style:{minWidth:180},children:w===q.id?s.jsx("input",{className:"input",value:R,onChange:X=>T(X.target.value)}):q.username||"-"}),s.jsx("td",{style:{minWidth:180},children:w===q.id?s.jsx("input",{className:"input",value:K,onChange:X=>E(X.target.value)}):q.nombre_usuario||"-"}),s.jsx("td",{style:{width:220},children:w===q.id?s.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:I,onChange:X=>B(X.target.value)}):q.role||"-"}),s.jsx("td",{style:{whiteSpace:"nowrap"},children:w===q.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>Q(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),s.jsx("button",{onClick:()=>ye(),className:"btn-opaque",children:"Cancelar"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>V(q),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),q.role==="cajero"?s.jsx("button",{onClick:()=>fe(q.id,q.role),className:"btn-danger",children:"Eliminar"}):s.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},q.id))})]}),xe.length===0&&!r&&s.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function w_({open:o,onClose:a,row:r,cajeros:l,availableCajeros:u,availableCajas:d,onSave:h}){const[g,p]=S.useState(null),[m,v]=S.useState(null),[_,x]=S.useState(!1),[b,w]=S.useState(null),[A,R]=S.useState(""),[T,I]=S.useState(""),[B,K]=S.useState(""),[E,M]=S.useState(""),[L,V]=S.useState(null),[ye,Q]=S.useState(""),[fe,xe]=S.useState(!1),[q,X]=S.useState(null);if(S.useEffect(()=>{if(!o||!r)return;w(r.caja??null),R(r.cai??""),Q(r.identificador??""),I(r.rango_de??""),K(r.rango_hasta??""),M(r.fecha_vencimiento??""),V(r.secuencia_actual??null);const C=r.cajero??null;if(C){const U=l.find(ee=>ee.username===C||ee.nombre_usuario===C);U?(p(U.id),v(null),x(!1)):(p(null),v(C),x(!0))}else p(null),v(null),x(!1);X(null)},[o,r,l]),!o||!r)return null;async function W(){if(!r){X("Registro invlido");return}if(b!=null&&(b<1||b>5)){X("La caja debe estar entre 1 y 5");return}xe(!0),X(null);try{const C={cai:A??null,identificador:ye??null,rango_de:T??null,rango_hasta:B??null,fecha_vencimiento:E??null,secuencia_actual:L??null,caja:b??null};if(g!=null){const U=l.find(ee=>ee.id===g);C.cajero=U?U.username:null,C.usuario_id=U?U.id:null}else C.cajero=m??null,C.usuario_id=null;await h(r.id,C),a()}catch(C){X(C?.message||String(C))}finally{xe(!1)}}return s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[s.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",r.id]}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),s.jsx("input",{className:"input",value:A,onChange:C=>R(C.target.value)}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),s.jsx("input",{className:"input",value:ye,onChange:C=>Q(C.target.value),placeholder:"Identificador (opcional)"}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),s.jsx("input",{className:"input",value:T,onChange:C=>I(C.target.value)}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),s.jsx("input",{className:"input",value:B,onChange:C=>K(C.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),s.jsx("input",{className:"input",type:"date",value:E,onChange:C=>M(C.target.value)}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),s.jsx("input",{className:"input",value:L??"",onChange:C=>V(C.target.value===""?null:C.target.value),placeholder:"0"}),s.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):_?"__custom__":"",onChange:C=>{const U=C.target.value;U===""?(p(null),v(null),x(!1)):U==="__custom__"?(p(null),x(!0)):/^\d+$/.test(U)&&(p(Number(U)),v(null),x(!1))},children:[s.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(C=>s.jsxs("option",{value:String(C.id),children:[C.username,C.nombre_usuario?`  ${C.nombre_usuario}`:""]},C.id)),s.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),_&&s.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:C=>{v(C.target.value),p(null)},style:{minHeight:36}}),s.jsxs("div",{style:{marginLeft:12},children:[s.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),s.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:C=>w(C.target.value===""?null:Number(C.target.value)),children:[s.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(C=>s.jsx("option",{value:C,children:C},C))]})]})]})]})]}),q&&s.jsx("div",{style:{color:"red",marginTop:12},children:q}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:a,disabled:fe,style:{width:"auto"},children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:W,disabled:fe,style:{width:"auto",padding:"8px 14px"},children:fe?"Guardando...":"Guardar"})]})]})})}function E_({open:o,onClose:a,cajeros:r,availableCajeros:l,availableCajas:u,onCreate:d}){const[h,g]=S.useState(null),[p,m]=S.useState(null),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,A]=S.useState(""),[R,T]=S.useState(""),[I,B]=S.useState(""),[K,E]=S.useState(""),[M,L]=S.useState(null),[V,ye]=S.useState(""),[Q,fe]=S.useState(!1),[xe,q]=S.useState(null);if(!o)return null;async function X(){const W=[];if(w||W.push("CAI"),R||W.push("Rango Desde"),I||W.push("Rango Hasta"),K||W.push("Fecha de Vencimiento"),x==null&&W.push("Caja"),h==null&&!p&&W.push("Cajero"),W.length>0){q(`Campos obligatorios faltantes: ${W.join(", ")}`);return}if(x!=null&&(x<1||x>5)){q("La caja debe estar entre 1 y 5");return}fe(!0),q(null);try{const C={cai:w??null,identificador:V??null,rango_de:R??null,rango_hasta:I??null,fecha_vencimiento:K??null,secuencia_actual:M??null,caja:x??null};if(h!=null){const U=r.find(ee=>ee.id===h);C.cajero=U?U.username:null,C.usuario_id=U?U.id:null}else C.cajero=p??null,C.usuario_id=null;await d(C),a()}catch(C){q(C?.message||String(C))}finally{fe(!1)}}return s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[s.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),s.jsx("input",{className:"input",value:w,onChange:W=>A(W.target.value)}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),s.jsx("input",{className:"input",value:V,onChange:W=>ye(W.target.value),placeholder:"Identificador (opcional)"}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),s.jsx("input",{className:"input",value:R,onChange:W=>T(W.target.value)}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),s.jsx("input",{className:"input",value:I,onChange:W=>B(W.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),s.jsx("input",{className:"input",type:"date",value:K,onChange:W=>E(W.target.value)}),s.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),s.jsx("input",{className:"input",value:M??"",onChange:W=>L(W.target.value===""?null:W.target.value),placeholder:"0"}),s.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:h!=null?String(h):v?"__custom__":"",onChange:W=>{const C=W.target.value;C===""?(g(null),m(null),_(!1)):C==="__custom__"?(g(null),_(!0)):/^\d+$/.test(C)&&(g(Number(C)),m(null),_(!1))},children:[s.jsx("option",{value:"",children:"-- sin asignar --"}),(l??r).map(W=>s.jsxs("option",{value:String(W.id),children:[W.username,W.nombre_usuario?`  ${W.nombre_usuario}`:""]},W.id)),s.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&s.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:W=>{m(W.target.value),g(null)},style:{minHeight:36}}),s.jsxs("div",{style:{marginLeft:12},children:[s.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),s.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:x??"",onChange:W=>b(W.target.value===""?null:Number(W.target.value)),children:[s.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(W=>s.jsx("option",{value:W,children:W},W))]})]})]})]})]}),xe&&s.jsx("div",{style:{color:"red",marginTop:12},children:xe}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:a,disabled:Q,style:{width:"auto"},children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:X,disabled:Q,style:{width:"auto",padding:"8px 14px"},children:Q?"Creando...":"Crear"})]})]})})}function C_(){const[o,a]=S.useState([]),[r,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState([]),[p,m]=S.useState(null),[v,_]=S.useState(!1),[x,b]=S.useState(!1);async function w(){l(!0),d(null);try{const{data:E,error:M}=await ae.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(M)throw M;a(Array.isArray(E)?E:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}async function A(){try{const{data:E}=await ae.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),A()},[]);const R=new Set(o.filter(E=>E.cajero).map(E=>String(E.cajero))),T=new Set(o.filter(E=>E.caja!=null).map(E=>Number(E.caja)));function I(E){m(E),_(!0),d(null)}function B(){_(!1),m(null)}async function K(E,M){l(!0),d(null);try{const{error:L}=await ae.from("cai").update(M).eq("id",E);if(L)throw L;await w()}catch(L){throw d(L?.message||String(L)),L}finally{l(!1)}}return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),s.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${o.length} registros`})]}),u&&s.jsx("div",{style:{color:"red",marginBottom:12},children:u}),s.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"CAI"}),s.jsx("th",{children:"Identificador"}),s.jsx("th",{children:"Rango Desde"}),s.jsx("th",{children:"Rango Hasta"}),s.jsx("th",{children:"Vencimiento"}),s.jsx("th",{children:"Secuencia actual"}),s.jsx("th",{children:"Cajero"}),s.jsx("th",{children:"Usuario ID"}),s.jsx("th",{children:"Caja"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:o.map(E=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:80},children:E.id}),s.jsx("td",{style:{minWidth:200},children:E.cai}),s.jsx("td",{style:{minWidth:160},children:E.identificador??"-"}),s.jsx("td",{children:E.rango_de}),s.jsx("td",{children:E.rango_hasta}),s.jsx("td",{children:E.fecha_vencimiento}),s.jsx("td",{children:E.secuencia_actual??"-"}),s.jsx("td",{style:{minWidth:180},children:E.cajero||"-"}),s.jsx("td",{style:{minWidth:160},children:E.usuario_id??"-"}),s.jsx("td",{style:{width:120},children:E.caja??"-"}),s.jsx("td",{style:{whiteSpace:"nowrap"},children:s.jsx(s.Fragment,{children:s.jsx("button",{onClick:()=>I(E),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},E.id))})]}),o.length===0&&!r&&s.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),s.jsx(w_,{open:v,onClose:B,row:p,cajeros:h,availableCajeros:p?h.filter(E=>!R.has(E.username)||E.username===p.cajero):h.filter(E=>!R.has(E.username)),availableCajas:p?[1,2,3,4,5].filter(E=>!T.has(E)||E===p.caja):[1,2,3,4,5].filter(E=>!T.has(E)),onSave:K}),s.jsx(E_,{open:x,onClose:()=>b(!1),cajeros:h,availableCajeros:h.filter(E=>!R.has(E.username)),availableCajas:[1,2,3,4,5].filter(E=>!T.has(E)),onCreate:async E=>{l(!0),d(null);try{const{error:M}=await ae.from("cai").insert(E);if(M)throw M;await w(),b(!1)}catch(M){throw d(M?.message||String(M)),M}finally{l(!1)}}})]})}function T_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),s.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function A_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),s.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var qu=cp();function N_({open:o,title:a="Confirmar",message:r="Ests seguro?",onClose:l,onConfirm:u}){const[d,h]=Nu.useState(!1);if(!o)return null;const g=async()=>{try{h(!0),await u()}finally{h(!1)}};return qu.createPortal(s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[s.jsx("h3",{style:{marginTop:0},children:a}),s.jsx("p",{children:r}),s.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[s.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),s.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function R_({open:o,title:a="Formulario",columns:r,initialData:l={},onClose:u,onSave:d}){const[h,g]=S.useState({}),[p,m]=S.useState(!1),[v,_]=S.useState(null);if(S.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?_(l.imagen):_(null)},[l,o]),!o)return null;const x=(R,T)=>{g(I=>({...I,[R]:T}))},b=async R=>{R.preventDefault();try{m(!0),await d(h)}finally{m(!1)}},w=R=>R==="creado_en"?null:R==="id"?s.jsx("input",{className:"input",value:h[R]??"",readOnly:!0}):R.includes("publicacion")||R.includes("exento")||R.includes("aplica_impuesto")||R==="publicacion_web"?s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[s.jsxs("label",{className:"switch",children:[s.jsx("input",{type:"checkbox",checked:!!h[R],onChange:T=>x(R,T.target.checked)}),s.jsx("span",{className:"slider"})]}),s.jsx("span",{style:{fontSize:13},children:h[R]?"S":"No"})]}):R.includes("categoria")||R.includes("marca")?s.jsx("input",{type:"text",className:"input",value:h[R]??"",onChange:T=>x(R,T.target.value===""?null:T.target.value)}):R==="imagen"?s.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?s.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,s.jsx("input",{type:"file",accept:"image/*",onChange:T=>{const I=T.target.files&&T.target.files[0];if(x(R,I??null),I)try{const B=URL.createObjectURL(I);_(B)}catch{_(null)}else _(null)}}),v?s.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{x(R,null),_(null)},children:"Eliminar imagen"}):null]}):s.jsx("input",{className:"input",value:h[R]??"",onChange:T=>x(R,T.target.value)}),A=s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[s.jsx("h3",{style:{marginTop:0},children:a}),s.jsxs("form",{onSubmit:b,children:[s.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:r.map(R=>s.jsxs("label",{style:{display:"block"},children:[s.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(R).replace(/_/g," ").toUpperCase()}),w(R)]},R))}),s.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[s.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),s.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return qu.createPortal(A,typeof document<"u"&&document.body||document.createElement("div"))}function O_({open:o,data:a,title:r="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const h=a||{},[g,p]=S.useState(null),[m,v]=S.useState(null),[_,x]=S.useState(null),[b,w]=S.useState(null);return S.useEffect(()=>{let A=!0;return(async()=>{const T=typeof h.imagen=="string"?h.imagen:null;if(!T){A&&p(null);return}if(T.startsWith("http")){A&&(p(T),x(T));return}let I=T;const B=String(T).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);B&&(I=decodeURIComponent(B[2]));const K="inventario";try{const E=(await Tn(async()=>{const{default:Q}=await Promise.resolve().then(()=>Cn);return{default:Q}},void 0)).default,M=await E.storage.from(K).getPublicUrl(I),L=M?.data?.publicUrl||M?.data?.publicURL||null;if(L){A&&(p(L),x(L));return}const V=await E.storage.from(K).createSignedUrl(I,3600*24*7);if(V.error){console.warn("ProductDetailModal createSignedUrl error",V.error),A&&p(null);return}const ye=V.data?.signedUrl??null;A&&(p(ye),x(ye))}catch(E){console.error("ProductDetailModal resolve error",E),A&&p(null)}})(),()=>{A=!1}},[h]),S.useEffect(()=>{let A=!0;return(async()=>{if(w(null),!!_)try{const T=await fetch(_,{method:"HEAD"});if(!A)return;w(`HEAD ${T.status} ${T.statusText} - content-type: ${T.headers.get("content-type")}`)}catch(T){if(!A)return;w(`FETCH_ERROR: ${String(T)}`)}})(),()=>{A=!1}},[_]),qu.createPortal(s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:s.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[s.jsx("h3",{style:{marginTop:0},children:r}),s.jsxs("div",{style:{display:"flex",gap:18},children:[s.jsx("div",{style:{flex:1},children:s.jsx("table",{style:{width:"100%"},children:s.jsx("tbody",{children:Object.keys(h).map(A=>{const R=h[A];return A==="imagen"&&typeof R=="string"?null:s.jsxs("tr",{children:[s.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(A).replace(/_/g," ").toUpperCase()}),s.jsx("td",{style:{padding:6},children:String(R??"-")})]},A)})})})}),s.jsx("div",{style:{width:280,textAlign:"center"},children:g?s.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:A=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?s.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[s.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),s.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):s.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),s.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[s.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(h),children:"Editar"}),s.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(h.id),children:"Eliminar"}),s.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function k_({table:o,select:a,title:r,limit:l=500,columns:u,searchColumns:d,order:h,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:_=[]}){const[x,b]=S.useState(null),[w,A]=S.useState(!1),[R,T]=S.useState(null),[I,B]=S.useState(""),[K,E]=S.useState(!1),[M,L]=S.useState("add"),[V,ye]=S.useState({}),[Q,fe]=S.useState(!1),[xe,q]=S.useState(null),[X,W]=S.useState(!1),[C,U]=S.useState(null),ee=S.useRef(!0),ge=async()=>{A(!0),T(null);try{const le=(await Tn(async()=>{const{default:we}=await Promise.resolve().then(()=>Cn);return{default:we}},void 0)).default,O=a||"*";let te=le.from(o).select(O).limit(l);h&&(Array.isArray(h)?h:String(h).split(",").map(Te=>Te.trim()).filter(Boolean)).forEach(Te=>{const ke=Te.split(" ").map(ut=>ut.trim()).filter(Boolean),Le=ke[0],$e=ke[1]?ke[1].toLowerCase():"asc";te=te.order(Le,{ascending:$e!=="desc"})}),g&&Object.entries(g).forEach(([we,Te])=>{Te==null||Te===""||(te=te.eq(we,Te))});const me=await te;if(console.debug("SupabaseTable fetch result for",o,me),!ee.current)return;if(me.error)throw me.error;b(Array.isArray(me.data)?me.data:[])}catch(le){console.error("SupabaseTable error",le),T(le?.message||String(le)),b([])}finally{ee.current&&A(!1)}};S.useEffect(()=>(ee.current=!0,ge(),()=>{ee.current=!1}),[o,a,l]);const pe=S.useMemo(()=>u&&u.length>0?u:!x||x.length===0?[]:Object.keys(x[0]),[u,x]),N=S.useMemo(()=>{if(!x)return null;const le=(I||"").toString().trim().toLowerCase();if(!le)return x;const O=d&&d.length>0?d:pe;return x.filter(te=>O.some(me=>{const we=te?.[me];return we==null?!1:String(we).toLowerCase().includes(le)}))},[x,I,d,pe]),D=()=>{p&&(L("add"),ye({}),E(!0))},P=le=>{m&&(L("edit"),ye(le),E(!0))},J=async le=>{const O=(await Tn(async()=>{const{default:te}=await Promise.resolve().then(()=>Cn);return{default:te}},void 0)).default;try{const te="inventario",me={...le},we=M==="edit"?V?.imagen??null:null,Te=ke=>{if(!ke)return null;if(!ke.startsWith("http"))return ke;const Le=ke.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Le?decodeURIComponent(Le[2]):null};if(me.imagen&&me.imagen instanceof File){const ke=me.imagen,Le=me.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),$e=`${o}/${Le}/${Date.now()}_${ke.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,ut=await O.storage.from(te).upload($e,ke,{upsert:!0});if(ut.error)throw ut.error;const mt=ut.data?.path??$e;me.imagen=mt;try{const dt=Te(we);if(dt&&dt!==mt){const wt=await O.storage.from(te).remove([dt]);wt.error&&console.warn("Failed to remove old image",wt.error)}}catch(dt){console.warn("Error removing old image",dt)}}if(M==="edit"&&(me.imagen==null||me.imagen===""))try{const ke=Te(V?.imagen??null);if(ke){const Le=await O.storage.from(te).remove([ke]);Le.error&&console.warn("Failed to remove old image on clear",Le.error)}}catch(ke){console.warn("Error removing old image on clear",ke)}if(M==="add"){const{error:ke}=await O.from(o).insert([me]);if(ke)throw ke}else{const ke=me.id,Le={...me};delete Le.id;const{error:$e}=await O.from(o).update(Le).eq("id",ke);if($e)throw $e}E(!1),await ge()}catch(te){console.error("Error saving",te),T(te?.message||String(te))}},he=async()=>{if(xe==null)return;const le=(await Tn(async()=>{const{default:O}=await Promise.resolve().then(()=>Cn);return{default:O}},void 0)).default;try{if(!v)return;try{const te="inventario",me=x?.find(Le=>Le.id===xe),we=Le=>{if(!Le)return null;if(!Le.startsWith("http"))return Le;const $e=Le.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return $e?decodeURIComponent($e[2]):null},Te=me?.imagen??null,ke=we(Te);if(ke){const Le=await le.storage.from(te).remove([ke]);Le.error&&console.warn("Failed to remove image on delete",Le.error)}}catch(te){console.warn("Error removing image before delete",te)}const{error:O}=await le.from(o).delete().eq("id",xe);if(O)throw O;fe(!1),q(null),await ge()}catch(O){console.error("Error deleting",O),T(O?.message||String(O))}};return s.jsxs("div",{style:{padding:18},children:[r?s.jsx("h2",{style:{marginTop:0},children:r}):null,s.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[s.jsx("input",{placeholder:"Buscar...",value:I,onChange:le=>B(le.target.value),className:"input",style:{minWidth:240}}),s.jsx("button",{onClick:()=>{T(null),B(""),ge()},className:"btn-opaque",children:"Recargar"}),s.jsx("div",{style:{marginLeft:"auto"},children:s.jsx("button",{onClick:D,className:"btn-primary",children:"Agregar"})})]}),w&&s.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),R&&s.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",R]}),!w&&x&&x.length===0&&s.jsxs("div",{children:["No hay registros en la tabla ",s.jsx("strong",{children:o}),"."]}),!w&&N&&N.length>0&&s.jsx("div",{style:{overflowX:"auto"},children:s.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[pe.map(le=>s.jsx("th",{children:String(le).replace(/_/g," ").toUpperCase()},le)),s.jsx("th",{style:{width:140},children:"Acciones"})]})}),s.jsx("tbody",{children:N.map((le,O)=>s.jsxs("tr",{children:[pe.map(te=>{if(te==="imagen"){const me=le?.imagen??null;return me||console.debug("SupabaseTable: row has no imagen for id",le?.id,le),s.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:me?s.jsx(rm,{src:String(me)}):s.jsx("span",{style:{color:"#6b7280"},children:"-"})},te)}return s.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:U_(le[te])},te)}),s.jsx("td",{className:"admin-actions",children:s.jsx("button",{className:"btn-opaque",onClick:()=>{U(le),W(!0)},children:"Ver"})})]},le.id??O))})]})}),s.jsx(R_,{open:K,title:M==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:pe.filter(le=>!_.includes(le)),initialData:V,onClose:()=>E(!1),onSave:J}),s.jsx(O_,{open:X,data:C,title:`Detalle de ${o}`,onClose:()=>W(!1),onEdit:le=>{W(!1),P(le)},onDeleteClick:le=>{W(!1),q(le),fe(!0)}}),s.jsx(N_,{open:Q,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>fe(!1),onConfirm:he})]})}function U_(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return s.jsx(rm,{src:o})}return String(o)}function rm({src:o}){const[a,r]=S.useState(null),[l,u]=S.useState(null);return S.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&r(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await Tn(async()=>{const{default:A}=await Promise.resolve().then(()=>Cn);return{default:A}},void 0)).default,v="inventario",_=await m.storage.from(v).getPublicUrl(g),x=_?.data?.publicUrl||_?.data?.publicURL||null;if(x){d&&r(x);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&r(null);return}const w=b.data?.signedUrl??null;d&&r(w)}catch(m){console.error("Thumbnail resolve error",m),d&&r(null)}})(),()=>{d=!1}},[o]),!a&&!l?s.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?s.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),r(null)}}):s.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:s.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function z_(){const[o,a]=S.useState(null),[r,l]=S.useState(""),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,m]=S.useState([]);return S.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await Tn(async()=>{const{default:L}=await Promise.resolve().then(()=>Cn);return{default:L}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],A=new Set(w.map(L=>L.categoria??"").filter(Boolean)),R=new Set(w.map(L=>L.marca??"").filter(Boolean)),T=w.length,I=w.filter(L=>!!L.publicacion_web).length,B=L=>{if(L==null)return!1;if(typeof L=="boolean")return L===!0;if(typeof L=="number")return L===1;const V=String(L).toLowerCase().trim();return V==="1"||V==="true"||V==="t"||V==="si"||V==="s"||V==="yes"},K=w.filter(L=>B(L.exento)).length,E=w.filter(L=>B(L.aplica_impuesto_18)).length,M=w.filter(L=>B(L.aplica_impuesto_turistico)).length;a({categorias:A.size,marcas:R.size,items:T,publicadas:I,exentos:K,aplica_impuesto_18:E,aplica_impuesto_turistico:M}),g(Array.from(A).sort()),m(Array.from(R).sort())}catch(x){console.error("Error loading inventario summary",x)}})(),()=>{v=!1}},[]),s.jsxs("div",{children:[s.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),s.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[s.jsx(ni,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),s.jsx(ni,{label:"Marcas",value:o?String(o.marcas):"..."}),s.jsx(ni,{label:"Items",value:o?String(o.items):"..."}),s.jsx(ni,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),s.jsx(ni,{label:"Exentos",value:o?String(o.exentos):"..."}),s.jsx(ni,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),s.jsx(ni,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),s.jsxs("select",{value:r,onChange:v=>l(v.target.value),className:"input",children:[s.jsx("option",{value:"",children:"Todas"}),h.map(v=>s.jsx("option",{value:v,children:v},v))]})]}),s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),s.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[s.jsx("option",{value:"",children:"Todas"}),p.map(v=>s.jsx("option",{value:v,children:v},v))]})]}),s.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),s.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),s.jsx(k_,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:r||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function ni({label:o,value:a}){return s.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[s.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),s.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function D_({open:o,onClose:a,products:r,availableCajas:l,onCreate:u}){const[d,h]=S.useState(null),[g,p]=S.useState(""),[m,v]=S.useState(!1),[_,x]=S.useState(null),[b,w]=S.useState(null),[A,R]=S.useState(null),[T,I]=S.useState(null),[B,K]=S.useState(null),[E,M]=S.useState(null),[L,V]=S.useState(null),[ye,Q]=S.useState(null),[fe,xe]=S.useState(null),[q,X]=S.useState(!1);S.useEffect(()=>{o&&(h(null),p(""),w(null),R(null),I(null),Q(null),xe(null),x(null))},[o]);async function W(){const U=[];if(d||U.push("Producto"),g||U.push("Precio"),U.length>0){x(`Faltan campos: ${U.join(", ")}`);return}const ee=Number(g);if(isNaN(ee)||ee<0){x("Precio invlido");return}v(!0),x(null);try{await u({producto_id:d,precio:g});try{const ge={};if(B!==null&&(ge.exento=B),E!==null&&(ge.aplica_impuesto_18=E),L!==null&&(ge.aplica_impuesto_turistico=L),Object.keys(ge).length>0){const{error:pe}=await ae.from("inventario").update(ge).eq("id",d);pe&&console.warn("Error actualizando inventario flags:",pe)}}catch(ge){console.warn("Error al persistir flags en inventario:",ge)}a()}catch(ge){x(ge?.message||String(ge))}finally{v(!1)}}function C(U){return U?Number(U.replace(",",".")):NaN}return S.useEffect(()=>{let U=!0;async function ee(){if(w(null),R(null),I(null),Q(null),xe(null),!d)return;const ge=C(g);if(!isNaN(ge)){X(!0);try{const{data:pe,error:N}=await ae.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(N)throw N;const D=Array.isArray(pe)?pe.map(ot=>Number(ot.costo_unitario)).filter(ot=>!isNaN(ot)):[],P=D.length>0?D.reduce((ot,Ze)=>ot+Ze,0)/D.length:0;if(!U)return;w(P);let J=!1,he=!1,le=!1;try{const{data:ot,error:Ze}=await ae.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!Ze&&ot&&(J=!!ot.exento,he=!!ot.aplica_impuesto_18,le=!!ot.aplica_impuesto_turistico,B===null&&K(J),E===null&&M(he),L===null&&V(le))}catch{}const{data:O}=await ae.from("impuesto").select("id, impuesto_venta"),te={};Array.isArray(O)&&O.forEach(ot=>{te[String(ot.id)]=Number(ot.impuesto_venta)});const me=B!==null?B:J,we=E!==null?E:he,Te=L!==null?L:le;let ke=0;me?ke=0:we?ke=te[2]??te[1]??0:ke=te[1]??0;let Le=0;Te&&(Le=te[3]??0);const $e=(ke||0)+(Le||0),ut=$e>1?$e/100:$e,mt=ge*ut;R($e),I(mt);const dt=ge-P,wt=P>0?dt/P*100:null;Q(wt);const Ht=ge>0?(ge-P-mt)/ge*100:null;xe(Ht)}catch{}finally{U&&X(!1)}}}return ee(),()=>{U=!1}},[d,g,B,E,L]),o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[s.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),s.jsxs("div",{style:{display:"grid",gap:8},children:[s.jsx("label",{style:{fontSize:13},children:"Producto"}),s.jsxs("select",{className:"input",value:d??"",onChange:U=>h(U.target.value||null),children:[s.jsx("option",{value:"",children:"-- seleccionar producto --"}),r.map(U=>s.jsx("option",{value:U.id,children:U.nombre},U.id))]}),s.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{type:"checkbox",checked:!!B,onChange:U=>K(U.target.checked)}),s.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{type:"checkbox",checked:!!E,onChange:U=>M(U.target.checked)}),s.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{type:"checkbox",checked:!!L,onChange:U=>V(U.target.checked)}),s.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),s.jsx("label",{style:{fontSize:13},children:"Precio"}),s.jsx("input",{className:"input",value:g,onChange:U=>p(U.target.value),placeholder:"0.00"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),s.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),s.jsx("input",{className:"input",value:T==null?"":T.toFixed(2),readOnly:!0,placeholder:"--"})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),s.jsx("input",{className:"input",value:ye==null?"":ye.toFixed(2),readOnly:!0,placeholder:"--"})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),s.jsx("input",{className:"input",value:fe==null?"":fe.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&s.jsx("div",{style:{color:"red",marginTop:12},children:_}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:W,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function L_({open:o,onClose:a,row:r,products:l,availableProducts:u,onSave:d}){const[h,g]=S.useState(null),[p,m]=S.useState(""),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,A]=S.useState(null),[R,T]=S.useState(null),[I,B]=S.useState(null),[K,E]=S.useState(null),[M,L]=S.useState(null),[V,ye]=S.useState(null),[Q,fe]=S.useState(null),[xe,q]=S.useState(null),[X,W]=S.useState(!1);S.useEffect(()=>{if(!(!o||!r)){g(r.producto_id);try{const ee=Number(r.precio);m(isNaN(ee)?String(r.precio):ee.toFixed(2))}catch{m(r.precio)}b(null)}},[o,r]);function C(ee){return ee?Number(ee.replace(",",".")):NaN}if(S.useEffect(()=>{let ee=!0;async function ge(){if(A(null),T(null),B(null),fe(null),q(null),!o||!r||!h)return;const pe=C(p);if(!isNaN(pe)){W(!0);try{const{data:N,error:D}=await ae.from("compras_detalle").select("costo_unitario").eq("producto_id",h);if(D)throw D;const P=Array.isArray(N)?N.map(Ze=>Number(Ze.costo_unitario)).filter(Ze=>!isNaN(Ze)):[],J=P.length>0?P.reduce((Ze,Ua)=>Ze+Ua,0)/P.length:0;if(!ee)return;A(J);let he=!1,le=!1,O=!1;try{const{data:Ze,error:Ua}=await ae.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",h).single();!Ua&&Ze&&(he=!!Ze.exento,le=!!Ze.aplica_impuesto_18,O=!!Ze.aplica_impuesto_turistico,K===null&&E(he),M===null&&L(le),V===null&&ye(O))}catch{}const{data:te}=await ae.from("impuesto").select("id, impuesto_venta"),me={};Array.isArray(te)&&te.forEach(Ze=>me[String(Ze.id)]=Number(Ze.impuesto_venta));const we=K!==null?K:he,Te=M!==null?M:le,ke=V!==null?V:O;let Le=0;we?Le=0:Te?Le=me[2]??me[1]??0:Le=me[1]??0;let $e=0;ke&&($e=me[3]??0);const ut=(Le||0)+($e||0),mt=ut>1?ut/100:ut,dt=pe*mt;T(ut),B(dt);const wt=pe-J,Ht=J>0?wt/J*100:null;fe(Ht);const ot=pe>0?(pe-J-dt)/pe*100:null;q(ot)}catch{}finally{ee&&W(!1)}}}return ge(),()=>{ee=!1}},[o,r,h,p,K,M,V]),!o||!r)return null;async function U(){const ee=[];if(h||ee.push("Producto"),p||ee.push("Precio"),ee.length>0){b(`Faltan campos: ${ee.join(", ")}`);return}const ge=Number(p);if(isNaN(ge)||ge<0){b("Precio invlido");return}_(!0),b(null);try{const pe=r.id;await d(pe,{producto_id:h,precio:p});try{const N={};if(K!==null&&(N.exento=K),M!==null&&(N.aplica_impuesto_18=M),V!==null&&(N.aplica_impuesto_turistico=V),Object.keys(N).length>0&&h){const{error:D}=await ae.from("inventario").update(N).eq("id",h);D&&console.warn("Error actualizando inventario flags:",D)}}catch(N){console.warn("Error al persistir flags en inventario:",N)}a()}catch(pe){b(pe?.message||String(pe))}finally{_(!1)}}return s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[s.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",r.id]}),s.jsxs("div",{style:{display:"grid",gap:8},children:[s.jsx("label",{style:{fontSize:13},children:"Producto"}),s.jsxs("select",{className:"input",value:h??"",onChange:ee=>g(ee.target.value||null),children:[s.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(ee=>s.jsx("option",{value:ee.id,children:ee.nombre},ee.id))]}),s.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{type:"checkbox",checked:!!K,onChange:ee=>E(ee.target.checked)}),s.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{type:"checkbox",checked:!!M,onChange:ee=>L(ee.target.checked)}),s.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),s.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{type:"checkbox",checked:!!V,onChange:ee=>ye(ee.target.checked)}),s.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),s.jsx("label",{style:{fontSize:13},children:"Precio"}),s.jsx("input",{className:"input",value:p,onChange:ee=>m(ee.target.value),placeholder:"0.00"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),s.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),s.jsx("input",{className:"input",value:I==null?"":I.toFixed(2),readOnly:!0,placeholder:"--"})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),s.jsx("input",{className:"input",value:Q==null?"":Q.toFixed(2),readOnly:!0,placeholder:"--"})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),s.jsx("input",{className:"input",value:xe==null?"":xe.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&s.jsx("div",{style:{color:"red",marginTop:12},children:x}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:U,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function B_(){const[o,a]=S.useState([]),[r,l]=S.useState([]),[u,d]=S.useState(!1),[h,g]=S.useState(null),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[x,b]=S.useState(null);async function w(){d(!0),g(null);try{const{data:E,error:M}=await ae.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(M)throw M;a(Array.isArray(E)?E:[])}catch(E){g(E?.message||String(E)),a([])}finally{d(!1)}}async function A(){try{const{data:E}=await ae.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),A()},[]);const R=new Set(o.map(E=>String(E.producto_id))),T=r.filter(E=>!R.has(E.id));function I(E){b(E),_(!0),g(null)}async function B(E){d(!0),g(null);try{const{error:M}=await ae.from("precios").insert(E);if(M)throw M;try{const L={producto_id:E.producto_id,precio:E.precio},{error:V}=await ae.from("precios_historico").insert(L);V&&console.warn("No se pudo insertar en precios_historico",V)}catch(L){console.warn("Error registrando precios_historico",L)}await w()}catch(M){throw g(M?.message||String(M)),M}finally{d(!1)}}async function K(E,M){d(!0),g(null);try{const{error:L}=await ae.from("precios").update(M).eq("id",E);if(L)throw L;let V=M.producto_id,ye=M.precio;if(!V||ye===void 0)try{const{data:Q}=await ae.from("precios").select("producto_id, precio").eq("id",E).limit(1).single();Q&&(V=V||Q.producto_id,ye=ye===void 0?Q.precio:ye)}catch{}try{if(V&&ye!==void 0){const Q={producto_id:V,precio:ye},{error:fe}=await ae.from("precios_historico").insert(Q);fe&&console.warn("No se pudo insertar en precios_historico",fe)}}catch(Q){console.warn("Error registrando precios_historico",Q)}await w()}catch(L){throw g(L?.message||String(L)),L}finally{d(!1)}}return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsx("button",{className:"btn-opaque",onClick:()=>{w(),A()},children:"Recargar"}),s.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),h&&s.jsx("div",{style:{color:"red",marginBottom:12},children:h}),s.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Precio"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:o.map(E=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:80},children:E.id}),s.jsx("td",{style:{minWidth:220},children:r.find(M=>M.id===E.producto_id)?.nombre||E.producto_id}),s.jsx("td",{children:E.precio}),s.jsx("td",{style:{whiteSpace:"nowrap"},children:s.jsx("button",{className:"btn-opaque",onClick:()=>I(E),children:"Editar"})})]},E.id))})]})}),s.jsx(D_,{open:p,onClose:()=>m(!1),products:T,onCreate:async E=>{await B(E),m(!1)}}),s.jsx(L_,{open:v,onClose:()=>{_(!1),b(null)},row:x,products:r,availableProducts:[...r.filter(E=>!R.has(E.id)),...x?r.filter(E=>E.id===x.producto_id):[]],onSave:async(E,M)=>{await K(E,M),_(!1),b(null)}})]})}function M_(){const[o,a]=S.useState(""),[r,l]=S.useState([]),[u,d]=S.useState(null),[h,g]=S.useState([]),[p,m]=S.useState(!1),[v,_]=S.useState(null);async function x(){if(_(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:A}=await ae.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(A)throw A;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const R=w[0].id;d(R),await b(R)}}catch(w){_(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),_(null);try{const{data:A,error:R}=await ae.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(R)throw R;g(Array.isArray(A)?A:[])}catch(A){_(A?.message||String(A)),g([])}finally{m(!1)}}return S.useEffect(()=>{u&&b(u)},[u]),s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),s.jsx("button",{className:"btn-opaque",onClick:()=>x(),children:"Buscar"}),s.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${h.length} registros`})]}),v&&s.jsx("div",{style:{color:"red",marginBottom:12},children:v}),r.length>0&&s.jsxs("div",{style:{marginBottom:12},children:[s.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),s.jsx("ul",{children:r.map(w=>s.jsxs("li",{style:{marginBottom:6},children:[s.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),s.jsx("strong",{children:w.nombre})," ",s.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),s.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("div",{}),s.jsx("div",{children:s.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),s.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Precio"}),s.jsx("th",{children:"Actualizacion"})]})}),s.jsx("tbody",{children:h.map(w=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:80},children:String(w.id)}),s.jsx("td",{style:{minWidth:220},children:r.find(A=>A.id===w.producto_id)?.nombre||w.producto_id}),s.jsx("td",{children:Number(w.precio).toFixed(2)}),s.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function q_(){const[o,a]=S.useState(""),[r,l]=S.useState(""),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,m]=S.useState({}),[v,_]=S.useState({}),[x,b]=S.useState(!1),[w,A]=S.useState(null);async function R(){b(!0),A(null);try{let T=ae.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(T=T.ilike("sku",`%${o}%`)),r&&(T=T.ilike("marca",`%${r}%`)),u&&(T=T.ilike("modelo",`%${u}%`));const{data:I,error:B}=await T.order("nombre",{ascending:!0});if(B)throw B;const K=Array.isArray(I)?I:[];g(K);const E=K.map(Q=>Q.id);if(E.length===0){m({});return}const{data:M,error:L}=await ae.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",E);if(L)throw L;const V=Array.isArray(M)?M:[],ye={};for(const Q of K)ye[String(Q.id)]=0;for(const Q of V){const fe=String(Q.producto_id),xe=Number(Q.cantidad)||0,q=String(Q.tipo_de_movimiento||"").toUpperCase();ye.hasOwnProperty(fe)||(ye[fe]=0),q==="ENTRADA"?ye[fe]=(ye[fe]||0)+xe:q==="SALIDA"&&(ye[fe]=(ye[fe]||0)-xe)}for(const Q of Object.keys(ye))ye[Q]=Number((ye[Q]||0).toFixed(2));m(ye);try{const Q=(await Tn(async()=>{const{default:q}=await Promise.resolve().then(()=>Cn);return{default:q}},void 0)).default,fe="inventario",xe={};await Promise.all(K.map(async q=>{const X=q.imagen;if(!X){xe[String(q.id)]=null;return}const W=String(X);if(W.startsWith("http")){xe[String(q.id)]=W;return}let C=W;const U=String(W).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);U&&(C=decodeURIComponent(U[2]));try{const ee=await Q.storage.from(fe).getPublicUrl(C),ge=ee?.data?.publicUrl||ee?.data?.publicURL||null;if(ge){xe[String(q.id)]=ge;return}}catch{}try{const ge=(await Q.storage.from(fe).createSignedUrl(C,604800))?.data?.signedUrl??null;xe[String(q.id)]=ge}catch{xe[String(q.id)]=null}})),_(xe)}catch{}}catch(T){A(T?.message||String(T)),g([]),m({})}finally{b(!1)}}return S.useEffect(()=>{R()},[]),s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Stock"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:T=>a(T.target.value)}),s.jsx("input",{className:"input",placeholder:"Filtro Marca",value:r,onChange:T=>l(T.target.value)}),s.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:T=>d(T.target.value)}),s.jsx("button",{className:"btn-opaque",onClick:()=>R(),children:"Aplicar"}),s.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),R()},children:"Limpiar"}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:x?"Cargando...":`${h.length} productos`})]}),w&&s.jsx("div",{style:{color:"red",marginBottom:12},children:w}),s.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("div",{}),s.jsx("div",{children:s.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),s.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Imagen"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Marca"}),s.jsx("th",{children:"Modelo"}),s.jsx("th",{children:"Descripcin"}),s.jsx("th",{children:"Stock"})]})}),s.jsx("tbody",{children:h.map(T=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:70},children:v[String(T.id)]?s.jsx("img",{src:encodeURI(v[String(T.id)]),alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):T.imagen?s.jsx("img",{src:T.imagen,alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):""}),s.jsx("td",{children:T.sku||""}),s.jsx("td",{children:T.marca||""}),s.jsx("td",{children:T.modelo||""}),s.jsx("td",{style:{maxWidth:320},children:T.descripcion||""}),s.jsx("td",{style:{textAlign:"right"},children:p[String(T.id)]!=null?String(p[String(T.id)]):"0"})]},T.id))})]})]})]})}function I_(){const[o,a]=S.useState(""),[r,l]=S.useState(""),[u,d]=S.useState(""),[h,g]=S.useState([]),[p,m]=S.useState([]),[v,_]=S.useState(!1),[x,b]=S.useState([]),[w,A]=S.useState({}),[R,T]=S.useState(!1),[I,B]=S.useState(null);async function K(){T(!0),B(null),b([]);try{let V=null;if(o||r||u){let X=ae.from("inventario").select("id").order("nombre",{ascending:!0});o&&(X=X.ilike("sku",`%${o}%`)),r&&(X=X.ilike("marca",`%${r}%`)),u&&(X=X.ilike("categoria",`%${u}%`));const{data:W,error:C}=await X;if(C)throw C;if(V=Array.isArray(W)?W.map(U=>String(U.id)):[],V.length===0){b([]),A({}),T(!1);return}}let ye=ae.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(V&&(ye=ye.in("producto_id",V)),v){const X=new Date(Date.now()-864e5).toISOString();ye=ye.gte("fecha_salida",X)}ye=ye.order("fecha_salida",{ascending:!1});const{data:Q,error:fe}=await ye;if(fe)throw fe;const xe=Array.isArray(Q)?Q.map(X=>({id:X.id,producto_id:String(X.producto_id),cantidad:Number(X.cantidad),tipo_de_movimiento:X.tipo_de_movimiento,referencia:X.referencia,usuario:X.usuario,fecha_salida:X.fecha_salida})):[];b(xe);const q=Array.from(new Set(xe.map(X=>X.producto_id))).filter(Boolean);if(q.length>0){const{data:X}=await ae.from("inventario").select("id, nombre, sku, marca, categoria").in("id",q),W={};Array.isArray(X)&&X.forEach(C=>{W[String(C.id)]={id:C.id,nombre:C.nombre,sku:C.sku,marca:C.marca,categoria:C.categoria}}),A(W)}else A({})}catch(V){B(V?.message||String(V)),b([])}finally{T(!1)}}async function E(){try{const{data:V,error:ye}=await ae.from("inventario").select("marca, categoria");if(ye)throw ye;const Q=new Set,fe=new Set;Array.isArray(V)&&V.forEach(xe=>{xe.marca&&Q.add(String(xe.marca)),xe.categoria&&fe.add(String(xe.categoria))}),g(Array.from(Q).sort()),m(Array.from(fe).sort())}catch(V){console.warn("Error loading filter options",V)}}S.useEffect(()=>{K(),E()},[]);const M=x.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="ENTRADA"),L=x.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="SALIDA");return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:V=>a(V.target.value)}),s.jsxs("select",{className:"input",value:r,onChange:V=>l(V.target.value),children:[s.jsx("option",{value:"",children:"-- Marca (todas) --"}),h.map(V=>s.jsx("option",{value:V,children:V},V))]}),s.jsxs("select",{className:"input",value:u,onChange:V=>d(V.target.value),children:[s.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(V=>s.jsx("option",{value:V,children:V},V))]}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[s.jsx("input",{type:"checkbox",checked:v,onChange:V=>_(V.target.checked)})," ltimas 24h"]}),s.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Aplicar"}),s.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),_(!1),K()},children:"Limpiar"}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:R?"Cargando...":`${x.length} registros`})]}),I&&s.jsx("div",{style:{color:"red",marginBottom:12},children:I}),s.jsxs("div",{style:{display:"flex",gap:12},children:[s.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("strong",{children:"Entradas"}),s.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),s.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Cantidad"}),s.jsx("th",{children:"Referencia"}),s.jsx("th",{children:"Usuario"}),s.jsx("th",{children:"Fecha"})]})}),s.jsx("tbody",{children:M.map(V=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:70},children:String(V.id)}),s.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),s.jsx("td",{children:w[V.producto_id]?.nombre||""}),s.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),s.jsx("td",{children:V.referencia||""}),s.jsx("td",{children:V.usuario||""}),s.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]}),s.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("strong",{children:"Salidas"}),s.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),s.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"SKU"}),s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Cantidad"}),s.jsx("th",{children:"Referencia"}),s.jsx("th",{children:"Usuario"}),s.jsx("th",{children:"Fecha"})]})}),s.jsx("tbody",{children:L.map(V=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:70},children:String(V.id)}),s.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),s.jsx("td",{children:w[V.producto_id]?.nombre||""}),s.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),s.jsx("td",{children:V.referencia||""}),s.jsx("td",{children:V.usuario||""}),s.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]})]})]})}function H_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),s.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function $_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),s.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function V_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),s.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function P_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),s.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function G_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),s.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function K_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),s.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function Y_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),s.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function F_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),s.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function J_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),s.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function Q_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),s.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function X_(){return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),s.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function Z_({open:o,onClose:a,onCreate:r}){const[l,u]=S.useState(""),[d,h]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,x]=S.useState(""),[b,w]=S.useState(""),[A,R]=S.useState(!0),[T,I]=S.useState(!1),[B,K]=S.useState(null);if(!o)return null;async function E(){const M=[];if(l.trim()||M.push("Nombre"),M.length){K(`Faltan campos: ${M.join(", ")}`);return}I(!0),K(null);try{await r({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:b||void 0,activo:A}),u(""),h(""),p(""),v(""),x(""),w(""),R(!0),a()}catch(L){K(L?.message||String(L))}finally{I(!1)}}return s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[s.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),s.jsxs("div",{style:{display:"grid",gap:8},children:[s.jsx("label",{style:{fontSize:13},children:"Nombre"}),s.jsx("input",{className:"input",value:l,onChange:M=>u(M.target.value)}),s.jsx("label",{style:{fontSize:13},children:"RTN"}),s.jsx("input",{className:"input",value:d,onChange:M=>h(M.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Telfono"}),s.jsx("input",{className:"input",value:g,onChange:M=>p(M.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Correo"}),s.jsx("input",{className:"input",value:m,onChange:M=>v(M.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Direccin"}),s.jsx("input",{className:"input",value:_,onChange:M=>x(M.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Tipo"}),s.jsx("input",{className:"input",value:b,onChange:M=>w(M.target.value),placeholder:"local / internacional"}),s.jsxs("label",{style:{fontSize:13},children:[s.jsx("input",{type:"checkbox",checked:A,onChange:M=>R(M.target.checked)})," ","Activo"]})]}),B&&s.jsx("div",{style:{color:"red",marginTop:12},children:B}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:a,disabled:T,style:{width:"auto"},children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:E,disabled:T,style:{width:"auto",padding:"8px 14px"},children:T?"Creando...":"Crear"})]})]})})}function W_({open:o,onClose:a,row:r,onSave:l}){const[u,d]=S.useState(""),[h,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[x,b]=S.useState(""),[w,A]=S.useState(""),[R,T]=S.useState(!0),[I,B]=S.useState(!1),[K,E]=S.useState(null);if(S.useEffect(()=>{!o||!r||(d(r.nombre||""),g(r.rtn||""),m(r.telefono||""),_(r.correo||""),b(r.direccion||""),A(r.tipo_proveedor||""),T(r.activo??!0),E(null))},[o,r]),!o||!r)return null;async function M(){if(!r){E("No hay fila seleccionada");return}const L=[];if(u.trim()||L.push("Nombre"),L.length){E(`Faltan campos: ${L.join(", ")}`);return}B(!0),E(null);try{await l(r.id,{nombre:u.trim(),rtn:h.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:w||void 0,activo:R}),a()}catch(V){E(V?.message||String(V))}finally{B(!1)}}return s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[s.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(r.id)]}),s.jsxs("div",{style:{display:"grid",gap:8},children:[s.jsx("label",{style:{fontSize:13},children:"Nombre"}),s.jsx("input",{className:"input",value:u,onChange:L=>d(L.target.value)}),s.jsx("label",{style:{fontSize:13},children:"RTN"}),s.jsx("input",{className:"input",value:h,onChange:L=>g(L.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Telfono"}),s.jsx("input",{className:"input",value:p,onChange:L=>m(L.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Correo"}),s.jsx("input",{className:"input",value:v,onChange:L=>_(L.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Direccin"}),s.jsx("input",{className:"input",value:x,onChange:L=>b(L.target.value)}),s.jsx("label",{style:{fontSize:13},children:"Tipo"}),s.jsx("input",{className:"input",value:w,onChange:L=>A(L.target.value),placeholder:"local / internacional"}),s.jsxs("label",{style:{fontSize:13},children:[s.jsx("input",{type:"checkbox",checked:R,onChange:L=>T(L.target.checked)})," ","Activo"]})]}),K&&s.jsx("div",{style:{color:"red",marginTop:12},children:K}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:a,disabled:I,style:{width:"auto"},children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:M,disabled:I,style:{width:"auto",padding:"8px 14px"},children:I?"Guardando...":"Guardar"})]})]})})}function ex(){const[o,a]=S.useState([]),[r,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(""),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[x,b]=S.useState(null),[w,A]=S.useState(!1),[R,T]=S.useState(null);async function I(M){l(!0),d(null);try{let L=null,V=null;if(M&&M.trim()){const Q=`%${M.trim()}%`,fe=await ae.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${Q},rtn.ilike.${Q}`).order("id",{ascending:!0});L=fe.data,V=fe.error}else{const ye=await ae.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});L=ye.data,V=ye.error}if(V)throw V;a(Array.isArray(L)?L:[])}catch(L){d(L?.message||String(L)),a([])}finally{l(!1)}}S.useEffect(()=>{I()},[]),S.useEffect(()=>{const M=setTimeout(()=>{I(h)},350);return()=>clearTimeout(M)},[h]);async function B(M){l(!0),d(null);try{const L={...M};if(delete L.id,L.rtn){const{data:ye,error:Q}=await ae.from("proveedores").select("id, nombre").eq("rtn",L.rtn).limit(1);if(Q)throw Q;if(Array.isArray(ye)&&ye.length>0)throw new Error(`Ya existe un proveedor con RTN ${L.rtn}`)}const{error:V}=await ae.from("proveedores").insert(L);if(V)throw V;await I()}catch(L){throw String(L).includes("Ya existe un proveedor")?d(String(L)):L?.code==="23505"||String(L).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(L?.message||String(L)),L}finally{l(!1)}}async function K(M,L){l(!0),d(null);try{const{error:V}=await ae.from("proveedores").update(L).eq("id",M);if(V)throw V;await I()}catch(V){throw d(V?.message||String(V)),V}finally{l(!1)}}async function E(){if(R){l(!0),d(null);try{const{error:M}=await ae.from("proveedores").delete().eq("id",R.id);if(M)throw M;A(!1),T(null),await I()}catch(M){d(M?.message||String(M))}finally{l(!1)}}}return s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsx("button",{className:"btn-opaque",onClick:()=>I(),children:"Recargar"}),s.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),s.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[s.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:h,onChange:M=>g(M.target.value),style:{width:260}}),s.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),I()},children:"Limpiar"})]}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${o.length} proveedores`})]}),u&&s.jsx("div",{style:{color:"red",marginBottom:12},children:u}),s.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"RTN"}),s.jsx("th",{children:"Nombre"}),s.jsx("th",{children:"Telfono"}),s.jsx("th",{children:"Correo"}),s.jsx("th",{children:"Direccin"}),s.jsx("th",{children:"Tipo"}),s.jsx("th",{children:"Activo"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:o.map(M=>s.jsxs("tr",{children:[s.jsx("td",{children:M.rtn||""}),s.jsx("td",{style:{minWidth:180},children:M.nombre}),s.jsx("td",{children:M.telefono||""}),s.jsx("td",{children:M.correo||""}),s.jsx("td",{children:M.direccion||""}),s.jsx("td",{children:M.tipo_proveedor||""}),s.jsx("td",{children:M.activo?"S":"No"}),s.jsxs("td",{style:{whiteSpace:"nowrap"},children:[s.jsx("button",{className:"btn-opaque",onClick:()=>{b(M),_(!0)},children:"Editar"}),s.jsx("button",{className:"btn-danger",onClick:()=>{T(M),A(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},M.id))})]})}),s.jsx(Z_,{open:p,onClose:()=>m(!1),onCreate:async M=>{await B(M),m(!1)}}),s.jsx(W_,{open:v,onClose:()=>{_(!1),b(null)},row:x,onSave:async(M,L)=>{await K(M,L),_(!1),b(null)}}),s.jsx(im,{open:w,title:R?`Eliminar proveedor ${R.nombre}`:"Eliminar proveedor",message:R?`Confirma eliminar al proveedor ${R.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await E()},onCancel:()=>{A(!1),T(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function tx({open:o,onClose:a,onCreated:r}){const[l,u]=S.useState([]),[d,h]=S.useState([]),[g,p]=S.useState(0),[m,v]=S.useState(null),[_,x]=S.useState(""),[b,w]=S.useState("factura"),[A,R]=S.useState([]),[T,I]=S.useState(null),[B,K]=S.useState(1),[E,M]=S.useState(null),[L,V]=S.useState(!1),[ye,Q]=S.useState(null);if(S.useEffect(()=>{o&&(async()=>{try{const U=await ae.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await ae.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});h(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await ae.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),ee=Array.isArray(U.data)&&U.data.length>0?U.data[0]:null,ge=ee?Number(ee.impuesto_venta):0;p(ge)}catch{}})()},[o]),!o)return null;function fe(){v(null),x(""),w("factura"),R([]),I(null),K(1),M(null),Q(null)}function xe(){if(!T){Q("Selecciona un producto");return}if(!E||E<=0){Q("Costo unitario invlido");return}if(!B||B<=0){Q("Cantidad invlida");return}const U=l.find(ge=>ge.id===T),ee=ge=>{if(ge==null)return!1;if(typeof ge=="boolean")return ge===!0;if(typeof ge=="number")return ge===1;const pe=String(ge).toLowerCase().trim();return pe==="1"||pe==="true"||pe==="t"||pe==="si"||pe==="s"||pe==="yes"};R(ge=>[...ge,{producto_id:T,nombre:U?.nombre||"",cantidad:B,costo_unitario:E,exento:ee(U?.exento)}]),I(null),K(1),M(null),Q(null)}function q(U){R(ee=>ee.filter((ge,pe)=>pe!==U))}function X(){const U=g,ee=U>1?U/100:U;let ge=0,pe=0,N=0;for(const D of A){const P=D.cantidad*D.costo_unitario;let J=0,he=P;D.exento||(J=P*ee,he=P-J),ge+=he,pe+=J,N+=P}return{subtotal:ge,impuesto:pe,total:N}}async function W(){if(Q(null),!m){Q("Selecciona un proveedor");return}if(A.length===0){Q("Agrega al menos un producto");return}V(!0);try{const{subtotal:U,impuesto:ee,total:ge}=X(),pe={proveedor_id:m,numero_documento:_||null,tipo_documento:b||null,subtotal:U,impuesto:ee,total:ge,usuario:null},N=await ae.from("compras").insert(pe).select("id").single();if(N.error)throw N.error;const D=N.data.id,P=A.map(he=>({compra_id:D,producto_id:he.producto_id,cantidad:he.cantidad,costo_unitario:he.costo_unitario})),J=await ae.from("compras_detalle").insert(P);if(J.error)throw await ae.from("compras").delete().eq("id",D),J.error;try{const he=_?`Compra - ${_}`:`Compra ${D}`;let le="sistema";try{const we=localStorage.getItem("user");if(we){const Te=JSON.parse(we);le=Te.username?`${Te.username}${Te.role?` (${Te.role})`:""}`:String(Te)}}catch{}const O=new Date().toISOString(),te=A.map(we=>({producto_id:we.producto_id,cantidad:we.cantidad,tipo_de_movimiento:"ENTRADA",referencia:he,usuario:le,fecha_salida:O})),me=await ae.from("registro_de_inventario").insert(te);me.error&&(console.warn("Error registrando en registro_de_inventario",me.error),Q("Compra guardada, pero fall el registro en inventario: "+me.error.message))}catch(he){console.warn("Registro inventario fallo",he)}fe(),a(),r&&r()}catch(U){Q(U?.message||String(U))}finally{V(!1)}}const C=X();return s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[s.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Proveedor"}),s.jsxs("select",{className:"input",value:m??"",onChange:U=>v(U.target.value||null),children:[s.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(U=>s.jsx("option",{value:U.id,children:U.nombre},String(U.id)))]}),s.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),s.jsx("input",{className:"input",value:_,onChange:U=>x(U.target.value)}),s.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),s.jsx("input",{className:"input",value:b,onChange:U=>w(U.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsxs("select",{className:"input",value:T??"",onChange:U=>I(U.target.value||null),children:[s.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(U=>s.jsx("option",{value:U.id,children:U.nombre},U.id))]}),s.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:U=>K(Number(U.target.value))}),s.jsx("input",{className:"input",type:"number",style:{width:120},value:E??"",onChange:U=>M(Number(U.target.value)),placeholder:"Costo unitario"}),s.jsx("button",{className:"btn-primary",onClick:xe,children:"Agregar"})]}),s.jsx("div",{style:{marginTop:12},children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Cantidad"}),s.jsx("th",{children:"Costo unit."}),s.jsx("th",{children:"Impuesto"}),s.jsx("th",{children:"Subtotal"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:A.map((U,ee)=>{const ge=U.cantidad*U.costo_unitario,pe=g>1?g/100:g,N=U.exento?0:ge*pe,D=U.exento?ge:ge-N;return s.jsxs("tr",{children:[s.jsx("td",{children:U.nombre}),s.jsx("td",{children:U.cantidad}),s.jsx("td",{children:U.costo_unitario.toFixed(2)}),s.jsx("td",{children:N.toFixed(2)}),s.jsx("td",{children:D.toFixed(2)}),s.jsx("td",{children:s.jsx("button",{className:"btn-opaque",onClick:()=>q(ee),children:"Quitar"})})]},`${U.producto_id}-${ee}`)})})]})})]})]}),s.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:s.jsxs("div",{style:{textAlign:"right"},children:[s.jsxs("div",{children:["Subtotal: ",s.jsx("strong",{children:C.subtotal.toFixed(2)})]}),s.jsxs("div",{children:["Impuesto: ",s.jsx("strong",{children:C.impuesto.toFixed(2)})]}),s.jsxs("div",{children:["Total: ",s.jsx("strong",{children:C.total.toFixed(2)})]})]})}),ye&&s.jsx("div",{style:{color:"red",marginTop:12},children:ye}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:()=>{fe(),a()},disabled:L,children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:W,disabled:L,children:L?"Guardando...":"Confirmar compra"})]})]})})}function nx({open:o,compraId:a,onClose:r}){const[l,u]=S.useState([]),[d,h]=S.useState({}),[g,p]=S.useState({}),[m,v]=S.useState(0),[_,x]=S.useState(!1);return S.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{x(!0);try{const{data:w,error:A}=await ae.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(A)throw A;const R=Array.isArray(w)?w:[];if(!b)return;u(R);const T=Array.from(new Set(R.map(I=>I.producto_id))).filter(Boolean);if(T.length>0){const{data:I}=await ae.from("inventario").select("id, nombre, exento").in("id",T),B={},K={};Array.isArray(I)&&I.forEach(E=>{B[String(E.id)]={id:E.id,nombre:E.nombre},K[String(E.id)]=E.exento===!0||E.exento===1||String(E.exento).toLowerCase()==="true"}),b&&(h(B),p(K))}else h({});try{const{data:I}=await ae.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),B=Array.isArray(I)&&I.length>0?I[0]:null,K=B?Number(B.impuesto_venta):0;b&&v(K)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&x(!1)}})(),()=>{b=!1}},[o,a]),o?s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[s.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),s.jsx("div",{style:{marginTop:8},children:_?s.jsx("div",{children:"Cargando..."}):s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Cantidad"}),s.jsx("th",{children:"Costo unit."}),s.jsx("th",{children:"Impuesto"}),s.jsx("th",{children:"Subtotal"}),s.jsx("th",{children:"Total"})]})}),s.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),A=Number(b.costo_unitario),R=w*A,T=m>1?m/100:m,I=g[String(b.producto_id)]===!0,B=I?0:R*T,K=I?R:R-B;return s.jsxs("tr",{children:[s.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),s.jsx("td",{children:w.toFixed(2)}),s.jsx("td",{children:A.toFixed(2)}),s.jsx("td",{children:B.toFixed(2)}),s.jsx("td",{children:K.toFixed(2)}),s.jsx("td",{children:R.toFixed(2)})]},String(b.id))})}),s.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,A)=>{const R=Number(A.cantidad),T=Number(A.costo_unitario),I=R*T,B=m>1?m/100:m,K=g[String(A.producto_id)]===!0,E=K?0:I*B,M=K?I:I-E;return w.subtotal+=M,w.impuesto+=E,w.total+=I,w},{subtotal:0,impuesto:0,total:0});return s.jsxs("tr",{children:[s.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),s.jsx("td",{children:b.impuesto.toFixed(2)}),s.jsx("td",{children:b.subtotal.toFixed(2)}),s.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),s.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:s.jsx("button",{className:"btn-opaque",onClick:r,children:"Cerrar"})})]})}):null}function ax(){const[o,a]=S.useState([]),[r,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(!1),[p,m]=S.useState(!1),[v,_]=S.useState(null),[x,b]=S.useState([]),[w,A]=S.useState(""),[R,T]=S.useState(""),[I,B]=S.useState(!1);async function K(){l(!0),d(null);try{let E=ae.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const V=Number(w);isNaN(V)?E=E.eq("proveedor_id",w):E=E.eq("proveedor_id",V)}if(R&&(E=E.ilike("numero_documento",`%${R}%`)),I){const V=new Date(Date.now()-864e5).toISOString();E=E.gte("fecha_compra",V)}const{data:M,error:L}=await E.order("id",{ascending:!1});if(L)throw L;a(Array.isArray(M)?M:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}return S.useEffect(()=>{K()},[]),S.useEffect(()=>{let E=!0;return(async()=>{try{const{data:M}=await ae.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!E)return;b(Array.isArray(M)?M:[])}catch{}})(),()=>{E=!1}},[]),s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsxs("select",{className:"input",value:w,onChange:E=>A(E.target.value),children:[s.jsx("option",{value:"",children:"-- proveedor (todos) --"}),x.map(E=>s.jsx("option",{value:String(E.id),children:E.nombre},String(E.id)))]}),s.jsx("input",{className:"input",placeholder:"Nmero documento",value:R,onChange:E=>T(E.target.value)}),s.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[s.jsx("input",{type:"checkbox",checked:I,onChange:E=>B(E.target.checked)})," ltimas 24h"]}),s.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Aplicar"}),s.jsx("button",{className:"btn-opaque",onClick:()=>{A(""),T(""),B(!1),K()},children:"Limpiar"})]}),s.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[s.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Recargar"}),s.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),s.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:r?"Cargando...":`${o.length} compras`})]})]}),u&&s.jsx("div",{style:{color:"red",marginBottom:12},children:u}),s.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Proveedor"}),s.jsx("th",{children:"Documento"}),s.jsx("th",{children:"Fecha"}),s.jsx("th",{children:"Subtotal"}),s.jsx("th",{children:"Impuesto"}),s.jsx("th",{children:"Total"})]})}),s.jsx("tbody",{children:o.map(E=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:80},children:String(E.id)}),s.jsx("td",{children:String(E.proveedor_id)}),s.jsx("td",{children:E.numero_documento||""}),s.jsx("td",{children:E.fecha_compra||""}),s.jsx("td",{children:E.subtotal||""}),s.jsx("td",{children:E.impuesto||""}),s.jsx("td",{children:E.total||""}),s.jsx("td",{children:s.jsx("button",{className:"btn-opaque",onClick:()=>{_(E.id),m(!0)},children:"Detalle"})})]},String(E.id)))})]})}),s.jsx(tx,{open:h,onClose:()=>g(!1),onCreated:()=>{g(!1),K()}}),s.jsx(nx,{open:p,compraId:v,onClose:()=>{m(!1),_(null)}})]})}function ix(){const[o,a]=S.useState([]),[r,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(!1),[p,m]=S.useState(null);async function v(){l(!0),d(null);try{const{data:_,error:x}=await ae.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(x)throw x;a(Array.isArray(_)?_.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(_){d(_?.message||String(_)),a([])}finally{l(!1)}}return S.useEffect(()=>{v()},[]),s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),s.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),s.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[s.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),s.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${o.length} devoluciones`})]}),u&&s.jsx("div",{style:{color:"red",marginBottom:12},children:u}),s.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Proveedor"}),s.jsx("th",{children:"Documento"}),s.jsx("th",{children:"Usuario"}),s.jsx("th",{children:"Fecha"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:o.map(_=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:80},children:String(_.id)}),s.jsx("td",{children:String(_.proveedor_id||"")}),s.jsx("td",{children:_.numero_documento||""}),s.jsx("td",{children:_.usuario||""}),s.jsx("td",{children:_.fecha||""}),s.jsx("td",{children:s.jsx("button",{className:"btn-opaque",onClick:()=>m(_.id),children:"Detalle"})})]},String(_.id)))})]})}),h&&s.jsx(rx,{onClose:()=>{g(!1),v()}}),p&&s.jsx(sx,{id:p,onClose:()=>{m(null),v()}})]})}function rx({onClose:o}){const[a,r]=S.useState([]),[l,u]=S.useState([]),[d,h]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(null),[_,x]=S.useState(null),[b,w]=S.useState(""),[A,R]=S.useState([]),[T,I]=S.useState(null),[B,K]=S.useState(1),[E,M]=S.useState(!1),[L,V]=S.useState(null);S.useEffect(()=>{(async()=>{try{const q=await ae.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});r(Array.isArray(q.data)?q.data:[])}catch{}try{const q=await ae.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(q.data)?q.data:[])}catch{}})()},[]);async function ye(){if(b){V(null);try{const{data:q,error:X}=await ae.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(X)throw X;if(!q){V("No se encontr compra con ese nmero de documento");return}h(q.id),v(q.proveedor_id);try{const{data:J}=await ae.from("proveedores").select("id, nombre").eq("id",q.proveedor_id).limit(1).single();J&&J.nombre&&x(J.nombre)}catch{}const{data:W}=await ae.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",q.id),C=Array.isArray(W)?W:[],{data:U}=await ae.from("devoluciones_proveedores").select("id").eq("numero_documento",b),ee=Array.isArray(U)?U.map(J=>J.id):[];let ge={};if(ee.length>0){const{data:J}=await ae.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",ee);Array.isArray(J)&&J.forEach(he=>{const le=String(he.producto_id);ge[le]=(ge[le]||0)+Number(he.cantidad)})}const pe=C.map(J=>J.producto_id),{data:N}=await ae.from("inventario").select("id, nombre, sku").in("id",pe),D={};Array.isArray(N)&&N.forEach(J=>{D[String(J.id)]=J});const P=C.map(J=>{const he=String(J.producto_id),le=Number(J.cantidad),O=ge[he]||0,te=Math.max(0,le-O);return{producto_id:he,nombre:D[he]?.nombre||he,sku:D[he]?.sku,purchased:le,returned:O,available:te,costo_unitario:Number(J.costo_unitario||0)}});p(P),u(P.map(J=>({id:J.producto_id,nombre:J.nombre,sku:J.sku})))}catch(q){V(q?.message||String(q))}}}function Q(){if(!T){V("Selecciona un producto");return}if(!B||B<=0){V("Cantidad invlida");return}const q=l.find(W=>W.id===T),X=g.find(W=>W.producto_id===T);if(X&&B>X.available){V(`Cantidad excede disponible para devolucin (${X.available})`);return}R(W=>[...W,{producto_id:T,nombre:q?.nombre,cantidad:B}]),I(null),K(1),V(null),X&&(p(W=>W.map(C=>C.producto_id===X.producto_id?{...C,available:Math.max(0,C.available-B)}:C)),u(W=>W.map(C=>(C.id===X.producto_id,C))))}function fe(q){R(X=>X.filter((W,C)=>C!==q))}async function xe(){if(V(null),!m){V("Selecciona un proveedor");return}if(A.length===0){V("Agrega al menos un producto");return}M(!0);try{const q={proveedor_id:m,numero_documento:b||null,usuario:null},X=await ae.from("devoluciones_proveedores").insert(q).select("id").single();if(X.error)throw X.error;const W=X.data.id;try{const C=A.map(ee=>({devolucion_id:W,producto_id:ee.producto_id,cantidad:ee.cantidad})),U=await ae.from("devoluciones_proveedores_detalle").insert(C);U.error&&console.warn("No se pudo insertar detalles de devolucin",U.error)}catch(C){console.warn("Detalles tabla puede no existir",C)}try{const C=b?`Devolucin - ${b}`:`Devolucin ${W}`;let U="sistema";try{const N=localStorage.getItem("user");if(N){const D=JSON.parse(N);U=D.username?`${D.username}${D.role?` (${D.role})`:""}`:String(D)}}catch{}const ee=new Date().toISOString(),ge=A.map(N=>({producto_id:N.producto_id,cantidad:N.cantidad,tipo_de_movimiento:"SALIDA",referencia:C,usuario:U,fecha_salida:ee})),pe=await ae.from("registro_de_inventario").insert(ge);pe.error&&(console.warn("Error registrando en registro_de_inventario",pe.error),V("Devolucin guardada, pero fall el registro en inventario: "+pe.error.message))}catch(C){console.warn("Registro inventario fallo",C)}o()}catch(q){V(q?.message||String(q))}finally{M(!1)}}return s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[s.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),s.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?s.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:_||String(m||"")}):s.jsxs("select",{className:"input",value:m??"",onChange:q=>v(q.target.value||null),children:[s.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(q=>s.jsx("option",{value:q.id,children:q.nombre},String(q.id)))]}),s.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("input",{className:"input",value:b,onChange:q=>w(q.target.value)}),s.jsx("button",{className:"btn-opaque",onClick:()=>ye(),children:"Buscar compra"})]}),d&&s.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&s.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[s.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[s.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),s.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Comprado"}),s.jsx("th",{children:"Devuelto"}),s.jsx("th",{children:"Disponible"}),s.jsx("th",{})]})}),s.jsx("tbody",{children:g.map(q=>s.jsxs("tr",{children:[s.jsx("td",{children:q.nombre}),s.jsx("td",{style:{textAlign:"right"},children:Number(q.purchased).toFixed(2)}),s.jsx("td",{style:{textAlign:"right"},children:Number(q.returned).toFixed(2)}),s.jsx("td",{style:{textAlign:"right"},children:Number(q.available).toFixed(2)}),s.jsx("td",{style:{textAlign:"right"},children:s.jsx("button",{className:"btn-opaque",onClick:()=>{I(q.producto_id),K(q.available||1)},children:"Usar"})})]},q.producto_id))})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),s.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[s.jsxs("select",{className:"input",value:T??"",onChange:q=>I(q.target.value||null),disabled:!!d,children:[s.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(q=>s.jsx("option",{value:q.id,children:q.nombre},q.id))]}),s.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:q=>{const X=Number(q.target.value),W=g.find(C=>C.producto_id===T);if(W){const C=Number(W.available||0);return isNaN(X)||X<1?K(1):X>C?K(C):K(X)}K(X)},min:1,max:T?g.find(q=>q.producto_id===T)?.available??void 0:void 0,disabled:(()=>{const q=g.find(X=>X.producto_id===T);return!!q&&Number(q.available||0)<=1})()}),s.jsx("button",{className:"btn-primary",onClick:Q,children:"Agregar"})]}),s.jsx("div",{style:{marginTop:12},children:s.jsxs("table",{className:"admin-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Cantidad"}),s.jsx("th",{children:"Acciones"})]})}),s.jsx("tbody",{children:A.map((q,X)=>s.jsxs("tr",{children:[s.jsx("td",{children:q.nombre}),s.jsx("td",{style:{textAlign:"right"},children:q.cantidad}),s.jsx("td",{children:s.jsx("button",{className:"btn-opaque",onClick:()=>fe(X),children:"Quitar"})})]},`${q.producto_id}-${X}`))})]})})]})]}),L&&s.jsx("div",{style:{color:"red",marginTop:12},children:L}),s.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[s.jsx("button",{className:"btn-opaque",onClick:o,disabled:E,children:"Cancelar"}),s.jsx("button",{className:"btn-primary",onClick:xe,disabled:E,children:E?"Guardando...":"Registrar devolucin"})]})]})})}function sx({id:o,onClose:a}){const[r,l]=S.useState([]),[u,d]=S.useState(!1),[h,g]=S.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await ae.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const _=Array.isArray(m)?m:[];if(_.length>0){const x=_.map(A=>A.producto_id),{data:b}=await ae.from("inventario").select("id, nombre, sku").in("id",x),w={};Array.isArray(b)&&b.forEach(A=>{w[String(A.id)]=A}),l(_.map(A=>({producto:w[String(A.producto_id)]?.nombre||String(A.producto_id),cantidad:A.cantidad})))}else{const{data:x}=await ae.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(x)?x:[],w=b.map(T=>T.producto_id),{data:A}=await ae.from("inventario").select("id, nombre, sku").in("id",w),R={};Array.isArray(A)&&A.forEach(T=>{R[String(T.id)]=T}),l(b.map(T=>({producto:R[String(T.producto_id)]?.nombre||String(T.producto_id),cantidad:T.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return S.useEffect(()=>{p()},[o]),s.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:s.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[s.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&s.jsx("div",{children:"Cargando..."}),h&&s.jsx("div",{style:{color:"red"},children:h}),s.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Producto"}),s.jsx("th",{children:"Cantidad"})]})}),s.jsx("tbody",{children:r.map((m,v)=>s.jsxs("tr",{children:[s.jsx("td",{children:m.producto}),s.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),s.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:s.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const lx={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function ox(){const[o,a]=S.useState([]),[r,l]=S.useState(!1),[u,d]=S.useState(null),[h,g]=S.useState(null),[p,m]=S.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await ae.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};S.useEffect(()=>{v()},[]);const _=(b,w)=>{a(A=>A.map(R=>R.id===b?{...R,impuesto_venta:w}:R))},x=async b=>{const w=o.find(A=>A.id===b);if(w){d(b),m(null);try{const A={impuesto_venta:w.impuesto_venta??null},{error:R}=await ae.from("impuesto").update(A).eq("id",b);if(R)throw R;await v()}catch(A){console.warn("Error guardando impuesto:",A),m(String(A.message||A))}finally{d(null)}}};return s.jsxs("div",{children:[s.jsx("h2",{children:"Impuestos"}),s.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),r?s.jsx("div",{children:"Cargando..."}):s.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>s.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[s.jsx("div",{style:{fontWeight:700,marginBottom:8},children:lx[b.id]??`Impuesto #${b.id}`}),s.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),s.jsxs("div",{style:{marginBottom:8},children:[s.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),s.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>_(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:h!==b.id}),s.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:h===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[s.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),s.jsx("div",{style:{display:"flex",gap:8},children:h===b.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),s.jsx("button",{onClick:()=>x(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):s.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&s.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&s.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const cx={dashboard:v_,datos:x_,usuarios_internal:S_,usuarios_web:j_,cai:C_,facturas:T_,historial_facturas:A_,inventario_productos:z_,precios_productos:B_,precios_historico:M_,stock:q_,inventario_salidas:I_,inventario_categorias:H_,proveedores:ex,caja_sesiones:$_,caja_movimientos:V_,rep_ventas:P_,rep_devoluciones:G_,rep_ingresos_egresos:K_,rep_compras:Y_,compras_main:ax,devoluciones_proveedores:ix,rep_export:F_,cuentas_contables:J_,libro_diario:Q_,auditoria:X_,impuestos:ox};function ux({onLogout:o}){const[a,r]=S.useState("dashboard"),[l,u]=S.useState(null),[d,h]=S.useState({}),g=l||a,p=cx[g],v=(x=>{for(const b of sp){if(b.id===x)return b.label;if(b.children){const w=b.children.find(A=>A.id===x);if(w)return w.label}}return"Panel de Administracin"})(g),_=x=>{if(x.id==="salir")return o();x.children&&x.children.length>0?(h(b=>({...b,[x.id]:!b[x.id]})),(x.id!==a||!l)&&(r(x.id),u(x.children[0].id))):(r(x.id),u(null))};return s.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[s.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[s.jsx("strong",{children:"Panel Admin"}),s.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),s.jsx("nav",{children:sp.map(x=>s.jsxs("div",{style:{marginBottom:6},children:[s.jsxs("div",{onClick:()=>_(x),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===x.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[s.jsx("span",{children:x.label}),Array.isArray(x.children)&&x.children.length>0?s.jsx("span",{style:{marginLeft:8},children:d[x.id]?"":""}):null]}),Array.isArray(x.children)&&x.children.length>0&&d[x.id]&&s.jsx("div",{style:{marginLeft:12,marginTop:6},children:x.children.map(b=>s.jsx("div",{onClick:()=>{r(x.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},x.id))})]}),s.jsx("main",{style:{flex:1,padding:24},children:p?s.jsx(p,{}):s.jsx(y_,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function dx(){const[o,a]=S.useState(null);S.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]);function r(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return s.jsxs("div",{children:[!o&&s.jsx(P0,{onLogin:r}),o&&o.role==="cajero"&&s.jsx(f_,{onLogout:l}),o&&o.role==="admin"&&s.jsx(ux,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&s.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[s.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),s.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',s.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),s.jsx("div",{style:{marginTop:18},children:s.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class fx extends Nu.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,r){console.error("ErrorBoundary caught:",a,r),this.setState({error:a,info:r})}render(){return this.state.error?s.jsxs("div",{style:{padding:18},children:[s.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),s.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[s.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}xv.createRoot(document.getElementById("root")).render(s.jsx(fx,{children:s.jsx(dx,{})}));
