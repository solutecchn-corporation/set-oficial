function fv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function dp(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function hv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var nu={exports:{}},as={};var Sg;function gv(){if(Sg)return as;Sg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var h=null;if(d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:h,ref:u!==void 0?u:null,props:d}}return as.Fragment=a,as.jsx=s,as.jsxs=s,as}var wg;function pv(){return wg||(wg=1,nu.exports=gv()),nu.exports}var i=pv(),au={exports:{}},is={},iu={exports:{}},ru={};var Eg;function mv(){return Eg||(Eg=1,(function(o){function a(E,z){var ee=E.length;E.push(z);e:for(;0<ee;){var F=ee-1>>>1,pe=E[F];if(0<u(pe,z))E[F]=z,E[ee]=pe,ee=F;else break e}}function s(E){return E.length===0?null:E[0]}function l(E){if(E.length===0)return null;var z=E[0],ee=E.pop();if(ee!==z){E[0]=ee;e:for(var F=0,pe=E.length,N=pe>>>1;F<N;){var D=2*(F+1)-1,P=E[D],Q=D+1,me=E[Q];if(0>u(P,ee))Q<pe&&0>u(me,P)?(E[F]=me,E[Q]=ee,F=Q):(E[F]=P,E[D]=ee,F=D);else if(Q<pe&&0>u(me,ee))E[F]=me,E[Q]=ee,F=Q;else break e}}return z}function u(E,z){var ee=E.sortIndex-z.sortIndex;return ee!==0?ee:E.id-z.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();o.unstable_now=function(){return h.now()-g}}var p=[],m=[],v=1,x=null,_=3,b=!1,w=!1,R=!1,A=!1,T=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(E){for(var z=s(m);z!==null;){if(z.callback===null)l(m);else if(z.startTime<=E)l(m),z.sortIndex=z.expirationTime,a(p,z);else break;z=s(m)}}function C(E){if(R=!1,G(E),!w)if(s(p)!==null)w=!0,L||(L=!0,_e());else{var z=s(m);z!==null&&Z(C,z.startTime-E)}}var L=!1,U=-1,$=5,be=-1;function J(){return A?!0:!(o.unstable_now()-be<$)}function ue(){if(A=!1,L){var E=o.unstable_now();be=E;var z=!0;try{e:{w=!1,R&&(R=!1,I(U),U=-1),b=!0;var ee=_;try{t:{for(G(E),x=s(p);x!==null&&!(x.expirationTime>E&&J());){var F=x.callback;if(typeof F=="function"){x.callback=null,_=x.priorityLevel;var pe=F(x.expirationTime<=E);if(E=o.unstable_now(),typeof pe=="function"){x.callback=pe,G(E),z=!0;break t}x===s(p)&&l(p),G(E)}else l(p);x=s(p)}if(x!==null)z=!0;else{var N=s(m);N!==null&&Z(C,N.startTime-E),z=!1}}break e}finally{x=null,_=ee,b=!1}z=void 0}}finally{z?_e():L=!1}}}var _e;if(typeof M=="function")_e=function(){M(ue)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,W=q.port2;q.port1.onmessage=ue,_e=function(){W.postMessage(null)}}else _e=function(){T(ue,0)};function Z(E,z){U=T(function(){E(o.unstable_now())},z)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(E){E.callback=null},o.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<E?Math.floor(1e3/E):5},o.unstable_getCurrentPriorityLevel=function(){return _},o.unstable_next=function(E){switch(_){case 1:case 2:case 3:var z=3;break;default:z=_}var ee=_;_=z;try{return E()}finally{_=ee}},o.unstable_requestPaint=function(){A=!0},o.unstable_runWithPriority=function(E,z){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var ee=_;_=E;try{return z()}finally{_=ee}},o.unstable_scheduleCallback=function(E,z,ee){var F=o.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?F+ee:F):ee=F,E){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ee+pe,E={id:v++,callback:z,priorityLevel:E,startTime:ee,expirationTime:pe,sortIndex:-1},ee>F?(E.sortIndex=ee,a(m,E),s(p)===null&&E===s(m)&&(R?(I(U),U=-1):R=!0,Z(C,ee-F))):(E.sortIndex=pe,a(p,E),w||b||(w=!0,L||(L=!0,_e()))),E},o.unstable_shouldYield=J,o.unstable_wrapCallback=function(E){var z=_;return function(){var ee=_;_=z;try{return E.apply(this,arguments)}finally{_=ee}}}})(ru)),ru}var Cg;function yv(){return Cg||(Cg=1,iu.exports=mv()),iu.exports}var su={exports:{}},Le={};var Tg;function vv(){if(Tg)return Le;Tg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),_=Symbol.iterator;function b(N){return N===null||typeof N!="object"?null:(N=_&&N[_]||N["@@iterator"],typeof N=="function"?N:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,A={};function T(N,D,P){this.props=N,this.context=D,this.refs=A,this.updater=P||w}T.prototype.isReactComponent={},T.prototype.setState=function(N,D){if(typeof N!="object"&&typeof N!="function"&&N!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,N,D,"setState")},T.prototype.forceUpdate=function(N){this.updater.enqueueForceUpdate(this,N,"forceUpdate")};function I(){}I.prototype=T.prototype;function M(N,D,P){this.props=N,this.context=D,this.refs=A,this.updater=P||w}var G=M.prototype=new I;G.constructor=M,R(G,T.prototype),G.isPureReactComponent=!0;var C=Array.isArray;function L(){}var U={H:null,A:null,T:null,S:null},$=Object.prototype.hasOwnProperty;function be(N,D,P){var Q=P.ref;return{$$typeof:o,type:N,key:D,ref:Q!==void 0?Q:null,props:P}}function J(N,D){return be(N.type,D,N.props)}function ue(N){return typeof N=="object"&&N!==null&&N.$$typeof===o}function _e(N){var D={"=":"=0",":":"=2"};return"$"+N.replace(/[=:]/g,function(P){return D[P]})}var q=/\/+/g;function W(N,D){return typeof N=="object"&&N!==null&&N.key!=null?_e(""+N.key):D.toString(36)}function Z(N){switch(N.status){case"fulfilled":return N.value;case"rejected":throw N.reason;default:switch(typeof N.status=="string"?N.then(L,L):(N.status="pending",N.then(function(D){N.status==="pending"&&(N.status="fulfilled",N.value=D)},function(D){N.status==="pending"&&(N.status="rejected",N.reason=D)})),N.status){case"fulfilled":return N.value;case"rejected":throw N.reason}}throw N}function E(N,D,P,Q,me){var ge=typeof N;(ge==="undefined"||ge==="boolean")&&(N=null);var O=!1;if(N===null)O=!0;else switch(ge){case"bigint":case"string":case"number":O=!0;break;case"object":switch(N.$$typeof){case o:case a:O=!0;break;case v:return O=N._init,E(O(N._payload),D,P,Q,me)}}if(O)return me=me(N),O=Q===""?"."+W(N,0):Q,C(me)?(P="",O!=null&&(P=O.replace(q,"$&/")+"/"),E(me,D,P,"",function(Se){return Se})):me!=null&&(ue(me)&&(me=J(me,P+(me.key==null||N&&N.key===me.key?"":(""+me.key).replace(q,"$&/")+"/")+O)),D.push(me)),1;O=0;var ne=Q===""?".":Q+":";if(C(N))for(var ve=0;ve<N.length;ve++)Q=N[ve],ge=ne+W(Q,ve),O+=E(Q,D,P,ge,me);else if(ve=b(N),typeof ve=="function")for(N=ve.call(N),ve=0;!(Q=N.next()).done;)Q=Q.value,ge=ne+W(Q,ve++),O+=E(Q,D,P,ge,me);else if(ge==="object"){if(typeof N.then=="function")return E(Z(N),D,P,Q,me);throw D=String(N),Error("Objects are not valid as a React child (found: "+(D==="[object Object]"?"object with keys {"+Object.keys(N).join(", ")+"}":D)+"). If you meant to render a collection of children, use an array instead.")}return O}function z(N,D,P){if(N==null)return N;var Q=[],me=0;return E(N,Q,"","",function(ge){return D.call(P,ge,me++)}),Q}function ee(N){if(N._status===-1){var D=N._result;D=D(),D.then(function(P){(N._status===0||N._status===-1)&&(N._status=1,N._result=P)},function(P){(N._status===0||N._status===-1)&&(N._status=2,N._result=P)}),N._status===-1&&(N._status=0,N._result=D)}if(N._status===1)return N._result.default;throw N._result}var F=typeof reportError=="function"?reportError:function(N){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var D=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof N=="object"&&N!==null&&typeof N.message=="string"?String(N.message):String(N),error:N});if(!window.dispatchEvent(D))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",N);return}console.error(N)},pe={map:z,forEach:function(N,D,P){z(N,function(){D.apply(this,arguments)},P)},count:function(N){var D=0;return z(N,function(){D++}),D},toArray:function(N){return z(N,function(D){return D})||[]},only:function(N){if(!ue(N))throw Error("React.Children.only expected to receive a single React element child.");return N}};return Le.Activity=x,Le.Children=pe,Le.Component=T,Le.Fragment=s,Le.Profiler=u,Le.PureComponent=M,Le.StrictMode=l,Le.Suspense=p,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Le.__COMPILER_RUNTIME={__proto__:null,c:function(N){return U.H.useMemoCache(N)}},Le.cache=function(N){return function(){return N.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(N,D,P){if(N==null)throw Error("The argument must be a React element, but you passed "+N+".");var Q=R({},N.props),me=N.key;if(D!=null)for(ge in D.key!==void 0&&(me=""+D.key),D)!$.call(D,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&D.ref===void 0||(Q[ge]=D[ge]);var ge=arguments.length-2;if(ge===1)Q.children=P;else if(1<ge){for(var O=Array(ge),ne=0;ne<ge;ne++)O[ne]=arguments[ne+2];Q.children=O}return be(N.type,me,Q)},Le.createContext=function(N){return N={$$typeof:h,_currentValue:N,_currentValue2:N,_threadCount:0,Provider:null,Consumer:null},N.Provider=N,N.Consumer={$$typeof:d,_context:N},N},Le.createElement=function(N,D,P){var Q,me={},ge=null;if(D!=null)for(Q in D.key!==void 0&&(ge=""+D.key),D)$.call(D,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(me[Q]=D[Q]);var O=arguments.length-2;if(O===1)me.children=P;else if(1<O){for(var ne=Array(O),ve=0;ve<O;ve++)ne[ve]=arguments[ve+2];me.children=ne}if(N&&N.defaultProps)for(Q in O=N.defaultProps,O)me[Q]===void 0&&(me[Q]=O[Q]);return be(N,ge,me)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(N){return{$$typeof:g,render:N}},Le.isValidElement=ue,Le.lazy=function(N){return{$$typeof:v,_payload:{_status:-1,_result:N},_init:ee}},Le.memo=function(N,D){return{$$typeof:m,type:N,compare:D===void 0?null:D}},Le.startTransition=function(N){var D=U.T,P={};U.T=P;try{var Q=N(),me=U.S;me!==null&&me(P,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(L,F)}catch(ge){F(ge)}finally{D!==null&&P.types!==null&&(D.types=P.types),U.T=D}},Le.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Le.use=function(N){return U.H.use(N)},Le.useActionState=function(N,D,P){return U.H.useActionState(N,D,P)},Le.useCallback=function(N,D){return U.H.useCallback(N,D)},Le.useContext=function(N){return U.H.useContext(N)},Le.useDebugValue=function(){},Le.useDeferredValue=function(N,D){return U.H.useDeferredValue(N,D)},Le.useEffect=function(N,D){return U.H.useEffect(N,D)},Le.useEffectEvent=function(N){return U.H.useEffectEvent(N)},Le.useId=function(){return U.H.useId()},Le.useImperativeHandle=function(N,D,P){return U.H.useImperativeHandle(N,D,P)},Le.useInsertionEffect=function(N,D){return U.H.useInsertionEffect(N,D)},Le.useLayoutEffect=function(N,D){return U.H.useLayoutEffect(N,D)},Le.useMemo=function(N,D){return U.H.useMemo(N,D)},Le.useOptimistic=function(N,D){return U.H.useOptimistic(N,D)},Le.useReducer=function(N,D,P){return U.H.useReducer(N,D,P)},Le.useRef=function(N){return U.H.useRef(N)},Le.useState=function(N){return U.H.useState(N)},Le.useSyncExternalStore=function(N,D,P){return U.H.useSyncExternalStore(N,D,P)},Le.useTransition=function(){return U.H.useTransition()},Le.version="19.2.0",Le}var Ag;function Ru(){return Ag||(Ag=1,su.exports=vv()),su.exports}var lu={exports:{}},Vt={};var Ng;function bv(){if(Ng)return Vt;Ng=1;var o=Ru();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:x==null?null:""+x,children:p,containerInfo:m,implementation:v}}var h=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Vt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Vt.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},Vt.flushSync=function(p){var m=h.T,v=l.p;try{if(h.T=null,l.p=2,p)return p()}finally{h.T=m,l.p=v,l.d.f()}},Vt.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},Vt.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Vt.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:x,integrity:_,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Vt.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},Vt.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Vt.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},Vt.requestFormReset=function(p){l.d.r(p)},Vt.unstable_batchedUpdates=function(p,m){return p(m)},Vt.useFormState=function(p,m,v){return h.H.useFormState(p,m,v)},Vt.useFormStatus=function(){return h.H.useHostTransitionStatus()},Vt.version="19.2.0",Vt}var Rg;function fp(){if(Rg)return lu.exports;Rg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),lu.exports=bv(),lu.exports}var Og;function xv(){if(Og)return is;Og=1;var o=yv(),a=Ru(),s=fp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,r=t;;){var c=n.return;if(c===null)break;var f=c.alternate;if(f===null){if(r=c.return,r!==null){n=r;continue}break}if(c.child===f.child){for(f=c.child;f;){if(f===n)return p(c),e;if(f===r)return p(c),t;f=f.sibling}throw Error(l(188))}if(n.return!==r.return)n=c,r=f;else{for(var y=!1,S=c.child;S;){if(S===n){y=!0,n=c,r=f;break}if(S===r){y=!0,r=c,n=f;break}S=S.sibling}if(!y){for(S=f.child;S;){if(S===n){y=!0,n=f,r=c;break}if(S===r){y=!0,r=f,n=c;break}S=S.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==r)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,_=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),M=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),be=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),ue=Symbol.iterator;function _e(e){return e===null||typeof e!="object"?null:(e=ue&&e[ue]||e["@@iterator"],typeof e=="function"?e:null)}var q=Symbol.for("react.client.reference");function W(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case R:return"Fragment";case T:return"Profiler";case A:return"StrictMode";case C:return"Suspense";case L:return"SuspenseList";case be:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case M:return e.displayName||"Context";case I:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case U:return t=e.displayName||null,t!==null?t:W(e.type)||"Memo";case $:t=e._payload,e=e._init;try{return W(e(t))}catch{}}return null}var Z=Array.isArray,E=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},F=[],pe=-1;function N(e){return{current:e}}function D(e){0>pe||(e.current=F[pe],F[pe]=null,pe--)}function P(e,t){pe++,F[pe]=e.current,e.current=t}var Q=N(null),me=N(null),ge=N(null),O=N(null);function ne(e,t){switch(P(ge,t),P(me,e),P(Q,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Fh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Fh(t),e=Kh(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}D(Q),P(Q,e)}function ve(){D(Q),D(me),D(ge)}function Se(e){e.memoizedState!==null&&P(O,e);var t=Q.current,n=Kh(t,e.type);t!==n&&(P(me,e),P(Q,n))}function Ae(e){me.current===e&&(D(Q),D(me)),O.current===e&&(D(O),Wr._currentValue=ee)}var De,Me;function Ye(e){if(De===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);De=t&&t[1]||"",Me=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+De+e+Me}var gt=!1;function pt(e,t){if(!e||gt)return"";gt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var fe=function(){throw Error()};if(Object.defineProperty(fe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(fe,[])}catch(te){var X=te}Reflect.construct(e,[],fe)}else{try{fe.call()}catch(te){X=te}e.call(fe.prototype)}}else{try{throw Error()}catch(te){X=te}(fe=e())&&typeof fe.catch=="function"&&fe.catch(function(){})}}catch(te){if(te&&X&&typeof te.stack=="string")return[te.stack,X.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=r.DetermineComponentFrameRoot(),y=f[0],S=f[1];if(y&&S){var k=y.split(`
`),Y=S.split(`
`);for(c=r=0;r<k.length&&!k[r].includes("DetermineComponentFrameRoot");)r++;for(;c<Y.length&&!Y[c].includes("DetermineComponentFrameRoot");)c++;if(r===k.length||c===Y.length)for(r=k.length-1,c=Y.length-1;1<=r&&0<=c&&k[r]!==Y[c];)c--;for(;1<=r&&0<=c;r--,c--)if(k[r]!==Y[c]){if(r!==1||c!==1)do if(r--,c--,0>c||k[r]!==Y[c]){var se=`
`+k[r].replace(" at new "," at ");return e.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",e.displayName)),se}while(1<=r&&0<=c);break}}}finally{gt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Ye(n):""}function dt(e,t){switch(e.tag){case 26:case 27:case 5:return Ye(e.type);case 16:return Ye("Lazy");case 13:return e.child!==t&&t!==null?Ye("Suspense Fallback"):Ye("Suspense");case 19:return Ye("SuspenseList");case 0:case 15:return pt(e.type,!1);case 11:return pt(e.type.render,!1);case 1:return pt(e.type,!0);case 31:return Ye("Activity");default:return""}}function wt(e){try{var t="",n=null;do t+=dt(e,n),n=e,e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var Ht=Object.prototype.hasOwnProperty,Ze=o.unstable_scheduleCallback,et=o.unstable_cancelCallback,za=o.unstable_shouldYield,fi=o.unstable_requestPaint,Gt=o.unstable_now,hi=o.unstable_getCurrentPriorityLevel,fs=o.unstable_ImmediatePriority,gi=o.unstable_UserBlockingPriority,Ua=o.unstable_NormalPriority,ur=o.unstable_LowPriority,hs=o.unstable_IdlePriority,gs=o.log,dr=o.unstable_setDisableYieldValue,Da=null,Ft=null;function On(e){if(typeof gs=="function"&&dr(e),Ft&&typeof Ft.setStrictMode=="function")try{Ft.setStrictMode(Da,e)}catch{}}var Kt=Math.clz32?Math.clz32:Jl,pi=Math.log,Yl=Math.LN2;function Jl(e){return e>>>=0,e===0?32:31-(pi(e)/Yl|0)|0}var mi=256,yi=262144,vi=4194304;function kn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ba(e,t,n){var r=e.pendingLanes;if(r===0)return 0;var c=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var S=r&134217727;return S!==0?(r=S&~f,r!==0?c=kn(r):(y&=S,y!==0?c=kn(y):n||(n=S&~e,n!==0&&(c=kn(n))))):(S=r&~f,S!==0?c=kn(S):y!==0?c=kn(y):n||(n=r&~e,n!==0&&(c=kn(n)))),c===0?0:t!==0&&t!==c&&(t&f)===0&&(f=c&-c,n=t&-t,f>=n||f===32&&(n&4194048)!==0)?t:c}function La(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function qn(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zn(){var e=vi;return vi<<=1,(vi&62914560)===0&&(vi=4194304),e}function bi(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ma(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ql(e,t,n,r,c,f){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var S=e.entanglements,k=e.expirationTimes,Y=e.hiddenUpdates;for(n=y&~n;0<n;){var se=31-Kt(n),fe=1<<se;S[se]=0,k[se]=-1;var X=Y[se];if(X!==null)for(Y[se]=null,se=0;se<X.length;se++){var te=X[se];te!==null&&(te.lane&=-536870913)}n&=~fe}r!==0&&xi(e,r,0),f!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function xi(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Kt(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|n&261930}function ps(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Kt(n),c=1<<r;c&t|e[r]&t&&(e[r]|=t),n&=~c}}function _i(e,t){var n=t&-t;return n=(n&42)!==0?1:In(n),(n&(e.suspendedLanes|t))!==0?0:n}function In(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function fr(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ms(){var e=z.p;return e!==0?e:(e=window.event,e===void 0?32:mg(e.type))}function ys(e,t){var n=z.p;try{return z.p=e,t()}finally{z.p=n}}var wn=Math.random().toString(36).slice(2),Rt="__reactFiber$"+wn,zt="__reactProps$"+wn,Jt="__reactContainer$"+wn,hr="__reactEvents$"+wn,vs="__reactListeners$"+wn,bs="__reactHandles$"+wn,xs="__reactResources$"+wn,qa="__reactMarker$"+wn;function gr(e){delete e[Rt],delete e[zt],delete e[hr],delete e[vs],delete e[bs]}function H(e){var t=e[Rt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jt]||n[Rt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=eg(e);e!==null;){if(n=e[Rt])return n;e=eg(e)}return t}e=n,n=e.parentNode}return null}function le(e){if(e=e[Rt]||e[Jt]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function xe(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function re(e){var t=e[xs];return t||(t=e[xs]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function oe(e){e[qa]=!0}var ye=new Set,he={};function je(e,t){ae(e,t),ae(e+"Capture",t)}function ae(e,t){for(he[e]=t,e=0;e<t.length;e++)ye.add(t[e])}var de=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),we={},Ce={};function He(e){return Ht.call(Ce,e)?!0:Ht.call(we,e)?!1:de.test(e)?Ce[e]=!0:(we[e]=!0,!1)}function Dt(e,t,n){if(He(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function it(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Je(e,t,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+r)}}function Fe(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Un(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function fn(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var c=r.get,f=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ia(e){if(!e._valueTracker){var t=Un(e)?"checked":"value";e._valueTracker=fn(e,t,""+e[t])}}function pr(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Un(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function sa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Ha=/[\n"\\]/g;function _t(e){return e.replace(Ha,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function ze(e,t,n,r,c,f,y,S){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Fe(t)):e.value!==""+Fe(t)&&(e.value=""+Fe(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?yt(e,y,Fe(t)):n!=null?yt(e,y,Fe(n)):r!=null&&e.removeAttribute("value"),c==null&&f!=null&&(e.defaultChecked=!!f),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.name=""+Fe(S):e.removeAttribute("name")}function tt(e,t,n,r,c,f,y,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||n!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){Ia(e);return}n=n!=null?""+Fe(n):"",t=t!=null?""+Fe(t):n,S||t===e.value||(e.value=t),e.defaultValue=t}r=r??c,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=S?e.checked:!!r,e.defaultChecked=!!r,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Ia(e)}function yt(e,t,n){t==="number"&&sa(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Oe(e,t,n,r){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Fe(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,r&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function ot(e,t,n){if(t!=null&&(t=""+Fe(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Fe(n):""}function $t(e,t,n,r){if(t==null){if(r!=null){if(n!=null)throw Error(l(92));if(Z(r)){if(1<r.length)throw Error(l(93));r=r[0]}n=r}n==null&&(n=""),t=n}n=Fe(t),e.defaultValue=n,r=e.textContent,r===n&&r!==""&&r!==null&&(e.value=r),Ia(e)}function Hn(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var _s=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function $u(e,t,n){var r=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?r?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":r?e.setProperty(t,n):typeof n!="number"||n===0||_s.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Vu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var r in n)!n.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var c in t)r=t[c],t.hasOwnProperty(c)&&n[c]!==r&&$u(e,c,r)}else for(var f in t)t.hasOwnProperty(f)&&$u(e,f,t[f])}function Xl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var om=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function js(e){return cm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function $n(){}var Zl=null;function Wl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ji=null,Si=null;function Pu(e){var t=le(e);if(t&&(e=t.stateNode)){var n=e[zt]||null;e:switch(e=t.stateNode,t.type){case"input":if(ze(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+_t(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var c=r[zt]||null;if(!c)throw Error(l(90));ze(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)r=n[t],r.form===e.form&&pr(r)}break e;case"textarea":ot(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Oe(e,!!n.multiple,t,!1)}}}var eo=!1;function Gu(e,t,n){if(eo)return e(t,n);eo=!0;try{var r=e(t);return r}finally{if(eo=!1,(ji!==null||Si!==null)&&(cl(),ji&&(t=ji,e=Si,Si=ji=null,Pu(t),e)))for(t=0;t<e.length;t++)Pu(e[t])}}function mr(e,t){var n=e.stateNode;if(n===null)return null;var r=n[zt]||null;if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),to=!1;if(Vn)try{var yr={};Object.defineProperty(yr,"passive",{get:function(){to=!0}}),window.addEventListener("test",yr,yr),window.removeEventListener("test",yr,yr)}catch{to=!1}var la=null,no=null,Ss=null;function Fu(){if(Ss)return Ss;var e,t=no,n=t.length,r,c="value"in la?la.value:la.textContent,f=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(r=1;r<=y&&t[n-r]===c[f-r];r++);return Ss=c.slice(e,1<r?1-r:void 0)}function ws(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Es(){return!0}function Ku(){return!1}function Qt(e){function t(n,r,c,f,y){this._reactName=n,this._targetInst=c,this.type=r,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(n=e[S],this[S]=n?n(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Es:Ku,this.isPropagationStopped=Ku,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Es)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Es)},persist:function(){},isPersistent:Es}),t}var $a={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cs=Qt($a),vr=x({},$a,{view:0,detail:0}),um=Qt(vr),ao,io,br,Ts=x({},vr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:so,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==br&&(br&&e.type==="mousemove"?(ao=e.screenX-br.screenX,io=e.screenY-br.screenY):io=ao=0,br=e),ao)},movementY:function(e){return"movementY"in e?e.movementY:io}}),Yu=Qt(Ts),dm=x({},Ts,{dataTransfer:0}),fm=Qt(dm),hm=x({},vr,{relatedTarget:0}),ro=Qt(hm),gm=x({},$a,{animationName:0,elapsedTime:0,pseudoElement:0}),pm=Qt(gm),mm=x({},$a,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ym=Qt(mm),vm=x({},$a,{data:0}),Ju=Qt(vm),bm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_m={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_m[e])?!!t[e]:!1}function so(){return jm}var Sm=x({},vr,{key:function(e){if(e.key){var t=bm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ws(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:so,charCode:function(e){return e.type==="keypress"?ws(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ws(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wm=Qt(Sm),Em=x({},Ts,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qu=Qt(Em),Cm=x({},vr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:so}),Tm=Qt(Cm),Am=x({},$a,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nm=Qt(Am),Rm=x({},Ts,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Om=Qt(Rm),km=x({},$a,{newState:0,oldState:0}),zm=Qt(km),Um=[9,13,27,32],lo=Vn&&"CompositionEvent"in window,xr=null;Vn&&"documentMode"in document&&(xr=document.documentMode);var Dm=Vn&&"TextEvent"in window&&!xr,Xu=Vn&&(!lo||xr&&8<xr&&11>=xr),Zu=" ",Wu=!1;function ed(e,t){switch(e){case"keyup":return Um.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function td(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wi=!1;function Bm(e,t){switch(e){case"compositionend":return td(t);case"keypress":return t.which!==32?null:(Wu=!0,Zu);case"textInput":return e=t.data,e===Zu&&Wu?null:e;default:return null}}function Lm(e,t){if(wi)return e==="compositionend"||!lo&&ed(e,t)?(e=Fu(),Ss=no=la=null,wi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xu&&t.locale!=="ko"?null:t.data;default:return null}}var Mm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Mm[e.type]:t==="textarea"}function ad(e,t,n,r){ji?Si?Si.push(r):Si=[r]:ji=r,t=ml(t,"onChange"),0<t.length&&(n=new Cs("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var _r=null,jr=null;function qm(e){Ih(e,0)}function As(e){var t=xe(e);if(pr(t))return e}function id(e,t){if(e==="change")return t}var rd=!1;if(Vn){var oo;if(Vn){var co="oninput"in document;if(!co){var sd=document.createElement("div");sd.setAttribute("oninput","return;"),co=typeof sd.oninput=="function"}oo=co}else oo=!1;rd=oo&&(!document.documentMode||9<document.documentMode)}function ld(){_r&&(_r.detachEvent("onpropertychange",od),jr=_r=null)}function od(e){if(e.propertyName==="value"&&As(jr)){var t=[];ad(t,jr,e,Wl(e)),Gu(qm,t)}}function Im(e,t,n){e==="focusin"?(ld(),_r=t,jr=n,_r.attachEvent("onpropertychange",od)):e==="focusout"&&ld()}function Hm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return As(jr)}function $m(e,t){if(e==="click")return As(t)}function Vm(e,t){if(e==="input"||e==="change")return As(t)}function Pm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nn=typeof Object.is=="function"?Object.is:Pm;function Sr(e,t){if(nn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var c=n[r];if(!Ht.call(t,c)||!nn(e[c],t[c]))return!1}return!0}function cd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ud(e,t){var n=cd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cd(n)}}function dd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=sa(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=sa(e.document)}return t}function uo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Gm=Vn&&"documentMode"in document&&11>=document.documentMode,Ei=null,fo=null,wr=null,ho=!1;function hd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ho||Ei==null||Ei!==sa(r)||(r=Ei,"selectionStart"in r&&uo(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),wr&&Sr(wr,r)||(wr=r,r=ml(fo,"onSelect"),0<r.length&&(t=new Cs("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ei)))}function Va(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ci={animationend:Va("Animation","AnimationEnd"),animationiteration:Va("Animation","AnimationIteration"),animationstart:Va("Animation","AnimationStart"),transitionrun:Va("Transition","TransitionRun"),transitionstart:Va("Transition","TransitionStart"),transitioncancel:Va("Transition","TransitionCancel"),transitionend:Va("Transition","TransitionEnd")},go={},gd={};Vn&&(gd=document.createElement("div").style,"AnimationEvent"in window||(delete Ci.animationend.animation,delete Ci.animationiteration.animation,delete Ci.animationstart.animation),"TransitionEvent"in window||delete Ci.transitionend.transition);function Pa(e){if(go[e])return go[e];if(!Ci[e])return e;var t=Ci[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in gd)return go[e]=t[n];return e}var pd=Pa("animationend"),md=Pa("animationiteration"),yd=Pa("animationstart"),Fm=Pa("transitionrun"),Km=Pa("transitionstart"),Ym=Pa("transitioncancel"),vd=Pa("transitionend"),bd=new Map,po="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");po.push("scrollEnd");function En(e,t){bd.set(e,t),je(t,[e])}var Ns=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},hn=[],Ti=0,mo=0;function Rs(){for(var e=Ti,t=mo=Ti=0;t<e;){var n=hn[t];hn[t++]=null;var r=hn[t];hn[t++]=null;var c=hn[t];hn[t++]=null;var f=hn[t];if(hn[t++]=null,r!==null&&c!==null){var y=r.pending;y===null?c.next=c:(c.next=y.next,y.next=c),r.pending=c}f!==0&&xd(n,c,f)}}function Os(e,t,n,r){hn[Ti++]=e,hn[Ti++]=t,hn[Ti++]=n,hn[Ti++]=r,mo|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function yo(e,t,n,r){return Os(e,t,n,r),ks(e)}function Ga(e,t){return Os(e,null,null,t),ks(e)}function xd(e,t,n){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n);for(var c=!1,f=e.return;f!==null;)f.childLanes|=n,r=f.alternate,r!==null&&(r.childLanes|=n),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(c=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,c&&t!==null&&(c=31-Kt(n),e=f.hiddenUpdates,r=e[c],r===null?e[c]=[t]:r.push(t),t.lane=n|536870912),f):null}function ks(e){if(50<Fr)throw Fr=0,Cc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ai={};function Jm(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,n,r){return new Jm(e,t,n,r)}function vo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Pn(e,t){var n=e.alternate;return n===null?(n=an(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function _d(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zs(e,t,n,r,c,f){var y=0;if(r=e,typeof e=="function")vo(e)&&(y=1);else if(typeof e=="string")y=ev(e,n,Q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case be:return e=an(31,n,t,c),e.elementType=be,e.lanes=f,e;case R:return Fa(n.children,c,f,t);case A:y=8,c|=24;break;case T:return e=an(12,n,t,c|2),e.elementType=T,e.lanes=f,e;case C:return e=an(13,n,t,c),e.elementType=C,e.lanes=f,e;case L:return e=an(19,n,t,c),e.elementType=L,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:y=10;break e;case I:y=9;break e;case G:y=11;break e;case U:y=14;break e;case $:y=16,r=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),r=null}return t=an(y,n,t,c),t.elementType=e,t.type=r,t.lanes=f,t}function Fa(e,t,n,r){return e=an(7,e,r,t),e.lanes=n,e}function bo(e,t,n){return e=an(6,e,null,t),e.lanes=n,e}function jd(e){var t=an(18,null,null,0);return t.stateNode=e,t}function xo(e,t,n){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Sd=new WeakMap;function gn(e,t){if(typeof e=="object"&&e!==null){var n=Sd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:wt(t)},Sd.set(e,t),t)}return{value:e,source:t,stack:wt(t)}}var Ni=[],Ri=0,Us=null,Er=0,pn=[],mn=0,oa=null,Dn=1,Bn="";function Gn(e,t){Ni[Ri++]=Er,Ni[Ri++]=Us,Us=e,Er=t}function wd(e,t,n){pn[mn++]=Dn,pn[mn++]=Bn,pn[mn++]=oa,oa=e;var r=Dn;e=Bn;var c=32-Kt(r)-1;r&=~(1<<c),n+=1;var f=32-Kt(t)+c;if(30<f){var y=c-c%5;f=(r&(1<<y)-1).toString(32),r>>=y,c-=y,Dn=1<<32-Kt(t)+c|n<<c|r,Bn=f+e}else Dn=1<<f|n<<c|r,Bn=e}function _o(e){e.return!==null&&(Gn(e,1),wd(e,1,0))}function jo(e){for(;e===Us;)Us=Ni[--Ri],Ni[Ri]=null,Er=Ni[--Ri],Ni[Ri]=null;for(;e===oa;)oa=pn[--mn],pn[mn]=null,Bn=pn[--mn],pn[mn]=null,Dn=pn[--mn],pn[mn]=null}function Ed(e,t){pn[mn++]=Dn,pn[mn++]=Bn,pn[mn++]=oa,Dn=t.id,Bn=t.overflow,oa=e}var Bt=null,ft=null,Ke=!1,ca=null,yn=!1,So=Error(l(519));function ua(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Cr(gn(t,e)),So}function Cd(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Rt]=e,t[zt]=r,n){case"dialog":Ve("cancel",t),Ve("close",t);break;case"iframe":case"object":case"embed":Ve("load",t);break;case"video":case"audio":for(n=0;n<Yr.length;n++)Ve(Yr[n],t);break;case"source":Ve("error",t);break;case"img":case"image":case"link":Ve("error",t),Ve("load",t);break;case"details":Ve("toggle",t);break;case"input":Ve("invalid",t),tt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Ve("invalid",t);break;case"textarea":Ve("invalid",t),$t(t,r.value,r.defaultValue,r.children)}n=r.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||r.suppressHydrationWarning===!0||Ph(t.textContent,n)?(r.popover!=null&&(Ve("beforetoggle",t),Ve("toggle",t)),r.onScroll!=null&&Ve("scroll",t),r.onScrollEnd!=null&&Ve("scrollend",t),r.onClick!=null&&(t.onclick=$n),t=!0):t=!1,t||ua(e,!0)}function Td(e){for(Bt=e.return;Bt;)switch(Bt.tag){case 5:case 31:case 13:yn=!1;return;case 27:case 3:yn=!0;return;default:Bt=Bt.return}}function Oi(e){if(e!==Bt)return!1;if(!Ke)return Td(e),Ke=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Hc(e.type,e.memoizedProps)),n=!n),n&&ft&&ua(e),Td(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ft=Wh(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ft=Wh(e)}else t===27?(t=ft,wa(e.type)?(e=Fc,Fc=null,ft=e):ft=t):ft=Bt?bn(e.stateNode.nextSibling):null;return!0}function Ka(){ft=Bt=null,Ke=!1}function wo(){var e=ca;return e!==null&&(en===null?en=e:en.push.apply(en,e),ca=null),e}function Cr(e){ca===null?ca=[e]:ca.push(e)}var Eo=N(null),Ya=null,Fn=null;function da(e,t,n){P(Eo,t._currentValue),t._currentValue=n}function Kn(e){e._currentValue=Eo.current,D(Eo)}function Co(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function To(e,t,n,r){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){var y=c.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=c;for(var k=0;k<t.length;k++)if(S.context===t[k]){f.lanes|=n,S=f.alternate,S!==null&&(S.lanes|=n),Co(f.return,n,e),r||(y=null);break e}f=S.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,f=y.alternate,f!==null&&(f.lanes|=n),Co(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function ki(e,t,n,r){e=null;for(var c=t,f=!1;c!==null;){if(!f){if((c.flags&524288)!==0)f=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var S=c.type;nn(c.pendingProps.value,y.value)||(e!==null?e.push(S):e=[S])}}else if(c===O.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Wr):e=[Wr])}c=c.return}e!==null&&To(t,e,n,r),t.flags|=262144}function Ds(e){for(e=e.firstContext;e!==null;){if(!nn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ja(e){Ya=e,Fn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Lt(e){return Ad(Ya,e)}function Bs(e,t){return Ya===null&&Ja(e),Ad(e,t)}function Ad(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Fn===null){if(e===null)throw Error(l(308));Fn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Fn=Fn.next=t;return n}var Qm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Xm=o.unstable_scheduleCallback,Zm=o.unstable_NormalPriority,Et={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ao(){return{controller:new Qm,data:new Map,refCount:0}}function Tr(e){e.refCount--,e.refCount===0&&Xm(Zm,function(){e.controller.abort()})}var Ar=null,No=0,zi=0,Ui=null;function Wm(e,t){if(Ar===null){var n=Ar=[];No=0,zi=kc(),Ui={status:"pending",value:void 0,then:function(r){n.push(r)}}}return No++,t.then(Nd,Nd),t}function Nd(){if(--No===0&&Ar!==null){Ui!==null&&(Ui.status="fulfilled");var e=Ar;Ar=null,zi=0,Ui=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function ey(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(r.status="rejected",r.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),r}var Rd=E.S;E.S=function(e,t){gh=Gt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Wm(e,t),Rd!==null&&Rd(e,t)};var Qa=N(null);function Ro(){var e=Qa.current;return e!==null?e:ct.pooledCache}function Ls(e,t){t===null?P(Qa,Qa.current):P(Qa,t.pool)}function Od(){var e=Ro();return e===null?null:{parent:Et._currentValue,pool:e}}var Di=Error(l(460)),Oo=Error(l(474)),Ms=Error(l(542)),qs={then:function(){}};function kd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function zd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then($n,$n),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dd(e),e;default:if(typeof t.status=="string")t.then($n,$n);else{if(e=ct,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(r){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=r}},function(r){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dd(e),e}throw Za=t,Di}}function Xa(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Za=n,Di):n}}var Za=null;function Ud(){if(Za===null)throw Error(l(459));var e=Za;return Za=null,e}function Dd(e){if(e===Di||e===Ms)throw Error(l(483))}var Bi=null,Nr=0;function Is(e){var t=Nr;return Nr+=1,Bi===null&&(Bi=[]),zd(Bi,e,t)}function Rr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Hs(e,t){throw t.$$typeof===_?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Bd(e){function t(V,B){if(e){var K=V.deletions;K===null?(V.deletions=[B],V.flags|=16):K.push(B)}}function n(V,B){if(!e)return null;for(;B!==null;)t(V,B),B=B.sibling;return null}function r(V){for(var B=new Map;V!==null;)V.key!==null?B.set(V.key,V):B.set(V.index,V),V=V.sibling;return B}function c(V,B){return V=Pn(V,B),V.index=0,V.sibling=null,V}function f(V,B,K){return V.index=K,e?(K=V.alternate,K!==null?(K=K.index,K<B?(V.flags|=67108866,B):K):(V.flags|=67108866,B)):(V.flags|=1048576,B)}function y(V){return e&&V.alternate===null&&(V.flags|=67108866),V}function S(V,B,K,ce){return B===null||B.tag!==6?(B=bo(K,V.mode,ce),B.return=V,B):(B=c(B,K),B.return=V,B)}function k(V,B,K,ce){var ke=K.type;return ke===R?se(V,B,K.props.children,ce,K.key):B!==null&&(B.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===$&&Xa(ke)===B.type)?(B=c(B,K.props),Rr(B,K),B.return=V,B):(B=zs(K.type,K.key,K.props,null,V.mode,ce),Rr(B,K),B.return=V,B)}function Y(V,B,K,ce){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=xo(K,V.mode,ce),B.return=V,B):(B=c(B,K.children||[]),B.return=V,B)}function se(V,B,K,ce,ke){return B===null||B.tag!==7?(B=Fa(K,V.mode,ce,ke),B.return=V,B):(B=c(B,K),B.return=V,B)}function fe(V,B,K){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=bo(""+B,V.mode,K),B.return=V,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case b:return K=zs(B.type,B.key,B.props,null,V.mode,K),Rr(K,B),K.return=V,K;case w:return B=xo(B,V.mode,K),B.return=V,B;case $:return B=Xa(B),fe(V,B,K)}if(Z(B)||_e(B))return B=Fa(B,V.mode,K,null),B.return=V,B;if(typeof B.then=="function")return fe(V,Is(B),K);if(B.$$typeof===M)return fe(V,Bs(V,B),K);Hs(V,B)}return null}function X(V,B,K,ce){var ke=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return ke!==null?null:S(V,B,""+K,ce);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case b:return K.key===ke?k(V,B,K,ce):null;case w:return K.key===ke?Y(V,B,K,ce):null;case $:return K=Xa(K),X(V,B,K,ce)}if(Z(K)||_e(K))return ke!==null?null:se(V,B,K,ce,null);if(typeof K.then=="function")return X(V,B,Is(K),ce);if(K.$$typeof===M)return X(V,B,Bs(V,K),ce);Hs(V,K)}return null}function te(V,B,K,ce,ke){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return V=V.get(K)||null,S(B,V,""+ce,ke);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case b:return V=V.get(ce.key===null?K:ce.key)||null,k(B,V,ce,ke);case w:return V=V.get(ce.key===null?K:ce.key)||null,Y(B,V,ce,ke);case $:return ce=Xa(ce),te(V,B,K,ce,ke)}if(Z(ce)||_e(ce))return V=V.get(K)||null,se(B,V,ce,ke,null);if(typeof ce.then=="function")return te(V,B,K,Is(ce),ke);if(ce.$$typeof===M)return te(V,B,K,Bs(B,ce),ke);Hs(B,ce)}return null}function Ee(V,B,K,ce){for(var ke=null,Qe=null,Te=B,Ie=B=0,Ge=null;Te!==null&&Ie<K.length;Ie++){Te.index>Ie?(Ge=Te,Te=null):Ge=Te.sibling;var Xe=X(V,Te,K[Ie],ce);if(Xe===null){Te===null&&(Te=Ge);break}e&&Te&&Xe.alternate===null&&t(V,Te),B=f(Xe,B,Ie),Qe===null?ke=Xe:Qe.sibling=Xe,Qe=Xe,Te=Ge}if(Ie===K.length)return n(V,Te),Ke&&Gn(V,Ie),ke;if(Te===null){for(;Ie<K.length;Ie++)Te=fe(V,K[Ie],ce),Te!==null&&(B=f(Te,B,Ie),Qe===null?ke=Te:Qe.sibling=Te,Qe=Te);return Ke&&Gn(V,Ie),ke}for(Te=r(Te);Ie<K.length;Ie++)Ge=te(Te,V,Ie,K[Ie],ce),Ge!==null&&(e&&Ge.alternate!==null&&Te.delete(Ge.key===null?Ie:Ge.key),B=f(Ge,B,Ie),Qe===null?ke=Ge:Qe.sibling=Ge,Qe=Ge);return e&&Te.forEach(function(Na){return t(V,Na)}),Ke&&Gn(V,Ie),ke}function Ue(V,B,K,ce){if(K==null)throw Error(l(151));for(var ke=null,Qe=null,Te=B,Ie=B=0,Ge=null,Xe=K.next();Te!==null&&!Xe.done;Ie++,Xe=K.next()){Te.index>Ie?(Ge=Te,Te=null):Ge=Te.sibling;var Na=X(V,Te,Xe.value,ce);if(Na===null){Te===null&&(Te=Ge);break}e&&Te&&Na.alternate===null&&t(V,Te),B=f(Na,B,Ie),Qe===null?ke=Na:Qe.sibling=Na,Qe=Na,Te=Ge}if(Xe.done)return n(V,Te),Ke&&Gn(V,Ie),ke;if(Te===null){for(;!Xe.done;Ie++,Xe=K.next())Xe=fe(V,Xe.value,ce),Xe!==null&&(B=f(Xe,B,Ie),Qe===null?ke=Xe:Qe.sibling=Xe,Qe=Xe);return Ke&&Gn(V,Ie),ke}for(Te=r(Te);!Xe.done;Ie++,Xe=K.next())Xe=te(Te,V,Ie,Xe.value,ce),Xe!==null&&(e&&Xe.alternate!==null&&Te.delete(Xe.key===null?Ie:Xe.key),B=f(Xe,B,Ie),Qe===null?ke=Xe:Qe.sibling=Xe,Qe=Xe);return e&&Te.forEach(function(dv){return t(V,dv)}),Ke&&Gn(V,Ie),ke}function lt(V,B,K,ce){if(typeof K=="object"&&K!==null&&K.type===R&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case b:e:{for(var ke=K.key;B!==null;){if(B.key===ke){if(ke=K.type,ke===R){if(B.tag===7){n(V,B.sibling),ce=c(B,K.props.children),ce.return=V,V=ce;break e}}else if(B.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===$&&Xa(ke)===B.type){n(V,B.sibling),ce=c(B,K.props),Rr(ce,K),ce.return=V,V=ce;break e}n(V,B);break}else t(V,B);B=B.sibling}K.type===R?(ce=Fa(K.props.children,V.mode,ce,K.key),ce.return=V,V=ce):(ce=zs(K.type,K.key,K.props,null,V.mode,ce),Rr(ce,K),ce.return=V,V=ce)}return y(V);case w:e:{for(ke=K.key;B!==null;){if(B.key===ke)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){n(V,B.sibling),ce=c(B,K.children||[]),ce.return=V,V=ce;break e}else{n(V,B);break}else t(V,B);B=B.sibling}ce=xo(K,V.mode,ce),ce.return=V,V=ce}return y(V);case $:return K=Xa(K),lt(V,B,K,ce)}if(Z(K))return Ee(V,B,K,ce);if(_e(K)){if(ke=_e(K),typeof ke!="function")throw Error(l(150));return K=ke.call(K),Ue(V,B,K,ce)}if(typeof K.then=="function")return lt(V,B,Is(K),ce);if(K.$$typeof===M)return lt(V,B,Bs(V,K),ce);Hs(V,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,B!==null&&B.tag===6?(n(V,B.sibling),ce=c(B,K),ce.return=V,V=ce):(n(V,B),ce=bo(K,V.mode,ce),ce.return=V,V=ce),y(V)):n(V,B)}return function(V,B,K,ce){try{Nr=0;var ke=lt(V,B,K,ce);return Bi=null,ke}catch(Te){if(Te===Di||Te===Ms)throw Te;var Qe=an(29,Te,null,V.mode);return Qe.lanes=ce,Qe.return=V,Qe}finally{}}}var Wa=Bd(!0),Ld=Bd(!1),fa=!1;function ko(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ha(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ga(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(We&2)!==0){var c=r.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),r.pending=t,t=ks(e),xd(e,null,n),t}return Os(e,r,t,n),ks(e)}function Or(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ps(e,n)}}function Uo(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var c=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};f===null?c=f=y:f=f.next=y,n=n.next}while(n!==null);f===null?c=f=t:f=f.next=t}else c=f=t;n={baseState:r.baseState,firstBaseUpdate:c,lastBaseUpdate:f,shared:r.shared,callbacks:r.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Do=!1;function kr(){if(Do){var e=Ui;if(e!==null)throw e}}function zr(e,t,n,r){Do=!1;var c=e.updateQueue;fa=!1;var f=c.firstBaseUpdate,y=c.lastBaseUpdate,S=c.shared.pending;if(S!==null){c.shared.pending=null;var k=S,Y=k.next;k.next=null,y===null?f=Y:y.next=Y,y=k;var se=e.alternate;se!==null&&(se=se.updateQueue,S=se.lastBaseUpdate,S!==y&&(S===null?se.firstBaseUpdate=Y:S.next=Y,se.lastBaseUpdate=k))}if(f!==null){var fe=c.baseState;y=0,se=Y=k=null,S=f;do{var X=S.lane&-536870913,te=X!==S.lane;if(te?(Pe&X)===X:(r&X)===X){X!==0&&X===zi&&(Do=!0),se!==null&&(se=se.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ee=e,Ue=S;X=t;var lt=n;switch(Ue.tag){case 1:if(Ee=Ue.payload,typeof Ee=="function"){fe=Ee.call(lt,fe,X);break e}fe=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Ue.payload,X=typeof Ee=="function"?Ee.call(lt,fe,X):Ee,X==null)break e;fe=x({},fe,X);break e;case 2:fa=!0}}X=S.callback,X!==null&&(e.flags|=64,te&&(e.flags|=8192),te=c.callbacks,te===null?c.callbacks=[X]:te.push(X))}else te={lane:X,tag:S.tag,payload:S.payload,callback:S.callback,next:null},se===null?(Y=se=te,k=fe):se=se.next=te,y|=X;if(S=S.next,S===null){if(S=c.shared.pending,S===null)break;te=S,S=te.next,te.next=null,c.lastBaseUpdate=te,c.shared.pending=null}}while(!0);se===null&&(k=fe),c.baseState=k,c.firstBaseUpdate=Y,c.lastBaseUpdate=se,f===null&&(c.shared.lanes=0),ba|=y,e.lanes=y,e.memoizedState=fe}}function Md(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function qd(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Md(n[e],t)}var Li=N(null),$s=N(0);function Id(e,t){e=na,P($s,e),P(Li,t),na=e|t.baseLanes}function Bo(){P($s,na),P(Li,Li.current)}function Lo(){na=$s.current,D(Li),D($s)}var rn=N(null),vn=null;function pa(e){var t=e.alternate;P(jt,jt.current&1),P(rn,e),vn===null&&(t===null||Li.current!==null||t.memoizedState!==null)&&(vn=e)}function Mo(e){P(jt,jt.current),P(rn,e),vn===null&&(vn=e)}function Hd(e){e.tag===22?(P(jt,jt.current),P(rn,e),vn===null&&(vn=e)):ma()}function ma(){P(jt,jt.current),P(rn,rn.current)}function sn(e){D(rn),vn===e&&(vn=null),D(jt)}var jt=N(0);function Vs(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Pc(n)||Gc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yn=0,qe=null,rt=null,Ct=null,Ps=!1,Mi=!1,ei=!1,Gs=0,Ur=0,qi=null,ty=0;function bt(){throw Error(l(321))}function qo(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!nn(e[n],t[n]))return!1;return!0}function Io(e,t,n,r,c,f){return Yn=f,qe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,E.H=e===null||e.memoizedState===null?Ef:tc,ei=!1,f=n(r,c),ei=!1,Mi&&(f=Vd(t,n,r,c)),$d(e),f}function $d(e){E.H=Lr;var t=rt!==null&&rt.next!==null;if(Yn=0,Ct=rt=qe=null,Ps=!1,Ur=0,qi=null,t)throw Error(l(300));e===null||Tt||(e=e.dependencies,e!==null&&Ds(e)&&(Tt=!0))}function Vd(e,t,n,r){qe=e;var c=0;do{if(Mi&&(qi=null),Ur=0,Mi=!1,25<=c)throw Error(l(301));if(c+=1,Ct=rt=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}E.H=Cf,f=t(n,r)}while(Mi);return f}function ny(){var e=E.H,t=e.useState()[0];return t=typeof t.then=="function"?Dr(t):t,e=e.useState()[0],(rt!==null?rt.memoizedState:null)!==e&&(qe.flags|=1024),t}function Ho(){var e=Gs!==0;return Gs=0,e}function $o(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Vo(e){if(Ps){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ps=!1}Yn=0,Ct=rt=qe=null,Mi=!1,Ur=Gs=0,qi=null}function Yt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?qe.memoizedState=Ct=e:Ct=Ct.next=e,Ct}function St(){if(rt===null){var e=qe.alternate;e=e!==null?e.memoizedState:null}else e=rt.next;var t=Ct===null?qe.memoizedState:Ct.next;if(t!==null)Ct=t,rt=e;else{if(e===null)throw qe.alternate===null?Error(l(467)):Error(l(310));rt=e,e={memoizedState:rt.memoizedState,baseState:rt.baseState,baseQueue:rt.baseQueue,queue:rt.queue,next:null},Ct===null?qe.memoizedState=Ct=e:Ct=Ct.next=e}return Ct}function Fs(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dr(e){var t=Ur;return Ur+=1,qi===null&&(qi=[]),e=zd(qi,e,t),t=qe,(Ct===null?t.memoizedState:Ct.next)===null&&(t=t.alternate,E.H=t===null||t.memoizedState===null?Ef:tc),e}function Ks(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Dr(e);if(e.$$typeof===M)return Lt(e)}throw Error(l(438,String(e)))}function Po(e){var t=null,n=qe.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var r=qe.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Fs(),qe.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=J;return t.index++,n}function Jn(e,t){return typeof t=="function"?t(e):t}function Ys(e){var t=St();return Go(t,rt,e)}function Go(e,t,n){var r=e.queue;if(r===null)throw Error(l(311));r.lastRenderedReducer=n;var c=e.baseQueue,f=r.pending;if(f!==null){if(c!==null){var y=c.next;c.next=f.next,f.next=y}t.baseQueue=c=f,r.pending=null}if(f=e.baseState,c===null)e.memoizedState=f;else{t=c.next;var S=y=null,k=null,Y=t,se=!1;do{var fe=Y.lane&-536870913;if(fe!==Y.lane?(Pe&fe)===fe:(Yn&fe)===fe){var X=Y.revertLane;if(X===0)k!==null&&(k=k.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),fe===zi&&(se=!0);else if((Yn&X)===X){Y=Y.next,X===zi&&(se=!0);continue}else fe={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},k===null?(S=k=fe,y=f):k=k.next=fe,qe.lanes|=X,ba|=X;fe=Y.action,ei&&n(f,fe),f=Y.hasEagerState?Y.eagerState:n(f,fe)}else X={lane:fe,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},k===null?(S=k=X,y=f):k=k.next=X,qe.lanes|=fe,ba|=fe;Y=Y.next}while(Y!==null&&Y!==t);if(k===null?y=f:k.next=S,!nn(f,e.memoizedState)&&(Tt=!0,se&&(n=Ui,n!==null)))throw n;e.memoizedState=f,e.baseState=y,e.baseQueue=k,r.lastRenderedState=f}return c===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Fo(e){var t=St(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var r=n.dispatch,c=n.pending,f=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do f=e(f,y.action),y=y.next;while(y!==c);nn(f,t.memoizedState)||(Tt=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,r]}function Pd(e,t,n){var r=qe,c=St(),f=Ke;if(f){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!nn((rt||c).memoizedState,n);if(y&&(c.memoizedState=n,Tt=!0),c=c.queue,Jo(Kd.bind(null,r,c,e),[e]),c.getSnapshot!==t||y||Ct!==null&&Ct.memoizedState.tag&1){if(r.flags|=2048,Ii(9,{destroy:void 0},Fd.bind(null,r,c,n,t),null),ct===null)throw Error(l(349));f||(Yn&127)!==0||Gd(r,t,n)}return n}function Gd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=qe.updateQueue,t===null?(t=Fs(),qe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Fd(e,t,n,r){t.value=n,t.getSnapshot=r,Yd(t)&&Jd(e)}function Kd(e,t,n){return n(function(){Yd(t)&&Jd(e)})}function Yd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!nn(e,n)}catch{return!0}}function Jd(e){var t=Ga(e,2);t!==null&&tn(t,e,2)}function Ko(e){var t=Yt();if(typeof e=="function"){var n=e;if(e=n(),ei){On(!0);try{n()}finally{On(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jn,lastRenderedState:e},t}function Qd(e,t,n,r){return e.baseState=n,Go(e,rt,typeof r=="function"?r:Jn)}function ay(e,t,n,r,c){if(Xs(e))throw Error(l(485));if(e=t.action,e!==null){var f={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};E.T!==null?n(!0):f.isTransition=!1,r(f),n=t.pending,n===null?(f.next=t.pending=f,Xd(t,f)):(f.next=n.next,t.pending=n.next=f)}}function Xd(e,t){var n=t.action,r=t.payload,c=e.state;if(t.isTransition){var f=E.T,y={};E.T=y;try{var S=n(c,r),k=E.S;k!==null&&k(y,S),Zd(e,t,S)}catch(Y){Yo(e,t,Y)}finally{f!==null&&y.types!==null&&(f.types=y.types),E.T=f}}else try{f=n(c,r),Zd(e,t,f)}catch(Y){Yo(e,t,Y)}}function Zd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(r){Wd(e,t,r)},function(r){return Yo(e,t,r)}):Wd(e,t,n)}function Wd(e,t,n){t.status="fulfilled",t.value=n,ef(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Xd(e,n)))}function Yo(e,t,n){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=n,ef(t),t=t.next;while(t!==r)}e.action=null}function ef(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function tf(e,t){return t}function nf(e,t){if(Ke){var n=ct.formState;if(n!==null){e:{var r=qe;if(Ke){if(ft){t:{for(var c=ft,f=yn;c.nodeType!==8;){if(!f){c=null;break t}if(c=bn(c.nextSibling),c===null){c=null;break t}}f=c.data,c=f==="F!"||f==="F"?c:null}if(c){ft=bn(c.nextSibling),r=c.data==="F!";break e}}ua(r)}r=!1}r&&(t=n[0])}}return n=Yt(),n.memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tf,lastRenderedState:t},n.queue=r,n=jf.bind(null,qe,r),r.dispatch=n,r=Ko(!1),f=ec.bind(null,qe,!1,r.queue),r=Yt(),c={state:t,dispatch:null,action:e,pending:null},r.queue=c,n=ay.bind(null,qe,c,f,n),c.dispatch=n,r.memoizedState=e,[t,n,!1]}function af(e){var t=St();return rf(t,rt,e)}function rf(e,t,n){if(t=Go(e,t,tf)[0],e=Ys(Jn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=Dr(t)}catch(y){throw y===Di?Ms:y}else r=t;t=St();var c=t.queue,f=c.dispatch;return n!==t.memoizedState&&(qe.flags|=2048,Ii(9,{destroy:void 0},iy.bind(null,c,n),null)),[r,f,e]}function iy(e,t){e.action=t}function sf(e){var t=St(),n=rt;if(n!==null)return rf(t,n,e);St(),t=t.memoizedState,n=St();var r=n.queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Ii(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},t=qe.updateQueue,t===null&&(t=Fs(),qe.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function lf(){return St().memoizedState}function Js(e,t,n,r){var c=Yt();qe.flags|=e,c.memoizedState=Ii(1|t,{destroy:void 0},n,r===void 0?null:r)}function Qs(e,t,n,r){var c=St();r=r===void 0?null:r;var f=c.memoizedState.inst;rt!==null&&r!==null&&qo(r,rt.memoizedState.deps)?c.memoizedState=Ii(t,f,n,r):(qe.flags|=e,c.memoizedState=Ii(1|t,f,n,r))}function of(e,t){Js(8390656,8,e,t)}function Jo(e,t){Qs(2048,8,e,t)}function ry(e){qe.flags|=4;var t=qe.updateQueue;if(t===null)t=Fs(),qe.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function cf(e){var t=St().memoizedState;return ry({ref:t,nextImpl:e}),function(){if((We&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function uf(e,t){return Qs(4,2,e,t)}function df(e,t){return Qs(4,4,e,t)}function ff(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hf(e,t,n){n=n!=null?n.concat([e]):null,Qs(4,4,ff.bind(null,t,e),n)}function Qo(){}function gf(e,t){var n=St();t=t===void 0?null:t;var r=n.memoizedState;return t!==null&&qo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function pf(e,t){var n=St();t=t===void 0?null:t;var r=n.memoizedState;if(t!==null&&qo(t,r[1]))return r[0];if(r=e(),ei){On(!0);try{e()}finally{On(!1)}}return n.memoizedState=[r,t],r}function Xo(e,t,n){return n===void 0||(Yn&1073741824)!==0&&(Pe&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=mh(),qe.lanes|=e,ba|=e,n)}function mf(e,t,n,r){return nn(n,t)?n:Li.current!==null?(e=Xo(e,n,r),nn(e,t)||(Tt=!0),e):(Yn&42)===0||(Yn&1073741824)!==0&&(Pe&261930)===0?(Tt=!0,e.memoizedState=n):(e=mh(),qe.lanes|=e,ba|=e,t)}function yf(e,t,n,r,c){var f=z.p;z.p=f!==0&&8>f?f:8;var y=E.T,S={};E.T=S,ec(e,!1,t,n);try{var k=c(),Y=E.S;if(Y!==null&&Y(S,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var se=ey(k,r);Br(e,t,se,cn(e))}else Br(e,t,r,cn(e))}catch(fe){Br(e,t,{then:function(){},status:"rejected",reason:fe},cn())}finally{z.p=f,y!==null&&S.types!==null&&(y.types=S.types),E.T=y}}function sy(){}function Zo(e,t,n,r){if(e.tag!==5)throw Error(l(476));var c=vf(e).queue;yf(e,c,t,ee,n===null?sy:function(){return bf(e),n(r)})}function vf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jn,lastRenderedState:ee},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function bf(e){var t=vf(e);t.next===null&&(t=e.alternate.memoizedState),Br(e,t.next.queue,{},cn())}function Wo(){return Lt(Wr)}function xf(){return St().memoizedState}function _f(){return St().memoizedState}function ly(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=cn();e=ha(n);var r=ga(t,e,n);r!==null&&(tn(r,t,n),Or(r,t,n)),t={cache:Ao()},e.payload=t;return}t=t.return}}function oy(e,t,n){var r=cn();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Xs(e)?Sf(t,n):(n=yo(e,t,n,r),n!==null&&(tn(n,e,r),wf(n,t,r)))}function jf(e,t,n){var r=cn();Br(e,t,n,r)}function Br(e,t,n,r){var c={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xs(e))Sf(t,c);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,S=f(y,n);if(c.hasEagerState=!0,c.eagerState=S,nn(S,y))return Os(e,t,c,0),ct===null&&Rs(),!1}catch{}finally{}if(n=yo(e,t,c,r),n!==null)return tn(n,e,r),wf(n,t,r),!0}return!1}function ec(e,t,n,r){if(r={lane:2,revertLane:kc(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Xs(e)){if(t)throw Error(l(479))}else t=yo(e,n,r,2),t!==null&&tn(t,e,2)}function Xs(e){var t=e.alternate;return e===qe||t!==null&&t===qe}function Sf(e,t){Mi=Ps=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function wf(e,t,n){if((n&4194048)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ps(e,n)}}var Lr={readContext:Lt,use:Ks,useCallback:bt,useContext:bt,useEffect:bt,useImperativeHandle:bt,useLayoutEffect:bt,useInsertionEffect:bt,useMemo:bt,useReducer:bt,useRef:bt,useState:bt,useDebugValue:bt,useDeferredValue:bt,useTransition:bt,useSyncExternalStore:bt,useId:bt,useHostTransitionStatus:bt,useFormState:bt,useActionState:bt,useOptimistic:bt,useMemoCache:bt,useCacheRefresh:bt};Lr.useEffectEvent=bt;var Ef={readContext:Lt,use:Ks,useCallback:function(e,t){return Yt().memoizedState=[e,t===void 0?null:t],e},useContext:Lt,useEffect:of,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Js(4194308,4,ff.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Js(4194308,4,e,t)},useInsertionEffect:function(e,t){Js(4,2,e,t)},useMemo:function(e,t){var n=Yt();t=t===void 0?null:t;var r=e();if(ei){On(!0);try{e()}finally{On(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Yt();if(n!==void 0){var c=n(t);if(ei){On(!0);try{n(t)}finally{On(!1)}}}else c=t;return r.memoizedState=r.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},r.queue=e,e=e.dispatch=oy.bind(null,qe,e),[r.memoizedState,e]},useRef:function(e){var t=Yt();return e={current:e},t.memoizedState=e},useState:function(e){e=Ko(e);var t=e.queue,n=jf.bind(null,qe,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Qo,useDeferredValue:function(e,t){var n=Yt();return Xo(n,e,t)},useTransition:function(){var e=Ko(!1);return e=yf.bind(null,qe,e.queue,!0,!1),Yt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=qe,c=Yt();if(Ke){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),ct===null)throw Error(l(349));(Pe&127)!==0||Gd(r,t,n)}c.memoizedState=n;var f={value:n,getSnapshot:t};return c.queue=f,of(Kd.bind(null,r,f,e),[e]),r.flags|=2048,Ii(9,{destroy:void 0},Fd.bind(null,r,f,n,t),null),n},useId:function(){var e=Yt(),t=ct.identifierPrefix;if(Ke){var n=Bn,r=Dn;n=(r&~(1<<32-Kt(r)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Gs++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=ty++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Wo,useFormState:nf,useActionState:nf,useOptimistic:function(e){var t=Yt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ec.bind(null,qe,!0,n),n.dispatch=t,[e,t]},useMemoCache:Po,useCacheRefresh:function(){return Yt().memoizedState=ly.bind(null,qe)},useEffectEvent:function(e){var t=Yt(),n={impl:e};return t.memoizedState=n,function(){if((We&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},tc={readContext:Lt,use:Ks,useCallback:gf,useContext:Lt,useEffect:Jo,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:df,useMemo:pf,useReducer:Ys,useRef:lf,useState:function(){return Ys(Jn)},useDebugValue:Qo,useDeferredValue:function(e,t){var n=St();return mf(n,rt.memoizedState,e,t)},useTransition:function(){var e=Ys(Jn)[0],t=St().memoizedState;return[typeof e=="boolean"?e:Dr(e),t]},useSyncExternalStore:Pd,useId:xf,useHostTransitionStatus:Wo,useFormState:af,useActionState:af,useOptimistic:function(e,t){var n=St();return Qd(n,rt,e,t)},useMemoCache:Po,useCacheRefresh:_f};tc.useEffectEvent=cf;var Cf={readContext:Lt,use:Ks,useCallback:gf,useContext:Lt,useEffect:Jo,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:df,useMemo:pf,useReducer:Fo,useRef:lf,useState:function(){return Fo(Jn)},useDebugValue:Qo,useDeferredValue:function(e,t){var n=St();return rt===null?Xo(n,e,t):mf(n,rt.memoizedState,e,t)},useTransition:function(){var e=Fo(Jn)[0],t=St().memoizedState;return[typeof e=="boolean"?e:Dr(e),t]},useSyncExternalStore:Pd,useId:xf,useHostTransitionStatus:Wo,useFormState:sf,useActionState:sf,useOptimistic:function(e,t){var n=St();return rt!==null?Qd(n,rt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Po,useCacheRefresh:_f};Cf.useEffectEvent=cf;function nc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:x({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ac={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cn(),c=ha(r);c.payload=t,n!=null&&(c.callback=n),t=ga(e,c,r),t!==null&&(tn(t,e,r),Or(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cn(),c=ha(r);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=ga(e,c,r),t!==null&&(tn(t,e,r),Or(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cn(),r=ha(n);r.tag=2,t!=null&&(r.callback=t),t=ga(e,r,n),t!==null&&(tn(t,e,n),Or(t,e,n))}};function Tf(e,t,n,r,c,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,f,y):t.prototype&&t.prototype.isPureReactComponent?!Sr(n,r)||!Sr(c,f):!0}function Af(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ac.enqueueReplaceState(t,t.state,null)}function ti(e,t){var n=t;if("ref"in t){n={};for(var r in t)r!=="ref"&&(n[r]=t[r])}if(e=e.defaultProps){n===t&&(n=x({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Nf(e){Ns(e)}function Rf(e){console.error(e)}function Of(e){Ns(e)}function Zs(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function kf(e,t,n){try{var r=e.onCaughtError;r(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function ic(e,t,n){return n=ha(n),n.tag=3,n.payload={element:null},n.callback=function(){Zs(e,t)},n}function zf(e){return e=ha(e),e.tag=3,e}function Uf(e,t,n,r){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var f=r.value;e.payload=function(){return c(f)},e.callback=function(){kf(t,n,r)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){kf(t,n,r),typeof c!="function"&&(xa===null?xa=new Set([this]):xa.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})})}function cy(e,t,n,r,c){if(n.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=n.alternate,t!==null&&ki(t,n,c,!0),n=rn.current,n!==null){switch(n.tag){case 31:case 13:return vn===null?ul():n.alternate===null&&xt===0&&(xt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,r===qs?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([r]):t.add(r),Nc(e,r,c)),!1;case 22:return n.flags|=65536,r===qs?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([r]):n.add(r)),Nc(e,r,c)),!1}throw Error(l(435,n.tag))}return Nc(e,r,c),ul(),!1}if(Ke)return t=rn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,r!==So&&(e=Error(l(422),{cause:r}),Cr(gn(e,n)))):(r!==So&&(t=Error(l(423),{cause:r}),Cr(gn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,r=gn(r,n),c=ic(e.stateNode,r,c),Uo(e,c),xt!==4&&(xt=2)),!1;var f=Error(l(520),{cause:r});if(f=gn(f,n),Gr===null?Gr=[f]:Gr.push(f),xt!==4&&(xt=2),t===null)return!0;r=gn(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=ic(n.stateNode,r,e),Uo(n,e),!1;case 1:if(t=n.type,f=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(xa===null||!xa.has(f))))return n.flags|=65536,c&=-c,n.lanes|=c,c=zf(c),Uf(c,e,n,r),Uo(n,c),!1}n=n.return}while(n!==null);return!1}var rc=Error(l(461)),Tt=!1;function Mt(e,t,n,r){t.child=e===null?Ld(t,null,n,r):Wa(t,e.child,n,r)}function Df(e,t,n,r,c){n=n.render;var f=t.ref;if("ref"in r){var y={};for(var S in r)S!=="ref"&&(y[S]=r[S])}else y=r;return Ja(t),r=Io(e,t,n,y,f,c),S=Ho(),e!==null&&!Tt?($o(e,t,c),Qn(e,t,c)):(Ke&&S&&_o(t),t.flags|=1,Mt(e,t,r,c),t.child)}function Bf(e,t,n,r,c){if(e===null){var f=n.type;return typeof f=="function"&&!vo(f)&&f.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=f,Lf(e,t,f,r,c)):(e=zs(n.type,null,r,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!hc(e,c)){var y=f.memoizedProps;if(n=n.compare,n=n!==null?n:Sr,n(y,r)&&e.ref===t.ref)return Qn(e,t,c)}return t.flags|=1,e=Pn(f,r),e.ref=t.ref,e.return=t,t.child=e}function Lf(e,t,n,r,c){if(e!==null){var f=e.memoizedProps;if(Sr(f,r)&&e.ref===t.ref)if(Tt=!1,t.pendingProps=r=f,hc(e,c))(e.flags&131072)!==0&&(Tt=!0);else return t.lanes=e.lanes,Qn(e,t,c)}return sc(e,t,n,r,c)}function Mf(e,t,n,r){var c=r.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;r=c&~f}else r=0,t.child=null;return qf(e,t,f,n,r)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ls(t,f!==null?f.cachePool:null),f!==null?Id(t,f):Bo(),Hd(t);else return r=t.lanes=536870912,qf(e,t,f!==null?f.baseLanes|n:n,n,r)}else f!==null?(Ls(t,f.cachePool),Id(t,f),ma(),t.memoizedState=null):(e!==null&&Ls(t,null),Bo(),ma());return Mt(e,t,c,n),t.child}function Mr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function qf(e,t,n,r,c){var f=Ro();return f=f===null?null:{parent:Et._currentValue,pool:f},t.memoizedState={baseLanes:n,cachePool:f},e!==null&&Ls(t,null),Bo(),Hd(t),e!==null&&ki(e,t,r,!0),t.childLanes=c,null}function Ws(e,t){return t=tl({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function If(e,t,n){return Wa(t,e.child,null,n),e=Ws(t,t.pendingProps),e.flags|=2,sn(t),t.memoizedState=null,e}function uy(e,t,n){var r=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ke){if(r.mode==="hidden")return e=Ws(t,r),t.lanes=536870912,Mr(null,e);if(Mo(t),(e=ft)?(e=Zh(e,yn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:oa!==null?{id:Dn,overflow:Bn}:null,retryLane:536870912,hydrationErrors:null},n=jd(e),n.return=t,t.child=n,Bt=t,ft=null)):e=null,e===null)throw ua(t);return t.lanes=536870912,null}return Ws(t,r)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if(Mo(t),c)if(t.flags&256)t.flags&=-257,t=If(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(Tt||ki(e,t,n,!1),c=(n&e.childLanes)!==0,Tt||c){if(r=ct,r!==null&&(y=_i(r,n),y!==0&&y!==f.retryLane))throw f.retryLane=y,Ga(e,y),tn(r,e,y),rc;ul(),t=If(e,t,n)}else e=f.treeContext,ft=bn(y.nextSibling),Bt=t,Ke=!0,ca=null,yn=!1,e!==null&&Ed(t,e),t=Ws(t,r),t.flags|=4096;return t}return e=Pn(e.child,{mode:r.mode,children:r.children}),e.ref=t.ref,t.child=e,e.return=t,e}function el(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function sc(e,t,n,r,c){return Ja(t),n=Io(e,t,n,r,void 0,c),r=Ho(),e!==null&&!Tt?($o(e,t,c),Qn(e,t,c)):(Ke&&r&&_o(t),t.flags|=1,Mt(e,t,n,c),t.child)}function Hf(e,t,n,r,c,f){return Ja(t),t.updateQueue=null,n=Vd(t,r,n,c),$d(e),r=Ho(),e!==null&&!Tt?($o(e,t,f),Qn(e,t,f)):(Ke&&r&&_o(t),t.flags|=1,Mt(e,t,n,f),t.child)}function $f(e,t,n,r,c){if(Ja(t),t.stateNode===null){var f=Ai,y=n.contextType;typeof y=="object"&&y!==null&&(f=Lt(y)),f=new n(r,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=ac,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=r,f.state=t.memoizedState,f.refs={},ko(t),y=n.contextType,f.context=typeof y=="object"&&y!==null?Lt(y):Ai,f.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(nc(t,n,y,r),f.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&ac.enqueueReplaceState(f,f.state,null),zr(t,r,f,c),kr(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(e===null){f=t.stateNode;var S=t.memoizedProps,k=ti(n,S);f.props=k;var Y=f.context,se=n.contextType;y=Ai,typeof se=="object"&&se!==null&&(y=Lt(se));var fe=n.getDerivedStateFromProps;se=typeof fe=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=t.pendingProps!==S,se||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||Y!==y)&&Af(t,f,r,y),fa=!1;var X=t.memoizedState;f.state=X,zr(t,r,f,c),kr(),Y=t.memoizedState,S||X!==Y||fa?(typeof fe=="function"&&(nc(t,n,fe,r),Y=t.memoizedState),(k=fa||Tf(t,n,k,r,X,Y,y))?(se||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=Y),f.props=r,f.state=Y,f.context=y,r=k):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{f=t.stateNode,zo(e,t),y=t.memoizedProps,se=ti(n,y),f.props=se,fe=t.pendingProps,X=f.context,Y=n.contextType,k=Ai,typeof Y=="object"&&Y!==null&&(k=Lt(Y)),S=n.getDerivedStateFromProps,(Y=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==fe||X!==k)&&Af(t,f,r,k),fa=!1,X=t.memoizedState,f.state=X,zr(t,r,f,c),kr();var te=t.memoizedState;y!==fe||X!==te||fa||e!==null&&e.dependencies!==null&&Ds(e.dependencies)?(typeof S=="function"&&(nc(t,n,S,r),te=t.memoizedState),(se=fa||Tf(t,n,se,r,X,te,k)||e!==null&&e.dependencies!==null&&Ds(e.dependencies))?(Y||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(r,te,k),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(r,te,k)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&X===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&X===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=te),f.props=r,f.state=te,f.context=k,r=se):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&X===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&X===e.memoizedState||(t.flags|=1024),r=!1)}return f=r,el(e,t),r=(t.flags&128)!==0,f||r?(f=t.stateNode,n=r&&typeof n.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&r?(t.child=Wa(t,e.child,null,c),t.child=Wa(t,null,n,c)):Mt(e,t,n,c),t.memoizedState=f.state,e=t.child):e=Qn(e,t,c),e}function Vf(e,t,n,r){return Ka(),t.flags|=256,Mt(e,t,n,r),t.child}var lc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function oc(e){return{baseLanes:e,cachePool:Od()}}function cc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=on),e}function Pf(e,t,n){var r=t.pendingProps,c=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(jt.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ke){if(c?pa(t):ma(),(e=ft)?(e=Zh(e,yn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:oa!==null?{id:Dn,overflow:Bn}:null,retryLane:536870912,hydrationErrors:null},n=jd(e),n.return=t,t.child=n,Bt=t,ft=null)):e=null,e===null)throw ua(t);return Gc(e)?t.lanes=32:t.lanes=536870912,null}var S=r.children;return r=r.fallback,c?(ma(),c=t.mode,S=tl({mode:"hidden",children:S},c),r=Fa(r,c,n,null),S.return=t,r.return=t,S.sibling=r,t.child=S,r=t.child,r.memoizedState=oc(n),r.childLanes=cc(e,y,n),t.memoizedState=lc,Mr(null,r)):(pa(t),uc(t,S))}var k=e.memoizedState;if(k!==null&&(S=k.dehydrated,S!==null)){if(f)t.flags&256?(pa(t),t.flags&=-257,t=dc(e,t,n)):t.memoizedState!==null?(ma(),t.child=e.child,t.flags|=128,t=null):(ma(),S=r.fallback,c=t.mode,r=tl({mode:"visible",children:r.children},c),S=Fa(S,c,n,null),S.flags|=2,r.return=t,S.return=t,r.sibling=S,t.child=r,Wa(t,e.child,null,n),r=t.child,r.memoizedState=oc(n),r.childLanes=cc(e,y,n),t.memoizedState=lc,t=Mr(null,r));else if(pa(t),Gc(S)){if(y=S.nextSibling&&S.nextSibling.dataset,y)var Y=y.dgst;y=Y,r=Error(l(419)),r.stack="",r.digest=y,Cr({value:r,source:null,stack:null}),t=dc(e,t,n)}else if(Tt||ki(e,t,n,!1),y=(n&e.childLanes)!==0,Tt||y){if(y=ct,y!==null&&(r=_i(y,n),r!==0&&r!==k.retryLane))throw k.retryLane=r,Ga(e,r),tn(y,e,r),rc;Pc(S)||ul(),t=dc(e,t,n)}else Pc(S)?(t.flags|=192,t.child=e.child,t=null):(e=k.treeContext,ft=bn(S.nextSibling),Bt=t,Ke=!0,ca=null,yn=!1,e!==null&&Ed(t,e),t=uc(t,r.children),t.flags|=4096);return t}return c?(ma(),S=r.fallback,c=t.mode,k=e.child,Y=k.sibling,r=Pn(k,{mode:"hidden",children:r.children}),r.subtreeFlags=k.subtreeFlags&65011712,Y!==null?S=Pn(Y,S):(S=Fa(S,c,n,null),S.flags|=2),S.return=t,r.return=t,r.sibling=S,t.child=r,Mr(null,r),r=t.child,S=e.child.memoizedState,S===null?S=oc(n):(c=S.cachePool,c!==null?(k=Et._currentValue,c=c.parent!==k?{parent:k,pool:k}:c):c=Od(),S={baseLanes:S.baseLanes|n,cachePool:c}),r.memoizedState=S,r.childLanes=cc(e,y,n),t.memoizedState=lc,Mr(e.child,r)):(pa(t),n=e.child,e=n.sibling,n=Pn(n,{mode:"visible",children:r.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function uc(e,t){return t=tl({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function tl(e,t){return e=an(22,e,null,t),e.lanes=0,e}function dc(e,t,n){return Wa(t,e.child,null,n),e=uc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Gf(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Co(e.return,t,n)}function fc(e,t,n,r,c,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:c,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=r,y.tail=n,y.tailMode=c,y.treeForkCount=f)}function Ff(e,t,n){var r=t.pendingProps,c=r.revealOrder,f=r.tail;r=r.children;var y=jt.current,S=(y&2)!==0;if(S?(y=y&1|2,t.flags|=128):y&=1,P(jt,y),Mt(e,t,r,n),r=Ke?Er:0,!S&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Gf(e,n,t);else if(e.tag===19)Gf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Vs(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),fc(t,!1,c,n,f,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Vs(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}fc(t,!0,n,null,f,r);break;case"together":fc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function Qn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ba|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(ki(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Pn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Pn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function hc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Ds(e)))}function dy(e,t,n){switch(t.tag){case 3:ne(t,t.stateNode.containerInfo),da(t,Et,e.memoizedState.cache),Ka();break;case 27:case 5:Se(t);break;case 4:ne(t,t.stateNode.containerInfo);break;case 10:da(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Mo(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(pa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Pf(e,t,n):(pa(t),e=Qn(e,t,n),e!==null?e.sibling:null);pa(t);break;case 19:var c=(e.flags&128)!==0;if(r=(n&t.childLanes)!==0,r||(ki(e,t,n,!1),r=(n&t.childLanes)!==0),c){if(r)return Ff(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),P(jt,jt.current),r)break;return null;case 22:return t.lanes=0,Mf(e,t,n,t.pendingProps);case 24:da(t,Et,e.memoizedState.cache)}return Qn(e,t,n)}function Kf(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Tt=!0;else{if(!hc(e,n)&&(t.flags&128)===0)return Tt=!1,dy(e,t,n);Tt=(e.flags&131072)!==0}else Tt=!1,Ke&&(t.flags&1048576)!==0&&wd(t,Er,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=Xa(t.elementType),t.type=e,typeof e=="function")vo(e)?(r=ti(e,r),t.tag=1,t=$f(null,t,e,r,n)):(t.tag=0,t=sc(null,t,e,r,n));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=Df(null,t,e,r,n);break e}else if(c===U){t.tag=14,t=Bf(null,t,e,r,n);break e}}throw t=W(e)||e,Error(l(306,t,""))}}return t;case 0:return sc(e,t,t.type,t.pendingProps,n);case 1:return r=t.type,c=ti(r,t.pendingProps),$f(e,t,r,c,n);case 3:e:{if(ne(t,t.stateNode.containerInfo),e===null)throw Error(l(387));r=t.pendingProps;var f=t.memoizedState;c=f.element,zo(e,t),zr(t,r,null,n);var y=t.memoizedState;if(r=y.cache,da(t,Et,r),r!==f.cache&&To(t,[Et],n,!0),kr(),r=y.element,f.isDehydrated)if(f={element:r,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Vf(e,t,r,n);break e}else if(r!==c){c=gn(Error(l(424)),t),Cr(c),t=Vf(e,t,r,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ft=bn(e.firstChild),Bt=t,Ke=!0,ca=null,yn=!0,n=Ld(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Ka(),r===c){t=Qn(e,t,n);break e}Mt(e,t,r,n)}t=t.child}return t;case 26:return el(e,t),e===null?(n=ig(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ke||(n=t.type,e=t.pendingProps,r=yl(ge.current).createElement(n),r[Rt]=t,r[zt]=e,qt(r,n,e),oe(r),t.stateNode=r):t.memoizedState=ig(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Se(t),e===null&&Ke&&(r=t.stateNode=tg(t.type,t.pendingProps,ge.current),Bt=t,yn=!0,c=ft,wa(t.type)?(Fc=c,ft=bn(r.firstChild)):ft=c),Mt(e,t,t.pendingProps.children,n),el(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ke&&((c=r=ft)&&(r=Hy(r,t.type,t.pendingProps,yn),r!==null?(t.stateNode=r,Bt=t,ft=bn(r.firstChild),yn=!1,c=!0):c=!1),c||ua(t)),Se(t),c=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,r=f.children,Hc(c,f)?r=null:y!==null&&Hc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Io(e,t,ny,null,null,n),Wr._currentValue=c),el(e,t),Mt(e,t,r,n),t.child;case 6:return e===null&&Ke&&((e=n=ft)&&(n=$y(n,t.pendingProps,yn),n!==null?(t.stateNode=n,Bt=t,ft=null,e=!0):e=!1),e||ua(t)),null;case 13:return Pf(e,t,n);case 4:return ne(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Wa(t,null,r,n):Mt(e,t,r,n),t.child;case 11:return Df(e,t,t.type,t.pendingProps,n);case 7:return Mt(e,t,t.pendingProps,n),t.child;case 8:return Mt(e,t,t.pendingProps.children,n),t.child;case 12:return Mt(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,da(t,t.type,r.value),Mt(e,t,r.children,n),t.child;case 9:return c=t.type._context,r=t.pendingProps.children,Ja(t),c=Lt(c),r=r(c),t.flags|=1,Mt(e,t,r,n),t.child;case 14:return Bf(e,t,t.type,t.pendingProps,n);case 15:return Lf(e,t,t.type,t.pendingProps,n);case 19:return Ff(e,t,n);case 31:return uy(e,t,n);case 22:return Mf(e,t,n,t.pendingProps);case 24:return Ja(t),r=Lt(Et),e===null?(c=Ro(),c===null&&(c=ct,f=Ao(),c.pooledCache=f,f.refCount++,f!==null&&(c.pooledCacheLanes|=n),c=f),t.memoizedState={parent:r,cache:c},ko(t),da(t,Et,c)):((e.lanes&n)!==0&&(zo(e,t),zr(t,null,null,n),kr()),c=e.memoizedState,f=t.memoizedState,c.parent!==r?(c={parent:r,cache:r},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),da(t,Et,r)):(r=f.cache,da(t,Et,r),r!==c.cache&&To(t,[Et],n,!0))),Mt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Xn(e){e.flags|=4}function gc(e,t,n,r,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(xh())e.flags|=8192;else throw Za=qs,Oo}else e.flags&=-16777217}function Yf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!cg(t))if(xh())e.flags|=8192;else throw Za=qs,Oo}function nl(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?zn():536870912,e.lanes|=t,Pi|=t)}function qr(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ht(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags&65011712,r|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags,r|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function fy(e,t,n){var r=t.pendingProps;switch(jo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ht(t),null;case 1:return ht(t),null;case 3:return n=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Kn(Et),ve(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Oi(t)?Xn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,wo())),ht(t),null;case 26:var c=t.type,f=t.memoizedState;return e===null?(Xn(t),f!==null?(ht(t),Yf(t,f)):(ht(t),gc(t,c,null,r,n))):f?f!==e.memoizedState?(Xn(t),ht(t),Yf(t,f)):(ht(t),t.flags&=-16777217):(e=e.memoizedProps,e!==r&&Xn(t),ht(t),gc(t,c,e,r,n)),null;case 27:if(Ae(t),n=ge.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Xn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return ht(t),null}e=Q.current,Oi(t)?Cd(t):(e=tg(c,r,n),t.stateNode=e,Xn(t))}return ht(t),null;case 5:if(Ae(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Xn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return ht(t),null}if(f=Q.current,Oi(t))Cd(t);else{var y=yl(ge.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof r.is=="string"?y.createElement("select",{is:r.is}):y.createElement("select"),r.multiple?f.multiple=!0:r.size&&(f.size=r.size);break;default:f=typeof r.is=="string"?y.createElement(c,{is:r.is}):y.createElement(c)}}f[Rt]=t,f[zt]=r;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(qt(f,c,r),c){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Xn(t)}}return ht(t),gc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&Xn(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(l(166));if(e=ge.current,Oi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,c=Bt,c!==null)switch(c.tag){case 27:case 5:r=c.memoizedProps}e[Rt]=t,e=!!(e.nodeValue===n||r!==null&&r.suppressHydrationWarning===!0||Ph(e.nodeValue,n)),e||ua(t,!0)}else e=yl(e).createTextNode(r),e[Rt]=t,t.stateNode=e}return ht(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(r=Oi(t),n!==null){if(e===null){if(!r)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[Rt]=t}else Ka(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ht(t),e=!1}else n=wo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(sn(t),t):(sn(t),null);if((t.flags&128)!==0)throw Error(l(558))}return ht(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Oi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[Rt]=t}else Ka(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ht(t),c=!1}else c=wo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(sn(t),t):(sn(t),null)}return sn(t),(t.flags&128)!==0?(t.lanes=n,t):(n=r!==null,e=e!==null&&e.memoizedState!==null,n&&(r=t.child,c=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(c=r.alternate.memoizedState.cachePool.pool),f=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),f!==c&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),nl(t,t.updateQueue),ht(t),null);case 4:return ve(),e===null&&Bc(t.stateNode.containerInfo),ht(t),null;case 10:return Kn(t.type),ht(t),null;case 19:if(D(jt),r=t.memoizedState,r===null)return ht(t),null;if(c=(t.flags&128)!==0,f=r.rendering,f===null)if(c)qr(r,!1);else{if(xt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=Vs(e),f!==null){for(t.flags|=128,qr(r,!1),e=f.updateQueue,t.updateQueue=e,nl(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)_d(n,e),n=n.sibling;return P(jt,jt.current&1|2),Ke&&Gn(t,r.treeForkCount),t.child}e=e.sibling}r.tail!==null&&Gt()>ll&&(t.flags|=128,c=!0,qr(r,!1),t.lanes=4194304)}else{if(!c)if(e=Vs(f),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,nl(t,e),qr(r,!0),r.tail===null&&r.tailMode==="hidden"&&!f.alternate&&!Ke)return ht(t),null}else 2*Gt()-r.renderingStartTime>ll&&n!==536870912&&(t.flags|=128,c=!0,qr(r,!1),t.lanes=4194304);r.isBackwards?(f.sibling=t.child,t.child=f):(e=r.last,e!==null?e.sibling=f:t.child=f,r.last=f)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Gt(),e.sibling=null,n=jt.current,P(jt,c?n&1|2:n&1),Ke&&Gn(t,r.treeForkCount),e):(ht(t),null);case 22:case 23:return sn(t),Lo(),r=t.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?(n&536870912)!==0&&(t.flags&128)===0&&(ht(t),t.subtreeFlags&6&&(t.flags|=8192)):ht(t),n=t.updateQueue,n!==null&&nl(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),e!==null&&D(Qa),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Kn(Et),ht(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function hy(e,t){switch(jo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Kn(Et),ve(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ae(t),null;case 31:if(t.memoizedState!==null){if(sn(t),t.alternate===null)throw Error(l(340));Ka()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(sn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Ka()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return D(jt),null;case 4:return ve(),null;case 10:return Kn(t.type),null;case 22:case 23:return sn(t),Lo(),e!==null&&D(Qa),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Kn(Et),null;case 25:return null;default:return null}}function Jf(e,t){switch(jo(t),t.tag){case 3:Kn(Et),ve();break;case 26:case 27:case 5:Ae(t);break;case 4:ve();break;case 31:t.memoizedState!==null&&sn(t);break;case 13:sn(t);break;case 19:D(jt);break;case 10:Kn(t.type);break;case 22:case 23:sn(t),Lo(),e!==null&&D(Qa);break;case 24:Kn(Et)}}function Ir(e,t){try{var n=t.updateQueue,r=n!==null?n.lastEffect:null;if(r!==null){var c=r.next;n=c;do{if((n.tag&e)===e){r=void 0;var f=n.create,y=n.inst;r=f(),y.destroy=r}n=n.next}while(n!==c)}}catch(S){at(t,t.return,S)}}function ya(e,t,n){try{var r=t.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&e)===e){var y=r.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,c=t;var k=n,Y=S;try{Y()}catch(se){at(c,k,se)}}}r=r.next}while(r!==f)}}catch(se){at(t,t.return,se)}}function Qf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{qd(t,n)}catch(r){at(e,e.return,r)}}}function Xf(e,t,n){n.props=ti(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){at(e,t,r)}}function Hr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof n=="function"?e.refCleanup=n(r):n.current=r}}catch(c){at(e,t,c)}}function Ln(e,t){var n=e.ref,r=e.refCleanup;if(n!==null)if(typeof r=="function")try{r()}catch(c){at(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){at(e,t,c)}else n.current=null}function Zf(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(c){at(e,e.return,c)}}function pc(e,t,n){try{var r=e.stateNode;Dy(r,e.type,n,t),r[zt]=t}catch(c){at(e,e.return,c)}}function Wf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&wa(e.type)||e.tag===4}function mc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Wf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&wa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=$n));else if(r!==4&&(r===27&&wa(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(yc(e,t,n),e=e.sibling;e!==null;)yc(e,t,n),e=e.sibling}function al(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(r===27&&wa(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(al(e,t,n),e=e.sibling;e!==null;)al(e,t,n),e=e.sibling}function eh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);qt(t,r,n),t[Rt]=e,t[zt]=n}catch(f){at(e,e.return,f)}}var Zn=!1,At=!1,vc=!1,th=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function gy(e,t){if(e=e.containerInfo,qc=wl,e=fd(e),uo(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var c=r.anchorOffset,f=r.focusNode;r=r.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var y=0,S=-1,k=-1,Y=0,se=0,fe=e,X=null;t:for(;;){for(var te;fe!==n||c!==0&&fe.nodeType!==3||(S=y+c),fe!==f||r!==0&&fe.nodeType!==3||(k=y+r),fe.nodeType===3&&(y+=fe.nodeValue.length),(te=fe.firstChild)!==null;)X=fe,fe=te;for(;;){if(fe===e)break t;if(X===n&&++Y===c&&(S=y),X===f&&++se===r&&(k=y),(te=fe.nextSibling)!==null)break;fe=X,X=fe.parentNode}fe=te}n=S===-1||k===-1?null:{start:S,end:k}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ic={focusedElem:e,selectionRange:n},wl=!1,Ut=t;Ut!==null;)if(t=Ut,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ut=e;else for(;Ut!==null;){switch(t=Ut,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,n=t,c=f.memoizedProps,f=f.memoizedState,r=n.stateNode;try{var Ee=ti(n.type,c);e=r.getSnapshotBeforeUpdate(Ee,f),r.__reactInternalSnapshotBeforeUpdate=e}catch(Ue){at(n,n.return,Ue)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Vc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Vc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Ut=e;break}Ut=t.return}}function nh(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:ea(e,n),r&4&&Ir(5,n);break;case 1:if(ea(e,n),r&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){at(n,n.return,y)}else{var c=ti(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){at(n,n.return,y)}}r&64&&Qf(n),r&512&&Hr(n,n.return);break;case 3:if(ea(e,n),r&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{qd(e,t)}catch(y){at(n,n.return,y)}}break;case 27:t===null&&r&4&&eh(n);case 26:case 5:ea(e,n),t===null&&r&4&&Zf(n),r&512&&Hr(n,n.return);break;case 12:ea(e,n);break;case 31:ea(e,n),r&4&&rh(e,n);break;case 13:ea(e,n),r&4&&sh(e,n),r&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=Sy.bind(null,n),Vy(e,n))));break;case 22:if(r=n.memoizedState!==null||Zn,!r){t=t!==null&&t.memoizedState!==null||At,c=Zn;var f=At;Zn=r,(At=t)&&!f?ta(e,n,(n.subtreeFlags&8772)!==0):ea(e,n),Zn=c,At=f}break;case 30:break;default:ea(e,n)}}function ah(e){var t=e.alternate;t!==null&&(e.alternate=null,ah(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&gr(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var mt=null,Xt=!1;function Wn(e,t,n){for(n=n.child;n!==null;)ih(e,t,n),n=n.sibling}function ih(e,t,n){if(Ft&&typeof Ft.onCommitFiberUnmount=="function")try{Ft.onCommitFiberUnmount(Da,n)}catch{}switch(n.tag){case 26:At||Ln(n,t),Wn(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:At||Ln(n,t);var r=mt,c=Xt;wa(n.type)&&(mt=n.stateNode,Xt=!1),Wn(e,t,n),Qr(n.stateNode),mt=r,Xt=c;break;case 5:At||Ln(n,t);case 6:if(r=mt,c=Xt,mt=null,Wn(e,t,n),mt=r,Xt=c,mt!==null)if(Xt)try{(mt.nodeType===9?mt.body:mt.nodeName==="HTML"?mt.ownerDocument.body:mt).removeChild(n.stateNode)}catch(f){at(n,t,f)}else try{mt.removeChild(n.stateNode)}catch(f){at(n,t,f)}break;case 18:mt!==null&&(Xt?(e=mt,Qh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Zi(e)):Qh(mt,n.stateNode));break;case 4:r=mt,c=Xt,mt=n.stateNode.containerInfo,Xt=!0,Wn(e,t,n),mt=r,Xt=c;break;case 0:case 11:case 14:case 15:ya(2,n,t),At||ya(4,n,t),Wn(e,t,n);break;case 1:At||(Ln(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"&&Xf(n,t,r)),Wn(e,t,n);break;case 21:Wn(e,t,n);break;case 22:At=(r=At)||n.memoizedState!==null,Wn(e,t,n),At=r;break;default:Wn(e,t,n)}}function rh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Zi(e)}catch(n){at(t,t.return,n)}}}function sh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Zi(e)}catch(n){at(t,t.return,n)}}function py(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new th),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new th),t;default:throw Error(l(435,e.tag))}}function il(e,t){var n=py(e);t.forEach(function(r){if(!n.has(r)){n.add(r);var c=wy.bind(null,e,r);r.then(c,c)}})}function Zt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var c=n[r],f=e,y=t,S=y;e:for(;S!==null;){switch(S.tag){case 27:if(wa(S.type)){mt=S.stateNode,Xt=!1;break e}break;case 5:mt=S.stateNode,Xt=!1;break e;case 3:case 4:mt=S.stateNode.containerInfo,Xt=!0;break e}S=S.return}if(mt===null)throw Error(l(160));ih(f,y,c),mt=null,Xt=!1,f=c.alternate,f!==null&&(f.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)lh(t,e),t=t.sibling}var Cn=null;function lh(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Zt(t,e),Wt(e),r&4&&(ya(3,e,e.return),Ir(3,e),ya(5,e,e.return));break;case 1:Zt(t,e),Wt(e),r&512&&(At||n===null||Ln(n,n.return)),r&64&&Zn&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?r:n.concat(r))));break;case 26:var c=Cn;if(Zt(t,e),Wt(e),r&512&&(At||n===null||Ln(n,n.return)),r&4){var f=n!==null?n.memoizedState:null;if(r=e.memoizedState,n===null)if(r===null)if(e.stateNode===null){e:{r=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(r){case"title":f=c.getElementsByTagName("title")[0],(!f||f[qa]||f[Rt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=c.createElement(r),c.head.insertBefore(f,c.querySelector("head > title"))),qt(f,r,n),f[Rt]=e,oe(f),r=f;break e;case"link":var y=lg("link","href",c).get(r+(n.href||""));if(y){for(var S=0;S<y.length;S++)if(f=y[S],f.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&f.getAttribute("rel")===(n.rel==null?null:n.rel)&&f.getAttribute("title")===(n.title==null?null:n.title)&&f.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(S,1);break t}}f=c.createElement(r),qt(f,r,n),c.head.appendChild(f);break;case"meta":if(y=lg("meta","content",c).get(r+(n.content||""))){for(S=0;S<y.length;S++)if(f=y[S],f.getAttribute("content")===(n.content==null?null:""+n.content)&&f.getAttribute("name")===(n.name==null?null:n.name)&&f.getAttribute("property")===(n.property==null?null:n.property)&&f.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&f.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(S,1);break t}}f=c.createElement(r),qt(f,r,n),c.head.appendChild(f);break;default:throw Error(l(468,r))}f[Rt]=e,oe(f),r=f}e.stateNode=r}else og(c,e.type,e.stateNode);else e.stateNode=sg(c,r,e.memoizedProps);else f!==r?(f===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):f.count--,r===null?og(c,e.type,e.stateNode):sg(c,r,e.memoizedProps)):r===null&&e.stateNode!==null&&pc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Zt(t,e),Wt(e),r&512&&(At||n===null||Ln(n,n.return)),n!==null&&r&4&&pc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Zt(t,e),Wt(e),r&512&&(At||n===null||Ln(n,n.return)),e.flags&32){c=e.stateNode;try{Hn(c,"")}catch(Ee){at(e,e.return,Ee)}}r&4&&e.stateNode!=null&&(c=e.memoizedProps,pc(e,c,n!==null?n.memoizedProps:c)),r&1024&&(vc=!0);break;case 6:if(Zt(t,e),Wt(e),r&4){if(e.stateNode===null)throw Error(l(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(Ee){at(e,e.return,Ee)}}break;case 3:if(xl=null,c=Cn,Cn=vl(t.containerInfo),Zt(t,e),Cn=c,Wt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Zi(t.containerInfo)}catch(Ee){at(e,e.return,Ee)}vc&&(vc=!1,oh(e));break;case 4:r=Cn,Cn=vl(e.stateNode.containerInfo),Zt(t,e),Wt(e),Cn=r;break;case 12:Zt(t,e),Wt(e);break;case 31:Zt(t,e),Wt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,il(e,r)));break;case 13:Zt(t,e),Wt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(sl=Gt()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,il(e,r)));break;case 22:c=e.memoizedState!==null;var k=n!==null&&n.memoizedState!==null,Y=Zn,se=At;if(Zn=Y||c,At=se||k,Zt(t,e),At=se,Zn=Y,Wt(e),r&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||k||Zn||At||ni(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){k=n=t;try{if(f=k.stateNode,c)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{S=k.stateNode;var fe=k.memoizedProps.style,X=fe!=null&&fe.hasOwnProperty("display")?fe.display:null;S.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(Ee){at(k,k.return,Ee)}}}else if(t.tag===6){if(n===null){k=t;try{k.stateNode.nodeValue=c?"":k.memoizedProps}catch(Ee){at(k,k.return,Ee)}}}else if(t.tag===18){if(n===null){k=t;try{var te=k.stateNode;c?Xh(te,!0):Xh(k.stateNode,!1)}catch(Ee){at(k,k.return,Ee)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(n=r.retryQueue,n!==null&&(r.retryQueue=null,il(e,n))));break;case 19:Zt(t,e),Wt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,il(e,r)));break;case 30:break;case 21:break;default:Zt(t,e),Wt(e)}}function Wt(e){var t=e.flags;if(t&2){try{for(var n,r=e.return;r!==null;){if(Wf(r)){n=r;break}r=r.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,f=mc(e);al(e,f,c);break;case 5:var y=n.stateNode;n.flags&32&&(Hn(y,""),n.flags&=-33);var S=mc(e);al(e,S,y);break;case 3:case 4:var k=n.stateNode.containerInfo,Y=mc(e);yc(e,Y,k);break;default:throw Error(l(161))}}catch(se){at(e,e.return,se)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function oh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;oh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ea(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)nh(e,t.alternate,t),t=t.sibling}function ni(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ya(4,t,t.return),ni(t);break;case 1:Ln(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Xf(t,t.return,n),ni(t);break;case 27:Qr(t.stateNode);case 26:case 5:Ln(t,t.return),ni(t);break;case 22:t.memoizedState===null&&ni(t);break;case 30:ni(t);break;default:ni(t)}e=e.sibling}}function ta(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,c=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:ta(c,f,n),Ir(4,f);break;case 1:if(ta(c,f,n),r=f,c=r.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(Y){at(r,r.return,Y)}if(r=f,c=r.updateQueue,c!==null){var S=r.stateNode;try{var k=c.shared.hiddenCallbacks;if(k!==null)for(c.shared.hiddenCallbacks=null,c=0;c<k.length;c++)Md(k[c],S)}catch(Y){at(r,r.return,Y)}}n&&y&64&&Qf(f),Hr(f,f.return);break;case 27:eh(f);case 26:case 5:ta(c,f,n),n&&r===null&&y&4&&Zf(f),Hr(f,f.return);break;case 12:ta(c,f,n);break;case 31:ta(c,f,n),n&&y&4&&rh(c,f);break;case 13:ta(c,f,n),n&&y&4&&sh(c,f);break;case 22:f.memoizedState===null&&ta(c,f,n),Hr(f,f.return);break;case 30:break;default:ta(c,f,n)}t=t.sibling}}function bc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Tr(n))}function xc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Tr(e))}function Tn(e,t,n,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ch(e,t,n,r),t=t.sibling}function ch(e,t,n,r){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Tn(e,t,n,r),c&2048&&Ir(9,t);break;case 1:Tn(e,t,n,r);break;case 3:Tn(e,t,n,r),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Tr(e)));break;case 12:if(c&2048){Tn(e,t,n,r),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,S=f.onPostCommit;typeof S=="function"&&S(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(k){at(t,t.return,k)}}else Tn(e,t,n,r);break;case 31:Tn(e,t,n,r);break;case 13:Tn(e,t,n,r);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?Tn(e,t,n,r):$r(e,t):f._visibility&2?Tn(e,t,n,r):(f._visibility|=2,Hi(e,t,n,r,(t.subtreeFlags&10256)!==0||!1)),c&2048&&bc(y,t);break;case 24:Tn(e,t,n,r),c&2048&&xc(t.alternate,t);break;default:Tn(e,t,n,r)}}function Hi(e,t,n,r,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,S=n,k=r,Y=y.flags;switch(y.tag){case 0:case 11:case 15:Hi(f,y,S,k,c),Ir(8,y);break;case 23:break;case 22:var se=y.stateNode;y.memoizedState!==null?se._visibility&2?Hi(f,y,S,k,c):$r(f,y):(se._visibility|=2,Hi(f,y,S,k,c)),c&&Y&2048&&bc(y.alternate,y);break;case 24:Hi(f,y,S,k,c),c&&Y&2048&&xc(y.alternate,y);break;default:Hi(f,y,S,k,c)}t=t.sibling}}function $r(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,r=t,c=r.flags;switch(r.tag){case 22:$r(n,r),c&2048&&bc(r.alternate,r);break;case 24:$r(n,r),c&2048&&xc(r.alternate,r);break;default:$r(n,r)}t=t.sibling}}var Vr=8192;function $i(e,t,n){if(e.subtreeFlags&Vr)for(e=e.child;e!==null;)uh(e,t,n),e=e.sibling}function uh(e,t,n){switch(e.tag){case 26:$i(e,t,n),e.flags&Vr&&e.memoizedState!==null&&tv(n,Cn,e.memoizedState,e.memoizedProps);break;case 5:$i(e,t,n);break;case 3:case 4:var r=Cn;Cn=vl(e.stateNode.containerInfo),$i(e,t,n),Cn=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=Vr,Vr=16777216,$i(e,t,n),Vr=r):$i(e,t,n));break;default:$i(e,t,n)}}function dh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Pr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];Ut=r,hh(r,e)}dh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)fh(e),e=e.sibling}function fh(e){switch(e.tag){case 0:case 11:case 15:Pr(e),e.flags&2048&&ya(9,e,e.return);break;case 3:Pr(e);break;case 12:Pr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,rl(e)):Pr(e);break;default:Pr(e)}}function rl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];Ut=r,hh(r,e)}dh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ya(8,t,t.return),rl(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,rl(t));break;default:rl(t)}e=e.sibling}}function hh(e,t){for(;Ut!==null;){var n=Ut;switch(n.tag){case 0:case 11:case 15:ya(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var r=n.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:Tr(n.memoizedState.cache)}if(r=n.child,r!==null)r.return=n,Ut=r;else e:for(n=e;Ut!==null;){r=Ut;var c=r.sibling,f=r.return;if(ah(r),r===n){Ut=null;break e}if(c!==null){c.return=f,Ut=c;break e}Ut=f}}}var my={getCacheForType:function(e){var t=Lt(Et),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Lt(Et).controller.signal}},yy=typeof WeakMap=="function"?WeakMap:Map,We=0,ct=null,$e=null,Pe=0,nt=0,ln=null,va=!1,Vi=!1,_c=!1,na=0,xt=0,ba=0,ai=0,jc=0,on=0,Pi=0,Gr=null,en=null,Sc=!1,sl=0,gh=0,ll=1/0,ol=null,xa=null,Ot=0,_a=null,Gi=null,aa=0,wc=0,Ec=null,ph=null,Fr=0,Cc=null;function cn(){return(We&2)!==0&&Pe!==0?Pe&-Pe:E.T!==null?kc():ms()}function mh(){if(on===0)if((Pe&536870912)===0||Ke){var e=yi;yi<<=1,(yi&3932160)===0&&(yi=262144),on=e}else on=536870912;return e=rn.current,e!==null&&(e.flags|=32),on}function tn(e,t,n){(e===ct&&(nt===2||nt===9)||e.cancelPendingCommit!==null)&&(Fi(e,0),ja(e,Pe,on,!1)),Ma(e,n),((We&2)===0||e!==ct)&&(e===ct&&((We&2)===0&&(ai|=n),xt===4&&ja(e,Pe,on,!1)),Mn(e))}function yh(e,t,n){if((We&6)!==0)throw Error(l(327));var r=!n&&(t&127)===0&&(t&e.expiredLanes)===0||La(e,t),c=r?xy(e,t):Ac(e,t,!0),f=r;do{if(c===0){Vi&&!r&&ja(e,t,0,!1);break}else{if(n=e.current.alternate,f&&!vy(n)){c=Ac(e,t,!1),f=!1;continue}if(c===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var S=e;c=Gr;var k=S.current.memoizedState.isDehydrated;if(k&&(Fi(S,y).flags|=256),y=Ac(S,y,!1),y!==2){if(_c&&!k){S.errorRecoveryDisabledLanes|=f,ai|=f,c=4;break e}f=en,en=c,f!==null&&(en===null?en=f:en.push.apply(en,f))}c=y}if(f=!1,c!==2)continue}}if(c===1){Fi(e,0),ja(e,t,0,!0);break}e:{switch(r=e,f=c,f){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:ja(r,t,on,!va);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=sl+300-Gt(),10<c)){if(ja(r,t,on,!va),Ba(r,0,!0)!==0)break e;aa=t,r.timeoutHandle=Yh(vh.bind(null,r,n,en,ol,Sc,t,on,ai,Pi,va,f,"Throttled",-0,0),c);break e}vh(r,n,en,ol,Sc,t,on,ai,Pi,va,f,null,-0,0)}}break}while(!0);Mn(e)}function vh(e,t,n,r,c,f,y,S,k,Y,se,fe,X,te){if(e.timeoutHandle=-1,fe=t.subtreeFlags,fe&8192||(fe&16785408)===16785408){fe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:$n},uh(t,f,fe);var Ee=(f&62914560)===f?sl-Gt():(f&4194048)===f?gh-Gt():0;if(Ee=nv(fe,Ee),Ee!==null){aa=f,e.cancelPendingCommit=Ee(Ch.bind(null,e,t,f,n,r,c,y,S,k,se,fe,null,X,te)),ja(e,f,y,!Y);return}}Ch(e,t,f,n,r,c,y,S,k)}function vy(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var r=0;r<n.length;r++){var c=n[r],f=c.getSnapshot;c=c.value;try{if(!nn(f(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ja(e,t,n,r){t&=~jc,t&=~ai,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var c=t;0<c;){var f=31-Kt(c),y=1<<f;r[f]=-1,c&=~y}n!==0&&xi(e,n,t)}function cl(){return(We&6)===0?(Kr(0),!1):!0}function Tc(){if($e!==null){if(nt===0)var e=$e.return;else e=$e,Fn=Ya=null,Vo(e),Bi=null,Nr=0,e=$e;for(;e!==null;)Jf(e.alternate,e),e=e.return;$e=null}}function Fi(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,My(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),aa=0,Tc(),ct=e,$e=n=Pn(e.current,null),Pe=t,nt=0,ln=null,va=!1,Vi=La(e,t),_c=!1,Pi=on=jc=ai=ba=xt=0,en=Gr=null,Sc=!1,(t&8)!==0&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var c=31-Kt(r),f=1<<c;t|=e[c],r&=~f}return na=t,Rs(),n}function bh(e,t){qe=null,E.H=Lr,t===Di||t===Ms?(t=Ud(),nt=3):t===Oo?(t=Ud(),nt=4):nt=t===rc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,ln=t,$e===null&&(xt=1,Zs(e,gn(t,e.current)))}function xh(){var e=rn.current;return e===null?!0:(Pe&4194048)===Pe?vn===null:(Pe&62914560)===Pe||(Pe&536870912)!==0?e===vn:!1}function _h(){var e=E.H;return E.H=Lr,e===null?Lr:e}function jh(){var e=E.A;return E.A=my,e}function ul(){xt=4,va||(Pe&4194048)!==Pe&&rn.current!==null||(Vi=!0),(ba&134217727)===0&&(ai&134217727)===0||ct===null||ja(ct,Pe,on,!1)}function Ac(e,t,n){var r=We;We|=2;var c=_h(),f=jh();(ct!==e||Pe!==t)&&(ol=null,Fi(e,t)),t=!1;var y=xt;e:do try{if(nt!==0&&$e!==null){var S=$e,k=ln;switch(nt){case 8:Tc(),y=6;break e;case 3:case 2:case 9:case 6:rn.current===null&&(t=!0);var Y=nt;if(nt=0,ln=null,Ki(e,S,k,Y),n&&Vi){y=0;break e}break;default:Y=nt,nt=0,ln=null,Ki(e,S,k,Y)}}by(),y=xt;break}catch(se){bh(e,se)}while(!0);return t&&e.shellSuspendCounter++,Fn=Ya=null,We=r,E.H=c,E.A=f,$e===null&&(ct=null,Pe=0,Rs()),y}function by(){for(;$e!==null;)Sh($e)}function xy(e,t){var n=We;We|=2;var r=_h(),c=jh();ct!==e||Pe!==t?(ol=null,ll=Gt()+500,Fi(e,t)):Vi=La(e,t);e:do try{if(nt!==0&&$e!==null){t=$e;var f=ln;t:switch(nt){case 1:nt=0,ln=null,Ki(e,t,f,1);break;case 2:case 9:if(kd(f)){nt=0,ln=null,wh(t);break}t=function(){nt!==2&&nt!==9||ct!==e||(nt=7),Mn(e)},f.then(t,t);break e;case 3:nt=7;break e;case 4:nt=5;break e;case 7:kd(f)?(nt=0,ln=null,wh(t)):(nt=0,ln=null,Ki(e,t,f,7));break;case 5:var y=null;switch($e.tag){case 26:y=$e.memoizedState;case 5:case 27:var S=$e;if(y?cg(y):S.stateNode.complete){nt=0,ln=null;var k=S.sibling;if(k!==null)$e=k;else{var Y=S.return;Y!==null?($e=Y,dl(Y)):$e=null}break t}}nt=0,ln=null,Ki(e,t,f,5);break;case 6:nt=0,ln=null,Ki(e,t,f,6);break;case 8:Tc(),xt=6;break e;default:throw Error(l(462))}}_y();break}catch(se){bh(e,se)}while(!0);return Fn=Ya=null,E.H=r,E.A=c,We=n,$e!==null?0:(ct=null,Pe=0,Rs(),xt)}function _y(){for(;$e!==null&&!za();)Sh($e)}function Sh(e){var t=Kf(e.alternate,e,na);e.memoizedProps=e.pendingProps,t===null?dl(e):$e=t}function wh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Hf(n,t,t.pendingProps,t.type,void 0,Pe);break;case 11:t=Hf(n,t,t.pendingProps,t.type.render,t.ref,Pe);break;case 5:Vo(t);default:Jf(n,t),t=$e=_d(t,na),t=Kf(n,t,na)}e.memoizedProps=e.pendingProps,t===null?dl(e):$e=t}function Ki(e,t,n,r){Fn=Ya=null,Vo(t),Bi=null,Nr=0;var c=t.return;try{if(cy(e,c,t,n,Pe)){xt=1,Zs(e,gn(n,e.current)),$e=null;return}}catch(f){if(c!==null)throw $e=c,f;xt=1,Zs(e,gn(n,e.current)),$e=null;return}t.flags&32768?(Ke||r===1?e=!0:Vi||(Pe&536870912)!==0?e=!1:(va=e=!0,(r===2||r===9||r===3||r===6)&&(r=rn.current,r!==null&&r.tag===13&&(r.flags|=16384))),Eh(t,e)):dl(t)}function dl(e){var t=e;do{if((t.flags&32768)!==0){Eh(t,va);return}e=t.return;var n=fy(t.alternate,t,na);if(n!==null){$e=n;return}if(t=t.sibling,t!==null){$e=t;return}$e=t=e}while(t!==null);xt===0&&(xt=5)}function Eh(e,t){do{var n=hy(e.alternate,e);if(n!==null){n.flags&=32767,$e=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){$e=e;return}$e=e=n}while(e!==null);xt=6,$e=null}function Ch(e,t,n,r,c,f,y,S,k){e.cancelPendingCommit=null;do fl();while(Ot!==0);if((We&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(f=t.lanes|t.childLanes,f|=mo,Ql(e,n,f,y,S,k),e===ct&&($e=ct=null,Pe=0),Gi=t,_a=e,aa=n,wc=f,Ec=c,ph=r,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ey(Ua,function(){return Oh(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||r){r=E.T,E.T=null,c=z.p,z.p=2,y=We,We|=4;try{gy(e,t,n)}finally{We=y,z.p=c,E.T=r}}Ot=1,Th(),Ah(),Nh()}}function Th(){if(Ot===1){Ot=0;var e=_a,t=Gi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=E.T,E.T=null;var r=z.p;z.p=2;var c=We;We|=4;try{lh(t,e);var f=Ic,y=fd(e.containerInfo),S=f.focusedElem,k=f.selectionRange;if(y!==S&&S&&S.ownerDocument&&dd(S.ownerDocument.documentElement,S)){if(k!==null&&uo(S)){var Y=k.start,se=k.end;if(se===void 0&&(se=Y),"selectionStart"in S)S.selectionStart=Y,S.selectionEnd=Math.min(se,S.value.length);else{var fe=S.ownerDocument||document,X=fe&&fe.defaultView||window;if(X.getSelection){var te=X.getSelection(),Ee=S.textContent.length,Ue=Math.min(k.start,Ee),lt=k.end===void 0?Ue:Math.min(k.end,Ee);!te.extend&&Ue>lt&&(y=lt,lt=Ue,Ue=y);var V=ud(S,Ue),B=ud(S,lt);if(V&&B&&(te.rangeCount!==1||te.anchorNode!==V.node||te.anchorOffset!==V.offset||te.focusNode!==B.node||te.focusOffset!==B.offset)){var K=fe.createRange();K.setStart(V.node,V.offset),te.removeAllRanges(),Ue>lt?(te.addRange(K),te.extend(B.node,B.offset)):(K.setEnd(B.node,B.offset),te.addRange(K))}}}}for(fe=[],te=S;te=te.parentNode;)te.nodeType===1&&fe.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<fe.length;S++){var ce=fe[S];ce.element.scrollLeft=ce.left,ce.element.scrollTop=ce.top}}wl=!!qc,Ic=qc=null}finally{We=c,z.p=r,E.T=n}}e.current=t,Ot=2}}function Ah(){if(Ot===2){Ot=0;var e=_a,t=Gi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=E.T,E.T=null;var r=z.p;z.p=2;var c=We;We|=4;try{nh(e,t.alternate,t)}finally{We=c,z.p=r,E.T=n}}Ot=3}}function Nh(){if(Ot===4||Ot===3){Ot=0,fi();var e=_a,t=Gi,n=aa,r=ph;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ot=5:(Ot=0,Gi=_a=null,Rh(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(xa=null),fr(n),t=t.stateNode,Ft&&typeof Ft.onCommitFiberRoot=="function")try{Ft.onCommitFiberRoot(Da,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=E.T,c=z.p,z.p=2,E.T=null;try{for(var f=e.onRecoverableError,y=0;y<r.length;y++){var S=r[y];f(S.value,{componentStack:S.stack})}}finally{E.T=t,z.p=c}}(aa&3)!==0&&fl(),Mn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===Cc?Fr++:(Fr=0,Cc=e):Fr=0,Kr(0)}}function Rh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Tr(t)))}function fl(){return Th(),Ah(),Nh(),Oh()}function Oh(){if(Ot!==5)return!1;var e=_a,t=wc;wc=0;var n=fr(aa),r=E.T,c=z.p;try{z.p=32>n?32:n,E.T=null,n=Ec,Ec=null;var f=_a,y=aa;if(Ot=0,Gi=_a=null,aa=0,(We&6)!==0)throw Error(l(331));var S=We;if(We|=4,fh(f.current),ch(f,f.current,y,n),We=S,Kr(0,!1),Ft&&typeof Ft.onPostCommitFiberRoot=="function")try{Ft.onPostCommitFiberRoot(Da,f)}catch{}return!0}finally{z.p=c,E.T=r,Rh(e,t)}}function kh(e,t,n){t=gn(n,t),t=ic(e.stateNode,t,2),e=ga(e,t,2),e!==null&&(Ma(e,2),Mn(e))}function at(e,t,n){if(e.tag===3)kh(e,e,n);else for(;t!==null;){if(t.tag===3){kh(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(xa===null||!xa.has(r))){e=gn(n,e),n=zf(2),r=ga(t,n,2),r!==null&&(Uf(n,r,t,e),Ma(r,2),Mn(r));break}}t=t.return}}function Nc(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new yy;var c=new Set;r.set(t,c)}else c=r.get(t),c===void 0&&(c=new Set,r.set(t,c));c.has(n)||(_c=!0,c.add(n),e=jy.bind(null,e,t,n),t.then(e,e))}function jy(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ct===e&&(Pe&n)===n&&(xt===4||xt===3&&(Pe&62914560)===Pe&&300>Gt()-sl?(We&2)===0&&Fi(e,0):jc|=n,Pi===Pe&&(Pi=0)),Mn(e)}function zh(e,t){t===0&&(t=zn()),e=Ga(e,t),e!==null&&(Ma(e,t),Mn(e))}function Sy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),zh(e,n)}function wy(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(l(314))}r!==null&&r.delete(t),zh(e,n)}function Ey(e,t){return Ze(e,t)}var hl=null,Yi=null,Rc=!1,gl=!1,Oc=!1,Sa=0;function Mn(e){e!==Yi&&e.next===null&&(Yi===null?hl=Yi=e:Yi=Yi.next=e),gl=!0,Rc||(Rc=!0,Ty())}function Kr(e,t){if(!Oc&&gl){Oc=!0;do for(var n=!1,r=hl;r!==null;){if(e!==0){var c=r.pendingLanes;if(c===0)var f=0;else{var y=r.suspendedLanes,S=r.pingedLanes;f=(1<<31-Kt(42|e)+1)-1,f&=c&~(y&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(n=!0,Lh(r,f))}else f=Pe,f=Ba(r,r===ct?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(f&3)===0||La(r,f)||(n=!0,Lh(r,f));r=r.next}while(n);Oc=!1}}function Cy(){Uh()}function Uh(){gl=Rc=!1;var e=0;Sa!==0&&Ly()&&(e=Sa);for(var t=Gt(),n=null,r=hl;r!==null;){var c=r.next,f=Dh(r,t);f===0?(r.next=null,n===null?hl=c:n.next=c,c===null&&(Yi=n)):(n=r,(e!==0||(f&3)!==0)&&(gl=!0)),r=c}Ot!==0&&Ot!==5||Kr(e),Sa!==0&&(Sa=0)}function Dh(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,c=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Kt(f),S=1<<y,k=c[y];k===-1?((S&n)===0||(S&r)!==0)&&(c[y]=qn(S,t)):k<=t&&(e.expiredLanes|=S),f&=~S}if(t=ct,n=Pe,n=Ba(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,n===0||e===t&&(nt===2||nt===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&et(r),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||La(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(r!==null&&et(r),fr(n)){case 2:case 8:n=gi;break;case 32:n=Ua;break;case 268435456:n=hs;break;default:n=Ua}return r=Bh.bind(null,e),n=Ze(n,r),e.callbackPriority=t,e.callbackNode=n,t}return r!==null&&r!==null&&et(r),e.callbackPriority=2,e.callbackNode=null,2}function Bh(e,t){if(Ot!==0&&Ot!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(fl()&&e.callbackNode!==n)return null;var r=Pe;return r=Ba(e,e===ct?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(yh(e,r,t),Dh(e,Gt()),e.callbackNode!=null&&e.callbackNode===n?Bh.bind(null,e):null)}function Lh(e,t){if(fl())return null;yh(e,t,!0)}function Ty(){qy(function(){(We&6)!==0?Ze(fs,Cy):Uh()})}function kc(){if(Sa===0){var e=zi;e===0&&(e=mi,mi<<=1,(mi&261888)===0&&(mi=256)),Sa=e}return Sa}function Mh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:js(""+e)}function qh(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ay(e,t,n,r,c){if(t==="submit"&&n&&n.stateNode===c){var f=Mh((c[zt]||null).action),y=r.submitter;y&&(t=(t=y[zt]||null)?Mh(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var S=new Cs("action","action",null,r,c);e.push({event:S,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(Sa!==0){var k=y?qh(c,y):new FormData(c);Zo(n,{pending:!0,data:k,method:c.method,action:f},null,k)}}else typeof f=="function"&&(S.preventDefault(),k=y?qh(c,y):new FormData(c),Zo(n,{pending:!0,data:k,method:c.method,action:f},f,k))},currentTarget:c}]})}}for(var zc=0;zc<po.length;zc++){var Uc=po[zc],Ny=Uc.toLowerCase(),Ry=Uc[0].toUpperCase()+Uc.slice(1);En(Ny,"on"+Ry)}En(pd,"onAnimationEnd"),En(md,"onAnimationIteration"),En(yd,"onAnimationStart"),En("dblclick","onDoubleClick"),En("focusin","onFocus"),En("focusout","onBlur"),En(Fm,"onTransitionRun"),En(Km,"onTransitionStart"),En(Ym,"onTransitionCancel"),En(vd,"onTransitionEnd"),ae("onMouseEnter",["mouseout","mouseover"]),ae("onMouseLeave",["mouseout","mouseover"]),ae("onPointerEnter",["pointerout","pointerover"]),ae("onPointerLeave",["pointerout","pointerover"]),je("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),je("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),je("onBeforeInput",["compositionend","keypress","textInput","paste"]),je("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),je("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yr));function Ih(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],c=r.event;r=r.listeners;e:{var f=void 0;if(t)for(var y=r.length-1;0<=y;y--){var S=r[y],k=S.instance,Y=S.currentTarget;if(S=S.listener,k!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=Y;try{f(c)}catch(se){Ns(se)}c.currentTarget=null,f=k}else for(y=0;y<r.length;y++){if(S=r[y],k=S.instance,Y=S.currentTarget,S=S.listener,k!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=Y;try{f(c)}catch(se){Ns(se)}c.currentTarget=null,f=k}}}}function Ve(e,t){var n=t[hr];n===void 0&&(n=t[hr]=new Set);var r=e+"__bubble";n.has(r)||(Hh(t,e,2,!1),n.add(r))}function Dc(e,t,n){var r=0;t&&(r|=4),Hh(n,e,r,t)}var pl="_reactListening"+Math.random().toString(36).slice(2);function Bc(e){if(!e[pl]){e[pl]=!0,ye.forEach(function(n){n!=="selectionchange"&&(Oy.has(n)||Dc(n,!1,e),Dc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[pl]||(t[pl]=!0,Dc("selectionchange",!1,t))}}function Hh(e,t,n,r){switch(mg(t)){case 2:var c=rv;break;case 8:c=sv;break;default:c=Xc}n=c.bind(null,t,n,e),c=void 0,!to||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),r?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Lc(e,t,n,r,c){var f=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var y=r.tag;if(y===3||y===4){var S=r.stateNode.containerInfo;if(S===c)break;if(y===4)for(y=r.return;y!==null;){var k=y.tag;if((k===3||k===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;S!==null;){if(y=H(S),y===null)return;if(k=y.tag,k===5||k===6||k===26||k===27){r=f=y;continue e}S=S.parentNode}}r=r.return}Gu(function(){var Y=f,se=Wl(n),fe=[];e:{var X=bd.get(e);if(X!==void 0){var te=Cs,Ee=e;switch(e){case"keypress":if(ws(n)===0)break e;case"keydown":case"keyup":te=wm;break;case"focusin":Ee="focus",te=ro;break;case"focusout":Ee="blur",te=ro;break;case"beforeblur":case"afterblur":te=ro;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Yu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=fm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=Tm;break;case pd:case md:case yd:te=pm;break;case vd:te=Nm;break;case"scroll":case"scrollend":te=um;break;case"wheel":te=Om;break;case"copy":case"cut":case"paste":te=ym;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=Qu;break;case"toggle":case"beforetoggle":te=zm}var Ue=(t&4)!==0,lt=!Ue&&(e==="scroll"||e==="scrollend"),V=Ue?X!==null?X+"Capture":null:X;Ue=[];for(var B=Y,K;B!==null;){var ce=B;if(K=ce.stateNode,ce=ce.tag,ce!==5&&ce!==26&&ce!==27||K===null||V===null||(ce=mr(B,V),ce!=null&&Ue.push(Jr(B,ce,K))),lt)break;B=B.return}0<Ue.length&&(X=new te(X,Ee,null,n,se),fe.push({event:X,listeners:Ue}))}}if((t&7)===0){e:{if(X=e==="mouseover"||e==="pointerover",te=e==="mouseout"||e==="pointerout",X&&n!==Zl&&(Ee=n.relatedTarget||n.fromElement)&&(H(Ee)||Ee[Jt]))break e;if((te||X)&&(X=se.window===se?se:(X=se.ownerDocument)?X.defaultView||X.parentWindow:window,te?(Ee=n.relatedTarget||n.toElement,te=Y,Ee=Ee?H(Ee):null,Ee!==null&&(lt=d(Ee),Ue=Ee.tag,Ee!==lt||Ue!==5&&Ue!==27&&Ue!==6)&&(Ee=null)):(te=null,Ee=Y),te!==Ee)){if(Ue=Yu,ce="onMouseLeave",V="onMouseEnter",B="mouse",(e==="pointerout"||e==="pointerover")&&(Ue=Qu,ce="onPointerLeave",V="onPointerEnter",B="pointer"),lt=te==null?X:xe(te),K=Ee==null?X:xe(Ee),X=new Ue(ce,B+"leave",te,n,se),X.target=lt,X.relatedTarget=K,ce=null,H(se)===Y&&(Ue=new Ue(V,B+"enter",Ee,n,se),Ue.target=K,Ue.relatedTarget=lt,ce=Ue),lt=ce,te&&Ee)t:{for(Ue=ky,V=te,B=Ee,K=0,ce=V;ce;ce=Ue(ce))K++;ce=0;for(var ke=B;ke;ke=Ue(ke))ce++;for(;0<K-ce;)V=Ue(V),K--;for(;0<ce-K;)B=Ue(B),ce--;for(;K--;){if(V===B||B!==null&&V===B.alternate){Ue=V;break t}V=Ue(V),B=Ue(B)}Ue=null}else Ue=null;te!==null&&$h(fe,X,te,Ue,!1),Ee!==null&&lt!==null&&$h(fe,lt,Ee,Ue,!0)}}e:{if(X=Y?xe(Y):window,te=X.nodeName&&X.nodeName.toLowerCase(),te==="select"||te==="input"&&X.type==="file")var Qe=id;else if(nd(X))if(rd)Qe=Vm;else{Qe=Hm;var Te=Im}else te=X.nodeName,!te||te.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Y&&Xl(Y.elementType)&&(Qe=id):Qe=$m;if(Qe&&(Qe=Qe(e,Y))){ad(fe,Qe,n,se);break e}Te&&Te(e,X,Y),e==="focusout"&&Y&&X.type==="number"&&Y.memoizedProps.value!=null&&yt(X,"number",X.value)}switch(Te=Y?xe(Y):window,e){case"focusin":(nd(Te)||Te.contentEditable==="true")&&(Ei=Te,fo=Y,wr=null);break;case"focusout":wr=fo=Ei=null;break;case"mousedown":ho=!0;break;case"contextmenu":case"mouseup":case"dragend":ho=!1,hd(fe,n,se);break;case"selectionchange":if(Gm)break;case"keydown":case"keyup":hd(fe,n,se)}var Ie;if(lo)e:{switch(e){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else wi?ed(e,n)&&(Ge="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ge="onCompositionStart");Ge&&(Xu&&n.locale!=="ko"&&(wi||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&wi&&(Ie=Fu()):(la=se,no="value"in la?la.value:la.textContent,wi=!0)),Te=ml(Y,Ge),0<Te.length&&(Ge=new Ju(Ge,e,null,n,se),fe.push({event:Ge,listeners:Te}),Ie?Ge.data=Ie:(Ie=td(n),Ie!==null&&(Ge.data=Ie)))),(Ie=Dm?Bm(e,n):Lm(e,n))&&(Ge=ml(Y,"onBeforeInput"),0<Ge.length&&(Te=new Ju("onBeforeInput","beforeinput",null,n,se),fe.push({event:Te,listeners:Ge}),Te.data=Ie)),Ay(fe,e,Y,n,se)}Ih(fe,t)})}function Jr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ml(e,t){for(var n=t+"Capture",r=[];e!==null;){var c=e,f=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||f===null||(c=mr(e,n),c!=null&&r.unshift(Jr(e,c,f)),c=mr(e,t),c!=null&&r.push(Jr(e,c,f))),e.tag===3)return r;e=e.return}return[]}function ky(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function $h(e,t,n,r,c){for(var f=t._reactName,y=[];n!==null&&n!==r;){var S=n,k=S.alternate,Y=S.stateNode;if(S=S.tag,k!==null&&k===r)break;S!==5&&S!==26&&S!==27||Y===null||(k=Y,c?(Y=mr(n,f),Y!=null&&y.unshift(Jr(n,Y,k))):c||(Y=mr(n,f),Y!=null&&y.push(Jr(n,Y,k)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var zy=/\r\n?/g,Uy=/\u0000|\uFFFD/g;function Vh(e){return(typeof e=="string"?e:""+e).replace(zy,`
`).replace(Uy,"")}function Ph(e,t){return t=Vh(t),Vh(e)===t}function st(e,t,n,r,c,f){switch(n){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||Hn(e,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&Hn(e,""+r);break;case"className":it(e,"class",r);break;case"tabIndex":it(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":it(e,n,r);break;case"style":Vu(e,r,f);break;case"data":if(t!=="object"){it(e,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=js(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(n==="formAction"?(t!=="input"&&st(e,t,"name",c.name,c,null),st(e,t,"formEncType",c.formEncType,c,null),st(e,t,"formMethod",c.formMethod,c,null),st(e,t,"formTarget",c.formTarget,c,null)):(st(e,t,"encType",c.encType,c,null),st(e,t,"method",c.method,c,null),st(e,t,"target",c.target,c,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=js(""+r),e.setAttribute(n,r);break;case"onClick":r!=null&&(e.onclick=$n);break;case"onScroll":r!=null&&Ve("scroll",e);break;case"onScrollEnd":r!=null&&Ve("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(n=r.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}n=js(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":r===!0?e.setAttribute(n,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Ve("beforetoggle",e),Ve("toggle",e),Dt(e,"popover",r);break;case"xlinkActuate":Je(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":Je(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":Je(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":Je(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":Je(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":Je(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":Je(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":Je(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":Je(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":Dt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=om.get(n)||n,Dt(e,n,r))}}function Mc(e,t,n,r,c,f){switch(n){case"style":Vu(e,r,f);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(n=r.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof r=="string"?Hn(e,r):(typeof r=="number"||typeof r=="bigint")&&Hn(e,""+r);break;case"onScroll":r!=null&&Ve("scroll",e);break;case"onScrollEnd":r!=null&&Ve("scrollend",e);break;case"onClick":r!=null&&(e.onclick=$n);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!he.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),f=e[zt]||null,f=f!=null?f[n]:null,typeof f=="function"&&e.removeEventListener(t,f,c),typeof r=="function")){typeof f!="function"&&f!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,c);break e}n in e?e[n]=r:r===!0?e.setAttribute(n,""):Dt(e,n,r)}}}function qt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",e),Ve("load",e);var r=!1,c=!1,f;for(f in n)if(n.hasOwnProperty(f)){var y=n[f];if(y!=null)switch(f){case"src":r=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:st(e,t,f,y,n,null)}}c&&st(e,t,"srcSet",n.srcSet,n,null),r&&st(e,t,"src",n.src,n,null);return;case"input":Ve("invalid",e);var S=f=y=c=null,k=null,Y=null;for(r in n)if(n.hasOwnProperty(r)){var se=n[r];if(se!=null)switch(r){case"name":c=se;break;case"type":y=se;break;case"checked":k=se;break;case"defaultChecked":Y=se;break;case"value":f=se;break;case"defaultValue":S=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(l(137,t));break;default:st(e,t,r,se,n,null)}}tt(e,f,S,k,Y,y,c,!1);return;case"select":Ve("invalid",e),r=y=f=null;for(c in n)if(n.hasOwnProperty(c)&&(S=n[c],S!=null))switch(c){case"value":f=S;break;case"defaultValue":y=S;break;case"multiple":r=S;default:st(e,t,c,S,n,null)}t=f,n=y,e.multiple=!!r,t!=null?Oe(e,!!r,t,!1):n!=null&&Oe(e,!!r,n,!0);return;case"textarea":Ve("invalid",e),f=c=r=null;for(y in n)if(n.hasOwnProperty(y)&&(S=n[y],S!=null))switch(y){case"value":r=S;break;case"defaultValue":c=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(l(91));break;default:st(e,t,y,S,n,null)}$t(e,r,c,f);return;case"option":for(k in n)if(n.hasOwnProperty(k)&&(r=n[k],r!=null))switch(k){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:st(e,t,k,r,n,null)}return;case"dialog":Ve("beforetoggle",e),Ve("toggle",e),Ve("cancel",e),Ve("close",e);break;case"iframe":case"object":Ve("load",e);break;case"video":case"audio":for(r=0;r<Yr.length;r++)Ve(Yr[r],e);break;case"image":Ve("error",e),Ve("load",e);break;case"details":Ve("toggle",e);break;case"embed":case"source":case"link":Ve("error",e),Ve("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in n)if(n.hasOwnProperty(Y)&&(r=n[Y],r!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:st(e,t,Y,r,n,null)}return;default:if(Xl(t)){for(se in n)n.hasOwnProperty(se)&&(r=n[se],r!==void 0&&Mc(e,t,se,r,n,void 0));return}}for(S in n)n.hasOwnProperty(S)&&(r=n[S],r!=null&&st(e,t,S,r,n,null))}function Dy(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,f=null,y=null,S=null,k=null,Y=null,se=null;for(te in n){var fe=n[te];if(n.hasOwnProperty(te)&&fe!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":k=fe;default:r.hasOwnProperty(te)||st(e,t,te,null,r,fe)}}for(var X in r){var te=r[X];if(fe=n[X],r.hasOwnProperty(X)&&(te!=null||fe!=null))switch(X){case"type":f=te;break;case"name":c=te;break;case"checked":Y=te;break;case"defaultChecked":se=te;break;case"value":y=te;break;case"defaultValue":S=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(l(137,t));break;default:te!==fe&&st(e,t,X,te,r,fe)}}ze(e,y,S,k,Y,se,f,c);return;case"select":te=y=S=X=null;for(f in n)if(k=n[f],n.hasOwnProperty(f)&&k!=null)switch(f){case"value":break;case"multiple":te=k;default:r.hasOwnProperty(f)||st(e,t,f,null,r,k)}for(c in r)if(f=r[c],k=n[c],r.hasOwnProperty(c)&&(f!=null||k!=null))switch(c){case"value":X=f;break;case"defaultValue":S=f;break;case"multiple":y=f;default:f!==k&&st(e,t,c,f,r,k)}t=S,n=y,r=te,X!=null?Oe(e,!!n,X,!1):!!r!=!!n&&(t!=null?Oe(e,!!n,t,!0):Oe(e,!!n,n?[]:"",!1));return;case"textarea":te=X=null;for(S in n)if(c=n[S],n.hasOwnProperty(S)&&c!=null&&!r.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:st(e,t,S,null,r,c)}for(y in r)if(c=r[y],f=n[y],r.hasOwnProperty(y)&&(c!=null||f!=null))switch(y){case"value":X=c;break;case"defaultValue":te=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==f&&st(e,t,y,c,r,f)}ot(e,X,te);return;case"option":for(var Ee in n)if(X=n[Ee],n.hasOwnProperty(Ee)&&X!=null&&!r.hasOwnProperty(Ee))switch(Ee){case"selected":e.selected=!1;break;default:st(e,t,Ee,null,r,X)}for(k in r)if(X=r[k],te=n[k],r.hasOwnProperty(k)&&X!==te&&(X!=null||te!=null))switch(k){case"selected":e.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:st(e,t,k,X,r,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in n)X=n[Ue],n.hasOwnProperty(Ue)&&X!=null&&!r.hasOwnProperty(Ue)&&st(e,t,Ue,null,r,X);for(Y in r)if(X=r[Y],te=n[Y],r.hasOwnProperty(Y)&&X!==te&&(X!=null||te!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(l(137,t));break;default:st(e,t,Y,X,r,te)}return;default:if(Xl(t)){for(var lt in n)X=n[lt],n.hasOwnProperty(lt)&&X!==void 0&&!r.hasOwnProperty(lt)&&Mc(e,t,lt,void 0,r,X);for(se in r)X=r[se],te=n[se],!r.hasOwnProperty(se)||X===te||X===void 0&&te===void 0||Mc(e,t,se,X,r,te);return}}for(var V in n)X=n[V],n.hasOwnProperty(V)&&X!=null&&!r.hasOwnProperty(V)&&st(e,t,V,null,r,X);for(fe in r)X=r[fe],te=n[fe],!r.hasOwnProperty(fe)||X===te||X==null&&te==null||st(e,t,fe,X,r,te)}function Gh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function By(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var c=n[r],f=c.transferSize,y=c.initiatorType,S=c.duration;if(f&&S&&Gh(y)){for(y=0,S=c.responseEnd,r+=1;r<n.length;r++){var k=n[r],Y=k.startTime;if(Y>S)break;var se=k.transferSize,fe=k.initiatorType;se&&Gh(fe)&&(k=k.responseEnd,y+=se*(k<S?1:(S-Y)/(k-Y)))}if(--r,t+=8*(f+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var qc=null,Ic=null;function yl(e){return e.nodeType===9?e:e.ownerDocument}function Fh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Kh(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Hc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var $c=null;function Ly(){var e=window.event;return e&&e.type==="popstate"?e===$c?!1:($c=e,!0):($c=null,!1)}var Yh=typeof setTimeout=="function"?setTimeout:void 0,My=typeof clearTimeout=="function"?clearTimeout:void 0,Jh=typeof Promise=="function"?Promise:void 0,qy=typeof queueMicrotask=="function"?queueMicrotask:typeof Jh<"u"?function(e){return Jh.resolve(null).then(e).catch(Iy)}:Yh;function Iy(e){setTimeout(function(){throw e})}function wa(e){return e==="head"}function Qh(e,t){var n=t,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(r===0){e.removeChild(c),Zi(t);return}r--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")r++;else if(n==="html")Qr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Qr(n);for(var f=n.firstChild;f;){var y=f.nextSibling,S=f.nodeName;f[qa]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||n.removeChild(f),f=y}}else n==="body"&&Qr(e.ownerDocument.body);n=c}while(n);Zi(t)}function Xh(e,t){var n=e;e=0;do{var r=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=r}while(n)}function Vc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Vc(n),gr(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Hy(e,t,n,r){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[qa])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=bn(e.nextSibling),e===null)break}return null}function $y(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=bn(e.nextSibling),e===null))return null;return e}function Zh(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=bn(e.nextSibling),e===null))return null;return e}function Pc(e){return e.data==="$?"||e.data==="$~"}function Gc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Vy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function bn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Fc=null;function Wh(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return bn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function eg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function tg(e,t,n){switch(t=yl(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Qr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);gr(e)}var xn=new Map,ng=new Set;function vl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ia=z.d;z.d={f:Py,r:Gy,D:Fy,C:Ky,L:Yy,m:Jy,X:Xy,S:Qy,M:Zy};function Py(){var e=ia.f(),t=cl();return e||t}function Gy(e){var t=le(e);t!==null&&t.tag===5&&t.type==="form"?bf(t):ia.r(e)}var Ji=typeof document>"u"?null:document;function ag(e,t,n){var r=Ji;if(r&&typeof t=="string"&&t){var c=_t(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),ng.has(c)||(ng.add(c),e={rel:e,crossOrigin:n,href:t},r.querySelector(c)===null&&(t=r.createElement("link"),qt(t,"link",e),oe(t),r.head.appendChild(t)))}}function Fy(e){ia.D(e),ag("dns-prefetch",e,null)}function Ky(e,t){ia.C(e,t),ag("preconnect",e,t)}function Yy(e,t,n){ia.L(e,t,n);var r=Ji;if(r&&e&&t){var c='link[rel="preload"][as="'+_t(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+_t(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+_t(n.imageSizes)+'"]')):c+='[href="'+_t(e)+'"]';var f=c;switch(t){case"style":f=Qi(e);break;case"script":f=Xi(e)}xn.has(f)||(e=x({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),xn.set(f,e),r.querySelector(c)!==null||t==="style"&&r.querySelector(Xr(f))||t==="script"&&r.querySelector(Zr(f))||(t=r.createElement("link"),qt(t,"link",e),oe(t),r.head.appendChild(t)))}}function Jy(e,t){ia.m(e,t);var n=Ji;if(n&&e){var r=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+_t(r)+'"][href="'+_t(e)+'"]',f=c;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=Xi(e)}if(!xn.has(f)&&(e=x({rel:"modulepreload",href:e},t),xn.set(f,e),n.querySelector(c)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Zr(f)))return}r=n.createElement("link"),qt(r,"link",e),oe(r),n.head.appendChild(r)}}}function Qy(e,t,n){ia.S(e,t,n);var r=Ji;if(r&&e){var c=re(r).hoistableStyles,f=Qi(e);t=t||"default";var y=c.get(f);if(!y){var S={loading:0,preload:null};if(y=r.querySelector(Xr(f)))S.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},n),(n=xn.get(f))&&Kc(e,n);var k=y=r.createElement("link");oe(k),qt(k,"link",e),k._p=new Promise(function(Y,se){k.onload=Y,k.onerror=se}),k.addEventListener("load",function(){S.loading|=1}),k.addEventListener("error",function(){S.loading|=2}),S.loading|=4,bl(y,t,r)}y={type:"stylesheet",instance:y,count:1,state:S},c.set(f,y)}}}function Xy(e,t){ia.X(e,t);var n=Ji;if(n&&e){var r=re(n).hoistableScripts,c=Xi(e),f=r.get(c);f||(f=n.querySelector(Zr(c)),f||(e=x({src:e,async:!0},t),(t=xn.get(c))&&Yc(e,t),f=n.createElement("script"),oe(f),qt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},r.set(c,f))}}function Zy(e,t){ia.M(e,t);var n=Ji;if(n&&e){var r=re(n).hoistableScripts,c=Xi(e),f=r.get(c);f||(f=n.querySelector(Zr(c)),f||(e=x({src:e,async:!0,type:"module"},t),(t=xn.get(c))&&Yc(e,t),f=n.createElement("script"),oe(f),qt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},r.set(c,f))}}function ig(e,t,n,r){var c=(c=ge.current)?vl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Qi(n.href),n=re(c).hoistableStyles,r=n.get(t),r||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Qi(n.href);var f=re(c).hoistableStyles,y=f.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=c.querySelector(Xr(e)))&&!f._p&&(y.instance=f,y.state.loading=5),xn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},xn.set(e,n),f||Wy(c,e,n,y.state))),t&&r===null)throw Error(l(528,""));return y}if(t&&r!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Xi(n),n=re(c).hoistableScripts,r=n.get(t),r||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Qi(e){return'href="'+_t(e)+'"'}function Xr(e){return'link[rel="stylesheet"]['+e+"]"}function rg(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function Wy(e,t,n,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),qt(t,"link",n),oe(t),e.head.appendChild(t))}function Xi(e){return'[src="'+_t(e)+'"]'}function Zr(e){return"script[async]"+e}function sg(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+_t(n.href)+'"]');if(r)return t.instance=r,oe(r),r;var c=x({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),oe(r),qt(r,"style",c),bl(r,n.precedence,e),t.instance=r;case"stylesheet":c=Qi(n.href);var f=e.querySelector(Xr(c));if(f)return t.state.loading|=4,t.instance=f,oe(f),f;r=rg(n),(c=xn.get(c))&&Kc(r,c),f=(e.ownerDocument||e).createElement("link"),oe(f);var y=f;return y._p=new Promise(function(S,k){y.onload=S,y.onerror=k}),qt(f,"link",r),t.state.loading|=4,bl(f,n.precedence,e),t.instance=f;case"script":return f=Xi(n.src),(c=e.querySelector(Zr(f)))?(t.instance=c,oe(c),c):(r=n,(c=xn.get(f))&&(r=x({},n),Yc(r,c)),e=e.ownerDocument||e,c=e.createElement("script"),oe(c),qt(c,"link",r),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(r=t.instance,t.state.loading|=4,bl(r,n.precedence,e));return t.instance}function bl(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=r.length?r[r.length-1]:null,f=c,y=0;y<r.length;y++){var S=r[y];if(S.dataset.precedence===t)f=S;else if(f!==c)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Kc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Yc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var xl=null;function lg(e,t,n){if(xl===null){var r=new Map,c=xl=new Map;c.set(n,r)}else c=xl,r=c.get(n),r||(r=new Map,c.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var f=n[c];if(!(f[qa]||f[Rt]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var S=r.get(y);S?S.push(f):r.set(y,[f])}}return r}function og(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function ev(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function cg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function tv(e,t,n,r){if(n.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=Qi(r.href),f=t.querySelector(Xr(c));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=_l.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=f,oe(f);return}f=t.ownerDocument||t,r=rg(r),(c=xn.get(c))&&Kc(r,c),f=f.createElement("link"),oe(f);var y=f;y._p=new Promise(function(S,k){y.onload=S,y.onerror=k}),qt(f,"link",r),n.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=_l.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Jc=0;function nv(e,t){return e.stylesheets&&e.count===0&&Sl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&Sl(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&Jc===0&&(Jc=62500*By());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Sl(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>Jc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(c)}}:null}function _l(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Sl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var jl=null;function Sl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,jl=new Map,t.forEach(av,e),jl=null,_l.call(e))}function av(e,t){if(!(t.state.loading&4)){var n=jl.get(e);if(n)var r=n.get(null);else{n=new Map,jl.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<c.length;f++){var y=c[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),r=y)}r&&n.set(null,r)}c=t.instance,y=c.getAttribute("data-precedence"),f=n.get(y)||r,f===r&&n.set(null,c),n.set(y,c),this.count++,r=_l.bind(this),c.addEventListener("load",r),c.addEventListener("error",r),f?f.parentNode.insertBefore(c,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Wr={$$typeof:M,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function iv(e,t,n,r,c,f,y,S,k){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bi(0),this.hiddenUpdates=bi(null),this.identifierPrefix=r,this.onUncaughtError=c,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function ug(e,t,n,r,c,f,y,S,k,Y,se,fe){return e=new iv(e,t,n,y,k,Y,se,fe,S),t=1,f===!0&&(t|=24),f=an(3,null,null,t),e.current=f,f.stateNode=e,t=Ao(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:r,isDehydrated:n,cache:t},ko(f),e}function dg(e){return e?(e=Ai,e):Ai}function fg(e,t,n,r,c,f){c=dg(c),r.context===null?r.context=c:r.pendingContext=c,r=ha(t),r.payload={element:n},f=f===void 0?null:f,f!==null&&(r.callback=f),n=ga(e,r,t),n!==null&&(tn(n,e,t),Or(n,e,t))}function hg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Qc(e,t){hg(e,t),(e=e.alternate)&&hg(e,t)}function gg(e){if(e.tag===13||e.tag===31){var t=Ga(e,67108864);t!==null&&tn(t,e,67108864),Qc(e,67108864)}}function pg(e){if(e.tag===13||e.tag===31){var t=cn();t=In(t);var n=Ga(e,t);n!==null&&tn(n,e,t),Qc(e,t)}}var wl=!0;function rv(e,t,n,r){var c=E.T;E.T=null;var f=z.p;try{z.p=2,Xc(e,t,n,r)}finally{z.p=f,E.T=c}}function sv(e,t,n,r){var c=E.T;E.T=null;var f=z.p;try{z.p=8,Xc(e,t,n,r)}finally{z.p=f,E.T=c}}function Xc(e,t,n,r){if(wl){var c=Zc(r);if(c===null)Lc(e,t,r,El,n),yg(e,r);else if(ov(c,e,t,n,r))r.stopPropagation();else if(yg(e,r),t&4&&-1<lv.indexOf(e)){for(;c!==null;){var f=le(c);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=kn(f.pendingLanes);if(y!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var k=1<<31-Kt(y);S.entanglements[1]|=k,y&=~k}Mn(f),(We&6)===0&&(ll=Gt()+500,Kr(0))}}break;case 31:case 13:S=Ga(f,2),S!==null&&tn(S,f,2),cl(),Qc(f,2)}if(f=Zc(r),f===null&&Lc(e,t,r,El,n),f===c)break;c=f}c!==null&&r.stopPropagation()}else Lc(e,t,r,null,n)}}function Zc(e){return e=Wl(e),Wc(e)}var El=null;function Wc(e){if(El=null,e=H(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=h(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return El=e,null}function mg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hi()){case fs:return 2;case gi:return 8;case Ua:case ur:return 32;case hs:return 268435456;default:return 32}default:return 32}}var eu=!1,Ea=null,Ca=null,Ta=null,es=new Map,ts=new Map,Aa=[],lv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yg(e,t){switch(e){case"focusin":case"focusout":Ea=null;break;case"dragenter":case"dragleave":Ca=null;break;case"mouseover":case"mouseout":Ta=null;break;case"pointerover":case"pointerout":es.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ts.delete(t.pointerId)}}function ns(e,t,n,r,c,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:f,targetContainers:[c]},t!==null&&(t=le(t),t!==null&&gg(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function ov(e,t,n,r,c){switch(t){case"focusin":return Ea=ns(Ea,e,t,n,r,c),!0;case"dragenter":return Ca=ns(Ca,e,t,n,r,c),!0;case"mouseover":return Ta=ns(Ta,e,t,n,r,c),!0;case"pointerover":var f=c.pointerId;return es.set(f,ns(es.get(f)||null,e,t,n,r,c)),!0;case"gotpointercapture":return f=c.pointerId,ts.set(f,ns(ts.get(f)||null,e,t,n,r,c)),!0}return!1}function vg(e){var t=H(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){e.blockedOn=t,ys(e.priority,function(){pg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,ys(e.priority,function(){pg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Cl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zc(e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Zl=r,n.target.dispatchEvent(r),Zl=null}else return t=le(n),t!==null&&gg(t),e.blockedOn=n,!1;t.shift()}return!0}function bg(e,t,n){Cl(e)&&n.delete(t)}function cv(){eu=!1,Ea!==null&&Cl(Ea)&&(Ea=null),Ca!==null&&Cl(Ca)&&(Ca=null),Ta!==null&&Cl(Ta)&&(Ta=null),es.forEach(bg),ts.forEach(bg)}function Tl(e,t){e.blockedOn===t&&(e.blockedOn=null,eu||(eu=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,cv)))}var Al=null;function xg(e){Al!==e&&(Al=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){Al===e&&(Al=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],c=e[t+2];if(typeof r!="function"){if(Wc(r||n)===null)continue;break}var f=le(n);f!==null&&(e.splice(t,3),t-=3,Zo(f,{pending:!0,data:c,method:n.method,action:r},r,c))}}))}function Zi(e){function t(k){return Tl(k,e)}Ea!==null&&Tl(Ea,e),Ca!==null&&Tl(Ca,e),Ta!==null&&Tl(Ta,e),es.forEach(t),ts.forEach(t);for(var n=0;n<Aa.length;n++){var r=Aa[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Aa.length&&(n=Aa[0],n.blockedOn===null);)vg(n),n.blockedOn===null&&Aa.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(r=0;r<n.length;r+=3){var c=n[r],f=n[r+1],y=c[zt]||null;if(typeof f=="function")y||xg(n);else if(y){var S=null;if(f&&f.hasAttribute("formAction")){if(c=f,y=f[zt]||null)S=y.formAction;else if(Wc(c)!==null)continue}else S=y.action;typeof S=="function"?n[r+1]=S:(n.splice(r,3),r-=3),xg(n)}}}function _g(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function tu(e){this._internalRoot=e}Nl.prototype.render=tu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,r=cn();fg(n,r,e,t,null,null)},Nl.prototype.unmount=tu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fg(e.current,2,null,e,null,null),cl(),t[Jt]=null}};function Nl(e){this._internalRoot=e}Nl.prototype.unstable_scheduleHydration=function(e){if(e){var t=ms();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Aa.length&&t!==0&&t<Aa[n].priority;n++);Aa.splice(n,0,e),n===0&&vg(e)}};var jg=a.version;if(jg!=="19.2.0")throw Error(l(527,jg,"19.2.0"));z.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var uv={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:E,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rl.isDisabled&&Rl.supportsFiber)try{Da=Rl.inject(uv),Ft=Rl}catch{}}return is.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,r="",c=Nf,f=Rf,y=Of;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=ug(e,1,!1,null,null,n,r,null,c,f,y,_g),e[Jt]=t.current,Bc(e),new tu(t)},is.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var r=!1,c="",f=Nf,y=Rf,S=Of,k=null;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(S=n.onRecoverableError),n.formState!==void 0&&(k=n.formState)),t=ug(e,1,!0,t,n??null,r,c,k,f,y,S,_g),t.context=dg(null),n=t.current,r=cn(),r=In(r),c=ha(r),c.callback=null,ga(n,c,r),n=r,t.current.lanes=n,Ma(t,n),Mn(t),e[Jt]=t.current,Bc(e),new Nl(t)},is.version="19.2.0",is}var kg;function _v(){if(kg)return au.exports;kg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),au.exports=xv(),au.exports}var jv=_v(),j=Ru();const Ou=dp(j);var yu=function(o,a){return yu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},yu(o,a)};function hp(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");yu(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var Il=function(){return Il=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},Il.apply(this,arguments)};function or(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function gp(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(h=o[g])&&(d=(u<3?h(d):u>3?h(a,s,d):h(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function pp(o,a){return function(s,l){a(s,l,o)}}function mp(o,a,s,l,u,d){function h(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),x,_=!1,b=s.length-1;b>=0;b--){var w={};for(var R in l)w[R]=R==="access"?{}:l[R];for(var R in l.access)w.access[R]=l.access[R];w.addInitializer=function(T){if(_)throw new TypeError("Cannot add initializers after decoration has completed");d.push(h(T||null))};var A=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(A===void 0)continue;if(A===null||typeof A!="object")throw new TypeError("Object expected");(x=h(A.get))&&(v.get=x),(x=h(A.set))&&(v.set=x),(x=h(A.init))&&u.unshift(x)}else(x=h(A))&&(g==="field"?u.unshift(x):v[p]=x)}m&&Object.defineProperty(m,l.name,v),_=!0}function yp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function vp(o){return typeof o=="symbol"?o:"".concat(o)}function bp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function xp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function Ne(o,a,s,l){function u(d){return d instanceof s?d:new s(function(h){h(d)})}return new(s||(s=Promise))(function(d,h){function g(v){try{m(l.next(v))}catch(x){h(x)}}function p(v){try{m(l.throw(v))}catch(x){h(x)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function _p(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=g(0),h.throw=g(1),h.return=g(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;h&&(h=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Gl=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function jp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&Gl(a,o,s)}function Hl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function ku(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],h;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){h={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(h)throw h.error}}return d}function Sp(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(ku(arguments[a]));return o}function wp(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],h=0,g=d.length;h<g;h++,u++)l[u]=d[h];return l}function Ep(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function lr(o){return this instanceof lr?(this.v=o,this):new lr(o)}function Cp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",h),u[Symbol.asyncIterator]=function(){return this},u;function h(b){return function(w){return Promise.resolve(w).then(b,x)}}function g(b,w){l[b]&&(u[b]=function(R){return new Promise(function(A,T){d.push([b,R,A,T])>1||p(b,R)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(R){_(d[0][3],R)}}function m(b){b.value instanceof lr?Promise.resolve(b.value.v).then(v,x):_(d[0][2],b)}function v(b){p("next",b)}function x(b){p("throw",b)}function _(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function Tp(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(h){return(s=!s)?{value:lr(o[u](h)),done:!1}:d?d(h):h}:d}}function Ap(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Hl=="function"?Hl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(h){return new Promise(function(g,p){h=o[d](h),u(g,p,h.done,h.value)})}}function u(d,h,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},h)}}function Np(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var Sv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},vu=function(o){return vu=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},vu(o)};function Rp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=vu(o),l=0;l<s.length;l++)s[l]!=="default"&&Gl(a,o,s[l]);return Sv(a,o),a}function Op(o){return o&&o.__esModule?o:{default:o}}function kp(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function zp(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Up(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function Dp(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var wv=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Bp(o){function a(d){o.error=o.hasError?new wv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(h){return a(h),u()})}else l|=1}catch(h){a(h)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function Lp(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,h){return l?a?".jsx":".js":u&&(!d||!h)?s:u+d+"."+h.toLowerCase()+"js"}):o}const Ev={__extends:hp,__assign:Il,__rest:or,__decorate:gp,__param:pp,__esDecorate:mp,__runInitializers:yp,__propKey:vp,__setFunctionName:bp,__metadata:xp,__awaiter:Ne,__generator:_p,__createBinding:Gl,__exportStar:jp,__values:Hl,__read:ku,__spread:Sp,__spreadArrays:wp,__spreadArray:Ep,__await:lr,__asyncGenerator:Cp,__asyncDelegator:Tp,__asyncValues:Ap,__makeTemplateObject:Np,__importStar:Rp,__importDefault:Op,__classPrivateFieldGet:kp,__classPrivateFieldSet:zp,__classPrivateFieldIn:Up,__addDisposableResource:Dp,__disposeResources:Bp,__rewriteRelativeImportExtension:Lp},Cv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Dp,get __assign(){return Il},__asyncDelegator:Tp,__asyncGenerator:Cp,__asyncValues:Ap,__await:lr,__awaiter:Ne,__classPrivateFieldGet:kp,__classPrivateFieldIn:Up,__classPrivateFieldSet:zp,__createBinding:Gl,__decorate:gp,__disposeResources:Bp,__esDecorate:mp,__exportStar:jp,__extends:hp,__generator:_p,__importDefault:Op,__importStar:Rp,__makeTemplateObject:Np,__metadata:xp,__param:pp,__propKey:vp,__read:ku,__rest:or,__rewriteRelativeImportExtension:Lp,__runInitializers:yp,__setFunctionName:bp,__spread:Sp,__spreadArray:Ep,__spreadArrays:wp,__values:Hl,default:Ev},Symbol.toStringTag,{value:"Module"})),Tv=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class zu extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Av extends zu{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class zg extends zu{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Ug extends zu{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var bu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(bu||(bu={}));class Nv{constructor(a,{headers:s={},customFetch:l,region:u=bu.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Tv(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return Ne(this,arguments,void 0,function*(s,l={}){var u;let d,h;try{const{headers:g,method:p,body:m,signal:v,timeout:x}=l;let _={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${s}`);b&&b!=="any"&&(_["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let R;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",R=m):typeof m=="string"?(_["Content-Type"]="text/plain",R=m):typeof FormData<"u"&&m instanceof FormData?R=m:(_["Content-Type"]="application/json",R=JSON.stringify(m)):R=m;let A=v;x&&(h=new AbortController,d=setTimeout(()=>h.abort(),x),v?(A=h.signal,v.addEventListener("abort",()=>h.abort())):A=h.signal);const T=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),g),body:R,signal:A}).catch(C=>{throw new Av(C)}),I=T.headers.get("x-relay-error");if(I&&I==="true")throw new zg(T);if(!T.ok)throw new Ug(T);let M=((u=T.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),G;return M==="application/json"?G=yield T.json():M==="application/octet-stream"||M==="application/pdf"?G=yield T.blob():M==="text/event-stream"?G=T:M==="multipart/form-data"?G=yield T.formData():G=yield T.text(),{data:G,error:null,response:T}}catch(g){return{data:null,error:g,response:g instanceof Ug||g instanceof zg?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Pt={};const cr=hv(Cv);var Ol={},kl={},zl={},Ul={},Dl={},Bl={},Dg;function Mp(){if(Dg)return Bl;Dg=1,Object.defineProperty(Bl,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Bl.default=o,Bl}var Bg;function qp(){if(Bg)return Dl;Bg=1,Object.defineProperty(Dl,"__esModule",{value:!0});const a=cr.__importDefault(Mp());class s{constructor(u){var d,h;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(h=u.isMaybeSingle)!==null&&h!==void 0?h:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,x,_;let b=null,w=null,R=null,A=p.status,T=p.statusText;if(p.ok){if(this.method!=="HEAD"){const C=await p.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=C:w=JSON.parse(C))}const M=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),G=(x=p.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");M&&G&&G.length>1&&(R=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,R=null,A=406,T="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const M=await p.text();try{b=JSON.parse(M),Array.isArray(b)&&p.status===404&&(w=[],b=null,A=200,T="OK")}catch{p.status===404&&M===""?(A=204,T="No Content"):b={message:M}}if(b&&this.isMaybeSingle&&(!((_=b?.details)===null||_===void 0)&&_.includes("0 rows"))&&(b=null,A=200,T="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:R,status:A,statusText:T}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,x;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(x=p?.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Dl.default=s,Dl}var Lg;function Ip(){if(Lg)return Ul;Lg=1,Object.defineProperty(Ul,"__esModule",{value:!0});const a=cr.__importDefault(qp());class s extends a.default{select(u){let d=!1;const h=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",h),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:h,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:h=d}={}){const g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:h,referencedTable:g=h}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:h=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const x=[u?"analyze":null,d?"verbose":null,h?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),_=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${_}"; options=${x};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return Ul.default=s,Ul}var Mg;function Uu(){if(Mg)return zl;Mg=1,Object.defineProperty(zl,"__esModule",{value:!0});const a=cr.__importDefault(Ip()),s=new RegExp("[,()]");class l extends a.default{eq(d,h){return this.url.searchParams.append(d,`eq.${h}`),this}neq(d,h){return this.url.searchParams.append(d,`neq.${h}`),this}gt(d,h){return this.url.searchParams.append(d,`gt.${h}`),this}gte(d,h){return this.url.searchParams.append(d,`gte.${h}`),this}lt(d,h){return this.url.searchParams.append(d,`lt.${h}`),this}lte(d,h){return this.url.searchParams.append(d,`lte.${h}`),this}like(d,h){return this.url.searchParams.append(d,`like.${h}`),this}likeAllOf(d,h){return this.url.searchParams.append(d,`like(all).{${h.join(",")}}`),this}likeAnyOf(d,h){return this.url.searchParams.append(d,`like(any).{${h.join(",")}}`),this}ilike(d,h){return this.url.searchParams.append(d,`ilike.${h}`),this}ilikeAllOf(d,h){return this.url.searchParams.append(d,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(d,h){return this.url.searchParams.append(d,`ilike(any).{${h.join(",")}}`),this}is(d,h){return this.url.searchParams.append(d,`is.${h}`),this}in(d,h){const g=Array.from(new Set(h)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cs.{${h.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(h)}`),this}containedBy(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cd.{${h.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(h)}`),this}rangeGt(d,h){return this.url.searchParams.append(d,`sr.${h}`),this}rangeGte(d,h){return this.url.searchParams.append(d,`nxl.${h}`),this}rangeLt(d,h){return this.url.searchParams.append(d,`sl.${h}`),this}rangeLte(d,h){return this.url.searchParams.append(d,`nxr.${h}`),this}rangeAdjacent(d,h){return this.url.searchParams.append(d,`adj.${h}`),this}overlaps(d,h){return typeof h=="string"?this.url.searchParams.append(d,`ov.${h}`):this.url.searchParams.append(d,`ov.{${h.join(",")}}`),this}textSearch(d,h,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${h}`),this}match(d){return Object.entries(d).forEach(([h,g])=>{this.url.searchParams.append(h,`eq.${g}`)}),this}not(d,h,g){return this.url.searchParams.append(d,`not.${h}.${g}`),this}or(d,{foreignTable:h,referencedTable:g=h}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,h,g){return this.url.searchParams.append(d,`${h}.${g}`),this}}return zl.default=l,zl}var qg;function Hp(){if(qg)return kl;qg=1,Object.defineProperty(kl,"__esModule",{value:!0});const a=cr.__importDefault(Uu());class s{constructor(u,{headers:d={},schema:h,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=h,this.fetch=g}select(u,d){const{head:h=!1,count:g}=d??{},p=h?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:h=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(m.length>0){const v=[...new Set(m)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:h=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${h?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const x=u.reduce((_,b)=>_.concat(Object.keys(b)),[]);if(x.length>0){const _=[...new Set(x)].map(b=>`"${b}"`);this.url.searchParams.set("columns",_.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var h;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}delete({count:u}={}){var d;const h="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return kl.default=s,kl}var Ig;function Rv(){if(Ig)return Ol;Ig=1,Object.defineProperty(Ol,"__esModule",{value:!0});const o=cr,a=o.__importDefault(Hp()),s=o.__importDefault(Uu());class l{constructor(d,{headers:h={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(h),this.schemaName=g,this.fetch=p}from(d){const h=new URL(`${this.url}/${d}`);return new a.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,h={},{head:g=!1,get:p=!1,count:m}={}){var v;let x;const _=new URL(`${this.url}/rpc/${d}`);let b;g||p?(x=g?"HEAD":"GET",Object.entries(h).filter(([R,A])=>A!==void 0).map(([R,A])=>[R,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([R,A])=>{_.searchParams.append(R,A)})):(x="POST",b=h);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new s.default({method:x,url:_,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return Ol.default=l,Ol}var Hg;function Ov(){if(Hg)return Pt;Hg=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.PostgrestError=Pt.PostgrestBuilder=Pt.PostgrestTransformBuilder=Pt.PostgrestFilterBuilder=Pt.PostgrestQueryBuilder=Pt.PostgrestClient=void 0;const o=cr,a=o.__importDefault(Rv());Pt.PostgrestClient=a.default;const s=o.__importDefault(Hp());Pt.PostgrestQueryBuilder=s.default;const l=o.__importDefault(Uu());Pt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Ip());Pt.PostgrestTransformBuilder=u.default;const d=o.__importDefault(qp());Pt.PostgrestBuilder=d.default;const h=o.__importDefault(Mp());return Pt.PostgrestError=h.default,Pt.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:h.default},Pt}var $p=Ov();const Vp=dp($p),kv=fv({__proto__:null,default:Vp},[$p]),{PostgrestClient:zv,PostgrestQueryBuilder:h_,PostgrestFilterBuilder:g_,PostgrestTransformBuilder:p_,PostgrestBuilder:m_,PostgrestError:y_}=Vp||kv;class Uv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const Dv="2.81.1",Bv=`realtime-js/${Dv}`,Pp="1.0.0",Lv="2.0.0",$g=Pp,xu=1e4,Mv=1e3,qv=100;var oi;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(oi||(oi={}));var kt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(kt||(kt={}));var _n;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(_n||(_n={}));var _u;(function(o){o.websocket="websocket"})(_u||(_u={}));var ci;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(ci||(ci={}));class Iv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:h}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(l,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(d,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(u,_=>m.setUint8(v++,_.charCodeAt(0)));var x=new Uint8Array(p.byteLength+h.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(h),p.byteLength),x.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(v),_=0;x.setUint8(_++,this.KINDS.userBroadcastPush),x.setUint8(_++,u.length),x.setUint8(_++,d.length),x.setUint8(_++,h.length),x.setUint8(_++,g.length),x.setUint8(_++,this.BINARY_ENCODING),Array.from(u,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(d,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(h,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(g,w=>x.setUint8(_++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,x=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,_=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(_),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,h.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,A=>b.setUint8(w++,A.charCodeAt(0))),Array.from(d,A=>b.setUint8(w++,A.charCodeAt(0))),Array.from(h,A=>b.setUint8(w++,A.charCodeAt(0))),Array.from(g,A=>b.setUint8(w++,A.charCodeAt(0)));var R=new Uint8Array(_.byteLength+v.byteLength);return R.set(new Uint8Array(_),0),R.set(new Uint8Array(v),_.byteLength),R.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,h,g,p]=l;return s({join_ref:u,ref:d,topic:h,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+h));g=g+h;const x=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:x}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:_,response:b};return{join_ref:m,ref:v,topic:x,event:_n.reply,payload:w}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let h=this.HEADER_LENGTH+2;const g=l.decode(a.slice(h,h+u));h=h+u;const p=l.decode(a.slice(h,h+d));h=h+d;const m=JSON.parse(l.decode(a.slice(h,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(_)):_,w={type:this.BROADCAST,event:v,payload:b};return h>0&&(w.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Gp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ut;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(ut||(ut={}));const Vg=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,h)=>(d[h]=Hv(h,o,a,u),d),{}):{}},Hv=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,h=s[o];return d&&!l.includes(d)?Fp(d,h):ju(h)},Fp=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return Gv(a,s)}switch(o){case ut.bool:return $v(a);case ut.float4:case ut.float8:case ut.int2:case ut.int4:case ut.int8:case ut.numeric:case ut.oid:return Vv(a);case ut.json:case ut.jsonb:return Pv(a);case ut.timestamp:return Fv(a);case ut.abstime:case ut.date:case ut.daterange:case ut.int4range:case ut.int8range:case ut.money:case ut.reltime:case ut.text:case ut.time:case ut.timestamptz:case ut.timetz:case ut.tsrange:case ut.tstzrange:return ju(a);default:return ju(a)}},ju=o=>o,$v=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Vv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Pv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},Gv=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const h=o.slice(1,s);try{d=JSON.parse("["+h+"]")}catch{d=h?h.split(","):[]}return d.map(g=>Fp(a,g))}return o},Fv=o=>typeof o=="string"?o.replace(" ","T"):o,Kp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class ou{constructor(a,s,l={},u=xu){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Pg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Pg||(Pg={}));class ss{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ss.syncState(this.state,u,d,h),this.pendingDiffs.forEach(p=>{this.state=ss.syncDiff(this.state,p,d,h)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=ss.syncDiff(this.state,u,d,h),g())}),this.onJoin((u,d,h)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:h})}),this.onLeave((u,d,h)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),h=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{h[m]||(p[m]=v)}),this.map(h,(m,v)=>{const x=d[m];if(x){const _=v.map(A=>A.presence_ref),b=x.map(A=>A.presence_ref),w=v.filter(A=>b.indexOf(A.presence_ref)<0),R=x.filter(A=>_.indexOf(A.presence_ref)<0);w.length>0&&(g[m]=w),R.length>0&&(p[m]=R)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:h}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const x=a[g].map(b=>b.presence_ref),_=v.filter(b=>x.indexOf(b.presence_ref)<0);a[g].unshift(..._)}l(g,v,p)}),this.map(h,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(x=>x.presence_ref);m=m.filter(x=>v.indexOf(x.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gg;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Gg||(Gg={}));var ls;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(ls||(ls={}));var ra;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(ra||(ra={}));class Du{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new ou(this,_n.join,this.params,this.timeout),this.rejoinTimer=new Gp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=kt.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_n.reply,{},(h,g)=>{this._trigger(this._replyEventName(g),h)}),this.presence=new ss(this),this.broadcastEndpointURL=Kp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==kt.closed){const{config:{broadcast:h,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[ls.PRESENCE]&&this.bindings[ls.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,x={},_={broadcast:h,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(ra.CHANNEL_ERROR,b)),this._onClose(()=>a?.(ra.CLOSED)),this.updateJoinPayload(Object.assign({config:_},x)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(ra.SUBSCRIBED);return}else{const R=this.bindings.postgres_changes,A=(w=R?.length)!==null&&w!==void 0?w:0,T=[];for(let I=0;I<A;I++){const M=R[I],{filter:{event:G,schema:C,table:L,filter:U}}=M,$=b&&b[I];if($&&$.event===G&&$.schema===C&&$.table===L&&$.filter===U)T.push(Object.assign(Object.assign({},M),{id:$.id}));else{this.unsubscribe(),this.state=kt.errored,a?.(ra.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,a&&a(ra.SUBSCRIBED);return}}).receive("error",b=>{this.state=kt.errored,a?.(ra.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(ra.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===kt.joined&&a===ls.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const h={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:h}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:h,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var h,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(h=this.params)===null||h===void 0?void 0:h.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=kt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_n.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new ou(this,_n.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=kt.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),h=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),h}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new ou(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>qv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const h=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=_n;if(l&&[g,p,m,v].indexOf(h)>=0&&l!==this._joinRef())return;let _=this._onMessage(h,s,l);if(s&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,R,A;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((A=(R=b.filter)===null||R===void 0?void 0:R.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===h}).map(b=>b.callback(_,l)):(d=this.bindings[h])===null||d===void 0||d.filter(b=>{var w,R,A,T,I,M;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in b){const G=b.id,C=(w=b.filter)===null||w===void 0?void 0:w.event;return G&&((R=s.ids)===null||R===void 0?void 0:R.includes(G))&&(C==="*"||C?.toLocaleLowerCase()===((A=s.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const G=(I=(T=b?.filter)===null||T===void 0?void 0:T.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return G==="*"||G===((M=s?.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===h}).map(b=>{if(typeof _=="object"&&"ids"in _){const w=_.data,{schema:R,table:A,commit_timestamp:T,type:I,errors:M}=w;_=Object.assign(Object.assign({},{schema:R,table:A,commit_timestamp:T,eventType:I,new:{},old:{},errors:M}),this._getPayloadRecords(w))}b.callback(_,l)})}_isClosed(){return this.state===kt.closed}_isJoined(){return this.state===kt.joined}_isJoining(){return this.state===kt.joining}_isLeaving(){return this.state===kt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Du.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(_n.close,{},a)}_onError(a){this._on(_n.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=kt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Vg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Vg(a.columns,a.old_record)),s}}const cu=()=>{},Ll={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Kv=[1e3,2e3,5e3,1e4],Yv=1e4,Jv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Qv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xu,this.transport=null,this.heartbeatIntervalMs=Ll.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cu,this.ref=0,this.reconnectTimer=null,this.vsn=$g,this.logger=cu,this.conn=null,this.sendBuffer=[],this.serializer=new Iv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${_u.websocket}`,this.httpEndpoint=Kp(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Uv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case oi.connecting:return ci.Connecting;case oi.open:return ci.Open;case oi.closing:return ci.Closing;default:return ci.Closed}}isConnected(){return this.connectionState()===ci.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Du(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,h=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Mv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Ll.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:h}=s,g=h?`(${h})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,h)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===oi.open||this.conn.readyState===oi.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(_n.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Jv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:Bv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(_n.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Gp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ll.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,h,g,p,m,v,x,_,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:xu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Ll.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(h=a?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:cu,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:$g,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Kv[w-1]||Yv),this.vsn){case Pp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,R)=>R(JSON.stringify(w))),this.decode=(x=a?.decode)!==null&&x!==void 0?x:((w,R)=>R(JSON.parse(w)));break;case Lv:this.encode=(_=a?.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class Bu extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function vt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Xv extends Bu{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Su extends Bu{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const Lu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Zv=()=>Response,wu=o=>{if(Array.isArray(o))return o.map(s=>wu(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=wu(l)}),a},Wv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},uu=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},eb=(o,a,s)=>Ne(void 0,void 0,void 0,function*(){const l=yield Zv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,h=u?.statusCode||d+"";a(new Xv(uu(u),d,h))}).catch(u=>{a(new Su(uu(u),u))}):a(new Su(uu(o),o))}),tb=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Wv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function ds(o,a,s,l,u,d){return Ne(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,tb(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>eb(p,g,l))})})}function os(o,a,s,l){return Ne(this,void 0,void 0,function*(){return ds(o,"GET",a,s,l)})}function Rn(o,a,s,l,u){return Ne(this,void 0,void 0,function*(){return ds(o,"POST",a,l,u,s)})}function Eu(o,a,s,l,u){return Ne(this,void 0,void 0,function*(){return ds(o,"PUT",a,l,u,s)})}function nb(o,a,s,l){return Ne(this,void 0,void 0,function*(){return ds(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function Mu(o,a,s,l,u){return Ne(this,void 0,void 0,function*(){return ds(o,"DELETE",a,l,u,s)})}class ab{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return Ne(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(vt(a))return{data:null,error:a};throw a}})}}var Yp;class ib{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Yp]="BlobDownloadBuilder",this.promise=null}asStream(){return new ab(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ne(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(vt(a))return{data:null,error:a};throw a}})}}Yp=Symbol.toStringTag;const rb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Fg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class sb{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=Lu(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return Ne(this,void 0,void 0,function*(){try{let d;const h=Object.assign(Object.assign({},Fg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",h.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!h.duplex&&(h.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),x=yield(a=="PUT"?Eu:Rn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:m,id:x.Id,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(vt(d))return{data:null,error:d};throw d}})}upload(a,s,l){return Ne(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return Ne(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),h=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${h}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:Fg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const x=yield Eu(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:x.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(vt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return Ne(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield Rn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),h=new URL(this.url+d.url),g=h.searchParams.get("token");if(!g)throw new Bu("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}update(a,s,l){return Ne(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return Ne(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}copy(a,s,l){return Ne(this,void 0,void 0,function*(){try{return{data:{path:(yield Rn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return Ne(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield Rn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const h=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${h}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return Ne(this,void 0,void 0,function*(){try{const u=yield Rn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),h=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>os(this.fetch,`${this.url}/${u}/${g}${h}`,{headers:this.headers,noResolveJson:!0});return new ib(p,this.shouldThrowOnError)}info(a){return Ne(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield os(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:wu(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}exists(a){return Ne(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield nb(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l)&&l instanceof Su){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield Mu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}list(a,s,l){return Ne(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},rb),s),{prefix:a||""});return{data:yield Rn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}listV2(a,s){return Ne(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield Rn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const Jp="2.81.1",Qp={"X-Client-Info":`storage-js/${Jp}`};class lb{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qp),s),this.fetch=Lu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return Ne(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield os(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}getBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield os(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}createBucket(a){return Ne(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield Rn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return Ne(this,void 0,void 0,function*(){try{return{data:yield Eu(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield Mu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class ob{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qp),s),this.fetch=Lu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}listBuckets(a){return Ne(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield os(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield Mu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(vt(s))return{data:null,error:s};throw s}})}}const qu={"X-Client-Info":`storage-js/${Jp}`,"Content-Type":"application/json"};class Xp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function un(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class du extends Xp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class cb extends Xp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Kg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Kg||(Kg={}));const Iu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ub=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Yg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),db=(o,a,s)=>Ne(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(h=>{const g=h?.statusCode||h?.code||u+"";a(new du(Yg(h),u,g))}).catch(()=>{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new du(g,u,h))});else{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new du(g,u,h))}}else a(new cb(Yg(o),o))}),fb=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(ub(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function hb(o,a,s,l,u,d){return Ne(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,fb(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>h(p)).catch(p=>db(p,g,l))})})}function dn(o,a,s,l,u){return Ne(this,void 0,void 0,function*(){return hb(o,"POST",a,l,u,s)})}class gb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},qu),s),this.fetch=Iu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return Ne(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}getIndex(a,s){return Ne(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(un(l))return{data:null,error:l};throw l}})}listIndexes(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return Ne(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(un(l))return{data:null,error:l};throw l}})}}class pb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},qu),s),this.fetch=Iu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return Ne(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield dn(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}getVectors(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}listVectors(a){return Ne(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield dn(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}queryVectors(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}deleteVectors(a){return Ne(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield dn(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}}class mb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},qu),s),this.fetch=Iu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}getBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}listBuckets(){return Ne(this,arguments,void 0,function*(a={}){try{return{data:yield dn(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ne(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}}class yb extends mb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new vb(this.url,this.headers,a,this.fetch)}}class vb extends gb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ne(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ne(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ne(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ne(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new bb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class bb extends pb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ne(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ne(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ne(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ne(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ne(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class xb extends lb{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new sb(this.url,this.headers,a,this.fetch)}get vectors(){return new yb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ob(this.url+"/iceberg",this.headers,this.fetch)}}const _b="2.81.1";let rs="";typeof Deno<"u"?rs="deno":typeof document<"u"?rs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?rs="react-native":rs="node";const jb={"X-Client-Info":`supabase-js-${rs}/${_b}`},Sb={headers:jb},wb={schema:"public"},Eb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Cb={},Tb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Ab=()=>Headers,Nb=(o,a,s)=>{const l=Tb(s),u=Ab();return async(d,h)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(h?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},h),{headers:m}))}};function Rb(o){return o.endsWith("/")?o:o+"/"}function Ob(o,a){var s,l;const{db:u,auth:d,realtime:h,global:g}=o,{db:p,auth:m,realtime:v,global:x}=a,_={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),h),storage:{},global:Object.assign(Object.assign(Object.assign({},x),g),{headers:Object.assign(Object.assign({},(s=x?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?_.accessToken=o.accessToken:delete _.accessToken,_}function kb(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Rb(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Zp="2.81.1",ir=30*1e3,Cu=3,fu=Cu*ir,zb="http://localhost:9999",Ub="supabase.auth.token",Db={"X-Client-Info":`gotrue-js/${Zp}`},Tu="X-Supabase-Api-Version",Wp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Bb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Lb=600*1e3;class cs extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function Re(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Mb extends cs{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function qb(o){return Re(o)&&o.name==="AuthApiError"}class ui extends cs{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class ka extends cs{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class An extends ka{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ib(o){return Re(o)&&o.name==="AuthSessionMissingError"}class Wi extends ka{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ml extends ka{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class ql extends ka{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Hb(o){return Re(o)&&o.name==="AuthImplicitGrantRedirectError"}class Jg extends ka{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Au extends ka{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function hu(o){return Re(o)&&o.name==="AuthRetryableFetchError"}class Qg extends ka{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class Nu extends ka{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const $l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xg=` 	
\r=`.split(""),$b=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Xg.length;a+=1)o[Xg[a].charCodeAt(0)]=-2;for(let a=0;a<$l.length;a+=1)o[$l[a].charCodeAt(0)]=a;return o})();function Zg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s($l[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s($l[l]),a.queuedBits-=6}}function em(o,a,s){const l=$b[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Wg(o){const a=[],s=h=>{a.push(String.fromCodePoint(h))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=h=>{Gb(h,l,s)};for(let h=0;h<o.length;h+=1)em(o.charCodeAt(h),u,d);return a.join("")}function Vb(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Pb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Vb(l,a)}}function Gb(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function sr(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)em(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Fb(o){const a=[];return Pb(o,s=>a.push(s)),new Uint8Array(a)}function di(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Zg(u,s,l)),Zg(null,s,l),a.join("")}function Kb(o){return Math.round(Date.now()/1e3)+o}function Yb(){return Symbol("auth-callback")}const It=()=>typeof window<"u"&&typeof document<"u",ii={tested:!1,writable:!1},tm=()=>{if(!It())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ii.tested)return ii.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ii.tested=!0,ii.writable=!0}catch{ii.tested=!0,ii.writable=!1}return ii.writable};function Jb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const nm=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Qb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",rr=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},ri=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Ra=async(o,a)=>{await o.removeItem(a)};class Fl{constructor(){this.promise=new Fl.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Fl.promiseConstructor=Promise;function gu(o){const a=o.split(".");if(a.length!==3)throw new Nu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!Bb.test(a[l]))throw new Nu("JWT not in base64url format");return{header:JSON.parse(Wg(a[0])),payload:JSON.parse(Wg(a[1])),signature:sr(a[2]),raw:{header:a[0],payload:a[1]}}}async function Xb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Zb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const h=await o(d);if(!a(d,null,h)){l(h);return}}catch(h){if(!a(d,h)){u(h);return}}})()})}function Wb(o){return("0"+o.toString(16)).substr(-2)}function e0(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Wb).join("")}async function t0(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function n0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await t0(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function er(o,a,s=!1){const l=e0();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await rr(o,`${a}-code-verifier`,u);const d=await n0(l);return[d,l===d?"plain":"s256"]}const a0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function i0(o){const a=o.headers.get(Tu);if(!a||!a.match(a0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function r0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function s0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const l0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tr(o){if(!l0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function pu(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function o0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function ep(o){return JSON.parse(JSON.stringify(o))}const li=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),c0=[502,503,504];async function tp(o){var a;if(!Qb(o))throw new Au(li(o),0);if(c0.includes(o.status))throw new Au(li(o),o.status);let s;try{s=await o.json()}catch(d){throw new ui(li(d),d)}let l;const u=i0(o);if(u&&u.getTime()>=Wp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Qg(li(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new An}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,h)=>d&&typeof h=="string",!0))throw new Qg(li(s),o.status,s.weak_password.reasons);throw new Mb(li(s),o.status||500,l)}const u0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Be(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[Tu]||(d[Tu]=Wp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const h=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(h.redirect_to=l.redirectTo);const g=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await d0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function d0(o,a,s,l,u,d){const h=u0(a,l,u,d);let g;try{g=await o(s,Object.assign({},h))}catch(p){throw console.error(p),new Au(li(p),0)}if(g.ok||await tp(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await tp(p)}}function Nn(o){var a;let s=null;g0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Kb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function np(o){const a=Nn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Oa(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function f0(o){return{data:o,error:null}}function h0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,h=or(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},h);return{data:{properties:g,user:p},error:null}}function ap(o){return o}function g0(o){return o.access_token&&o.refresh_token&&o.expires_in}const mu=["global","local","others"];class p0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=nm(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=mu[0]){if(mu.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${mu.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Re(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Oa})}catch(l){if(Re(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=or(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:h0,redirectTo:s?.redirectTo})}catch(s){if(Re(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Oa})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ap});if(v.error)throw v.error;const x=await v.json(),_=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const R=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(w.split(";")[1].split("=")[1]);m[`${A}Page`]=R}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(Re(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){tr(a);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Oa})}catch(s){if(Re(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){tr(a);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:Oa})}catch(l){if(Re(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){tr(a);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:Oa})}catch(l){if(Re(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){tr(a.userId);try{const{data:s,error:l}=await Be(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _deleteFactor(a){tr(a.userId),tr(a.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ap});if(v.error)throw v.error;const x=await v.json(),_=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const R=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(w.split(";")[1].split("=")[1]);m[`${A}Page`]=R}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(Re(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Re(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Re(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Re(s))return{data:null,error:s};throw s}}}function ip(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const nr={debug:!!(globalThis&&tm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class am extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class m0 extends am{}async function y0(o,a,s){nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),nr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw nr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new m0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(nr.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function v0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function im(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function b0(o){return parseInt(o,16)}function x0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function _0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:h,notBefore:g,requestId:p,resources:m,scheme:v,uri:x,version:_}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=im(o.address),w=v?`${v}://${l}`:l,R=o.statement?`${o.statement}
`:"",A=`${w} wants you to sign in with your Ethereum account:
${b}

${R}`;let T=`URI: ${x}
Version: ${_}
Chain ID: ${s}${h?`
Nonce: ${h}`:""}
Issued At: ${d.toISOString()}`;if(u&&(T+=`
Expiration Time: ${u.toISOString()}`),g&&(T+=`
Not Before: ${g.toISOString()}`),p&&(T+=`
Request ID: ${p}`),m){let I=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);I+=`
- ${M}`}T+=I}return`${A}
${T}`}class Nt extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Vl extends Nt{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function j0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Nt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Nt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Nt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new Nt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Nt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Nt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Nt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Nt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const h=window.location.hostname;if(rm(h)){if(d.rp.id!==h)return new Nt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Nt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function S0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Nt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Nt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(rm(l)){if(s.rpId!==l)return new Nt({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Nt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Nt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Nt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class w0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const E0=new w0;function C0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=or(o,["challenge","user","excludeCredentials"]),d=sr(a).buffer,h=Object.assign(Object.assign({},s),{id:sr(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:h});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:sr(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function T0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=or(o,["challenge","allowCredentials"]),u=sr(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const g=s[h];d.allowCredentials[h]=Object.assign(Object.assign({},g),{id:sr(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function A0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:di(new Uint8Array(o.response.attestationObject)),clientDataJSON:di(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function N0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:di(new Uint8Array(u.authenticatorData)),clientDataJSON:di(new Uint8Array(u.clientDataJSON)),signature:di(new Uint8Array(u.signature)),userHandle:u.userHandle?di(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function rm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function rp(){var o,a;return!!(It()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function R0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Vl("Browser returned unexpected credential type",a)}:{data:null,error:new Vl("Empty credential response",a)}}catch(a){return{data:null,error:j0({error:a,options:o})}}}async function O0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Vl("Browser returned unexpected credential type",a)}:{data:null,error:new Vl("Empty credential response",a)}}catch(a){return{data:null,error:S0({error:a,options:o})}}}const k0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},z0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Pl(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const h=u[d];if(h!==void 0)if(Array.isArray(h))l[d]=h;else if(s(h))l[d]=h;else if(a(h)){const g=l[d];a(g)?l[d]=Pl(g,h):l[d]=Pl(h)}else l[d]=h}return l}function U0(o,a){return Pl(k0,o,a||{})}function D0(o,a){return Pl(z0,o,a||{})}class B0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:h,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!h)return{data:null,error:g};const p=u??E0.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=U0(h.webauthn.credential_options.publicKey,d?.create),{data:v,error:x}=await R0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}case"request":{const m=D0(h.webauthn.credential_options.publicKey,d?.request),{data:v,error:x}=await O0(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}}}catch(h){return Re(h)?{data:null,error:h}:{data:null,error:new ui("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new cs("rpId is required for WebAuthn authentication")};try{if(!rp())return{data:null,error:new ui("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!h)return{data:null,error:g};const{webauthn:p}=h;return this._verify({factorId:a,challengeId:h.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(h){return Re(h)?{data:null,error:h}:{data:null,error:new ui("Unexpected error in authenticate",h)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new cs("rpId is required for WebAuthn registration")};try{if(!rp())return{data:null,error:new ui("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this._enroll({friendlyName:a});if(!h)return await this.client.mfa.listFactors().then(v=>{var x;return(x=v.data)===null||x===void 0?void 0:x.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===a&&_.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:h.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(h){return Re(h)?{data:null,error:h}:{data:null,error:new ui("Unexpected error in register",h)}}}}v0();const L0={url:zb,storageKey:Ub,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Db,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function sp(o,a,s){return await s()}const ar={};class us{get jwks(){var a,s;return(s=(a=ar[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){ar[this.storageKey]=Object.assign(Object.assign({},ar[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=ar[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){ar[this.storageKey]=Object.assign(Object.assign({},ar[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},L0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=us.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,us.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&It()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new p0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=nm(d.fetch),this.lock=d.lock||sp,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:It()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=y0:this.lock=sp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new B0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:tm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ip(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=ip(this.memoryStorage)),It()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Zp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(It()&&(s=Jb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),It()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Hb(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:h,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",h,"redirect type",g),await this._saveSession(h),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return Re(s)?this._returnResult({error:s}):this._returnResult({error:new ui("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:Nn}),{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Re(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:x,options:_}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await er(this.storage,this.storageKey)),d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_?.emailRedirectTo,body:{email:v,password:x,data:(s=_?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:_?.captchaToken},code_challenge:b,code_challenge_method:w},xform:Nn})}else if("phone"in a){const{phone:v,password:x,options:_}=a;d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(l=_?.data)!==null&&l!==void 0?l:{},channel:(u=_?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:_?.captchaToken}},xform:Nn})}else throw new Ml("You must provide either an email or phone number and a password");const{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Re(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:h,options:g}=a;s=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:np})}else if("phone"in a){const{phone:d,password:h,options:g}=a;s=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:np})}else throw new Ml("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Wi;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(Re(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,h,g,p,m,v,x,_;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:R,wallet:A,statement:T,options:I}=a;let M;if(It())if(typeof A=="object")M=A;else{const be=window;if("ethereum"in be&&typeof be.ethereum=="object"&&"request"in be.ethereum&&typeof be.ethereum.request=="function")M=be.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=A}const G=new URL((s=I?.url)!==null&&s!==void 0?s:window.location.href),C=await M.request({method:"eth_requestAccounts"}).then(be=>be).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!C||C.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=im(C[0]);let U=(l=I?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!U){const be=await M.request({method:"eth_chainId"});U=b0(be)}const $={domain:G.host,address:L,statement:T,uri:G.href,version:"1",chainId:U,nonce:(u=I?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(h=(d=I?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(g=I?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=I?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=I?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=I?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=_0($),w=await M.request({method:"personal_sign",params:[x0(b),L]})}try{const{data:R,error:A}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(_=a.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Nn});if(A)throw A;if(!R||!R.session||!R.user){const T=new Wi;return this._returnResult({data:{user:null,session:null},error:T})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:A})}catch(R){if(Re(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async signInWithSolana(a){var s,l,u,d,h,g,p,m,v,x,_,b;let w,R;if("message"in a)w=a.message,R=a.signature;else{const{chain:A,wallet:T,statement:I,options:M}=a;let G;if(It())if(typeof T=="object")G=T;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))G=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=T}const C=new URL((s=M?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in G&&G.signIn){const L=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M?.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),I?{statement:I}:null));let U;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")U=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)U=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in U&&"signature"in U&&(typeof U.signedMessage=="string"||U.signedMessage instanceof Uint8Array)&&U.signature instanceof Uint8Array)w=typeof U.signedMessage=="string"?U.signedMessage:new TextDecoder().decode(U.signedMessage),R=U.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${C.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(u=(l=M?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=M?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((h=M?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((g=M?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((p=M?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((x=(v=M?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",...M.signInWithSolana.resources.map(U=>`- ${U}`)]:[]].join(`
`);const L=await G.signMessage(new TextEncoder().encode(w),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");R=L}}try{const{data:A,error:T}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:di(R)},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Nn});if(T)throw T;if(!A||!A.session||!A.user){const I=new Wi;return this._returnResult({data:{user:null,session:null},error:I})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:T})}catch(A){if(Re(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async _exchangeCodeForSession(a){const s=await ri(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:h}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:Nn});if(await Ra(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!d||!d.session||!d.user){const g=new Wi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:h})}catch(d){if(Re(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:h}=a,g=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:h,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Nn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new Wi;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(Re(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,h;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await er(this.storage,this.storageKey));const{error:x}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(h=p?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new Ml("You must provide either an email or phone number.")}catch(g){if(Re(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:h,error:g}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:Nn});if(g)throw g;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,m=h.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(Re(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,h;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await er(this.storage,this.storageKey));const m=await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:f0});return!((d=m.data)===null||d===void 0)&&d.url&&It()&&!(!((h=a.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(Re(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new An;const{error:u}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(Re(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:h}=await Be(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:h,error:g}=await Be(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:g})}throw new Ml("You must provide either an email or phone number and a type")}catch(s){if(Re(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await ri(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<fu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const h=await ri(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=pu()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};a.user=o0(a.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Oa}):await this._useSession(async s=>{var l,u,d;const{data:h,error:g}=s;if(g)throw g;return!(!((l=h.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new An}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Oa})})}catch(s){if(Re(s))return Ib(s)&&(await this._removeSession(),await Ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new An;const h=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await er(this.storage,this.storageKey));const{data:m,error:v}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:h.access_token,xform:Oa});if(v)throw v;return h.user=m.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(l){if(Re(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new An;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:h}=gu(a.access_token);if(h.exp&&(l=h.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(Re(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:h,error:g}=s;if(g)throw g;a=(l=h.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new An;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(Re(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!It())throw new ql("No browser detected.");if(a.error||a.error_description||a.error_code)throw new ql(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Jg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ql("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Jg("No code detected.");const{data:I,error:M}=await this._exchangeCodeForSession(a.code);if(M)throw M;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:h,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!h||!m)throw new ql("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(g);let _=v+x;p&&(_=parseInt(p));const b=_-v;b*1e3<=ir&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const w=_-x;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,_,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,_,v);const{data:R,error:A}=await this._getUser(d);if(A)throw A;const T={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:x,expires_at:_,refresh_token:h,token_type:m,user:R.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:a.type},error:null})}catch(l){if(Re(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await ri(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const h=(l=u.session)===null||l===void 0?void 0:l.access_token;if(h){const{error:g}=await this.admin.signOut(h,a);if(g&&!(qb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await Ra(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Yb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:h}=s;if(h)throw h;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await er(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(Re(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var h,g,p,m,v;const{data:x,error:_}=d;if(_)throw _;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=x.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return It()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(Re(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:h,provider:g,token:p,access_token:m,nonce:v}=a,x=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Nn}),{data:_,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new Wi}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:b}))}catch(u){if(Re(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)throw h;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Zb(async u=>(u>0&&await Xb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Nn})),(u,d)=>{const h=200*Math.pow(2,u);return d&&hu(d)&&Date.now()+h-l<ir})}catch(l){if(this._debug(s,"error",l),Re(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),It()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await ri(this.storage,this.storageKey);if(u&&this.userStorage){let h=await ri(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:u.user},await rr(this.userStorage,this.storageKey+"-user",h)),u.user=(a=h?.user)!==null&&a!==void 0?a:pu()}else if(u&&!u.user&&!u.user){const h=await ri(this.storage,this.storageKey+"-user");h&&h?.user?(u.user=h.user,await Ra(this.storage,this.storageKey+"-user"),await rr(this.storage,this.storageKey,u)):u.user=pu()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<fu;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${fu}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:h}=await this._callRefreshToken(u.refresh_token);h&&(console.error(h),hu(h)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:g}=await this._getUser(u.access_token);!g&&h?.user?(u.user=h.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(l,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new An;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Fl;const{data:d,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!d.session)throw new An;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),Re(d)){const h={data:null,error:d};return hu(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(h),h}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],h=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(h),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await rr(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=ep(u);await rr(this.storage,this.storageKey,d)}else{const u=ep(s);await rr(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await Ra(this.storage,this.storageKey),await Ra(this.storage,this.storageKey+"-code-verifier"),await Ra(this.storage,this.storageKey+"-user"),this.userStorage&&await Ra(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&It()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),ir);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/ir);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${ir}ms, refresh threshold is ${Cu} ticks`),u<=Cu&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof am)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!It()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,h]=await er(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(h)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Be(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)return this._returnResult({data:null,error:h});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?A0(a.webauthn.credential_response):N0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Be(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=await Be(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(h.error)return h;const{data:g}=h;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:C0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:T0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=gu(l.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Be(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new An})})}catch(s){if(Re(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new An});const h=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&It()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(Re(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new An});const h=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&It()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(Re(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Lb>u)return l;const{data:d,error:h}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:h,raw:{header:g,payload:p}}=gu(l);s?.allowExpired||r0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:h},error:null}}const v=s0(u.alg),x=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,h,Fb(`${g}.${p}`)))throw new Nu("Invalid JWT signature");return{data:{claims:d,header:u,signature:h},error:null}}catch(l){if(Re(l))return this._returnResult({data:null,error:l});throw l}}}us.nextInstanceID={};const M0=us;class q0 extends M0{constructor(a){super(a)}}class I0{constructor(a,s,l){var u,d,h;this.supabaseUrl=a,this.supabaseKey=s;const g=kb(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:wb,realtime:Cb,auth:Object.assign(Object.assign({},Eb),{storageKey:p}),global:Sb},v=Ob(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(x,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,v.global.fetch),this.fetch=Nb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new zv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new xb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Nv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:h,flowType:g,lock:p,debug:m,throwOnError:v},x,_){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new q0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),x),storageKey:h,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Qv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const H0=(o,a,s)=>new I0(o,a,s);function $0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}$0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const V0="https://sqwqlvsjtimallidxrsz.supabase.co",P0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",ie=H0(V0,P0,{auth:{persistSession:!1}}),jn=Object.freeze(Object.defineProperty({__proto__:null,default:ie,supabase:ie},Symbol.toStringTag,{value:"Module"}));async function Kl(){try{const{data:o,error:a}=await ie.from("empresa").select("*").limit(1).maybeSingle();if(a)throw a;const s=o||null;if(!s)return null;try{const l=s.logo;if(!l)s.logoUrl=null;else if(String(l).startsWith("http"))s.logoUrl=String(l);else{const u="logo";try{const h=(await ie.storage.from(u).getPublicUrl(String(l)))?.data?.publicUrl??null;if(h)s.logoUrl=h;else{const g=await ie.storage.from(u).createSignedUrl(String(l),3600);s.logoUrl=g?.data?.signedUrl??null}}catch{const h="https://sqwqlvsjtimallidxrsz.supabase.co";let g=String(l);g.startsWith(`${u}/`)&&(g=g.slice(u.length+1)),s.logoUrl=`${h}/storage/v1/object/public/${u}/${encodeURIComponent(g)}`}}}catch{s.logoUrl=null}return s}catch(o){return console.warn("getCompanyData error",o),null}}function G0({onLogin:o}){const[a,s]=j.useState(""),[l,u]=j.useState(""),[d,h]=j.useState(null);async function g(p){p.preventDefault(),h(null);try{const{data:m,error:v}=await ie.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){h("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){h("Credenciales invlidas");return}const x=m;if(x.password===l){const _={id:x.id,username:x.username,role:x.role};localStorage.setItem("user",JSON.stringify(_));try{console.debug("Login: stored localStorage.user =",_)}catch{}try{if(x.role==="cajero"){const{data:b,error:w}=await ie.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",x.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}h("Inicio de sesin correcto"),typeof o=="function"&&o()}else h("Credenciales invlidas")}catch(m){h(m.message||"Error al consultar la base de datos")}}return i.jsx("div",{className:"login-root",children:i.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[i.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),i.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),i.jsxs("div",{className:"login-inner",children:[i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"username",children:"Usuario"}),i.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"password",children:"Contrasea"}),i.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),i.jsx("div",{children:i.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&i.jsx("p",{style:{marginTop:12},children:d}),i.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",i.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function F0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),i.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function K0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!0),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,_]=j.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=j.useState(()=>{try{const T=localStorage.getItem("user");if(T)return JSON.parse(T).username||"usuario"}catch{}return"usuario"});j.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(T=>T.json()).then(T=>{const I=T&&Array.isArray(T.ingresos)?T.ingresos:[],M=localStorage.getItem("ingresosEfectivo");let G=[];try{M&&(G=JSON.parse(M))}catch{}const C=[...I,...G];s(C)}).catch(()=>{const T=localStorage.getItem("ingresosEfectivo");try{T&&s(JSON.parse(T))}catch{s([])}}).finally(()=>u(!1))},[]);function R(T){localStorage.setItem("ingresosEfectivo",JSON.stringify(T))}function A(T){if(T.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const I=a.length?Math.max(...a.map(C=>C.id))+1:1,M={id:I,factura:d||`F-${I}`,motivo:g,monto:Number(m),fechaHora:new Date(x).toISOString(),usuario:b},G=[...a,M];s(G),R(G),h(""),p(""),v(""),_(new Date().toISOString().slice(0,16))}return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?i.jsx("p",{children:"Cargando..."}):i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),i.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),i.jsx("tbody",{children:a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(T=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:{padding:8},children:T.factura}),i.jsx("td",{style:{padding:8},children:T.motivo}),i.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",T.monto.toFixed(2)]}),i.jsx("td",{style:{padding:8},children:new Date(T.fechaHora).toLocaleString()}),i.jsx("td",{style:{padding:8},children:T.usuario})]},T.id))})]})})]}),i.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),i.jsxs("form",{onSubmit:A,style:{display:"grid",gap:8},children:[i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",i.jsx("input",{value:d,onChange:T=>h(T.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",i.jsx("input",{value:g,onChange:T=>p(T.target.value),className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",i.jsx("input",{value:m,onChange:T=>v(T.target.value===""?"":Number(T.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",i.jsx("input",{value:x,onChange:T=>_(T.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",i.jsx("input",{value:b,onChange:T=>w(T.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[i.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),i.jsx("button",{type:"button",onClick:()=>{h(""),p(""),v(""),_(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function Y0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!1),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(!1),[x,_]=j.useState(!1),[b,w]=j.useState(null),R=async()=>{u(!0);try{const{data:J,error:ue}=await ie.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(ue)throw ue;const _e=Array.isArray(J)?J:[],q=Array.from(new Set(_e.map(E=>E.cliente_id).filter(Boolean)));let W={};if(q.length>0)try{const{data:E}=await ie.from("clientes").select("id,nombre").in("id",q);if(Array.isArray(E))for(const z of E)W[String(z.id)]=z.nombre||""}catch(E){console.warn("Error cargando nombres de clientes:",E)}const Z=_e.map(E=>({...E,cliente_nombre:W[String(E.cliente_id)]||null}));s(Z)}catch(J){console.warn("Error cargando cotizaciones:",J),s([])}u(!1)};j.useEffect(()=>{R()},[]);const[A,T]=j.useState(null),[I,M]=j.useState(null),[G,C]=j.useState(""),L=async J=>{h(J);try{const{data:ue,error:_e}=await ie.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",J).maybeSingle();if(_e&&console.warn("Error cargando cabecera de cotizacion",_e),T(ue||null),ue&&ue.cliente_id)try{const{data:Z}=await ie.from("clientes").select("id,nombre").eq("id",ue.cliente_id).maybeSingle();M(Z?.nombre||null)}catch{M(null)}else M(null);const{data:q,error:W}=await ie.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J);if(W)throw W;p(Array.isArray(q)?q:[]),v(!0)}catch(ue){console.warn("Error cargando detalles de cotizacion",ue),p([])}},U=async J=>{try{const{data:ue,error:_e}=await ie.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J.id),q=Array.isArray(ue)?ue:[],W={header:J,detalles:q};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(W))}catch(Z){console.warn("No se pudo escribir localStorage",Z)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:W}))}catch{}o()}catch(ue){console.warn("Error cargando detalles para editar",ue)}},$=async J=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:ue}=await ie.from("cotizaciones_detalle").delete().eq("cotizacion_id",J);ue&&console.warn("Error eliminando detalles:",ue);const{error:_e}=await ie.from("cotizaciones").delete().eq("id",J);if(_e)throw _e;R()}catch(ue){console.warn("Error eliminando cotizacion:",ue)}},be=async()=>{if(b)try{const J={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:ue}=await ie.from("cotizaciones").update(J).eq("id",b.id);if(ue&&console.warn("Error actualizando cotizacion:",ue),b.id){const{error:_e}=await ie.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);_e&&console.warn("Error borrando detalles antiguos:",_e);const q=g.map(Z=>({...Z,cotizacion_id:b.id})),{error:W}=await ie.from("cotizaciones_detalle").insert(q);W&&console.warn("Error insertando detalles actualizados:",W)}_(!1),R()}catch(J){console.warn("Error guardando cotizacion editada:",J)}};return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),i.jsxs("div",{children:[i.jsx("button",{onClick:R,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),i.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),i.jsx("input",{placeholder:"Nmero o cliente",value:G,onChange:J=>C(J.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),i.jsx("button",{onClick:()=>C(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?i.jsx("div",{children:"Cargando..."}):a.length===0?i.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Nmero"}),i.jsx("th",{style:{padding:8},children:"Fecha"}),i.jsx("th",{style:{padding:8},children:"Usuario"}),i.jsx("th",{style:{padding:8},children:"Cliente ID"}),i.jsx("th",{style:{padding:8},children:"Total"}),i.jsx("th",{style:{padding:8},children:"Estado"}),i.jsx("th",{style:{padding:8},children:"Acciones"})]})}),i.jsx("tbody",{children:a.filter(J=>{if(!G)return!0;const ue=G.toLowerCase(),_e=(J.numero_cotizacion||"").toLowerCase(),q=(J.cliente_nombre||"")?.toLowerCase(),W=(J.usuario||"").toLowerCase();return _e.includes(ue)||q.includes(ue)||W.includes(ue)}).map(J=>i.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[i.jsx("td",{style:{padding:8},children:J.numero_cotizacion||""}),i.jsx("td",{style:{padding:8},children:J.fecha_cotizacion?new Date(J.fecha_cotizacion).toLocaleString():""}),i.jsx("td",{style:{padding:8},children:J.usuario||""}),i.jsx("td",{style:{padding:8},children:J.cliente_nombre||(J.cliente_id?String(J.cliente_id):"")}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||0).toFixed(2)]}),i.jsx("td",{style:{padding:8},children:J.estado||""}),i.jsxs("td",{style:{padding:8},children:[i.jsx("button",{onClick:()=>L(J.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(J.estado||"").toLowerCase()==="aceptada"?i.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):i.jsx("button",{onClick:()=>U(J),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),i.jsx("button",{onClick:()=>$(J.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},J.id))})]})]}),m&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),i.jsx("button",{onClick:()=>{v(!1),p([]),h(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[A&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[i.jsxs("div",{children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Nmero:"})," ",A.numero_cotizacion]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Fecha:"})," ",A.fecha_cotizacion?new Date(A.fecha_cotizacion).toLocaleString():""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Usuario:"})," ",A.usuario]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Cliente:"})," ",I??(A.cliente_id?String(A.cliente_id):"C/F")]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Subtotal:"})," L ",Number(A.subtotal||0).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Impuesto:"})," L ",Number(A.impuesto||0).toFixed(2)]}),i.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[i.jsx("strong",{children:"Total:"})," L ",Number(A.total||0).toFixed(2)]})]})]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Descripcin"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio U."}),i.jsx("th",{style:{padding:8},children:"Subtotal"}),i.jsx("th",{style:{padding:8},children:"Descuento"}),i.jsx("th",{style:{padding:8},children:"Total"})]})}),i.jsx("tbody",{children:g.map((J,ue)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:J.descripcion}),i.jsx("td",{style:{padding:8},children:J.cantidad}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.precio_unitario||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.subtotal||(J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.descuento||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||(J.subtotal||0)-(J.descuento||0)).toFixed(2)]})]},ue))})]})]})]})}),x&&b&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),i.jsx("button",{onClick:()=>{_(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{children:"Cliente"}),i.jsx("input",{value:b.cliente||"",onChange:J=>w({...b,cliente:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),i.jsxs("div",{children:[i.jsx("label",{children:"RTN"}),i.jsx("input",{value:b.rtn||"",onChange:J=>w({...b,rtn:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"SKU"}),i.jsx("th",{style:{padding:8},children:"Nombre"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio"}),i.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),i.jsx("tbody",{children:g.map((J,ue)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:J.sku}),i.jsx("td",{style:{padding:8},children:J.nombre}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:J.cantidad||0,onChange:_e=>{const q=Number(_e.target.value||0),W=[...g];W[ue]={...W[ue],cantidad:q},p(W)},style:{width:80,padding:6}})}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:J.precio_unitario||0,onChange:_e=>{const q=Number(_e.target.value||0),W=[...g];W[ue]={...W[ue],precio_unitario:q},p(W)},style:{width:120,padding:6}})}),i.jsxs("td",{style:{padding:8},children:["L ",Number((J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]})]},ue))})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:()=>{_(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:be,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function J0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),i.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function Q0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function X0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function Z0({open:o,onClose:a,onSelect:s}){const[l,u]=j.useState(""),[d,h]=j.useState(!1),[g,p]=j.useState([]);return j.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{h(!0);try{const{data:v,error:x}=await ie.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(x)throw x;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&h(!1)}})(),()=>{m=!1}},[o]),j.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{h(!0);try{const v=String(l||"").trim();let x;if(v===""?x=await ie.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):x=await ie.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),x.error)throw x.error;p(Array.isArray(x.data)?x.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{h(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:i.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),i.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),i.jsx("th",{style:{padding:8}})]})}),i.jsxs("tbody",{children:[g.map(m=>i.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[i.jsx("td",{style:{padding:8},children:m.rtn}),i.jsx("td",{style:{padding:8},children:m.nombre}),i.jsx("td",{style:{padding:8},children:m.telefono}),i.jsx("td",{style:{padding:8},children:m.correo_electronico}),i.jsx("td",{style:{padding:8},children:i.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function W0({open:o,onClose:a,totalDue:s,onConfirm:l,exchangeRate:u}){const[d,h]=j.useState([]),[g,p]=j.useState("efectivo"),[m,v]=j.useState(0),[x,_]=j.useState(""),[b,w]=j.useState(""),[R,A]=j.useState(""),[T,I]=j.useState(""),[M,G]=j.useState(""),[C,L]=j.useState(0);j.useEffect(()=>{o||(h([]),p("efectivo"),v(0),_(""),w(""),A(""),I(""),G(""))},[o]);const U=F=>{const pe=Number(F);return Number.isFinite(pe)?Number(pe.toFixed(2)):0},$=()=>{const F=U(m);if(F<=0)return;const pe={id:String(Date.now())+Math.random().toString(36).slice(2,7),tipo:g,monto:F,usd_monto:g==="dolares"?Number((C||0).toFixed(2)):void 0,banco:x||void 0,tarjeta:b||void 0,factura:R||void 0,autorizador:T||void 0,referencia:M||void 0};h(N=>[...N,pe]),v(0),_(""),w(""),A(""),I(""),G("")},be=F=>{h(pe=>pe.filter(N=>N.id!==F))},J=d.filter(F=>F.tipo==="efectivo").reduce((F,pe)=>F+pe.monto,0),ue=d.filter(F=>F.tipo==="tarjeta").reduce((F,pe)=>F+pe.monto,0),_e=d.filter(F=>F.tipo==="transferencia").reduce((F,pe)=>F+pe.monto,0),q=d.filter(F=>F.tipo==="dolares").reduce((F,pe)=>F+pe.monto,0),W=Number((J+ue+_e+q).toFixed(2)),Z=Number((s-W).toFixed(2)),E=W>=s&&W>0,z=F=>new Intl.NumberFormat("es-HN",{style:"currency",currency:"HNL"}).format(F).replace("HNL","L"),ee=()=>{const F=[];J>0&&F.push(`efectivo:(${J.toFixed(2)})`),ue>0&&F.push(`tarjeta:(${ue.toFixed(2)})`),_e>0&&F.push(`transferencia:(${_e.toFixed(2)})`);const pe=F.join(",");l({efectivo:J,tarjeta:ue,transferencia:_e,totalPaid:W,tipoPagoString:pe,pagos:d}),a()};return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:i.jsxs("div",{style:{width:1100,maxWidth:"99%",background:"white",borderRadius:10,padding:16,maxHeight:"94vh",overflow:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:10,display:"grid",gridTemplateColumns:"1fr 420px",gap:14,fontSize:13},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",i.jsx("strong",{children:z(s)})]}),i.jsx("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:6,marginBottom:12,fontSize:13},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #efefef"},children:[i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Monto"}),i.jsx("th",{children:"Detalles"}),i.jsx("th",{})]})}),i.jsxs("tbody",{children:[d.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,style:{padding:12,color:"#666"},children:"No hay pagos registrados"})}),d.map(F=>i.jsxs("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[i.jsx("td",{style:{padding:"6px 4px"},children:F.tipo}),i.jsx("td",{style:{padding:"6px 4px"},children:z(F.monto)}),i.jsxs("td",{style:{padding:"6px 4px",fontSize:12},children:[F.tipo==="efectivo"&&i.jsx("span",{children:""}),F.tipo==="tarjeta"&&i.jsxs("span",{children:[F.banco||"-"," / ",F.tarjeta||"-"," / ",F.factura||"-"]}),F.tipo==="transferencia"&&i.jsxs("span",{children:[F.banco||"-"," / ",F.referencia||"-"]})]}),i.jsx("td",{style:{padding:"8px 4px"},children:i.jsx("button",{onClick:()=>be(F.id),className:"btn-opaque",style:{background:"transparent"},children:"Eliminar"})})]},F.id))]})]})}),i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:8,fontSize:13},children:[i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Efectivo"}),i.jsx("div",{style:{fontWeight:600},children:z(J)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Tarjeta"}),i.jsx("div",{style:{fontWeight:600},children:z(ue)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Transferencia"}),i.jsx("div",{style:{fontWeight:600},children:z(_e)})]}),i.jsxs("div",{style:{marginLeft:"auto",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Total ingresado"}),i.jsx("div",{style:{fontWeight:700},children:z(W)}),i.jsx("div",{style:{marginTop:6,color:Z>0?"#ef4444":"#16a34a"},children:Z>0?`Falta ${z(Z)}`:`Cambio ${z(Math.abs(Z))}`})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:10,fontSize:13},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de pago"}),i.jsxs("select",{value:g,onChange:F=>{p(F.target.value),v(0),L(0),_(""),w(""),A(""),I(""),G("")},style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"efectivo",children:"Efectivo"}),i.jsx("option",{value:"tarjeta",children:"Tarjeta"}),i.jsx("option",{value:"transferencia",children:"Transferencia"}),i.jsx("option",{value:"dolares",children:"Dlares"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Monto"}),g==="dolares"?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"$"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:C,onChange:F=>{const pe=U(F.target.value);L(pe);const N=Number((pe*u).toFixed(2));v(N)},style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"L (convertido)"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:m,readOnly:!0,style:{width:"100%",padding:6,borderRadius:6,fontSize:13,background:"#f9fafb"}})]})]}):i.jsx("input",{type:"number",min:0,step:"0.01",value:m,onChange:F=>v(U(F.target.value)),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),g==="dolares"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de cambio (Lps por $)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("div",{style:{fontSize:14,fontWeight:600},children:[u.toFixed(2)," L"]}),i.jsx("div",{style:{fontSize:13,color:"#666"},children:"(Editable en el encabezado de Punto de Ventas)"})]})]}),g==="efectivo"&&i.jsx("div",{style:{fontSize:13,color:"#444",marginBottom:8},children:'Pago en efectivo: solo indique el monto y presione "Agregar".'}),g==="tarjeta"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:F=>_(F.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras "}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente "}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas "}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda "}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores "}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tarjeta (ltimos 4)"}),i.jsx("input",{value:b,onChange:F=>w(F.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Factura"}),i.jsx("input",{value:R,onChange:F=>A(F.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Autorizador"}),i.jsx("input",{value:T,onChange:F=>I(F.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]})]}),g==="transferencia"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:F=>_(F.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras  (Banco de Amrica Central Honduras)"}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente  Banocc"}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas  (Banco del Pas)"}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda  Davi"}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores  BanTrab"}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Referencia"}),i.jsx("input",{value:M,onChange:F=>G(F.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:10},children:[i.jsx("button",{onClick:$,className:"btn-opaque",style:{background:"#0ea5a4",color:"white",padding:"6px 10px",borderRadius:6,fontSize:13},children:"Agregar"}),i.jsx("button",{onClick:()=>{v(s-W)},className:"btn-opaque",style:{background:"transparent",fontSize:13},children:"Exacto"})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",fontSize:13,padding:"6px 10px"},children:"Cancelar"}),i.jsx("button",{onClick:ee,className:"btn-opaque",disabled:!E,style:{background:E?"#16a34a":"gray",color:"white",fontSize:13,padding:"6px 12px"},children:"Registrar y guardar venta"})]})]})}):null}function ex({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:h}){return i.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:i.jsxs("tr",{children:[i.jsx("th",{style:u}),i.jsx("th",{style:u,children:"Imagen"}),i.jsx("th",{style:u,children:"SKU"}),i.jsx("th",{style:u,children:"Nombre"}),i.jsx("th",{style:u,children:"Categora"}),i.jsx("th",{style:u,children:"Precio"}),i.jsx("th",{style:u,children:"Stock"}),i.jsx("th",{style:u,children:"Accin"})]})}),i.jsx("tbody",{children:o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:d,children:i.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),i.jsx("td",{style:d,children:a[String(g.id)]?i.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?i.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),i.jsx("td",{style:d,children:i.jsx("code",{style:h,children:g.sku})}),i.jsx("td",{style:d,children:i.jsx("strong",{children:g.nombre})}),i.jsx("td",{style:d,children:i.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),i.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return i.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,x=v?p<1?"Agotado":"Sin precio":"Agregar";return i.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:x})})()})]},g.id))})]})})}function tx({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:h,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:x}){return i.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&i.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&i.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["L",u.toFixed(2)]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"space-between",color:"#16a34a",fontWeight:500},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsxs("div",{children:["ISV (",h*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.isv||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto 18%: ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.imp18||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto turstico (",p*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.tur||0),0)).toFixed(2)]})]})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[i.jsx("span",{children:"TOTAL:"}),i.jsxs("span",{children:["L",m.toFixed(2)]})]}),i.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:[i.jsxs("div",{children:["Tax rates: ISV ",(h*100).toFixed(2),"%, 18% ",(g*100).toFixed(2),"%, Tur ",(p*100).toFixed(2),"%"]}),i.jsxs("details",{style:{marginTop:6},children:[i.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),i.jsx("div",{style:{marginTop:8},children:d.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[i.jsxs("div",{style:{color:"#0f172a"},children:[_.nombre,"  L",_.price.toFixed(2)]}),i.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",_.isv.toFixed(2),"  18%: L",_.imp18.toFixed(2),"  Tur: L",_.tur.toFixed(2)]})]},String(_.id)))})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[i.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),i.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?i.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):i.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",_.producto.sku,"] ",_.producto.nombre]}),i.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(_.producto.precio||0).toFixed(2)," c/u"]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("button",{onClick:()=>a(_.producto.id,-1),style:x,children:""}),i.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:_.cantidad}),i.jsx("button",{onClick:()=>a(_.producto.id,1),style:x,children:"+"}),i.jsx("button",{onClick:()=>s(_.producto.id),style:{...x,background:"#ef4444"},children:""})]})]},_.producto.id))})]})}function nx({userName:o,userRole:a,userId:s,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:h,onPrintFormatChange:g,printFormat:p}){const[m,v]=j.useState(!1),x=j.useRef(null),[_,b]=j.useState(null),[w,R]=j.useState(null);return j.useEffect(()=>{function A(T){x.current&&!x.current.contains(T.target)&&v(!1)}return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]),j.useEffect(()=>{let A=!0;return(async()=>{try{const T=await Kl();if(!A||!T)return;const I=T.nombre||T.comercio||T.name||null,M=T.logoUrl||T.logo||null;I&&b(String(I)),M&&R(String(M))}catch{}})(),()=>{A=!1}},[]),i.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[w?i.jsx("img",{src:w,alt:"logo",style:{width:40,height:40,objectFit:"contain",borderRadius:6}}):null,i.jsx("div",{style:{margin:0,fontSize:"1.05rem",fontWeight:700},children:_||"Punto de Ventas"})]}),i.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[i.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),i.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""}),s!=null&&i.jsxs("div",{style:{fontSize:"0.75rem",color:"#cbd5e1",marginTop:2},children:["ID: ",String(s)]})]}),i.jsxs("div",{style:{position:"relative"},ref:x,children:[i.jsxs("div",{style:{position:"absolute",right:120,top:10,display:"flex",alignItems:"center",gap:8},children:[i.jsx("label",{style:{color:"#e2e8f0",fontSize:12},children:"Impresin"}),i.jsxs("div",{style:{display:"flex",background:"#0b1724",padding:4,borderRadius:20},children:[i.jsx("button",{onClick:()=>{g&&g("carta")},className:"btn-opaque",style:{padding:"6px 8px",background:p==="carta"?"#0ea5e9":"transparent",color:"#e2e8f0",borderRadius:12},children:"Carta"}),i.jsx("button",{onClick:()=>{g&&g("cinta")},className:"btn-opaque",style:{padding:"6px 8px",background:p==="cinta"?"#0ea5e9":"transparent",color:"#e2e8f0",borderRadius:12},children:"Cinta"})]})]}),i.jsx("button",{onClick:()=>v(A=>!A),"aria-expanded":m,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),m&&i.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[i.jsx("button",{onClick:()=>{v(!1),d()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),i.jsx("button",{onClick:()=>{v(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),i.jsx("button",{onClick:()=>{v(!1),h("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),i.jsx("button",{onClick:()=>{v(!1),h("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),i.jsx("button",{onClick:()=>{v(!1),h("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),i.jsx("button",{onClick:()=>{v(!1),h("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),i.jsx("button",{onClick:()=>{v(!1),h("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),i.jsx("button",{onClick:()=>{v(!1),h("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function ax({open:o,onClose:a,width:s=520,children:l,zIndex:u=9999}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:i.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:s,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})}):null}function ix({open:o,onClose:a,caiInfo:s,onRefresh:l}){const[u,d]=Ou.useState(!1);return i.jsx(ax,{open:o,onClose:a,width:520,children:i.jsxs("div",{children:[i.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),i.jsxs("div",{style:{color:"#475569",marginTop:8},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"CAI:"})," ",s?.cai??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Identificador:"})," ",s?.identificador??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango desde:"})," ",s?.rango_de??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango hasta:"})," ",s?.rango_hasta??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Fecha lmite emisin:"})," ",s?.fecha_vencimiento??s?.fecha_limite_emision??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Secuencia actual:"})," ",s?.secuencia_actual??"-"]})]}),i.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),i.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(h){console.debug("Error calling onRefresh from DatosFacturaModal:",h)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function rx({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),i.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?i.jsx("div",{children:i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?i.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):i.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),i.jsxs("div",{style:{flex:1},children:[i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"SKU:"})," ",a.sku]}),i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),i.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),i.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:i.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):i.jsx("div",{children:i.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function sx({open:o,onClose:a,onCancel:s,onSave:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),i.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function lx({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:h,taxRate:g,taxableSubtotal:p}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[i.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Consumidor final"})]}),i.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar datos del cliente"})]}),i.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Razn social / RTN"})]})]})]})})}):null}function ox({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:h,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:x,onTelefonoChange:_,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:R,onCancel:A,onOpenCreateCliente:T,onOpenPayment:I,paymentDone:M,submitClienteNormal:G}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{value:l,onChange:C=>v(C.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&i.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),i.jsx("input",{value:u,onChange:C=>x(C.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx(Z0,{open:p,onClose:()=>m(!1),onSelect:C=>{try{if(C&&typeof C=="object"){const L=C.rtn||"",U=C.nombre||"",$=C.telefono||"",be=C.correo_electronico||"",J=!!C.exonerado;try{v(String(L||""))}catch{}try{x(String(U||""))}catch{}try{_(String($||""))}catch{}try{b(String(be||""))}catch{}try{w(!!J)}catch{}}}catch{}m(!1)}}),i.jsx("button",{onClick:A,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:T,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),M?i.jsx("button",{onClick:G,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):i.jsx("button",{onClick:I,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function cx({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:h,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:x,onCreate:_}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",i.jsx("strong",{children:"juridico"}),"."]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),i.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),i.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),i.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),i.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{id:"exon",type:"checkbox",checked:h,onChange:b=>x(b.target.checked)}),i.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:async()=>{await _()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})}):null}async function lp(o={},a="factura",s={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const O=await Kl();O&&(l=l||O.nombre||O.comercio||l,u=u||O.rtn||u,d=d||O.direccion||O.direccion_fiscal||d,h=h||O.telefono||O.telefono_fijo||h,g=g||O.email||O.correo||g,p=p||O.logoUrl||O.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const O=await fetch(String(p),{mode:"cors"});if(O.ok){const ne=await O.blob(),ve=await new Promise(Se=>{const Ae=new FileReader;Ae.onloadend=()=>{Se(typeof Ae.result=="string"?Ae.result:null)},Ae.onerror=()=>{Se(null)},Ae.readAsDataURL(ne)});ve&&(p=ve)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let O=o.caiInfo||null;if(!O&&typeof window<"u"){const ne=window.localStorage.getItem("caiInfo");if(ne)try{O=JSON.parse(ne)}catch{O=null}}if(O&&(v=v||O.cai||O.CAI||"",x=x||O.fecha_vencimiento||O.fecha_limite_emision||"",_=_||O.rango_de||O.rangoDesde||"",b=b||O.rango_hasta||O.rangoHasta||"",w=w||O.identificador||"",!m))try{const ne=O.identificador?String(O.identificador):"",ve=O.secuencia_actual!=null?String(O.secuencia_actual):O.rango_de!=null?String(O.rango_de):"",Se=String(ve).replace(/[^0-9]/g,"")||"";let Ae=0;(O.rango_hasta||O.rango_de)&&(Ae=Math.max(String(O.rango_hasta||O.rango_de).length,Se.length));const De=Se?String(Se).padStart(Ae||Se.length||1,"0"):"";m=(ne||"")+(De||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const R=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),A=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||s.identidad||"C/F",T=new Date().toLocaleString(),I=Array.isArray(s.carrito)?s.carrito:[],M=typeof s.subtotal=="number"?s.subtotal:I.reduce((O,ne)=>O+Number(ne.producto&&ne.producto.precio||ne.precio||0)*(ne.cantidad||1),0),G=typeof s.descuento=="number"?s.descuento:0,C=typeof s.exonerado=="number"?s.exonerado:0,L=typeof s.gravado=="number"?s.gravado:M,U=typeof s.exento=="number"?s.exento:0,$=typeof s.isvTotal=="number"?s.isvTotal:0,be=typeof s.imp18Total=="number"?s.imp18Total:0,J=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,ue=typeof s.total=="number"?s.total:null,_e=M+($||0)+(be||0)+(J||0),q=ue??_e,W=q,Z=s.pagos||{},E=typeof Z.efectivo=="number"?Z.efectivo:typeof s.Efectivo=="number"?s.Efectivo:0,z=typeof Z.tarjeta=="number"?Z.tarjeta:typeof s.Tarjeta=="number"?s.Tarjeta:0,ee=typeof Z.transferencia=="number"?Z.transferencia:typeof s.Transferencia=="number"?s.Transferencia:0,F=typeof Z.totalPaid=="number"?Z.totalPaid:E+z+ee;let pe;if(typeof Z.cambio=="number")pe=Z.cambio;else if(typeof s.cambio=="number")pe=s.cambio;else{const O=Number(F)-Number(W||0);pe=isNaN(O)?0:O>0?O:0}const D=I.map(O=>{const ne=String(O.producto&&(O.producto.nombre||O.producto.descripcion)||O.descripcion||O.nombre||""),ve=Number(O.cantidad||0),Se=Number((O.producto&&(O.producto.precio??O.producto.precio_unitario))??O.precio_unitario??O.precio??0),Ae=!!(O.producto&&O.producto.exento)||!!O.exento,De=!!(O.producto&&O.producto.aplica_impuesto_18)||!!O.aplica_impuesto_18,Me=!!(O.producto&&O.producto.aplica_impuesto_turistico)||!!O.aplica_impuesto_turistico,Ye=De?s.tax18Rate??s.tax18??0:s.taxRate??s.tax??0,gt=Me?s.taxTouristRate??s.taxTourist??0:0,pt=(Number(Ye)||0)+(Number(gt)||0);let dt=Se;!Ae&&pt>0&&(dt=Se/(1+pt));const wt=Number(dt||0).toFixed(2),Ht=dt*ve,Ze=Number(Ht||0).toFixed(2);return`<tr><td>${O.producto&&O.producto.sku||O.sku||""} ${ne}</td><td style="text-align:center">${ve}</td><td style="text-align:right">L ${wt}</td><td style="text-align:right">L ${Ze}</td></tr>`}).join(`
`),P=(Number(E)||0)+(Number(ee)||0)+(Number(z)||0)-(Number(pe)||0),Q=isNaN(P)?0:P,me=ux(Q);return`
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Factura Detallada</title>
	<style>
		/* === 1. Estilos Base y Reset de Impresin === */
		@page {
			size: letter;
			margin: 0.5in; /* Reducido a 0.5in para mejor uso del espacio */
		}

		* {
			/* Mantener la configuracin de negrita y espaciado ajustado para factura */
			font-weight: bold !important;
			letter-spacing: 0 !important;
			word-spacing: 0 !important;
			margin: 0;
			padding: 0;
			line-height: 1.2 !important; /* Ligeramente aumentado para legibilidad */
			box-sizing: border-box;
		}

		body {
			font-family: 'Arial', sans-serif;
			font-size: 10px;
			color: #000;
			margin: 0;
			padding: 0;
		}

		/* === 2. Estructura Principal === */
		.factura-container {
			width: 100%;
			max-width: 8.5in;
			margin: 0 auto;
			padding: 0.25in; /* Espaciado interno general */
		}

		.divider {
			border: none;
			border-top: 1px solid #000;
			margin: 5px 0;
		}

		/* === 3. Encabezado de Factura === */
		.header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 10px;
		}

		.header img {
			width: 200px; /* Tamao ajustado para armona */
			height: auto;
			object-fit: contain;
			margin-right: 20px;
		}

		.header-title {
			font-size: 35px; /* Reducido ligeramente para balance */
			color: #0066CC;
			text-align: right;
			flex-grow: 1;
		}

		/* === 4. Secciones de Informacin === */
		.info-section h3, .info-section p {
			font-size: 11px;
			margin-bottom: 2px;
		}

		.info-dates {
			text-align: right;
			margin-bottom: 5px;
		}
		
		.info-dates p {
			font-size: 10px;
			margin: 1px 0;
		}

		/* === 5. Tabla de Productos === */
		.tabla {
			width: 100%;
			border-collapse: collapse;
			margin-top: 8px;
			font-size: 10px;
		}

		.tabla th, .tabla td {
			border: 1px solid #000;
			padding: 4px 6px; /* Aumentado para mejor legibilidad */
			text-align: left;
		}

		.tabla th {
			background-color: #555; /* Oscurecido a un gris ms formal */
			color: white;
			text-transform: uppercase;
		}

		.tabla td:nth-child(2), .tabla td:nth-child(3), .tabla td:nth-child(4) {
			text-align: right; /* Alineacin de nmeros */
		}

		/* === 6. Totales y Pagos === */
		.totals-section {
			margin-top: 5px;
			display: grid;
			grid-template-columns: 1fr 1fr; /* Para asegurar alineacin de etiquetas y valores */
			gap: 2px 0;
		}

		.totals-section p {
			display: contents; /* Permite que el span .right se alinee al final de la columna */
		}

		.totals-section span.label {
			text-align: left;
			padding-left: 2px;
		}

		.totals-section span.value {
			text-align: right;
			padding-right: 2px;
		}
		
		.total-final {
			font-size: 11px;
			margin-top: 5px;
			border-top: 1px solid #000;
			padding-top: 3px;
		}

		/* === 7. Pie de Factura === */
		.footer-info {
			text-align: center;
			margin-top: 10px;
			font-size: 10px;
		}
		
		.letras {
			font-size: 11px;
			margin: 5px 0;
			text-align: center;
		}

		.firma-section {
			margin-top: 15px;
			display: flex;
			justify-content: space-around;
			text-align: center;
		}

		.copias-info {
			text-align: center;
			margin-top: 8px;
		}

		.final-message {
			font-size: 10px;
			text-align: center;
			margin-top: 10px;
		}
		
		/* === 8. Media Print Overrides (Mejorado) === */
		@media print {
			.tabla th {
				/* Asegurar colores de encabezado de tabla en la impresin */
				background-color: #555 !important;
				color: white !important;
				-webkit-print-color-adjust: exact;
				print-color-adjust: exact;
			}
			.factura-container {
				box-shadow: none;
				border-radius: 0;
			}
			/* Se puede aadir ms ajustes si la impresin recorta elementos */
		}

			/* Forzar que navegadores impriman colores de fondo y estilos exactos */
			html, body, .factura-container, .header, .header-title, .header-title-container, .tabla, .tabla th, .totals-section, .total-final, .footer-info {
				-webkit-print-color-adjust: exact !important;
				print-color-adjust: exact !important;
				color-adjust: exact !important;
			}

			/* Reforzar en la regla de impresin para asegurar compatibilidad */
			@media print {
				.header-title { color: #0066CC !important; }
				.tabla th { background-color: #555 !important; color: #fff !important; }
				.totals-section, .total-final { background-color: transparent !important; }
			}
			.header-title-container {
    text-align: right;
}

.numero-factura {
    font-size: 24px;   /* Tamao grande */
    color: #000;       /* Negro */
    margin-top: -5px;  /* Ajuste opcional para acercarlo al ttulo */
}

	</style>
</head>
<body>
	<main class="factura-container">

		<header class="header">
    <img src="${p}" alt="Logo del Comercio" />
    <div class="header-title-container">
        <h1 class="header-title">FACTURA</h1>
        <h2 class="numero-factura">No. ${m}</h2>
    </div>
</header>

		<hr class="divider" />

		<section class="info-section">
			<h3>${l}</h3>
			<p>RTN: ${u}</p>
			<p>Direccin: ${d}</p>
			<p>Telfono: ${h}</p>
			<p>Email: ${g}</p>
		</section>
		<hr class="divider" />

		<section class="info-dates">
			<p>Fecha y hora: ${T}</p>
			<p>Factura No: ${m}</p>
			<p>CAI: ${v}</p>
			<p>Fecha lmite de emisin: ${x}</p>
			<p>Rango autorizado: ${w?w+" "+_+" al "+w+" "+b:_+" al "+b}</p>
		</section>
		<hr class="divider" />

		<section class="info-section">
			<p>Cliente: ${R}</p>
			<p>RTN Cliente: ${A}</p>
		</section>
		<hr class="divider" />

		<section class="details-section">
			<table class="tabla">
				<thead>
					<tr>
						<th>Descripcin</th>
						<th style="width: 10%;">Cant</th>
							<th style="width: 15%;">Precio unitario</th>
							<th style="width: 15%;">Total</th>
					</tr>
				</thead>
				<tbody>
					${D} </tbody>
			</table>
		</section>
		<hr class="divider" />

	<section class="totals-section">
    <span class="label">Descuento:</span> <span class="value">L ${G.toFixed(2)}</span>
    <span class="label">Sub Total Exonerado:</span> <span class="value">L ${Number(C).toFixed(2)}</span>
    <span class="label">Sub Total Gravado:</span> <span class="value">L ${Number(L).toFixed(2)}</span>
    <span class="label">Sub Total Exento:</span> <span class="value">L ${Number(U).toFixed(2)}</span>
    <span class="label">Tasa Turstica 4%:</span> <span class="value">L ${Number(J).toFixed(2)}</span>
    <span class="label">ISV 15%:</span> <span class="value">L ${Number($).toFixed(2)}</span>
    <span class="label">ISV 18%:</span> <span class="value">L ${Number(be).toFixed(2)}</span>
</section>

<section class="transaccion-section"><hr class="divider" />
    <span class="label">TOTAL TRANSACCIN:</span>
    <span class="value">L ${Number(q).toFixed(2)}</span>
</section>

<hr class="divider" />


		<section class="totals-section total-final">
			<span class="label">**TOTAL FACTURA:**</span> <span class="value">**L ${W.toFixed(2)}**</span>
			<span class="label">Efectivo:</span> <span class="value">L ${Number(E).toFixed(2)}</span>
			<span class="label">Tarjeta:</span> <span class="value">L ${Number(z).toFixed(2)}</span>
			<span class="label">Transferencia:</span> <span class="value">L ${Number(ee).toFixed(2)}</span>
			<span class="label">Cambio:</span> <span class="value">L ${Number(pe).toFixed(2)}</span>
		</section>
		<hr class="divider" />

		<footer class="footer-info">
			<div class="letras">
				<p>Total Pagado: L ${Q.toFixed(2)}</p>
				<p>*** ${me} Lempiras ***</p>
			</div>
			<hr class="divider" />
			
			<div class="firma-section">
				<p>Firma del Cliente: ______________________</p>
				<p>Firma del Emisor: ______________________</p>
			</div>
			
			<div class="copias-info">
				<p>Original: Cliente | Copia: Obligado tributario emisor</p>
			</div>
			
			<div class="final-message">
				<h5>Para cualquier reclamo debe presentar su factura</h5>
				<h5>Gracias por su compra!</h5>
				<h5>LA FACTURA ES BENEFICIO DE TODOS EXJALA!</h5>
			</div>
		</footer>

	</main>
</body>
</html>`}function ux(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const x=Math.floor(v/10),_=v%10;return s[x]+(_?" y "+a[_]:"")}if(v<1e3){const x=Math.floor(v/100),_=v%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let x=u(v);m===2&&v===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}async function op(o={},a="factura",s={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const O=await Kl();O&&(l=l||O.nombre||O.comercio||l,u=u||O.rtn||u,d=d||O.direccion||O.direccion_fiscal||d,h=h||O.telefono||O.telefono_fijo||h,g=g||O.email||O.correo||g,p=p||O.logoUrl||O.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const O=await fetch(String(p),{mode:"cors"});if(O.ok){const ne=await O.blob(),ve=await new Promise(Se=>{const Ae=new FileReader;Ae.onloadend=()=>{Se(typeof Ae.result=="string"?Ae.result:null)},Ae.onerror=()=>{Se(null)},Ae.readAsDataURL(ne)});ve&&(p=ve)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let O=o.caiInfo||null;if(!O&&typeof window<"u"){const ne=window.localStorage.getItem("caiInfo");if(ne)try{O=JSON.parse(ne)}catch{O=null}}if(O&&(v=v||O.cai||O.CAI||"",x=x||O.fecha_vencimiento||O.fecha_limite_emision||"",_=_||O.rango_de||O.rangoDesde||"",b=b||O.rango_hasta||O.rangoHasta||"",w=w||O.identificador||"",!m))try{const ne=O.identificador?String(O.identificador):"",ve=O.secuencia_actual!=null?String(O.secuencia_actual):O.rango_de!=null?String(O.rango_de):"",Se=String(ve).replace(/[^0-9]/g,"")||"";let Ae=0;(O.rango_hasta||O.rango_de)&&(Ae=Math.max(String(O.rango_hasta||O.rango_de).length,Se.length));const De=Se?String(Se).padStart(Ae||Se.length||1,"0"):"";m=(ne||"")+(De||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const R=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),A=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||s.identidad||"C/F",T=new Date().toLocaleString(),I=Array.isArray(s.carrito)?s.carrito:[],M=typeof s.subtotal=="number"?s.subtotal:I.reduce((O,ne)=>O+Number(ne.producto&&ne.producto.precio||ne.precio||0)*(ne.cantidad||1),0),G=typeof s.descuento=="number"?s.descuento:0,C=typeof s.exonerado=="number"?s.exonerado:0,L=typeof s.gravado=="number"?s.gravado:M,U=typeof s.exento=="number"?s.exento:0,$=typeof s.isvTotal=="number"?s.isvTotal:0,be=typeof s.imp18Total=="number"?s.imp18Total:0,J=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,ue=typeof s.total=="number"?s.total:null,_e=M+($||0)+(be||0)+(J||0),q=ue??_e,W=q,Z=s.pagos||{},E=typeof Z.efectivo=="number"?Z.efectivo:typeof s.Efectivo=="number"?s.Efectivo:0,z=typeof Z.tarjeta=="number"?Z.tarjeta:typeof s.Tarjeta=="number"?s.Tarjeta:0,ee=typeof Z.transferencia=="number"?Z.transferencia:typeof s.Transferencia=="number"?s.Transferencia:0,F=typeof Z.totalPaid=="number"?Z.totalPaid:E+z+ee;let pe;if(typeof Z.cambio=="number")pe=Z.cambio;else if(typeof s.cambio=="number")pe=s.cambio;else{const O=Number(F)-Number(W||0);pe=isNaN(O)?0:O>0?O:0}const D=I.map(O=>{const ne=String(O.producto&&(O.producto.nombre||O.producto.descripcion)||O.descripcion||O.nombre||""),ve=Number(O.cantidad||0),Se=Number((O.producto&&(O.producto.precio??O.producto.precio_unitario))??O.precio_unitario??O.precio??0),Ae=!!(O.producto&&O.producto.exento)||!!O.exento,De=!!(O.producto&&O.producto.aplica_impuesto_18)||!!O.aplica_impuesto_18,Me=!!(O.producto&&O.producto.aplica_impuesto_turistico)||!!O.aplica_impuesto_turistico,Ye=De?s.tax18Rate??s.tax18??0:s.taxRate??s.tax??0,gt=Me?s.taxTouristRate??s.taxTourist??0:0,pt=(Number(Ye)||0)+(Number(gt)||0);let dt=Se;!Ae&&pt>0&&(dt=Se/(1+pt));const wt=Number(dt||0).toFixed(2),Ht=dt*ve,Ze=Number(Ht||0).toFixed(2);return`<tr><td>${O.producto&&O.producto.sku||O.sku||""} ${ne}</td><td style="text-align:center">${ve}</td><td style="text-align:right">L ${wt}</td><td style="text-align:right">L ${Ze}</td></tr>`}).join(`
`),P=(Number(E)||0)+(Number(ee)||0)+(Number(z)||0)-(Number(pe)||0),Q=isNaN(P)?0:P,me=dx(Q);return`<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Factura Cinta</title>

<style>
    body {
        font-family: monospace;
        font-size: 12px;
        width: 260px; /* tamao para impresora trmica 58mm */
        margin: 0 auto;
        padding: 0;
    }

    .center { text-align: center; }
    .line { border-top: 1px dashed #000; margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 2px 0; }
    th { border-bottom: 1px solid #000; }
    .right { text-align: right; }
    .left { text-align: left; }
    .bold { font-weight: bold; }
</style>
</head>

<body>

<div class="center">
    <img src="${p}" alt="logo" style="width:120px; height:auto;" />
</div>

<div class="center bold">FACTURA</div>
<div class="center">No. ${m}</div>

<div class="line"></div>

<div class="center bold">${l}</div>
<p>RTN: ${u}</p>
<p>Direccin: ${d}</p>
<p>Tel: ${h}</p>
<p>Email: ${g}</p>

<div class="line"></div>

<p>Fecha/Hora: ${T}</p>
<p>CAI: ${v}</p>
<p>F. Lmite: ${x}</p>
<p>Rango:  
${w?w+" "+_+" al "+w+" "+b:_+" al "+b}</p>

<div class="line"></div>

<p>Cliente: ${R}</p>
<p>RTN Cliente: ${A}</p>

<div class="line"></div>

<table>
    <thead>
        <tr>
            <th class="left">Descripcin</th>
            <th class="right">Cant</th>
            <th class="right">P.U</th>
            <th class="right">Total</th>
        </tr>
    </thead>
    <tbody>
        ${D}
    </tbody>
</table>

<div class="line"></div>

<p>Descuento: <span class="right">L ${G.toFixed(2)}</span></p>
<p>SubT Exonerado: <span class="right">L ${Number(C).toFixed(2)}</span></p>
<p>SubT Gravado: <span class="right">L ${Number(L).toFixed(2)}</span></p>
<p>SubT Exento: <span class="right">L ${Number(U).toFixed(2)}</span></p>
<p>Tasa Turstica 4%: <span class="right">L ${Number(J).toFixed(2)}</span></p>
<p>ISV 15%: <span class="right">L ${Number($).toFixed(2)}</span></p>
<p>ISV 18%: <span class="right">L ${Number(be).toFixed(2)}</span></p>

<div class="line"></div>

<p class="bold">TOTAL TRANSACCIN:
   <span class="right bold">L ${Number(q).toFixed(2)}</span>
</p>

<div class="line"></div>

<p class="bold">TOTAL FACTURA :
   <span class="right bold">L ${W.toFixed(2)}</span>
</p>

<p>Efectivo: <span class="right">L ${Number(E).toFixed(2)}</span></p>
<p>Tarjeta: <span class="right">L ${Number(z).toFixed(2)}</span></p>
<p>Transferencia: <span class="right">L ${Number(ee).toFixed(2)}</span></p>
<p>Cambio: <span class="right">L ${Number(pe).toFixed(2)}</span></p>

<div class="line"></div>

<div class="center">
    <p>Total Pagado: L ${Q.toFixed(2)}</p>
    <p>*** ${me} Lempiras ***</p>
</div>

<div class="line"></div>

<p>Firma Cliente: ____________________</p>
<p>Firma Emisor: _____________________</p>

<div class="center">
    <p>Original: Cliente</p>
    <p>Copia: Obligado tributario emisor</p>
</div>

<div class="center">
    <p>Para cualquier reclamo debe<br/>presentar su factura</p>
    <p>Gracias por su compra!</p>
    <p>LA FACTURA ES BENEFICIO DE TODOS,<br/>EXJALA!</p>
</div>

</body>
</html>
`}function dx(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const x=Math.floor(v/10),_=v%10;return s[x]+(_?" y "+a[_]:"")}if(v<1e3){const x=Math.floor(v/100),_=v%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let x=u(v);m===2&&v===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}function fx({onLogout:o}){j.useEffect(()=>{const H=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=H||""}},[]);const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(""),[g,p]=j.useState("Todas"),[m,v]=j.useState(.15),[x,_]=j.useState(0),[b,w]=j.useState(0),[R,A]=j.useState(26.27),T=["Todas",...Array.from(new Set(a.map(H=>H.categoria)))],I=a.filter(H=>(String(H.nombre||"").toLowerCase().includes(d.toLowerCase())||String(H.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||H.categoria===g)),M=l.reduce((H,le)=>H+Number(le.producto.precio||0)*le.cantidad,0);let G=0,C=0,L=0;for(const H of l){const le=Number(H.producto.precio||0)*H.cantidad,xe=!!H.producto.exento,re=!!H.producto.aplica_impuesto_18,oe=!!H.producto.aplica_impuesto_turistico;if(xe)continue;const ye=re?x||0:m||0,he=oe&&b||0,je=(Number(ye)||0)+(Number(he)||0);if(je<=0)continue;const ae=le-le/(1+je);re?C+=ae*(ye/je):G+=ae*(ye/je),oe&&(L+=ae*(he/je))}const U=M,$=Math.max(0,M-(G+C+L)),be=l.map(H=>{const le=Number(H.producto.precio||0)*H.cantidad,xe=!!H.producto.exento,re=!!H.producto.aplica_impuesto_18,oe=!!H.producto.aplica_impuesto_turistico;if(xe)return{id:H.producto.id,nombre:H.producto.nombre,price:le,isv:0,imp18:0,tur:0,totalTax:0};const ye=re?x||0:m||0,he=oe&&b||0,je=(Number(ye)||0)+(Number(he)||0);if(je<=0)return{id:H.producto.id,nombre:H.producto.nombre,price:le,isv:0,imp18:0,tur:0,totalTax:0};const ae=le-le/(1+je),de=re?0:ae*(ye/je),we=re?ae*(ye/je):0,Ce=oe?ae*(he/je):0;return{id:H.producto.id,nombre:H.producto.nombre,price:le,isv:de,imp18:we,tur:Ce,totalTax:de+we+Ce}}),J=H=>{const le=Number(H.stock??0),xe=Number(H.precio??0);le<1||xe<=0||u(re=>re.find(ye=>ye.producto.id===H.id)?re.map(ye=>ye.producto.id===H.id?{...ye,cantidad:ye.cantidad+1}:ye):[...re,{producto:H,cantidad:1}])},ue=(H,le)=>{u(xe=>xe.map(re=>{if(String(re.producto.id)===String(H)){const oe=re.cantidad+le;return oe>0?{...re,cantidad:oe}:re}return re}).filter(re=>re.cantidad>0))},_e=H=>{u(le=>le.filter(xe=>String(xe.producto.id)!==String(H)))},q=()=>u([]),[W,Z]=j.useState(!1),[E,z]=j.useState("factura"),[ee,F]=j.useState(!1),[pe,N]=j.useState(null),[D,P]=j.useState(null),[Q,me]=j.useState(!1),[ge,O]=j.useState(!1),[ne,ve]=j.useState(""),[Se,Ae]=j.useState(""),De=j.useRef(null),Me=j.useRef(null),[Ye,gt]=j.useState("final"),[pt,dt]=j.useState(""),[wt,Ht]=j.useState(""),[Ze,et]=j.useState(!1),[za,fi]=j.useState(!1),[Gt,hi]=j.useState(!1),[fs,gi]=j.useState(!1),[Ua,ur]=j.useState(null),[hs,gs]=j.useState(!1),[dr,Da]=j.useState("carta"),Ft=async H=>{if(Ae(H),!H||String(H).trim()===""){ve("");return}try{if(Ye==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",H);const{data:oe,error:ye}=await ie.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",H).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:oe,error:ye}),!ye&&oe&&oe.nombre){ve(oe.nombre||""),dt(oe.telefono||""),Ht(oe.correo_electronico||""),et(!!oe.exonerado),setTimeout(()=>{try{Me.current?.focus()}catch{}},50);return}else{ve(""),dt(""),Ht(""),et(!1);return}}const le="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",H);const{data:xe,error:re}=await ie.from(le).select("nombre").eq("rtn",H).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:xe,error:re}),!re&&xe&&xe.nombre?(ve(xe.nombre||""),setTimeout(()=>{try{Me.current?.focus()}catch{}},50)):ve("")}catch(le){console.warn("Error buscando cliente por RTN:",le)}},On=H=>{if(H==="cotizacion"){z("cotizacion"),Z(!0);return}z(H),Z(!0)},Kt=async(H={})=>{try{if(!l||l.length===0)return null;const le=pi(),xe=G,re=C,oe=L,ye=Number(xe||0)+Number(re||0)+Number(oe||0),he=le+ye;let je=H.cliente_id??null;if(!je&&H.rtn)try{const{data:it,error:Je}=await ie.from("clientes").select("id").eq("rtn",H.rtn).maybeSingle();!Je&&it&&it.id&&(je=it.id)}catch{}const ae=In||"system",de=String(Math.floor(Math.random()*9e5)+1e5),we={cliente_id:je,usuario:ae,numero_cotizacion:de,validez_dias:30,subtotal:le,impuesto:ye,total:he,estado:"pendiente"};let Ce=H.cotizacion_id??D;if(Ce){const it={cliente_id:we.cliente_id||null,usuario:we.usuario,validez_dias:we.validez_dias,subtotal:we.subtotal,impuesto:we.impuesto,total:we.total,estado:we.estado},{error:Je}=await ie.from("cotizaciones").update(it).eq("id",Ce);if(Je)return console.warn("Error actualizando cotizacion:",Je),null}else{const{data:it,error:Je}=await ie.from("cotizaciones").insert([we]).select("id").maybeSingle();if(Je)return console.warn("Error insertando cotizacion:",Je),null;if(Ce=it?.id||null,!Ce)return null}const He=l.map(it=>{const Je=Number(it.producto.precio||0),Fe=Number(it.cantidad||0),Un=!!it.producto.exento,fn=!!it.producto.aplica_impuesto_18,Ia=!!it.producto.aplica_impuesto_turistico,pr=Un||fn?0:Je*(m||0)*Fe,sa=Un?0:fn?Je*(x||0)*Fe:0,Ha=Un?0:Ia?Je*(b||0)*Fe:0,_t=Je*Fe,ze=_t+pr+sa+Ha;return{cotizacion_id:Ce,producto_id:it.producto.id||null,descripcion:it.producto.nombre||"",cantidad:Fe,precio_unitario:Je,subtotal:_t,descuento:0,total:ze}});try{await ie.from("cotizaciones_detalle").delete().eq("cotizacion_id",Ce)}catch{}const{error:Dt}=await ie.from("cotizaciones_detalle").insert(He);return Dt?console.warn("Error insertando cotizaciones_detalle:",Dt):console.debug("Cotizacion guardada id=",Ce),Ce}catch(le){return console.warn("Error guardando cotizacion:",le),null}},pi=()=>{const H=l.reduce((oe,ye)=>oe+Number(ye.producto.precio||0)*ye.cantidad,0);let le=0,xe=0,re=0;for(const oe of l){const ye=Number(oe.producto.precio||0)*oe.cantidad,he=!!oe.producto.exento,je=!!oe.producto.aplica_impuesto_18,ae=!!oe.producto.aplica_impuesto_turistico;if(he)continue;const de=je?x||0:m||0,we=ae&&b||0,Ce=(Number(de)||0)+(Number(we)||0);if(Ce<=0)continue;const He=ye-ye/(1+Ce);je?xe+=He*(de/Ce):le+=He*(de/Ce),ae&&(re+=He*(we/Ce))}return Math.max(0,H-(le+xe+re))},Yl=()=>l.reduce((H,le)=>H+(le.producto.exento?0:Number(le.producto.precio||0)*le.cantidad),0),Jl=async()=>{gt("final"),ve("Consumidor Final"),Ae("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),gs(!0),hi(!0),Z(!1)},mi=()=>{gt("normal"),ve(""),Ae(""),gi(!1),ur(null),me(!0),Z(!1)},yi=()=>{gt("juridico"),ve(""),Ae(""),gi(!1),ur(null),me(!0),Z(!1)},vi=async(H,le,xe)=>{const oe=await(dr==="cinta"?op:lp)({cliente:H,rtn:le},E,{carrito:l,subtotal:pi(),isvTotal:G,imp18Total:C,impTouristTotal:L,taxRate:m,tax18Rate:x,taxTouristRate:b,total:U,pagos:xe});if(E==="factura"&&D)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",D);const{error:ye}=await ie.from("cotizaciones").update({estado:"aceptada"}).eq("id",D);if(ye)console.warn("Error marcando cotizacion (pre-print):",ye);else try{P(null)}catch{}}catch(ye){console.warn("Error marcacion pre-print:",ye)}if(E==="factura")try{let ye=null,he=null;try{const je=localStorage.getItem("user"),ae=je?JSON.parse(je):null;he=ae&&(ae.id||ae.user?.id||ae.sub||ae.user_id)?ae.id||ae.user?.id||ae.sub||ae.user_id:null;const de=ae&&(ae.username||ae.user?.username||ae.name||ae.user?.name)?ae.username||ae.user?.username||ae.name||ae.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",je),console.debug("PV: CAI lookup - parsed user object:",ae),console.debug("PV: CAI lookup - extracted userId:",he,"typeof",typeof he),console.debug("PV: CAI lookup - extracted userNameFromStorage:",de),he){const we=typeof he=="string"&&/^\d+$/.test(he)?Number(he):he;try{const{data:Ce,error:He}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",we).order("id",{ascending:!1}).limit(1);!He&&Array.isArray(Ce)&&Ce.length>0&&(ye=Ce[0])}catch(Ce){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Ce)}}if(!ye&&de)try{const{data:we,error:Ce}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",de).order("id",{ascending:!1}).limit(1);!Ce&&Array.isArray(we)&&we.length>0&&(ye=we[0])}catch(we){console.debug("PV: CAI lookup by cajero failed:",we)}}catch(je){console.debug("No se pudo cargar CAI desde frontend:",je)}await kn({clienteName:H,rtn:le,paymentPayload:xe,caiData:ye,usuarioId:he})}catch(ye){console.warn("Error preparando venta antes de imprimir:",ye),alert("Error preparando venta antes de imprimir: "+String(ye))}try{const ye=document.createElement("iframe");ye.style.position="fixed",ye.style.right="0",ye.style.bottom="0",ye.style.width="0",ye.style.height="0",ye.style.border="0",ye.style.overflow="hidden",ye.setAttribute("aria-hidden","true"),document.body.appendChild(ye);const he=ye.contentWindow,je=ye.contentDocument||ye.contentWindow?.document;if(!je||!he)try{document.body.removeChild(ye)}catch{}else{je.open(),je.write(oe),je.close();const ae=()=>{try{he.focus(),he.print()}catch(we){console.warn("Error during iframe print (finalize):",we)}setTimeout(()=>{try{document.body.removeChild(ye)}catch{}},800)},de=()=>{try{const we=je.images;if(we&&we.length>0){let Ce=0;for(let He=0;He<we.length;He++){const Dt=we[He];Dt.complete?Ce++:(Dt.addEventListener("load",()=>{Ce++,Ce===we.length&&ae()}),Dt.addEventListener("error",()=>{Ce++,Ce===we.length&&ae()}))}Ce===we.length&&ae()}else ae()}catch{try{he.addEventListener("load",ae)}catch{}setTimeout(ae,1e3)}};try{je.readyState==="complete"?de():(he.addEventListener("load",de),setTimeout(de,1500))}catch{setTimeout(de,800)}}}catch(ye){console.warn("Direct print failed, falling back to opening new window",ye);const he=window.open("","_blank");he&&(he.document.open(),he.document.write(oe),he.document.close(),setTimeout(()=>{try{he.print(),he.close()}catch{}},800))}E==="factura"&&(q(),await Ba()),E==="cotizacion"&&(N({cliente:H,rtn:le}),F(!0))},kn=async({clienteName:H,rtn:le,paymentPayload:xe,caiData:re,usuarioId:oe})=>{if(!l||l.length===0)return null;const ye=xe&&xe.tipoPagoString?String(xe.tipoPagoString):"",he=xe&&xe.totalPaid?Number(xe.totalPaid||0):0,je=he>Number(U||0)?he-Number(U||0):0;let ae=String(Math.floor(Math.random()*9e5)+1e5);const de=zt||re||null;let we=null,Ce=0,He=null,Dt=null;if(de&&(de.rango_de!==void 0||de.secuencia_actual!==void 0))try{const ze=de.rango_de!=null?String(de.rango_de):"",tt=de.rango_hasta!=null?String(de.rango_hasta):"",yt=de.secuencia_actual!=null?String(de.secuencia_actual):"",Oe=Number(String(ze).replace(/[^0-9]/g,""))||0,ot=Number(String(tt).replace(/[^0-9]/g,""))||0,$t=Number(String(yt).replace(/[^0-9]/g,""))||Oe||0;Ce=Math.max((tt||ze||"").length,String($t).length,1),Dt=String($t).padStart(Ce,"0"),ae=(de.identificador?String(de.identificador):"")+Dt;const _s=$t+1;we=_s,He=String(_s).padStart(Ce,"0")}catch(ze){console.debug("Error computing factura from caiInfoState, falling back to random:",ze)}const it={rtn:le||null,nombre_cliente:H||null,usuario:In||"system",factura:ae,tipo_pago:ye,subtotal:Number($||0),impuesto:Number(G+C+L||0),total:Number(U||0),estado:"pagada",cambio:String(Number(je).toFixed(2)),cai:de?.cai??null,rango_desde:(de&&de.identificador?String(de.identificador):"")+(de?.rango_de!=null?String(de.rango_de):"")||null,rango_hasta:(de&&de.identificador?String(de.identificador):"")+(de?.rango_hasta!=null?String(de.rango_hasta):"")||null,fecha_limite_emision:de?.fecha_vencimiento??de?.fecha_limite_emision??null};let Je=null,Fe=null;try{const ze=await ie.from("ventas").insert([it]).select("id, factura");Je=ze.data??ze,Fe=ze.error??null}catch(ze){Fe=ze}if(console.debug("Insert venta response:",{ventaInsRaw:Je,ventaErr:Fe}),Fe){const ze=String(Fe&&(Fe.message||Fe.msg||Fe.details)||""),tt=Fe&&Fe.code?String(Fe.code):"";if(tt==="PGRST204"||ze.includes("Could not find the")||/column .* of 'ventas'/.test(ze)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:ze,code:tt});const Oe={...it};delete Oe.cai,delete Oe.rango_desde,delete Oe.rango_hasta,delete Oe.fecha_limite_emision;try{const ot=await ie.from("ventas").insert([Oe]).select("id, factura");if(Je=ot.data??ot,Fe=ot.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:Je,ventaErr:Fe}),Fe)throw Fe}catch(ot){throw console.error("Fallback insert also failed:",ot),ot}}else throw Fe}const Un=Array.isArray(Je)?Je[0]:Je;let fn=Un?Un.id||Un.id:null;if(!fn)try{const{data:ze,error:tt}=await ie.from("ventas").select("id").eq("factura",ae).maybeSingle();tt&&console.debug("Error buscando venta por factura (fallback):",tt),ze&&ze.id&&(fn=ze.id)}catch(ze){console.debug("fallback lookup error",ze)}if(!fn)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",Je),null;const Ia=l.map(ze=>{const tt=Number(ze.producto.precio||0),yt=Number(ze.cantidad||0),Oe=tt*yt,ot=0,$t=Oe-ot;return{venta_id:fn,factura:ae,producto_id:ze.producto.id,cantidad:yt,precio_unitario:tt,subtotal:Oe,descuento:ot,total:$t}});if(re&&oe&&(ze=>typeof ze=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(ze))(oe))try{const ze=l.map(Oe=>({producto_id:String(Oe.producto.id),cantidad:Number(Oe.cantidad||0),precio_unitario:Number(Oe.producto.precio||0),subtotal:Number((Number(Oe.producto.precio||0)*Oe.cantidad).toFixed(6)),descuento:0,total:Number((Number(Oe.producto.precio||0)*Oe.cantidad).toFixed(6))})),{data:tt,error:yt}=await ie.rpc("create_venta_with_detalle",{p_usuario_id:oe,p_usuario:In||oe,p_rtn:le||null,p_nombre_cliente:H||null,p_tipo_pago:ye,p_subtotal:Number($||0),p_impuesto:Number(G+C+L||0),p_total:Number(U||0),p_cambio:String(Number(je).toFixed(2)),p_detalles:ze});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:tt,rpcErr:yt}),yt)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",yt);else if(tt&&Array.isArray(tt)&&tt.length>0){const Oe=tt[0];try{if(de&&de.id!=null)try{const{data:ot,error:$t}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",de.id).maybeSingle();if(!$t&&ot){Jt(ot);try{localStorage.setItem("caiInfo",JSON.stringify(ot))}catch{}}}catch(ot){console.debug("Error refreshing cai after RPC:",ot)}}catch(ot){console.debug("Error during post-RPC cai refresh:",ot)}return Oe.venta_id||Oe.venta_id===0?Oe.venta_id:fn}else if(tt&&tt.venta_id){try{if(de&&de.id!=null)try{const{data:Oe,error:ot}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",de.id).maybeSingle();if(!ot&&Oe){Jt(Oe);try{localStorage.setItem("caiInfo",JSON.stringify(Oe))}catch{}}}catch(Oe){console.debug("Error refreshing cai after RPC (scalar):",Oe)}}catch(Oe){console.debug("Error during post-RPC cai refresh (scalar):",Oe)}return tt.venta_id}}catch(ze){console.warn("Error calling RPC create_venta_with_detalle:",ze)}else re&&oe&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",oe);const{data:sa,error:Ha}=await ie.from("ventas_detalle").insert(Ia).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:sa,detErr:Ha}),Ha)throw Ha;try{if(xe&&Array.isArray(xe.pagos)&&xe.pagos.length>0){const ze=xe.pagos.map(Oe=>({venta_id:fn,tipo:Oe.tipo,monto:Number(Oe.monto||0),banco:Oe.banco||null,tarjeta:Oe.tarjeta||null,factura:ae||Oe.factura||null,autorizador:Oe.autorizador||null,referencia:Oe.referencia||null,meta:Oe.meta||null,created_by:typeof oe=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(oe)?oe:null})),{data:tt,error:yt}=await ie.from("pagos").insert(ze).select("id");yt?console.warn("Error insertando pagos en tabla pagos:",yt):console.debug("Pagos insertados:",tt)}}catch(ze){console.warn("Excepcin insertando pagos:",ze)}const _t=de&&(de.id||de.id===0)?de.id:null;if(_t!=null&&we!=null)try{const ze=He??String(we);try{const tt=de?.rango_hasta!=null?String(de.rango_hasta):"",yt=Number(tt.replace(/[^0-9]/g,""))||null,Oe=Number(String(ze).replace(/[^0-9]/g,""))||null;if(yt!=null&&Oe!=null&&Oe>yt)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:Oe,rangoHastaNum:yt});else{const{error:ot}=await ie.from("cai").update({secuencia_actual:ze}).eq("id",_t);if(ot)console.debug("Error updating cai.secuencia_actual (manual path):",ot);else{console.debug("Updated cai.secuencia_actual to",ze,"for cai id",_t);try{const $t={...de||{},secuencia_actual:ze};Jt($t);try{localStorage.setItem("caiInfo",JSON.stringify($t))}catch{}}catch($t){console.debug("Error updating local caiInfoState/localStorage:",$t)}}}}catch(tt){console.debug("Validation error while checking rango_hasta:",tt);const{error:yt}=await ie.from("cai").update({secuencia_actual:ze}).eq("id",_t);if(yt)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",yt);else{console.debug("Updated cai.secuencia_actual to",ze,"for cai id",_t);try{const Oe={...de||{},secuencia_actual:ze};Jt(Oe);try{localStorage.setItem("caiInfo",JSON.stringify(Oe))}catch{}}catch(Oe){console.debug("Error updating local caiInfoState/localStorage (after validation):",Oe)}}}}catch(ze){console.debug("Exception updating cai.secuencia_actual:",ze)}return fn},Ba=async()=>{if(E==="factura"&&D)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",D);const{error:H}=await ie.from("cotizaciones").update({estado:"aceptada"}).eq("id",D);H?console.warn("Error marcando cotizacion como facturado:",H):console.debug("Cotizacion marcada como facturado:",D)}catch(H){console.warn("Error procesando cotizacion tras facturar",H)}};j.useEffect(()=>{Q&&setTimeout(()=>{try{De.current?.focus()}catch{}},80)},[Q]);const La=async()=>{try{if(Se&&ne){const re={rtn:Se,nombre:ne},{error:oe}=await ie.from("clientenatural").upsert(re,{onConflict:"rtn"});oe&&console.warn("Error guardando clientenatural:",oe)}}catch(re){console.warn("Error upsert clientenatural:",re)}try{if(Se&&ne)if(Ye==="juridico"){const{data:re,error:oe}=await ie.from("clientes").select("id").eq("rtn",Se).eq("tipo_cliente","juridico").maybeSingle();if(oe&&console.warn("Error buscando cliente juridico:",oe),re&&re.id){const{error:ye}=await ie.from("clientes").update({nombre:ne,telefono:pt||null,correo_electronico:wt||null,exonerado:Ze}).eq("id",re.id);ye&&console.warn("Error actualizando cliente juridico:",ye)}else{const{error:ye}=await ie.from("clientes").insert([{nombre:ne,rtn:Se,telefono:pt||null,correo_electronico:wt||null,tipo_cliente:"juridico",exonerado:Ze}]);ye&&console.warn("Error insertando cliente juridico:",ye)}}else{const re={rtn:Se,nombre:ne},{error:oe}=await ie.from("clientenatural").upsert(re,{onConflict:"rtn"});oe&&console.warn("Error guardando clientenatural:",oe)}}catch(re){console.warn("Error upsert cliente:",re)}const le=await(dr==="cinta"?op:lp)({cliente:ne||"Cliente",rtn:Se||""},E,{carrito:l,subtotal:pi(),isvTotal:G,imp18Total:C,impTouristTotal:L,taxRate:m,tax18Rate:x,taxTouristRate:b,total:U,pagos:Ua});if(E==="factura"&&D)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",D);const{error:re}=await ie.from("cotizaciones").update({estado:"aceptada"}).eq("id",D);if(re)console.warn("Error marcando cotizacion como facturado (pre-print):",re);else{console.debug("Cotizacion marcada como facturado (pre-print):",D);try{P(null)}catch{}}}catch(re){console.warn("Error marcacion pre-print:",re)}if(E==="factura")try{let re=null,oe=null;try{const ye=localStorage.getItem("user"),he=ye?JSON.parse(ye):null;oe=he&&(he.id||he.user?.id||he.sub||he.user_id)?he.id||he.user?.id||he.sub||he.user_id:null;const je=he&&(he.username||he.user?.username||he.name||he.user?.name)?he.username||he.user?.username||he.name||he.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",ye),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",he),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",oe,"typeof",typeof oe),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",je),oe){const ae=typeof oe=="string"&&/^\d+$/.test(oe)?Number(oe):oe;try{const{data:de,error:we}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",ae).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(de)&&de.length>0&&(re=de[0])}catch(de){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",de)}}if(!re&&je)try{const{data:ae,error:de}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",je).order("id",{ascending:!1}).limit(1);!de&&Array.isArray(ae)&&ae.length>0&&(re=ae[0])}catch(ae){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",ae)}}catch(ye){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",ye)}await kn({clienteName:ne||"Cliente",rtn:Se||null,paymentPayload:Ua,caiData:re,usuarioId:oe})}catch(re){console.warn("Error insertando venta en flujo cliente normal:",re)}try{const re=document.createElement("iframe");re.style.position="fixed",re.style.right="0",re.style.bottom="0",re.style.width="0",re.style.height="0",re.style.border="0",re.style.overflow="hidden",re.setAttribute("aria-hidden","true"),document.body.appendChild(re);const oe=re.contentWindow,ye=re.contentDocument||re.contentWindow?.document;if(!ye||!oe)try{document.body.removeChild(re)}catch{}else{ye.open(),ye.write(le),ye.close();const he=()=>{try{oe.focus(),oe.print()}catch(ae){console.warn("Error during iframe print (cliente normal):",ae)}setTimeout(()=>{try{document.body.removeChild(re)}catch{}},800)},je=()=>{try{const ae=ye.images;if(ae&&ae.length>0){let de=0;for(let we=0;we<ae.length;we++){const Ce=ae[we];Ce.complete?de++:(Ce.addEventListener("load",()=>{de++,de===ae.length&&he()}),Ce.addEventListener("error",()=>{de++,de===ae.length&&he()}))}de===ae.length&&he()}else he()}catch{try{oe.addEventListener("load",he)}catch{}setTimeout(he,1e3)}};try{ye.readyState==="complete"?je():(oe.addEventListener("load",je),setTimeout(je,1500))}catch{setTimeout(je,800)}}}catch(re){console.warn("Direct print (cliente normal) failed, falling back to new window",re);const oe=window.open("","_blank");oe&&(oe.document.open(),oe.document.write(le),oe.document.close(),setTimeout(()=>{try{oe.print(),oe.close()}catch{}},800))}await(async()=>{E==="factura"&&(q(),await Ba()),E==="cotizacion"&&(N({cliente:ne||"Cliente",rtn:Se||null}),F(!0))})(),me(!1)},[qn,zn]=j.useState(null),[bi,Ma]=j.useState([]),[Ql,xi]=j.useState(!1),[ps,_i]=j.useState(null);j.useEffect(()=>{fetch("/data-base/inventario.json").then(async H=>{if(!H.ok)return console.warn("inventario.json no disponible, status",H.status),null;const le=H.headers.get("content-type")||"";if(!le.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",le),null;try{return await H.json()}catch(xe){return console.warn("Error parseando inventario.json:",xe),null}}).then(H=>{H&&Array.isArray(H.items)&&Ma(H.items),console.log("inventario cargado:",H&&H.items?H.items.length:0)}).catch(H=>{console.warn("Error cargando inventario:",H)})},[]),j.useEffect(()=>{let H=!0;return(async()=>{try{const{data:le,error:xe}=await ie.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(xe)throw xe;const re=Array.isArray(le)?le:[],oe=re.map(ae=>String(ae.id));if(oe.length===0){H&&s([]);return}const ye={};try{const{data:ae,error:de}=await ie.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(de)throw de;if(console.debug("PV: precios total rows",Array.isArray(ae)?ae.length:0),Array.isArray(ae))for(const we of ae){const Ce=String(we.producto_id);ye[Ce]||(ye[Ce]=Number(we.precio||0))}}catch(ae){console.warn("Error cargando precios en PV:",ae)}let he={};try{const{data:ae,error:de}=await ie.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",oe);if(de)throw de;const we=Array.isArray(ae)?ae:[];he={},oe.forEach(Ce=>he[Ce]=0);for(const Ce of we){const He=String(Ce.producto_id),Dt=Number(Ce.cantidad)||0,it=String(Ce.tipo_de_movimiento||"").toUpperCase();it==="ENTRADA"?he[He]=(he[He]||0)+Dt:it==="SALIDA"&&(he[He]=(he[He]||0)-Dt)}}catch(ae){console.warn("Error cargando registro_de_inventario en PV:",ae),he={},oe.forEach(de=>he[de]=0)}console.debug("PV: priceMap sample",Object.keys(ye).slice(0,5).map(ae=>[ae,ye[ae]]));const je=re.map(ae=>({id:String(ae.id),sku:ae.sku,nombre:ae.nombre,categoria:ae.categoria,imagen:ae.imagen,precio:ye[String(ae.id)]!==void 0?ye[String(ae.id)]:ae.precio!==void 0?Number(ae.precio):0,exento:ae.exento===!0||String(ae.exento)==="true"||Number(ae.exento)===1||!1,aplica_impuesto_18:ae.aplica_impuesto_18===!0||String(ae.aplica_impuesto_18)==="true"||Number(ae.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:ae.aplica_impuesto_turistico===!0||String(ae.aplica_impuesto_turistico)==="true"||Number(ae.aplica_impuesto_turistico)===1||!1,stock:Number((he[String(ae.id)]||0).toFixed(2))}));H&&s(je)}catch(le){console.warn("Error cargando productos desde inventario:",le),H&&s([])}})(),()=>{H=!1}},[]),j.useEffect(()=>{const H=xe=>{try{const re=xe||(()=>{const he=localStorage.getItem("cotizacion_to_load");return he?JSON.parse(he):null})();if(!re)return;try{P(re.header&&re.header.id?String(re.header.id):null)}catch{}const ye=(Array.isArray(re.detalles)?re.detalles:[]).map(he=>{const je=a.find(de=>String(de.id)===String(he.producto_id));return{producto:je?{...je}:{id:String(he.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:he.sku??void 0,nombre:he.descripcion||he.nombre||"Artculo",precio:Number(he.precio_unitario||he.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(he.cantidad||1)}});ye.length>0&&u(ye);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};H();const le=xe=>{try{H(xe.detail)}catch{}};return window.addEventListener("cotizacion:load",le),()=>{window.removeEventListener("cotizacion:load",le)}},[a]);const[In,fr]=j.useState(null),[ms,ys]=j.useState(null),[wn,Rt]=j.useState(null),[zt,Jt]=j.useState(null),[hr,vs]=j.useState(!1),[bs,xs]=j.useState({}),qa=async()=>{try{let H=null;try{const le=localStorage.getItem("user"),xe=le?JSON.parse(le):null;let re=wn??(xe&&(xe.id||xe.user?.id||xe.sub||xe.user_id)?xe.id||xe.user?.id||xe.sub||xe.user_id:null);const oe=In??(xe&&(xe.username||xe.user?.username||xe.name||xe.user?.name)?xe.username||xe.user?.username||xe.name||xe.user?.name:null),ye=re!=null&&typeof re=="string"&&/^\d+$/.test(re)?Number(re):re;if(ye!=null)try{const{data:he,error:je}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",ye).order("id",{ascending:!1}).limit(1);!je&&Array.isArray(he)&&he.length>0&&(H=he[0])}catch(he){console.debug("refreshCaiInfo: lookup by usuario_id failed:",he)}if(!H&&oe)try{const{data:he,error:je}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",oe).order("id",{ascending:!1}).limit(1);!je&&Array.isArray(he)&&he.length>0&&(H=he[0])}catch(he){console.debug("refreshCaiInfo: lookup by cajero failed:",he)}}catch(le){console.debug("refreshCaiInfo: error building lookup params",le)}if(H){Jt(H);try{localStorage.setItem("caiInfo",JSON.stringify(H))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",H)}}catch(H){console.debug("refreshCaiInfo: unexpected error",H)}};j.useEffect(()=>{try{const H=localStorage.getItem("user");if(H){const le=JSON.parse(H);fr(le.username||le.name||null),ys(le.role||null);let xe=null;try{xe=le&&(le.id||le.user?.id||le.sub||le.user_id)?le.id||le.user?.id||le.sub||le.user_id:null,Rt(xe??null),console.debug("PV: localStorage.user parsed:",le),console.debug("PV: extracted userId for CAI/RPC usage:",xe)}catch(re){console.debug("PV: error parsing localStorage.user for debug:",re)}try{const re=localStorage.getItem("caiInfo");if(re){const oe=JSON.parse(re);Jt(oe),console.debug("PV: loaded caiInfo from localStorage:",oe),(async()=>{try{if(!(oe&&oe.rango_de!==void 0&&oe.rango_hasta!==void 0&&oe.fecha_vencimiento!==void 0&&oe.secuencia_actual!==void 0)){const he=le&&(le.username||le.user?.username||le.name||le.user?.name)?le.username||le.user?.username||le.name||le.user?.name:null,je=xe&&typeof xe=="string"&&/^\d+$/.test(xe)?Number(xe):xe;let ae=null;try{if(je!=null){const{data:de,error:we}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",je).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(de)&&de.length>0&&(ae=de[0])}}catch(de){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",de)}if(!ae&&he)try{const{data:de,error:we}=await ie.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",he).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(de)&&de.length>0&&(ae=de[0])}catch(de){console.debug("PV: refetch CAI by cajero failed:",de)}if(ae){Jt(ae);try{localStorage.setItem("caiInfo",JSON.stringify(ae))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",ae)}}}catch(ye){console.debug("PV: error trying to refresh caiInfo:",ye)}})()}}catch(re){console.debug("PV: error parsing localStorage.caiInfo:",re)}}}catch{}},[]),j.useEffect(()=>{let H=!0;return(async()=>{try{const{data:le,error:xe}=await ie.from("impuesto").select("id, impuesto_venta");if(xe)throw xe;if(!le||!Array.isArray(le))return;const re=je=>{const ae=le.find(Ce=>Number(Ce.id)===je);if(!ae)return null;const de=ae.impuesto_venta;if(de==null)return null;const we=Number(de);return Number.isNaN(we)?null:we>1?we/100:we},oe=re(1),ye=re(2),he=re(3);if(H){let je=oe,ae=ye,de=he;try{if((je===null||je===0)&&H){const Ce=(await ie.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,He=Ce==null?null:Number(Ce);He!=null&&!Number.isNaN(He)&&(je=He>1?He/100:He)}if((ae===null||ae===0)&&H){const Ce=(await ie.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,He=Ce==null?null:Number(Ce);He!=null&&!Number.isNaN(He)&&(ae=He>1?He/100:He)}if((de===null||de===0)&&H){const Ce=(await ie.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,He=Ce==null?null:Number(Ce);He!=null&&!Number.isNaN(He)&&(de=He>1?He/100:He)}}catch(we){console.warn("PV: fallback single-id impuesto fetch failed",we)}(je===null||je===0)&&(je=.15),(ae===null||ae===0)&&(ae=.18),(de===null||de===0)&&(de=.04),v(je),_(ae),w(de),console.debug("PV: impuestos raw rows",le),console.debug("PV: resolved tax rates",{taxRate:je,tax18Rate:ae,taxTouristRate:de})}}catch(le){console.warn("Error cargando impuesto en PV:",le)}})(),()=>{H=!1}},[]);const gr=H=>{console.log("openUbicacion",H,"entradasCount",bi.length);let le=null;try{le=a.find(re=>String(re.sku||"")===String(H)||String(re.id)===String(H))||null}catch{le=null}if(le){const re=Number(le.stock??0),oe={id:le.id,producto:le.nombre||"",sku:le.sku||"",imagen:le.imagen||null,descripcion:le.descripcion||"",ubicacion:le.ubicacion||null,cantidad:re};_i(oe),xi(!0);return}const xe=bi.find(re=>re.sku===H)||null;console.log("entrada encontrada",xe),_i(xe),xi(!0)};if(j.useEffect(()=>{let H=!0;return(async()=>{try{const le="inventario",xe={};await Promise.all((a||[]).map(async re=>{const oe=re.imagen;if(!oe){xe[String(re.id)]=null;return}const ye=String(oe);if(ye.startsWith("http")){xe[String(re.id)]=ye;return}let he=ye;const je=String(ye).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);je&&(he=decodeURIComponent(je[2]));try{const ae=await ie.storage.from(le).getPublicUrl(he),de=ae?.data?.publicUrl||ae?.data?.publicURL||null;if(de){xe[String(re.id)]=de;return}}catch{}try{const de=(await ie.storage.from(le).createSignedUrl(he,604800))?.data?.signedUrl??null;xe[String(re.id)]=de}catch{xe[String(re.id)]=null}})),H&&xs(xe)}catch(le){console.warn("Error resolviendo imgenes en PV",le)}})(),()=>{H=!1}},[a]),qn){if(qn==="DevolucionCaja")return i.jsx(F0,{onBack:()=>zn(null)});if(qn==="IngresoEfectivo")return i.jsx(K0,{onBack:()=>zn(null)});if(qn==="CotizacionesGuardadas")return i.jsx(Y0,{onBack:()=>zn(null)});if(qn==="PedidosEnLinea")return i.jsx(J0,{onBack:()=>zn(null)});if(qn==="CorteCajaParcial")return i.jsx(Q0,{onBack:()=>zn(null)});if(qn==="CorteCajaTotal")return i.jsx(X0,{onBack:()=>zn(null)})}return i.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[i.jsx(nx,{userName:In,userRole:ms,userId:wn,caiInfo:zt,onLogout:o,onNavigate:H=>zn(H),onOpenDatosFactura:()=>vs(!0),onPrintFormatChange:H=>Da(H),printFormat:dr}),i.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[i.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:H=>h(H.target.value),onKeyDown:H=>{if(H.key==="Enter"){const le=String(d||"").trim().toLowerCase();if(!le)return;const re=I.find(oe=>String(oe.sku||"").toLowerCase()===le)||I[0];if(re){const oe=Number(re.stock??0),ye=Number(re.precio??0);oe>=1&&ye>0?J(re):console.debug("No se puede agregar por stock/precio",{id:re.id,stockNum:oe,precioNum:ye})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),i.jsx("select",{value:g,onChange:H=>p(H.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:T.map(H=>i.jsx("option",{value:H,children:H},H))}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("label",{style:{fontSize:13,color:"#333"},children:"Tipo de cambio Lps/$"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:R,onChange:H=>{const le=Number(H.target.value||0);A(Number(le.toFixed?Number(le.toFixed(2)):le))},style:{width:120,padding:"8px 10px",borderRadius:8,border:"1px solid #cbd5e1"}})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:i.jsx(ex,{productos:I,imageUrls:bs,agregarAlCarrito:J,openUbicacion:gr,thStyle:hx,tdStyle:gx,skuStyle:px})}),i.jsx(tx,{carrito:l,actualizarCantidad:ue,eliminarDelCarrito:_e,vaciarCarrito:q,subtotal:$,perItemTaxes:be,taxRate:m,tax18Rate:x,taxTouristRate:b,total:U,openSelector:On,btnStyle:mx})]})]}),i.jsx(rx,{open:Ql,selectedEntrada:ps,onClose:()=>{xi(!1),_i(null)},imageUrls:bs}),i.jsx(W0,{open:Gt,totalDue:U,exchangeRate:R,onClose:()=>hi(!1),onConfirm:async H=>{if(ur(H),gi(!0),hs)try{gs(!1),await vi("Consumidor Final","C/F",H)}catch(le){console.warn("Error facturando despus del pago:",le)}hi(!1)}}),i.jsx(sx,{open:ee,onClose:()=>F(!1),onCancel:()=>{F(!1),N(null)},onSave:async()=>{F(!1);try{const H=await Kt(pe||{});H&&P(String(H))}catch(H){console.warn("Error guardando cotizacion desde confirm modal",H)}N(null)}}),i.jsx(lx,{open:W,onClose:()=>Z(!1),doFacturaClienteFinal:Jl,doFacturaClienteNormal:mi,doFacturaClienteJuridico:yi,carritoLength:l.length,subtotal:pi(),taxRate:m,taxableSubtotal:Yl()}),i.jsx(ox,{open:Q,onClose:()=>me(!1),clienteTipo:Ye,clienteRTN:Se,clienteNombre:ne,clienteTelefono:pt,clienteCorreo:wt,clienteExonerado:Ze,clienteSearchOpen:ge,setClienteSearchOpen:H=>O(H),onRTNChange:H=>Ft(H),onNombreChange:H=>ve(H),onTelefonoChange:H=>dt(H),onCorreoChange:H=>Ht(H),onExoneradoChange:H=>et(H),onCreateCliente:()=>fi(!0),onCancel:()=>me(!1),onOpenCreateCliente:()=>fi(!0),onOpenPayment:()=>hi(!0),paymentDone:fs,submitClienteNormal:La}),i.jsx(cx,{open:za,onClose:()=>fi(!1),clienteRTN:Se,clienteNombre:ne,clienteTelefono:pt,clienteCorreo:wt,clienteExonerado:Ze,onChangeRTN:H=>Ae(H),onChangeNombre:H=>ve(H),onChangeTelefono:H=>dt(H),onChangeCorreo:H=>Ht(H),onChangeExonerado:H=>et(H),onCreate:async()=>{try{if(!ne||!Se)return;const{data:H,error:le}=await ie.from("clientes").select("id").eq("rtn",Se).maybeSingle();if(le&&console.warn("Error buscando cliente al crear:",le),H&&H.id){const{error:xe}=await ie.from("clientes").update({nombre:ne,telefono:pt||null,correo_electronica:wt||null,tipo_cliente:"juridico",exonerado:Ze}).eq("id",H.id);xe&&console.warn("Error actualizando cliente al crear:",xe)}else{const{error:xe}=await ie.from("clientes").insert([{nombre:ne,rtn:Se,telefono:pt||null,correo_electronica:wt||null,tipo_cliente:"juridico",exonerado:Ze}]);xe&&console.warn("Error insertando cliente al crear:",xe)}}catch(H){console.warn("Error creando cliente juridico:",H)}fi(!1)}}),i.jsx(ix,{open:hr,onClose:()=>vs(!1),caiInfo:zt,onRefresh:qa})]})}const hx={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},gx={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},px={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},mx={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},cp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function yx({title:o,children:a}){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:o}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function vx(){const[o,a]=j.useState(null);return j.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Ventas (ltimos das)"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Flujo de caja"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Inventario por categora"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Promedios"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):i.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const bx="modulepreload",xx=function(o){return"/"+o},up={},Sn=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var h=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=xx(v),v in up)return;up[v]=!0;const x=v.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${_}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":bx,x||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),x)return new Promise((w,R)=>{b.addEventListener("load",w),b.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function sm({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:h="Cancelar"}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),i.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:h}),i.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function _x(){const[o,a]=j.useState(null),[s,l]=j.useState(!1),[u,d]=j.useState(!1),[h,g]=j.useState({}),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,R]=j.useState(!1),[A,T]=j.useState(null),[I,M]=j.useState(null),[G,C]=j.useState(!1),[L,U]=j.useState(""),[$,be]=j.useState(""),[J,ue]=j.useState(null),[_e,q]=j.useState(null);j.useEffect(()=>{let D=!0;return(async()=>{l(!0);try{const P=(await Sn(async()=>{const{default:ge}=await Promise.resolve().then(()=>jn);return{default:ge}},void 0)).default,{data:Q,error:me}=await P.from("empresa").select("*").limit(1).single();if(!D)return;if(me)throw me;if(Q){a(Q),g(Q);try{localStorage.setItem("companyData",JSON.stringify(Q))}catch{}l(!1);return}}catch(P){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",P)}try{const P=localStorage.getItem("companyData");if(P){a(JSON.parse(P)),g(JSON.parse(P)),l(!1);return}}catch{}try{const P=await fetch("/data-base/company.json");if(!P.ok)throw new Error("no json");const Q=await P.json();if(!D)return;a(Q),g(Q)}catch{D&&a(null)}finally{D&&l(!1)}})(),()=>{D=!1}},[]),j.useEffect(()=>{o&&g(o)},[o]),j.useEffect(()=>{try{const D=localStorage.getItem("pendingCompanySave");if(D){const P=JSON.parse(D);x(!0),b(P.payload??null),R(!!P.needsLogo)}}catch{}},[]),j.useEffect(()=>{let D=!0;return(async()=>{try{if(!o||!o.logo){D&&ue(null);return}const P=String(o.logo);if(P.startsWith("http")){D&&ue(P);return}const Q=(await Sn(async()=>{const{default:Se}=await Promise.resolve().then(()=>jn);return{default:Se}},void 0)).default,me="logo",O=(await Q.storage.from(me).getPublicUrl(P))?.data?.publicUrl??null;if(O){D&&ue(O);return}const ve=(await Q.storage.from(me).createSignedUrl(P,3600))?.data?.signedUrl??null;if(ve){D&&ue(ve);return}D&&ue(null)}catch(P){console.warn("Error resolving company logo URL",P),D&&ue(null)}})(),()=>{D=!1}},[o?.logo]),j.useEffect(()=>{let D=!0;return(async()=>{try{if(p){D&&q(p);return}const P=h?.logo;if(!P){D&&q(null);return}const Q=String(P);if(Q.startsWith("http")){D&&q(Q);return}const me=(await Sn(async()=>{const{default:Ae}=await Promise.resolve().then(()=>jn);return{default:Ae}},void 0)).default,ge="logo",ne=(await me.storage.from(ge).getPublicUrl(Q))?.data?.publicUrl??null;if(ne){D&&q(ne);return}const Se=(await me.storage.from(ge).createSignedUrl(Q,3600))?.data?.signedUrl??null;if(Se){D&&q(Se);return}D&&q(null)}catch(P){console.warn("Error resolving edit logo URL",P),D&&q(null)}})(),()=>{D=!1}},[h?.logo,p]);function W(){d(!0),g(o||{})}function Z(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function E(D){const{name:P,value:Q}=D.target;g(me=>({...me,[P]:Q}))}function z(D){const P=D.target.files?.[0]??null;if(g(Q=>({...Q,logoFile:P})),P)try{const Q=URL.createObjectURL(P);m(Q)}catch{m(null)}else m(null)}function ee(D=!1){const P="logo",Q="https://sqwqlvsjtimallidxrsz.supabase.co";if(D){if(p)return p;const O=h?.logo;if(!O)return"/logo192.png";if(String(O).startsWith("http"))return String(O);let ne=String(O);return ne.startsWith(`${P}/`)&&(ne=ne.slice(P.length+1)),`${Q}/storage/v1/object/public/${P}/${encodeURIComponent(ne)}`}if(!o)return"/logo192.png";const me=o.logo;if(!me)return"/logo192.png";if(String(me).startsWith("http"))return String(me);let ge=String(me);return ge.startsWith(`${P}/`)&&(ge=ge.slice(P.length+1)),`${Q}/storage/v1/object/public/${P}/${encodeURIComponent(ge)}`}async function F(){try{const D=(await Sn(async()=>{const{default:ne}=await Promise.resolve().then(()=>jn);return{default:ne}},void 0)).default,P={...h||{}};let Q=null;const me=ne=>{if(!ne)return null;if(!ne.startsWith("http"))return ne;const ve=ne.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return ve?decodeURIComponent(ve[2]):null},ge=o?.logo??null;try{const ne=h&&h.logoFile instanceof File?h.logoFile:null,ve="logo";if(ne){const Ae=`logo/${P.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${ne.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,De=await D.storage.from(ve).upload(Ae,ne,{upsert:!0});if(De.error)throw De.error;const Me=De.data?.path??Ae;Q=Me,P.logo=Me}}catch(ne){console.warn("Logo upload error",ne)}try{P.logoFile&&delete P.logoFile}catch{}let O=null;try{if(o&&o.id){const{data:ne,error:ve}=await D.from("empresa").update(P).eq("id",o.id).select("*");if(ve)throw ve;O=Array.isArray(ne)?ne[0]??null:ne}else{const{data:ne,error:ve}=await D.from("empresa").insert(P).select("*");if(ve)throw ve;O=Array.isArray(ne)?ne[0]??null:ne}try{if(Q){const ne=me(ge);if(ne&&ne!==Q){const Se=await D.storage.from("logo").remove([ne]);Se.error&&console.warn("Failed to remove old company logo after DB update",Se.error)}}}catch(ne){console.warn("Error removing old logo after DB success",ne)}}catch(ne){try{if(Q){const Se=await D.storage.from("logo").remove([Q]);Se.error&&console.warn("Failed to remove uploaded logo after DB error",Se.error)}}catch(ve){console.warn("Error cleaning uploaded logo after DB failure",ve)}throw ne}a(O),g(O);try{console.debug("Empresa guardada, logo field:",O?.logo)}catch{}try{M(O?.logo??null)}catch{}try{U("Datos guardados"),be("Los datos de la empresa se guardaron correctamente."),C(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(O))}catch{}d(!1)}catch(D){console.error("Error guardando empresa en Supabase",D);try{T(D?.message||String(D))}catch{}try{const P={...h||{}};P.logoFile&&delete P.logoFile;const Q=!!(h&&h.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:P,needsLogo:Q,ts:Date.now()})),x(!0),b(P),R(Q),a(h);try{localStorage.setItem("companyData",JSON.stringify(h))}catch{}d(!1),U("Guardado localmente"),be("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),C(!0)}catch(P){console.error("Error saving locally",P)}}}async function pe(){const D=_;if(!D){U("Sin pendientes"),be("No hay datos pendientes para enviar"),C(!0);return}try{const P=(await Sn(async()=>{const{default:me}=await Promise.resolve().then(()=>jn);return{default:me}},void 0)).default;let Q=null;if(D.id){const{data:me,error:ge}=await P.from("empresa").update(D).eq("id",D.id).select("*");if(ge)throw ge;Q=Array.isArray(me)?me[0]??null:me}else{const{data:me,error:ge}=await P.from("empresa").insert(D).select("*");if(ge)throw ge;Q=Array.isArray(me)?me[0]??null:me}localStorage.removeItem("pendingCompanySave"),x(!1),b(null),R(!1),a(Q),g(Q),U("Sincronizado"),be("Los datos pendientes se sincronizaron con Supabase correctamente."),C(!0)}catch(P){console.error("Error reenviando datos pendientes",P),U("Error al reenviar"),be("No se pudo reenviar los datos a Supabase: "+(P?.message||String(P))),C(!0)}}function N(){try{localStorage.removeItem("pendingCompanySave"),x(!1),b(null),R(!1),U("Pendiente descartado"),be("El guardado pendiente fue descartado."),C(!0)}catch{}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?i.jsx("div",{children:"Cargando datos de la empresa..."}):o?i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?i.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",A?i.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(A)]}):null,w?i.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("button",{className:"btn-primary",onClick:pe,children:"Reintentar guardar en Supabase"}),i.jsx("button",{className:"btn-opaque",onClick:N,children:"Descartar pendiente"})]})]})}):null,I?i.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[i.jsx("strong",{children:"Logo guardado:"}),i.jsxs("div",{style:{marginTop:6},children:[i.jsx("a",{href:ee(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),i.jsx("div",{style:{color:"#374151",fontSize:12},children:String(I)})]})]}):null,i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:i.jsx("img",{src:u?_e??ee(!0):J??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),i.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"RTN:"})," ",u?i.jsx("input",{name:"rtn",value:h.rtn||"",onChange:E,className:"input"}):o.rtn]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Telfono:"})," ",u?i.jsx("input",{name:"telefono",value:h.telefono||"",onChange:E,className:"input"}):o.telefono]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Correo:"})," ",u?i.jsx("input",{name:"email",value:h.email||"",onChange:E,className:"input"}):o.email]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Direccin:"})," ",u?i.jsx("textarea",{name:"direccion",value:h.direccion||"",onChange:E,className:"input",style:{minHeight:64}}):o.direccion]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Logo (archivo o URL):"}),u?i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[i.jsx("input",{type:"file",accept:"image/*",onChange:z}),i.jsx("input",{name:"logo",value:h.logo||"",onChange:E,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):i.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?i.jsxs("div",{style:{marginTop:8},children:[i.jsx("small",{children:"Preview:"}),i.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:F,className:"btn-primary",children:"Guardar"}),i.jsx("button",{type:"button",onClick:Z,className:"btn-opaque",children:"Cancelar"})]}):i.jsx(i.Fragment,{children:i.jsx("button",{type:"button",onClick:W,className:"btn-primary",children:"Actualizar datos"})})})]}),i.jsx("div",{style:{flex:1,minWidth:320},children:i.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:i.jsx("img",{src:u?_e??ee(!0):J??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),i.jsxs("p",{style:{margin:0},children:["RTN: ",i.jsx("strong",{children:o.rtn})]}),i.jsxs("p",{style:{margin:0},children:["Telfono: ",i.jsx("strong",{children:o.telefono})]}),i.jsxs("p",{style:{marginTop:8},children:["Correo: ",i.jsx("strong",{children:o.email})]}),i.jsxs("p",{style:{marginTop:8},children:["Direccin: ",i.jsx("strong",{children:o.direccion})]})]})})]}):i.jsx("div",{children:"No se encontraron datos de la empresa."}),i.jsx(sm,{open:G,title:L,message:$,onClose:()=>C(!1)})]})}function jx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function Sx(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[_,b]=j.useState(""),[w,R]=j.useState(null),[A,T]=j.useState(""),[I,M]=j.useState(""),[G,C]=j.useState("");async function L(){l(!0),d(null);try{const{data:q,error:W}=await ie.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(W)throw W;a(Array.isArray(q)?q:[])}catch(q){d(q?.message||String(q)),a([])}finally{l(!1)}}async function U(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const q={username:p,password:v,role:"cajero"};_&&(q.nombre_usuario=_);const{error:W}=await ie.from("users").insert(q);if(W)throw W;m(""),x(""),b(""),await L()}catch(q){d(q?.message||String(q))}finally{l(!1)}}function $(q){R(q.id),T(q.username||""),C(q.nombre_usuario||""),M(""),d(null)}function be(){R(null),T(""),M(""),C(""),d(null)}async function J(){if(w!=null){if(!A)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const q={username:A};I&&(q.password=I),q.nombre_usuario=G||null;const{error:W}=await ie.from("users").update(q).eq("id",w);if(W)throw W;be(),await L()}catch(q){d(q?.message||String(q))}finally{l(!1)}}}async function ue(q,W){if(W!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:Z}=await ie.from("users").delete().eq("id",q);if(Z)throw Z;await L()}catch(Z){d(Z?.message||String(Z))}finally{l(!1)}}}j.useEffect(()=>{let q=!0;return(async()=>q&&await L())(),()=>{q=!1}},[]);const _e=o.filter(q=>{if(!h)return!0;const W=h.toLowerCase();return(q.username||"").toLowerCase().includes(W)||(String(q.id)||"").includes(W)||(q.role||"").toLowerCase().includes(W)||(q.nombre_usuario||"").toLowerCase().includes(W)});return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[i.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:h,onChange:q=>g(q.target.value),style:{minWidth:220}}),i.jsx("button",{onClick:()=>L(),className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${_e.length} usuarios`}),i.jsx("div",{style:{width:"100%",height:8}}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:q=>m(q.target.value)}),i.jsx("input",{placeholder:"Nombre",className:"input",value:_,onChange:q=>b(q.target.value)}),i.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:q=>x(q.target.value)}),i.jsx("button",{onClick:()=>U(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?i.jsx("div",{style:{color:"red",marginBottom:12},children:u}):i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Rol"})]})}),i.jsx("tbody",{children:_e.map(q=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:q.id}),i.jsx("td",{style:{minWidth:180},children:w===q.id?i.jsx("input",{className:"input",value:A,onChange:W=>T(W.target.value)}):q.username||"-"}),i.jsx("td",{style:{minWidth:180},children:w===q.id?i.jsx("input",{className:"input",value:G,onChange:W=>C(W.target.value)}):q.nombre_usuario||"-"}),i.jsx("td",{style:{width:220},children:w===q.id?i.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:I,onChange:W=>M(W.target.value)}):q.role||"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:w===q.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>J(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),i.jsx("button",{onClick:()=>be(),className:"btn-opaque",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>$(q),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),q.role==="cajero"?i.jsx("button",{onClick:()=>ue(q.id,q.role),className:"btn-danger",children:"Eliminar"}):i.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},q.id))})]}),_e.length===0&&!s&&i.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function wx({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:h}){const[g,p]=j.useState(null),[m,v]=j.useState(null),[x,_]=j.useState(!1),[b,w]=j.useState(null),[R,A]=j.useState(""),[T,I]=j.useState(""),[M,G]=j.useState(""),[C,L]=j.useState(""),[U,$]=j.useState(null),[be,J]=j.useState(""),[ue,_e]=j.useState(!1),[q,W]=j.useState(null);if(j.useEffect(()=>{if(!o||!s)return;w(s.caja??null),A(s.cai??""),J(s.identificador??""),I(s.rango_de??""),G(s.rango_hasta??""),L(s.fecha_vencimiento??""),$(s.secuencia_actual??null);const E=s.cajero??null;if(E){const z=l.find(ee=>ee.username===E||ee.nombre_usuario===E);z?(p(z.id),v(null),_(!1)):(p(null),v(E),_(!0))}else p(null),v(null),_(!1);W(null)},[o,s,l]),!o||!s)return null;async function Z(){if(!s){W("Registro invlido");return}if(b!=null&&(b<1||b>5)){W("La caja debe estar entre 1 y 5");return}_e(!0),W(null);try{const E={cai:R??null,identificador:be??null,rango_de:T??null,rango_hasta:M??null,fecha_vencimiento:C??null,secuencia_actual:U??null,caja:b??null};if(g!=null){const z=l.find(ee=>ee.id===g);E.cajero=z?z.username:null,E.usuario_id=z?z.id:null}else E.cajero=m??null,E.usuario_id=null;await h(s.id,E),a()}catch(E){W(E?.message||String(E))}finally{_e(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:R,onChange:E=>A(E.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:be,onChange:E=>J(E.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:T,onChange:E=>I(E.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:M,onChange:E=>G(E.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:C,onChange:E=>L(E.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:U??"",onChange:E=>$(E.target.value===""?null:E.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):x?"__custom__":"",onChange:E=>{const z=E.target.value;z===""?(p(null),v(null),_(!1)):z==="__custom__"?(p(null),_(!0)):/^\d+$/.test(z)&&(p(Number(z)),v(null),_(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(E=>i.jsxs("option",{value:String(E.id),children:[E.username,E.nombre_usuario?`  ${E.nombre_usuario}`:""]},E.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),x&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:E=>{v(E.target.value),p(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:E=>w(E.target.value===""?null:Number(E.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(E=>i.jsx("option",{value:E,children:E},E))]})]})]})]})]}),q&&i.jsx("div",{style:{color:"red",marginTop:12},children:q}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:ue,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:Z,disabled:ue,style:{width:"auto",padding:"8px 14px"},children:ue?"Guardando...":"Guardar"})]})]})})}function Ex({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[h,g]=j.useState(null),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,R]=j.useState(""),[A,T]=j.useState(""),[I,M]=j.useState(""),[G,C]=j.useState(""),[L,U]=j.useState(null),[$,be]=j.useState(""),[J,ue]=j.useState(!1),[_e,q]=j.useState(null);if(!o)return null;async function W(){const Z=[];if(w||Z.push("CAI"),A||Z.push("Rango Desde"),I||Z.push("Rango Hasta"),G||Z.push("Fecha de Vencimiento"),_==null&&Z.push("Caja"),h==null&&!p&&Z.push("Cajero"),Z.length>0){q(`Campos obligatorios faltantes: ${Z.join(", ")}`);return}if(_!=null&&(_<1||_>5)){q("La caja debe estar entre 1 y 5");return}ue(!0),q(null);try{const E={cai:w??null,identificador:$??null,rango_de:A??null,rango_hasta:I??null,fecha_vencimiento:G??null,secuencia_actual:L??null,caja:_??null};if(h!=null){const z=s.find(ee=>ee.id===h);E.cajero=z?z.username:null,E.usuario_id=z?z.id:null}else E.cajero=p??null,E.usuario_id=null;await d(E),a()}catch(E){q(E?.message||String(E))}finally{ue(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:w,onChange:Z=>R(Z.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:$,onChange:Z=>be(Z.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:A,onChange:Z=>T(Z.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:I,onChange:Z=>M(Z.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:G,onChange:Z=>C(Z.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:L??"",onChange:Z=>U(Z.target.value===""?null:Z.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:h!=null?String(h):v?"__custom__":"",onChange:Z=>{const E=Z.target.value;E===""?(g(null),m(null),x(!1)):E==="__custom__"?(g(null),x(!0)):/^\d+$/.test(E)&&(g(Number(E)),m(null),x(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(Z=>i.jsxs("option",{value:String(Z.id),children:[Z.username,Z.nombre_usuario?`  ${Z.nombre_usuario}`:""]},Z.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:Z=>{m(Z.target.value),g(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:_??"",onChange:Z=>b(Z.target.value===""?null:Number(Z.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(Z=>i.jsx("option",{value:Z,children:Z},Z))]})]})]})]})]}),_e&&i.jsx("div",{style:{color:"red",marginTop:12},children:_e}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:J,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:W,disabled:J,style:{width:"auto",padding:"8px 14px"},children:J?"Creando...":"Crear"})]})]})})}function Cx(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(!1);async function w(){l(!0),d(null);try{const{data:C,error:L}=await ie.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(C)?C:[])}catch(C){d(C?.message||String(C)),a([])}finally{l(!1)}}async function R(){try{const{data:C}=await ie.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(C)?C:[])}catch{}}j.useEffect(()=>{w(),R()},[]);const A=new Set(o.filter(C=>C.cajero).map(C=>String(C.cajero))),T=new Set(o.filter(C=>C.caja!=null).map(C=>Number(C.caja)));function I(C){m(C),x(!0),d(null)}function M(){x(!1),m(null)}async function G(C,L){l(!0),d(null);try{const{error:U}=await ie.from("cai").update(L).eq("id",C);if(U)throw U;await w()}catch(U){throw d(U?.message||String(U)),U}finally{l(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"CAI"}),i.jsx("th",{children:"Identificador"}),i.jsx("th",{children:"Rango Desde"}),i.jsx("th",{children:"Rango Hasta"}),i.jsx("th",{children:"Vencimiento"}),i.jsx("th",{children:"Secuencia actual"}),i.jsx("th",{children:"Cajero"}),i.jsx("th",{children:"Usuario ID"}),i.jsx("th",{children:"Caja"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(C=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:C.id}),i.jsx("td",{style:{minWidth:200},children:C.cai}),i.jsx("td",{style:{minWidth:160},children:C.identificador??"-"}),i.jsx("td",{children:C.rango_de}),i.jsx("td",{children:C.rango_hasta}),i.jsx("td",{children:C.fecha_vencimiento}),i.jsx("td",{children:C.secuencia_actual??"-"}),i.jsx("td",{style:{minWidth:180},children:C.cajero||"-"}),i.jsx("td",{style:{minWidth:160},children:C.usuario_id??"-"}),i.jsx("td",{style:{width:120},children:C.caja??"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx(i.Fragment,{children:i.jsx("button",{onClick:()=>I(C),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},C.id))})]}),o.length===0&&!s&&i.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),i.jsx(wx,{open:v,onClose:M,row:p,cajeros:h,availableCajeros:p?h.filter(C=>!A.has(C.username)||C.username===p.cajero):h.filter(C=>!A.has(C.username)),availableCajas:p?[1,2,3,4,5].filter(C=>!T.has(C)||C===p.caja):[1,2,3,4,5].filter(C=>!T.has(C)),onSave:G}),i.jsx(Ex,{open:_,onClose:()=>b(!1),cajeros:h,availableCajeros:h.filter(C=>!A.has(C.username)),availableCajas:[1,2,3,4,5].filter(C=>!T.has(C)),onCreate:async C=>{l(!0),d(null);try{const{error:L}=await ie.from("cai").insert(C);if(L)throw L;await w(),b(!1)}catch(L){throw d(L?.message||String(L)),L}finally{l(!1)}}})]})}function Tx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function Ax(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),i.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Hu=fp();function Nx({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,h]=Ou.useState(!1);if(!o)return null;const g=async()=>{try{h(!0),await u()}finally{h(!1)}};return Hu.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("p",{children:s}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),i.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function Rx({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[h,g]=j.useState({}),[p,m]=j.useState(!1),[v,x]=j.useState(null);if(j.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?x(l.imagen):x(null)},[l,o]),!o)return null;const _=(A,T)=>{g(I=>({...I,[A]:T}))},b=async A=>{A.preventDefault();try{m(!0),await d(h)}finally{m(!1)}},w=A=>A==="creado_en"?null:A==="id"?i.jsx("input",{className:"input",value:h[A]??"",readOnly:!0}):A.includes("publicacion")||A.includes("exento")||A.includes("aplica_impuesto")||A==="publicacion_web"?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("label",{className:"switch",children:[i.jsx("input",{type:"checkbox",checked:!!h[A],onChange:T=>_(A,T.target.checked)}),i.jsx("span",{className:"slider"})]}),i.jsx("span",{style:{fontSize:13},children:h[A]?"S":"No"})]}):A.includes("categoria")||A.includes("marca")?i.jsx("input",{type:"text",className:"input",value:h[A]??"",onChange:T=>_(A,T.target.value===""?null:T.target.value)}):A==="imagen"?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?i.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,i.jsx("input",{type:"file",accept:"image/*",onChange:T=>{const I=T.target.files&&T.target.files[0];if(_(A,I??null),I)try{const M=URL.createObjectURL(I);x(M)}catch{x(null)}else x(null)}}),v?i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{_(A,null),x(null)},children:"Eliminar imagen"}):null]}):i.jsx("input",{className:"input",value:h[A]??"",onChange:T=>_(A,T.target.value)}),R=i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsxs("form",{onSubmit:b,children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(A=>i.jsxs("label",{style:{display:"block"},children:[i.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(A).replace(/_/g," ").toUpperCase()}),w(A)]},A))}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Hu.createPortal(R,typeof document<"u"&&document.body||document.createElement("div"))}function Ox({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const h=a||{},[g,p]=j.useState(null),[m,v]=j.useState(null),[x,_]=j.useState(null),[b,w]=j.useState(null);return j.useEffect(()=>{let R=!0;return(async()=>{const T=typeof h.imagen=="string"?h.imagen:null;if(!T){R&&p(null);return}if(T.startsWith("http")){R&&(p(T),_(T));return}let I=T;const M=String(T).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);M&&(I=decodeURIComponent(M[2]));const G="inventario";try{const C=(await Sn(async()=>{const{default:J}=await Promise.resolve().then(()=>jn);return{default:J}},void 0)).default,L=await C.storage.from(G).getPublicUrl(I),U=L?.data?.publicUrl||L?.data?.publicURL||null;if(U){R&&(p(U),_(U));return}const $=await C.storage.from(G).createSignedUrl(I,3600*24*7);if($.error){console.warn("ProductDetailModal createSignedUrl error",$.error),R&&p(null);return}const be=$.data?.signedUrl??null;R&&(p(be),_(be))}catch(C){console.error("ProductDetailModal resolve error",C),R&&p(null)}})(),()=>{R=!1}},[h]),j.useEffect(()=>{let R=!0;return(async()=>{if(w(null),!!x)try{const T=await fetch(x,{method:"HEAD"});if(!R)return;w(`HEAD ${T.status} ${T.statusText} - content-type: ${T.headers.get("content-type")}`)}catch(T){if(!R)return;w(`FETCH_ERROR: ${String(T)}`)}})(),()=>{R=!1}},[x]),Hu.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:s}),i.jsxs("div",{style:{display:"flex",gap:18},children:[i.jsx("div",{style:{flex:1},children:i.jsx("table",{style:{width:"100%"},children:i.jsx("tbody",{children:Object.keys(h).map(R=>{const A=h[R];return R==="imagen"&&typeof A=="string"?null:i.jsxs("tr",{children:[i.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(R).replace(/_/g," ").toUpperCase()}),i.jsx("td",{style:{padding:6},children:String(A??"-")})]},R)})})})}),i.jsx("div",{style:{width:280,textAlign:"center"},children:g?i.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:R=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?i.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[i.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),i.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):i.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(h),children:"Editar"}),i.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(h.id),children:"Eliminar"}),i.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function kx({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:h,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:x=[]}){const[_,b]=j.useState(null),[w,R]=j.useState(!1),[A,T]=j.useState(null),[I,M]=j.useState(""),[G,C]=j.useState(!1),[L,U]=j.useState("add"),[$,be]=j.useState({}),[J,ue]=j.useState(!1),[_e,q]=j.useState(null),[W,Z]=j.useState(!1),[E,z]=j.useState(null),ee=j.useRef(!0),F=async()=>{R(!0),T(null);try{const ge=(await Sn(async()=>{const{default:Se}=await Promise.resolve().then(()=>jn);return{default:Se}},void 0)).default,O=a||"*";let ne=ge.from(o).select(O).limit(l);h&&(Array.isArray(h)?h:String(h).split(",").map(Ae=>Ae.trim()).filter(Boolean)).forEach(Ae=>{const De=Ae.split(" ").map(gt=>gt.trim()).filter(Boolean),Me=De[0],Ye=De[1]?De[1].toLowerCase():"asc";ne=ne.order(Me,{ascending:Ye!=="desc"})}),g&&Object.entries(g).forEach(([Se,Ae])=>{Ae==null||Ae===""||(ne=ne.eq(Se,Ae))});const ve=await ne;if(console.debug("SupabaseTable fetch result for",o,ve),!ee.current)return;if(ve.error)throw ve.error;b(Array.isArray(ve.data)?ve.data:[])}catch(ge){console.error("SupabaseTable error",ge),T(ge?.message||String(ge)),b([])}finally{ee.current&&R(!1)}};j.useEffect(()=>(ee.current=!0,F(),()=>{ee.current=!1}),[o,a,l]);const pe=j.useMemo(()=>u&&u.length>0?u:!_||_.length===0?[]:Object.keys(_[0]),[u,_]),N=j.useMemo(()=>{if(!_)return null;const ge=(I||"").toString().trim().toLowerCase();if(!ge)return _;const O=d&&d.length>0?d:pe;return _.filter(ne=>O.some(ve=>{const Se=ne?.[ve];return Se==null?!1:String(Se).toLowerCase().includes(ge)}))},[_,I,d,pe]),D=()=>{p&&(U("add"),be({}),C(!0))},P=ge=>{m&&(U("edit"),be(ge),C(!0))},Q=async ge=>{const O=(await Sn(async()=>{const{default:ne}=await Promise.resolve().then(()=>jn);return{default:ne}},void 0)).default;try{const ne="inventario",ve={...ge},Se=L==="edit"?$?.imagen??null:null,Ae=De=>{if(!De)return null;if(!De.startsWith("http"))return De;const Me=De.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Me?decodeURIComponent(Me[2]):null};if(ve.imagen&&ve.imagen instanceof File){const De=ve.imagen,Me=ve.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Ye=`${o}/${Me}/${Date.now()}_${De.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,gt=await O.storage.from(ne).upload(Ye,De,{upsert:!0});if(gt.error)throw gt.error;const pt=gt.data?.path??Ye;ve.imagen=pt;try{const dt=Ae(Se);if(dt&&dt!==pt){const wt=await O.storage.from(ne).remove([dt]);wt.error&&console.warn("Failed to remove old image",wt.error)}}catch(dt){console.warn("Error removing old image",dt)}}if(L==="edit"&&(ve.imagen==null||ve.imagen===""))try{const De=Ae($?.imagen??null);if(De){const Me=await O.storage.from(ne).remove([De]);Me.error&&console.warn("Failed to remove old image on clear",Me.error)}}catch(De){console.warn("Error removing old image on clear",De)}if(L==="add"){const{error:De}=await O.from(o).insert([ve]);if(De)throw De}else{const De=ve.id,Me={...ve};delete Me.id;const{error:Ye}=await O.from(o).update(Me).eq("id",De);if(Ye)throw Ye}C(!1),await F()}catch(ne){console.error("Error saving",ne),T(ne?.message||String(ne))}},me=async()=>{if(_e==null)return;const ge=(await Sn(async()=>{const{default:O}=await Promise.resolve().then(()=>jn);return{default:O}},void 0)).default;try{if(!v)return;try{const ne="inventario",ve=_?.find(Me=>Me.id===_e),Se=Me=>{if(!Me)return null;if(!Me.startsWith("http"))return Me;const Ye=Me.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Ye?decodeURIComponent(Ye[2]):null},Ae=ve?.imagen??null,De=Se(Ae);if(De){const Me=await ge.storage.from(ne).remove([De]);Me.error&&console.warn("Failed to remove image on delete",Me.error)}}catch(ne){console.warn("Error removing image before delete",ne)}const{error:O}=await ge.from(o).delete().eq("id",_e);if(O)throw O;ue(!1),q(null),await F()}catch(O){console.error("Error deleting",O),T(O?.message||String(O))}};return i.jsxs("div",{style:{padding:18},children:[s?i.jsx("h2",{style:{marginTop:0},children:s}):null,i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("input",{placeholder:"Buscar...",value:I,onChange:ge=>M(ge.target.value),className:"input",style:{minWidth:240}}),i.jsx("button",{onClick:()=>{T(null),M(""),F()},className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto"},children:i.jsx("button",{onClick:D,className:"btn-primary",children:"Agregar"})})]}),w&&i.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),A&&i.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",A]}),!w&&_&&_.length===0&&i.jsxs("div",{children:["No hay registros en la tabla ",i.jsx("strong",{children:o}),"."]}),!w&&N&&N.length>0&&i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[pe.map(ge=>i.jsx("th",{children:String(ge).replace(/_/g," ").toUpperCase()},ge)),i.jsx("th",{style:{width:140},children:"Acciones"})]})}),i.jsx("tbody",{children:N.map((ge,O)=>i.jsxs("tr",{children:[pe.map(ne=>{if(ne==="imagen"){const ve=ge?.imagen??null;return ve||console.debug("SupabaseTable: row has no imagen for id",ge?.id,ge),i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:ve?i.jsx(lm,{src:String(ve)}):i.jsx("span",{style:{color:"#6b7280"},children:"-"})},ne)}return i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:zx(ge[ne])},ne)}),i.jsx("td",{className:"admin-actions",children:i.jsx("button",{className:"btn-opaque",onClick:()=>{z(ge),Z(!0)},children:"Ver"})})]},ge.id??O))})]})}),i.jsx(Rx,{open:G,title:L==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:pe.filter(ge=>!x.includes(ge)),initialData:$,onClose:()=>C(!1),onSave:Q}),i.jsx(Ox,{open:W,data:E,title:`Detalle de ${o}`,onClose:()=>Z(!1),onEdit:ge=>{Z(!1),P(ge)},onDeleteClick:ge=>{Z(!1),q(ge),ue(!0)}}),i.jsx(Nx,{open:J,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>ue(!1),onConfirm:me})]})}function zx(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return i.jsx(lm,{src:o})}return String(o)}function lm({src:o}){const[a,s]=j.useState(null),[l,u]=j.useState(null);return j.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await Sn(async()=>{const{default:R}=await Promise.resolve().then(()=>jn);return{default:R}},void 0)).default,v="inventario",x=await m.storage.from(v).getPublicUrl(g),_=x?.data?.publicUrl||x?.data?.publicURL||null;if(_){d&&s(_);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const w=b.data?.signedUrl??null;d&&s(w)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?i.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:i.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function Ux(){const[o,a]=j.useState(null),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]);return j.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await Sn(async()=>{const{default:U}=await Promise.resolve().then(()=>jn);return{default:U}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],R=new Set(w.map(U=>U.categoria??"").filter(Boolean)),A=new Set(w.map(U=>U.marca??"").filter(Boolean)),T=w.length,I=w.filter(U=>!!U.publicacion_web).length,M=U=>{if(U==null)return!1;if(typeof U=="boolean")return U===!0;if(typeof U=="number")return U===1;const $=String(U).toLowerCase().trim();return $==="1"||$==="true"||$==="t"||$==="si"||$==="s"||$==="yes"},G=w.filter(U=>M(U.exento)).length,C=w.filter(U=>M(U.aplica_impuesto_18)).length,L=w.filter(U=>M(U.aplica_impuesto_turistico)).length;a({categorias:R.size,marcas:A.size,items:T,publicadas:I,exentos:G,aplica_impuesto_18:C,aplica_impuesto_turistico:L}),g(Array.from(R).sort()),m(Array.from(A).sort())}catch(_){console.error("Error loading inventario summary",_)}})(),()=>{v=!1}},[]),i.jsxs("div",{children:[i.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[i.jsx(si,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),i.jsx(si,{label:"Marcas",value:o?String(o.marcas):"..."}),i.jsx(si,{label:"Items",value:o?String(o.items):"..."}),i.jsx(si,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),i.jsx(si,{label:"Exentos",value:o?String(o.exentos):"..."}),i.jsx(si,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),i.jsx(si,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),i.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),h.map(v=>i.jsx("option",{value:v,children:v},v))]})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),i.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),p.map(v=>i.jsx("option",{value:v,children:v},v))]})]}),i.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),i.jsx(kx,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function si({label:o,value:a}){return i.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),i.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function Dx({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,h]=j.useState(null),[g,p]=j.useState(""),[m,v]=j.useState(!1),[x,_]=j.useState(null),[b,w]=j.useState(null),[R,A]=j.useState(null),[T,I]=j.useState(null),[M,G]=j.useState(null),[C,L]=j.useState(null),[U,$]=j.useState(null),[be,J]=j.useState(null),[ue,_e]=j.useState(null),[q,W]=j.useState(!1);j.useEffect(()=>{o&&(h(null),p(""),w(null),A(null),I(null),J(null),_e(null),_(null))},[o]);async function Z(){const z=[];if(d||z.push("Producto"),g||z.push("Precio"),z.length>0){_(`Faltan campos: ${z.join(", ")}`);return}const ee=Number(g);if(isNaN(ee)||ee<0){_("Precio invlido");return}v(!0),_(null);try{await u({producto_id:d,precio:g});try{const F={};if(M!==null&&(F.exento=M),C!==null&&(F.aplica_impuesto_18=C),U!==null&&(F.aplica_impuesto_turistico=U),Object.keys(F).length>0){const{error:pe}=await ie.from("inventario").update(F).eq("id",d);pe&&console.warn("Error actualizando inventario flags:",pe)}}catch(F){console.warn("Error al persistir flags en inventario:",F)}a()}catch(F){_(F?.message||String(F))}finally{v(!1)}}function E(z){return z?Number(z.replace(",",".")):NaN}return j.useEffect(()=>{let z=!0;async function ee(){if(w(null),A(null),I(null),J(null),_e(null),!d)return;const F=E(g);if(!isNaN(F)){W(!0);try{const{data:pe,error:N}=await ie.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(N)throw N;const D=Array.isArray(pe)?pe.map(Ze=>Number(Ze.costo_unitario)).filter(Ze=>!isNaN(Ze)):[],P=D.length>0?D.reduce((Ze,et)=>Ze+et,0)/D.length:0;if(!z)return;w(P);let Q=!1,me=!1,ge=!1;try{const{data:Ze,error:et}=await ie.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!et&&Ze&&(Q=!!Ze.exento,me=!!Ze.aplica_impuesto_18,ge=!!Ze.aplica_impuesto_turistico,M===null&&G(Q),C===null&&L(me),U===null&&$(ge))}catch{}const{data:O}=await ie.from("impuesto").select("id, impuesto_venta"),ne={};Array.isArray(O)&&O.forEach(Ze=>{ne[String(Ze.id)]=Number(Ze.impuesto_venta)});const ve=M!==null?M:Q,Se=C!==null?C:me,Ae=U!==null?U:ge;let De=0;ve?De=0:Se?De=ne[2]??ne[1]??0:De=ne[1]??0;let Me=0;Ae&&(Me=ne[3]??0);const Ye=(De||0)+(Me||0),gt=Ye>1?Ye/100:Ye,pt=F*gt;A(Ye),I(pt);const dt=F-P,wt=P>0?dt/P*100:null;J(wt);const Ht=F>0?(F-P-pt)/F*100:null;_e(Ht)}catch{}finally{z&&W(!1)}}}return ee(),()=>{z=!1}},[d,g,M,C,U]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:d??"",onChange:z=>h(z.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(z=>i.jsx("option",{value:z.id,children:z.nombre},z.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!M,onChange:z=>G(z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!C,onChange:z=>L(z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!U,onChange:z=>$(z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:g,onChange:z=>p(z.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:T==null?"":T.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:be==null?"":be.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:ue==null?"":ue.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&i.jsx("div",{style:{color:"red",marginTop:12},children:x}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:Z,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function Bx({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[h,g]=j.useState(null),[p,m]=j.useState(""),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,R]=j.useState(null),[A,T]=j.useState(null),[I,M]=j.useState(null),[G,C]=j.useState(null),[L,U]=j.useState(null),[$,be]=j.useState(null),[J,ue]=j.useState(null),[_e,q]=j.useState(null),[W,Z]=j.useState(!1);j.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const ee=Number(s.precio);m(isNaN(ee)?String(s.precio):ee.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function E(ee){return ee?Number(ee.replace(",",".")):NaN}if(j.useEffect(()=>{let ee=!0;async function F(){if(R(null),T(null),M(null),ue(null),q(null),!o||!s||!h)return;const pe=E(p);if(!isNaN(pe)){Z(!0);try{const{data:N,error:D}=await ie.from("compras_detalle").select("costo_unitario").eq("producto_id",h);if(D)throw D;const P=Array.isArray(N)?N.map(et=>Number(et.costo_unitario)).filter(et=>!isNaN(et)):[],Q=P.length>0?P.reduce((et,za)=>et+za,0)/P.length:0;if(!ee)return;R(Q);let me=!1,ge=!1,O=!1;try{const{data:et,error:za}=await ie.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",h).single();!za&&et&&(me=!!et.exento,ge=!!et.aplica_impuesto_18,O=!!et.aplica_impuesto_turistico,G===null&&C(me),L===null&&U(ge),$===null&&be(O))}catch{}const{data:ne}=await ie.from("impuesto").select("id, impuesto_venta"),ve={};Array.isArray(ne)&&ne.forEach(et=>ve[String(et.id)]=Number(et.impuesto_venta));const Se=G!==null?G:me,Ae=L!==null?L:ge,De=$!==null?$:O;let Me=0;Se?Me=0:Ae?Me=ve[2]??ve[1]??0:Me=ve[1]??0;let Ye=0;De&&(Ye=ve[3]??0);const gt=(Me||0)+(Ye||0),pt=gt>1?gt/100:gt,dt=pe*pt;T(gt),M(dt);const wt=pe-Q,Ht=Q>0?wt/Q*100:null;ue(Ht);const Ze=pe>0?(pe-Q-dt)/pe*100:null;q(Ze)}catch{}finally{ee&&Z(!1)}}}return F(),()=>{ee=!1}},[o,s,h,p,G,L,$]),!o||!s)return null;async function z(){const ee=[];if(h||ee.push("Producto"),p||ee.push("Precio"),ee.length>0){b(`Faltan campos: ${ee.join(", ")}`);return}const F=Number(p);if(isNaN(F)||F<0){b("Precio invlido");return}x(!0),b(null);try{const pe=s.id;await d(pe,{producto_id:h,precio:p});try{const N={};if(G!==null&&(N.exento=G),L!==null&&(N.aplica_impuesto_18=L),$!==null&&(N.aplica_impuesto_turistico=$),Object.keys(N).length>0&&h){const{error:D}=await ie.from("inventario").update(N).eq("id",h);D&&console.warn("Error actualizando inventario flags:",D)}}catch(N){console.warn("Error al persistir flags en inventario:",N)}a()}catch(pe){b(pe?.message||String(pe))}finally{x(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:h??"",onChange:ee=>g(ee.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(ee=>i.jsx("option",{value:ee.id,children:ee.nombre},ee.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!G,onChange:ee=>C(ee.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!L,onChange:ee=>U(ee.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!$,onChange:ee=>be(ee.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:p,onChange:ee=>m(ee.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:I==null?"":I.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:J==null?"":J.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:_e==null?"":_e.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&i.jsx("div",{style:{color:"red",marginTop:12},children:_}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:z,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function Lx(){const[o,a]=j.useState([]),[s,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[_,b]=j.useState(null);async function w(){d(!0),g(null);try{const{data:C,error:L}=await ie.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(C)?C:[])}catch(C){g(C?.message||String(C)),a([])}finally{d(!1)}}async function R(){try{const{data:C}=await ie.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(C)?C:[])}catch{}}j.useEffect(()=>{w(),R()},[]);const A=new Set(o.map(C=>String(C.producto_id))),T=s.filter(C=>!A.has(C.id));function I(C){b(C),x(!0),g(null)}async function M(C){d(!0),g(null);try{const{error:L}=await ie.from("precios").insert(C);if(L)throw L;try{const U={producto_id:C.producto_id,precio:C.precio},{error:$}=await ie.from("precios_historico").insert(U);$&&console.warn("No se pudo insertar en precios_historico",$)}catch(U){console.warn("Error registrando precios_historico",U)}await w()}catch(L){throw g(L?.message||String(L)),L}finally{d(!1)}}async function G(C,L){d(!0),g(null);try{const{error:U}=await ie.from("precios").update(L).eq("id",C);if(U)throw U;let $=L.producto_id,be=L.precio;if(!$||be===void 0)try{const{data:J}=await ie.from("precios").select("producto_id, precio").eq("id",C).limit(1).single();J&&($=$||J.producto_id,be=be===void 0?J.precio:be)}catch{}try{if($&&be!==void 0){const J={producto_id:$,precio:be},{error:ue}=await ie.from("precios_historico").insert(J);ue&&console.warn("No se pudo insertar en precios_historico",ue)}}catch(J){console.warn("Error registrando precios_historico",J)}await w()}catch(U){throw g(U?.message||String(U)),U}finally{d(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{w(),R()},children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),h&&i.jsx("div",{style:{color:"red",marginBottom:12},children:h}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(C=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:C.id}),i.jsx("td",{style:{minWidth:220},children:s.find(L=>L.id===C.producto_id)?.nombre||C.producto_id}),i.jsx("td",{children:C.precio}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>I(C),children:"Editar"})})]},C.id))})]})}),i.jsx(Dx,{open:p,onClose:()=>m(!1),products:T,onCreate:async C=>{await M(C),m(!1)}}),i.jsx(Bx,{open:v,onClose:()=>{x(!1),b(null)},row:_,products:s,availableProducts:[...s.filter(C=>!A.has(C.id)),..._?s.filter(C=>C.id===_.producto_id):[]],onSave:async(C,L)=>{await G(C,L),x(!1),b(null)}})]})}function Mx(){const[o,a]=j.useState(""),[s,l]=j.useState([]),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(!1),[v,x]=j.useState(null);async function _(){if(x(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:R}=await ie.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(R)throw R;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const A=w[0].id;d(A),await b(A)}}catch(w){x(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),x(null);try{const{data:R,error:A}=await ie.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(A)throw A;g(Array.isArray(R)?R:[])}catch(R){x(R?.message||String(R)),g([])}finally{m(!1)}}return j.useEffect(()=>{u&&b(u)},[u]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>_(),children:"Buscar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${h.length} registros`})]}),v&&i.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),i.jsx("ul",{children:s.map(w=>i.jsxs("li",{style:{marginBottom:6},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),i.jsx("strong",{children:w.nombre})," ",i.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Actualizacion"})]})}),i.jsx("tbody",{children:h.map(w=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(w.id)}),i.jsx("td",{style:{minWidth:220},children:s.find(R=>R.id===w.producto_id)?.nombre||w.producto_id}),i.jsx("td",{children:Number(w.precio).toFixed(2)}),i.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function qx(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState({}),[v,x]=j.useState({}),[_,b]=j.useState(!1),[w,R]=j.useState(null);async function A(){b(!0),R(null);try{let T=ie.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(T=T.ilike("sku",`%${o}%`)),s&&(T=T.ilike("marca",`%${s}%`)),u&&(T=T.ilike("modelo",`%${u}%`));const{data:I,error:M}=await T.order("nombre",{ascending:!0});if(M)throw M;const G=Array.isArray(I)?I:[];g(G);const C=G.map(J=>J.id);if(C.length===0){m({});return}const{data:L,error:U}=await ie.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",C);if(U)throw U;const $=Array.isArray(L)?L:[],be={};for(const J of G)be[String(J.id)]=0;for(const J of $){const ue=String(J.producto_id),_e=Number(J.cantidad)||0,q=String(J.tipo_de_movimiento||"").toUpperCase();be.hasOwnProperty(ue)||(be[ue]=0),q==="ENTRADA"?be[ue]=(be[ue]||0)+_e:q==="SALIDA"&&(be[ue]=(be[ue]||0)-_e)}for(const J of Object.keys(be))be[J]=Number((be[J]||0).toFixed(2));m(be);try{const J=(await Sn(async()=>{const{default:q}=await Promise.resolve().then(()=>jn);return{default:q}},void 0)).default,ue="inventario",_e={};await Promise.all(G.map(async q=>{const W=q.imagen;if(!W){_e[String(q.id)]=null;return}const Z=String(W);if(Z.startsWith("http")){_e[String(q.id)]=Z;return}let E=Z;const z=String(Z).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);z&&(E=decodeURIComponent(z[2]));try{const ee=await J.storage.from(ue).getPublicUrl(E),F=ee?.data?.publicUrl||ee?.data?.publicURL||null;if(F){_e[String(q.id)]=F;return}}catch{}try{const F=(await J.storage.from(ue).createSignedUrl(E,604800))?.data?.signedUrl??null;_e[String(q.id)]=F}catch{_e[String(q.id)]=null}})),x(_e)}catch{}}catch(T){R(T?.message||String(T)),g([]),m({})}finally{b(!1)}}return j.useEffect(()=>{A()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Stock"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:T=>a(T.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:T=>l(T.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:T=>d(T.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>A(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),A()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:_?"Cargando...":`${h.length} productos`})]}),w&&i.jsx("div",{style:{color:"red",marginBottom:12},children:w}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Imagen"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Marca"}),i.jsx("th",{children:"Modelo"}),i.jsx("th",{children:"Descripcin"}),i.jsx("th",{children:"Stock"})]})}),i.jsx("tbody",{children:h.map(T=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:v[String(T.id)]?i.jsx("img",{src:encodeURI(v[String(T.id)]),alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):T.imagen?i.jsx("img",{src:T.imagen,alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):""}),i.jsx("td",{children:T.sku||""}),i.jsx("td",{children:T.marca||""}),i.jsx("td",{children:T.modelo||""}),i.jsx("td",{style:{maxWidth:320},children:T.descripcion||""}),i.jsx("td",{style:{textAlign:"right"},children:p[String(T.id)]!=null?String(p[String(T.id)]):"0"})]},T.id))})]})]})]})}function Ix(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]),[v,x]=j.useState(!1),[_,b]=j.useState([]),[w,R]=j.useState({}),[A,T]=j.useState(!1),[I,M]=j.useState(null);async function G(){T(!0),M(null),b([]);try{let $=null;if(o||s||u){let W=ie.from("inventario").select("id").order("nombre",{ascending:!0});o&&(W=W.ilike("sku",`%${o}%`)),s&&(W=W.ilike("marca",`%${s}%`)),u&&(W=W.ilike("categoria",`%${u}%`));const{data:Z,error:E}=await W;if(E)throw E;if($=Array.isArray(Z)?Z.map(z=>String(z.id)):[],$.length===0){b([]),R({}),T(!1);return}}let be=ie.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if($&&(be=be.in("producto_id",$)),v){const W=new Date(Date.now()-864e5).toISOString();be=be.gte("fecha_salida",W)}be=be.order("fecha_salida",{ascending:!1});const{data:J,error:ue}=await be;if(ue)throw ue;const _e=Array.isArray(J)?J.map(W=>({id:W.id,producto_id:String(W.producto_id),cantidad:Number(W.cantidad),tipo_de_movimiento:W.tipo_de_movimiento,referencia:W.referencia,usuario:W.usuario,fecha_salida:W.fecha_salida})):[];b(_e);const q=Array.from(new Set(_e.map(W=>W.producto_id))).filter(Boolean);if(q.length>0){const{data:W}=await ie.from("inventario").select("id, nombre, sku, marca, categoria").in("id",q),Z={};Array.isArray(W)&&W.forEach(E=>{Z[String(E.id)]={id:E.id,nombre:E.nombre,sku:E.sku,marca:E.marca,categoria:E.categoria}}),R(Z)}else R({})}catch($){M($?.message||String($)),b([])}finally{T(!1)}}async function C(){try{const{data:$,error:be}=await ie.from("inventario").select("marca, categoria");if(be)throw be;const J=new Set,ue=new Set;Array.isArray($)&&$.forEach(_e=>{_e.marca&&J.add(String(_e.marca)),_e.categoria&&ue.add(String(_e.categoria))}),g(Array.from(J).sort()),m(Array.from(ue).sort())}catch($){console.warn("Error loading filter options",$)}}j.useEffect(()=>{G(),C()},[]);const L=_.filter($=>String($.tipo_de_movimiento).toUpperCase()==="ENTRADA"),U=_.filter($=>String($.tipo_de_movimiento).toUpperCase()==="SALIDA");return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:$=>a($.target.value)}),i.jsxs("select",{className:"input",value:s,onChange:$=>l($.target.value),children:[i.jsx("option",{value:"",children:"-- Marca (todas) --"}),h.map($=>i.jsx("option",{value:$,children:$},$))]}),i.jsxs("select",{className:"input",value:u,onChange:$=>d($.target.value),children:[i.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map($=>i.jsx("option",{value:$,children:$},$))]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:v,onChange:$=>x($.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),x(!1),G()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:A?"Cargando...":`${_.length} registros`})]}),I&&i.jsx("div",{style:{color:"red",marginBottom:12},children:I}),i.jsxs("div",{style:{display:"flex",gap:12},children:[i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Entradas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:L.map($=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String($.id)}),i.jsx("td",{style:{minWidth:120},children:w[$.producto_id]?.sku||$.producto_id}),i.jsx("td",{children:w[$.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number($.cantidad).toFixed(2)}),i.jsx("td",{children:$.referencia||""}),i.jsx("td",{children:$.usuario||""}),i.jsx("td",{children:$.fecha_salida||""})]},String($.id)))})]})]}),i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Salidas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:U.map($=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String($.id)}),i.jsx("td",{style:{minWidth:120},children:w[$.producto_id]?.sku||$.producto_id}),i.jsx("td",{children:w[$.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number($.cantidad).toFixed(2)}),i.jsx("td",{children:$.referencia||""}),i.jsx("td",{children:$.usuario||""}),i.jsx("td",{children:$.fecha_salida||""})]},String($.id)))})]})]})]})]})}function Hx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),i.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function $x(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),i.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function Vx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function Px(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function Gx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function Fx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function Kx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function Yx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),i.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function Jx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),i.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function Qx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),i.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function Xx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),i.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function Zx({open:o,onClose:a,onCreate:s}){const[l,u]=j.useState(""),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,_]=j.useState(""),[b,w]=j.useState(""),[R,A]=j.useState(!0),[T,I]=j.useState(!1),[M,G]=j.useState(null);if(!o)return null;async function C(){const L=[];if(l.trim()||L.push("Nombre"),L.length){G(`Faltan campos: ${L.join(", ")}`);return}I(!0),G(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:b||void 0,activo:R}),u(""),h(""),p(""),v(""),_(""),w(""),A(!0),a()}catch(U){G(U?.message||String(U))}finally{I(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:l,onChange:L=>u(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:d,onChange:L=>h(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:g,onChange:L=>p(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:m,onChange:L=>v(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:x,onChange:L=>_(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:b,onChange:L=>w(L.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:R,onChange:L=>A(L.target.checked)})," ","Activo"]})]}),M&&i.jsx("div",{style:{color:"red",marginTop:12},children:M}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:T,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:C,disabled:T,style:{width:"auto",padding:"8px 14px"},children:T?"Creando...":"Crear"})]})]})})}function Wx({open:o,onClose:a,row:s,onSave:l}){const[u,d]=j.useState(""),[h,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[_,b]=j.useState(""),[w,R]=j.useState(""),[A,T]=j.useState(!0),[I,M]=j.useState(!1),[G,C]=j.useState(null);if(j.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),x(s.correo||""),b(s.direccion||""),R(s.tipo_proveedor||""),T(s.activo??!0),C(null))},[o,s]),!o||!s)return null;async function L(){if(!s){C("No hay fila seleccionada");return}const U=[];if(u.trim()||U.push("Nombre"),U.length){C(`Faltan campos: ${U.join(", ")}`);return}M(!0),C(null);try{await l(s.id,{nombre:u.trim(),rtn:h.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:w||void 0,activo:A}),a()}catch($){C($?.message||String($))}finally{M(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:u,onChange:U=>d(U.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:h,onChange:U=>g(U.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:p,onChange:U=>m(U.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:v,onChange:U=>x(U.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:_,onChange:U=>b(U.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:w,onChange:U=>R(U.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:A,onChange:U=>T(U.target.checked)})," ","Activo"]})]}),G&&i.jsx("div",{style:{color:"red",marginTop:12},children:G}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:I,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:L,disabled:I,style:{width:"auto",padding:"8px 14px"},children:I?"Guardando...":"Guardar"})]})]})})}function e_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[_,b]=j.useState(null),[w,R]=j.useState(!1),[A,T]=j.useState(null);async function I(L){l(!0),d(null);try{let U=null,$=null;if(L&&L.trim()){const J=`%${L.trim()}%`,ue=await ie.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${J},rtn.ilike.${J}`).order("id",{ascending:!0});U=ue.data,$=ue.error}else{const be=await ie.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});U=be.data,$=be.error}if($)throw $;a(Array.isArray(U)?U:[])}catch(U){d(U?.message||String(U)),a([])}finally{l(!1)}}j.useEffect(()=>{I()},[]),j.useEffect(()=>{const L=setTimeout(()=>{I(h)},350);return()=>clearTimeout(L)},[h]);async function M(L){l(!0),d(null);try{const U={...L};if(delete U.id,U.rtn){const{data:be,error:J}=await ie.from("proveedores").select("id, nombre").eq("rtn",U.rtn).limit(1);if(J)throw J;if(Array.isArray(be)&&be.length>0)throw new Error(`Ya existe un proveedor con RTN ${U.rtn}`)}const{error:$}=await ie.from("proveedores").insert(U);if($)throw $;await I()}catch(U){throw String(U).includes("Ya existe un proveedor")?d(String(U)):U?.code==="23505"||String(U).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(U?.message||String(U)),U}finally{l(!1)}}async function G(L,U){l(!0),d(null);try{const{error:$}=await ie.from("proveedores").update(U).eq("id",L);if($)throw $;await I()}catch($){throw d($?.message||String($)),$}finally{l(!1)}}async function C(){if(A){l(!0),d(null);try{const{error:L}=await ie.from("proveedores").delete().eq("id",A.id);if(L)throw L;R(!1),T(null),await I()}catch(L){d(L?.message||String(L))}finally{l(!1)}}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>I(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),i.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:h,onChange:L=>g(L.target.value),style:{width:260}}),i.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),I()},children:"Limpiar"})]}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"RTN"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Telfono"}),i.jsx("th",{children:"Correo"}),i.jsx("th",{children:"Direccin"}),i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Activo"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(L=>i.jsxs("tr",{children:[i.jsx("td",{children:L.rtn||""}),i.jsx("td",{style:{minWidth:180},children:L.nombre}),i.jsx("td",{children:L.telefono||""}),i.jsx("td",{children:L.correo||""}),i.jsx("td",{children:L.direccion||""}),i.jsx("td",{children:L.tipo_proveedor||""}),i.jsx("td",{children:L.activo?"S":"No"}),i.jsxs("td",{style:{whiteSpace:"nowrap"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{b(L),x(!0)},children:"Editar"}),i.jsx("button",{className:"btn-danger",onClick:()=>{T(L),R(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},L.id))})]})}),i.jsx(Zx,{open:p,onClose:()=>m(!1),onCreate:async L=>{await M(L),m(!1)}}),i.jsx(Wx,{open:v,onClose:()=>{x(!1),b(null)},row:_,onSave:async(L,U)=>{await G(L,U),x(!1),b(null)}}),i.jsx(sm,{open:w,title:A?`Eliminar proveedor ${A.nombre}`:"Eliminar proveedor",message:A?`Confirma eliminar al proveedor ${A.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await C()},onCancel:()=>{R(!1),T(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function t_({open:o,onClose:a,onCreated:s}){const[l,u]=j.useState([]),[d,h]=j.useState([]),[g,p]=j.useState(0),[m,v]=j.useState(null),[x,_]=j.useState(""),[b,w]=j.useState("factura"),[R,A]=j.useState([]),[T,I]=j.useState(null),[M,G]=j.useState(1),[C,L]=j.useState(null),[U,$]=j.useState(!1),[be,J]=j.useState(null);if(j.useEffect(()=>{o&&(async()=>{try{const z=await ie.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(z.data)?z.data:[])}catch{}try{const z=await ie.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});h(Array.isArray(z.data)?z.data:[])}catch{}try{const z=await ie.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),ee=Array.isArray(z.data)&&z.data.length>0?z.data[0]:null,F=ee?Number(ee.impuesto_venta):0;p(F)}catch{}})()},[o]),!o)return null;function ue(){v(null),_(""),w("factura"),A([]),I(null),G(1),L(null),J(null)}function _e(){if(!T){J("Selecciona un producto");return}if(!C||C<=0){J("Costo unitario invlido");return}if(!M||M<=0){J("Cantidad invlida");return}const z=l.find(F=>F.id===T),ee=F=>{if(F==null)return!1;if(typeof F=="boolean")return F===!0;if(typeof F=="number")return F===1;const pe=String(F).toLowerCase().trim();return pe==="1"||pe==="true"||pe==="t"||pe==="si"||pe==="s"||pe==="yes"};A(F=>[...F,{producto_id:T,nombre:z?.nombre||"",cantidad:M,costo_unitario:C,exento:ee(z?.exento)}]),I(null),G(1),L(null),J(null)}function q(z){A(ee=>ee.filter((F,pe)=>pe!==z))}function W(){const z=g,ee=z>1?z/100:z;let F=0,pe=0,N=0;for(const D of R){const P=D.cantidad*D.costo_unitario;let Q=0,me=P;D.exento||(Q=P*ee,me=P-Q),F+=me,pe+=Q,N+=P}return{subtotal:F,impuesto:pe,total:N}}async function Z(){if(J(null),!m){J("Selecciona un proveedor");return}if(R.length===0){J("Agrega al menos un producto");return}$(!0);try{const{subtotal:z,impuesto:ee,total:F}=W(),pe={proveedor_id:m,numero_documento:x||null,tipo_documento:b||null,subtotal:z,impuesto:ee,total:F,usuario:null},N=await ie.from("compras").insert(pe).select("id").single();if(N.error)throw N.error;const D=N.data.id,P=R.map(me=>({compra_id:D,producto_id:me.producto_id,cantidad:me.cantidad,costo_unitario:me.costo_unitario})),Q=await ie.from("compras_detalle").insert(P);if(Q.error)throw await ie.from("compras").delete().eq("id",D),Q.error;try{const me=x?`Compra - ${x}`:`Compra ${D}`;let ge="sistema";try{const Se=localStorage.getItem("user");if(Se){const Ae=JSON.parse(Se);ge=Ae.username?`${Ae.username}${Ae.role?` (${Ae.role})`:""}`:String(Ae)}}catch{}const O=new Date().toISOString(),ne=R.map(Se=>({producto_id:Se.producto_id,cantidad:Se.cantidad,tipo_de_movimiento:"ENTRADA",referencia:me,usuario:ge,fecha_salida:O})),ve=await ie.from("registro_de_inventario").insert(ne);ve.error&&(console.warn("Error registrando en registro_de_inventario",ve.error),J("Compra guardada, pero fall el registro en inventario: "+ve.error.message))}catch(me){console.warn("Registro inventario fallo",me)}ue(),a(),s&&s()}catch(z){J(z?.message||String(z))}finally{$(!1)}}const E=W();return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),i.jsxs("select",{className:"input",value:m??"",onChange:z=>v(z.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(z=>i.jsx("option",{value:z.id,children:z.nombre},String(z.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),i.jsx("input",{className:"input",value:x,onChange:z=>_(z.target.value)}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),i.jsx("input",{className:"input",value:b,onChange:z=>w(z.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:T??"",onChange:z=>I(z.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(z=>i.jsx("option",{value:z.id,children:z.nombre},z.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:z=>G(Number(z.target.value))}),i.jsx("input",{className:"input",type:"number",style:{width:120},value:C??"",onChange:z=>L(Number(z.target.value)),placeholder:"Costo unitario"}),i.jsx("button",{className:"btn-primary",onClick:_e,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:R.map((z,ee)=>{const F=z.cantidad*z.costo_unitario,pe=g>1?g/100:g,N=z.exento?0:F*pe,D=z.exento?F:F-N;return i.jsxs("tr",{children:[i.jsx("td",{children:z.nombre}),i.jsx("td",{children:z.cantidad}),i.jsx("td",{children:z.costo_unitario.toFixed(2)}),i.jsx("td",{children:N.toFixed(2)}),i.jsx("td",{children:D.toFixed(2)}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>q(ee),children:"Quitar"})})]},`${z.producto_id}-${ee}`)})})]})})]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:["Subtotal: ",i.jsx("strong",{children:E.subtotal.toFixed(2)})]}),i.jsxs("div",{children:["Impuesto: ",i.jsx("strong",{children:E.impuesto.toFixed(2)})]}),i.jsxs("div",{children:["Total: ",i.jsx("strong",{children:E.total.toFixed(2)})]})]})}),be&&i.jsx("div",{style:{color:"red",marginTop:12},children:be}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{ue(),a()},disabled:U,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:Z,disabled:U,children:U?"Guardando...":"Confirmar compra"})]})]})})}function n_({open:o,compraId:a,onClose:s}){const[l,u]=j.useState([]),[d,h]=j.useState({}),[g,p]=j.useState({}),[m,v]=j.useState(0),[x,_]=j.useState(!1);return j.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{_(!0);try{const{data:w,error:R}=await ie.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(R)throw R;const A=Array.isArray(w)?w:[];if(!b)return;u(A);const T=Array.from(new Set(A.map(I=>I.producto_id))).filter(Boolean);if(T.length>0){const{data:I}=await ie.from("inventario").select("id, nombre, exento").in("id",T),M={},G={};Array.isArray(I)&&I.forEach(C=>{M[String(C.id)]={id:C.id,nombre:C.nombre},G[String(C.id)]=C.exento===!0||C.exento===1||String(C.exento).toLowerCase()==="true"}),b&&(h(M),p(G))}else h({});try{const{data:I}=await ie.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),M=Array.isArray(I)&&I.length>0?I[0]:null,G=M?Number(M.impuesto_venta):0;b&&v(G)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&_(!1)}})(),()=>{b=!1}},[o,a]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),i.jsx("div",{style:{marginTop:8},children:x?i.jsx("div",{children:"Cargando..."}):i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),R=Number(b.costo_unitario),A=w*R,T=m>1?m/100:m,I=g[String(b.producto_id)]===!0,M=I?0:A*T,G=I?A:A-M;return i.jsxs("tr",{children:[i.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),i.jsx("td",{children:w.toFixed(2)}),i.jsx("td",{children:R.toFixed(2)}),i.jsx("td",{children:M.toFixed(2)}),i.jsx("td",{children:G.toFixed(2)}),i.jsx("td",{children:A.toFixed(2)})]},String(b.id))})}),i.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,R)=>{const A=Number(R.cantidad),T=Number(R.costo_unitario),I=A*T,M=m>1?m/100:m,G=g[String(R.producto_id)]===!0,C=G?0:I*M,L=G?I:I-C;return w.subtotal+=L,w.impuesto+=C,w.total+=I,w},{subtotal:0,impuesto:0,total:0});return i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),i.jsx("td",{children:b.impuesto.toFixed(2)}),i.jsx("td",{children:b.subtotal.toFixed(2)}),i.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function a_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(!1),[v,x]=j.useState(null),[_,b]=j.useState([]),[w,R]=j.useState(""),[A,T]=j.useState(""),[I,M]=j.useState(!1);async function G(){l(!0),d(null);try{let C=ie.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const $=Number(w);isNaN($)?C=C.eq("proveedor_id",w):C=C.eq("proveedor_id",$)}if(A&&(C=C.ilike("numero_documento",`%${A}%`)),I){const $=new Date(Date.now()-864e5).toISOString();C=C.gte("fecha_compra",$)}const{data:L,error:U}=await C.order("id",{ascending:!1});if(U)throw U;a(Array.isArray(L)?L:[])}catch(C){d(C?.message||String(C)),a([])}finally{l(!1)}}return j.useEffect(()=>{G()},[]),j.useEffect(()=>{let C=!0;return(async()=>{try{const{data:L}=await ie.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!C)return;b(Array.isArray(L)?L:[])}catch{}})(),()=>{C=!1}},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:w,onChange:C=>R(C.target.value),children:[i.jsx("option",{value:"",children:"-- proveedor (todos) --"}),_.map(C=>i.jsx("option",{value:String(C.id),children:C.nombre},String(C.id)))]}),i.jsx("input",{className:"input",placeholder:"Nmero documento",value:A,onChange:C=>T(C.target.value)}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:I,onChange:C=>M(C.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{R(""),T(""),M(!1),G()},children:"Limpiar"})]}),i.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),i.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:o.map(C=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(C.id)}),i.jsx("td",{children:String(C.proveedor_id)}),i.jsx("td",{children:C.numero_documento||""}),i.jsx("td",{children:C.fecha_compra||""}),i.jsx("td",{children:C.subtotal||""}),i.jsx("td",{children:C.impuesto||""}),i.jsx("td",{children:C.total||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{x(C.id),m(!0)},children:"Detalle"})})]},String(C.id)))})]})}),i.jsx(t_,{open:h,onClose:()=>g(!1),onCreated:()=>{g(!1),G()}}),i.jsx(n_,{open:p,compraId:v,onClose:()=>{m(!1),x(null)}})]})}function i_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(null);async function v(){l(!0),d(null);try{const{data:x,error:_}=await ie.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(_)throw _;a(Array.isArray(x)?x.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(x){d(x?.message||String(x)),a([])}finally{l(!1)}}return j.useEffect(()=>{v()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),i.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(x=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(x.id)}),i.jsx("td",{children:String(x.proveedor_id||"")}),i.jsx("td",{children:x.numero_documento||""}),i.jsx("td",{children:x.usuario||""}),i.jsx("td",{children:x.fecha||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>m(x.id),children:"Detalle"})})]},String(x.id)))})]})}),h&&i.jsx(r_,{onClose:()=>{g(!1),v()}}),p&&i.jsx(s_,{id:p,onClose:()=>{m(null),v()}})]})}function r_({onClose:o}){const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(null),[x,_]=j.useState(null),[b,w]=j.useState(""),[R,A]=j.useState([]),[T,I]=j.useState(null),[M,G]=j.useState(1),[C,L]=j.useState(!1),[U,$]=j.useState(null);j.useEffect(()=>{(async()=>{try{const q=await ie.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(q.data)?q.data:[])}catch{}try{const q=await ie.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(q.data)?q.data:[])}catch{}})()},[]);async function be(){if(b){$(null);try{const{data:q,error:W}=await ie.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(W)throw W;if(!q){$("No se encontr compra con ese nmero de documento");return}h(q.id),v(q.proveedor_id);try{const{data:Q}=await ie.from("proveedores").select("id, nombre").eq("id",q.proveedor_id).limit(1).single();Q&&Q.nombre&&_(Q.nombre)}catch{}const{data:Z}=await ie.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",q.id),E=Array.isArray(Z)?Z:[],{data:z}=await ie.from("devoluciones_proveedores").select("id").eq("numero_documento",b),ee=Array.isArray(z)?z.map(Q=>Q.id):[];let F={};if(ee.length>0){const{data:Q}=await ie.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",ee);Array.isArray(Q)&&Q.forEach(me=>{const ge=String(me.producto_id);F[ge]=(F[ge]||0)+Number(me.cantidad)})}const pe=E.map(Q=>Q.producto_id),{data:N}=await ie.from("inventario").select("id, nombre, sku").in("id",pe),D={};Array.isArray(N)&&N.forEach(Q=>{D[String(Q.id)]=Q});const P=E.map(Q=>{const me=String(Q.producto_id),ge=Number(Q.cantidad),O=F[me]||0,ne=Math.max(0,ge-O);return{producto_id:me,nombre:D[me]?.nombre||me,sku:D[me]?.sku,purchased:ge,returned:O,available:ne,costo_unitario:Number(Q.costo_unitario||0)}});p(P),u(P.map(Q=>({id:Q.producto_id,nombre:Q.nombre,sku:Q.sku})))}catch(q){$(q?.message||String(q))}}}function J(){if(!T){$("Selecciona un producto");return}if(!M||M<=0){$("Cantidad invlida");return}const q=l.find(Z=>Z.id===T),W=g.find(Z=>Z.producto_id===T);if(W&&M>W.available){$(`Cantidad excede disponible para devolucin (${W.available})`);return}A(Z=>[...Z,{producto_id:T,nombre:q?.nombre,cantidad:M}]),I(null),G(1),$(null),W&&(p(Z=>Z.map(E=>E.producto_id===W.producto_id?{...E,available:Math.max(0,E.available-M)}:E)),u(Z=>Z.map(E=>(E.id===W.producto_id,E))))}function ue(q){A(W=>W.filter((Z,E)=>E!==q))}async function _e(){if($(null),!m){$("Selecciona un proveedor");return}if(R.length===0){$("Agrega al menos un producto");return}L(!0);try{const q={proveedor_id:m,numero_documento:b||null,usuario:null},W=await ie.from("devoluciones_proveedores").insert(q).select("id").single();if(W.error)throw W.error;const Z=W.data.id;try{const E=R.map(ee=>({devolucion_id:Z,producto_id:ee.producto_id,cantidad:ee.cantidad})),z=await ie.from("devoluciones_proveedores_detalle").insert(E);z.error&&console.warn("No se pudo insertar detalles de devolucin",z.error)}catch(E){console.warn("Detalles tabla puede no existir",E)}try{const E=b?`Devolucin - ${b}`:`Devolucin ${Z}`;let z="sistema";try{const N=localStorage.getItem("user");if(N){const D=JSON.parse(N);z=D.username?`${D.username}${D.role?` (${D.role})`:""}`:String(D)}}catch{}const ee=new Date().toISOString(),F=R.map(N=>({producto_id:N.producto_id,cantidad:N.cantidad,tipo_de_movimiento:"SALIDA",referencia:E,usuario:z,fecha_salida:ee})),pe=await ie.from("registro_de_inventario").insert(F);pe.error&&(console.warn("Error registrando en registro_de_inventario",pe.error),$("Devolucin guardada, pero fall el registro en inventario: "+pe.error.message))}catch(E){console.warn("Registro inventario fallo",E)}o()}catch(q){$(q?.message||String(q))}finally{L(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?i.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:x||String(m||"")}):i.jsxs("select",{className:"input",value:m??"",onChange:q=>v(q.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(q=>i.jsx("option",{value:q.id,children:q.nombre},String(q.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{className:"input",value:b,onChange:q=>w(q.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>be(),children:"Buscar compra"})]}),d&&i.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&i.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[i.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[i.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Comprado"}),i.jsx("th",{children:"Devuelto"}),i.jsx("th",{children:"Disponible"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:g.map(q=>i.jsxs("tr",{children:[i.jsx("td",{children:q.nombre}),i.jsx("td",{style:{textAlign:"right"},children:Number(q.purchased).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(q.returned).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(q.available).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>{I(q.producto_id),G(q.available||1)},children:"Usar"})})]},q.producto_id))})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:T??"",onChange:q=>I(q.target.value||null),disabled:!!d,children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(q=>i.jsx("option",{value:q.id,children:q.nombre},q.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:q=>{const W=Number(q.target.value),Z=g.find(E=>E.producto_id===T);if(Z){const E=Number(Z.available||0);return isNaN(W)||W<1?G(1):W>E?G(E):G(W)}G(W)},min:1,max:T?g.find(q=>q.producto_id===T)?.available??void 0:void 0,disabled:(()=>{const q=g.find(W=>W.producto_id===T);return!!q&&Number(q.available||0)<=1})()}),i.jsx("button",{className:"btn-primary",onClick:J,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:R.map((q,W)=>i.jsxs("tr",{children:[i.jsx("td",{children:q.nombre}),i.jsx("td",{style:{textAlign:"right"},children:q.cantidad}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>ue(W),children:"Quitar"})})]},`${q.producto_id}-${W}`))})]})})]})]}),U&&i.jsx("div",{style:{color:"red",marginTop:12},children:U}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:o,disabled:C,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:_e,disabled:C,children:C?"Guardando...":"Registrar devolucin"})]})]})})}function s_({id:o,onClose:a}){const[s,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await ie.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const x=Array.isArray(m)?m:[];if(x.length>0){const _=x.map(R=>R.producto_id),{data:b}=await ie.from("inventario").select("id, nombre, sku").in("id",_),w={};Array.isArray(b)&&b.forEach(R=>{w[String(R.id)]=R}),l(x.map(R=>({producto:w[String(R.producto_id)]?.nombre||String(R.producto_id),cantidad:R.cantidad})))}else{const{data:_}=await ie.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(_)?_:[],w=b.map(T=>T.producto_id),{data:R}=await ie.from("inventario").select("id, nombre, sku").in("id",w),A={};Array.isArray(R)&&R.forEach(T=>{A[String(T.id)]=T}),l(b.map(T=>({producto:A[String(T.producto_id)]?.nombre||String(T.producto_id),cantidad:T.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return j.useEffect(()=>{p()},[o]),i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&i.jsx("div",{children:"Cargando..."}),h&&i.jsx("div",{style:{color:"red"},children:h}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"})]})}),i.jsx("tbody",{children:s.map((m,v)=>i.jsxs("tr",{children:[i.jsx("td",{children:m.producto}),i.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const l_={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function o_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(null),[p,m]=j.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await ie.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};j.useEffect(()=>{v()},[]);const x=(b,w)=>{a(R=>R.map(A=>A.id===b?{...A,impuesto_venta:w}:A))},_=async b=>{const w=o.find(R=>R.id===b);if(w){d(b),m(null);try{const R={impuesto_venta:w.impuesto_venta??null},{error:A}=await ie.from("impuesto").update(R).eq("id",b);if(A)throw A;await v()}catch(R){console.warn("Error guardando impuesto:",R),m(String(R.message||R))}finally{d(null)}}};return i.jsxs("div",{children:[i.jsx("h2",{children:"Impuestos"}),i.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?i.jsx("div",{children:"Cargando..."}):i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>i.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:l_[b.id]??`Impuesto #${b.id}`}),i.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),i.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>x(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:h!==b.id}),i.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:h===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[i.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),i.jsx("div",{style:{display:"flex",gap:8},children:h===b.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:()=>_(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):i.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&i.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&i.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const c_={dashboard:vx,datos:_x,usuarios_internal:Sx,usuarios_web:jx,cai:Cx,facturas:Tx,historial_facturas:Ax,inventario_productos:Ux,precios_productos:Lx,precios_historico:Mx,stock:qx,inventario_salidas:Ix,inventario_categorias:Hx,proveedores:e_,caja_sesiones:$x,caja_movimientos:Vx,rep_ventas:Px,rep_devoluciones:Gx,rep_ingresos_egresos:Fx,rep_compras:Kx,compras_main:a_,devoluciones_proveedores:i_,rep_export:Yx,cuentas_contables:Jx,libro_diario:Qx,auditoria:Xx,impuestos:o_};function u_({onLogout:o}){const[a,s]=j.useState("dashboard"),[l,u]=j.useState(null),[d,h]=j.useState({}),g=l||a,p=c_[g],v=(_=>{for(const b of cp){if(b.id===_)return b.label;if(b.children){const w=b.children.find(R=>R.id===_);if(w)return w.label}}return"Panel de Administracin"})(g),x=_=>{if(_.id==="salir")return o();_.children&&_.children.length>0?(h(b=>({...b,[_.id]:!b[_.id]})),(_.id!==a||!l)&&(s(_.id),u(_.children[0].id))):(s(_.id),u(null))};return i.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[i.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[i.jsx("strong",{children:"Panel Admin"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),i.jsx("nav",{children:cp.map(_=>i.jsxs("div",{style:{marginBottom:6},children:[i.jsxs("div",{onClick:()=>x(_),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===_.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[i.jsx("span",{children:_.label}),Array.isArray(_.children)&&_.children.length>0?i.jsx("span",{style:{marginLeft:8},children:d[_.id]?"":""}):null]}),Array.isArray(_.children)&&_.children.length>0&&d[_.id]&&i.jsx("div",{style:{marginLeft:12,marginTop:6},children:_.children.map(b=>i.jsx("div",{onClick:()=>{s(_.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},_.id))})]}),i.jsx("main",{style:{flex:1,padding:24},children:p?i.jsx(p,{}):i.jsx(yx,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function d_(){const[o,a]=j.useState(null);j.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]),j.useEffect(()=>{let u=!0;return(async()=>{try{const d=await Kl();if(!u||!d)return;const h=d.nombre||d.comercio||d.name||"";h&&(document.title=String(h));const g=d.logoUrl||d.logo||null;if(g)try{let p=document.querySelector("link[rel~='icon']");p||(p=document.createElement("link"),p.rel="icon",document.getElementsByTagName("head")[0].appendChild(p)),p.href=String(g)}catch{}}catch{}})(),()=>{u=!1}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return i.jsxs("div",{children:[!o&&i.jsx(G0,{onLogin:s}),o&&o.role==="cajero"&&i.jsx(fx,{onLogout:l}),o&&o.role==="admin"&&i.jsx(u_,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&i.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[i.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),i.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',i.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),i.jsx("div",{style:{marginTop:18},children:i.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class f_ extends Ou.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[i.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}jv.createRoot(document.getElementById("root")).render(i.jsx(f_,{children:i.jsx(d_,{})}));
