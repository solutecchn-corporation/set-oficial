function uv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function ip(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function dv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var Pc={exports:{}},Lr={};var yg;function hv(){if(yg)return Lr;yg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var f=null;if(d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:f,ref:u!==void 0?u:null,props:d}}return Lr.Fragment=a,Lr.jsx=s,Lr.jsxs=s,Lr}var vg;function fv(){return vg||(vg=1,Pc.exports=hv()),Pc.exports}var r=fv(),Kc={exports:{}},Hr={},Yc={exports:{}},Jc={};var bg;function gv(){return bg||(bg=1,(function(o){function a(U,L){var ee=U.length;U.push(L);e:for(;0<ee;){var le=ee-1>>>1,fe=U[le];if(0<u(fe,L))U[le]=L,U[ee]=fe,ee=le;else break e}}function s(U){return U.length===0?null:U[0]}function l(U){if(U.length===0)return null;var L=U[0],ee=U.pop();if(ee!==L){U[0]=ee;e:for(var le=0,fe=U.length,T=fe>>>1;le<T;){var z=2*(le+1)-1,P=U[z],Q=z+1,se=U[Q];if(0>u(P,ee))Q<fe&&0>u(se,P)?(U[le]=se,U[Q]=ee,le=Q):(U[le]=P,U[z]=ee,le=z);else if(Q<fe&&0>u(se,ee))U[le]=se,U[Q]=ee,le=Q;else break e}}return L}function u(U,L){var ee=U.sortIndex-L.sortIndex;return ee!==0?ee:U.id-L.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var f=Date,g=f.now();o.unstable_now=function(){return f.now()-g}}var p=[],m=[],v=1,_=null,j=3,b=!1,w=!1,A=!1,O=!1,C=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function K(U){for(var L=s(m);L!==null;){if(L.callback===null)l(m);else if(L.startTime<=U)l(m),L.sortIndex=L.expirationTime,a(p,L);else break;L=s(m)}}function E(U){if(A=!1,K(U),!w)if(s(p)!==null)w=!0,q||(q=!0,Z());else{var L=s(m);L!==null&&pe(E,L.startTime-U)}}var q=!1,k=-1,I=5,ce=-1;function J(){return O?!0:!(o.unstable_now()-ce<I)}function F(){if(O=!1,q){var U=o.unstable_now();ce=U;var L=!0;try{e:{w=!1,A&&(A=!1,M(k),k=-1),b=!0;var ee=j;try{t:{for(K(U),_=s(p);_!==null&&!(_.expirationTime>U&&J());){var le=_.callback;if(typeof le=="function"){_.callback=null,j=_.priorityLevel;var fe=le(_.expirationTime<=U);if(U=o.unstable_now(),typeof fe=="function"){_.callback=fe,K(U),L=!0;break t}_===s(p)&&l(p),K(U)}else l(p);_=s(p)}if(_!==null)L=!0;else{var T=s(m);T!==null&&pe(E,T.startTime-U),L=!1}}break e}finally{_=null,j=ee,b=!1}L=void 0}}finally{L?Z():q=!1}}}var Z;if(typeof B=="function")Z=function(){B(F)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,W=D.port2;D.port1.onmessage=F,Z=function(){W.postMessage(null)}}else Z=function(){C(F,0)};function pe(U,L){k=C(function(){U(o.unstable_now())},L)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(U){U.callback=null},o.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<U?Math.floor(1e3/U):5},o.unstable_getCurrentPriorityLevel=function(){return j},o.unstable_next=function(U){switch(j){case 1:case 2:case 3:var L=3;break;default:L=j}var ee=j;j=L;try{return U()}finally{j=ee}},o.unstable_requestPaint=function(){O=!0},o.unstable_runWithPriority=function(U,L){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var ee=j;j=U;try{return L()}finally{j=ee}},o.unstable_scheduleCallback=function(U,L,ee){var le=o.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?le+ee:le):ee=le,U){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=ee+fe,U={id:v++,callback:L,priorityLevel:U,startTime:ee,expirationTime:fe,sortIndex:-1},ee>le?(U.sortIndex=ee,a(m,U),s(p)===null&&U===s(m)&&(A?(M(k),k=-1):A=!0,pe(E,ee-le))):(U.sortIndex=fe,a(p,U),w||b||(w=!0,q||(q=!0,Z()))),U},o.unstable_shouldYield=J,o.unstable_wrapCallback=function(U){var L=j;return function(){var ee=j;j=L;try{return U.apply(this,arguments)}finally{j=ee}}}})(Jc)),Jc}var xg;function pv(){return xg||(xg=1,Yc.exports=gv()),Yc.exports}var Qc={exports:{}},Oe={};var _g;function mv(){if(_g)return Oe;_g=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),j=Symbol.iterator;function b(T){return T===null||typeof T!="object"?null:(T=j&&T[j]||T["@@iterator"],typeof T=="function"?T:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,O={};function C(T,z,P){this.props=T,this.context=z,this.refs=O,this.updater=P||w}C.prototype.isReactComponent={},C.prototype.setState=function(T,z){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,z,"setState")},C.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function M(){}M.prototype=C.prototype;function B(T,z,P){this.props=T,this.context=z,this.refs=O,this.updater=P||w}var K=B.prototype=new M;K.constructor=B,A(K,C.prototype),K.isPureReactComponent=!0;var E=Array.isArray;function q(){}var k={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function ce(T,z,P){var Q=P.ref;return{$$typeof:o,type:T,key:z,ref:Q!==void 0?Q:null,props:P}}function J(T,z){return ce(T.type,z,T.props)}function F(T){return typeof T=="object"&&T!==null&&T.$$typeof===o}function Z(T){var z={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(P){return z[P]})}var D=/\/+/g;function W(T,z){return typeof T=="object"&&T!==null&&T.key!=null?Z(""+T.key):z.toString(36)}function pe(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(q,q):(T.status="pending",T.then(function(z){T.status==="pending"&&(T.status="fulfilled",T.value=z)},function(z){T.status==="pending"&&(T.status="rejected",T.reason=z)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function U(T,z,P,Q,se){var ae=typeof T;(ae==="undefined"||ae==="boolean")&&(T=null);var de=!1;if(T===null)de=!0;else switch(ae){case"bigint":case"string":case"number":de=!0;break;case"object":switch(T.$$typeof){case o:case a:de=!0;break;case v:return de=T._init,U(de(T._payload),z,P,Q,se)}}if(de)return se=se(T),de=Q===""?"."+W(T,0):Q,E(se)?(P="",de!=null&&(P=de.replace(D,"$&/")+"/"),U(se,z,P,"",function(Re){return Re})):se!=null&&(F(se)&&(se=J(se,P+(se.key==null||T&&T.key===se.key?"":(""+se.key).replace(D,"$&/")+"/")+de)),z.push(se)),1;de=0;var oe=Q===""?".":Q+":";if(E(T))for(var ge=0;ge<T.length;ge++)Q=T[ge],ae=oe+W(Q,ge),de+=U(Q,z,P,ae,se);else if(ge=b(T),typeof ge=="function")for(T=ge.call(T),ge=0;!(Q=T.next()).done;)Q=Q.value,ae=oe+W(Q,ge++),de+=U(Q,z,P,ae,se);else if(ae==="object"){if(typeof T.then=="function")return U(pe(T),z,P,Q,se);throw z=String(T),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return de}function L(T,z,P){if(T==null)return T;var Q=[],se=0;return U(T,Q,"","",function(ae){return z.call(P,ae,se++)}),Q}function ee(T){if(T._status===-1){var z=T._result;z=z(),z.then(function(P){(T._status===0||T._status===-1)&&(T._status=1,T._result=P)},function(P){(T._status===0||T._status===-1)&&(T._status=2,T._result=P)}),T._status===-1&&(T._status=0,T._result=z)}if(T._status===1)return T._result.default;throw T._result}var le=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},fe={map:L,forEach:function(T,z,P){L(T,function(){z.apply(this,arguments)},P)},count:function(T){var z=0;return L(T,function(){z++}),z},toArray:function(T){return L(T,function(z){return z})||[]},only:function(T){if(!F(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return Oe.Activity=_,Oe.Children=fe,Oe.Component=C,Oe.Fragment=s,Oe.Profiler=u,Oe.PureComponent=B,Oe.StrictMode=l,Oe.Suspense=p,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(T){return k.H.useMemoCache(T)}},Oe.cache=function(T){return function(){return T.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(T,z,P){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var Q=A({},T.props),se=T.key;if(z!=null)for(ae in z.key!==void 0&&(se=""+z.key),z)!I.call(z,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&z.ref===void 0||(Q[ae]=z[ae]);var ae=arguments.length-2;if(ae===1)Q.children=P;else if(1<ae){for(var de=Array(ae),oe=0;oe<ae;oe++)de[oe]=arguments[oe+2];Q.children=de}return ce(T.type,se,Q)},Oe.createContext=function(T){return T={$$typeof:f,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:d,_context:T},T},Oe.createElement=function(T,z,P){var Q,se={},ae=null;if(z!=null)for(Q in z.key!==void 0&&(ae=""+z.key),z)I.call(z,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(se[Q]=z[Q]);var de=arguments.length-2;if(de===1)se.children=P;else if(1<de){for(var oe=Array(de),ge=0;ge<de;ge++)oe[ge]=arguments[ge+2];se.children=oe}if(T&&T.defaultProps)for(Q in de=T.defaultProps,de)se[Q]===void 0&&(se[Q]=de[Q]);return ce(T,ae,se)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(T){return{$$typeof:g,render:T}},Oe.isValidElement=F,Oe.lazy=function(T){return{$$typeof:v,_payload:{_status:-1,_result:T},_init:ee}},Oe.memo=function(T,z){return{$$typeof:m,type:T,compare:z===void 0?null:z}},Oe.startTransition=function(T){var z=k.T,P={};k.T=P;try{var Q=T(),se=k.S;se!==null&&se(P,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(q,le)}catch(ae){le(ae)}finally{z!==null&&P.types!==null&&(z.types=P.types),k.T=z}},Oe.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Oe.use=function(T){return k.H.use(T)},Oe.useActionState=function(T,z,P){return k.H.useActionState(T,z,P)},Oe.useCallback=function(T,z){return k.H.useCallback(T,z)},Oe.useContext=function(T){return k.H.useContext(T)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(T,z){return k.H.useDeferredValue(T,z)},Oe.useEffect=function(T,z){return k.H.useEffect(T,z)},Oe.useEffectEvent=function(T){return k.H.useEffectEvent(T)},Oe.useId=function(){return k.H.useId()},Oe.useImperativeHandle=function(T,z,P){return k.H.useImperativeHandle(T,z,P)},Oe.useInsertionEffect=function(T,z){return k.H.useInsertionEffect(T,z)},Oe.useLayoutEffect=function(T,z){return k.H.useLayoutEffect(T,z)},Oe.useMemo=function(T,z){return k.H.useMemo(T,z)},Oe.useOptimistic=function(T,z){return k.H.useOptimistic(T,z)},Oe.useReducer=function(T,z,P){return k.H.useReducer(T,z,P)},Oe.useRef=function(T){return k.H.useRef(T)},Oe.useState=function(T){return k.H.useState(T)},Oe.useSyncExternalStore=function(T,z,P){return k.H.useSyncExternalStore(T,z,P)},Oe.useTransition=function(){return k.H.useTransition()},Oe.version="19.2.0",Oe}var jg;function bu(){return jg||(jg=1,Qc.exports=mv()),Qc.exports}var Xc={exports:{}},zt={};var Sg;function yv(){if(Sg)return zt;Sg=1;var o=bu();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:_==null?null:""+_,children:p,containerInfo:m,implementation:v}}var f=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return zt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,zt.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},zt.flushSync=function(p){var m=f.T,v=l.p;try{if(f.T=null,l.p=2,p)return p()}finally{f.T=m,l.p=v,l.d.f()}},zt.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},zt.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},zt.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin),j=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:j,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:_,integrity:j,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},zt.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},zt.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},zt.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},zt.requestFormReset=function(p){l.d.r(p)},zt.unstable_batchedUpdates=function(p,m){return p(m)},zt.useFormState=function(p,m,v){return f.H.useFormState(p,m,v)},zt.useFormStatus=function(){return f.H.useHostTransitionStatus()},zt.version="19.2.0",zt}var wg;function rp(){if(wg)return Xc.exports;wg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),Xc.exports=yv(),Xc.exports}var Eg;function vv(){if(Eg)return Hr;Eg=1;var o=pv(),a=bu(),s=rp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,i=t;;){var c=n.return;if(c===null)break;var h=c.alternate;if(h===null){if(i=c.return,i!==null){n=i;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===n)return p(c),e;if(h===i)return p(c),t;h=h.sibling}throw Error(l(188))}if(n.return!==i.return)n=c,i=h;else{for(var y=!1,x=c.child;x;){if(x===n){y=!0,n=c,i=h;break}if(x===i){y=!0,i=c,n=h;break}x=x.sibling}if(!y){for(x=h.child;x;){if(x===n){y=!0,n=h,i=c;break}if(x===i){y=!0,i=h,n=c;break}x=x.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==i)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var _=Object.assign,j=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),B=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),ce=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function Z(e){return e===null||typeof e!="object"?null:(e=F&&e[F]||e["@@iterator"],typeof e=="function"?e:null)}var D=Symbol.for("react.client.reference");function W(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===D?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case A:return"Fragment";case C:return"Profiler";case O:return"StrictMode";case E:return"Suspense";case q:return"SuspenseList";case ce:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case B:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case K:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case k:return t=e.displayName||null,t!==null?t:W(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return W(e(t))}catch{}}return null}var pe=Array.isArray,U=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},le=[],fe=-1;function T(e){return{current:e}}function z(e){0>fe||(e.current=le[fe],le[fe]=null,fe--)}function P(e,t){fe++,le[fe]=e.current,e.current=t}var Q=T(null),se=T(null),ae=T(null),de=T(null);function oe(e,t){switch(P(ae,t),P(se,e),P(Q,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Hf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Hf(t),e=If(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(Q),P(Q,e)}function ge(){z(Q),z(se),z(ae)}function Re(e){e.memoizedState!==null&&P(de,e);var t=Q.current,n=If(t,e.type);t!==n&&(P(se,e),P(Q,n))}function qe(e){se.current===e&&(z(Q),z(se)),de.current===e&&(z(de),Dr._currentValue=ee)}var Ne,ke;function Je(e){if(Ne===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ne=t&&t[1]||"",ke=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ne+e+ke}var ut=!1;function Nt(e,t){if(!e||ut)return"";ut=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(X){var Y=X}Reflect.construct(e,[],ie)}else{try{ie.call()}catch(X){Y=X}e.call(ie.prototype)}}else{try{throw Error()}catch(X){Y=X}(ie=e())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(X){if(X&&Y&&typeof X.stack=="string")return[X.stack,Y.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=i.DetermineComponentFrameRoot(),y=h[0],x=h[1];if(y&&x){var R=y.split(`
`),G=x.split(`
`);for(c=i=0;i<R.length&&!R[i].includes("DetermineComponentFrameRoot");)i++;for(;c<G.length&&!G[c].includes("DetermineComponentFrameRoot");)c++;if(i===R.length||c===G.length)for(i=R.length-1,c=G.length-1;1<=i&&0<=c&&R[i]!==G[c];)c--;for(;1<=i&&0<=c;i--,c--)if(R[i]!==G[c]){if(i!==1||c!==1)do if(i--,c--,0>c||R[i]!==G[c]){var te=`
`+R[i].replace(" at new "," at ");return e.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",e.displayName)),te}while(1<=i&&0<=c);break}}}finally{ut=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Je(n):""}function jt(e,t){switch(e.tag){case 26:case 27:case 5:return Je(e.type);case 16:return Je("Lazy");case 13:return e.child!==t&&t!==null?Je("Suspense Fallback"):Je("Suspense");case 19:return Je("SuspenseList");case 0:case 15:return Nt(e.type,!1);case 11:return Nt(e.type.render,!1);case 1:return Nt(e.type,!0);case 31:return Je("Activity");default:return""}}function Lt(e){try{var t="",n=null;do t+=jt(e,n),n=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var Nn=Object.prototype.hasOwnProperty,at=o.unstable_scheduleCallback,ot=o.unstable_cancelCallback,wn=o.unstable_shouldYield,Ol=o.unstable_requestPaint,Dt=o.unstable_now,Ru=o.unstable_getCurrentPriorityLevel,Jr=o.unstable_ImmediatePriority,Qr=o.unstable_UserBlockingPriority,Ca=o.unstable_NormalPriority,Rl=o.unstable_LowPriority,Xr=o.unstable_IdlePriority,Nl=o.log,ni=o.unstable_setDisableYieldValue,Ta=null,Bt=null;function En(e){if(typeof Nl=="function"&&ni(e),Bt&&typeof Bt.setStrictMode=="function")try{Bt.setStrictMode(Ta,e)}catch{}}var Mt=Math.clz32?Math.clz32:zl,kl=Math.log,Fr=Math.LN2;function zl(e){return e>>>=0,e===0?32:31-(kl(e)/Fr|0)|0}var tn=256,nn=262144,Aa=4194304;function kn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ai(e,t,n){var i=e.pendingLanes;if(i===0)return 0;var c=0,h=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var x=i&134217727;return x!==0?(i=x&~h,i!==0?c=kn(i):(y&=x,y!==0?c=kn(y):n||(n=x&~e,n!==0&&(c=kn(n))))):(x=i&~h,x!==0?c=kn(x):y!==0?c=kn(y):n||(n=i&~e,n!==0&&(c=kn(n)))),c===0?0:t!==0&&t!==c&&(t&h)===0&&(h=c&-c,n=t&-t,h>=n||h===32&&(n&4194048)!==0)?t:c}function zn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ul(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ii(){var e=Aa;return Aa<<=1,(Aa&62914560)===0&&(Aa=4194304),e}function Oa(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ra(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Dl(e,t,n,i,c,h){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var x=e.entanglements,R=e.expirationTimes,G=e.hiddenUpdates;for(n=y&~n;0<n;){var te=31-Mt(n),ie=1<<te;x[te]=0,R[te]=-1;var Y=G[te];if(Y!==null)for(G[te]=null,te=0;te<Y.length;te++){var X=Y[te];X!==null&&(X.lane&=-536870913)}n&=~ie}i!==0&&Zr(e,i,0),h!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=h&~(y&~t))}function Zr(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-Mt(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&261930}function Qi(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Mt(n),c=1<<i;c&t|e[i]&t&&(e[i]|=t),n&=~c}}function Wr(e,t){var n=t&-t;return n=(n&42)!==0?1:Xi(n),(n&(e.suspendedLanes|t))!==0?0:n}function Xi(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function $(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ue(){var e=L.p;return e!==0?e:(e=window.event,e===void 0?32:ug(e.type))}function we(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}var he=Math.random().toString(36).slice(2),ye="__reactFiber$"+he,me="__reactProps$"+he,Te="__reactContainer$"+he,$e="__reactEvents$"+he,be="__reactListeners$"+he,De="__reactHandles$"+he,Ge="__reactResources$"+he,Ae="__reactMarker$"+he;function Le(e){delete e[ye],delete e[me],delete e[$e],delete e[be],delete e[De]}function mt(e){var t=e[ye];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Te]||n[ye]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Jf(e);e!==null;){if(n=e[ye])return n;e=Jf(e)}return t}e=n,n=e.parentNode}return null}function Pe(e){if(e=e[ye]||e[Te]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function it(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function kt(e){var t=e[Ge];return t||(t=e[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function rt(e){e[Ae]=!0}var Wn=new Set,Na={};function an(e,t){Cn(e,t),Cn(e+"Capture",t)}function Cn(e,t){for(Na[e]=t,e=0;e<t.length;e++)Wn.add(t[e])}var Bl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fi={},es={};function nm(e){return Nn.call(es,e)?!0:Nn.call(Fi,e)?!1:Bl.test(e)?es[e]=!0:(Fi[e]=!0,!1)}function ts(e,t,n){if(nm(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function ns(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Un(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function rn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Nu(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function am(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,h=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,h.call(this,y)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ml(e){if(!e._valueTracker){var t=Nu(e)?"checked":"value";e._valueTracker=am(e,t,""+e[t])}}function ku(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Nu(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function as(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var im=/[\n"\\]/g;function sn(e){return e.replace(im,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function ql(e,t,n,i,c,h,y,x){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+rn(t)):e.value!==""+rn(t)&&(e.value=""+rn(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?Ll(e,y,rn(t)):n!=null?Ll(e,y,rn(n)):i!=null&&e.removeAttribute("value"),c==null&&h!=null&&(e.defaultChecked=!!h),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.name=""+rn(x):e.removeAttribute("name")}function zu(e,t,n,i,c,h,y,x){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||n!=null){if(!(h!=="submit"&&h!=="reset"||t!=null)){Ml(e);return}n=n!=null?""+rn(n):"",t=t!=null?""+rn(t):n,x||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=x?e.checked:!!i,e.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Ml(e)}function Ll(e,t,n){t==="number"&&as(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function ri(e,t,n,i){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&i&&(e[n].defaultSelected=!0)}else{for(n=""+rn(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Uu(e,t,n){if(t!=null&&(t=""+rn(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+rn(n):""}function Du(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(l(92));if(pe(i)){if(1<i.length)throw Error(l(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=rn(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i),Ml(e)}function si(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var rm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Bu(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||rm.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Mu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&n[c]!==i&&Bu(e,c,i)}else for(var h in t)t.hasOwnProperty(h)&&Bu(e,h,t[h])}function Hl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function is(e){return lm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Dn(){}var Il=null;function Vl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var li=null,oi=null;function qu(e){var t=Pe(e);if(t&&(e=t.stateNode)){var n=e[me]||null;e:switch(e=t.stateNode,t.type){case"input":if(ql(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+sn(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var c=i[me]||null;if(!c)throw Error(l(90));ql(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&ku(i)}break e;case"textarea":Uu(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&ri(e,!!n.multiple,t,!1)}}}var $l=!1;function Lu(e,t,n){if($l)return e(t,n);$l=!0;try{var i=e(t);return i}finally{if($l=!1,(li!==null||oi!==null)&&(Ps(),li&&(t=li,e=oi,oi=li=null,qu(t),e)))for(t=0;t<e.length;t++)qu(e[t])}}function Zi(e,t){var n=e.stateNode;if(n===null)return null;var i=n[me]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Bn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gl=!1;if(Bn)try{var Wi={};Object.defineProperty(Wi,"passive",{get:function(){Gl=!0}}),window.addEventListener("test",Wi,Wi),window.removeEventListener("test",Wi,Wi)}catch{Gl=!1}var ea=null,Pl=null,rs=null;function Hu(){if(rs)return rs;var e,t=Pl,n=t.length,i,c="value"in ea?ea.value:ea.textContent,h=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(i=1;i<=y&&t[n-i]===c[h-i];i++);return rs=c.slice(e,1<i?1-i:void 0)}function ss(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ls(){return!0}function Iu(){return!1}function Ht(e){function t(n,i,c,h,y){this._reactName=n,this._targetInst=c,this.type=i,this.nativeEvent=h,this.target=y,this.currentTarget=null;for(var x in e)e.hasOwnProperty(x)&&(n=e[x],this[x]=n?n(h):h[x]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?ls:Iu,this.isPropagationStopped=Iu,this}return _(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ls)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ls)},persist:function(){},isPersistent:ls}),t}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},os=Ht(ka),er=_({},ka,{view:0,detail:0}),om=Ht(er),Kl,Yl,tr,cs=_({},er,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ql,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==tr&&(tr&&e.type==="mousemove"?(Kl=e.screenX-tr.screenX,Yl=e.screenY-tr.screenY):Yl=Kl=0,tr=e),Kl)},movementY:function(e){return"movementY"in e?e.movementY:Yl}}),Vu=Ht(cs),cm=_({},cs,{dataTransfer:0}),um=Ht(cm),dm=_({},er,{relatedTarget:0}),Jl=Ht(dm),hm=_({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=Ht(hm),gm=_({},ka,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pm=Ht(gm),mm=_({},ka,{data:0}),$u=Ht(mm),ym={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bm[e])?!!t[e]:!1}function Ql(){return xm}var _m=_({},er,{key:function(e){if(e.key){var t=ym[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ss(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ql,charCode:function(e){return e.type==="keypress"?ss(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ss(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jm=Ht(_m),Sm=_({},cs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gu=Ht(Sm),wm=_({},er,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ql}),Em=Ht(wm),Cm=_({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tm=Ht(Cm),Am=_({},cs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Om=Ht(Am),Rm=_({},ka,{newState:0,oldState:0}),Nm=Ht(Rm),km=[9,13,27,32],Xl=Bn&&"CompositionEvent"in window,nr=null;Bn&&"documentMode"in document&&(nr=document.documentMode);var zm=Bn&&"TextEvent"in window&&!nr,Pu=Bn&&(!Xl||nr&&8<nr&&11>=nr),Ku=" ",Yu=!1;function Ju(e,t){switch(e){case"keyup":return km.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ci=!1;function Um(e,t){switch(e){case"compositionend":return Qu(t);case"keypress":return t.which!==32?null:(Yu=!0,Ku);case"textInput":return e=t.data,e===Ku&&Yu?null:e;default:return null}}function Dm(e,t){if(ci)return e==="compositionend"||!Xl&&Ju(e,t)?(e=Hu(),rs=Pl=ea=null,ci=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Pu&&t.locale!=="ko"?null:t.data;default:return null}}var Bm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bm[e.type]:t==="textarea"}function Fu(e,t,n,i){li?oi?oi.push(i):oi=[i]:li=i,t=Zs(t,"onChange"),0<t.length&&(n=new os("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var ar=null,ir=null;function Mm(e){Uf(e,0)}function us(e){var t=it(e);if(ku(t))return e}function Zu(e,t){if(e==="change")return t}var Wu=!1;if(Bn){var Fl;if(Bn){var Zl="oninput"in document;if(!Zl){var ed=document.createElement("div");ed.setAttribute("oninput","return;"),Zl=typeof ed.oninput=="function"}Fl=Zl}else Fl=!1;Wu=Fl&&(!document.documentMode||9<document.documentMode)}function td(){ar&&(ar.detachEvent("onpropertychange",nd),ir=ar=null)}function nd(e){if(e.propertyName==="value"&&us(ir)){var t=[];Fu(t,ir,e,Vl(e)),Lu(Mm,t)}}function qm(e,t,n){e==="focusin"?(td(),ar=t,ir=n,ar.attachEvent("onpropertychange",nd)):e==="focusout"&&td()}function Lm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return us(ir)}function Hm(e,t){if(e==="click")return us(t)}function Im(e,t){if(e==="input"||e==="change")return us(t)}function Vm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Kt=typeof Object.is=="function"?Object.is:Vm;function rr(e,t){if(Kt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var c=n[i];if(!Nn.call(t,c)||!Kt(e[c],t[c]))return!1}return!0}function ad(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function id(e,t){var n=ad(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ad(n)}}function rd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function sd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=as(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=as(e.document)}return t}function Wl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var $m=Bn&&"documentMode"in document&&11>=document.documentMode,ui=null,eo=null,sr=null,to=!1;function ld(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;to||ui==null||ui!==as(i)||(i=ui,"selectionStart"in i&&Wl(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),sr&&rr(sr,i)||(sr=i,i=Zs(eo,"onSelect"),0<i.length&&(t=new os("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=ui)))}function za(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var di={animationend:za("Animation","AnimationEnd"),animationiteration:za("Animation","AnimationIteration"),animationstart:za("Animation","AnimationStart"),transitionrun:za("Transition","TransitionRun"),transitionstart:za("Transition","TransitionStart"),transitioncancel:za("Transition","TransitionCancel"),transitionend:za("Transition","TransitionEnd")},no={},od={};Bn&&(od=document.createElement("div").style,"AnimationEvent"in window||(delete di.animationend.animation,delete di.animationiteration.animation,delete di.animationstart.animation),"TransitionEvent"in window||delete di.transitionend.transition);function Ua(e){if(no[e])return no[e];if(!di[e])return e;var t=di[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in od)return no[e]=t[n];return e}var cd=Ua("animationend"),ud=Ua("animationiteration"),dd=Ua("animationstart"),Gm=Ua("transitionrun"),Pm=Ua("transitionstart"),Km=Ua("transitioncancel"),hd=Ua("transitionend"),fd=new Map,ao="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ao.push("scrollEnd");function vn(e,t){fd.set(e,t),an(t,[e])}var ds=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},ln=[],hi=0,io=0;function hs(){for(var e=hi,t=io=hi=0;t<e;){var n=ln[t];ln[t++]=null;var i=ln[t];ln[t++]=null;var c=ln[t];ln[t++]=null;var h=ln[t];if(ln[t++]=null,i!==null&&c!==null){var y=i.pending;y===null?c.next=c:(c.next=y.next,y.next=c),i.pending=c}h!==0&&gd(n,c,h)}}function fs(e,t,n,i){ln[hi++]=e,ln[hi++]=t,ln[hi++]=n,ln[hi++]=i,io|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function ro(e,t,n,i){return fs(e,t,n,i),gs(e)}function Da(e,t){return fs(e,null,null,t),gs(e)}function gd(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var c=!1,h=e.return;h!==null;)h.childLanes|=n,i=h.alternate,i!==null&&(i.childLanes|=n),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(c=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,c&&t!==null&&(c=31-Mt(n),e=h.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=n|536870912),h):null}function gs(e){if(50<Ar)throw Ar=0,pc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var fi={};function Ym(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(e,t,n,i){return new Ym(e,t,n,i)}function so(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Mn(e,t){var n=e.alternate;return n===null?(n=Yt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function pd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function ps(e,t,n,i,c,h){var y=0;if(i=e,typeof e=="function")so(e)&&(y=1);else if(typeof e=="string")y=Zy(e,n,Q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ce:return e=Yt(31,n,t,c),e.elementType=ce,e.lanes=h,e;case A:return Ba(n.children,c,h,t);case O:y=8,c|=24;break;case C:return e=Yt(12,n,t,c|2),e.elementType=C,e.lanes=h,e;case E:return e=Yt(13,n,t,c),e.elementType=E,e.lanes=h,e;case q:return e=Yt(19,n,t,c),e.elementType=q,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B:y=10;break e;case M:y=9;break e;case K:y=11;break e;case k:y=14;break e;case I:y=16,i=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),i=null}return t=Yt(y,n,t,c),t.elementType=e,t.type=i,t.lanes=h,t}function Ba(e,t,n,i){return e=Yt(7,e,i,t),e.lanes=n,e}function lo(e,t,n){return e=Yt(6,e,null,t),e.lanes=n,e}function md(e){var t=Yt(18,null,null,0);return t.stateNode=e,t}function oo(e,t,n){return t=Yt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var yd=new WeakMap;function on(e,t){if(typeof e=="object"&&e!==null){var n=yd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Lt(t)},yd.set(e,t),t)}return{value:e,source:t,stack:Lt(t)}}var gi=[],pi=0,ms=null,lr=0,cn=[],un=0,ta=null,Tn=1,An="";function qn(e,t){gi[pi++]=lr,gi[pi++]=ms,ms=e,lr=t}function vd(e,t,n){cn[un++]=Tn,cn[un++]=An,cn[un++]=ta,ta=e;var i=Tn;e=An;var c=32-Mt(i)-1;i&=~(1<<c),n+=1;var h=32-Mt(t)+c;if(30<h){var y=c-c%5;h=(i&(1<<y)-1).toString(32),i>>=y,c-=y,Tn=1<<32-Mt(t)+c|n<<c|i,An=h+e}else Tn=1<<h|n<<c|i,An=e}function co(e){e.return!==null&&(qn(e,1),vd(e,1,0))}function uo(e){for(;e===ms;)ms=gi[--pi],gi[pi]=null,lr=gi[--pi],gi[pi]=null;for(;e===ta;)ta=cn[--un],cn[un]=null,An=cn[--un],cn[un]=null,Tn=cn[--un],cn[un]=null}function bd(e,t){cn[un++]=Tn,cn[un++]=An,cn[un++]=ta,Tn=t.id,An=t.overflow,ta=e}var Ct=null,st=null,Ve=!1,na=null,dn=!1,ho=Error(l(519));function aa(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw or(on(t,e)),ho}function xd(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[ye]=e,t[me]=i,n){case"dialog":Me("cancel",t),Me("close",t);break;case"iframe":case"object":case"embed":Me("load",t);break;case"video":case"audio":for(n=0;n<Rr.length;n++)Me(Rr[n],t);break;case"source":Me("error",t);break;case"img":case"image":case"link":Me("error",t),Me("load",t);break;case"details":Me("toggle",t);break;case"input":Me("invalid",t),zu(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Me("invalid",t);break;case"textarea":Me("invalid",t),Du(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||qf(t.textContent,n)?(i.popover!=null&&(Me("beforetoggle",t),Me("toggle",t)),i.onScroll!=null&&Me("scroll",t),i.onScrollEnd!=null&&Me("scrollend",t),i.onClick!=null&&(t.onclick=Dn),t=!0):t=!1,t||aa(e,!0)}function _d(e){for(Ct=e.return;Ct;)switch(Ct.tag){case 5:case 31:case 13:dn=!1;return;case 27:case 3:dn=!0;return;default:Ct=Ct.return}}function mi(e){if(e!==Ct)return!1;if(!Ve)return _d(e),Ve=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Rc(e.type,e.memoizedProps)),n=!n),n&&st&&aa(e),_d(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));st=Yf(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));st=Yf(e)}else t===27?(t=st,ya(e.type)?(e=Dc,Dc=null,st=e):st=t):st=Ct?fn(e.stateNode.nextSibling):null;return!0}function Ma(){st=Ct=null,Ve=!1}function fo(){var e=na;return e!==null&&(Gt===null?Gt=e:Gt.push.apply(Gt,e),na=null),e}function or(e){na===null?na=[e]:na.push(e)}var go=T(null),qa=null,Ln=null;function ia(e,t,n){P(go,t._currentValue),t._currentValue=n}function Hn(e){e._currentValue=go.current,z(go)}function po(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function mo(e,t,n,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var h=c.dependencies;if(h!==null){var y=c.child;h=h.firstContext;e:for(;h!==null;){var x=h;h=c;for(var R=0;R<t.length;R++)if(x.context===t[R]){h.lanes|=n,x=h.alternate,x!==null&&(x.lanes|=n),po(h.return,n,e),i||(y=null);break e}h=x.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,h=y.alternate,h!==null&&(h.lanes|=n),po(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function yi(e,t,n,i){e=null;for(var c=t,h=!1;c!==null;){if(!h){if((c.flags&524288)!==0)h=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var x=c.type;Kt(c.pendingProps.value,y.value)||(e!==null?e.push(x):e=[x])}}else if(c===de.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Dr):e=[Dr])}c=c.return}e!==null&&mo(t,e,n,i),t.flags|=262144}function ys(e){for(e=e.firstContext;e!==null;){if(!Kt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function La(e){qa=e,Ln=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Tt(e){return jd(qa,e)}function vs(e,t){return qa===null&&La(e),jd(e,t)}function jd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Ln===null){if(e===null)throw Error(l(308));Ln=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ln=Ln.next=t;return n}var Jm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Qm=o.unstable_scheduleCallback,Xm=o.unstable_NormalPriority,yt={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yo(){return{controller:new Jm,data:new Map,refCount:0}}function cr(e){e.refCount--,e.refCount===0&&Qm(Xm,function(){e.controller.abort()})}var ur=null,vo=0,vi=0,bi=null;function Fm(e,t){if(ur===null){var n=ur=[];vo=0,vi=_c(),bi={status:"pending",value:void 0,then:function(i){n.push(i)}}}return vo++,t.then(Sd,Sd),t}function Sd(){if(--vo===0&&ur!==null){bi!==null&&(bi.status="fulfilled");var e=ur;ur=null,vi=0,bi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Zm(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),i}var wd=U.S;U.S=function(e,t){of=Dt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Fm(e,t),wd!==null&&wd(e,t)};var Ha=T(null);function bo(){var e=Ha.current;return e!==null?e:tt.pooledCache}function bs(e,t){t===null?P(Ha,Ha.current):P(Ha,t.pool)}function Ed(){var e=bo();return e===null?null:{parent:yt._currentValue,pool:e}}var xi=Error(l(460)),xo=Error(l(474)),xs=Error(l(542)),_s={then:function(){}};function Cd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Td(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Dn,Dn),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Od(e),e;default:if(typeof t.status=="string")t.then(Dn,Dn);else{if(e=tt,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Od(e),e}throw Va=t,xi}}function Ia(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Va=n,xi):n}}var Va=null;function Ad(){if(Va===null)throw Error(l(459));var e=Va;return Va=null,e}function Od(e){if(e===xi||e===xs)throw Error(l(483))}var _i=null,dr=0;function js(e){var t=dr;return dr+=1,_i===null&&(_i=[]),Td(_i,e,t)}function hr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ss(e,t){throw t.$$typeof===j?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Rd(e){function t(H,N){if(e){var V=H.deletions;V===null?(H.deletions=[N],H.flags|=16):V.push(N)}}function n(H,N){if(!e)return null;for(;N!==null;)t(H,N),N=N.sibling;return null}function i(H){for(var N=new Map;H!==null;)H.key!==null?N.set(H.key,H):N.set(H.index,H),H=H.sibling;return N}function c(H,N){return H=Mn(H,N),H.index=0,H.sibling=null,H}function h(H,N,V){return H.index=V,e?(V=H.alternate,V!==null?(V=V.index,V<N?(H.flags|=67108866,N):V):(H.flags|=67108866,N)):(H.flags|=1048576,N)}function y(H){return e&&H.alternate===null&&(H.flags|=67108866),H}function x(H,N,V,ne){return N===null||N.tag!==6?(N=lo(V,H.mode,ne),N.return=H,N):(N=c(N,V),N.return=H,N)}function R(H,N,V,ne){var Se=V.type;return Se===A?te(H,N,V.props.children,ne,V.key):N!==null&&(N.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===I&&Ia(Se)===N.type)?(N=c(N,V.props),hr(N,V),N.return=H,N):(N=ps(V.type,V.key,V.props,null,H.mode,ne),hr(N,V),N.return=H,N)}function G(H,N,V,ne){return N===null||N.tag!==4||N.stateNode.containerInfo!==V.containerInfo||N.stateNode.implementation!==V.implementation?(N=oo(V,H.mode,ne),N.return=H,N):(N=c(N,V.children||[]),N.return=H,N)}function te(H,N,V,ne,Se){return N===null||N.tag!==7?(N=Ba(V,H.mode,ne,Se),N.return=H,N):(N=c(N,V),N.return=H,N)}function ie(H,N,V){if(typeof N=="string"&&N!==""||typeof N=="number"||typeof N=="bigint")return N=lo(""+N,H.mode,V),N.return=H,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case b:return V=ps(N.type,N.key,N.props,null,H.mode,V),hr(V,N),V.return=H,V;case w:return N=oo(N,H.mode,V),N.return=H,N;case I:return N=Ia(N),ie(H,N,V)}if(pe(N)||Z(N))return N=Ba(N,H.mode,V,null),N.return=H,N;if(typeof N.then=="function")return ie(H,js(N),V);if(N.$$typeof===B)return ie(H,vs(H,N),V);Ss(H,N)}return null}function Y(H,N,V,ne){var Se=N!==null?N.key:null;if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return Se!==null?null:x(H,N,""+V,ne);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case b:return V.key===Se?R(H,N,V,ne):null;case w:return V.key===Se?G(H,N,V,ne):null;case I:return V=Ia(V),Y(H,N,V,ne)}if(pe(V)||Z(V))return Se!==null?null:te(H,N,V,ne,null);if(typeof V.then=="function")return Y(H,N,js(V),ne);if(V.$$typeof===B)return Y(H,N,vs(H,V),ne);Ss(H,V)}return null}function X(H,N,V,ne,Se){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return H=H.get(V)||null,x(N,H,""+ne,Se);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:return H=H.get(ne.key===null?V:ne.key)||null,R(N,H,ne,Se);case w:return H=H.get(ne.key===null?V:ne.key)||null,G(N,H,ne,Se);case I:return ne=Ia(ne),X(H,N,V,ne,Se)}if(pe(ne)||Z(ne))return H=H.get(V)||null,te(N,H,ne,Se,null);if(typeof ne.then=="function")return X(H,N,V,js(ne),Se);if(ne.$$typeof===B)return X(H,N,V,vs(N,ne),Se);Ss(N,ne)}return null}function ve(H,N,V,ne){for(var Se=null,Ke=null,xe=N,Ue=N=0,Ie=null;xe!==null&&Ue<V.length;Ue++){xe.index>Ue?(Ie=xe,xe=null):Ie=xe.sibling;var Ye=Y(H,xe,V[Ue],ne);if(Ye===null){xe===null&&(xe=Ie);break}e&&xe&&Ye.alternate===null&&t(H,xe),N=h(Ye,N,Ue),Ke===null?Se=Ye:Ke.sibling=Ye,Ke=Ye,xe=Ie}if(Ue===V.length)return n(H,xe),Ve&&qn(H,Ue),Se;if(xe===null){for(;Ue<V.length;Ue++)xe=ie(H,V[Ue],ne),xe!==null&&(N=h(xe,N,Ue),Ke===null?Se=xe:Ke.sibling=xe,Ke=xe);return Ve&&qn(H,Ue),Se}for(xe=i(xe);Ue<V.length;Ue++)Ie=X(xe,H,Ue,V[Ue],ne),Ie!==null&&(e&&Ie.alternate!==null&&xe.delete(Ie.key===null?Ue:Ie.key),N=h(Ie,N,Ue),Ke===null?Se=Ie:Ke.sibling=Ie,Ke=Ie);return e&&xe.forEach(function(ja){return t(H,ja)}),Ve&&qn(H,Ue),Se}function Ee(H,N,V,ne){if(V==null)throw Error(l(151));for(var Se=null,Ke=null,xe=N,Ue=N=0,Ie=null,Ye=V.next();xe!==null&&!Ye.done;Ue++,Ye=V.next()){xe.index>Ue?(Ie=xe,xe=null):Ie=xe.sibling;var ja=Y(H,xe,Ye.value,ne);if(ja===null){xe===null&&(xe=Ie);break}e&&xe&&ja.alternate===null&&t(H,xe),N=h(ja,N,Ue),Ke===null?Se=ja:Ke.sibling=ja,Ke=ja,xe=Ie}if(Ye.done)return n(H,xe),Ve&&qn(H,Ue),Se;if(xe===null){for(;!Ye.done;Ue++,Ye=V.next())Ye=ie(H,Ye.value,ne),Ye!==null&&(N=h(Ye,N,Ue),Ke===null?Se=Ye:Ke.sibling=Ye,Ke=Ye);return Ve&&qn(H,Ue),Se}for(xe=i(xe);!Ye.done;Ue++,Ye=V.next())Ye=X(xe,H,Ue,Ye.value,ne),Ye!==null&&(e&&Ye.alternate!==null&&xe.delete(Ye.key===null?Ue:Ye.key),N=h(Ye,N,Ue),Ke===null?Se=Ye:Ke.sibling=Ye,Ke=Ye);return e&&xe.forEach(function(cv){return t(H,cv)}),Ve&&qn(H,Ue),Se}function et(H,N,V,ne){if(typeof V=="object"&&V!==null&&V.type===A&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case b:e:{for(var Se=V.key;N!==null;){if(N.key===Se){if(Se=V.type,Se===A){if(N.tag===7){n(H,N.sibling),ne=c(N,V.props.children),ne.return=H,H=ne;break e}}else if(N.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===I&&Ia(Se)===N.type){n(H,N.sibling),ne=c(N,V.props),hr(ne,V),ne.return=H,H=ne;break e}n(H,N);break}else t(H,N);N=N.sibling}V.type===A?(ne=Ba(V.props.children,H.mode,ne,V.key),ne.return=H,H=ne):(ne=ps(V.type,V.key,V.props,null,H.mode,ne),hr(ne,V),ne.return=H,H=ne)}return y(H);case w:e:{for(Se=V.key;N!==null;){if(N.key===Se)if(N.tag===4&&N.stateNode.containerInfo===V.containerInfo&&N.stateNode.implementation===V.implementation){n(H,N.sibling),ne=c(N,V.children||[]),ne.return=H,H=ne;break e}else{n(H,N);break}else t(H,N);N=N.sibling}ne=oo(V,H.mode,ne),ne.return=H,H=ne}return y(H);case I:return V=Ia(V),et(H,N,V,ne)}if(pe(V))return ve(H,N,V,ne);if(Z(V)){if(Se=Z(V),typeof Se!="function")throw Error(l(150));return V=Se.call(V),Ee(H,N,V,ne)}if(typeof V.then=="function")return et(H,N,js(V),ne);if(V.$$typeof===B)return et(H,N,vs(H,V),ne);Ss(H,V)}return typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint"?(V=""+V,N!==null&&N.tag===6?(n(H,N.sibling),ne=c(N,V),ne.return=H,H=ne):(n(H,N),ne=lo(V,H.mode,ne),ne.return=H,H=ne),y(H)):n(H,N)}return function(H,N,V,ne){try{dr=0;var Se=et(H,N,V,ne);return _i=null,Se}catch(xe){if(xe===xi||xe===xs)throw xe;var Ke=Yt(29,xe,null,H.mode);return Ke.lanes=ne,Ke.return=H,Ke}finally{}}}var $a=Rd(!0),Nd=Rd(!1),ra=!1;function _o(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function sa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function la(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Qe&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=gs(e),gd(e,null,n),t}return fs(e,i,t,n),gs(e)}function fr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Qi(e,n)}}function So(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var c=null,h=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};h===null?c=h=y:h=h.next=y,n=n.next}while(n!==null);h===null?c=h=t:h=h.next=t}else c=h=t;n={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var wo=!1;function gr(){if(wo){var e=bi;if(e!==null)throw e}}function pr(e,t,n,i){wo=!1;var c=e.updateQueue;ra=!1;var h=c.firstBaseUpdate,y=c.lastBaseUpdate,x=c.shared.pending;if(x!==null){c.shared.pending=null;var R=x,G=R.next;R.next=null,y===null?h=G:y.next=G,y=R;var te=e.alternate;te!==null&&(te=te.updateQueue,x=te.lastBaseUpdate,x!==y&&(x===null?te.firstBaseUpdate=G:x.next=G,te.lastBaseUpdate=R))}if(h!==null){var ie=c.baseState;y=0,te=G=R=null,x=h;do{var Y=x.lane&-536870913,X=Y!==x.lane;if(X?(He&Y)===Y:(i&Y)===Y){Y!==0&&Y===vi&&(wo=!0),te!==null&&(te=te.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var ve=e,Ee=x;Y=t;var et=n;switch(Ee.tag){case 1:if(ve=Ee.payload,typeof ve=="function"){ie=ve.call(et,ie,Y);break e}ie=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=Ee.payload,Y=typeof ve=="function"?ve.call(et,ie,Y):ve,Y==null)break e;ie=_({},ie,Y);break e;case 2:ra=!0}}Y=x.callback,Y!==null&&(e.flags|=64,X&&(e.flags|=8192),X=c.callbacks,X===null?c.callbacks=[Y]:X.push(Y))}else X={lane:Y,tag:x.tag,payload:x.payload,callback:x.callback,next:null},te===null?(G=te=X,R=ie):te=te.next=X,y|=Y;if(x=x.next,x===null){if(x=c.shared.pending,x===null)break;X=x,x=X.next,X.next=null,c.lastBaseUpdate=X,c.shared.pending=null}}while(!0);te===null&&(R=ie),c.baseState=R,c.firstBaseUpdate=G,c.lastBaseUpdate=te,h===null&&(c.shared.lanes=0),ha|=y,e.lanes=y,e.memoizedState=ie}}function kd(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function zd(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)kd(n[e],t)}var ji=T(null),ws=T(0);function Ud(e,t){e=Qn,P(ws,e),P(ji,t),Qn=e|t.baseLanes}function Eo(){P(ws,Qn),P(ji,ji.current)}function Co(){Qn=ws.current,z(ji),z(ws)}var Jt=T(null),hn=null;function oa(e){var t=e.alternate;P(gt,gt.current&1),P(Jt,e),hn===null&&(t===null||ji.current!==null||t.memoizedState!==null)&&(hn=e)}function To(e){P(gt,gt.current),P(Jt,e),hn===null&&(hn=e)}function Dd(e){e.tag===22?(P(gt,gt.current),P(Jt,e),hn===null&&(hn=e)):ca()}function ca(){P(gt,gt.current),P(Jt,Jt.current)}function Qt(e){z(Jt),hn===e&&(hn=null),z(gt)}var gt=T(0);function Es(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||zc(n)||Uc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var In=0,ze=null,Ze=null,vt=null,Cs=!1,Si=!1,Ga=!1,Ts=0,mr=0,wi=null,Wm=0;function ht(){throw Error(l(321))}function Ao(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kt(e[n],t[n]))return!1;return!0}function Oo(e,t,n,i,c,h){return In=h,ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,U.H=e===null||e.memoizedState===null?vh:Go,Ga=!1,h=n(i,c),Ga=!1,Si&&(h=Md(t,n,i,c)),Bd(e),h}function Bd(e){U.H=br;var t=Ze!==null&&Ze.next!==null;if(In=0,vt=Ze=ze=null,Cs=!1,mr=0,wi=null,t)throw Error(l(300));e===null||bt||(e=e.dependencies,e!==null&&ys(e)&&(bt=!0))}function Md(e,t,n,i){ze=e;var c=0;do{if(Si&&(wi=null),mr=0,Si=!1,25<=c)throw Error(l(301));if(c+=1,vt=Ze=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}U.H=bh,h=t(n,i)}while(Si);return h}function ey(){var e=U.H,t=e.useState()[0];return t=typeof t.then=="function"?yr(t):t,e=e.useState()[0],(Ze!==null?Ze.memoizedState:null)!==e&&(ze.flags|=1024),t}function Ro(){var e=Ts!==0;return Ts=0,e}function No(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ko(e){if(Cs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Cs=!1}In=0,vt=Ze=ze=null,Si=!1,mr=Ts=0,wi=null}function qt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?ze.memoizedState=vt=e:vt=vt.next=e,vt}function pt(){if(Ze===null){var e=ze.alternate;e=e!==null?e.memoizedState:null}else e=Ze.next;var t=vt===null?ze.memoizedState:vt.next;if(t!==null)vt=t,Ze=e;else{if(e===null)throw ze.alternate===null?Error(l(467)):Error(l(310));Ze=e,e={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},vt===null?ze.memoizedState=vt=e:vt=vt.next=e}return vt}function As(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yr(e){var t=mr;return mr+=1,wi===null&&(wi=[]),e=Td(wi,e,t),t=ze,(vt===null?t.memoizedState:vt.next)===null&&(t=t.alternate,U.H=t===null||t.memoizedState===null?vh:Go),e}function Os(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return yr(e);if(e.$$typeof===B)return Tt(e)}throw Error(l(438,String(e)))}function zo(e){var t=null,n=ze.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=ze.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=As(),ze.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=J;return t.index++,n}function Vn(e,t){return typeof t=="function"?t(e):t}function Rs(e){var t=pt();return Uo(t,Ze,e)}function Uo(e,t,n){var i=e.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=n;var c=e.baseQueue,h=i.pending;if(h!==null){if(c!==null){var y=c.next;c.next=h.next,h.next=y}t.baseQueue=c=h,i.pending=null}if(h=e.baseState,c===null)e.memoizedState=h;else{t=c.next;var x=y=null,R=null,G=t,te=!1;do{var ie=G.lane&-536870913;if(ie!==G.lane?(He&ie)===ie:(In&ie)===ie){var Y=G.revertLane;if(Y===0)R!==null&&(R=R.next={lane:0,revertLane:0,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null}),ie===vi&&(te=!0);else if((In&Y)===Y){G=G.next,Y===vi&&(te=!0);continue}else ie={lane:0,revertLane:G.revertLane,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},R===null?(x=R=ie,y=h):R=R.next=ie,ze.lanes|=Y,ha|=Y;ie=G.action,Ga&&n(h,ie),h=G.hasEagerState?G.eagerState:n(h,ie)}else Y={lane:ie,revertLane:G.revertLane,gesture:G.gesture,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},R===null?(x=R=Y,y=h):R=R.next=Y,ze.lanes|=ie,ha|=ie;G=G.next}while(G!==null&&G!==t);if(R===null?y=h:R.next=x,!Kt(h,e.memoizedState)&&(bt=!0,te&&(n=bi,n!==null)))throw n;e.memoizedState=h,e.baseState=y,e.baseQueue=R,i.lastRenderedState=h}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Do(e){var t=pt(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var i=n.dispatch,c=n.pending,h=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do h=e(h,y.action),y=y.next;while(y!==c);Kt(h,t.memoizedState)||(bt=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),n.lastRenderedState=h}return[h,i]}function qd(e,t,n){var i=ze,c=pt(),h=Ve;if(h){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!Kt((Ze||c).memoizedState,n);if(y&&(c.memoizedState=n,bt=!0),c=c.queue,qo(Id.bind(null,i,c,e),[e]),c.getSnapshot!==t||y||vt!==null&&vt.memoizedState.tag&1){if(i.flags|=2048,Ei(9,{destroy:void 0},Hd.bind(null,i,c,n,t),null),tt===null)throw Error(l(349));h||(In&127)!==0||Ld(i,t,n)}return n}function Ld(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ze.updateQueue,t===null?(t=As(),ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Hd(e,t,n,i){t.value=n,t.getSnapshot=i,Vd(t)&&$d(e)}function Id(e,t,n){return n(function(){Vd(t)&&$d(e)})}function Vd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kt(e,n)}catch{return!0}}function $d(e){var t=Da(e,2);t!==null&&Pt(t,e,2)}function Bo(e){var t=qt();if(typeof e=="function"){var n=e;if(e=n(),Ga){En(!0);try{n()}finally{En(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vn,lastRenderedState:e},t}function Gd(e,t,n,i){return e.baseState=n,Uo(e,Ze,typeof i=="function"?i:Vn)}function ty(e,t,n,i,c){if(zs(e))throw Error(l(485));if(e=t.action,e!==null){var h={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){h.listeners.push(y)}};U.T!==null?n(!0):h.isTransition=!1,i(h),n=t.pending,n===null?(h.next=t.pending=h,Pd(t,h)):(h.next=n.next,t.pending=n.next=h)}}function Pd(e,t){var n=t.action,i=t.payload,c=e.state;if(t.isTransition){var h=U.T,y={};U.T=y;try{var x=n(c,i),R=U.S;R!==null&&R(y,x),Kd(e,t,x)}catch(G){Mo(e,t,G)}finally{h!==null&&y.types!==null&&(h.types=y.types),U.T=h}}else try{h=n(c,i),Kd(e,t,h)}catch(G){Mo(e,t,G)}}function Kd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Yd(e,t,i)},function(i){return Mo(e,t,i)}):Yd(e,t,n)}function Yd(e,t,n){t.status="fulfilled",t.value=n,Jd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Pd(e,n)))}function Mo(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,Jd(t),t=t.next;while(t!==i)}e.action=null}function Jd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Qd(e,t){return t}function Xd(e,t){if(Ve){var n=tt.formState;if(n!==null){e:{var i=ze;if(Ve){if(st){t:{for(var c=st,h=dn;c.nodeType!==8;){if(!h){c=null;break t}if(c=fn(c.nextSibling),c===null){c=null;break t}}h=c.data,c=h==="F!"||h==="F"?c:null}if(c){st=fn(c.nextSibling),i=c.data==="F!";break e}}aa(i)}i=!1}i&&(t=n[0])}}return n=qt(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qd,lastRenderedState:t},n.queue=i,n=ph.bind(null,ze,i),i.dispatch=n,i=Bo(!1),h=$o.bind(null,ze,!1,i.queue),i=qt(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,n=ty.bind(null,ze,c,h,n),c.dispatch=n,i.memoizedState=e,[t,n,!1]}function Fd(e){var t=pt();return Zd(t,Ze,e)}function Zd(e,t,n){if(t=Uo(e,t,Qd)[0],e=Rs(Vn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=yr(t)}catch(y){throw y===xi?xs:y}else i=t;t=pt();var c=t.queue,h=c.dispatch;return n!==t.memoizedState&&(ze.flags|=2048,Ei(9,{destroy:void 0},ny.bind(null,c,n),null)),[i,h,e]}function ny(e,t){e.action=t}function Wd(e){var t=pt(),n=Ze;if(n!==null)return Zd(t,n,e);pt(),t=t.memoizedState,n=pt();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Ei(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},t=ze.updateQueue,t===null&&(t=As(),ze.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function eh(){return pt().memoizedState}function Ns(e,t,n,i){var c=qt();ze.flags|=e,c.memoizedState=Ei(1|t,{destroy:void 0},n,i===void 0?null:i)}function ks(e,t,n,i){var c=pt();i=i===void 0?null:i;var h=c.memoizedState.inst;Ze!==null&&i!==null&&Ao(i,Ze.memoizedState.deps)?c.memoizedState=Ei(t,h,n,i):(ze.flags|=e,c.memoizedState=Ei(1|t,h,n,i))}function th(e,t){Ns(8390656,8,e,t)}function qo(e,t){ks(2048,8,e,t)}function ay(e){ze.flags|=4;var t=ze.updateQueue;if(t===null)t=As(),ze.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function nh(e){var t=pt().memoizedState;return ay({ref:t,nextImpl:e}),function(){if((Qe&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function ah(e,t){return ks(4,2,e,t)}function ih(e,t){return ks(4,4,e,t)}function rh(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function sh(e,t,n){n=n!=null?n.concat([e]):null,ks(4,4,rh.bind(null,t,e),n)}function Lo(){}function lh(e,t){var n=pt();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&Ao(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function oh(e,t){var n=pt();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&Ao(t,i[1]))return i[0];if(i=e(),Ga){En(!0);try{e()}finally{En(!1)}}return n.memoizedState=[i,t],i}function Ho(e,t,n){return n===void 0||(In&1073741824)!==0&&(He&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=uf(),ze.lanes|=e,ha|=e,n)}function ch(e,t,n,i){return Kt(n,t)?n:ji.current!==null?(e=Ho(e,n,i),Kt(e,t)||(bt=!0),e):(In&42)===0||(In&1073741824)!==0&&(He&261930)===0?(bt=!0,e.memoizedState=n):(e=uf(),ze.lanes|=e,ha|=e,t)}function uh(e,t,n,i,c){var h=L.p;L.p=h!==0&&8>h?h:8;var y=U.T,x={};U.T=x,$o(e,!1,t,n);try{var R=c(),G=U.S;if(G!==null&&G(x,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var te=Zm(R,i);vr(e,t,te,Zt(e))}else vr(e,t,i,Zt(e))}catch(ie){vr(e,t,{then:function(){},status:"rejected",reason:ie},Zt())}finally{L.p=h,y!==null&&x.types!==null&&(y.types=x.types),U.T=y}}function iy(){}function Io(e,t,n,i){if(e.tag!==5)throw Error(l(476));var c=dh(e).queue;uh(e,c,t,ee,n===null?iy:function(){return hh(e),n(i)})}function dh(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vn,lastRenderedState:ee},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function hh(e){var t=dh(e);t.next===null&&(t=e.alternate.memoizedState),vr(e,t.next.queue,{},Zt())}function Vo(){return Tt(Dr)}function fh(){return pt().memoizedState}function gh(){return pt().memoizedState}function ry(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Zt();e=sa(n);var i=la(t,e,n);i!==null&&(Pt(i,t,n),fr(i,t,n)),t={cache:yo()},e.payload=t;return}t=t.return}}function sy(e,t,n){var i=Zt();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},zs(e)?mh(t,n):(n=ro(e,t,n,i),n!==null&&(Pt(n,e,i),yh(n,t,i)))}function ph(e,t,n){var i=Zt();vr(e,t,n,i)}function vr(e,t,n,i){var c={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(zs(e))mh(t,c);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var y=t.lastRenderedState,x=h(y,n);if(c.hasEagerState=!0,c.eagerState=x,Kt(x,y))return fs(e,t,c,0),tt===null&&hs(),!1}catch{}finally{}if(n=ro(e,t,c,i),n!==null)return Pt(n,e,i),yh(n,t,i),!0}return!1}function $o(e,t,n,i){if(i={lane:2,revertLane:_c(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},zs(e)){if(t)throw Error(l(479))}else t=ro(e,n,i,2),t!==null&&Pt(t,e,2)}function zs(e){var t=e.alternate;return e===ze||t!==null&&t===ze}function mh(e,t){Si=Cs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function yh(e,t,n){if((n&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Qi(e,n)}}var br={readContext:Tt,use:Os,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useLayoutEffect:ht,useInsertionEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useSyncExternalStore:ht,useId:ht,useHostTransitionStatus:ht,useFormState:ht,useActionState:ht,useOptimistic:ht,useMemoCache:ht,useCacheRefresh:ht};br.useEffectEvent=ht;var vh={readContext:Tt,use:Os,useCallback:function(e,t){return qt().memoizedState=[e,t===void 0?null:t],e},useContext:Tt,useEffect:th,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Ns(4194308,4,rh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ns(4194308,4,e,t)},useInsertionEffect:function(e,t){Ns(4,2,e,t)},useMemo:function(e,t){var n=qt();t=t===void 0?null:t;var i=e();if(Ga){En(!0);try{e()}finally{En(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=qt();if(n!==void 0){var c=n(t);if(Ga){En(!0);try{n(t)}finally{En(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=sy.bind(null,ze,e),[i.memoizedState,e]},useRef:function(e){var t=qt();return e={current:e},t.memoizedState=e},useState:function(e){e=Bo(e);var t=e.queue,n=ph.bind(null,ze,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Lo,useDeferredValue:function(e,t){var n=qt();return Ho(n,e,t)},useTransition:function(){var e=Bo(!1);return e=uh.bind(null,ze,e.queue,!0,!1),qt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=ze,c=qt();if(Ve){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),tt===null)throw Error(l(349));(He&127)!==0||Ld(i,t,n)}c.memoizedState=n;var h={value:n,getSnapshot:t};return c.queue=h,th(Id.bind(null,i,h,e),[e]),i.flags|=2048,Ei(9,{destroy:void 0},Hd.bind(null,i,h,n,t),null),n},useId:function(){var e=qt(),t=tt.identifierPrefix;if(Ve){var n=An,i=Tn;n=(i&~(1<<32-Mt(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Ts++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Wm++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Vo,useFormState:Xd,useActionState:Xd,useOptimistic:function(e){var t=qt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=$o.bind(null,ze,!0,n),n.dispatch=t,[e,t]},useMemoCache:zo,useCacheRefresh:function(){return qt().memoizedState=ry.bind(null,ze)},useEffectEvent:function(e){var t=qt(),n={impl:e};return t.memoizedState=n,function(){if((Qe&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},Go={readContext:Tt,use:Os,useCallback:lh,useContext:Tt,useEffect:qo,useImperativeHandle:sh,useInsertionEffect:ah,useLayoutEffect:ih,useMemo:oh,useReducer:Rs,useRef:eh,useState:function(){return Rs(Vn)},useDebugValue:Lo,useDeferredValue:function(e,t){var n=pt();return ch(n,Ze.memoizedState,e,t)},useTransition:function(){var e=Rs(Vn)[0],t=pt().memoizedState;return[typeof e=="boolean"?e:yr(e),t]},useSyncExternalStore:qd,useId:fh,useHostTransitionStatus:Vo,useFormState:Fd,useActionState:Fd,useOptimistic:function(e,t){var n=pt();return Gd(n,Ze,e,t)},useMemoCache:zo,useCacheRefresh:gh};Go.useEffectEvent=nh;var bh={readContext:Tt,use:Os,useCallback:lh,useContext:Tt,useEffect:qo,useImperativeHandle:sh,useInsertionEffect:ah,useLayoutEffect:ih,useMemo:oh,useReducer:Do,useRef:eh,useState:function(){return Do(Vn)},useDebugValue:Lo,useDeferredValue:function(e,t){var n=pt();return Ze===null?Ho(n,e,t):ch(n,Ze.memoizedState,e,t)},useTransition:function(){var e=Do(Vn)[0],t=pt().memoizedState;return[typeof e=="boolean"?e:yr(e),t]},useSyncExternalStore:qd,useId:fh,useHostTransitionStatus:Vo,useFormState:Wd,useActionState:Wd,useOptimistic:function(e,t){var n=pt();return Ze!==null?Gd(n,Ze,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:zo,useCacheRefresh:gh};bh.useEffectEvent=nh;function Po(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:_({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ko={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Zt(),c=sa(i);c.payload=t,n!=null&&(c.callback=n),t=la(e,c,i),t!==null&&(Pt(t,e,i),fr(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Zt(),c=sa(i);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=la(e,c,i),t!==null&&(Pt(t,e,i),fr(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Zt(),i=sa(n);i.tag=2,t!=null&&(i.callback=t),t=la(e,i,n),t!==null&&(Pt(t,e,n),fr(t,e,n))}};function xh(e,t,n,i,c,h,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,h,y):t.prototype&&t.prototype.isPureReactComponent?!rr(n,i)||!rr(c,h):!0}function _h(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Ko.enqueueReplaceState(t,t.state,null)}function Pa(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=_({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function jh(e){ds(e)}function Sh(e){console.error(e)}function wh(e){ds(e)}function Us(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Eh(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function Yo(e,t,n){return n=sa(n),n.tag=3,n.payload={element:null},n.callback=function(){Us(e,t)},n}function Ch(e){return e=sa(e),e.tag=3,e}function Th(e,t,n,i){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=i.value;e.payload=function(){return c(h)},e.callback=function(){Eh(t,n,i)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Eh(t,n,i),typeof c!="function"&&(fa===null?fa=new Set([this]):fa.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})})}function ly(e,t,n,i,c){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&yi(t,n,c,!0),n=Jt.current,n!==null){switch(n.tag){case 31:case 13:return hn===null?Ks():n.alternate===null&&ft===0&&(ft=3),n.flags&=-257,n.flags|=65536,n.lanes=c,i===_s?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),vc(e,i,c)),!1;case 22:return n.flags|=65536,i===_s?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),vc(e,i,c)),!1}throw Error(l(435,n.tag))}return vc(e,i,c),Ks(),!1}if(Ve)return t=Jt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==ho&&(e=Error(l(422),{cause:i}),or(on(e,n)))):(i!==ho&&(t=Error(l(423),{cause:i}),or(on(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=on(i,n),c=Yo(e.stateNode,i,c),So(e,c),ft!==4&&(ft=2)),!1;var h=Error(l(520),{cause:i});if(h=on(h,n),Tr===null?Tr=[h]:Tr.push(h),ft!==4&&(ft=2),t===null)return!0;i=on(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=Yo(n.stateNode,i,e),So(n,e),!1;case 1:if(t=n.type,h=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(fa===null||!fa.has(h))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Ch(c),Th(c,e,n,i),So(n,c),!1}n=n.return}while(n!==null);return!1}var Jo=Error(l(461)),bt=!1;function At(e,t,n,i){t.child=e===null?Nd(t,null,n,i):$a(t,e.child,n,i)}function Ah(e,t,n,i,c){n=n.render;var h=t.ref;if("ref"in i){var y={};for(var x in i)x!=="ref"&&(y[x]=i[x])}else y=i;return La(t),i=Oo(e,t,n,y,h,c),x=Ro(),e!==null&&!bt?(No(e,t,c),$n(e,t,c)):(Ve&&x&&co(t),t.flags|=1,At(e,t,i,c),t.child)}function Oh(e,t,n,i,c){if(e===null){var h=n.type;return typeof h=="function"&&!so(h)&&h.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=h,Rh(e,t,h,i,c)):(e=ps(n.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!nc(e,c)){var y=h.memoizedProps;if(n=n.compare,n=n!==null?n:rr,n(y,i)&&e.ref===t.ref)return $n(e,t,c)}return t.flags|=1,e=Mn(h,i),e.ref=t.ref,e.return=t,t.child=e}function Rh(e,t,n,i,c){if(e!==null){var h=e.memoizedProps;if(rr(h,i)&&e.ref===t.ref)if(bt=!1,t.pendingProps=i=h,nc(e,c))(e.flags&131072)!==0&&(bt=!0);else return t.lanes=e.lanes,$n(e,t,c)}return Qo(e,t,n,i,c)}function Nh(e,t,n,i){var c=i.children,h=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(h=h!==null?h.baseLanes|n:n,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~h}else i=0,t.child=null;return kh(e,t,h,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&bs(t,h!==null?h.cachePool:null),h!==null?Ud(t,h):Eo(),Dd(t);else return i=t.lanes=536870912,kh(e,t,h!==null?h.baseLanes|n:n,n,i)}else h!==null?(bs(t,h.cachePool),Ud(t,h),ca(),t.memoizedState=null):(e!==null&&bs(t,null),Eo(),ca());return At(e,t,c,n),t.child}function xr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function kh(e,t,n,i,c){var h=bo();return h=h===null?null:{parent:yt._currentValue,pool:h},t.memoizedState={baseLanes:n,cachePool:h},e!==null&&bs(t,null),Eo(),Dd(t),e!==null&&yi(e,t,i,!0),t.childLanes=c,null}function Ds(e,t){return t=Ms({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function zh(e,t,n){return $a(t,e.child,null,n),e=Ds(t,t.pendingProps),e.flags|=2,Qt(t),t.memoizedState=null,e}function oy(e,t,n){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ve){if(i.mode==="hidden")return e=Ds(t,i),t.lanes=536870912,xr(null,e);if(To(t),(e=st)?(e=Kf(e,dn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ta!==null?{id:Tn,overflow:An}:null,retryLane:536870912,hydrationErrors:null},n=md(e),n.return=t,t.child=n,Ct=t,st=null)):e=null,e===null)throw aa(t);return t.lanes=536870912,null}return Ds(t,i)}var h=e.memoizedState;if(h!==null){var y=h.dehydrated;if(To(t),c)if(t.flags&256)t.flags&=-257,t=zh(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(bt||yi(e,t,n,!1),c=(n&e.childLanes)!==0,bt||c){if(i=tt,i!==null&&(y=Wr(i,n),y!==0&&y!==h.retryLane))throw h.retryLane=y,Da(e,y),Pt(i,e,y),Jo;Ks(),t=zh(e,t,n)}else e=h.treeContext,st=fn(y.nextSibling),Ct=t,Ve=!0,na=null,dn=!1,e!==null&&bd(t,e),t=Ds(t,i),t.flags|=4096;return t}return e=Mn(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Bs(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function Qo(e,t,n,i,c){return La(t),n=Oo(e,t,n,i,void 0,c),i=Ro(),e!==null&&!bt?(No(e,t,c),$n(e,t,c)):(Ve&&i&&co(t),t.flags|=1,At(e,t,n,c),t.child)}function Uh(e,t,n,i,c,h){return La(t),t.updateQueue=null,n=Md(t,i,n,c),Bd(e),i=Ro(),e!==null&&!bt?(No(e,t,h),$n(e,t,h)):(Ve&&i&&co(t),t.flags|=1,At(e,t,n,h),t.child)}function Dh(e,t,n,i,c){if(La(t),t.stateNode===null){var h=fi,y=n.contextType;typeof y=="object"&&y!==null&&(h=Tt(y)),h=new n(i,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Ko,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=i,h.state=t.memoizedState,h.refs={},_o(t),y=n.contextType,h.context=typeof y=="object"&&y!==null?Tt(y):fi,h.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(Po(t,n,y,i),h.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(y=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),y!==h.state&&Ko.enqueueReplaceState(h,h.state,null),pr(t,i,h,c),gr(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){h=t.stateNode;var x=t.memoizedProps,R=Pa(n,x);h.props=R;var G=h.context,te=n.contextType;y=fi,typeof te=="object"&&te!==null&&(y=Tt(te));var ie=n.getDerivedStateFromProps;te=typeof ie=="function"||typeof h.getSnapshotBeforeUpdate=="function",x=t.pendingProps!==x,te||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(x||G!==y)&&_h(t,h,i,y),ra=!1;var Y=t.memoizedState;h.state=Y,pr(t,i,h,c),gr(),G=t.memoizedState,x||Y!==G||ra?(typeof ie=="function"&&(Po(t,n,ie,i),G=t.memoizedState),(R=ra||xh(t,n,R,i,Y,G,y))?(te||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=G),h.props=i,h.state=G,h.context=y,i=R):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{h=t.stateNode,jo(e,t),y=t.memoizedProps,te=Pa(n,y),h.props=te,ie=t.pendingProps,Y=h.context,G=n.contextType,R=fi,typeof G=="object"&&G!==null&&(R=Tt(G)),x=n.getDerivedStateFromProps,(G=typeof x=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(y!==ie||Y!==R)&&_h(t,h,i,R),ra=!1,Y=t.memoizedState,h.state=Y,pr(t,i,h,c),gr();var X=t.memoizedState;y!==ie||Y!==X||ra||e!==null&&e.dependencies!==null&&ys(e.dependencies)?(typeof x=="function"&&(Po(t,n,x,i),X=t.memoizedState),(te=ra||xh(t,n,te,i,Y,X,R)||e!==null&&e.dependencies!==null&&ys(e.dependencies))?(G||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,X,R),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,X,R)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=X),h.props=i,h.state=X,h.context=R,i=te):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),i=!1)}return h=i,Bs(e,t),i=(t.flags&128)!==0,h||i?(h=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&i?(t.child=$a(t,e.child,null,c),t.child=$a(t,null,n,c)):At(e,t,n,c),t.memoizedState=h.state,e=t.child):e=$n(e,t,c),e}function Bh(e,t,n,i){return Ma(),t.flags|=256,At(e,t,n,i),t.child}var Xo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Fo(e){return{baseLanes:e,cachePool:Ed()}}function Zo(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Ft),e}function Mh(e,t,n){var i=t.pendingProps,c=!1,h=(t.flags&128)!==0,y;if((y=h)||(y=e!==null&&e.memoizedState===null?!1:(gt.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ve){if(c?oa(t):ca(),(e=st)?(e=Kf(e,dn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ta!==null?{id:Tn,overflow:An}:null,retryLane:536870912,hydrationErrors:null},n=md(e),n.return=t,t.child=n,Ct=t,st=null)):e=null,e===null)throw aa(t);return Uc(e)?t.lanes=32:t.lanes=536870912,null}var x=i.children;return i=i.fallback,c?(ca(),c=t.mode,x=Ms({mode:"hidden",children:x},c),i=Ba(i,c,n,null),x.return=t,i.return=t,x.sibling=i,t.child=x,i=t.child,i.memoizedState=Fo(n),i.childLanes=Zo(e,y,n),t.memoizedState=Xo,xr(null,i)):(oa(t),Wo(t,x))}var R=e.memoizedState;if(R!==null&&(x=R.dehydrated,x!==null)){if(h)t.flags&256?(oa(t),t.flags&=-257,t=ec(e,t,n)):t.memoizedState!==null?(ca(),t.child=e.child,t.flags|=128,t=null):(ca(),x=i.fallback,c=t.mode,i=Ms({mode:"visible",children:i.children},c),x=Ba(x,c,n,null),x.flags|=2,i.return=t,x.return=t,i.sibling=x,t.child=i,$a(t,e.child,null,n),i=t.child,i.memoizedState=Fo(n),i.childLanes=Zo(e,y,n),t.memoizedState=Xo,t=xr(null,i));else if(oa(t),Uc(x)){if(y=x.nextSibling&&x.nextSibling.dataset,y)var G=y.dgst;y=G,i=Error(l(419)),i.stack="",i.digest=y,or({value:i,source:null,stack:null}),t=ec(e,t,n)}else if(bt||yi(e,t,n,!1),y=(n&e.childLanes)!==0,bt||y){if(y=tt,y!==null&&(i=Wr(y,n),i!==0&&i!==R.retryLane))throw R.retryLane=i,Da(e,i),Pt(y,e,i),Jo;zc(x)||Ks(),t=ec(e,t,n)}else zc(x)?(t.flags|=192,t.child=e.child,t=null):(e=R.treeContext,st=fn(x.nextSibling),Ct=t,Ve=!0,na=null,dn=!1,e!==null&&bd(t,e),t=Wo(t,i.children),t.flags|=4096);return t}return c?(ca(),x=i.fallback,c=t.mode,R=e.child,G=R.sibling,i=Mn(R,{mode:"hidden",children:i.children}),i.subtreeFlags=R.subtreeFlags&65011712,G!==null?x=Mn(G,x):(x=Ba(x,c,n,null),x.flags|=2),x.return=t,i.return=t,i.sibling=x,t.child=i,xr(null,i),i=t.child,x=e.child.memoizedState,x===null?x=Fo(n):(c=x.cachePool,c!==null?(R=yt._currentValue,c=c.parent!==R?{parent:R,pool:R}:c):c=Ed(),x={baseLanes:x.baseLanes|n,cachePool:c}),i.memoizedState=x,i.childLanes=Zo(e,y,n),t.memoizedState=Xo,xr(e.child,i)):(oa(t),n=e.child,e=n.sibling,n=Mn(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function Wo(e,t){return t=Ms({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Ms(e,t){return e=Yt(22,e,null,t),e.lanes=0,e}function ec(e,t,n){return $a(t,e.child,null,n),e=Wo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function qh(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),po(e.return,t,n)}function tc(e,t,n,i,c,h){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:c,treeForkCount:h}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=n,y.tailMode=c,y.treeForkCount=h)}function Lh(e,t,n){var i=t.pendingProps,c=i.revealOrder,h=i.tail;i=i.children;var y=gt.current,x=(y&2)!==0;if(x?(y=y&1|2,t.flags|=128):y&=1,P(gt,y),At(e,t,i,n),i=Ve?lr:0,!x&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&qh(e,n,t);else if(e.tag===19)qh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Es(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),tc(t,!1,c,n,h,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Es(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}tc(t,!0,n,null,h,i);break;case"together":tc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function $n(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ha|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(yi(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Mn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Mn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function nc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&ys(e)))}function cy(e,t,n){switch(t.tag){case 3:oe(t,t.stateNode.containerInfo),ia(t,yt,e.memoizedState.cache),Ma();break;case 27:case 5:Re(t);break;case 4:oe(t,t.stateNode.containerInfo);break;case 10:ia(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,To(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(oa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Mh(e,t,n):(oa(t),e=$n(e,t,n),e!==null?e.sibling:null);oa(t);break;case 19:var c=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(yi(e,t,n,!1),i=(n&t.childLanes)!==0),c){if(i)return Lh(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),P(gt,gt.current),i)break;return null;case 22:return t.lanes=0,Nh(e,t,n,t.pendingProps);case 24:ia(t,yt,e.memoizedState.cache)}return $n(e,t,n)}function Hh(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)bt=!0;else{if(!nc(e,n)&&(t.flags&128)===0)return bt=!1,cy(e,t,n);bt=(e.flags&131072)!==0}else bt=!1,Ve&&(t.flags&1048576)!==0&&vd(t,lr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=Ia(t.elementType),t.type=e,typeof e=="function")so(e)?(i=Pa(e,i),t.tag=1,t=Dh(null,t,e,i,n)):(t.tag=0,t=Qo(null,t,e,i,n));else{if(e!=null){var c=e.$$typeof;if(c===K){t.tag=11,t=Ah(null,t,e,i,n);break e}else if(c===k){t.tag=14,t=Oh(null,t,e,i,n);break e}}throw t=W(e)||e,Error(l(306,t,""))}}return t;case 0:return Qo(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,c=Pa(i,t.pendingProps),Dh(e,t,i,c,n);case 3:e:{if(oe(t,t.stateNode.containerInfo),e===null)throw Error(l(387));i=t.pendingProps;var h=t.memoizedState;c=h.element,jo(e,t),pr(t,i,null,n);var y=t.memoizedState;if(i=y.cache,ia(t,yt,i),i!==h.cache&&mo(t,[yt],n,!0),gr(),i=y.element,h.isDehydrated)if(h={element:i,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=Bh(e,t,i,n);break e}else if(i!==c){c=on(Error(l(424)),t),or(c),t=Bh(e,t,i,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(st=fn(e.firstChild),Ct=t,Ve=!0,na=null,dn=!0,n=Nd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Ma(),i===c){t=$n(e,t,n);break e}At(e,t,i,n)}t=t.child}return t;case 26:return Bs(e,t),e===null?(n=Zf(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ve||(n=t.type,e=t.pendingProps,i=Ws(ae.current).createElement(n),i[ye]=t,i[me]=e,Ot(i,n,e),rt(i),t.stateNode=i):t.memoizedState=Zf(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Re(t),e===null&&Ve&&(i=t.stateNode=Qf(t.type,t.pendingProps,ae.current),Ct=t,dn=!0,c=st,ya(t.type)?(Dc=c,st=fn(i.firstChild)):st=c),At(e,t,t.pendingProps.children,n),Bs(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ve&&((c=i=st)&&(i=Ly(i,t.type,t.pendingProps,dn),i!==null?(t.stateNode=i,Ct=t,st=fn(i.firstChild),dn=!1,c=!0):c=!1),c||aa(t)),Re(t),c=t.type,h=t.pendingProps,y=e!==null?e.memoizedProps:null,i=h.children,Rc(c,h)?i=null:y!==null&&Rc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Oo(e,t,ey,null,null,n),Dr._currentValue=c),Bs(e,t),At(e,t,i,n),t.child;case 6:return e===null&&Ve&&((e=n=st)&&(n=Hy(n,t.pendingProps,dn),n!==null?(t.stateNode=n,Ct=t,st=null,e=!0):e=!1),e||aa(t)),null;case 13:return Mh(e,t,n);case 4:return oe(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=$a(t,null,i,n):At(e,t,i,n),t.child;case 11:return Ah(e,t,t.type,t.pendingProps,n);case 7:return At(e,t,t.pendingProps,n),t.child;case 8:return At(e,t,t.pendingProps.children,n),t.child;case 12:return At(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,ia(t,t.type,i.value),At(e,t,i.children,n),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,La(t),c=Tt(c),i=i(c),t.flags|=1,At(e,t,i,n),t.child;case 14:return Oh(e,t,t.type,t.pendingProps,n);case 15:return Rh(e,t,t.type,t.pendingProps,n);case 19:return Lh(e,t,n);case 31:return oy(e,t,n);case 22:return Nh(e,t,n,t.pendingProps);case 24:return La(t),i=Tt(yt),e===null?(c=bo(),c===null&&(c=tt,h=yo(),c.pooledCache=h,h.refCount++,h!==null&&(c.pooledCacheLanes|=n),c=h),t.memoizedState={parent:i,cache:c},_o(t),ia(t,yt,c)):((e.lanes&n)!==0&&(jo(e,t),pr(t,null,null,n),gr()),c=e.memoizedState,h=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),ia(t,yt,i)):(i=h.cache,ia(t,yt,i),i!==c.cache&&mo(t,[yt],n,!0))),At(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Gn(e){e.flags|=4}function ac(e,t,n,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(gf())e.flags|=8192;else throw Va=_s,xo}else e.flags&=-16777217}function Ih(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!ag(t))if(gf())e.flags|=8192;else throw Va=_s,xo}function qs(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ii():536870912,e.lanes|=t,Oi|=t)}function _r(e,t){if(!Ve)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function uy(e,t,n){var i=t.pendingProps;switch(uo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(t),null;case 1:return lt(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Hn(yt),ge(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(mi(t)?Gn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,fo())),lt(t),null;case 26:var c=t.type,h=t.memoizedState;return e===null?(Gn(t),h!==null?(lt(t),Ih(t,h)):(lt(t),ac(t,c,null,i,n))):h?h!==e.memoizedState?(Gn(t),lt(t),Ih(t,h)):(lt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&Gn(t),lt(t),ac(t,c,e,i,n)),null;case 27:if(qe(t),n=ae.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Gn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return lt(t),null}e=Q.current,mi(t)?xd(t):(e=Qf(c,i,n),t.stateNode=e,Gn(t))}return lt(t),null;case 5:if(qe(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Gn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return lt(t),null}if(h=Q.current,mi(t))xd(t);else{var y=Ws(ae.current);switch(h){case 1:h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":h=y.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?h.multiple=!0:i.size&&(h.size=i.size);break;default:h=typeof i.is=="string"?y.createElement(c,{is:i.is}):y.createElement(c)}}h[ye]=t,h[me]=i;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)h.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=h;e:switch(Ot(h,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Gn(t)}}return lt(t),ac(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Gn(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(l(166));if(e=ae.current,mi(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,c=Ct,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[ye]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||qf(e.nodeValue,n)),e||aa(t,!0)}else e=Ws(e).createTextNode(i),e[ye]=t,t.stateNode=e}return lt(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(i=mi(t),n!==null){if(e===null){if(!i)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[ye]=t}else Ma(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;lt(t),e=!1}else n=fo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(Qt(t),t):(Qt(t),null);if((t.flags&128)!==0)throw Error(l(558))}return lt(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=mi(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[ye]=t}else Ma(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;lt(t),c=!1}else c=fo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(Qt(t),t):(Qt(t),null)}return Qt(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,e=e!==null&&e.memoizedState!==null,n&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==c&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),qs(t,t.updateQueue),lt(t),null);case 4:return ge(),e===null&&Ec(t.stateNode.containerInfo),lt(t),null;case 10:return Hn(t.type),lt(t),null;case 19:if(z(gt),i=t.memoizedState,i===null)return lt(t),null;if(c=(t.flags&128)!==0,h=i.rendering,h===null)if(c)_r(i,!1);else{if(ft!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=Es(e),h!==null){for(t.flags|=128,_r(i,!1),e=h.updateQueue,t.updateQueue=e,qs(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)pd(n,e),n=n.sibling;return P(gt,gt.current&1|2),Ve&&qn(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Dt()>$s&&(t.flags|=128,c=!0,_r(i,!1),t.lanes=4194304)}else{if(!c)if(e=Es(h),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,qs(t,e),_r(i,!0),i.tail===null&&i.tailMode==="hidden"&&!h.alternate&&!Ve)return lt(t),null}else 2*Dt()-i.renderingStartTime>$s&&n!==536870912&&(t.flags|=128,c=!0,_r(i,!1),t.lanes=4194304);i.isBackwards?(h.sibling=t.child,t.child=h):(e=i.last,e!==null?e.sibling=h:t.child=h,i.last=h)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Dt(),e.sibling=null,n=gt.current,P(gt,c?n&1|2:n&1),Ve&&qn(t,i.treeForkCount),e):(lt(t),null);case 22:case 23:return Qt(t),Co(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(lt(t),t.subtreeFlags&6&&(t.flags|=8192)):lt(t),n=t.updateQueue,n!==null&&qs(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&z(Ha),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Hn(yt),lt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function dy(e,t){switch(uo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Hn(yt),ge(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return qe(t),null;case 31:if(t.memoizedState!==null){if(Qt(t),t.alternate===null)throw Error(l(340));Ma()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(Qt(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Ma()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return z(gt),null;case 4:return ge(),null;case 10:return Hn(t.type),null;case 22:case 23:return Qt(t),Co(),e!==null&&z(Ha),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Hn(yt),null;case 25:return null;default:return null}}function Vh(e,t){switch(uo(t),t.tag){case 3:Hn(yt),ge();break;case 26:case 27:case 5:qe(t);break;case 4:ge();break;case 31:t.memoizedState!==null&&Qt(t);break;case 13:Qt(t);break;case 19:z(gt);break;case 10:Hn(t.type);break;case 22:case 23:Qt(t),Co(),e!==null&&z(Ha);break;case 24:Hn(yt)}}function jr(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var c=i.next;n=c;do{if((n.tag&e)===e){i=void 0;var h=n.create,y=n.inst;i=h(),y.destroy=i}n=n.next}while(n!==c)}}catch(x){Fe(t,t.return,x)}}function ua(e,t,n){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var h=c.next;i=h;do{if((i.tag&e)===e){var y=i.inst,x=y.destroy;if(x!==void 0){y.destroy=void 0,c=t;var R=n,G=x;try{G()}catch(te){Fe(c,R,te)}}}i=i.next}while(i!==h)}}catch(te){Fe(t,t.return,te)}}function $h(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{zd(t,n)}catch(i){Fe(e,e.return,i)}}}function Gh(e,t,n){n.props=Pa(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){Fe(e,t,i)}}function Sr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof n=="function"?e.refCleanup=n(i):n.current=i}}catch(c){Fe(e,t,c)}}function On(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(c){Fe(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){Fe(e,t,c)}else n.current=null}function Ph(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(c){Fe(e,e.return,c)}}function ic(e,t,n){try{var i=e.stateNode;zy(i,e.type,n,t),i[me]=t}catch(c){Fe(e,e.return,c)}}function Kh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&ya(e.type)||e.tag===4}function rc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Kh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&ya(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function sc(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Dn));else if(i!==4&&(i===27&&ya(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(sc(e,t,n),e=e.sibling;e!==null;)sc(e,t,n),e=e.sibling}function Ls(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(i===27&&ya(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Ls(e,t,n),e=e.sibling;e!==null;)Ls(e,t,n),e=e.sibling}function Yh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Ot(t,i,n),t[ye]=e,t[me]=n}catch(h){Fe(e,e.return,h)}}var Pn=!1,xt=!1,lc=!1,Jh=typeof WeakSet=="function"?WeakSet:Set,Et=null;function hy(e,t){if(e=e.containerInfo,Ac=sl,e=sd(e),Wl(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var c=i.anchorOffset,h=i.focusNode;i=i.focusOffset;try{n.nodeType,h.nodeType}catch{n=null;break e}var y=0,x=-1,R=-1,G=0,te=0,ie=e,Y=null;t:for(;;){for(var X;ie!==n||c!==0&&ie.nodeType!==3||(x=y+c),ie!==h||i!==0&&ie.nodeType!==3||(R=y+i),ie.nodeType===3&&(y+=ie.nodeValue.length),(X=ie.firstChild)!==null;)Y=ie,ie=X;for(;;){if(ie===e)break t;if(Y===n&&++G===c&&(x=y),Y===h&&++te===i&&(R=y),(X=ie.nextSibling)!==null)break;ie=Y,Y=ie.parentNode}ie=X}n=x===-1||R===-1?null:{start:x,end:R}}else n=null}n=n||{start:0,end:0}}else n=null;for(Oc={focusedElem:e,selectionRange:n},sl=!1,Et=t;Et!==null;)if(t=Et,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Et=e;else for(;Et!==null;){switch(t=Et,h=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,n=t,c=h.memoizedProps,h=h.memoizedState,i=n.stateNode;try{var ve=Pa(n.type,c);e=i.getSnapshotBeforeUpdate(ve,h),i.__reactInternalSnapshotBeforeUpdate=e}catch(Ee){Fe(n,n.return,Ee)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)kc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":kc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Et=e;break}Et=t.return}}function Qh(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Yn(e,n),i&4&&jr(5,n);break;case 1:if(Yn(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){Fe(n,n.return,y)}else{var c=Pa(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){Fe(n,n.return,y)}}i&64&&$h(n),i&512&&Sr(n,n.return);break;case 3:if(Yn(e,n),i&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{zd(e,t)}catch(y){Fe(n,n.return,y)}}break;case 27:t===null&&i&4&&Yh(n);case 26:case 5:Yn(e,n),t===null&&i&4&&Ph(n),i&512&&Sr(n,n.return);break;case 12:Yn(e,n);break;case 31:Yn(e,n),i&4&&Zh(e,n);break;case 13:Yn(e,n),i&4&&Wh(e,n),i&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=_y.bind(null,n),Iy(e,n))));break;case 22:if(i=n.memoizedState!==null||Pn,!i){t=t!==null&&t.memoizedState!==null||xt,c=Pn;var h=xt;Pn=i,(xt=t)&&!h?Jn(e,n,(n.subtreeFlags&8772)!==0):Yn(e,n),Pn=c,xt=h}break;case 30:break;default:Yn(e,n)}}function Xh(e){var t=e.alternate;t!==null&&(e.alternate=null,Xh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Le(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ct=null,It=!1;function Kn(e,t,n){for(n=n.child;n!==null;)Fh(e,t,n),n=n.sibling}function Fh(e,t,n){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(Ta,n)}catch{}switch(n.tag){case 26:xt||On(n,t),Kn(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:xt||On(n,t);var i=ct,c=It;ya(n.type)&&(ct=n.stateNode,It=!1),Kn(e,t,n),kr(n.stateNode),ct=i,It=c;break;case 5:xt||On(n,t);case 6:if(i=ct,c=It,ct=null,Kn(e,t,n),ct=i,It=c,ct!==null)if(It)try{(ct.nodeType===9?ct.body:ct.nodeName==="HTML"?ct.ownerDocument.body:ct).removeChild(n.stateNode)}catch(h){Fe(n,t,h)}else try{ct.removeChild(n.stateNode)}catch(h){Fe(n,t,h)}break;case 18:ct!==null&&(It?(e=ct,Gf(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Mi(e)):Gf(ct,n.stateNode));break;case 4:i=ct,c=It,ct=n.stateNode.containerInfo,It=!0,Kn(e,t,n),ct=i,It=c;break;case 0:case 11:case 14:case 15:ua(2,n,t),xt||ua(4,n,t),Kn(e,t,n);break;case 1:xt||(On(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Gh(n,t,i)),Kn(e,t,n);break;case 21:Kn(e,t,n);break;case 22:xt=(i=xt)||n.memoizedState!==null,Kn(e,t,n),xt=i;break;default:Kn(e,t,n)}}function Zh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Mi(e)}catch(n){Fe(t,t.return,n)}}}function Wh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Mi(e)}catch(n){Fe(t,t.return,n)}}function fy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Jh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Jh),t;default:throw Error(l(435,e.tag))}}function Hs(e,t){var n=fy(e);t.forEach(function(i){if(!n.has(i)){n.add(i);var c=jy.bind(null,e,i);i.then(c,c)}})}function Vt(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var c=n[i],h=e,y=t,x=y;e:for(;x!==null;){switch(x.tag){case 27:if(ya(x.type)){ct=x.stateNode,It=!1;break e}break;case 5:ct=x.stateNode,It=!1;break e;case 3:case 4:ct=x.stateNode.containerInfo,It=!0;break e}x=x.return}if(ct===null)throw Error(l(160));Fh(h,y,c),ct=null,It=!1,h=c.alternate,h!==null&&(h.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)ef(t,e),t=t.sibling}var bn=null;function ef(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Vt(t,e),$t(e),i&4&&(ua(3,e,e.return),jr(3,e),ua(5,e,e.return));break;case 1:Vt(t,e),$t(e),i&512&&(xt||n===null||On(n,n.return)),i&64&&Pn&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var c=bn;if(Vt(t,e),$t(e),i&512&&(xt||n===null||On(n,n.return)),i&4){var h=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":h=c.getElementsByTagName("title")[0],(!h||h[Ae]||h[ye]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=c.createElement(i),c.head.insertBefore(h,c.querySelector("head > title"))),Ot(h,i,n),h[ye]=e,rt(h),i=h;break e;case"link":var y=tg("link","href",c).get(i+(n.href||""));if(y){for(var x=0;x<y.length;x++)if(h=y[x],h.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&h.getAttribute("rel")===(n.rel==null?null:n.rel)&&h.getAttribute("title")===(n.title==null?null:n.title)&&h.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(x,1);break t}}h=c.createElement(i),Ot(h,i,n),c.head.appendChild(h);break;case"meta":if(y=tg("meta","content",c).get(i+(n.content||""))){for(x=0;x<y.length;x++)if(h=y[x],h.getAttribute("content")===(n.content==null?null:""+n.content)&&h.getAttribute("name")===(n.name==null?null:n.name)&&h.getAttribute("property")===(n.property==null?null:n.property)&&h.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&h.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(x,1);break t}}h=c.createElement(i),Ot(h,i,n),c.head.appendChild(h);break;default:throw Error(l(468,i))}h[ye]=e,rt(h),i=h}e.stateNode=i}else ng(c,e.type,e.stateNode);else e.stateNode=eg(c,i,e.memoizedProps);else h!==i?(h===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):h.count--,i===null?ng(c,e.type,e.stateNode):eg(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&ic(e,e.memoizedProps,n.memoizedProps)}break;case 27:Vt(t,e),$t(e),i&512&&(xt||n===null||On(n,n.return)),n!==null&&i&4&&ic(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Vt(t,e),$t(e),i&512&&(xt||n===null||On(n,n.return)),e.flags&32){c=e.stateNode;try{si(c,"")}catch(ve){Fe(e,e.return,ve)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,ic(e,c,n!==null?n.memoizedProps:c)),i&1024&&(lc=!0);break;case 6:if(Vt(t,e),$t(e),i&4){if(e.stateNode===null)throw Error(l(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(ve){Fe(e,e.return,ve)}}break;case 3:if(nl=null,c=bn,bn=el(t.containerInfo),Vt(t,e),bn=c,$t(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Mi(t.containerInfo)}catch(ve){Fe(e,e.return,ve)}lc&&(lc=!1,tf(e));break;case 4:i=bn,bn=el(e.stateNode.containerInfo),Vt(t,e),$t(e),bn=i;break;case 12:Vt(t,e),$t(e);break;case 31:Vt(t,e),$t(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Hs(e,i)));break;case 13:Vt(t,e),$t(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Vs=Dt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Hs(e,i)));break;case 22:c=e.memoizedState!==null;var R=n!==null&&n.memoizedState!==null,G=Pn,te=xt;if(Pn=G||c,xt=te||R,Vt(t,e),xt=te,Pn=G,$t(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||R||Pn||xt||Ka(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){R=n=t;try{if(h=R.stateNode,c)y=h.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{x=R.stateNode;var ie=R.memoizedProps.style,Y=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;x.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(ve){Fe(R,R.return,ve)}}}else if(t.tag===6){if(n===null){R=t;try{R.stateNode.nodeValue=c?"":R.memoizedProps}catch(ve){Fe(R,R.return,ve)}}}else if(t.tag===18){if(n===null){R=t;try{var X=R.stateNode;c?Pf(X,!0):Pf(R.stateNode,!1)}catch(ve){Fe(R,R.return,ve)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,Hs(e,n))));break;case 19:Vt(t,e),$t(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Hs(e,i)));break;case 30:break;case 21:break;default:Vt(t,e),$t(e)}}function $t(e){var t=e.flags;if(t&2){try{for(var n,i=e.return;i!==null;){if(Kh(i)){n=i;break}i=i.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,h=rc(e);Ls(e,h,c);break;case 5:var y=n.stateNode;n.flags&32&&(si(y,""),n.flags&=-33);var x=rc(e);Ls(e,x,y);break;case 3:case 4:var R=n.stateNode.containerInfo,G=rc(e);sc(e,G,R);break;default:throw Error(l(161))}}catch(te){Fe(e,e.return,te)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;tf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Yn(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Qh(e,t.alternate,t),t=t.sibling}function Ka(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ua(4,t,t.return),Ka(t);break;case 1:On(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Gh(t,t.return,n),Ka(t);break;case 27:kr(t.stateNode);case 26:case 5:On(t,t.return),Ka(t);break;case 22:t.memoizedState===null&&Ka(t);break;case 30:Ka(t);break;default:Ka(t)}e=e.sibling}}function Jn(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,h=t,y=h.flags;switch(h.tag){case 0:case 11:case 15:Jn(c,h,n),jr(4,h);break;case 1:if(Jn(c,h,n),i=h,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(G){Fe(i,i.return,G)}if(i=h,c=i.updateQueue,c!==null){var x=i.stateNode;try{var R=c.shared.hiddenCallbacks;if(R!==null)for(c.shared.hiddenCallbacks=null,c=0;c<R.length;c++)kd(R[c],x)}catch(G){Fe(i,i.return,G)}}n&&y&64&&$h(h),Sr(h,h.return);break;case 27:Yh(h);case 26:case 5:Jn(c,h,n),n&&i===null&&y&4&&Ph(h),Sr(h,h.return);break;case 12:Jn(c,h,n);break;case 31:Jn(c,h,n),n&&y&4&&Zh(c,h);break;case 13:Jn(c,h,n),n&&y&4&&Wh(c,h);break;case 22:h.memoizedState===null&&Jn(c,h,n),Sr(h,h.return);break;case 30:break;default:Jn(c,h,n)}t=t.sibling}}function oc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&cr(n))}function cc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&cr(e))}function xn(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)nf(e,t,n,i),t=t.sibling}function nf(e,t,n,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:xn(e,t,n,i),c&2048&&jr(9,t);break;case 1:xn(e,t,n,i);break;case 3:xn(e,t,n,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&cr(e)));break;case 12:if(c&2048){xn(e,t,n,i),e=t.stateNode;try{var h=t.memoizedProps,y=h.id,x=h.onPostCommit;typeof x=="function"&&x(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(R){Fe(t,t.return,R)}}else xn(e,t,n,i);break;case 31:xn(e,t,n,i);break;case 13:xn(e,t,n,i);break;case 23:break;case 22:h=t.stateNode,y=t.alternate,t.memoizedState!==null?h._visibility&2?xn(e,t,n,i):wr(e,t):h._visibility&2?xn(e,t,n,i):(h._visibility|=2,Ci(e,t,n,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&oc(y,t);break;case 24:xn(e,t,n,i),c&2048&&cc(t.alternate,t);break;default:xn(e,t,n,i)}}function Ci(e,t,n,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var h=e,y=t,x=n,R=i,G=y.flags;switch(y.tag){case 0:case 11:case 15:Ci(h,y,x,R,c),jr(8,y);break;case 23:break;case 22:var te=y.stateNode;y.memoizedState!==null?te._visibility&2?Ci(h,y,x,R,c):wr(h,y):(te._visibility|=2,Ci(h,y,x,R,c)),c&&G&2048&&oc(y.alternate,y);break;case 24:Ci(h,y,x,R,c),c&&G&2048&&cc(y.alternate,y);break;default:Ci(h,y,x,R,c)}t=t.sibling}}function wr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,c=i.flags;switch(i.tag){case 22:wr(n,i),c&2048&&oc(i.alternate,i);break;case 24:wr(n,i),c&2048&&cc(i.alternate,i);break;default:wr(n,i)}t=t.sibling}}var Er=8192;function Ti(e,t,n){if(e.subtreeFlags&Er)for(e=e.child;e!==null;)af(e,t,n),e=e.sibling}function af(e,t,n){switch(e.tag){case 26:Ti(e,t,n),e.flags&Er&&e.memoizedState!==null&&Wy(n,bn,e.memoizedState,e.memoizedProps);break;case 5:Ti(e,t,n);break;case 3:case 4:var i=bn;bn=el(e.stateNode.containerInfo),Ti(e,t,n),bn=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Er,Er=16777216,Ti(e,t,n),Er=i):Ti(e,t,n));break;default:Ti(e,t,n)}}function rf(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Cr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Et=i,lf(i,e)}rf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)sf(e),e=e.sibling}function sf(e){switch(e.tag){case 0:case 11:case 15:Cr(e),e.flags&2048&&ua(9,e,e.return);break;case 3:Cr(e);break;case 12:Cr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Is(e)):Cr(e);break;default:Cr(e)}}function Is(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Et=i,lf(i,e)}rf(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ua(8,t,t.return),Is(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Is(t));break;default:Is(t)}e=e.sibling}}function lf(e,t){for(;Et!==null;){var n=Et;switch(n.tag){case 0:case 11:case 15:ua(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:cr(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,Et=i;else e:for(n=e;Et!==null;){i=Et;var c=i.sibling,h=i.return;if(Xh(i),i===n){Et=null;break e}if(c!==null){c.return=h,Et=c;break e}Et=h}}}var gy={getCacheForType:function(e){var t=Tt(yt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Tt(yt).controller.signal}},py=typeof WeakMap=="function"?WeakMap:Map,Qe=0,tt=null,Be=null,He=0,Xe=0,Xt=null,da=!1,Ai=!1,uc=!1,Qn=0,ft=0,ha=0,Ya=0,dc=0,Ft=0,Oi=0,Tr=null,Gt=null,hc=!1,Vs=0,of=0,$s=1/0,Gs=null,fa=null,St=0,ga=null,Ri=null,Xn=0,fc=0,gc=null,cf=null,Ar=0,pc=null;function Zt(){return(Qe&2)!==0&&He!==0?He&-He:U.T!==null?_c():ue()}function uf(){if(Ft===0)if((He&536870912)===0||Ve){var e=nn;nn<<=1,(nn&3932160)===0&&(nn=262144),Ft=e}else Ft=536870912;return e=Jt.current,e!==null&&(e.flags|=32),Ft}function Pt(e,t,n){(e===tt&&(Xe===2||Xe===9)||e.cancelPendingCommit!==null)&&(Ni(e,0),pa(e,He,Ft,!1)),Ra(e,n),((Qe&2)===0||e!==tt)&&(e===tt&&((Qe&2)===0&&(Ya|=n),ft===4&&pa(e,He,Ft,!1)),Rn(e))}function df(e,t,n){if((Qe&6)!==0)throw Error(l(327));var i=!n&&(t&127)===0&&(t&e.expiredLanes)===0||zn(e,t),c=i?vy(e,t):yc(e,t,!0),h=i;do{if(c===0){Ai&&!i&&pa(e,t,0,!1);break}else{if(n=e.current.alternate,h&&!my(n)){c=yc(e,t,!1),h=!1;continue}if(c===2){if(h=t,e.errorRecoveryDisabledLanes&h)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var x=e;c=Tr;var R=x.current.memoizedState.isDehydrated;if(R&&(Ni(x,y).flags|=256),y=yc(x,y,!1),y!==2){if(uc&&!R){x.errorRecoveryDisabledLanes|=h,Ya|=h,c=4;break e}h=Gt,Gt=c,h!==null&&(Gt===null?Gt=h:Gt.push.apply(Gt,h))}c=y}if(h=!1,c!==2)continue}}if(c===1){Ni(e,0),pa(e,t,0,!0);break}e:{switch(i=e,h=c,h){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:pa(i,t,Ft,!da);break e;case 2:Gt=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=Vs+300-Dt(),10<c)){if(pa(i,t,Ft,!da),ai(i,0,!0)!==0)break e;Xn=t,i.timeoutHandle=Vf(hf.bind(null,i,n,Gt,Gs,hc,t,Ft,Ya,Oi,da,h,"Throttled",-0,0),c);break e}hf(i,n,Gt,Gs,hc,t,Ft,Ya,Oi,da,h,null,-0,0)}}break}while(!0);Rn(e)}function hf(e,t,n,i,c,h,y,x,R,G,te,ie,Y,X){if(e.timeoutHandle=-1,ie=t.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Dn},af(t,h,ie);var ve=(h&62914560)===h?Vs-Dt():(h&4194048)===h?of-Dt():0;if(ve=ev(ie,ve),ve!==null){Xn=h,e.cancelPendingCommit=ve(xf.bind(null,e,t,h,n,i,c,y,x,R,te,ie,null,Y,X)),pa(e,h,y,!G);return}}xf(e,t,h,n,i,c,y,x,R)}function my(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var c=n[i],h=c.getSnapshot;c=c.value;try{if(!Kt(h(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function pa(e,t,n,i){t&=~dc,t&=~Ya,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var h=31-Mt(c),y=1<<h;i[h]=-1,c&=~y}n!==0&&Zr(e,n,t)}function Ps(){return(Qe&6)===0?(Or(0),!1):!0}function mc(){if(Be!==null){if(Xe===0)var e=Be.return;else e=Be,Ln=qa=null,ko(e),_i=null,dr=0,e=Be;for(;e!==null;)Vh(e.alternate,e),e=e.return;Be=null}}function Ni(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,By(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Xn=0,mc(),tt=e,Be=n=Mn(e.current,null),He=t,Xe=0,Xt=null,da=!1,Ai=zn(e,t),uc=!1,Oi=Ft=dc=Ya=ha=ft=0,Gt=Tr=null,hc=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-Mt(i),h=1<<c;t|=e[c],i&=~h}return Qn=t,hs(),n}function ff(e,t){ze=null,U.H=br,t===xi||t===xs?(t=Ad(),Xe=3):t===xo?(t=Ad(),Xe=4):Xe=t===Jo?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Xt=t,Be===null&&(ft=1,Us(e,on(t,e.current)))}function gf(){var e=Jt.current;return e===null?!0:(He&4194048)===He?hn===null:(He&62914560)===He||(He&536870912)!==0?e===hn:!1}function pf(){var e=U.H;return U.H=br,e===null?br:e}function mf(){var e=U.A;return U.A=gy,e}function Ks(){ft=4,da||(He&4194048)!==He&&Jt.current!==null||(Ai=!0),(ha&134217727)===0&&(Ya&134217727)===0||tt===null||pa(tt,He,Ft,!1)}function yc(e,t,n){var i=Qe;Qe|=2;var c=pf(),h=mf();(tt!==e||He!==t)&&(Gs=null,Ni(e,t)),t=!1;var y=ft;e:do try{if(Xe!==0&&Be!==null){var x=Be,R=Xt;switch(Xe){case 8:mc(),y=6;break e;case 3:case 2:case 9:case 6:Jt.current===null&&(t=!0);var G=Xe;if(Xe=0,Xt=null,ki(e,x,R,G),n&&Ai){y=0;break e}break;default:G=Xe,Xe=0,Xt=null,ki(e,x,R,G)}}yy(),y=ft;break}catch(te){ff(e,te)}while(!0);return t&&e.shellSuspendCounter++,Ln=qa=null,Qe=i,U.H=c,U.A=h,Be===null&&(tt=null,He=0,hs()),y}function yy(){for(;Be!==null;)yf(Be)}function vy(e,t){var n=Qe;Qe|=2;var i=pf(),c=mf();tt!==e||He!==t?(Gs=null,$s=Dt()+500,Ni(e,t)):Ai=zn(e,t);e:do try{if(Xe!==0&&Be!==null){t=Be;var h=Xt;t:switch(Xe){case 1:Xe=0,Xt=null,ki(e,t,h,1);break;case 2:case 9:if(Cd(h)){Xe=0,Xt=null,vf(t);break}t=function(){Xe!==2&&Xe!==9||tt!==e||(Xe=7),Rn(e)},h.then(t,t);break e;case 3:Xe=7;break e;case 4:Xe=5;break e;case 7:Cd(h)?(Xe=0,Xt=null,vf(t)):(Xe=0,Xt=null,ki(e,t,h,7));break;case 5:var y=null;switch(Be.tag){case 26:y=Be.memoizedState;case 5:case 27:var x=Be;if(y?ag(y):x.stateNode.complete){Xe=0,Xt=null;var R=x.sibling;if(R!==null)Be=R;else{var G=x.return;G!==null?(Be=G,Ys(G)):Be=null}break t}}Xe=0,Xt=null,ki(e,t,h,5);break;case 6:Xe=0,Xt=null,ki(e,t,h,6);break;case 8:mc(),ft=6;break e;default:throw Error(l(462))}}by();break}catch(te){ff(e,te)}while(!0);return Ln=qa=null,U.H=i,U.A=c,Qe=n,Be!==null?0:(tt=null,He=0,hs(),ft)}function by(){for(;Be!==null&&!wn();)yf(Be)}function yf(e){var t=Hh(e.alternate,e,Qn);e.memoizedProps=e.pendingProps,t===null?Ys(e):Be=t}function vf(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Uh(n,t,t.pendingProps,t.type,void 0,He);break;case 11:t=Uh(n,t,t.pendingProps,t.type.render,t.ref,He);break;case 5:ko(t);default:Vh(n,t),t=Be=pd(t,Qn),t=Hh(n,t,Qn)}e.memoizedProps=e.pendingProps,t===null?Ys(e):Be=t}function ki(e,t,n,i){Ln=qa=null,ko(t),_i=null,dr=0;var c=t.return;try{if(ly(e,c,t,n,He)){ft=1,Us(e,on(n,e.current)),Be=null;return}}catch(h){if(c!==null)throw Be=c,h;ft=1,Us(e,on(n,e.current)),Be=null;return}t.flags&32768?(Ve||i===1?e=!0:Ai||(He&536870912)!==0?e=!1:(da=e=!0,(i===2||i===9||i===3||i===6)&&(i=Jt.current,i!==null&&i.tag===13&&(i.flags|=16384))),bf(t,e)):Ys(t)}function Ys(e){var t=e;do{if((t.flags&32768)!==0){bf(t,da);return}e=t.return;var n=uy(t.alternate,t,Qn);if(n!==null){Be=n;return}if(t=t.sibling,t!==null){Be=t;return}Be=t=e}while(t!==null);ft===0&&(ft=5)}function bf(e,t){do{var n=dy(e.alternate,e);if(n!==null){n.flags&=32767,Be=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Be=e;return}Be=e=n}while(e!==null);ft=6,Be=null}function xf(e,t,n,i,c,h,y,x,R){e.cancelPendingCommit=null;do Js();while(St!==0);if((Qe&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(h=t.lanes|t.childLanes,h|=io,Dl(e,n,h,y,x,R),e===tt&&(Be=tt=null,He=0),Ri=t,ga=e,Xn=n,fc=h,gc=c,cf=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Sy(Ca,function(){return Ef(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=U.T,U.T=null,c=L.p,L.p=2,y=Qe,Qe|=4;try{hy(e,t,n)}finally{Qe=y,L.p=c,U.T=i}}St=1,_f(),jf(),Sf()}}function _f(){if(St===1){St=0;var e=ga,t=Ri,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=U.T,U.T=null;var i=L.p;L.p=2;var c=Qe;Qe|=4;try{ef(t,e);var h=Oc,y=sd(e.containerInfo),x=h.focusedElem,R=h.selectionRange;if(y!==x&&x&&x.ownerDocument&&rd(x.ownerDocument.documentElement,x)){if(R!==null&&Wl(x)){var G=R.start,te=R.end;if(te===void 0&&(te=G),"selectionStart"in x)x.selectionStart=G,x.selectionEnd=Math.min(te,x.value.length);else{var ie=x.ownerDocument||document,Y=ie&&ie.defaultView||window;if(Y.getSelection){var X=Y.getSelection(),ve=x.textContent.length,Ee=Math.min(R.start,ve),et=R.end===void 0?Ee:Math.min(R.end,ve);!X.extend&&Ee>et&&(y=et,et=Ee,Ee=y);var H=id(x,Ee),N=id(x,et);if(H&&N&&(X.rangeCount!==1||X.anchorNode!==H.node||X.anchorOffset!==H.offset||X.focusNode!==N.node||X.focusOffset!==N.offset)){var V=ie.createRange();V.setStart(H.node,H.offset),X.removeAllRanges(),Ee>et?(X.addRange(V),X.extend(N.node,N.offset)):(V.setEnd(N.node,N.offset),X.addRange(V))}}}}for(ie=[],X=x;X=X.parentNode;)X.nodeType===1&&ie.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<ie.length;x++){var ne=ie[x];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}sl=!!Ac,Oc=Ac=null}finally{Qe=c,L.p=i,U.T=n}}e.current=t,St=2}}function jf(){if(St===2){St=0;var e=ga,t=Ri,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=U.T,U.T=null;var i=L.p;L.p=2;var c=Qe;Qe|=4;try{Qh(e,t.alternate,t)}finally{Qe=c,L.p=i,U.T=n}}St=3}}function Sf(){if(St===4||St===3){St=0,Ol();var e=ga,t=Ri,n=Xn,i=cf;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?St=5:(St=0,Ri=ga=null,wf(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(fa=null),$(n),t=t.stateNode,Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(Ta,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=U.T,c=L.p,L.p=2,U.T=null;try{for(var h=e.onRecoverableError,y=0;y<i.length;y++){var x=i[y];h(x.value,{componentStack:x.stack})}}finally{U.T=t,L.p=c}}(Xn&3)!==0&&Js(),Rn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===pc?Ar++:(Ar=0,pc=e):Ar=0,Or(0)}}function wf(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,cr(t)))}function Js(){return _f(),jf(),Sf(),Ef()}function Ef(){if(St!==5)return!1;var e=ga,t=fc;fc=0;var n=$(Xn),i=U.T,c=L.p;try{L.p=32>n?32:n,U.T=null,n=gc,gc=null;var h=ga,y=Xn;if(St=0,Ri=ga=null,Xn=0,(Qe&6)!==0)throw Error(l(331));var x=Qe;if(Qe|=4,sf(h.current),nf(h,h.current,y,n),Qe=x,Or(0,!1),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(Ta,h)}catch{}return!0}finally{L.p=c,U.T=i,wf(e,t)}}function Cf(e,t,n){t=on(n,t),t=Yo(e.stateNode,t,2),e=la(e,t,2),e!==null&&(Ra(e,2),Rn(e))}function Fe(e,t,n){if(e.tag===3)Cf(e,e,n);else for(;t!==null;){if(t.tag===3){Cf(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(fa===null||!fa.has(i))){e=on(n,e),n=Ch(2),i=la(t,n,2),i!==null&&(Th(n,i,t,e),Ra(i,2),Rn(i));break}}t=t.return}}function vc(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new py;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(n)||(uc=!0,c.add(n),e=xy.bind(null,e,t,n),t.then(e,e))}function xy(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,tt===e&&(He&n)===n&&(ft===4||ft===3&&(He&62914560)===He&&300>Dt()-Vs?(Qe&2)===0&&Ni(e,0):dc|=n,Oi===He&&(Oi=0)),Rn(e)}function Tf(e,t){t===0&&(t=ii()),e=Da(e,t),e!==null&&(Ra(e,t),Rn(e))}function _y(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Tf(e,n)}function jy(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(t),Tf(e,n)}function Sy(e,t){return at(e,t)}var Qs=null,zi=null,bc=!1,Xs=!1,xc=!1,ma=0;function Rn(e){e!==zi&&e.next===null&&(zi===null?Qs=zi=e:zi=zi.next=e),Xs=!0,bc||(bc=!0,Ey())}function Or(e,t){if(!xc&&Xs){xc=!0;do for(var n=!1,i=Qs;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var h=0;else{var y=i.suspendedLanes,x=i.pingedLanes;h=(1<<31-Mt(42|e)+1)-1,h&=c&~(y&~x),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(n=!0,Nf(i,h))}else h=He,h=ai(i,i===tt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(h&3)===0||zn(i,h)||(n=!0,Nf(i,h));i=i.next}while(n);xc=!1}}function wy(){Af()}function Af(){Xs=bc=!1;var e=0;ma!==0&&Dy()&&(e=ma);for(var t=Dt(),n=null,i=Qs;i!==null;){var c=i.next,h=Of(i,t);h===0?(i.next=null,n===null?Qs=c:n.next=c,c===null&&(zi=n)):(n=i,(e!==0||(h&3)!==0)&&(Xs=!0)),i=c}St!==0&&St!==5||Or(e),ma!==0&&(ma=0)}function Of(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var y=31-Mt(h),x=1<<y,R=c[y];R===-1?((x&n)===0||(x&i)!==0)&&(c[y]=Ul(x,t)):R<=t&&(e.expiredLanes|=x),h&=~x}if(t=tt,n=He,n=ai(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,n===0||e===t&&(Xe===2||Xe===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&ot(i),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||zn(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&ot(i),$(n)){case 2:case 8:n=Qr;break;case 32:n=Ca;break;case 268435456:n=Xr;break;default:n=Ca}return i=Rf.bind(null,e),n=at(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&ot(i),e.callbackPriority=2,e.callbackNode=null,2}function Rf(e,t){if(St!==0&&St!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Js()&&e.callbackNode!==n)return null;var i=He;return i=ai(e,e===tt?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(df(e,i,t),Of(e,Dt()),e.callbackNode!=null&&e.callbackNode===n?Rf.bind(null,e):null)}function Nf(e,t){if(Js())return null;df(e,t,!0)}function Ey(){My(function(){(Qe&6)!==0?at(Jr,wy):Af()})}function _c(){if(ma===0){var e=vi;e===0&&(e=tn,tn<<=1,(tn&261888)===0&&(tn=256)),ma=e}return ma}function kf(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:is(""+e)}function zf(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Cy(e,t,n,i,c){if(t==="submit"&&n&&n.stateNode===c){var h=kf((c[me]||null).action),y=i.submitter;y&&(t=(t=y[me]||null)?kf(t.formAction):y.getAttribute("formAction"),t!==null&&(h=t,y=null));var x=new os("action","action",null,i,c);e.push({event:x,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(ma!==0){var R=y?zf(c,y):new FormData(c);Io(n,{pending:!0,data:R,method:c.method,action:h},null,R)}}else typeof h=="function"&&(x.preventDefault(),R=y?zf(c,y):new FormData(c),Io(n,{pending:!0,data:R,method:c.method,action:h},h,R))},currentTarget:c}]})}}for(var jc=0;jc<ao.length;jc++){var Sc=ao[jc],Ty=Sc.toLowerCase(),Ay=Sc[0].toUpperCase()+Sc.slice(1);vn(Ty,"on"+Ay)}vn(cd,"onAnimationEnd"),vn(ud,"onAnimationIteration"),vn(dd,"onAnimationStart"),vn("dblclick","onDoubleClick"),vn("focusin","onFocus"),vn("focusout","onBlur"),vn(Gm,"onTransitionRun"),vn(Pm,"onTransitionStart"),vn(Km,"onTransitionCancel"),vn(hd,"onTransitionEnd"),Cn("onMouseEnter",["mouseout","mouseover"]),Cn("onMouseLeave",["mouseout","mouseover"]),Cn("onPointerEnter",["pointerout","pointerover"]),Cn("onPointerLeave",["pointerout","pointerover"]),an("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),an("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),an("onBeforeInput",["compositionend","keypress","textInput","paste"]),an("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),an("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),an("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Rr));function Uf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],c=i.event;i=i.listeners;e:{var h=void 0;if(t)for(var y=i.length-1;0<=y;y--){var x=i[y],R=x.instance,G=x.currentTarget;if(x=x.listener,R!==h&&c.isPropagationStopped())break e;h=x,c.currentTarget=G;try{h(c)}catch(te){ds(te)}c.currentTarget=null,h=R}else for(y=0;y<i.length;y++){if(x=i[y],R=x.instance,G=x.currentTarget,x=x.listener,R!==h&&c.isPropagationStopped())break e;h=x,c.currentTarget=G;try{h(c)}catch(te){ds(te)}c.currentTarget=null,h=R}}}}function Me(e,t){var n=t[$e];n===void 0&&(n=t[$e]=new Set);var i=e+"__bubble";n.has(i)||(Df(t,e,2,!1),n.add(i))}function wc(e,t,n){var i=0;t&&(i|=4),Df(n,e,i,t)}var Fs="_reactListening"+Math.random().toString(36).slice(2);function Ec(e){if(!e[Fs]){e[Fs]=!0,Wn.forEach(function(n){n!=="selectionchange"&&(Oy.has(n)||wc(n,!1,e),wc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fs]||(t[Fs]=!0,wc("selectionchange",!1,t))}}function Df(e,t,n,i){switch(ug(t)){case 2:var c=av;break;case 8:c=iv;break;default:c=Hc}n=c.bind(null,t,n,e),c=void 0,!Gl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Cc(e,t,n,i,c){var h=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var x=i.stateNode.containerInfo;if(x===c)break;if(y===4)for(y=i.return;y!==null;){var R=y.tag;if((R===3||R===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;x!==null;){if(y=mt(x),y===null)return;if(R=y.tag,R===5||R===6||R===26||R===27){i=h=y;continue e}x=x.parentNode}}i=i.return}Lu(function(){var G=h,te=Vl(n),ie=[];e:{var Y=fd.get(e);if(Y!==void 0){var X=os,ve=e;switch(e){case"keypress":if(ss(n)===0)break e;case"keydown":case"keyup":X=jm;break;case"focusin":ve="focus",X=Jl;break;case"focusout":ve="blur",X=Jl;break;case"beforeblur":case"afterblur":X=Jl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=Vu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=um;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=Em;break;case cd:case ud:case dd:X=fm;break;case hd:X=Tm;break;case"scroll":case"scrollend":X=om;break;case"wheel":X=Om;break;case"copy":case"cut":case"paste":X=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Gu;break;case"toggle":case"beforetoggle":X=Nm}var Ee=(t&4)!==0,et=!Ee&&(e==="scroll"||e==="scrollend"),H=Ee?Y!==null?Y+"Capture":null:Y;Ee=[];for(var N=G,V;N!==null;){var ne=N;if(V=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||V===null||H===null||(ne=Zi(N,H),ne!=null&&Ee.push(Nr(N,ne,V))),et)break;N=N.return}0<Ee.length&&(Y=new X(Y,ve,null,n,te),ie.push({event:Y,listeners:Ee}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",X=e==="mouseout"||e==="pointerout",Y&&n!==Il&&(ve=n.relatedTarget||n.fromElement)&&(mt(ve)||ve[Te]))break e;if((X||Y)&&(Y=te.window===te?te:(Y=te.ownerDocument)?Y.defaultView||Y.parentWindow:window,X?(ve=n.relatedTarget||n.toElement,X=G,ve=ve?mt(ve):null,ve!==null&&(et=d(ve),Ee=ve.tag,ve!==et||Ee!==5&&Ee!==27&&Ee!==6)&&(ve=null)):(X=null,ve=G),X!==ve)){if(Ee=Vu,ne="onMouseLeave",H="onMouseEnter",N="mouse",(e==="pointerout"||e==="pointerover")&&(Ee=Gu,ne="onPointerLeave",H="onPointerEnter",N="pointer"),et=X==null?Y:it(X),V=ve==null?Y:it(ve),Y=new Ee(ne,N+"leave",X,n,te),Y.target=et,Y.relatedTarget=V,ne=null,mt(te)===G&&(Ee=new Ee(H,N+"enter",ve,n,te),Ee.target=V,Ee.relatedTarget=et,ne=Ee),et=ne,X&&ve)t:{for(Ee=Ry,H=X,N=ve,V=0,ne=H;ne;ne=Ee(ne))V++;ne=0;for(var Se=N;Se;Se=Ee(Se))ne++;for(;0<V-ne;)H=Ee(H),V--;for(;0<ne-V;)N=Ee(N),ne--;for(;V--;){if(H===N||N!==null&&H===N.alternate){Ee=H;break t}H=Ee(H),N=Ee(N)}Ee=null}else Ee=null;X!==null&&Bf(ie,Y,X,Ee,!1),ve!==null&&et!==null&&Bf(ie,et,ve,Ee,!0)}}e:{if(Y=G?it(G):window,X=Y.nodeName&&Y.nodeName.toLowerCase(),X==="select"||X==="input"&&Y.type==="file")var Ke=Zu;else if(Xu(Y))if(Wu)Ke=Im;else{Ke=Lm;var xe=qm}else X=Y.nodeName,!X||X.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?G&&Hl(G.elementType)&&(Ke=Zu):Ke=Hm;if(Ke&&(Ke=Ke(e,G))){Fu(ie,Ke,n,te);break e}xe&&xe(e,Y,G),e==="focusout"&&G&&Y.type==="number"&&G.memoizedProps.value!=null&&Ll(Y,"number",Y.value)}switch(xe=G?it(G):window,e){case"focusin":(Xu(xe)||xe.contentEditable==="true")&&(ui=xe,eo=G,sr=null);break;case"focusout":sr=eo=ui=null;break;case"mousedown":to=!0;break;case"contextmenu":case"mouseup":case"dragend":to=!1,ld(ie,n,te);break;case"selectionchange":if($m)break;case"keydown":case"keyup":ld(ie,n,te)}var Ue;if(Xl)e:{switch(e){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else ci?Ju(e,n)&&(Ie="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ie="onCompositionStart");Ie&&(Pu&&n.locale!=="ko"&&(ci||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&ci&&(Ue=Hu()):(ea=te,Pl="value"in ea?ea.value:ea.textContent,ci=!0)),xe=Zs(G,Ie),0<xe.length&&(Ie=new $u(Ie,e,null,n,te),ie.push({event:Ie,listeners:xe}),Ue?Ie.data=Ue:(Ue=Qu(n),Ue!==null&&(Ie.data=Ue)))),(Ue=zm?Um(e,n):Dm(e,n))&&(Ie=Zs(G,"onBeforeInput"),0<Ie.length&&(xe=new $u("onBeforeInput","beforeinput",null,n,te),ie.push({event:xe,listeners:Ie}),xe.data=Ue)),Cy(ie,e,G,n,te)}Uf(ie,t)})}function Nr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Zs(e,t){for(var n=t+"Capture",i=[];e!==null;){var c=e,h=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||h===null||(c=Zi(e,n),c!=null&&i.unshift(Nr(e,c,h)),c=Zi(e,t),c!=null&&i.push(Nr(e,c,h))),e.tag===3)return i;e=e.return}return[]}function Ry(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Bf(e,t,n,i,c){for(var h=t._reactName,y=[];n!==null&&n!==i;){var x=n,R=x.alternate,G=x.stateNode;if(x=x.tag,R!==null&&R===i)break;x!==5&&x!==26&&x!==27||G===null||(R=G,c?(G=Zi(n,h),G!=null&&y.unshift(Nr(n,G,R))):c||(G=Zi(n,h),G!=null&&y.push(Nr(n,G,R)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var Ny=/\r\n?/g,ky=/\u0000|\uFFFD/g;function Mf(e){return(typeof e=="string"?e:""+e).replace(Ny,`
`).replace(ky,"")}function qf(e,t){return t=Mf(t),Mf(e)===t}function We(e,t,n,i,c,h){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||si(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&si(e,""+i);break;case"className":ns(e,"class",i);break;case"tabIndex":ns(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":ns(e,n,i);break;case"style":Mu(e,i,h);break;case"data":if(t!=="object"){ns(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=is(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(n==="formAction"?(t!=="input"&&We(e,t,"name",c.name,c,null),We(e,t,"formEncType",c.formEncType,c,null),We(e,t,"formMethod",c.formMethod,c,null),We(e,t,"formTarget",c.formTarget,c,null)):(We(e,t,"encType",c.encType,c,null),We(e,t,"method",c.method,c,null),We(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=is(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=Dn);break;case"onScroll":i!=null&&Me("scroll",e);break;case"onScrollEnd":i!=null&&Me("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=is(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":Me("beforetoggle",e),Me("toggle",e),ts(e,"popover",i);break;case"xlinkActuate":Un(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Un(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Un(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Un(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Un(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Un(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Un(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Un(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Un(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":ts(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=sm.get(n)||n,ts(e,n,i))}}function Tc(e,t,n,i,c,h){switch(n){case"style":Mu(e,i,h);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof i=="string"?si(e,i):(typeof i=="number"||typeof i=="bigint")&&si(e,""+i);break;case"onScroll":i!=null&&Me("scroll",e);break;case"onScrollEnd":i!=null&&Me("scrollend",e);break;case"onClick":i!=null&&(e.onclick=Dn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Na.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),h=e[me]||null,h=h!=null?h[n]:null,typeof h=="function"&&e.removeEventListener(t,h,c),typeof i=="function")){typeof h!="function"&&h!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,c);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):ts(e,n,i)}}}function Ot(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Me("error",e),Me("load",e);var i=!1,c=!1,h;for(h in n)if(n.hasOwnProperty(h)){var y=n[h];if(y!=null)switch(h){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:We(e,t,h,y,n,null)}}c&&We(e,t,"srcSet",n.srcSet,n,null),i&&We(e,t,"src",n.src,n,null);return;case"input":Me("invalid",e);var x=h=y=c=null,R=null,G=null;for(i in n)if(n.hasOwnProperty(i)){var te=n[i];if(te!=null)switch(i){case"name":c=te;break;case"type":y=te;break;case"checked":R=te;break;case"defaultChecked":G=te;break;case"value":h=te;break;case"defaultValue":x=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(l(137,t));break;default:We(e,t,i,te,n,null)}}zu(e,h,x,R,G,y,c,!1);return;case"select":Me("invalid",e),i=y=h=null;for(c in n)if(n.hasOwnProperty(c)&&(x=n[c],x!=null))switch(c){case"value":h=x;break;case"defaultValue":y=x;break;case"multiple":i=x;default:We(e,t,c,x,n,null)}t=h,n=y,e.multiple=!!i,t!=null?ri(e,!!i,t,!1):n!=null&&ri(e,!!i,n,!0);return;case"textarea":Me("invalid",e),h=c=i=null;for(y in n)if(n.hasOwnProperty(y)&&(x=n[y],x!=null))switch(y){case"value":i=x;break;case"defaultValue":c=x;break;case"children":h=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(l(91));break;default:We(e,t,y,x,n,null)}Du(e,i,c,h);return;case"option":for(R in n)if(n.hasOwnProperty(R)&&(i=n[R],i!=null))switch(R){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:We(e,t,R,i,n,null)}return;case"dialog":Me("beforetoggle",e),Me("toggle",e),Me("cancel",e),Me("close",e);break;case"iframe":case"object":Me("load",e);break;case"video":case"audio":for(i=0;i<Rr.length;i++)Me(Rr[i],e);break;case"image":Me("error",e),Me("load",e);break;case"details":Me("toggle",e);break;case"embed":case"source":case"link":Me("error",e),Me("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(G in n)if(n.hasOwnProperty(G)&&(i=n[G],i!=null))switch(G){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:We(e,t,G,i,n,null)}return;default:if(Hl(t)){for(te in n)n.hasOwnProperty(te)&&(i=n[te],i!==void 0&&Tc(e,t,te,i,n,void 0));return}}for(x in n)n.hasOwnProperty(x)&&(i=n[x],i!=null&&We(e,t,x,i,n,null))}function zy(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,h=null,y=null,x=null,R=null,G=null,te=null;for(X in n){var ie=n[X];if(n.hasOwnProperty(X)&&ie!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":R=ie;default:i.hasOwnProperty(X)||We(e,t,X,null,i,ie)}}for(var Y in i){var X=i[Y];if(ie=n[Y],i.hasOwnProperty(Y)&&(X!=null||ie!=null))switch(Y){case"type":h=X;break;case"name":c=X;break;case"checked":G=X;break;case"defaultChecked":te=X;break;case"value":y=X;break;case"defaultValue":x=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(l(137,t));break;default:X!==ie&&We(e,t,Y,X,i,ie)}}ql(e,y,x,R,G,te,h,c);return;case"select":X=y=x=Y=null;for(h in n)if(R=n[h],n.hasOwnProperty(h)&&R!=null)switch(h){case"value":break;case"multiple":X=R;default:i.hasOwnProperty(h)||We(e,t,h,null,i,R)}for(c in i)if(h=i[c],R=n[c],i.hasOwnProperty(c)&&(h!=null||R!=null))switch(c){case"value":Y=h;break;case"defaultValue":x=h;break;case"multiple":y=h;default:h!==R&&We(e,t,c,h,i,R)}t=x,n=y,i=X,Y!=null?ri(e,!!n,Y,!1):!!i!=!!n&&(t!=null?ri(e,!!n,t,!0):ri(e,!!n,n?[]:"",!1));return;case"textarea":X=Y=null;for(x in n)if(c=n[x],n.hasOwnProperty(x)&&c!=null&&!i.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:We(e,t,x,null,i,c)}for(y in i)if(c=i[y],h=n[y],i.hasOwnProperty(y)&&(c!=null||h!=null))switch(y){case"value":Y=c;break;case"defaultValue":X=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==h&&We(e,t,y,c,i,h)}Uu(e,Y,X);return;case"option":for(var ve in n)if(Y=n[ve],n.hasOwnProperty(ve)&&Y!=null&&!i.hasOwnProperty(ve))switch(ve){case"selected":e.selected=!1;break;default:We(e,t,ve,null,i,Y)}for(R in i)if(Y=i[R],X=n[R],i.hasOwnProperty(R)&&Y!==X&&(Y!=null||X!=null))switch(R){case"selected":e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:We(e,t,R,Y,i,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ee in n)Y=n[Ee],n.hasOwnProperty(Ee)&&Y!=null&&!i.hasOwnProperty(Ee)&&We(e,t,Ee,null,i,Y);for(G in i)if(Y=i[G],X=n[G],i.hasOwnProperty(G)&&Y!==X&&(Y!=null||X!=null))switch(G){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(l(137,t));break;default:We(e,t,G,Y,i,X)}return;default:if(Hl(t)){for(var et in n)Y=n[et],n.hasOwnProperty(et)&&Y!==void 0&&!i.hasOwnProperty(et)&&Tc(e,t,et,void 0,i,Y);for(te in i)Y=i[te],X=n[te],!i.hasOwnProperty(te)||Y===X||Y===void 0&&X===void 0||Tc(e,t,te,Y,i,X);return}}for(var H in n)Y=n[H],n.hasOwnProperty(H)&&Y!=null&&!i.hasOwnProperty(H)&&We(e,t,H,null,i,Y);for(ie in i)Y=i[ie],X=n[ie],!i.hasOwnProperty(ie)||Y===X||Y==null&&X==null||We(e,t,ie,Y,i,X)}function Lf(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Uy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var c=n[i],h=c.transferSize,y=c.initiatorType,x=c.duration;if(h&&x&&Lf(y)){for(y=0,x=c.responseEnd,i+=1;i<n.length;i++){var R=n[i],G=R.startTime;if(G>x)break;var te=R.transferSize,ie=R.initiatorType;te&&Lf(ie)&&(R=R.responseEnd,y+=te*(R<x?1:(x-G)/(R-G)))}if(--i,t+=8*(h+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Ac=null,Oc=null;function Ws(e){return e.nodeType===9?e:e.ownerDocument}function Hf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function If(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Rc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Nc=null;function Dy(){var e=window.event;return e&&e.type==="popstate"?e===Nc?!1:(Nc=e,!0):(Nc=null,!1)}var Vf=typeof setTimeout=="function"?setTimeout:void 0,By=typeof clearTimeout=="function"?clearTimeout:void 0,$f=typeof Promise=="function"?Promise:void 0,My=typeof queueMicrotask=="function"?queueMicrotask:typeof $f<"u"?function(e){return $f.resolve(null).then(e).catch(qy)}:Vf;function qy(e){setTimeout(function(){throw e})}function ya(e){return e==="head"}function Gf(e,t){var n=t,i=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(i===0){e.removeChild(c),Mi(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")kr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,kr(n);for(var h=n.firstChild;h;){var y=h.nextSibling,x=h.nodeName;h[Ae]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&h.rel.toLowerCase()==="stylesheet"||n.removeChild(h),h=y}}else n==="body"&&kr(e.ownerDocument.body);n=c}while(n);Mi(t)}function Pf(e,t){var n=e;e=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=i}while(n)}function kc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":kc(n),Le(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Ly(e,t,n,i){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[Ae])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=fn(e.nextSibling),e===null)break}return null}function Hy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=fn(e.nextSibling),e===null))return null;return e}function Kf(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=fn(e.nextSibling),e===null))return null;return e}function zc(e){return e.data==="$?"||e.data==="$~"}function Uc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Iy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Dc=null;function Yf(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return fn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function Jf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Qf(e,t,n){switch(t=Ws(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function kr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Le(e)}var gn=new Map,Xf=new Set;function el(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Fn=L.d;L.d={f:Vy,r:$y,D:Gy,C:Py,L:Ky,m:Yy,X:Qy,S:Jy,M:Xy};function Vy(){var e=Fn.f(),t=Ps();return e||t}function $y(e){var t=Pe(e);t!==null&&t.tag===5&&t.type==="form"?hh(t):Fn.r(e)}var Ui=typeof document>"u"?null:document;function Ff(e,t,n){var i=Ui;if(i&&typeof t=="string"&&t){var c=sn(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),Xf.has(c)||(Xf.add(c),e={rel:e,crossOrigin:n,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),Ot(t,"link",e),rt(t),i.head.appendChild(t)))}}function Gy(e){Fn.D(e),Ff("dns-prefetch",e,null)}function Py(e,t){Fn.C(e,t),Ff("preconnect",e,t)}function Ky(e,t,n){Fn.L(e,t,n);var i=Ui;if(i&&e&&t){var c='link[rel="preload"][as="'+sn(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+sn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+sn(n.imageSizes)+'"]')):c+='[href="'+sn(e)+'"]';var h=c;switch(t){case"style":h=Di(e);break;case"script":h=Bi(e)}gn.has(h)||(e=_({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),gn.set(h,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(zr(h))||t==="script"&&i.querySelector(Ur(h))||(t=i.createElement("link"),Ot(t,"link",e),rt(t),i.head.appendChild(t)))}}function Yy(e,t){Fn.m(e,t);var n=Ui;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+sn(i)+'"][href="'+sn(e)+'"]',h=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Bi(e)}if(!gn.has(h)&&(e=_({rel:"modulepreload",href:e},t),gn.set(h,e),n.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Ur(h)))return}i=n.createElement("link"),Ot(i,"link",e),rt(i),n.head.appendChild(i)}}}function Jy(e,t,n){Fn.S(e,t,n);var i=Ui;if(i&&e){var c=kt(i).hoistableStyles,h=Di(e);t=t||"default";var y=c.get(h);if(!y){var x={loading:0,preload:null};if(y=i.querySelector(zr(h)))x.loading=5;else{e=_({rel:"stylesheet",href:e,"data-precedence":t},n),(n=gn.get(h))&&Bc(e,n);var R=y=i.createElement("link");rt(R),Ot(R,"link",e),R._p=new Promise(function(G,te){R.onload=G,R.onerror=te}),R.addEventListener("load",function(){x.loading|=1}),R.addEventListener("error",function(){x.loading|=2}),x.loading|=4,tl(y,t,i)}y={type:"stylesheet",instance:y,count:1,state:x},c.set(h,y)}}}function Qy(e,t){Fn.X(e,t);var n=Ui;if(n&&e){var i=kt(n).hoistableScripts,c=Bi(e),h=i.get(c);h||(h=n.querySelector(Ur(c)),h||(e=_({src:e,async:!0},t),(t=gn.get(c))&&Mc(e,t),h=n.createElement("script"),rt(h),Ot(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function Xy(e,t){Fn.M(e,t);var n=Ui;if(n&&e){var i=kt(n).hoistableScripts,c=Bi(e),h=i.get(c);h||(h=n.querySelector(Ur(c)),h||(e=_({src:e,async:!0,type:"module"},t),(t=gn.get(c))&&Mc(e,t),h=n.createElement("script"),rt(h),Ot(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function Zf(e,t,n,i){var c=(c=ae.current)?el(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Di(n.href),n=kt(c).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Di(n.href);var h=kt(c).hoistableStyles,y=h.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,y),(h=c.querySelector(zr(e)))&&!h._p&&(y.instance=h,y.state.loading=5),gn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},gn.set(e,n),h||Fy(c,e,n,y.state))),t&&i===null)throw Error(l(528,""));return y}if(t&&i!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Bi(n),n=kt(c).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Di(e){return'href="'+sn(e)+'"'}function zr(e){return'link[rel="stylesheet"]['+e+"]"}function Wf(e){return _({},e,{"data-precedence":e.precedence,precedence:null})}function Fy(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Ot(t,"link",n),rt(t),e.head.appendChild(t))}function Bi(e){return'[src="'+sn(e)+'"]'}function Ur(e){return"script[async]"+e}function eg(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+sn(n.href)+'"]');if(i)return t.instance=i,rt(i),i;var c=_({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),rt(i),Ot(i,"style",c),tl(i,n.precedence,e),t.instance=i;case"stylesheet":c=Di(n.href);var h=e.querySelector(zr(c));if(h)return t.state.loading|=4,t.instance=h,rt(h),h;i=Wf(n),(c=gn.get(c))&&Bc(i,c),h=(e.ownerDocument||e).createElement("link"),rt(h);var y=h;return y._p=new Promise(function(x,R){y.onload=x,y.onerror=R}),Ot(h,"link",i),t.state.loading|=4,tl(h,n.precedence,e),t.instance=h;case"script":return h=Bi(n.src),(c=e.querySelector(Ur(h)))?(t.instance=c,rt(c),c):(i=n,(c=gn.get(h))&&(i=_({},n),Mc(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),rt(c),Ot(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,tl(i,n.precedence,e));return t.instance}function tl(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,h=c,y=0;y<i.length;y++){var x=i[y];if(x.dataset.precedence===t)h=x;else if(h!==c)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Bc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Mc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var nl=null;function tg(e,t,n){if(nl===null){var i=new Map,c=nl=new Map;c.set(n,i)}else c=nl,i=c.get(n),i||(i=new Map,c.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var h=n[c];if(!(h[Ae]||h[ye]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var y=h.getAttribute(t)||"";y=e+y;var x=i.get(y);x?x.push(h):i.set(y,[h])}}return i}function ng(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Zy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function ag(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Wy(e,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=Di(i.href),h=t.querySelector(zr(c));if(h){t=h._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=al.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=h,rt(h);return}h=t.ownerDocument||t,i=Wf(i),(c=gn.get(c))&&Bc(i,c),h=h.createElement("link"),rt(h);var y=h;y._p=new Promise(function(x,R){y.onload=x,y.onerror=R}),Ot(h,"link",i),n.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=al.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var qc=0;function ev(e,t){return e.stylesheets&&e.count===0&&rl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&rl(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+t);0<e.imgBytes&&qc===0&&(qc=62500*Uy());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&rl(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>qc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function al(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)rl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var il=null;function rl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,il=new Map,t.forEach(tv,e),il=null,al.call(e))}function tv(e,t){if(!(t.state.loading&4)){var n=il.get(e);if(n)var i=n.get(null);else{n=new Map,il.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<c.length;h++){var y=c[h];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),i=y)}i&&n.set(null,i)}c=t.instance,y=c.getAttribute("data-precedence"),h=n.get(y)||i,h===i&&n.set(null,c),n.set(y,c),this.count++,i=al.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),h?h.parentNode.insertBefore(c,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Dr={$$typeof:B,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function nv(e,t,n,i,c,h,y,x,R){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oa(0),this.hiddenUpdates=Oa(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=h,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function ig(e,t,n,i,c,h,y,x,R,G,te,ie){return e=new nv(e,t,n,y,R,G,te,ie,x),t=1,h===!0&&(t|=24),h=Yt(3,null,null,t),e.current=h,h.stateNode=e,t=yo(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:i,isDehydrated:n,cache:t},_o(h),e}function rg(e){return e?(e=fi,e):fi}function sg(e,t,n,i,c,h){c=rg(c),i.context===null?i.context=c:i.pendingContext=c,i=sa(t),i.payload={element:n},h=h===void 0?null:h,h!==null&&(i.callback=h),n=la(e,i,t),n!==null&&(Pt(n,e,t),fr(n,e,t))}function lg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Lc(e,t){lg(e,t),(e=e.alternate)&&lg(e,t)}function og(e){if(e.tag===13||e.tag===31){var t=Da(e,67108864);t!==null&&Pt(t,e,67108864),Lc(e,67108864)}}function cg(e){if(e.tag===13||e.tag===31){var t=Zt();t=Xi(t);var n=Da(e,t);n!==null&&Pt(n,e,t),Lc(e,t)}}var sl=!0;function av(e,t,n,i){var c=U.T;U.T=null;var h=L.p;try{L.p=2,Hc(e,t,n,i)}finally{L.p=h,U.T=c}}function iv(e,t,n,i){var c=U.T;U.T=null;var h=L.p;try{L.p=8,Hc(e,t,n,i)}finally{L.p=h,U.T=c}}function Hc(e,t,n,i){if(sl){var c=Ic(i);if(c===null)Cc(e,t,i,ll,n),dg(e,i);else if(sv(c,e,t,n,i))i.stopPropagation();else if(dg(e,i),t&4&&-1<rv.indexOf(e)){for(;c!==null;){var h=Pe(c);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var y=kn(h.pendingLanes);if(y!==0){var x=h;for(x.pendingLanes|=2,x.entangledLanes|=2;y;){var R=1<<31-Mt(y);x.entanglements[1]|=R,y&=~R}Rn(h),(Qe&6)===0&&($s=Dt()+500,Or(0))}}break;case 31:case 13:x=Da(h,2),x!==null&&Pt(x,h,2),Ps(),Lc(h,2)}if(h=Ic(i),h===null&&Cc(e,t,i,ll,n),h===c)break;c=h}c!==null&&i.stopPropagation()}else Cc(e,t,i,null,n)}}function Ic(e){return e=Vl(e),Vc(e)}var ll=null;function Vc(e){if(ll=null,e=mt(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=f(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ll=e,null}function ug(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ru()){case Jr:return 2;case Qr:return 8;case Ca:case Rl:return 32;case Xr:return 268435456;default:return 32}default:return 32}}var $c=!1,va=null,ba=null,xa=null,Br=new Map,Mr=new Map,_a=[],rv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function dg(e,t){switch(e){case"focusin":case"focusout":va=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":xa=null;break;case"pointerover":case"pointerout":Br.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mr.delete(t.pointerId)}}function qr(e,t,n,i,c,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:h,targetContainers:[c]},t!==null&&(t=Pe(t),t!==null&&og(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function sv(e,t,n,i,c){switch(t){case"focusin":return va=qr(va,e,t,n,i,c),!0;case"dragenter":return ba=qr(ba,e,t,n,i,c),!0;case"mouseover":return xa=qr(xa,e,t,n,i,c),!0;case"pointerover":var h=c.pointerId;return Br.set(h,qr(Br.get(h)||null,e,t,n,i,c)),!0;case"gotpointercapture":return h=c.pointerId,Mr.set(h,qr(Mr.get(h)||null,e,t,n,i,c)),!0}return!1}function hg(e){var t=mt(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=f(n),t!==null){e.blockedOn=t,we(e.priority,function(){cg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,we(e.priority,function(){cg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ol(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ic(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Il=i,n.target.dispatchEvent(i),Il=null}else return t=Pe(n),t!==null&&og(t),e.blockedOn=n,!1;t.shift()}return!0}function fg(e,t,n){ol(e)&&n.delete(t)}function lv(){$c=!1,va!==null&&ol(va)&&(va=null),ba!==null&&ol(ba)&&(ba=null),xa!==null&&ol(xa)&&(xa=null),Br.forEach(fg),Mr.forEach(fg)}function cl(e,t){e.blockedOn===t&&(e.blockedOn=null,$c||($c=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,lv)))}var ul=null;function gg(e){ul!==e&&(ul=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){ul===e&&(ul=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(Vc(i||n)===null)continue;break}var h=Pe(n);h!==null&&(e.splice(t,3),t-=3,Io(h,{pending:!0,data:c,method:n.method,action:i},i,c))}}))}function Mi(e){function t(R){return cl(R,e)}va!==null&&cl(va,e),ba!==null&&cl(ba,e),xa!==null&&cl(xa,e),Br.forEach(t),Mr.forEach(t);for(var n=0;n<_a.length;n++){var i=_a[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<_a.length&&(n=_a[0],n.blockedOn===null);)hg(n),n.blockedOn===null&&_a.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var c=n[i],h=n[i+1],y=c[me]||null;if(typeof h=="function")y||gg(n);else if(y){var x=null;if(h&&h.hasAttribute("formAction")){if(c=h,y=h[me]||null)x=y.formAction;else if(Vc(c)!==null)continue}else x=y.action;typeof x=="function"?n[i+1]=x:(n.splice(i,3),i-=3),gg(n)}}}function pg(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function Gc(e){this._internalRoot=e}dl.prototype.render=Gc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,i=Zt();sg(n,i,e,t,null,null)},dl.prototype.unmount=Gc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sg(e.current,2,null,e,null,null),Ps(),t[Te]=null}};function dl(e){this._internalRoot=e}dl.prototype.unstable_scheduleHydration=function(e){if(e){var t=ue();e={blockedOn:null,target:e,priority:t};for(var n=0;n<_a.length&&t!==0&&t<_a[n].priority;n++);_a.splice(n,0,e),n===0&&hg(e)}};var mg=a.version;if(mg!=="19.2.0")throw Error(l(527,mg,"19.2.0"));L.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var ov={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hl.isDisabled&&hl.supportsFiber)try{Ta=hl.inject(ov),Bt=hl}catch{}}return Hr.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,i="",c=jh,h=Sh,y=wh;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=ig(e,1,!1,null,null,n,i,null,c,h,y,pg),e[Te]=t.current,Ec(e),new Gc(t)},Hr.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var i=!1,c="",h=jh,y=Sh,x=wh,R=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(h=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(x=n.onRecoverableError),n.formState!==void 0&&(R=n.formState)),t=ig(e,1,!0,t,n??null,i,c,R,h,y,x,pg),t.context=rg(null),n=t.current,i=Zt(),i=Xi(i),c=sa(i),c.callback=null,la(n,c,i),n=i,t.current.lanes=n,Ra(t,n),Rn(t),e[Te]=t.current,Ec(e),new dl(t)},Hr.version="19.2.0",Hr}var Cg;function bv(){if(Cg)return Kc.exports;Cg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),Kc.exports=vv(),Kc.exports}var xv=bv(),S=bu();const sp=ip(S);var su=function(o,a){return su=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},su(o,a)};function lp(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");su(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var jl=function(){return jl=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},jl.apply(this,arguments)};function Yi(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function op(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(f=o[g])&&(d=(u<3?f(d):u>3?f(a,s,d):f(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function cp(o,a){return function(s,l){a(s,l,o)}}function up(o,a,s,l,u,d){function f(C){if(C!==void 0&&typeof C!="function")throw new TypeError("Function expected");return C}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),_,j=!1,b=s.length-1;b>=0;b--){var w={};for(var A in l)w[A]=A==="access"?{}:l[A];for(var A in l.access)w.access[A]=l.access[A];w.addInitializer=function(C){if(j)throw new TypeError("Cannot add initializers after decoration has completed");d.push(f(C||null))};var O=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(O===void 0)continue;if(O===null||typeof O!="object")throw new TypeError("Object expected");(_=f(O.get))&&(v.get=_),(_=f(O.set))&&(v.set=_),(_=f(O.init))&&u.unshift(_)}else(_=f(O))&&(g==="field"?u.unshift(_):v[p]=_)}m&&Object.defineProperty(m,l.name,v),j=!0}function dp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function hp(o){return typeof o=="symbol"?o:"".concat(o)}function fp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function gp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function _e(o,a,s,l){function u(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function g(v){try{m(l.next(v))}catch(_){f(_)}}function p(v){try{m(l.throw(v))}catch(_){f(_)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function pp(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=g(0),f.throw=g(1),f.return=g(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Tl=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function mp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&Tl(a,o,s)}function Sl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function xu(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],f;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){f={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(f)throw f.error}}return d}function yp(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(xu(arguments[a]));return o}function vp(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],f=0,g=d.length;f<g;f++,u++)l[u]=d[f];return l}function bp(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function Ki(o){return this instanceof Ki?(this.v=o,this):new Ki(o)}function xp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",f),u[Symbol.asyncIterator]=function(){return this},u;function f(b){return function(w){return Promise.resolve(w).then(b,_)}}function g(b,w){l[b]&&(u[b]=function(A){return new Promise(function(O,C){d.push([b,A,O,C])>1||p(b,A)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(A){j(d[0][3],A)}}function m(b){b.value instanceof Ki?Promise.resolve(b.value.v).then(v,_):j(d[0][2],b)}function v(b){p("next",b)}function _(b){p("throw",b)}function j(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function _p(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(f){return(s=!s)?{value:Ki(o[u](f)),done:!1}:d?d(f):f}:d}}function jp(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Sl=="function"?Sl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(f){return new Promise(function(g,p){f=o[d](f),u(g,p,f.done,f.value)})}}function u(d,f,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},f)}}function Sp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var _v=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},lu=function(o){return lu=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},lu(o)};function wp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=lu(o),l=0;l<s.length;l++)s[l]!=="default"&&Tl(a,o,s[l]);return _v(a,o),a}function Ep(o){return o&&o.__esModule?o:{default:o}}function Cp(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function Tp(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Ap(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function Op(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var jv=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Rp(o){function a(d){o.error=o.hasError?new jv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(f){return a(f),u()})}else l|=1}catch(f){a(f)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function Np(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,f){return l?a?".jsx":".js":u&&(!d||!f)?s:u+d+"."+f.toLowerCase()+"js"}):o}const Sv={__extends:lp,__assign:jl,__rest:Yi,__decorate:op,__param:cp,__esDecorate:up,__runInitializers:dp,__propKey:hp,__setFunctionName:fp,__metadata:gp,__awaiter:_e,__generator:pp,__createBinding:Tl,__exportStar:mp,__values:Sl,__read:xu,__spread:yp,__spreadArrays:vp,__spreadArray:bp,__await:Ki,__asyncGenerator:xp,__asyncDelegator:_p,__asyncValues:jp,__makeTemplateObject:Sp,__importStar:wp,__importDefault:Ep,__classPrivateFieldGet:Cp,__classPrivateFieldSet:Tp,__classPrivateFieldIn:Ap,__addDisposableResource:Op,__disposeResources:Rp,__rewriteRelativeImportExtension:Np},wv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Op,get __assign(){return jl},__asyncDelegator:_p,__asyncGenerator:xp,__asyncValues:jp,__await:Ki,__awaiter:_e,__classPrivateFieldGet:Cp,__classPrivateFieldIn:Ap,__classPrivateFieldSet:Tp,__createBinding:Tl,__decorate:op,__disposeResources:Rp,__esDecorate:up,__exportStar:mp,__extends:lp,__generator:pp,__importDefault:Ep,__importStar:wp,__makeTemplateObject:Sp,__metadata:gp,__param:cp,__propKey:hp,__read:xu,__rest:Yi,__rewriteRelativeImportExtension:Np,__runInitializers:dp,__setFunctionName:fp,__spread:yp,__spreadArray:bp,__spreadArrays:vp,__values:Sl,default:Sv},Symbol.toStringTag,{value:"Module"})),Ev=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class _u extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Cv extends _u{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Tg extends _u{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Ag extends _u{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var ou;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(ou||(ou={}));class Tv{constructor(a,{headers:s={},customFetch:l,region:u=ou.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Ev(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return _e(this,arguments,void 0,function*(s,l={}){var u;let d,f;try{const{headers:g,method:p,body:m,signal:v,timeout:_}=l;let j={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${s}`);b&&b!=="any"&&(j["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let A;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(j["Content-Type"]="application/octet-stream",A=m):typeof m=="string"?(j["Content-Type"]="text/plain",A=m):typeof FormData<"u"&&m instanceof FormData?A=m:(j["Content-Type"]="application/json",A=JSON.stringify(m)):A=m;let O=v;_&&(f=new AbortController,d=setTimeout(()=>f.abort(),_),v?(O=f.signal,v.addEventListener("abort",()=>f.abort())):O=f.signal);const C=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},j),this.headers),g),body:A,signal:O}).catch(E=>{throw new Cv(E)}),M=C.headers.get("x-relay-error");if(M&&M==="true")throw new Tg(C);if(!C.ok)throw new Ag(C);let B=((u=C.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),K;return B==="application/json"?K=yield C.json():B==="application/octet-stream"||B==="application/pdf"?K=yield C.blob():B==="text/event-stream"?K=C:B==="multipart/form-data"?K=yield C.formData():K=yield C.text(),{data:K,error:null,response:C}}catch(g){return{data:null,error:g,response:g instanceof Ag||g instanceof Tg?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Ut={};const Ji=dv(wv);var fl={},gl={},pl={},ml={},yl={},vl={},Og;function kp(){if(Og)return vl;Og=1,Object.defineProperty(vl,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return vl.default=o,vl}var Rg;function zp(){if(Rg)return yl;Rg=1,Object.defineProperty(yl,"__esModule",{value:!0});const a=Ji.__importDefault(kp());class s{constructor(u){var d,f;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(f=u.isMaybeSingle)!==null&&f!==void 0?f:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let g=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,_,j;let b=null,w=null,A=null,O=p.status,C=p.statusText;if(p.ok){if(this.method!=="HEAD"){const E=await p.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=E:w=JSON.parse(E))}const B=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),K=(_=p.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");B&&K&&K.length>1&&(A=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,A=null,O=406,C="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const B=await p.text();try{b=JSON.parse(B),Array.isArray(b)&&p.status===404&&(w=[],b=null,O=200,C="OK")}catch{p.status===404&&B===""?(O=204,C="No Content"):b={message:B}}if(b&&this.isMaybeSingle&&(!((j=b?.details)===null||j===void 0)&&j.includes("0 rows"))&&(b=null,O=200,C="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:A,status:O,statusText:C}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,_;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=p?.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return yl.default=s,yl}var Ng;function Up(){if(Ng)return ml;Ng=1,Object.defineProperty(ml,"__esModule",{value:!0});const a=Ji.__importDefault(zp());class s extends a.default{select(u){let d=!1;const f=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:f,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:f=d}={}){const g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:f,referencedTable:g=f}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:f=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const _=[u?"analyze":null,d?"verbose":null,f?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),j=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${j}"; options=${_};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return ml.default=s,ml}var kg;function ju(){if(kg)return pl;kg=1,Object.defineProperty(pl,"__esModule",{value:!0});const a=Ji.__importDefault(Up()),s=new RegExp("[,()]");class l extends a.default{eq(d,f){return this.url.searchParams.append(d,`eq.${f}`),this}neq(d,f){return this.url.searchParams.append(d,`neq.${f}`),this}gt(d,f){return this.url.searchParams.append(d,`gt.${f}`),this}gte(d,f){return this.url.searchParams.append(d,`gte.${f}`),this}lt(d,f){return this.url.searchParams.append(d,`lt.${f}`),this}lte(d,f){return this.url.searchParams.append(d,`lte.${f}`),this}like(d,f){return this.url.searchParams.append(d,`like.${f}`),this}likeAllOf(d,f){return this.url.searchParams.append(d,`like(all).{${f.join(",")}}`),this}likeAnyOf(d,f){return this.url.searchParams.append(d,`like(any).{${f.join(",")}}`),this}ilike(d,f){return this.url.searchParams.append(d,`ilike.${f}`),this}ilikeAllOf(d,f){return this.url.searchParams.append(d,`ilike(all).{${f.join(",")}}`),this}ilikeAnyOf(d,f){return this.url.searchParams.append(d,`ilike(any).{${f.join(",")}}`),this}is(d,f){return this.url.searchParams.append(d,`is.${f}`),this}in(d,f){const g=Array.from(new Set(f)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cs.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cs.{${f.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(f)}`),this}containedBy(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cd.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cd.{${f.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(f)}`),this}rangeGt(d,f){return this.url.searchParams.append(d,`sr.${f}`),this}rangeGte(d,f){return this.url.searchParams.append(d,`nxl.${f}`),this}rangeLt(d,f){return this.url.searchParams.append(d,`sl.${f}`),this}rangeLte(d,f){return this.url.searchParams.append(d,`nxr.${f}`),this}rangeAdjacent(d,f){return this.url.searchParams.append(d,`adj.${f}`),this}overlaps(d,f){return typeof f=="string"?this.url.searchParams.append(d,`ov.${f}`):this.url.searchParams.append(d,`ov.{${f.join(",")}}`),this}textSearch(d,f,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${f}`),this}match(d){return Object.entries(d).forEach(([f,g])=>{this.url.searchParams.append(f,`eq.${g}`)}),this}not(d,f,g){return this.url.searchParams.append(d,`not.${f}.${g}`),this}or(d,{foreignTable:f,referencedTable:g=f}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,f,g){return this.url.searchParams.append(d,`${f}.${g}`),this}}return pl.default=l,pl}var zg;function Dp(){if(zg)return gl;zg=1,Object.defineProperty(gl,"__esModule",{value:!0});const a=Ji.__importDefault(ju());class s{constructor(u,{headers:d={},schema:f,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=f,this.fetch=g}select(u,d){const{head:f=!1,count:g}=d??{},p=f?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(_=>/\s/.test(_)&&!m?"":(_==='"'&&(m=!m),_)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:f=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,_)=>v.concat(Object.keys(_)),[]);if(m.length>0){const v=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:f=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const _=u.reduce((j,b)=>j.concat(Object.keys(b)),[]);if(_.length>0){const j=[...new Set(_)].map(b=>`"${b}"`);this.url.searchParams.set("columns",j.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var f;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:u}={}){var d;const f="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return gl.default=s,gl}var Ug;function Av(){if(Ug)return fl;Ug=1,Object.defineProperty(fl,"__esModule",{value:!0});const o=Ji,a=o.__importDefault(Dp()),s=o.__importDefault(ju());class l{constructor(d,{headers:f={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(f),this.schemaName=g,this.fetch=p}from(d){const f=new URL(`${this.url}/${d}`);return new a.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,f={},{head:g=!1,get:p=!1,count:m}={}){var v;let _;const j=new URL(`${this.url}/rpc/${d}`);let b;g||p?(_=g?"HEAD":"GET",Object.entries(f).filter(([A,O])=>O!==void 0).map(([A,O])=>[A,Array.isArray(O)?`{${O.join(",")}}`:`${O}`]).forEach(([A,O])=>{j.searchParams.append(A,O)})):(_="POST",b=f);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new s.default({method:_,url:j,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return fl.default=l,fl}var Dg;function Ov(){if(Dg)return Ut;Dg=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.PostgrestError=Ut.PostgrestBuilder=Ut.PostgrestTransformBuilder=Ut.PostgrestFilterBuilder=Ut.PostgrestQueryBuilder=Ut.PostgrestClient=void 0;const o=Ji,a=o.__importDefault(Av());Ut.PostgrestClient=a.default;const s=o.__importDefault(Dp());Ut.PostgrestQueryBuilder=s.default;const l=o.__importDefault(ju());Ut.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Up());Ut.PostgrestTransformBuilder=u.default;const d=o.__importDefault(zp());Ut.PostgrestBuilder=d.default;const f=o.__importDefault(kp());return Ut.PostgrestError=f.default,Ut.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:f.default},Ut}var Bp=Ov();const Mp=ip(Bp),Rv=uv({__proto__:null,default:Mp},[Bp]),{PostgrestClient:Nv,PostgrestQueryBuilder:l_,PostgrestFilterBuilder:o_,PostgrestTransformBuilder:c_,PostgrestBuilder:u_,PostgrestError:d_}=Mp||Rv;class kv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const zv="2.81.1",Uv=`realtime-js/${zv}`,qp="1.0.0",Dv="2.0.0",Bg=qp,cu=1e4,Bv=1e3,Mv=100;var Za;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(Za||(Za={}));var wt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(wt||(wt={}));var pn;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(pn||(pn={}));var uu;(function(o){o.websocket="websocket"})(uu||(uu={}));var Wa;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(Wa||(Wa={}));class qv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:f}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(l,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(d,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(u,j=>m.setUint8(v++,j.charCodeAt(0)));var _=new Uint8Array(p.byteLength+f.byteLength);return _.set(new Uint8Array(p),0),_.set(new Uint8Array(f),p.byteLength),_.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let _=new DataView(v),j=0;_.setUint8(j++,this.KINDS.userBroadcastPush),_.setUint8(j++,u.length),_.setUint8(j++,d.length),_.setUint8(j++,f.length),_.setUint8(j++,g.length),_.setUint8(j++,this.BINARY_ENCODING),Array.from(u,w=>_.setUint8(j++,w.charCodeAt(0))),Array.from(d,w=>_.setUint8(j++,w.charCodeAt(0))),Array.from(f,w=>_.setUint8(j++,w.charCodeAt(0))),Array.from(g,w=>_.setUint8(j++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,_=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,j=new ArrayBuffer(this.HEADER_LENGTH+_);let b=new DataView(j),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,f.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(d,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(f,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(g,O=>b.setUint8(w++,O.charCodeAt(0)));var A=new Uint8Array(j.byteLength+v.byteLength);return A.set(new Uint8Array(j),0),A.set(new Uint8Array(v),j.byteLength),A.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,f,g,p]=l;return s({join_ref:u,ref:d,topic:f,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+f));g=g+f;const _=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:_}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+f));p=p+f;const j=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:j,response:b};return{join_ref:m,ref:v,topic:_,event:pn.reply,payload:w}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let f=this.HEADER_LENGTH+2;const g=l.decode(a.slice(f,f+u));f=f+u;const p=l.decode(a.slice(f,f+d));f=f+d;const m=JSON.parse(l.decode(a.slice(f,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+f));p=p+f;const j=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(j)):j,w={type:this.BROADCAST,event:v,payload:b};return f>0&&(w.meta=JSON.parse(_)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Lp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var nt;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(nt||(nt={}));const Mg=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,f)=>(d[f]=Lv(f,o,a,u),d),{}):{}},Lv=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,f=s[o];return d&&!l.includes(d)?Hp(d,f):du(f)},Hp=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return $v(a,s)}switch(o){case nt.bool:return Hv(a);case nt.float4:case nt.float8:case nt.int2:case nt.int4:case nt.int8:case nt.numeric:case nt.oid:return Iv(a);case nt.json:case nt.jsonb:return Vv(a);case nt.timestamp:return Gv(a);case nt.abstime:case nt.date:case nt.daterange:case nt.int4range:case nt.int8range:case nt.money:case nt.reltime:case nt.text:case nt.time:case nt.timestamptz:case nt.timetz:case nt.tsrange:case nt.tstzrange:return du(a);default:return du(a)}},du=o=>o,Hv=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Iv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Vv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},$v=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const f=o.slice(1,s);try{d=JSON.parse("["+f+"]")}catch{d=f?f.split(","):[]}return d.map(g=>Hp(a,g))}return o},Gv=o=>typeof o=="string"?o.replace(" ","T"):o,Ip=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class Fc{constructor(a,s,l={},u=cu){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var qg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(qg||(qg={}));class Vr{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vr.syncState(this.state,u,d,f),this.pendingDiffs.forEach(p=>{this.state=Vr.syncDiff(this.state,p,d,f)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=Vr.syncDiff(this.state,u,d,f),g())}),this.onJoin((u,d,f)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:f})}),this.onLeave((u,d,f)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),f=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{f[m]||(p[m]=v)}),this.map(f,(m,v)=>{const _=d[m];if(_){const j=v.map(O=>O.presence_ref),b=_.map(O=>O.presence_ref),w=v.filter(O=>b.indexOf(O.presence_ref)<0),A=_.filter(O=>j.indexOf(O.presence_ref)<0);w.length>0&&(g[m]=w),A.length>0&&(p[m]=A)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:f}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const _=a[g].map(b=>b.presence_ref),j=v.filter(b=>_.indexOf(b.presence_ref)<0);a[g].unshift(...j)}l(g,v,p)}),this.map(f,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(_=>_.presence_ref);m=m.filter(_=>v.indexOf(_.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lg;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Lg||(Lg={}));var $r;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})($r||($r={}));var Zn;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(Zn||(Zn={}));class Su{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new Fc(this,pn.join,this.params,this.timeout),this.rejoinTimer=new Lp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wt.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(pn.reply,{},(f,g)=>{this._trigger(this._replyEventName(g),f)}),this.presence=new Vr(this),this.broadcastEndpointURL=Ip(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==wt.closed){const{config:{broadcast:f,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[$r.PRESENCE]&&this.bindings[$r.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,_={},j={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(Zn.CHANNEL_ERROR,b)),this._onClose(()=>a?.(Zn.CLOSED)),this.updateJoinPayload(Object.assign({config:j},_)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(Zn.SUBSCRIBED);return}else{const A=this.bindings.postgres_changes,O=(w=A?.length)!==null&&w!==void 0?w:0,C=[];for(let M=0;M<O;M++){const B=A[M],{filter:{event:K,schema:E,table:q,filter:k}}=B,I=b&&b[M];if(I&&I.event===K&&I.schema===E&&I.table===q&&I.filter===k)C.push(Object.assign(Object.assign({},B),{id:I.id}));else{this.unsubscribe(),this.state=wt.errored,a?.(Zn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,a&&a(Zn.SUBSCRIBED);return}}).receive("error",b=>{this.state=wt.errored,a?.(Zn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(Zn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===wt.joined&&a===$r.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:f}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var f,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(f=this.params)===null||f===void 0?void 0:f.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=wt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(pn.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new Fc(this,pn.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wt.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),f=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),f}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new Fc(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Mv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const f=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=pn;if(l&&[g,p,m,v].indexOf(f)>=0&&l!==this._joinRef())return;let j=this._onMessage(f,s,l);if(s&&!j)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,A,O;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((O=(A=b.filter)===null||A===void 0?void 0:A.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===f}).map(b=>b.callback(j,l)):(d=this.bindings[f])===null||d===void 0||d.filter(b=>{var w,A,O,C,M,B;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in b){const K=b.id,E=(w=b.filter)===null||w===void 0?void 0:w.event;return K&&((A=s.ids)===null||A===void 0?void 0:A.includes(K))&&(E==="*"||E?.toLocaleLowerCase()===((O=s.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const K=(M=(C=b?.filter)===null||C===void 0?void 0:C.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return K==="*"||K===((B=s?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===f}).map(b=>{if(typeof j=="object"&&"ids"in j){const w=j.data,{schema:A,table:O,commit_timestamp:C,type:M,errors:B}=w;j=Object.assign(Object.assign({},{schema:A,table:O,commit_timestamp:C,eventType:M,new:{},old:{},errors:B}),this._getPayloadRecords(w))}b.callback(j,l)})}_isClosed(){return this.state===wt.closed}_isJoined(){return this.state===wt.joined}_isJoining(){return this.state===wt.joining}_isLeaving(){return this.state===wt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Su.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(pn.close,{},a)}_onError(a){this._on(pn.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Mg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Mg(a.columns,a.old_record)),s}}const Zc=()=>{},bl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Pv=[1e3,2e3,5e3,1e4],Kv=1e4,Yv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=cu,this.transport=null,this.heartbeatIntervalMs=bl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zc,this.ref=0,this.reconnectTimer=null,this.vsn=Bg,this.logger=Zc,this.conn=null,this.sendBuffer=[],this.serializer=new qv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${uu.websocket}`,this.httpEndpoint=Ip(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=kv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case Za.connecting:return Wa.Connecting;case Za.open:return Wa.Open;case Za.closing:return Wa.Closing;default:return Wa.Closed}}isConnected(){return this.connectionState()===Wa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Su(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,f=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Bv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},bl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:f}=s,g=f?`(${f})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,f)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Za.open||this.conn.readyState===Za.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(pn.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Yv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:Uv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(pn.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Lp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},bl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,f,g,p,m,v,_,j,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:cu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:bl.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(f=a?.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:Zc,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Bg,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Pv[w-1]||Kv),this.vsn){case qp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,A)=>A(JSON.stringify(w))),this.decode=(_=a?.decode)!==null&&_!==void 0?_:((w,A)=>A(JSON.parse(w)));break;case Dv:this.encode=(j=a?.encode)!==null&&j!==void 0?j:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class wu extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function dt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Qv extends wu{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class hu extends wu{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const Eu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Xv=()=>Response,fu=o=>{if(Array.isArray(o))return o.map(s=>fu(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=fu(l)}),a},Fv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Wc=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},Zv=(o,a,s)=>_e(void 0,void 0,void 0,function*(){const l=yield Xv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,f=u?.statusCode||d+"";a(new Qv(Wc(u),d,f))}).catch(u=>{a(new hu(Wc(u),u))}):a(new hu(Wc(o),o))}),Wv=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Fv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function Yr(o,a,s,l,u,d){return _e(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,Wv(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>f(p)).catch(p=>Zv(p,g,l))})})}function Gr(o,a,s,l){return _e(this,void 0,void 0,function*(){return Yr(o,"GET",a,s,l)})}function Sn(o,a,s,l,u){return _e(this,void 0,void 0,function*(){return Yr(o,"POST",a,l,u,s)})}function gu(o,a,s,l,u){return _e(this,void 0,void 0,function*(){return Yr(o,"PUT",a,l,u,s)})}function eb(o,a,s,l){return _e(this,void 0,void 0,function*(){return Yr(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function Cu(o,a,s,l,u){return _e(this,void 0,void 0,function*(){return Yr(o,"DELETE",a,l,u,s)})}class tb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return _e(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dt(a))return{data:null,error:a};throw a}})}}var Vp;class nb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Vp]="BlobDownloadBuilder",this.promise=null}asStream(){return new tb(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return _e(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(dt(a))return{data:null,error:a};throw a}})}}Vp=Symbol.toStringTag;const ab={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Hg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ib{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=Eu(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return _e(this,void 0,void 0,function*(){try{let d;const f=Object.assign(Object.assign({},Hg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(f.upsert)});const p=f.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",f.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!f.duplex&&(f.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),_=yield(a=="PUT"?gu:Sn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},f?.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:_.Id,fullPath:_.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(dt(d))return{data:null,error:d};throw d}})}upload(a,s,l){return _e(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return _e(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),f=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:Hg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const _=yield gu(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:_.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(dt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return _e(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield Sn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),f=new URL(this.url+d.url),g=f.searchParams.get("token");if(!g)throw new wu("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dt(l))return{data:null,error:l};throw l}})}update(a,s,l){return _e(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return _e(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(dt(u))return{data:null,error:u};throw u}})}copy(a,s,l){return _e(this,void 0,void 0,function*(){try{return{data:{path:(yield Sn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(dt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return _e(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield Sn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const f=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${f}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(dt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return _e(this,void 0,void 0,function*(){try{const u=yield Sn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(dt(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),f=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>Gr(this.fetch,`${this.url}/${u}/${g}${f}`,{headers:this.headers,noResolveJson:!0});return new nb(p,this.shouldThrowOnError)}info(a){return _e(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield Gr(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:fu(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dt(l))return{data:null,error:l};throw l}})}exists(a){return _e(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield eb(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dt(l)&&l instanceof hu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return _e(this,void 0,void 0,function*(){try{return{data:yield Cu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}list(a,s,l){return _e(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},ab),s),{prefix:a||""});return{data:yield Sn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(dt(u))return{data:null,error:u};throw u}})}listV2(a,s){return _e(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield Sn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const $p="2.81.1",Gp={"X-Client-Info":`storage-js/${$p}`};class rb{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gp),s),this.fetch=Eu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return _e(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield Gr(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}getBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}createBucket(a){return _e(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield Sn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(dt(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return _e(this,void 0,void 0,function*(){try{return{data:yield gu(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(dt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:yield Cu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class sb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Gp),s),this.fetch=Eu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:yield Sn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}listBuckets(a){return _e(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield Gr(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:yield Cu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(dt(s))return{data:null,error:s};throw s}})}}const Tu={"X-Client-Info":`storage-js/${$p}`,"Content-Type":"application/json"};class Pp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Wt(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class eu extends Pp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lb extends Pp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Ig;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Ig||(Ig={}));const Au=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ob=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Vg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),cb=(o,a,s)=>_e(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(f=>{const g=f?.statusCode||f?.code||u+"";a(new eu(Vg(f),u,g))}).catch(()=>{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new eu(g,u,f))});else{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new eu(g,u,f))}}else a(new lb(Vg(o),o))}),ub=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(ob(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function db(o,a,s,l,u,d){return _e(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,ub(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>f(p)).catch(p=>cb(p,g,l))})})}function en(o,a,s,l,u){return _e(this,void 0,void 0,function*(){return db(o,"POST",a,l,u,s)})}class hb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tu),s),this.fetch=Au(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return _e(this,void 0,void 0,function*(){try{return{data:(yield en(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}getIndex(a,s){return _e(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Wt(l))return{data:null,error:l};throw l}})}listIndexes(a){return _e(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return _e(this,void 0,void 0,function*(){try{return{data:(yield en(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Wt(l))return{data:null,error:l};throw l}})}}class fb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tu),s),this.fetch=Au(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return _e(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield en(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}getVectors(a){return _e(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}listVectors(a){return _e(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield en(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}queryVectors(a){return _e(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}deleteVectors(a){return _e(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield en(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}}class gb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tu),s),this.fetch=Au(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:(yield en(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}getBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}listBuckets(){return _e(this,arguments,void 0,function*(a={}){try{return{data:yield en(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return _e(this,void 0,void 0,function*(){try{return{data:(yield en(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}}class pb extends gb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new mb(this.url,this.headers,a,this.fetch)}}class mb extends hb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return _e(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return _e(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return _e(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return _e(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new yb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class yb extends fb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return _e(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return _e(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return _e(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return _e(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return _e(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vb extends rb{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new ib(this.url,this.headers,a,this.fetch)}get vectors(){return new pb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new sb(this.url+"/iceberg",this.headers,this.fetch)}}const bb="2.81.1";let Ir="";typeof Deno<"u"?Ir="deno":typeof document<"u"?Ir="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ir="react-native":Ir="node";const xb={"X-Client-Info":`supabase-js-${Ir}/${bb}`},_b={headers:xb},jb={schema:"public"},Sb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wb={},Eb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Cb=()=>Headers,Tb=(o,a,s)=>{const l=Eb(s),u=Cb();return async(d,f)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(f?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},f),{headers:m}))}};function Ab(o){return o.endsWith("/")?o:o+"/"}function Ob(o,a){var s,l;const{db:u,auth:d,realtime:f,global:g}=o,{db:p,auth:m,realtime:v,global:_}=a,j={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),f),storage:{},global:Object.assign(Object.assign(Object.assign({},_),g),{headers:Object.assign(Object.assign({},(s=_?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?j.accessToken=o.accessToken:delete j.accessToken,j}function Rb(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ab(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Kp="2.81.1",$i=30*1e3,pu=3,tu=pu*$i,Nb="http://localhost:9999",kb="supabase.auth.token",zb={"X-Client-Info":`gotrue-js/${Kp}`},mu="X-Supabase-Api-Version",Yp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ub=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Db=600*1e3;class Pr extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function je(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Bb extends Pr{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function Mb(o){return je(o)&&o.name==="AuthApiError"}class ei extends Pr{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class Ea extends Pr{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class _n extends Ea{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function qb(o){return je(o)&&o.name==="AuthSessionMissingError"}class qi extends Ea{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xl extends Ea{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class _l extends Ea{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Lb(o){return je(o)&&o.name==="AuthImplicitGrantRedirectError"}class $g extends Ea{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class yu extends Ea{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function nu(o){return je(o)&&o.name==="AuthRetryableFetchError"}class Gg extends Ea{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class vu extends Ea{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const wl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Pg=` 	
\r=`.split(""),Hb=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Pg.length;a+=1)o[Pg[a].charCodeAt(0)]=-2;for(let a=0;a<wl.length;a+=1)o[wl[a].charCodeAt(0)]=a;return o})();function Kg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(wl[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(wl[l]),a.queuedBits-=6}}function Jp(o,a,s){const l=Hb[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Yg(o){const a=[],s=f=>{a.push(String.fromCodePoint(f))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=f=>{$b(f,l,s)};for(let f=0;f<o.length;f+=1)Jp(o.charCodeAt(f),u,d);return a.join("")}function Ib(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Vb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Ib(l,a)}}function $b(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function Pi(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)Jp(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Gb(o){const a=[];return Vb(o,s=>a.push(s)),new Uint8Array(a)}function ti(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Kg(u,s,l)),Kg(null,s,l),a.join("")}function Pb(o){return Math.round(Date.now()/1e3)+o}function Kb(){return Symbol("auth-callback")}const Rt=()=>typeof window<"u"&&typeof document<"u",Ja={tested:!1,writable:!1},Qp=()=>{if(!Rt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ja.tested)return Ja.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),Ja.tested=!0,Ja.writable=!0}catch{Ja.tested=!0,Ja.writable=!1}return Ja.writable};function Yb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const Xp=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Jb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",Gi=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},Qa=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Sa=async(o,a)=>{await o.removeItem(a)};class Al{constructor(){this.promise=new Al.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Al.promiseConstructor=Promise;function au(o){const a=o.split(".");if(a.length!==3)throw new vu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!Ub.test(a[l]))throw new vu("JWT not in base64url format");return{header:JSON.parse(Yg(a[0])),payload:JSON.parse(Yg(a[1])),signature:Pi(a[2]),raw:{header:a[0],payload:a[1]}}}async function Qb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Xb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const f=await o(d);if(!a(d,null,f)){l(f);return}}catch(f){if(!a(d,f)){u(f);return}}})()})}function Fb(o){return("0"+o.toString(16)).substr(-2)}function Zb(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Fb).join("")}async function Wb(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function e0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await Wb(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Li(o,a,s=!1){const l=Zb();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await Gi(o,`${a}-code-verifier`,u);const d=await e0(l);return[d,l===d?"plain":"s256"]}const t0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function n0(o){const a=o.headers.get(mu);if(!a||!a.match(t0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function a0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function i0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const r0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hi(o){if(!r0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function iu(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function Jg(o){return JSON.parse(JSON.stringify(o))}const Fa=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),l0=[502,503,504];async function Qg(o){var a;if(!Jb(o))throw new yu(Fa(o),0);if(l0.includes(o.status))throw new yu(Fa(o),o.status);let s;try{s=await o.json()}catch(d){throw new ei(Fa(d),d)}let l;const u=n0(o);if(u&&u.getTime()>=Yp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Gg(Fa(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new _n}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,f)=>d&&typeof f=="string",!0))throw new Gg(Fa(s),o.status,s.weak_password.reasons);throw new Bb(Fa(s),o.status||500,l)}const o0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Ce(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[mu]||(d[mu]=Yp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const f=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(f.redirect_to=l.redirectTo);const g=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",p=await c0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function c0(o,a,s,l,u,d){const f=o0(a,l,u,d);let g;try{g=await o(s,Object.assign({},f))}catch(p){throw console.error(p),new yu(Fa(p),0)}if(g.ok||await Qg(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await Qg(p)}}function jn(o){var a;let s=null;h0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Pb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function Xg(o){const a=jn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function wa(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function u0(o){return{data:o,error:null}}function d0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,f=Yi(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},f);return{data:{properties:g,user:p},error:null}}function Fg(o){return o}function h0(o){return o.access_token&&o.refresh_token&&o.expires_in}const ru=["global","local","others"];class f0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=Xp(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=ru[0]){if(ru.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ru.join(", ")}`);try{return await Ce(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(je(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Ce(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:wa})}catch(l){if(je(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=Yi(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Ce(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:d0,redirectTo:s?.redirectTo})}catch(s){if(je(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Ce(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:wa})}catch(s){if(je(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Ce(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:Fg});if(v.error)throw v.error;const _=await v.json(),j=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const A=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=A}),m.total=parseInt(j)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(je(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){Hi(a);try{return await Ce(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:wa})}catch(s){if(je(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){Hi(a);try{return await Ce(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:wa})}catch(l){if(je(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){Hi(a);try{return await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:wa})}catch(l){if(je(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){Hi(a.userId);try{const{data:s,error:l}=await Ce(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(je(s))return{data:null,error:s};throw s}}async _deleteFactor(a){Hi(a.userId),Hi(a.id);try{return{data:await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(je(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Ce(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:Fg});if(v.error)throw v.error;const _=await v.json(),j=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const A=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=A}),m.total=parseInt(j)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(je(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Ce(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(je(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Ce(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(je(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Ce(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(je(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Ce(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(je(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Ce(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(je(s))return{data:null,error:s};throw s}}}function Zg(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const Ii={debug:!!(globalThis&&Qp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Fp extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class g0 extends Fp{}async function p0(o,a,s){Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw Ii.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new g0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Ii.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function m0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Zp(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function y0(o){return parseInt(o,16)}function v0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function b0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:f,notBefore:g,requestId:p,resources:m,scheme:v,uri:_,version:j}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!_)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(j!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${j}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=Zp(o.address),w=v?`${v}://${l}`:l,A=o.statement?`${o.statement}
`:"",O=`${w} wants you to sign in with your Ethereum account:
${b}

${A}`;let C=`URI: ${_}
Version: ${j}
Chain ID: ${s}${f?`
Nonce: ${f}`:""}
Issued At: ${d.toISOString()}`;if(u&&(C+=`
Expiration Time: ${u.toISOString()}`),g&&(C+=`
Not Before: ${g.toISOString()}`),p&&(C+=`
Request ID: ${p}`),m){let M=`
Resources:`;for(const B of m){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);M+=`
- ${B}`}C+=M}return`${O}
${C}`}class _t extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class El extends _t{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function x0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new _t({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new _t({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new _t({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new _t({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new _t({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new _t({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new _t({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new _t({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const f=window.location.hostname;if(Wp(f)){if(d.rp.id!==f)return new _t({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new _t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new _t({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new _t({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new _t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function _0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new _t({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new _t({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(Wp(l)){if(s.rpId!==l)return new _t({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new _t({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new _t({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new _t({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class j0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const S0=new j0;function w0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=Yi(o,["challenge","user","excludeCredentials"]),d=Pi(a).buffer,f=Object.assign(Object.assign({},s),{id:Pi(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:f});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:Pi(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function E0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=Yi(o,["challenge","allowCredentials"]),u=Pi(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let f=0;f<s.length;f++){const g=s[f];d.allowCredentials[f]=Object.assign(Object.assign({},g),{id:Pi(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function C0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:ti(new Uint8Array(o.response.attestationObject)),clientDataJSON:ti(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function T0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:ti(new Uint8Array(u.authenticatorData)),clientDataJSON:ti(new Uint8Array(u.clientDataJSON)),signature:ti(new Uint8Array(u.signature)),userHandle:u.userHandle?ti(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function Wp(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function Wg(){var o,a;return!!(Rt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function A0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new El("Browser returned unexpected credential type",a)}:{data:null,error:new El("Empty credential response",a)}}catch(a){return{data:null,error:x0({error:a,options:o})}}}async function O0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new El("Browser returned unexpected credential type",a)}:{data:null,error:new El("Empty credential response",a)}}catch(a){return{data:null,error:_0({error:a,options:o})}}}const R0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},N0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Cl(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const f=u[d];if(f!==void 0)if(Array.isArray(f))l[d]=f;else if(s(f))l[d]=f;else if(a(f)){const g=l[d];a(g)?l[d]=Cl(g,f):l[d]=Cl(f)}else l[d]=f}return l}function k0(o,a){return Cl(R0,o,a||{})}function z0(o,a){return Cl(N0,o,a||{})}class U0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:f,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!f)return{data:null,error:g};const p=u??S0.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=k0(f.webauthn.credential_options.publicKey,d?.create),{data:v,error:_}=await A0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}case"request":{const m=z0(f.webauthn.credential_options.publicKey,d?.request),{data:v,error:_}=await O0(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}}}catch(f){return je(f)?{data:null,error:f}:{data:null,error:new ei("Unexpected error in challenge",f)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new Pr("rpId is required for WebAuthn authentication")};try{if(!Wg())return{data:null,error:new ei("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!f)return{data:null,error:g};const{webauthn:p}=f;return this._verify({factorId:a,challengeId:f.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(f){return je(f)?{data:null,error:f}:{data:null,error:new ei("Unexpected error in authenticate",f)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new Pr("rpId is required for WebAuthn registration")};try{if(!Wg())return{data:null,error:new ei("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this._enroll({friendlyName:a});if(!f)return await this.client.mfa.listFactors().then(v=>{var _;return(_=v.data)===null||_===void 0?void 0:_.all.find(j=>j.factor_type==="webauthn"&&j.friendly_name===a&&j.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:f.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(f){return je(f)?{data:null,error:f}:{data:null,error:new ei("Unexpected error in register",f)}}}}m0();const D0={url:Nb,storageKey:kb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ep(o,a,s){return await s()}const Vi={};class Kr{get jwks(){var a,s;return(s=(a=Vi[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){Vi[this.storageKey]=Object.assign(Object.assign({},Vi[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=Vi[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){Vi[this.storageKey]=Object.assign(Object.assign({},Vi[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},D0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=Kr.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,Kr.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&Rt()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new f0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Xp(d.fetch),this.lock=d.lock||ep,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:Rt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=p0:this.lock=ep,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new U0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:Qp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Zg(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=Zg(this.memoryStorage)),Rt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Kp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(Rt()&&(s=Yb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),Rt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Lb(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:f,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",f,"redirect type",g),await this._saveSession(f),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return je(s)?this._returnResult({error:s}):this._returnResult({error:new ei("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:jn}),{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(je(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:_,options:j}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await Li(this.storage,this.storageKey)),d=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:j?.emailRedirectTo,body:{email:v,password:_,data:(s=j?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:j?.captchaToken},code_challenge:b,code_challenge_method:w},xform:jn})}else if("phone"in a){const{phone:v,password:_,options:j}=a;d=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:_,data:(l=j?.data)!==null&&l!==void 0?l:{},channel:(u=j?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:j?.captchaToken}},xform:jn})}else throw new xl("You must provide either an email or phone number and a password");const{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(je(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:f,options:g}=a;s=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:Xg})}else if("phone"in a){const{phone:d,password:f,options:g}=a;s=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:Xg})}else throw new xl("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new qi;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(je(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,f,g,p,m,v,_,j;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:A,wallet:O,statement:C,options:M}=a;let B;if(Rt())if(typeof O=="object")B=O;else{const ce=window;if("ethereum"in ce&&typeof ce.ethereum=="object"&&"request"in ce.ethereum&&typeof ce.ethereum.request=="function")B=ce.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=O}const K=new URL((s=M?.url)!==null&&s!==void 0?s:window.location.href),E=await B.request({method:"eth_requestAccounts"}).then(ce=>ce).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const q=Zp(E[0]);let k=(l=M?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!k){const ce=await B.request({method:"eth_chainId"});k=y0(ce)}const I={domain:K.host,address:q,statement:C,uri:K.href,version:"1",chainId:k,nonce:(u=M?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(f=(d=M?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(g=M?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=M?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=M?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=M?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=b0(I),w=await B.request({method:"personal_sign",params:[v0(b),q]})}try{const{data:A,error:O}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(j=a.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:jn});if(O)throw O;if(!A||!A.session||!A.user){const C=new qi;return this._returnResult({data:{user:null,session:null},error:C})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:O})}catch(A){if(je(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async signInWithSolana(a){var s,l,u,d,f,g,p,m,v,_,j,b;let w,A;if("message"in a)w=a.message,A=a.signature;else{const{chain:O,wallet:C,statement:M,options:B}=a;let K;if(Rt())if(typeof C=="object")K=C;else{const q=window;if("solana"in q&&typeof q.solana=="object"&&("signIn"in q.solana&&typeof q.solana.signIn=="function"||"signMessage"in q.solana&&typeof q.solana.signMessage=="function"))K=q.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=C}const E=new URL((s=B?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in K&&K.signIn){const q=await K.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),M?{statement:M}:null));let k;if(Array.isArray(q)&&q[0]&&typeof q[0]=="object")k=q[0];else if(q&&typeof q=="object"&&"signedMessage"in q&&"signature"in q)k=q;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)w=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),A=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in K)||typeof K.signMessage!="function"||!("publicKey"in K)||typeof K!="object"||!K.publicKey||!("toBase58"in K.publicKey)||typeof K.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,K.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(u=(l=B?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=B?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((f=B?.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((g=B?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((p=B?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((m=B?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((_=(v=B?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||_===void 0)&&_.length?["Resources",...B.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const q=await K.signMessage(new TextEncoder().encode(w),"utf8");if(!q||!(q instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=q}}try{const{data:O,error:C}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:ti(A)},!((j=a.options)===null||j===void 0)&&j.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:jn});if(C)throw C;if(!O||!O.session||!O.user){const M=new qi;return this._returnResult({data:{user:null,session:null},error:M})}return O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),this._returnResult({data:Object.assign({},O),error:C})}catch(O){if(je(O))return this._returnResult({data:{user:null,session:null},error:O});throw O}}async _exchangeCodeForSession(a){const s=await Qa(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:f}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:jn});if(await Sa(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!d||!d.session||!d.user){const g=new qi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:f})}catch(d){if(je(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:f}=a,g=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:f,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:jn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new qi;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(je(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,f;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Li(this.storage,this.storageKey));const{error:_}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:_})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(f=p?.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new xl("You must provide either an email or phone number.")}catch(g){if(je(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:f,error:g}=await Ce(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:jn});if(g)throw g;if(!f)throw new Error("An error occurred on token verification.");const p=f.session,m=f.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(je(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,f;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Li(this.storage,this.storageKey));const m=await Ce(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:u0});return!((d=m.data)===null||d===void 0)&&d.url&&Rt()&&!(!((f=a.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(je(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new _n;const{error:u}=await Ce(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(je(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:f}=await Ce(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:f,error:g}=await Ce(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:g})}throw new xl("You must provide either an email or phone number and a type")}catch(s){if(je(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await Qa(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<tu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const f=await Qa(this.userStorage,this.storageKey+"-user");f?.user?a.user=f.user:a.user=iu()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};a.user=s0(a.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:wa}):await this._useSession(async s=>{var l,u,d;const{data:f,error:g}=s;if(g)throw g;return!(!((l=f.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _n}:await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:wa})})}catch(s){if(je(s))return qb(s)&&(await this._removeSession(),await Sa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new _n;const f=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await Li(this.storage,this.storageKey));const{data:m,error:v}=await Ce(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:f.access_token,xform:wa});if(v)throw v;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(l){if(je(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new _n;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:f}=au(a.access_token);if(f.exp&&(l=f.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(je(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:f,error:g}=s;if(g)throw g;a=(l=f.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new _n;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(je(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!Rt())throw new _l("No browser detected.");if(a.error||a.error_description||a.error_code)throw new _l(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new $g("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new _l("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new $g("No code detected.");const{data:M,error:B}=await this._exchangeCodeForSession(a.code);if(B)throw B;const K=new URL(window.location.href);return K.searchParams.delete("code"),window.history.replaceState(window.history.state,"",K.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:f,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!f||!m)throw new _l("No session defined in URL");const v=Math.round(Date.now()/1e3),_=parseInt(g);let j=v+_;p&&(j=parseInt(p));const b=j-v;b*1e3<=$i&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${_}s`);const w=j-_;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,j,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,j,v);const{data:A,error:O}=await this._getUser(d);if(O)throw O;const C={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:_,expires_at:j,refresh_token:f,token_type:m,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:C,redirectType:a.type},error:null})}catch(l){if(je(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await Qa(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const f=(l=u.session)===null||l===void 0?void 0:l.access_token;if(f){const{error:g}=await this.admin.signOut(f,a);if(g&&!(Mb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await Sa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Kb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:f}=s;if(f)throw f;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Li(this.storage,this.storageKey,!0));try{return await Ce(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(je(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(je(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var f,g,p,m,v;const{data:_,error:j}=d;if(j)throw j;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(f=a.options)===null||f===void 0?void 0:f.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Ce(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=_.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return Rt()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(je(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:f,provider:g,token:p,access_token:m,nonce:v}=a,_=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:jn}),{data:j,error:b}=_;return b?this._returnResult({data:{user:null,session:null},error:b}):!j||!j.session||!j.user?this._returnResult({data:{user:null,session:null},error:new qi}):(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("USER_UPDATED",j.session)),this._returnResult({data:j,error:b}))}catch(u){if(je(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)throw f;return await Ce(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(je(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Xb(async u=>(u>0&&await Qb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Ce(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:jn})),(u,d)=>{const f=200*Math.pow(2,u);return d&&nu(d)&&Date.now()+f-l<$i})}catch(l){if(this._debug(s,"error",l),je(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),Rt()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await Qa(this.storage,this.storageKey);if(u&&this.userStorage){let f=await Qa(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:u.user},await Gi(this.userStorage,this.storageKey+"-user",f)),u.user=(a=f?.user)!==null&&a!==void 0?a:iu()}else if(u&&!u.user&&!u.user){const f=await Qa(this.storage,this.storageKey+"-user");f&&f?.user?(u.user=f.user,await Sa(this.storage,this.storageKey+"-user"),await Gi(this.storage,this.storageKey,u)):u.user=iu()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<tu;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${tu}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:f}=await this._callRefreshToken(u.refresh_token);f&&(console.error(f),nu(f)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:g}=await this._getUser(u.access_token);!g&&f?.user?(u.user=f.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(l,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new _n;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Al;const{data:d,error:f}=await this._refreshAccessToken(a);if(f)throw f;if(!d.session)throw new _n;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),je(d)){const f={data:null,error:d};return nu(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(f),f}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],f=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(f),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await Gi(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=Jg(u);await Gi(this.storage,this.storageKey,d)}else{const u=Jg(s);await Gi(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await Sa(this.storage,this.storageKey),await Sa(this.storage,this.storageKey+"-code-verifier"),await Sa(this.storage,this.storageKey+"-user"),this.userStorage&&await Sa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&Rt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),$i);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/$i);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${$i}ms, refresh threshold is ${pu} ticks`),u<=pu&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof Fp)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Rt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,f]=await Li(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(f)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Ce(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(je(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)return this._returnResult({data:null,error:f});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Ce(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(je(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?C0(a.webauthn.credential_response):T0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Ce(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:f,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(je(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=await Ce(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(f.error)return f;const{data:g}=f;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:w0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:E0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(je(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=au(l.access_token);let f=null;d.aal&&(f=d.aal);let g=f;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Ce(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new _n})})}catch(s){if(je(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new _n});const f=await Ce(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Rt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(je(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new _n});const f=await Ce(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Rt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(je(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Db>u)return l;const{data:d,error:f}=await Ce(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:f,raw:{header:g,payload:p}}=au(l);s?.allowExpired||a0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:f},error:null}}const v=i0(u.alg),_=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,_,f,Gb(`${g}.${p}`)))throw new vu("Invalid JWT signature");return{data:{claims:d,header:u,signature:f},error:null}}catch(l){if(je(l))return this._returnResult({data:null,error:l});throw l}}}Kr.nextInstanceID={};const B0=Kr;class M0 extends B0{constructor(a){super(a)}}class q0{constructor(a,s,l){var u,d,f;this.supabaseUrl=a,this.supabaseKey=s;const g=Rb(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:jb,realtime:wb,auth:Object.assign(Object.assign({},Sb),{storageKey:p}),global:_b},v=Ob(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,j)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(j)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=v.auth)!==null&&f!==void 0?f:{},this.headers,v.global.fetch),this.fetch=Tb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(_=>this.realtime.setAuth(_)).catch(_=>console.warn("Failed to set initial Realtime auth token:",_)),this.rest=new Nv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new vb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Tv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:f,flowType:g,lock:p,debug:m,throwOnError:v},_,j){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),_),storageKey:f,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:j,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Jv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const L0=(o,a,s)=>new q0(o,a,s);function H0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}H0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const I0="https://sqwqlvsjtimallidxrsz.supabase.co",V0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",re=L0(I0,V0,{auth:{persistSession:!1}}),mn=Object.freeze(Object.defineProperty({__proto__:null,default:re,supabase:re},Symbol.toStringTag,{value:"Module"}));function $0({onLogin:o}){const[a,s]=S.useState(""),[l,u]=S.useState(""),[d,f]=S.useState(null);async function g(p){p.preventDefault(),f(null);try{const{data:m,error:v}=await re.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){f("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){f("Credenciales invlidas");return}const _=m;_.password===l?(localStorage.setItem("user",JSON.stringify({id:_.id,username:_.username,role:_.role})),f("Inicio de sesin correcto"),typeof o=="function"&&o()):f("Credenciales invlidas")}catch(m){f(m.message||"Error al consultar la base de datos")}}return r.jsx("div",{className:"login-root",children:r.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[r.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),r.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),r.jsxs("div",{className:"login-inner",children:[r.jsxs("form",{onSubmit:g,children:[r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"username",children:"Usuario"}),r.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"password",children:"Contrasea"}),r.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),r.jsx("div",{children:r.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&r.jsx("p",{style:{marginTop:12},children:d}),r.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",r.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function G0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),r.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function P0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!0),[d,f]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,j]=S.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=S.useState(()=>{try{const C=localStorage.getItem("user");if(C)return JSON.parse(C).username||"usuario"}catch{}return"usuario"});S.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(C=>C.json()).then(C=>{const M=C&&Array.isArray(C.ingresos)?C.ingresos:[],B=localStorage.getItem("ingresosEfectivo");let K=[];try{B&&(K=JSON.parse(B))}catch{}const E=[...M,...K];s(E)}).catch(()=>{const C=localStorage.getItem("ingresosEfectivo");try{C&&s(JSON.parse(C))}catch{s([])}}).finally(()=>u(!1))},[]);function A(C){localStorage.setItem("ingresosEfectivo",JSON.stringify(C))}function O(C){if(C.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const M=a.length?Math.max(...a.map(E=>E.id))+1:1,B={id:M,factura:d||`F-${M}`,motivo:g,monto:Number(m),fechaHora:new Date(_).toISOString(),usuario:b},K=[...a,B];s(K),A(K),f(""),p(""),v(""),j(new Date().toISOString().slice(0,16))}return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?r.jsx("p",{children:"Cargando..."}):r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),r.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),r.jsx("tbody",{children:a.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(C=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:{padding:8},children:C.factura}),r.jsx("td",{style:{padding:8},children:C.motivo}),r.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",C.monto.toFixed(2)]}),r.jsx("td",{style:{padding:8},children:new Date(C.fechaHora).toLocaleString()}),r.jsx("td",{style:{padding:8},children:C.usuario})]},C.id))})]})})]}),r.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),r.jsxs("form",{onSubmit:O,style:{display:"grid",gap:8},children:[r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",r.jsx("input",{value:d,onChange:C=>f(C.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",r.jsx("input",{value:g,onChange:C=>p(C.target.value),className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",r.jsx("input",{value:m,onChange:C=>v(C.target.value===""?"":Number(C.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",r.jsx("input",{value:_,onChange:C=>j(C.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",r.jsx("input",{value:b,onChange:C=>w(C.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[r.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),r.jsx("button",{type:"button",onClick:()=>{f(""),p(""),v(""),j(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function K0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!1),[d,f]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(!1),[_,j]=S.useState(!1),[b,w]=S.useState(null),A=async()=>{u(!0);try{const{data:J,error:F}=await re.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(F)throw F;const Z=Array.isArray(J)?J:[],D=Array.from(new Set(Z.map(U=>U.cliente_id).filter(Boolean)));let W={};if(D.length>0)try{const{data:U}=await re.from("clientes").select("id,nombre").in("id",D);if(Array.isArray(U))for(const L of U)W[String(L.id)]=L.nombre||""}catch(U){console.warn("Error cargando nombres de clientes:",U)}const pe=Z.map(U=>({...U,cliente_nombre:W[String(U.cliente_id)]||null}));s(pe)}catch(J){console.warn("Error cargando cotizaciones:",J),s([])}u(!1)};S.useEffect(()=>{A()},[]);const[O,C]=S.useState(null),[M,B]=S.useState(null),[K,E]=S.useState(""),q=async J=>{f(J);try{const{data:F,error:Z}=await re.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",J).maybeSingle();if(Z&&console.warn("Error cargando cabecera de cotizacion",Z),C(F||null),F&&F.cliente_id)try{const{data:pe}=await re.from("clientes").select("id,nombre").eq("id",F.cliente_id).maybeSingle();B(pe?.nombre||null)}catch{B(null)}else B(null);const{data:D,error:W}=await re.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J);if(W)throw W;p(Array.isArray(D)?D:[]),v(!0)}catch(F){console.warn("Error cargando detalles de cotizacion",F),p([])}},k=async J=>{try{const{data:F,error:Z}=await re.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J.id),D=Array.isArray(F)?F:[],W={header:J,detalles:D};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(W))}catch(pe){console.warn("No se pudo escribir localStorage",pe)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:W}))}catch{}o()}catch(F){console.warn("Error cargando detalles para editar",F)}},I=async J=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:F}=await re.from("cotizaciones_detalle").delete().eq("cotizacion_id",J);F&&console.warn("Error eliminando detalles:",F);const{error:Z}=await re.from("cotizaciones").delete().eq("id",J);if(Z)throw Z;A()}catch(F){console.warn("Error eliminando cotizacion:",F)}},ce=async()=>{if(b)try{const J={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:F}=await re.from("cotizaciones").update(J).eq("id",b.id);if(F&&console.warn("Error actualizando cotizacion:",F),b.id){const{error:Z}=await re.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);Z&&console.warn("Error borrando detalles antiguos:",Z);const D=g.map(pe=>({...pe,cotizacion_id:b.id})),{error:W}=await re.from("cotizaciones_detalle").insert(D);W&&console.warn("Error insertando detalles actualizados:",W)}j(!1),A()}catch(J){console.warn("Error guardando cotizacion editada:",J)}};return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),r.jsxs("div",{children:[r.jsx("button",{onClick:A,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),r.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),r.jsx("input",{placeholder:"Nmero o cliente",value:K,onChange:J=>E(J.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),r.jsx("button",{onClick:()=>E(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?r.jsx("div",{children:"Cargando..."}):a.length===0?r.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Nmero"}),r.jsx("th",{style:{padding:8},children:"Fecha"}),r.jsx("th",{style:{padding:8},children:"Usuario"}),r.jsx("th",{style:{padding:8},children:"Cliente ID"}),r.jsx("th",{style:{padding:8},children:"Total"}),r.jsx("th",{style:{padding:8},children:"Estado"}),r.jsx("th",{style:{padding:8},children:"Acciones"})]})}),r.jsx("tbody",{children:a.filter(J=>{if(!K)return!0;const F=K.toLowerCase(),Z=(J.numero_cotizacion||"").toLowerCase(),D=(J.cliente_nombre||"")?.toLowerCase(),W=(J.usuario||"").toLowerCase();return Z.includes(F)||D.includes(F)||W.includes(F)}).map(J=>r.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[r.jsx("td",{style:{padding:8},children:J.numero_cotizacion||""}),r.jsx("td",{style:{padding:8},children:J.fecha_cotizacion?new Date(J.fecha_cotizacion).toLocaleString():""}),r.jsx("td",{style:{padding:8},children:J.usuario||""}),r.jsx("td",{style:{padding:8},children:J.cliente_nombre||(J.cliente_id?String(J.cliente_id):"")}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||0).toFixed(2)]}),r.jsx("td",{style:{padding:8},children:J.estado||""}),r.jsxs("td",{style:{padding:8},children:[r.jsx("button",{onClick:()=>q(J.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(J.estado||"").toLowerCase()==="aceptada"?r.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):r.jsx("button",{onClick:()=>k(J),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),r.jsx("button",{onClick:()=>I(J.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},J.id))})]})]}),m&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),r.jsx("button",{onClick:()=>{v(!1),p([]),f(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[O&&r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Nmero:"})," ",O.numero_cotizacion]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Fecha:"})," ",O.fecha_cotizacion?new Date(O.fecha_cotizacion).toLocaleString():""]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Usuario:"})," ",O.usuario]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Cliente:"})," ",M??(O.cliente_id?String(O.cliente_id):"C/F")]})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Subtotal:"})," L ",Number(O.subtotal||0).toFixed(2)]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Impuesto:"})," L ",Number(O.impuesto||0).toFixed(2)]}),r.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[r.jsx("strong",{children:"Total:"})," L ",Number(O.total||0).toFixed(2)]})]})]}),r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Descripcin"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio U."}),r.jsx("th",{style:{padding:8},children:"Subtotal"}),r.jsx("th",{style:{padding:8},children:"Descuento"}),r.jsx("th",{style:{padding:8},children:"Total"})]})}),r.jsx("tbody",{children:g.map((J,F)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:J.descripcion}),r.jsx("td",{style:{padding:8},children:J.cantidad}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.precio_unitario||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.subtotal||(J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.descuento||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||(J.subtotal||0)-(J.descuento||0)).toFixed(2)]})]},F))})]})]})]})}),_&&b&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),r.jsx("button",{onClick:()=>{j(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Cliente"}),r.jsx("input",{value:b.cliente||"",onChange:J=>w({...b,cliente:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"RTN"}),r.jsx("input",{value:b.rtn||"",onChange:J=>w({...b,rtn:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"SKU"}),r.jsx("th",{style:{padding:8},children:"Nombre"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio"}),r.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),r.jsx("tbody",{children:g.map((J,F)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:J.sku}),r.jsx("td",{style:{padding:8},children:J.nombre}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:J.cantidad||0,onChange:Z=>{const D=Number(Z.target.value||0),W=[...g];W[F]={...W[F],cantidad:D},p(W)},style:{width:80,padding:6}})}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:J.precio_unitario||0,onChange:Z=>{const D=Number(Z.target.value||0),W=[...g];W[F]={...W[F],precio_unitario:D},p(W)},style:{width:120,padding:6}})}),r.jsxs("td",{style:{padding:8},children:["L ",Number((J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]})]},F))})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:()=>{j(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:ce,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function Y0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),r.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function J0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function Q0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function X0({open:o,onClose:a,onSelect:s}){const[l,u]=S.useState(""),[d,f]=S.useState(!1),[g,p]=S.useState([]);return S.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{f(!0);try{const{data:v,error:_}=await re.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(_)throw _;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&f(!1)}})(),()=>{m=!1}},[o]),S.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{f(!0);try{const v=String(l||"").trim();let _;if(v===""?_=await re.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):_=await re.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),_.error)throw _.error;p(Array.isArray(_.data)?_.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{f(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:r.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),r.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),r.jsx("th",{style:{padding:8}})]})}),r.jsxs("tbody",{children:[g.map(m=>r.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[r.jsx("td",{style:{padding:8},children:m.rtn}),r.jsx("td",{style:{padding:8},children:m.nombre}),r.jsx("td",{style:{padding:8},children:m.telefono}),r.jsx("td",{style:{padding:8},children:m.correo_electronico}),r.jsx("td",{style:{padding:8},children:r.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function F0({open:o,onClose:a,totalDue:s,onConfirm:l}){const[u,d]=S.useState(0),[f,g]=S.useState(0),[p,m]=S.useState(0);S.useEffect(()=>{o||(d(0),g(0),m(0))},[o]);const v=Number((Number(u)+Number(f)+Number(p)).toFixed(2)),_=Number((s-v).toFixed(2)),j=v>=s&&v>0,b=()=>{const w=[];u>0&&w.push(`efectivo:(${u.toFixed(2)})`),f>0&&w.push(`tarjeta:(${f.toFixed(2)})`),p>0&&w.push(`transferencia:(${p.toFixed(2)})`);const A=w.join(",");l({efectivo:u,tarjeta:f,transferencia:p,totalPaid:v,tipoPagoString:A}),a()};return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",r.jsxs("strong",{children:["L ",s.toFixed(2)]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Efectivo"}),r.jsx("input",{type:"number",value:u,onChange:w=>d(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Tarjeta"}),r.jsx("input",{type:"number",value:f,onChange:w=>g(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Transferencia"}),r.jsx("input",{type:"number",value:p,onChange:w=>m(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:r.jsxs("div",{children:[r.jsx("label",{children:"Total ingresado"}),r.jsxs("div",{style:{padding:8,borderRadius:6,border:"1px solid #e6edf3"},children:["L ",v.toFixed(2)]})]})})]}),r.jsx("div",{style:{marginTop:12},children:_>0?r.jsxs("div",{style:{color:"#ef4444"},children:["Falta: L ",_.toFixed(2)]}):r.jsxs("div",{style:{color:"#16a34a"},children:["Pago completo. Cambio/Exceso: L ",Math.abs(_).toFixed(2)]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:b,className:"btn-opaque",disabled:!j,style:{background:j?"#16a34a":"gray",color:"white"},children:"Confirmar pago"})]})]})]})}):null}function Z0({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:f}){return r.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:u}),r.jsx("th",{style:u,children:"Imagen"}),r.jsx("th",{style:u,children:"SKU"}),r.jsx("th",{style:u,children:"Nombre"}),r.jsx("th",{style:u,children:"Categora"}),r.jsx("th",{style:u,children:"Precio"}),r.jsx("th",{style:u,children:"Stock"}),r.jsx("th",{style:u,children:"Accin"})]})}),r.jsx("tbody",{children:o.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:d,children:r.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),r.jsx("td",{style:d,children:a[String(g.id)]?r.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?r.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),r.jsx("td",{style:d,children:r.jsx("code",{style:f,children:g.sku})}),r.jsx("td",{style:d,children:r.jsx("strong",{children:g.nombre})}),r.jsx("td",{style:d,children:r.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),r.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return r.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,_=v?p<1?"Agotado":"Sin precio":"Agregar";return r.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:_})})()})]},g.id))})]})})}function W0({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:f,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:_}){return r.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&r.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&r.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[r.jsx("span",{children:"Subtotal:"}),r.jsxs("span",{children:["L",u.toFixed(2)]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",color:"#16a34a",fontWeight:500},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsxs("div",{children:["ISV (",(f*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.isv||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto 18%: ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.imp18||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto turstico (",(p*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.tur||0),0)).toFixed(2)]})]})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[r.jsx("span",{children:"TOTAL:"}),r.jsxs("span",{children:["L",m.toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:[r.jsxs("div",{children:["Tax rates: ISV ",(f*100).toFixed(2),"%, 18% ",(g*100).toFixed(2),"%, Tur ",(p*100).toFixed(2),"%"]}),r.jsxs("details",{style:{marginTop:6},children:[r.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),r.jsx("div",{style:{marginTop:8},children:d.map(j=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[r.jsxs("div",{style:{color:"#0f172a"},children:[j.nombre,"  L",j.price.toFixed(2)]}),r.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",j.isv.toFixed(2),"  18%: L",j.imp18.toFixed(2),"  Tur: L",j.tur.toFixed(2)]})]},String(j.id)))})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[r.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),r.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?r.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):r.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(j=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",j.producto.sku,"] ",j.producto.nombre]}),r.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(j.producto.precio||0).toFixed(2)," c/u"]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("button",{onClick:()=>a(j.producto.id,-1),style:_,children:""}),r.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:j.cantidad}),r.jsx("button",{onClick:()=>a(j.producto.id,1),style:_,children:"+"}),r.jsx("button",{onClick:()=>s(j.producto.id),style:{..._,background:"#ef4444"},children:""})]})]},j.producto.id))})]})}function ex({userName:o,userRole:a,onLogout:s,onNavigate:l}){const[u,d]=S.useState(!1),f=S.useRef(null);return S.useEffect(()=>{function g(p){f.current&&!f.current.contains(p.target)&&d(!1)}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]),r.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[r.jsx("h1",{style:{margin:0,fontSize:"1.4rem",fontWeight:600},children:"Solutecc  -  Caja"}),r.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[r.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),r.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""})]}),r.jsxs("div",{style:{position:"relative"},ref:f,children:[r.jsx("button",{onClick:()=>d(g=>!g),"aria-expanded":u,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),u&&r.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[r.jsx("button",{onClick:()=>{d(!1),s()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),r.jsx("button",{onClick:()=>{d(!1),l("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),r.jsx("button",{onClick:()=>{d(!1),l("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),r.jsx("button",{onClick:()=>{d(!1),l("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),r.jsx("button",{onClick:()=>{d(!1),l("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),r.jsx("button",{onClick:()=>{d(!1),l("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),r.jsx("button",{onClick:()=>{d(!1),l("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function tx({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),r.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?r.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):r.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),r.jsxs("div",{style:{flex:1},children:[r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"SKU:"})," ",a.sku]}),r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),r.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),r.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:r.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):r.jsx("div",{children:r.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function nx({open:o,onClose:a,onCancel:s,onSave:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),r.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function ax({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:f,taxRate:g,taxableSubtotal:p}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:"Elige si la factura ser para Cliente Final o para un Cliente registrado. Cliente Final genera una factura inmediata lista para imprimir. Cliente Normal permite ingresar datos del cliente."}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[r.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Factura para consumidor final. No requiere RTN."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar nombre y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar razn social y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]})]})]}),r.jsxs("div",{style:{width:220,borderLeft:"1px dashed #e6edf3",paddingLeft:16,display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontWeight:700},children:"Resumen"}),r.jsxs("div",{style:{color:"#475569"},children:["Items: ",r.jsx("strong",{children:d})]}),r.jsxs("div",{style:{color:"#475569"},children:["SubTotal: ",r.jsxs("strong",{children:["L ",f.toFixed(2)]})]}),r.jsxs("div",{style:{color:"#475569"},children:["ISV (",(g*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L ",(p*g).toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:18,fontWeight:800},children:["Total: L ",(f+p*g).toFixed(2)]}),r.jsx("div",{style:{marginTop:12,fontSize:12,color:"#94a3b8"},children:"Seleccione una opcin para continuar."})]})]})}):null}function ix({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:f,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:_,onTelefonoChange:j,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:A,onCancel:O,onOpenCreateCliente:C,onOpenPayment:M,paymentDone:B,submitClienteNormal:K}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{value:l,onChange:E=>v(E.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&r.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),r.jsx("input",{value:u,onChange:E=>_(E.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx(X0,{open:p,onClose:()=>m(!1),onSelect:E=>{}}),r.jsx("button",{onClick:O,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:C,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),B?r.jsx("button",{onClick:K,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):r.jsx("button",{onClick:M,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function rx({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:f,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:_,onCreate:j}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",r.jsx("strong",{children:"juridico"}),"."]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),r.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),r.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),r.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),r.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{id:"exon",type:"checkbox",checked:f,onChange:b=>_(b.target.checked)}),r.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:async()=>{await j()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})}):null}function tp(o={},a="factura",s={}){const l=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),u=o.rtn||"C/F",d=o.factura||String(Math.floor(Math.random()*9e5)+1e5),f=new Date().toLocaleString(),g=Array.isArray(s.carrito)?s.carrito:[],p=typeof s.subtotal=="number"?s.subtotal:g.reduce((M,B)=>M+Number(B.producto&&B.producto.precio||B.precio||0)*(B.cantidad||1),0),m=typeof s.isvTotal=="number"?s.isvTotal:0,v=typeof s.imp18Total=="number"?s.imp18Total:0,_=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,j=p+m+v+_,w=g.map(M=>{const B=String(M.producto&&(M.producto.nombre||M.producto.descripcion)||M.descripcion||M.nombre||""),K=Number(M.cantidad||0),E=Number((M.producto&&(M.producto.precio??M.producto.precio_unitario))??M.precio_unitario??M.precio??0),q=E.toFixed(2),k=(K*E).toFixed(2);return`<tr><td>${M.producto&&M.producto.sku||M.sku||""} ${B}</td><td style="text-align:center">${K}</td><td style="text-align:right">L ${q}</td><td style="text-align:right">L ${k}</td></tr>`}).join(`
`),A=a==="factura"?"FACTURA":"COTIZACIN",O=a==="factura"?"":'<div style="margin-top:12px;text-align:center;color:#475569">Vlida por 24 horas desde la fecha de emisin.</div>';return`<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>${A}</title><style>
    body{font-family:Arial,Helvetica,sans-serif;font-size:12px;color:#000;margin:20px}
    .factura{max-width:800px;margin:0 auto}
    .header{display:flex;justify-content:space-between;align-items:center}
    .header img{width:180px;height:auto}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border:1px solid #000;padding:6px;text-align:left}
    th{background:#eee}
    .right{text-align:right}
    </style></head><body><div class="factura"><div class="header"><div>
    <h2>Solutecc - Punto de Ventas</h2>
    <div>RTN: 00000000000000</div>
    </div><div><h3>${A}</h3><div>No: ${d}</div><div>Fecha: ${f}</div></div></div>
    <hr/>
    <div><strong>Cliente:</strong> ${l}</div>
    <div><strong>RTN:</strong> ${u}</div>
    <table><thead><tr><th>Descripcin</th><th>Cant</th><th>Precio</th><th>Total</th></tr></thead><tbody>
    ${w}
    </tbody></table>
    <div style="margin-top:8px;text-align:right"><div>SubTotal: L ${p.toFixed(2)}</div><div>ISV: L ${m.toFixed(2)}</div><div>Impuesto 18%: L ${v.toFixed(2)}</div><div>Impuesto turstico: L ${_.toFixed(2)}</div><h3>Total: L ${j.toFixed(2)}</h3></div>
    ${O}
    <div style="margin-top:20px;text-align:center"><small>Gracias por su preferencia</small></div>
    </div></body></html>`}function sx({onLogout:o}){S.useEffect(()=>{const $=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=$||""}},[]);const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,f]=S.useState(""),[g,p]=S.useState("Todas"),[m,v]=S.useState(.15),[_,j]=S.useState(0),[b,w]=S.useState(0),A=["Todas",...Array.from(new Set(a.map($=>$.categoria)))],O=a.filter($=>(String($.nombre||"").toLowerCase().includes(d.toLowerCase())||String($.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||$.categoria===g)),C=l.reduce(($,ue)=>$+Number(ue.producto.precio||0)*ue.cantidad,0);let M=0,B=0,K=0;for(const $ of l){const ue=Number($.producto.precio||0)*$.cantidad,we=!!$.producto.exento,he=!!$.producto.aplica_impuesto_18,ye=!!$.producto.aplica_impuesto_turistico;if(!we){if(he){const me=ue*(_||0);B+=me}else{const me=ue*(m||0);M+=me}ye&&(K+=ue*(b||0))}}const E=C+M+B+K,q=l.map($=>{const ue=Number($.producto.precio||0)*$.cantidad,we=!!$.producto.exento,he=!!$.producto.aplica_impuesto_18,ye=!!$.producto.aplica_impuesto_turistico;if(we)return{id:$.producto.id,nombre:$.producto.nombre,price:ue,isv:0,imp18:0,tur:0,totalTax:0};const me=he?0:ue*(m||0),Te=he?ue*(_||0):0,$e=ye?ue*(b||0):0;return{id:$.producto.id,nombre:$.producto.nombre,price:ue,isv:me,imp18:Te,tur:$e,totalTax:me+Te+$e}}),k=$=>{const ue=Number($.stock??0),we=Number($.precio??0);ue<1||we<=0||u(he=>he.find(me=>me.producto.id===$.id)?he.map(me=>me.producto.id===$.id?{...me,cantidad:me.cantidad+1}:me):[...he,{producto:$,cantidad:1}])},I=($,ue)=>{u(we=>we.map(he=>{if(String(he.producto.id)===String($)){const ye=he.cantidad+ue;return ye>0?{...he,cantidad:ye}:he}return he}).filter(he=>he.cantidad>0))},ce=$=>{u(ue=>ue.filter(we=>String(we.producto.id)!==String($)))},J=()=>u([]),[F,Z]=S.useState(!1),[D,W]=S.useState("factura"),[pe,U]=S.useState(!1),[L,ee]=S.useState(null),[le,fe]=S.useState(null),[T,z]=S.useState(!1),[P,Q]=S.useState(!1),[se,ae]=S.useState(""),[de,oe]=S.useState(""),ge=S.useRef(null),Re=S.useRef(null),[qe,Ne]=S.useState("final"),[ke,Je]=S.useState(""),[ut,Nt]=S.useState(""),[jt,Lt]=S.useState(!1),[Nn,at]=S.useState(!1),[ot,wn]=S.useState(!1),[Ol,Dt]=S.useState(!1),[Ru,Jr]=S.useState(null),[Qr,Ca]=S.useState(!1),Rl=async $=>{if(oe($),!$||String($).trim()===""){ae("");return}try{if(qe==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",$);const{data:ye,error:me}=await re.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",$).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:ye,error:me}),!me&&ye&&ye.nombre){ae(ye.nombre||""),Je(ye.telefono||""),Nt(ye.correo_electronico||""),Lt(!!ye.exonerado),setTimeout(()=>{try{Re.current?.focus()}catch{}},50);return}else{ae(""),Je(""),Nt(""),Lt(!1);return}}const ue="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",$);const{data:we,error:he}=await re.from(ue).select("nombre").eq("rtn",$).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:we,error:he}),!he&&we&&we.nombre?(ae(we.nombre||""),setTimeout(()=>{try{Re.current?.focus()}catch{}},50)):ae("")}catch(ue){console.warn("Error buscando cliente por RTN:",ue)}},Xr=$=>{if($==="cotizacion"){W("cotizacion"),Z(!0);return}W($),Z(!0)},Nl=async($={})=>{try{if(!l||l.length===0)return null;const ue=ni(),we=M,he=B,ye=K,me=Number(we||0)+Number(he||0)+Number(ye||0),Te=ue+me;let $e=$.cliente_id??null;if(!$e&&$.rtn)try{const{data:Pe,error:it}=await re.from("clientes").select("id").eq("rtn",$.rtn).maybeSingle();!it&&Pe&&Pe.id&&($e=Pe.id)}catch{}const be=Oa||"system",De=String(Math.floor(Math.random()*9e5)+1e5),Ge={cliente_id:$e,usuario:be,numero_cotizacion:De,validez_dias:30,subtotal:ue,impuesto:me,total:Te,estado:"pendiente"};let Ae=$.cotizacion_id??le;if(Ae){const Pe={cliente_id:Ge.cliente_id||null,usuario:Ge.usuario,validez_dias:Ge.validez_dias,subtotal:Ge.subtotal,impuesto:Ge.impuesto,total:Ge.total,estado:Ge.estado},{error:it}=await re.from("cotizaciones").update(Pe).eq("id",Ae);if(it)return console.warn("Error actualizando cotizacion:",it),null}else{const{data:Pe,error:it}=await re.from("cotizaciones").insert([Ge]).select("id").maybeSingle();if(it)return console.warn("Error insertando cotizacion:",it),null;if(Ae=Pe?.id||null,!Ae)return null}const Le=l.map(Pe=>{const it=Number(Pe.producto.precio||0),kt=Number(Pe.cantidad||0),rt=!!Pe.producto.exento,Wn=!!Pe.producto.aplica_impuesto_18,Na=!!Pe.producto.aplica_impuesto_turistico,an=rt||Wn?0:it*(m||0)*kt,Cn=rt?0:Wn?it*(_||0)*kt:0,Bl=rt?0:Na?it*(b||0)*kt:0,Fi=it*kt,es=Fi+an+Cn+Bl;return{cotizacion_id:Ae,producto_id:Pe.producto.id||null,descripcion:Pe.producto.nombre||"",cantidad:kt,precio_unitario:it,subtotal:Fi,descuento:0,total:es}});try{await re.from("cotizaciones_detalle").delete().eq("cotizacion_id",Ae)}catch{}const{error:mt}=await re.from("cotizaciones_detalle").insert(Le);return mt?console.warn("Error insertando cotizaciones_detalle:",mt):console.debug("Cotizacion guardada id=",Ae),Ae}catch(ue){return console.warn("Error guardando cotizacion:",ue),null}},ni=()=>l.reduce(($,ue)=>$+Number(ue.producto.precio||0)*ue.cantidad,0),Ta=()=>l.reduce(($,ue)=>$+(ue.producto.exento?0:Number(ue.producto.precio||0)*ue.cantidad),0),Bt=async()=>{Ne("final"),ae("Consumidor Final"),oe("C/F"),Z(!1),Ca(!0),wn(!0)},En=()=>{Ne("normal"),ae(""),oe(""),z(!0),Z(!1)},Mt=()=>{Ne("juridico"),ae(""),oe(""),z(!0),Z(!1)},kl=async($,ue,we)=>{const he=tp({cliente:$,rtn:ue},D,{carrito:l,subtotal:ni(),isvTotal:M,imp18Total:B,impTouristTotal:K});if(D==="factura"&&le)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",le);const{error:me}=await re.from("cotizaciones").update({estado:"aceptada"}).eq("id",le);if(me)console.warn("Error marcando cotizacion (pre-print):",me);else try{fe(null)}catch{}}catch(me){console.warn("Error marcacion pre-print:",me)}if(D==="factura")try{let me=null;try{if(ue){const{data:Ae,error:Le}=await re.from("clientes").select("id").eq("rtn",ue).maybeSingle();Le&&console.debug("Error buscando cliente por RTN (no fatal):",Le),Ae&&Ae.id&&(me=Ae.id)}}catch(Ae){console.debug("ignore",Ae)}const Te=we&&we.tipoPagoString?String(we.tipoPagoString):"",$e=String(Math.floor(Math.random()*9e5)+1e5),be={cliente_id:me,usuario:Oa||"system",factura:$e,tipo_pago:Te,subtotal:Number(C||0),impuesto:Number(M+B+K||0),total:Number(E||0),estado:"pagada"},{data:De,error:Ge}=await re.from("ventas").insert([be]).select("id, factura");if(console.debug("Insert venta response:",{ventaInsRaw:De,ventaErr:Ge}),Ge)console.warn("Error insertando venta:",Ge),alert("Error guardando venta: "+(Ge.message||JSON.stringify(Ge)));else{const Ae=Array.isArray(De)?De[0]:De;let Le=Ae?Ae.id||Ae.id:null;if(!Le)try{const{data:mt,error:Pe}=await re.from("ventas").select("id").eq("factura",$e).maybeSingle();Pe&&console.debug("Error buscando venta por factura (fallback):",Pe),mt&&mt.id&&(Le=mt.id)}catch(mt){console.debug("fallback lookup error",mt)}if(!Le)console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",De),alert("Advertencia: venta creada pero no se pudo recuperar su id. Revisa la tabla ventas.");else{const mt=l.map(kt=>{const rt=Number(kt.producto.precio||0),Wn=Number(kt.cantidad||0),Na=rt*Wn,an=0,Cn=Na-an;return{factura:Le,producto_id:kt.producto.id,cantidad:Wn,precio_unitario:rt,subtotal:Na,descuento:an,total:Cn}}),{data:Pe,error:it}=await re.from("ventas_detalle").insert(mt).select("id");console.debug("Insert ventas_detalle response:",{detalleIns:Pe,detErr:it}),it&&(console.warn("Error insertando ventas_detalle:",it),alert("Error guardando detalle de venta: "+(it.message||JSON.stringify(it))))}}}catch(me){console.warn("Error preparando venta antes de imprimir:",me),alert("Error preparando venta antes de imprimir: "+String(me))}const ye=window.open("","_blank");if(ye){ye.document.open(),ye.document.write(he),ye.document.close();try{ye.focus(),ye.print()}catch(me){console.warn("Error during print (finalize):",me)}setTimeout(()=>{try{ye.close()}catch{}},800)}D==="factura"&&(J(),await Fr()),D==="cotizacion"&&(ee({cliente:$,rtn:ue}),U(!0))},Fr=async()=>{if(D==="factura"&&le)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",le);const{error:$}=await re.from("cotizaciones").update({estado:"aceptada"}).eq("id",le);$?console.warn("Error marcando cotizacion como facturado:",$):console.debug("Cotizacion marcada como facturado:",le)}catch($){console.warn("Error procesando cotizacion tras facturar",$)}};S.useEffect(()=>{T&&setTimeout(()=>{try{ge.current?.focus()}catch{}},80)},[T]);const zl=async()=>{try{if(de&&se){const he={rtn:de,nombre:se},{error:ye}=await re.from("clientenatural").upsert(he,{onConflict:"rtn"});ye&&console.warn("Error guardando clientenatural:",ye)}}catch(he){console.warn("Error upsert clientenatural:",he)}try{if(de&&se)if(qe==="juridico"){const{data:he,error:ye}=await re.from("clientes").select("id").eq("rtn",de).eq("tipo_cliente","juridico").maybeSingle();if(ye&&console.warn("Error buscando cliente juridico:",ye),he&&he.id){const{error:me}=await re.from("clientes").update({nombre:se,telefono:ke||null,correo_electronico:ut||null,exonerado:jt}).eq("id",he.id);me&&console.warn("Error actualizando cliente juridico:",me)}else{const{error:me}=await re.from("clientes").insert([{nombre:se,rtn:de,telefono:ke||null,correo_electronico:ut||null,tipo_cliente:"juridico",exonerado:jt}]);me&&console.warn("Error insertando cliente juridico:",me)}}else{const he={rtn:de,nombre:se},{error:ye}=await re.from("clientenatural").upsert(he,{onConflict:"rtn"});ye&&console.warn("Error guardando clientenatural:",ye)}}catch(he){console.warn("Error upsert cliente:",he)}const $=tp({cliente:se||"Cliente",rtn:de||""},D,{carrito:l,subtotal:ni(),isvTotal:M,imp18Total:B,impTouristTotal:K});if(D==="factura"&&le)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",le);const{error:he}=await re.from("cotizaciones").update({estado:"aceptada"}).eq("id",le);if(he)console.warn("Error marcando cotizacion como facturado (pre-print):",he);else{console.debug("Cotizacion marcada como facturado (pre-print):",le);try{fe(null)}catch{}}}catch(he){console.warn("Error marcacion pre-print:",he)}const ue=window.open("","_blank");if(ue){ue.document.open(),ue.document.write($),ue.document.close();try{ue.focus(),ue.print()}catch(he){console.warn("Error during print (cliente normal):",he)}setTimeout(()=>{try{ue.close()}catch{}},800)}await(async()=>{D==="factura"&&(J(),await Fr()),D==="cotizacion"&&(ee({cliente:se||"Cliente",rtn:de||null}),U(!0))})(),z(!1)},[tn,nn]=S.useState(null),[Aa,kn]=S.useState([]),[ai,zn]=S.useState(!1),[Ul,ii]=S.useState(null);S.useEffect(()=>{fetch("/data-base/inventario.json").then(async $=>{if(!$.ok)return console.warn("inventario.json no disponible, status",$.status),null;const ue=$.headers.get("content-type")||"";if(!ue.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",ue),null;try{return await $.json()}catch(we){return console.warn("Error parseando inventario.json:",we),null}}).then($=>{$&&Array.isArray($.items)&&kn($.items),console.log("inventario cargado:",$&&$.items?$.items.length:0)}).catch($=>{console.warn("Error cargando inventario:",$)})},[]),S.useEffect(()=>{let $=!0;return(async()=>{try{const{data:ue,error:we}=await re.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(we)throw we;const he=Array.isArray(ue)?ue:[],ye=he.map(be=>String(be.id));if(ye.length===0){$&&s([]);return}const me={};try{const{data:be,error:De}=await re.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(De)throw De;if(console.debug("PV: precios total rows",Array.isArray(be)?be.length:0),Array.isArray(be))for(const Ge of be){const Ae=String(Ge.producto_id);me[Ae]||(me[Ae]=Number(Ge.precio||0))}}catch(be){console.warn("Error cargando precios en PV:",be)}let Te={};try{const{data:be,error:De}=await re.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",ye);if(De)throw De;const Ge=Array.isArray(be)?be:[];Te={},ye.forEach(Ae=>Te[Ae]=0);for(const Ae of Ge){const Le=String(Ae.producto_id),mt=Number(Ae.cantidad)||0,Pe=String(Ae.tipo_de_movimiento||"").toUpperCase();Pe==="ENTRADA"?Te[Le]=(Te[Le]||0)+mt:Pe==="SALIDA"&&(Te[Le]=(Te[Le]||0)-mt)}}catch(be){console.warn("Error cargando registro_de_inventario en PV:",be),Te={},ye.forEach(De=>Te[De]=0)}console.debug("PV: priceMap sample",Object.keys(me).slice(0,5).map(be=>[be,me[be]]));const $e=he.map(be=>({id:String(be.id),sku:be.sku,nombre:be.nombre,categoria:be.categoria,imagen:be.imagen,precio:me[String(be.id)]!==void 0?me[String(be.id)]:be.precio!==void 0?Number(be.precio):0,exento:be.exento===!0||String(be.exento)==="true"||Number(be.exento)===1||!1,aplica_impuesto_18:be.aplica_impuesto_18===!0||String(be.aplica_impuesto_18)==="true"||Number(be.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:be.aplica_impuesto_turistico===!0||String(be.aplica_impuesto_turistico)==="true"||Number(be.aplica_impuesto_turistico)===1||!1,stock:Number((Te[String(be.id)]||0).toFixed(2))}));$&&s($e)}catch(ue){console.warn("Error cargando productos desde inventario:",ue),$&&s([])}})(),()=>{$=!1}},[]),S.useEffect(()=>{const $=we=>{try{const he=we||(()=>{const Te=localStorage.getItem("cotizacion_to_load");return Te?JSON.parse(Te):null})();if(!he)return;try{fe(he.header&&he.header.id?String(he.header.id):null)}catch{}const me=(Array.isArray(he.detalles)?he.detalles:[]).map(Te=>{const $e=a.find(De=>String(De.id)===String(Te.producto_id));return{producto:$e?{...$e}:{id:String(Te.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:Te.sku??void 0,nombre:Te.descripcion||Te.nombre||"Artculo",precio:Number(Te.precio_unitario||Te.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(Te.cantidad||1)}});me.length>0&&u(me);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};$();const ue=we=>{try{$(we.detail)}catch{}};return window.addEventListener("cotizacion:load",ue),()=>{window.removeEventListener("cotizacion:load",ue)}},[a]);const[Oa,Ra]=S.useState(null),[Dl,Zr]=S.useState(null),[Qi,Wr]=S.useState({});S.useEffect(()=>{try{const $=localStorage.getItem("user");if($){const ue=JSON.parse($);Ra(ue.username||ue.name||null),Zr(ue.role||null)}}catch{}},[]),S.useEffect(()=>{let $=!0;return(async()=>{try{const{data:ue,error:we}=await re.from("impuesto").select("id, impuesto_venta");if(we)throw we;if(!ue||!Array.isArray(ue))return;const he=$e=>{const be=ue.find(Ae=>Number(Ae.id)===$e);if(!be)return null;const De=be.impuesto_venta;if(De==null)return null;const Ge=Number(De);return Number.isNaN(Ge)?null:Ge>1?Ge/100:Ge},ye=he(1),me=he(2),Te=he(3);if($){let $e=ye,be=me,De=Te;try{if(($e===null||$e===0)&&$){const Ae=(await re.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Le=Ae==null?null:Number(Ae);Le!=null&&!Number.isNaN(Le)&&($e=Le>1?Le/100:Le)}if((be===null||be===0)&&$){const Ae=(await re.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Le=Ae==null?null:Number(Ae);Le!=null&&!Number.isNaN(Le)&&(be=Le>1?Le/100:Le)}if((De===null||De===0)&&$){const Ae=(await re.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Le=Ae==null?null:Number(Ae);Le!=null&&!Number.isNaN(Le)&&(De=Le>1?Le/100:Le)}}catch(Ge){console.warn("PV: fallback single-id impuesto fetch failed",Ge)}($e===null||$e===0)&&($e=.15),(be===null||be===0)&&(be=.18),(De===null||De===0)&&(De=.04),v($e),j(be),w(De),console.debug("PV: impuestos raw rows",ue),console.debug("PV: resolved tax rates",{taxRate:$e,tax18Rate:be,taxTouristRate:De})}}catch(ue){console.warn("Error cargando impuesto en PV:",ue)}})(),()=>{$=!1}},[]);const Xi=$=>{console.log("openUbicacion",$,"entradasCount",Aa.length);let ue=null;try{ue=a.find(he=>String(he.sku||"")===String($)||String(he.id)===String($))||null}catch{ue=null}if(ue){const he=Number(ue.stock??0),ye={id:ue.id,producto:ue.nombre||"",sku:ue.sku||"",imagen:ue.imagen||null,descripcion:ue.descripcion||"",ubicacion:ue.ubicacion||null,cantidad:he};ii(ye),zn(!0);return}const we=Aa.find(he=>he.sku===$)||null;console.log("entrada encontrada",we),ii(we),zn(!0)};if(S.useEffect(()=>{let $=!0;return(async()=>{try{const ue="inventario",we={};await Promise.all((a||[]).map(async he=>{const ye=he.imagen;if(!ye){we[String(he.id)]=null;return}const me=String(ye);if(me.startsWith("http")){we[String(he.id)]=me;return}let Te=me;const $e=String(me).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);$e&&(Te=decodeURIComponent($e[2]));try{const be=await re.storage.from(ue).getPublicUrl(Te),De=be?.data?.publicUrl||be?.data?.publicURL||null;if(De){we[String(he.id)]=De;return}}catch{}try{const De=(await re.storage.from(ue).createSignedUrl(Te,604800))?.data?.signedUrl??null;we[String(he.id)]=De}catch{we[String(he.id)]=null}})),$&&Wr(we)}catch(ue){console.warn("Error resolviendo imgenes en PV",ue)}})(),()=>{$=!1}},[a]),tn){if(tn==="DevolucionCaja")return r.jsx(G0,{onBack:()=>nn(null)});if(tn==="IngresoEfectivo")return r.jsx(P0,{onBack:()=>nn(null)});if(tn==="CotizacionesGuardadas")return r.jsx(K0,{onBack:()=>nn(null)});if(tn==="PedidosEnLinea")return r.jsx(Y0,{onBack:()=>nn(null)});if(tn==="CorteCajaParcial")return r.jsx(J0,{onBack:()=>nn(null)});if(tn==="CorteCajaTotal")return r.jsx(Q0,{onBack:()=>nn(null)})}return r.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[r.jsx(ex,{userName:Oa,userRole:Dl,onLogout:o,onNavigate:$=>nn($)}),r.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[r.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:$=>f($.target.value),onKeyDown:$=>{if($.key==="Enter"){const ue=String(d||"").trim().toLowerCase();if(!ue)return;const he=O.find(ye=>String(ye.sku||"").toLowerCase()===ue)||O[0];if(he){const ye=Number(he.stock??0),me=Number(he.precio??0);ye>=1&&me>0?k(he):console.debug("No se puede agregar por stock/precio",{id:he.id,stockNum:ye,precioNum:me})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),r.jsx("select",{value:g,onChange:$=>p($.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:A.map($=>r.jsx("option",{value:$,children:$},$))})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:r.jsx(Z0,{productos:O,imageUrls:Qi,agregarAlCarrito:k,openUbicacion:Xi,thStyle:lx,tdStyle:ox,skuStyle:cx})}),r.jsx(W0,{carrito:l,actualizarCantidad:I,eliminarDelCarrito:ce,vaciarCarrito:J,subtotal:C,perItemTaxes:q,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,openSelector:Xr,btnStyle:ux})]})]}),r.jsx(tx,{open:ai,selectedEntrada:Ul,onClose:()=>{zn(!1),ii(null)},imageUrls:Qi}),r.jsx(F0,{open:ot,totalDue:E,onClose:()=>wn(!1),onConfirm:async $=>{if(Jr($),Dt(!0),Qr)try{Ca(!1),await kl("Consumidor Final","C/F",$)}catch(ue){console.warn("Error facturando despus del pago:",ue)}wn(!1)}}),r.jsx(nx,{open:pe,onClose:()=>U(!1),onCancel:()=>{U(!1),ee(null)},onSave:async()=>{U(!1);try{const $=await Nl(L||{});$&&fe(String($))}catch($){console.warn("Error guardando cotizacion desde confirm modal",$)}ee(null)}}),r.jsx(ax,{open:F,onClose:()=>Z(!1),doFacturaClienteFinal:Bt,doFacturaClienteNormal:En,doFacturaClienteJuridico:Mt,carritoLength:l.length,subtotal:ni(),taxRate:m,taxableSubtotal:Ta()}),r.jsx(ix,{open:T,onClose:()=>z(!1),clienteTipo:qe,clienteRTN:de,clienteNombre:se,clienteTelefono:ke,clienteCorreo:ut,clienteExonerado:jt,clienteSearchOpen:P,setClienteSearchOpen:$=>Q($),onRTNChange:$=>Rl($),onNombreChange:$=>ae($),onTelefonoChange:$=>Je($),onCorreoChange:$=>Nt($),onExoneradoChange:$=>Lt($),onCreateCliente:()=>at(!0),onCancel:()=>z(!1),onOpenCreateCliente:()=>at(!0),onOpenPayment:()=>wn(!0),paymentDone:Ol,submitClienteNormal:zl}),r.jsx(rx,{open:Nn,onClose:()=>at(!1),clienteRTN:de,clienteNombre:se,clienteTelefono:ke,clienteCorreo:ut,clienteExonerado:jt,onChangeRTN:$=>oe($),onChangeNombre:$=>ae($),onChangeTelefono:$=>Je($),onChangeCorreo:$=>Nt($),onChangeExonerado:$=>Lt($),onCreate:async()=>{try{if(!se||!de)return;const{data:$,error:ue}=await re.from("clientes").select("id").eq("rtn",de).maybeSingle();if(ue&&console.warn("Error buscando cliente al crear:",ue),$&&$.id){const{error:we}=await re.from("clientes").update({nombre:se,telefono:ke||null,correo_electronica:ut||null,tipo_cliente:"juridico",exonerado:jt}).eq("id",$.id);we&&console.warn("Error actualizando cliente al crear:",we)}else{const{error:we}=await re.from("clientes").insert([{nombre:se,rtn:de,telefono:ke||null,correo_electronica:ut||null,tipo_cliente:"juridico",exonerado:jt}]);we&&console.warn("Error insertando cliente al crear:",we)}}catch($){console.warn("Error creando cliente juridico:",$)}at(!1)}})]})}const lx={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},ox={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},cx={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},ux={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},np=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function dx({title:o,children:a}){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:o}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function hx(){const[o,a]=S.useState(null);return S.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Ventas (ltimos das)"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Flujo de caja"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Inventario por categora"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Promedios"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):r.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const fx="modulepreload",gx=function(o){return"/"+o},ap={},yn=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(_=>Promise.resolve(_).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};var f=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=gx(v),v in ap)return;ap[v]=!0;const _=v.endsWith(".css"),j=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${j}`))return;const b=document.createElement("link");if(b.rel=_?"stylesheet":fx,_||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),_)return new Promise((w,A)=>{b.addEventListener("load",w),b.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function em({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:f="Cancelar"}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),r.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:f}),r.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function px(){const[o,a]=S.useState(null),[s,l]=S.useState(!1),[u,d]=S.useState(!1),[f,g]=S.useState({}),[p,m]=S.useState(null),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,A]=S.useState(!1),[O,C]=S.useState(null),[M,B]=S.useState(null),[K,E]=S.useState(!1),[q,k]=S.useState(""),[I,ce]=S.useState(""),[J,F]=S.useState(null),[Z,D]=S.useState(null);S.useEffect(()=>{let z=!0;return(async()=>{l(!0);try{const P=(await yn(async()=>{const{default:ae}=await Promise.resolve().then(()=>mn);return{default:ae}},void 0)).default,{data:Q,error:se}=await P.from("empresa").select("*").limit(1).single();if(!z)return;if(se)throw se;if(Q){a(Q),g(Q);try{localStorage.setItem("companyData",JSON.stringify(Q))}catch{}l(!1);return}}catch(P){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",P)}try{const P=localStorage.getItem("companyData");if(P){a(JSON.parse(P)),g(JSON.parse(P)),l(!1);return}}catch{}try{const P=await fetch("/data-base/company.json");if(!P.ok)throw new Error("no json");const Q=await P.json();if(!z)return;a(Q),g(Q)}catch{z&&a(null)}finally{z&&l(!1)}})(),()=>{z=!1}},[]),S.useEffect(()=>{o&&g(o)},[o]),S.useEffect(()=>{try{const z=localStorage.getItem("pendingCompanySave");if(z){const P=JSON.parse(z);_(!0),b(P.payload??null),A(!!P.needsLogo)}}catch{}},[]),S.useEffect(()=>{let z=!0;return(async()=>{try{if(!o||!o.logo){z&&F(null);return}const P=String(o.logo);if(P.startsWith("http")){z&&F(P);return}const Q=(await yn(async()=>{const{default:Re}=await Promise.resolve().then(()=>mn);return{default:Re}},void 0)).default,se="logo",de=(await Q.storage.from(se).getPublicUrl(P))?.data?.publicUrl??null;if(de){z&&F(de);return}const ge=(await Q.storage.from(se).createSignedUrl(P,3600))?.data?.signedUrl??null;if(ge){z&&F(ge);return}z&&F(null)}catch(P){console.warn("Error resolving company logo URL",P),z&&F(null)}})(),()=>{z=!1}},[o?.logo]),S.useEffect(()=>{let z=!0;return(async()=>{try{if(p){z&&D(p);return}const P=f?.logo;if(!P){z&&D(null);return}const Q=String(P);if(Q.startsWith("http")){z&&D(Q);return}const se=(await yn(async()=>{const{default:qe}=await Promise.resolve().then(()=>mn);return{default:qe}},void 0)).default,ae="logo",oe=(await se.storage.from(ae).getPublicUrl(Q))?.data?.publicUrl??null;if(oe){z&&D(oe);return}const Re=(await se.storage.from(ae).createSignedUrl(Q,3600))?.data?.signedUrl??null;if(Re){z&&D(Re);return}z&&D(null)}catch(P){console.warn("Error resolving edit logo URL",P),z&&D(null)}})(),()=>{z=!1}},[f?.logo,p]);function W(){d(!0),g(o||{})}function pe(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function U(z){const{name:P,value:Q}=z.target;g(se=>({...se,[P]:Q}))}function L(z){const P=z.target.files?.[0]??null;if(g(Q=>({...Q,logoFile:P})),P)try{const Q=URL.createObjectURL(P);m(Q)}catch{m(null)}else m(null)}function ee(z=!1){const P="logo",Q="https://sqwqlvsjtimallidxrsz.supabase.co";if(z){if(p)return p;const de=f?.logo;if(!de)return"/logo192.png";if(String(de).startsWith("http"))return String(de);let oe=String(de);return oe.startsWith(`${P}/`)&&(oe=oe.slice(P.length+1)),`${Q}/storage/v1/object/public/${P}/${encodeURIComponent(oe)}`}if(!o)return"/logo192.png";const se=o.logo;if(!se)return"/logo192.png";if(String(se).startsWith("http"))return String(se);let ae=String(se);return ae.startsWith(`${P}/`)&&(ae=ae.slice(P.length+1)),`${Q}/storage/v1/object/public/${P}/${encodeURIComponent(ae)}`}async function le(){try{const z=(await yn(async()=>{const{default:oe}=await Promise.resolve().then(()=>mn);return{default:oe}},void 0)).default,P={...f||{}};let Q=null;const se=oe=>{if(!oe)return null;if(!oe.startsWith("http"))return oe;const ge=oe.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return ge?decodeURIComponent(ge[2]):null},ae=o?.logo??null;try{const oe=f&&f.logoFile instanceof File?f.logoFile:null,ge="logo";if(oe){const qe=`logo/${P.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${oe.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,Ne=await z.storage.from(ge).upload(qe,oe,{upsert:!0});if(Ne.error)throw Ne.error;const ke=Ne.data?.path??qe;Q=ke,P.logo=ke}}catch(oe){console.warn("Logo upload error",oe)}try{P.logoFile&&delete P.logoFile}catch{}let de=null;try{if(o&&o.id){const{data:oe,error:ge}=await z.from("empresa").update(P).eq("id",o.id).select("*");if(ge)throw ge;de=Array.isArray(oe)?oe[0]??null:oe}else{const{data:oe,error:ge}=await z.from("empresa").insert(P).select("*");if(ge)throw ge;de=Array.isArray(oe)?oe[0]??null:oe}try{if(Q){const oe=se(ae);if(oe&&oe!==Q){const Re=await z.storage.from("logo").remove([oe]);Re.error&&console.warn("Failed to remove old company logo after DB update",Re.error)}}}catch(oe){console.warn("Error removing old logo after DB success",oe)}}catch(oe){try{if(Q){const Re=await z.storage.from("logo").remove([Q]);Re.error&&console.warn("Failed to remove uploaded logo after DB error",Re.error)}}catch(ge){console.warn("Error cleaning uploaded logo after DB failure",ge)}throw oe}a(de),g(de);try{console.debug("Empresa guardada, logo field:",de?.logo)}catch{}try{B(de?.logo??null)}catch{}try{k("Datos guardados"),ce("Los datos de la empresa se guardaron correctamente."),E(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(de))}catch{}d(!1)}catch(z){console.error("Error guardando empresa en Supabase",z);try{C(z?.message||String(z))}catch{}try{const P={...f||{}};P.logoFile&&delete P.logoFile;const Q=!!(f&&f.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:P,needsLogo:Q,ts:Date.now()})),_(!0),b(P),A(Q),a(f);try{localStorage.setItem("companyData",JSON.stringify(f))}catch{}d(!1),k("Guardado localmente"),ce("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),E(!0)}catch(P){console.error("Error saving locally",P)}}}async function fe(){const z=j;if(!z){k("Sin pendientes"),ce("No hay datos pendientes para enviar"),E(!0);return}try{const P=(await yn(async()=>{const{default:se}=await Promise.resolve().then(()=>mn);return{default:se}},void 0)).default;let Q=null;if(z.id){const{data:se,error:ae}=await P.from("empresa").update(z).eq("id",z.id).select("*");if(ae)throw ae;Q=Array.isArray(se)?se[0]??null:se}else{const{data:se,error:ae}=await P.from("empresa").insert(z).select("*");if(ae)throw ae;Q=Array.isArray(se)?se[0]??null:se}localStorage.removeItem("pendingCompanySave"),_(!1),b(null),A(!1),a(Q),g(Q),k("Sincronizado"),ce("Los datos pendientes se sincronizaron con Supabase correctamente."),E(!0)}catch(P){console.error("Error reenviando datos pendientes",P),k("Error al reenviar"),ce("No se pudo reenviar los datos a Supabase: "+(P?.message||String(P))),E(!0)}}function T(){try{localStorage.removeItem("pendingCompanySave"),_(!1),b(null),A(!1),k("Pendiente descartado"),ce("El guardado pendiente fue descartado."),E(!0)}catch{}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?r.jsx("div",{children:"Cargando datos de la empresa..."}):o?r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?r.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",O?r.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(O)]}):null,w?r.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn-primary",onClick:fe,children:"Reintentar guardar en Supabase"}),r.jsx("button",{className:"btn-opaque",onClick:T,children:"Descartar pendiente"})]})]})}):null,M?r.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[r.jsx("strong",{children:"Logo guardado:"}),r.jsxs("div",{style:{marginTop:6},children:[r.jsx("a",{href:ee(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),r.jsx("div",{style:{color:"#374151",fontSize:12},children:String(M)})]})]}):null,r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:r.jsx("img",{src:u?Z??ee(!0):J??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),r.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"RTN:"})," ",u?r.jsx("input",{name:"rtn",value:f.rtn||"",onChange:U,className:"input"}):o.rtn]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Telfono:"})," ",u?r.jsx("input",{name:"telefono",value:f.telefono||"",onChange:U,className:"input"}):o.telefono]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Correo:"})," ",u?r.jsx("input",{name:"email",value:f.email||"",onChange:U,className:"input"}):o.email]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Direccin:"})," ",u?r.jsx("textarea",{name:"direccion",value:f.direccion||"",onChange:U,className:"input",style:{minHeight:64}}):o.direccion]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Logo (archivo o URL):"}),u?r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[r.jsx("input",{type:"file",accept:"image/*",onChange:L}),r.jsx("input",{name:"logo",value:f.logo||"",onChange:U,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):r.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?r.jsxs("div",{style:{marginTop:8},children:[r.jsx("small",{children:"Preview:"}),r.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:le,className:"btn-primary",children:"Guardar"}),r.jsx("button",{type:"button",onClick:pe,className:"btn-opaque",children:"Cancelar"})]}):r.jsx(r.Fragment,{children:r.jsx("button",{type:"button",onClick:W,className:"btn-primary",children:"Actualizar datos"})})})]}),r.jsx("div",{style:{flex:1,minWidth:320},children:r.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:r.jsx("img",{src:u?Z??ee(!0):J??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),r.jsxs("p",{style:{margin:0},children:["RTN: ",r.jsx("strong",{children:o.rtn})]}),r.jsxs("p",{style:{margin:0},children:["Telfono: ",r.jsx("strong",{children:o.telefono})]}),r.jsxs("p",{style:{marginTop:8},children:["Correo: ",r.jsx("strong",{children:o.email})]}),r.jsxs("p",{style:{marginTop:8},children:["Direccin: ",r.jsx("strong",{children:o.direccion})]})]})})]}):r.jsx("div",{children:"No se encontraron datos de la empresa."}),r.jsx(em,{open:K,title:q,message:I,onClose:()=>E(!1)})]})}function mx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function yx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[j,b]=S.useState(""),[w,A]=S.useState(null),[O,C]=S.useState(""),[M,B]=S.useState(""),[K,E]=S.useState("");async function q(){l(!0),d(null);try{const{data:D,error:W}=await re.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(W)throw W;a(Array.isArray(D)?D:[])}catch(D){d(D?.message||String(D)),a([])}finally{l(!1)}}async function k(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const D={username:p,password:v,role:"cajero"};j&&(D.nombre_usuario=j);const{error:W}=await re.from("users").insert(D);if(W)throw W;m(""),_(""),b(""),await q()}catch(D){d(D?.message||String(D))}finally{l(!1)}}function I(D){A(D.id),C(D.username||""),E(D.nombre_usuario||""),B(""),d(null)}function ce(){A(null),C(""),B(""),E(""),d(null)}async function J(){if(w!=null){if(!O)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const D={username:O};M&&(D.password=M),D.nombre_usuario=K||null;const{error:W}=await re.from("users").update(D).eq("id",w);if(W)throw W;ce(),await q()}catch(D){d(D?.message||String(D))}finally{l(!1)}}}async function F(D,W){if(W!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:pe}=await re.from("users").delete().eq("id",D);if(pe)throw pe;await q()}catch(pe){d(pe?.message||String(pe))}finally{l(!1)}}}S.useEffect(()=>{let D=!0;return(async()=>D&&await q())(),()=>{D=!1}},[]);const Z=o.filter(D=>{if(!f)return!0;const W=f.toLowerCase();return(D.username||"").toLowerCase().includes(W)||(String(D.id)||"").includes(W)||(D.role||"").toLowerCase().includes(W)||(D.nombre_usuario||"").toLowerCase().includes(W)});return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[r.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:f,onChange:D=>g(D.target.value),style:{minWidth:220}}),r.jsx("button",{onClick:()=>q(),className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${Z.length} usuarios`}),r.jsx("div",{style:{width:"100%",height:8}}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:D=>m(D.target.value)}),r.jsx("input",{placeholder:"Nombre",className:"input",value:j,onChange:D=>b(D.target.value)}),r.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:D=>_(D.target.value)}),r.jsx("button",{onClick:()=>k(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?r.jsx("div",{style:{color:"red",marginBottom:12},children:u}):r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"})]})}),r.jsx("tbody",{children:Z.map(D=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:D.id}),r.jsx("td",{style:{minWidth:180},children:w===D.id?r.jsx("input",{className:"input",value:O,onChange:W=>C(W.target.value)}):D.username||"-"}),r.jsx("td",{style:{minWidth:180},children:w===D.id?r.jsx("input",{className:"input",value:K,onChange:W=>E(W.target.value)}):D.nombre_usuario||"-"}),r.jsx("td",{style:{width:220},children:w===D.id?r.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:M,onChange:W=>B(W.target.value)}):D.role||"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:w===D.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>J(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),r.jsx("button",{onClick:()=>ce(),className:"btn-opaque",children:"Cancelar"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>I(D),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),D.role==="cajero"?r.jsx("button",{onClick:()=>F(D.id,D.role),className:"btn-danger",children:"Eliminar"}):r.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},D.id))})]}),Z.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function vx({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:f}){const[g,p]=S.useState(null),[m,v]=S.useState(null),[_,j]=S.useState(!1),[b,w]=S.useState(null),[A,O]=S.useState(""),[C,M]=S.useState(""),[B,K]=S.useState(""),[E,q]=S.useState(""),[k,I]=S.useState(!1),[ce,J]=S.useState(null);if(S.useEffect(()=>{if(!o||!s)return;w(s.caja??null),O(s.cai??""),M(s.rango_de??""),K(s.rango_hasta??""),q(s.fecha_vencimiento??"");const Z=s.cajero??null;if(Z){const D=l.find(W=>W.username===Z||W.nombre_usuario===Z);D?(p(D.id),v(null),j(!1)):(p(null),v(Z),j(!0))}else p(null),v(null),j(!1);J(null)},[o,s,l]),!o||!s)return null;async function F(){if(!s){J("Registro invlido");return}if(b!=null&&(b<1||b>5)){J("La caja debe estar entre 1 y 5");return}I(!0),J(null);try{const Z={cai:A??null,rango_de:C??null,rango_hasta:B??null,fecha_vencimiento:E??null,caja:b??null};if(g!=null){const D=l.find(W=>W.id===g);Z.cajero=D?D.username:null}else Z.cajero=m??null;await f(s.id,Z),a()}catch(Z){J(Z?.message||String(Z))}finally{I(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:A,onChange:Z=>O(Z.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:C,onChange:Z=>M(Z.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:B,onChange:Z=>K(Z.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:E,onChange:Z=>q(Z.target.value)}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):_?"__custom__":"",onChange:Z=>{const D=Z.target.value;D===""?(p(null),v(null),j(!1)):D==="__custom__"?(p(null),j(!0)):/^\d+$/.test(D)&&(p(Number(D)),v(null),j(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(Z=>r.jsxs("option",{value:String(Z.id),children:[Z.username,Z.nombre_usuario?`  ${Z.nombre_usuario}`:""]},Z.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),_&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:Z=>{v(Z.target.value),p(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:Z=>w(Z.target.value===""?null:Number(Z.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(Z=>r.jsx("option",{value:Z,children:Z},Z))]})]})]})]})]}),ce&&r.jsx("div",{style:{color:"red",marginTop:12},children:ce}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:k,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:F,disabled:k,style:{width:"auto",padding:"8px 14px"},children:k?"Guardando...":"Guardar"})]})]})})}function bx({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[f,g]=S.useState(null),[p,m]=S.useState(null),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,A]=S.useState(""),[O,C]=S.useState(""),[M,B]=S.useState(""),[K,E]=S.useState(""),[q,k]=S.useState(!1),[I,ce]=S.useState(null);if(!o)return null;async function J(){const F=[];if(w||F.push("CAI"),O||F.push("Rango Desde"),M||F.push("Rango Hasta"),K||F.push("Fecha de Vencimiento"),j==null&&F.push("Caja"),f==null&&!p&&F.push("Cajero"),F.length>0){ce(`Campos obligatorios faltantes: ${F.join(", ")}`);return}if(j!=null&&(j<1||j>5)){ce("La caja debe estar entre 1 y 5");return}k(!0),ce(null);try{const Z={cai:w??null,rango_de:O??null,rango_hasta:M??null,fecha_vencimiento:K??null,caja:j??null};if(f!=null){const D=s.find(W=>W.id===f);Z.cajero=D?D.username:null}else Z.cajero=p??null;await d(Z),a()}catch(Z){ce(Z?.message||String(Z))}finally{k(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:w,onChange:F=>A(F.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:O,onChange:F=>C(F.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:M,onChange:F=>B(F.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:K,onChange:F=>E(F.target.value)}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:f!=null?String(f):v?"__custom__":"",onChange:F=>{const Z=F.target.value;Z===""?(g(null),m(null),_(!1)):Z==="__custom__"?(g(null),_(!0)):/^\d+$/.test(Z)&&(g(Number(Z)),m(null),_(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(F=>r.jsxs("option",{value:String(F.id),children:[F.username,F.nombre_usuario?`  ${F.nombre_usuario}`:""]},F.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:F=>{m(F.target.value),g(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:j??"",onChange:F=>b(F.target.value===""?null:Number(F.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(F=>r.jsx("option",{value:F,children:F},F))]})]})]})]})]}),I&&r.jsx("div",{style:{color:"red",marginTop:12},children:I}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:q,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:J,disabled:q,style:{width:"auto",padding:"8px 14px"},children:q?"Creando...":"Crear"})]})]})})}function xx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState([]),[p,m]=S.useState(null),[v,_]=S.useState(!1),[j,b]=S.useState(!1);async function w(){l(!0),d(null);try{const{data:E,error:q}=await re.from("cai").select("id, cai, rango_de, rango_hasta, fecha_vencimiento, caja, cajero").order("id",{ascending:!0});if(q)throw q;a(Array.isArray(E)?E:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}async function A(){try{const{data:E}=await re.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),A()},[]);const O=new Set(o.filter(E=>E.cajero).map(E=>String(E.cajero))),C=new Set(o.filter(E=>E.caja!=null).map(E=>Number(E.caja)));function M(E){m(E),_(!0),d(null)}function B(){_(!1),m(null)}async function K(E,q){l(!0),d(null);try{const{error:k}=await re.from("cai").update(q).eq("id",E);if(k)throw k;await w()}catch(k){throw d(k?.message||String(k)),k}finally{l(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"CAI"}),r.jsx("th",{children:"Rango Desde"}),r.jsx("th",{children:"Rango Hasta"}),r.jsx("th",{children:"Vencimiento"}),r.jsx("th",{children:"Cajero"}),r.jsx("th",{children:"Caja"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:200},children:E.cai}),r.jsx("td",{children:E.rango_de}),r.jsx("td",{children:E.rango_hasta}),r.jsx("td",{children:E.fecha_vencimiento}),r.jsx("td",{style:{minWidth:180},children:E.cajero||"-"}),r.jsx("td",{style:{width:120},children:E.caja??"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>M(E),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},E.id))})]}),o.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),r.jsx(vx,{open:v,onClose:B,row:p,cajeros:f,availableCajeros:p?f.filter(E=>!O.has(E.username)||E.username===p.cajero):f.filter(E=>!O.has(E.username)),availableCajas:p?[1,2,3,4,5].filter(E=>!C.has(E)||E===p.caja):[1,2,3,4,5].filter(E=>!C.has(E)),onSave:K}),r.jsx(bx,{open:j,onClose:()=>b(!1),cajeros:f,availableCajeros:f.filter(E=>!O.has(E.username)),availableCajas:[1,2,3,4,5].filter(E=>!C.has(E)),onCreate:async E=>{l(!0),d(null);try{const{error:q}=await re.from("cai").insert(E);if(q)throw q;await w(),b(!1)}catch(q){throw d(q?.message||String(q)),q}finally{l(!1)}}})]})}function _x(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function jx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),r.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Ou=rp();function Sx({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,f]=sp.useState(!1);if(!o)return null;const g=async()=>{try{f(!0),await u()}finally{f(!1)}};return Ou.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("p",{children:s}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),r.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function wx({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[f,g]=S.useState({}),[p,m]=S.useState(!1),[v,_]=S.useState(null);if(S.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?_(l.imagen):_(null)},[l,o]),!o)return null;const j=(O,C)=>{g(M=>({...M,[O]:C}))},b=async O=>{O.preventDefault();try{m(!0),await d(f)}finally{m(!1)}},w=O=>O==="creado_en"?null:O==="id"?r.jsx("input",{className:"input",value:f[O]??"",readOnly:!0}):O.includes("publicacion")||O.includes("exento")||O.includes("aplica_impuesto")||O==="publicacion_web"?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("label",{className:"switch",children:[r.jsx("input",{type:"checkbox",checked:!!f[O],onChange:C=>j(O,C.target.checked)}),r.jsx("span",{className:"slider"})]}),r.jsx("span",{style:{fontSize:13},children:f[O]?"S":"No"})]}):O.includes("categoria")||O.includes("marca")?r.jsx("input",{type:"text",className:"input",value:f[O]??"",onChange:C=>j(O,C.target.value===""?null:C.target.value)}):O==="imagen"?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?r.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,r.jsx("input",{type:"file",accept:"image/*",onChange:C=>{const M=C.target.files&&C.target.files[0];if(j(O,M??null),M)try{const B=URL.createObjectURL(M);_(B)}catch{_(null)}else _(null)}}),v?r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{j(O,null),_(null)},children:"Eliminar imagen"}):null]}):r.jsx("input",{className:"input",value:f[O]??"",onChange:C=>j(O,C.target.value)}),A=r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsxs("form",{onSubmit:b,children:[r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(O=>r.jsxs("label",{style:{display:"block"},children:[r.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(O).replace(/_/g," ").toUpperCase()}),w(O)]},O))}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Ou.createPortal(A,typeof document<"u"&&document.body||document.createElement("div"))}function Ex({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const f=a||{},[g,p]=S.useState(null),[m,v]=S.useState(null),[_,j]=S.useState(null),[b,w]=S.useState(null);return S.useEffect(()=>{let A=!0;return(async()=>{const C=typeof f.imagen=="string"?f.imagen:null;if(!C){A&&p(null);return}if(C.startsWith("http")){A&&(p(C),j(C));return}let M=C;const B=String(C).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);B&&(M=decodeURIComponent(B[2]));const K="inventario";try{const E=(await yn(async()=>{const{default:J}=await Promise.resolve().then(()=>mn);return{default:J}},void 0)).default,q=await E.storage.from(K).getPublicUrl(M),k=q?.data?.publicUrl||q?.data?.publicURL||null;if(k){A&&(p(k),j(k));return}const I=await E.storage.from(K).createSignedUrl(M,3600*24*7);if(I.error){console.warn("ProductDetailModal createSignedUrl error",I.error),A&&p(null);return}const ce=I.data?.signedUrl??null;A&&(p(ce),j(ce))}catch(E){console.error("ProductDetailModal resolve error",E),A&&p(null)}})(),()=>{A=!1}},[f]),S.useEffect(()=>{let A=!0;return(async()=>{if(w(null),!!_)try{const C=await fetch(_,{method:"HEAD"});if(!A)return;w(`HEAD ${C.status} ${C.statusText} - content-type: ${C.headers.get("content-type")}`)}catch(C){if(!A)return;w(`FETCH_ERROR: ${String(C)}`)}})(),()=>{A=!1}},[_]),Ou.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:s}),r.jsxs("div",{style:{display:"flex",gap:18},children:[r.jsx("div",{style:{flex:1},children:r.jsx("table",{style:{width:"100%"},children:r.jsx("tbody",{children:Object.keys(f).map(A=>{const O=f[A];return A==="imagen"&&typeof O=="string"?null:r.jsxs("tr",{children:[r.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(A).replace(/_/g," ").toUpperCase()}),r.jsx("td",{style:{padding:6},children:String(O??"-")})]},A)})})})}),r.jsx("div",{style:{width:280,textAlign:"center"},children:g?r.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:A=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?r.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),r.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):r.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(f),children:"Editar"}),r.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(f.id),children:"Eliminar"}),r.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function Cx({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:f,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:_=[]}){const[j,b]=S.useState(null),[w,A]=S.useState(!1),[O,C]=S.useState(null),[M,B]=S.useState(""),[K,E]=S.useState(!1),[q,k]=S.useState("add"),[I,ce]=S.useState({}),[J,F]=S.useState(!1),[Z,D]=S.useState(null),[W,pe]=S.useState(!1),[U,L]=S.useState(null),ee=S.useRef(!0),le=async()=>{A(!0),C(null);try{const ae=(await yn(async()=>{const{default:Re}=await Promise.resolve().then(()=>mn);return{default:Re}},void 0)).default,de=a||"*";let oe=ae.from(o).select(de).limit(l);f&&(Array.isArray(f)?f:String(f).split(",").map(qe=>qe.trim()).filter(Boolean)).forEach(qe=>{const Ne=qe.split(" ").map(ut=>ut.trim()).filter(Boolean),ke=Ne[0],Je=Ne[1]?Ne[1].toLowerCase():"asc";oe=oe.order(ke,{ascending:Je!=="desc"})}),g&&Object.entries(g).forEach(([Re,qe])=>{qe==null||qe===""||(oe=oe.eq(Re,qe))});const ge=await oe;if(console.debug("SupabaseTable fetch result for",o,ge),!ee.current)return;if(ge.error)throw ge.error;b(Array.isArray(ge.data)?ge.data:[])}catch(ae){console.error("SupabaseTable error",ae),C(ae?.message||String(ae)),b([])}finally{ee.current&&A(!1)}};S.useEffect(()=>(ee.current=!0,le(),()=>{ee.current=!1}),[o,a,l]);const fe=S.useMemo(()=>u&&u.length>0?u:!j||j.length===0?[]:Object.keys(j[0]),[u,j]),T=S.useMemo(()=>{if(!j)return null;const ae=(M||"").toString().trim().toLowerCase();if(!ae)return j;const de=d&&d.length>0?d:fe;return j.filter(oe=>de.some(ge=>{const Re=oe?.[ge];return Re==null?!1:String(Re).toLowerCase().includes(ae)}))},[j,M,d,fe]),z=()=>{p&&(k("add"),ce({}),E(!0))},P=ae=>{m&&(k("edit"),ce(ae),E(!0))},Q=async ae=>{const de=(await yn(async()=>{const{default:oe}=await Promise.resolve().then(()=>mn);return{default:oe}},void 0)).default;try{const oe="inventario",ge={...ae},Re=q==="edit"?I?.imagen??null:null,qe=Ne=>{if(!Ne)return null;if(!Ne.startsWith("http"))return Ne;const ke=Ne.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return ke?decodeURIComponent(ke[2]):null};if(ge.imagen&&ge.imagen instanceof File){const Ne=ge.imagen,ke=ge.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Je=`${o}/${ke}/${Date.now()}_${Ne.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,ut=await de.storage.from(oe).upload(Je,Ne,{upsert:!0});if(ut.error)throw ut.error;const Nt=ut.data?.path??Je;ge.imagen=Nt;try{const jt=qe(Re);if(jt&&jt!==Nt){const Lt=await de.storage.from(oe).remove([jt]);Lt.error&&console.warn("Failed to remove old image",Lt.error)}}catch(jt){console.warn("Error removing old image",jt)}}if(q==="edit"&&(ge.imagen==null||ge.imagen===""))try{const Ne=qe(I?.imagen??null);if(Ne){const ke=await de.storage.from(oe).remove([Ne]);ke.error&&console.warn("Failed to remove old image on clear",ke.error)}}catch(Ne){console.warn("Error removing old image on clear",Ne)}if(q==="add"){const{error:Ne}=await de.from(o).insert([ge]);if(Ne)throw Ne}else{const Ne=ge.id,ke={...ge};delete ke.id;const{error:Je}=await de.from(o).update(ke).eq("id",Ne);if(Je)throw Je}E(!1),await le()}catch(oe){console.error("Error saving",oe),C(oe?.message||String(oe))}},se=async()=>{if(Z==null)return;const ae=(await yn(async()=>{const{default:de}=await Promise.resolve().then(()=>mn);return{default:de}},void 0)).default;try{if(!v)return;try{const oe="inventario",ge=j?.find(ke=>ke.id===Z),Re=ke=>{if(!ke)return null;if(!ke.startsWith("http"))return ke;const Je=ke.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Je?decodeURIComponent(Je[2]):null},qe=ge?.imagen??null,Ne=Re(qe);if(Ne){const ke=await ae.storage.from(oe).remove([Ne]);ke.error&&console.warn("Failed to remove image on delete",ke.error)}}catch(oe){console.warn("Error removing image before delete",oe)}const{error:de}=await ae.from(o).delete().eq("id",Z);if(de)throw de;F(!1),D(null),await le()}catch(de){console.error("Error deleting",de),C(de?.message||String(de))}};return r.jsxs("div",{style:{padding:18},children:[s?r.jsx("h2",{style:{marginTop:0},children:s}):null,r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("input",{placeholder:"Buscar...",value:M,onChange:ae=>B(ae.target.value),className:"input",style:{minWidth:240}}),r.jsx("button",{onClick:()=>{C(null),B(""),le()},className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto"},children:r.jsx("button",{onClick:z,className:"btn-primary",children:"Agregar"})})]}),w&&r.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),O&&r.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",O]}),!w&&j&&j.length===0&&r.jsxs("div",{children:["No hay registros en la tabla ",r.jsx("strong",{children:o}),"."]}),!w&&T&&T.length>0&&r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[fe.map(ae=>r.jsx("th",{children:String(ae).replace(/_/g," ").toUpperCase()},ae)),r.jsx("th",{style:{width:140},children:"Acciones"})]})}),r.jsx("tbody",{children:T.map((ae,de)=>r.jsxs("tr",{children:[fe.map(oe=>{if(oe==="imagen"){const ge=ae?.imagen??null;return ge||console.debug("SupabaseTable: row has no imagen for id",ae?.id,ae),r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:ge?r.jsx(tm,{src:String(ge)}):r.jsx("span",{style:{color:"#6b7280"},children:"-"})},oe)}return r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:Tx(ae[oe])},oe)}),r.jsx("td",{className:"admin-actions",children:r.jsx("button",{className:"btn-opaque",onClick:()=>{L(ae),pe(!0)},children:"Ver"})})]},ae.id??de))})]})}),r.jsx(wx,{open:K,title:q==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:fe.filter(ae=>!_.includes(ae)),initialData:I,onClose:()=>E(!1),onSave:Q}),r.jsx(Ex,{open:W,data:U,title:`Detalle de ${o}`,onClose:()=>pe(!1),onEdit:ae=>{pe(!1),P(ae)},onDeleteClick:ae=>{pe(!1),D(ae),F(!0)}}),r.jsx(Sx,{open:J,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>F(!1),onConfirm:se})]})}function Tx(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return r.jsx(tm,{src:o})}return String(o)}function tm({src:o}){const[a,s]=S.useState(null),[l,u]=S.useState(null);return S.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await yn(async()=>{const{default:A}=await Promise.resolve().then(()=>mn);return{default:A}},void 0)).default,v="inventario",_=await m.storage.from(v).getPublicUrl(g),j=_?.data?.publicUrl||_?.data?.publicURL||null;if(j){d&&s(j);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const w=b.data?.signedUrl??null;d&&s(w)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?r.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:r.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function Ax(){const[o,a]=S.useState(null),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState([]);return S.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await yn(async()=>{const{default:k}=await Promise.resolve().then(()=>mn);return{default:k}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],A=new Set(w.map(k=>k.categoria??"").filter(Boolean)),O=new Set(w.map(k=>k.marca??"").filter(Boolean)),C=w.length,M=w.filter(k=>!!k.publicacion_web).length,B=k=>{if(k==null)return!1;if(typeof k=="boolean")return k===!0;if(typeof k=="number")return k===1;const I=String(k).toLowerCase().trim();return I==="1"||I==="true"||I==="t"||I==="si"||I==="s"||I==="yes"},K=w.filter(k=>B(k.exento)).length,E=w.filter(k=>B(k.aplica_impuesto_18)).length,q=w.filter(k=>B(k.aplica_impuesto_turistico)).length;a({categorias:A.size,marcas:O.size,items:C,publicadas:M,exentos:K,aplica_impuesto_18:E,aplica_impuesto_turistico:q}),g(Array.from(A).sort()),m(Array.from(O).sort())}catch(j){console.error("Error loading inventario summary",j)}})(),()=>{v=!1}},[]),r.jsxs("div",{children:[r.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[r.jsx(Xa,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),r.jsx(Xa,{label:"Marcas",value:o?String(o.marcas):"..."}),r.jsx(Xa,{label:"Items",value:o?String(o.items):"..."}),r.jsx(Xa,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),r.jsx(Xa,{label:"Exentos",value:o?String(o.exentos):"..."}),r.jsx(Xa,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),r.jsx(Xa,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),r.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),f.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),r.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),p.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),r.jsx(Cx,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function Xa({label:o,value:a}){return r.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),r.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function Ox({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,f]=S.useState(null),[g,p]=S.useState(""),[m,v]=S.useState(!1),[_,j]=S.useState(null),[b,w]=S.useState(null),[A,O]=S.useState(null),[C,M]=S.useState(null),[B,K]=S.useState(null),[E,q]=S.useState(null),[k,I]=S.useState(null),[ce,J]=S.useState(null),[F,Z]=S.useState(null),[D,W]=S.useState(!1);S.useEffect(()=>{o&&(f(null),p(""),w(null),O(null),M(null),J(null),Z(null),j(null))},[o]);async function pe(){const L=[];if(d||L.push("Producto"),g||L.push("Precio"),L.length>0){j(`Faltan campos: ${L.join(", ")}`);return}const ee=Number(g);if(isNaN(ee)||ee<0){j("Precio invlido");return}v(!0),j(null);try{await u({producto_id:d,precio:g});try{const le={};if(B!==null&&(le.exento=B),E!==null&&(le.aplica_impuesto_18=E),k!==null&&(le.aplica_impuesto_turistico=k),Object.keys(le).length>0){const{error:fe}=await re.from("inventario").update(le).eq("id",d);fe&&console.warn("Error actualizando inventario flags:",fe)}}catch(le){console.warn("Error al persistir flags en inventario:",le)}a()}catch(le){j(le?.message||String(le))}finally{v(!1)}}function U(L){return L?Number(L.replace(",",".")):NaN}return S.useEffect(()=>{let L=!0;async function ee(){if(w(null),O(null),M(null),J(null),Z(null),!d)return;const le=U(g);if(!isNaN(le)){W(!0);try{const{data:fe,error:T}=await re.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(T)throw T;const z=Array.isArray(fe)?fe.map(at=>Number(at.costo_unitario)).filter(at=>!isNaN(at)):[],P=z.length>0?z.reduce((at,ot)=>at+ot,0)/z.length:0;if(!L)return;w(P);let Q=!1,se=!1,ae=!1;try{const{data:at,error:ot}=await re.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!ot&&at&&(Q=!!at.exento,se=!!at.aplica_impuesto_18,ae=!!at.aplica_impuesto_turistico,B===null&&K(Q),E===null&&q(se),k===null&&I(ae))}catch{}const{data:de}=await re.from("impuesto").select("id, impuesto_venta"),oe={};Array.isArray(de)&&de.forEach(at=>{oe[String(at.id)]=Number(at.impuesto_venta)});const ge=B!==null?B:Q,Re=E!==null?E:se,qe=k!==null?k:ae;let Ne=0;ge?Ne=0:Re?Ne=oe[2]??oe[1]??0:Ne=oe[1]??0;let ke=0;qe&&(ke=oe[3]??0);const Je=(Ne||0)+(ke||0),ut=Je>1?Je/100:Je,Nt=le*ut;O(Je),M(Nt);const jt=le-P,Lt=P>0?jt/P*100:null;J(Lt);const Nn=le>0?(le-P-Nt)/le*100:null;Z(Nn)}catch{}finally{L&&W(!1)}}}return ee(),()=>{L=!1}},[d,g,B,E,k]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:d??"",onChange:L=>f(L.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(L=>r.jsx("option",{value:L.id,children:L.nombre},L.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!B,onChange:L=>K(L.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!E,onChange:L=>q(L.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!k,onChange:L=>I(L.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:g,onChange:L=>p(L.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:C==null?"":C.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:ce==null?"":ce.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:F==null?"":F.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&r.jsx("div",{style:{color:"red",marginTop:12},children:_}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:pe,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function Rx({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[f,g]=S.useState(null),[p,m]=S.useState(""),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,A]=S.useState(null),[O,C]=S.useState(null),[M,B]=S.useState(null),[K,E]=S.useState(null),[q,k]=S.useState(null),[I,ce]=S.useState(null),[J,F]=S.useState(null),[Z,D]=S.useState(null),[W,pe]=S.useState(!1);S.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const ee=Number(s.precio);m(isNaN(ee)?String(s.precio):ee.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function U(ee){return ee?Number(ee.replace(",",".")):NaN}if(S.useEffect(()=>{let ee=!0;async function le(){if(A(null),C(null),B(null),F(null),D(null),!o||!s||!f)return;const fe=U(p);if(!isNaN(fe)){pe(!0);try{const{data:T,error:z}=await re.from("compras_detalle").select("costo_unitario").eq("producto_id",f);if(z)throw z;const P=Array.isArray(T)?T.map(ot=>Number(ot.costo_unitario)).filter(ot=>!isNaN(ot)):[],Q=P.length>0?P.reduce((ot,wn)=>ot+wn,0)/P.length:0;if(!ee)return;A(Q);let se=!1,ae=!1,de=!1;try{const{data:ot,error:wn}=await re.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",f).single();!wn&&ot&&(se=!!ot.exento,ae=!!ot.aplica_impuesto_18,de=!!ot.aplica_impuesto_turistico,K===null&&E(se),q===null&&k(ae),I===null&&ce(de))}catch{}const{data:oe}=await re.from("impuesto").select("id, impuesto_venta"),ge={};Array.isArray(oe)&&oe.forEach(ot=>ge[String(ot.id)]=Number(ot.impuesto_venta));const Re=K!==null?K:se,qe=q!==null?q:ae,Ne=I!==null?I:de;let ke=0;Re?ke=0:qe?ke=ge[2]??ge[1]??0:ke=ge[1]??0;let Je=0;Ne&&(Je=ge[3]??0);const ut=(ke||0)+(Je||0),Nt=ut>1?ut/100:ut,jt=fe*Nt;C(ut),B(jt);const Lt=fe-Q,Nn=Q>0?Lt/Q*100:null;F(Nn);const at=fe>0?(fe-Q-jt)/fe*100:null;D(at)}catch{}finally{ee&&pe(!1)}}}return le(),()=>{ee=!1}},[o,s,f,p,K,q,I]),!o||!s)return null;async function L(){const ee=[];if(f||ee.push("Producto"),p||ee.push("Precio"),ee.length>0){b(`Faltan campos: ${ee.join(", ")}`);return}const le=Number(p);if(isNaN(le)||le<0){b("Precio invlido");return}_(!0),b(null);try{const fe=s.id;await d(fe,{producto_id:f,precio:p});try{const T={};if(K!==null&&(T.exento=K),q!==null&&(T.aplica_impuesto_18=q),I!==null&&(T.aplica_impuesto_turistico=I),Object.keys(T).length>0&&f){const{error:z}=await re.from("inventario").update(T).eq("id",f);z&&console.warn("Error actualizando inventario flags:",z)}}catch(T){console.warn("Error al persistir flags en inventario:",T)}a()}catch(fe){b(fe?.message||String(fe))}finally{_(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:f??"",onChange:ee=>g(ee.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(ee=>r.jsx("option",{value:ee.id,children:ee.nombre},ee.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!K,onChange:ee=>E(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!q,onChange:ee=>k(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!I,onChange:ee=>ce(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:p,onChange:ee=>m(ee.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:M==null?"":M.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:J==null?"":J.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:Z==null?"":Z.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),j&&r.jsx("div",{style:{color:"red",marginTop:12},children:j}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:L,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function Nx(){const[o,a]=S.useState([]),[s,l]=S.useState([]),[u,d]=S.useState(!1),[f,g]=S.useState(null),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[j,b]=S.useState(null);async function w(){d(!0),g(null);try{const{data:E,error:q}=await re.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(q)throw q;a(Array.isArray(E)?E:[])}catch(E){g(E?.message||String(E)),a([])}finally{d(!1)}}async function A(){try{const{data:E}=await re.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),A()},[]);const O=new Set(o.map(E=>String(E.producto_id))),C=s.filter(E=>!O.has(E.id));function M(E){b(E),_(!0),g(null)}async function B(E){d(!0),g(null);try{const{error:q}=await re.from("precios").insert(E);if(q)throw q;try{const k={producto_id:E.producto_id,precio:E.precio},{error:I}=await re.from("precios_historico").insert(k);I&&console.warn("No se pudo insertar en precios_historico",I)}catch(k){console.warn("Error registrando precios_historico",k)}await w()}catch(q){throw g(q?.message||String(q)),q}finally{d(!1)}}async function K(E,q){d(!0),g(null);try{const{error:k}=await re.from("precios").update(q).eq("id",E);if(k)throw k;let I=q.producto_id,ce=q.precio;if(!I||ce===void 0)try{const{data:J}=await re.from("precios").select("producto_id, precio").eq("id",E).limit(1).single();J&&(I=I||J.producto_id,ce=ce===void 0?J.precio:ce)}catch{}try{if(I&&ce!==void 0){const J={producto_id:I,precio:ce},{error:F}=await re.from("precios_historico").insert(J);F&&console.warn("No se pudo insertar en precios_historico",F)}}catch(J){console.warn("Error registrando precios_historico",J)}await w()}catch(k){throw g(k?.message||String(k)),k}finally{d(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{w(),A()},children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),f&&r.jsx("div",{style:{color:"red",marginBottom:12},children:f}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:220},children:s.find(q=>q.id===E.producto_id)?.nombre||E.producto_id}),r.jsx("td",{children:E.precio}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>M(E),children:"Editar"})})]},E.id))})]})}),r.jsx(Ox,{open:p,onClose:()=>m(!1),products:C,onCreate:async E=>{await B(E),m(!1)}}),r.jsx(Rx,{open:v,onClose:()=>{_(!1),b(null)},row:j,products:s,availableProducts:[...s.filter(E=>!O.has(E.id)),...j?s.filter(E=>E.id===j.producto_id):[]],onSave:async(E,q)=>{await K(E,q),_(!1),b(null)}})]})}function kx(){const[o,a]=S.useState(""),[s,l]=S.useState([]),[u,d]=S.useState(null),[f,g]=S.useState([]),[p,m]=S.useState(!1),[v,_]=S.useState(null);async function j(){if(_(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:A}=await re.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(A)throw A;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const O=w[0].id;d(O),await b(O)}}catch(w){_(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),_(null);try{const{data:A,error:O}=await re.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(O)throw O;g(Array.isArray(A)?A:[])}catch(A){_(A?.message||String(A)),g([])}finally{m(!1)}}return S.useEffect(()=>{u&&b(u)},[u]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>j(),children:"Buscar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${f.length} registros`})]}),v&&r.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),r.jsx("ul",{children:s.map(w=>r.jsxs("li",{style:{marginBottom:6},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),r.jsx("strong",{children:w.nombre})," ",r.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Actualizacion"})]})}),r.jsx("tbody",{children:f.map(w=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(w.id)}),r.jsx("td",{style:{minWidth:220},children:s.find(A=>A.id===w.producto_id)?.nombre||w.producto_id}),r.jsx("td",{children:Number(w.precio).toFixed(2)}),r.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function zx(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState({}),[v,_]=S.useState({}),[j,b]=S.useState(!1),[w,A]=S.useState(null);async function O(){b(!0),A(null);try{let C=re.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(C=C.ilike("sku",`%${o}%`)),s&&(C=C.ilike("marca",`%${s}%`)),u&&(C=C.ilike("modelo",`%${u}%`));const{data:M,error:B}=await C.order("nombre",{ascending:!0});if(B)throw B;const K=Array.isArray(M)?M:[];g(K);const E=K.map(J=>J.id);if(E.length===0){m({});return}const{data:q,error:k}=await re.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",E);if(k)throw k;const I=Array.isArray(q)?q:[],ce={};for(const J of K)ce[String(J.id)]=0;for(const J of I){const F=String(J.producto_id),Z=Number(J.cantidad)||0,D=String(J.tipo_de_movimiento||"").toUpperCase();ce.hasOwnProperty(F)||(ce[F]=0),D==="ENTRADA"?ce[F]=(ce[F]||0)+Z:D==="SALIDA"&&(ce[F]=(ce[F]||0)-Z)}for(const J of Object.keys(ce))ce[J]=Number((ce[J]||0).toFixed(2));m(ce);try{const J=(await yn(async()=>{const{default:D}=await Promise.resolve().then(()=>mn);return{default:D}},void 0)).default,F="inventario",Z={};await Promise.all(K.map(async D=>{const W=D.imagen;if(!W){Z[String(D.id)]=null;return}const pe=String(W);if(pe.startsWith("http")){Z[String(D.id)]=pe;return}let U=pe;const L=String(pe).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);L&&(U=decodeURIComponent(L[2]));try{const ee=await J.storage.from(F).getPublicUrl(U),le=ee?.data?.publicUrl||ee?.data?.publicURL||null;if(le){Z[String(D.id)]=le;return}}catch{}try{const le=(await J.storage.from(F).createSignedUrl(U,604800))?.data?.signedUrl??null;Z[String(D.id)]=le}catch{Z[String(D.id)]=null}})),_(Z)}catch{}}catch(C){A(C?.message||String(C)),g([]),m({})}finally{b(!1)}}return S.useEffect(()=>{O()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Stock"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:C=>a(C.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:C=>l(C.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:C=>d(C.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>O(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),O()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:j?"Cargando...":`${f.length} productos`})]}),w&&r.jsx("div",{style:{color:"red",marginBottom:12},children:w}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Imagen"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Marca"}),r.jsx("th",{children:"Modelo"}),r.jsx("th",{children:"Descripcin"}),r.jsx("th",{children:"Stock"})]})}),r.jsx("tbody",{children:f.map(C=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:v[String(C.id)]?r.jsx("img",{src:encodeURI(v[String(C.id)]),alt:C.nombre,style:{width:48,height:48,objectFit:"cover"},onError:M=>{M.currentTarget.src=""}}):C.imagen?r.jsx("img",{src:C.imagen,alt:C.nombre,style:{width:48,height:48,objectFit:"cover"},onError:M=>{M.currentTarget.src=""}}):""}),r.jsx("td",{children:C.sku||""}),r.jsx("td",{children:C.marca||""}),r.jsx("td",{children:C.modelo||""}),r.jsx("td",{style:{maxWidth:320},children:C.descripcion||""}),r.jsx("td",{style:{textAlign:"right"},children:p[String(C.id)]!=null?String(p[String(C.id)]):"0"})]},C.id))})]})]})]})}function Ux(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState([]),[v,_]=S.useState(!1),[j,b]=S.useState([]),[w,A]=S.useState({}),[O,C]=S.useState(!1),[M,B]=S.useState(null);async function K(){C(!0),B(null),b([]);try{let I=null;if(o||s||u){let W=re.from("inventario").select("id").order("nombre",{ascending:!0});o&&(W=W.ilike("sku",`%${o}%`)),s&&(W=W.ilike("marca",`%${s}%`)),u&&(W=W.ilike("categoria",`%${u}%`));const{data:pe,error:U}=await W;if(U)throw U;if(I=Array.isArray(pe)?pe.map(L=>String(L.id)):[],I.length===0){b([]),A({}),C(!1);return}}let ce=re.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(I&&(ce=ce.in("producto_id",I)),v){const W=new Date(Date.now()-864e5).toISOString();ce=ce.gte("fecha_salida",W)}ce=ce.order("fecha_salida",{ascending:!1});const{data:J,error:F}=await ce;if(F)throw F;const Z=Array.isArray(J)?J.map(W=>({id:W.id,producto_id:String(W.producto_id),cantidad:Number(W.cantidad),tipo_de_movimiento:W.tipo_de_movimiento,referencia:W.referencia,usuario:W.usuario,fecha_salida:W.fecha_salida})):[];b(Z);const D=Array.from(new Set(Z.map(W=>W.producto_id))).filter(Boolean);if(D.length>0){const{data:W}=await re.from("inventario").select("id, nombre, sku, marca, categoria").in("id",D),pe={};Array.isArray(W)&&W.forEach(U=>{pe[String(U.id)]={id:U.id,nombre:U.nombre,sku:U.sku,marca:U.marca,categoria:U.categoria}}),A(pe)}else A({})}catch(I){B(I?.message||String(I)),b([])}finally{C(!1)}}async function E(){try{const{data:I,error:ce}=await re.from("inventario").select("marca, categoria");if(ce)throw ce;const J=new Set,F=new Set;Array.isArray(I)&&I.forEach(Z=>{Z.marca&&J.add(String(Z.marca)),Z.categoria&&F.add(String(Z.categoria))}),g(Array.from(J).sort()),m(Array.from(F).sort())}catch(I){console.warn("Error loading filter options",I)}}S.useEffect(()=>{K(),E()},[]);const q=j.filter(I=>String(I.tipo_de_movimiento).toUpperCase()==="ENTRADA"),k=j.filter(I=>String(I.tipo_de_movimiento).toUpperCase()==="SALIDA");return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:I=>a(I.target.value)}),r.jsxs("select",{className:"input",value:s,onChange:I=>l(I.target.value),children:[r.jsx("option",{value:"",children:"-- Marca (todas) --"}),f.map(I=>r.jsx("option",{value:I,children:I},I))]}),r.jsxs("select",{className:"input",value:u,onChange:I=>d(I.target.value),children:[r.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(I=>r.jsx("option",{value:I,children:I},I))]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:v,onChange:I=>_(I.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),_(!1),K()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:O?"Cargando...":`${j.length} registros`})]}),M&&r.jsx("div",{style:{color:"red",marginBottom:12},children:M}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Entradas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:q.map(I=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(I.id)}),r.jsx("td",{style:{minWidth:120},children:w[I.producto_id]?.sku||I.producto_id}),r.jsx("td",{children:w[I.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(I.cantidad).toFixed(2)}),r.jsx("td",{children:I.referencia||""}),r.jsx("td",{children:I.usuario||""}),r.jsx("td",{children:I.fecha_salida||""})]},String(I.id)))})]})]}),r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Salidas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:k.map(I=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(I.id)}),r.jsx("td",{style:{minWidth:120},children:w[I.producto_id]?.sku||I.producto_id}),r.jsx("td",{children:w[I.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(I.cantidad).toFixed(2)}),r.jsx("td",{children:I.referencia||""}),r.jsx("td",{children:I.usuario||""}),r.jsx("td",{children:I.fecha_salida||""})]},String(I.id)))})]})]})]})]})}function Dx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),r.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function Bx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),r.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function Mx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function qx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function Lx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function Hx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function Ix(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function Vx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),r.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function $x(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),r.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function Gx(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),r.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function Px(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),r.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function Kx({open:o,onClose:a,onCreate:s}){const[l,u]=S.useState(""),[d,f]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,j]=S.useState(""),[b,w]=S.useState(""),[A,O]=S.useState(!0),[C,M]=S.useState(!1),[B,K]=S.useState(null);if(!o)return null;async function E(){const q=[];if(l.trim()||q.push("Nombre"),q.length){K(`Faltan campos: ${q.join(", ")}`);return}M(!0),K(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:b||void 0,activo:A}),u(""),f(""),p(""),v(""),j(""),w(""),O(!0),a()}catch(k){K(k?.message||String(k))}finally{M(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:l,onChange:q=>u(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:d,onChange:q=>f(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:g,onChange:q=>p(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:m,onChange:q=>v(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:_,onChange:q=>j(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:b,onChange:q=>w(q.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:A,onChange:q=>O(q.target.checked)})," ","Activo"]})]}),B&&r.jsx("div",{style:{color:"red",marginTop:12},children:B}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:C,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:E,disabled:C,style:{width:"auto",padding:"8px 14px"},children:C?"Creando...":"Crear"})]})]})})}function Yx({open:o,onClose:a,row:s,onSave:l}){const[u,d]=S.useState(""),[f,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[j,b]=S.useState(""),[w,A]=S.useState(""),[O,C]=S.useState(!0),[M,B]=S.useState(!1),[K,E]=S.useState(null);if(S.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),_(s.correo||""),b(s.direccion||""),A(s.tipo_proveedor||""),C(s.activo??!0),E(null))},[o,s]),!o||!s)return null;async function q(){if(!s){E("No hay fila seleccionada");return}const k=[];if(u.trim()||k.push("Nombre"),k.length){E(`Faltan campos: ${k.join(", ")}`);return}B(!0),E(null);try{await l(s.id,{nombre:u.trim(),rtn:f.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:j.trim()||void 0,tipo_proveedor:w||void 0,activo:O}),a()}catch(I){E(I?.message||String(I))}finally{B(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:u,onChange:k=>d(k.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:f,onChange:k=>g(k.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:p,onChange:k=>m(k.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:v,onChange:k=>_(k.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:j,onChange:k=>b(k.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:w,onChange:k=>A(k.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:O,onChange:k=>C(k.target.checked)})," ","Activo"]})]}),K&&r.jsx("div",{style:{color:"red",marginTop:12},children:K}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:M,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:q,disabled:M,style:{width:"auto",padding:"8px 14px"},children:M?"Guardando...":"Guardar"})]})]})})}function Jx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(""),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,A]=S.useState(!1),[O,C]=S.useState(null);async function M(q){l(!0),d(null);try{let k=null,I=null;if(q&&q.trim()){const J=`%${q.trim()}%`,F=await re.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${J},rtn.ilike.${J}`).order("id",{ascending:!0});k=F.data,I=F.error}else{const ce=await re.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});k=ce.data,I=ce.error}if(I)throw I;a(Array.isArray(k)?k:[])}catch(k){d(k?.message||String(k)),a([])}finally{l(!1)}}S.useEffect(()=>{M()},[]),S.useEffect(()=>{const q=setTimeout(()=>{M(f)},350);return()=>clearTimeout(q)},[f]);async function B(q){l(!0),d(null);try{const k={...q};if(delete k.id,k.rtn){const{data:ce,error:J}=await re.from("proveedores").select("id, nombre").eq("rtn",k.rtn).limit(1);if(J)throw J;if(Array.isArray(ce)&&ce.length>0)throw new Error(`Ya existe un proveedor con RTN ${k.rtn}`)}const{error:I}=await re.from("proveedores").insert(k);if(I)throw I;await M()}catch(k){throw String(k).includes("Ya existe un proveedor")?d(String(k)):k?.code==="23505"||String(k).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(k?.message||String(k)),k}finally{l(!1)}}async function K(q,k){l(!0),d(null);try{const{error:I}=await re.from("proveedores").update(k).eq("id",q);if(I)throw I;await M()}catch(I){throw d(I?.message||String(I)),I}finally{l(!1)}}async function E(){if(O){l(!0),d(null);try{const{error:q}=await re.from("proveedores").delete().eq("id",O.id);if(q)throw q;A(!1),C(null),await M()}catch(q){d(q?.message||String(q))}finally{l(!1)}}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>M(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),r.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:f,onChange:q=>g(q.target.value),style:{width:260}}),r.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),M()},children:"Limpiar"})]}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"RTN"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Telfono"}),r.jsx("th",{children:"Correo"}),r.jsx("th",{children:"Direccin"}),r.jsx("th",{children:"Tipo"}),r.jsx("th",{children:"Activo"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(q=>r.jsxs("tr",{children:[r.jsx("td",{children:q.rtn||""}),r.jsx("td",{style:{minWidth:180},children:q.nombre}),r.jsx("td",{children:q.telefono||""}),r.jsx("td",{children:q.correo||""}),r.jsx("td",{children:q.direccion||""}),r.jsx("td",{children:q.tipo_proveedor||""}),r.jsx("td",{children:q.activo?"S":"No"}),r.jsxs("td",{style:{whiteSpace:"nowrap"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{b(q),_(!0)},children:"Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>{C(q),A(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},q.id))})]})}),r.jsx(Kx,{open:p,onClose:()=>m(!1),onCreate:async q=>{await B(q),m(!1)}}),r.jsx(Yx,{open:v,onClose:()=>{_(!1),b(null)},row:j,onSave:async(q,k)=>{await K(q,k),_(!1),b(null)}}),r.jsx(em,{open:w,title:O?`Eliminar proveedor ${O.nombre}`:"Eliminar proveedor",message:O?`Confirma eliminar al proveedor ${O.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await E()},onCancel:()=>{A(!1),C(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function Qx({open:o,onClose:a,onCreated:s}){const[l,u]=S.useState([]),[d,f]=S.useState([]),[g,p]=S.useState(0),[m,v]=S.useState(null),[_,j]=S.useState(""),[b,w]=S.useState("factura"),[A,O]=S.useState([]),[C,M]=S.useState(null),[B,K]=S.useState(1),[E,q]=S.useState(null),[k,I]=S.useState(!1),[ce,J]=S.useState(null);if(S.useEffect(()=>{o&&(async()=>{try{const L=await re.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(L.data)?L.data:[])}catch{}try{const L=await re.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});f(Array.isArray(L.data)?L.data:[])}catch{}try{const L=await re.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),ee=Array.isArray(L.data)&&L.data.length>0?L.data[0]:null,le=ee?Number(ee.impuesto_venta):0;p(le)}catch{}})()},[o]),!o)return null;function F(){v(null),j(""),w("factura"),O([]),M(null),K(1),q(null),J(null)}function Z(){if(!C){J("Selecciona un producto");return}if(!E||E<=0){J("Costo unitario invlido");return}if(!B||B<=0){J("Cantidad invlida");return}const L=l.find(le=>le.id===C),ee=le=>{if(le==null)return!1;if(typeof le=="boolean")return le===!0;if(typeof le=="number")return le===1;const fe=String(le).toLowerCase().trim();return fe==="1"||fe==="true"||fe==="t"||fe==="si"||fe==="s"||fe==="yes"};O(le=>[...le,{producto_id:C,nombre:L?.nombre||"",cantidad:B,costo_unitario:E,exento:ee(L?.exento)}]),M(null),K(1),q(null),J(null)}function D(L){O(ee=>ee.filter((le,fe)=>fe!==L))}function W(){const L=g,ee=L>1?L/100:L;let le=0,fe=0,T=0;for(const z of A){const P=z.cantidad*z.costo_unitario;let Q=0,se=P;z.exento||(Q=P*ee,se=P-Q),le+=se,fe+=Q,T+=P}return{subtotal:le,impuesto:fe,total:T}}async function pe(){if(J(null),!m){J("Selecciona un proveedor");return}if(A.length===0){J("Agrega al menos un producto");return}I(!0);try{const{subtotal:L,impuesto:ee,total:le}=W(),fe={proveedor_id:m,numero_documento:_||null,tipo_documento:b||null,subtotal:L,impuesto:ee,total:le,usuario:null},T=await re.from("compras").insert(fe).select("id").single();if(T.error)throw T.error;const z=T.data.id,P=A.map(se=>({compra_id:z,producto_id:se.producto_id,cantidad:se.cantidad,costo_unitario:se.costo_unitario})),Q=await re.from("compras_detalle").insert(P);if(Q.error)throw await re.from("compras").delete().eq("id",z),Q.error;try{const se=_?`Compra - ${_}`:`Compra ${z}`;let ae="sistema";try{const Re=localStorage.getItem("user");if(Re){const qe=JSON.parse(Re);ae=qe.username?`${qe.username}${qe.role?` (${qe.role})`:""}`:String(qe)}}catch{}const de=new Date().toISOString(),oe=A.map(Re=>({producto_id:Re.producto_id,cantidad:Re.cantidad,tipo_de_movimiento:"ENTRADA",referencia:se,usuario:ae,fecha_salida:de})),ge=await re.from("registro_de_inventario").insert(oe);ge.error&&(console.warn("Error registrando en registro_de_inventario",ge.error),J("Compra guardada, pero fall el registro en inventario: "+ge.error.message))}catch(se){console.warn("Registro inventario fallo",se)}F(),a(),s&&s()}catch(L){J(L?.message||String(L))}finally{I(!1)}}const U=W();return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),r.jsxs("select",{className:"input",value:m??"",onChange:L=>v(L.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(L=>r.jsx("option",{value:L.id,children:L.nombre},String(L.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),r.jsx("input",{className:"input",value:_,onChange:L=>j(L.target.value)}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),r.jsx("input",{className:"input",value:b,onChange:L=>w(L.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:C??"",onChange:L=>M(L.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(L=>r.jsx("option",{value:L.id,children:L.nombre},L.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:L=>K(Number(L.target.value))}),r.jsx("input",{className:"input",type:"number",style:{width:120},value:E??"",onChange:L=>q(Number(L.target.value)),placeholder:"Costo unitario"}),r.jsx("button",{className:"btn-primary",onClick:Z,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:A.map((L,ee)=>{const le=L.cantidad*L.costo_unitario,fe=g>1?g/100:g,T=L.exento?0:le*fe,z=L.exento?le:le-T;return r.jsxs("tr",{children:[r.jsx("td",{children:L.nombre}),r.jsx("td",{children:L.cantidad}),r.jsx("td",{children:L.costo_unitario.toFixed(2)}),r.jsx("td",{children:T.toFixed(2)}),r.jsx("td",{children:z.toFixed(2)}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>D(ee),children:"Quitar"})})]},`${L.producto_id}-${ee}`)})})]})})]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:["Subtotal: ",r.jsx("strong",{children:U.subtotal.toFixed(2)})]}),r.jsxs("div",{children:["Impuesto: ",r.jsx("strong",{children:U.impuesto.toFixed(2)})]}),r.jsxs("div",{children:["Total: ",r.jsx("strong",{children:U.total.toFixed(2)})]})]})}),ce&&r.jsx("div",{style:{color:"red",marginTop:12},children:ce}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{F(),a()},disabled:k,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:pe,disabled:k,children:k?"Guardando...":"Confirmar compra"})]})]})})}function Xx({open:o,compraId:a,onClose:s}){const[l,u]=S.useState([]),[d,f]=S.useState({}),[g,p]=S.useState({}),[m,v]=S.useState(0),[_,j]=S.useState(!1);return S.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{j(!0);try{const{data:w,error:A}=await re.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(A)throw A;const O=Array.isArray(w)?w:[];if(!b)return;u(O);const C=Array.from(new Set(O.map(M=>M.producto_id))).filter(Boolean);if(C.length>0){const{data:M}=await re.from("inventario").select("id, nombre, exento").in("id",C),B={},K={};Array.isArray(M)&&M.forEach(E=>{B[String(E.id)]={id:E.id,nombre:E.nombre},K[String(E.id)]=E.exento===!0||E.exento===1||String(E.exento).toLowerCase()==="true"}),b&&(f(B),p(K))}else f({});try{const{data:M}=await re.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),B=Array.isArray(M)&&M.length>0?M[0]:null,K=B?Number(B.impuesto_venta):0;b&&v(K)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&j(!1)}})(),()=>{b=!1}},[o,a]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),r.jsx("div",{style:{marginTop:8},children:_?r.jsx("div",{children:"Cargando..."}):r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),A=Number(b.costo_unitario),O=w*A,C=m>1?m/100:m,M=g[String(b.producto_id)]===!0,B=M?0:O*C,K=M?O:O-B;return r.jsxs("tr",{children:[r.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),r.jsx("td",{children:w.toFixed(2)}),r.jsx("td",{children:A.toFixed(2)}),r.jsx("td",{children:B.toFixed(2)}),r.jsx("td",{children:K.toFixed(2)}),r.jsx("td",{children:O.toFixed(2)})]},String(b.id))})}),r.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,A)=>{const O=Number(A.cantidad),C=Number(A.costo_unitario),M=O*C,B=m>1?m/100:m,K=g[String(A.producto_id)]===!0,E=K?0:M*B,q=K?M:M-E;return w.subtotal+=q,w.impuesto+=E,w.total+=M,w},{subtotal:0,impuesto:0,total:0});return r.jsxs("tr",{children:[r.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),r.jsx("td",{children:b.impuesto.toFixed(2)}),r.jsx("td",{children:b.subtotal.toFixed(2)}),r.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function Fx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(!1),[p,m]=S.useState(!1),[v,_]=S.useState(null),[j,b]=S.useState([]),[w,A]=S.useState(""),[O,C]=S.useState(""),[M,B]=S.useState(!1);async function K(){l(!0),d(null);try{let E=re.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const I=Number(w);isNaN(I)?E=E.eq("proveedor_id",w):E=E.eq("proveedor_id",I)}if(O&&(E=E.ilike("numero_documento",`%${O}%`)),M){const I=new Date(Date.now()-864e5).toISOString();E=E.gte("fecha_compra",I)}const{data:q,error:k}=await E.order("id",{ascending:!1});if(k)throw k;a(Array.isArray(q)?q:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}return S.useEffect(()=>{K()},[]),S.useEffect(()=>{let E=!0;return(async()=>{try{const{data:q}=await re.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!E)return;b(Array.isArray(q)?q:[])}catch{}})(),()=>{E=!1}},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:w,onChange:E=>A(E.target.value),children:[r.jsx("option",{value:"",children:"-- proveedor (todos) --"}),j.map(E=>r.jsx("option",{value:String(E.id),children:E.nombre},String(E.id)))]}),r.jsx("input",{className:"input",placeholder:"Nmero documento",value:O,onChange:E=>C(E.target.value)}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:M,onChange:E=>B(E.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{A(""),C(""),B(!1),K()},children:"Limpiar"})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),r.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(E.id)}),r.jsx("td",{children:String(E.proveedor_id)}),r.jsx("td",{children:E.numero_documento||""}),r.jsx("td",{children:E.fecha_compra||""}),r.jsx("td",{children:E.subtotal||""}),r.jsx("td",{children:E.impuesto||""}),r.jsx("td",{children:E.total||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{_(E.id),m(!0)},children:"Detalle"})})]},String(E.id)))})]})}),r.jsx(Qx,{open:f,onClose:()=>g(!1),onCreated:()=>{g(!1),K()}}),r.jsx(Xx,{open:p,compraId:v,onClose:()=>{m(!1),_(null)}})]})}function Zx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(!1),[p,m]=S.useState(null);async function v(){l(!0),d(null);try{const{data:_,error:j}=await re.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(j)throw j;a(Array.isArray(_)?_.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(_){d(_?.message||String(_)),a([])}finally{l(!1)}}return S.useEffect(()=>{v()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),r.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(_=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(_.id)}),r.jsx("td",{children:String(_.proveedor_id||"")}),r.jsx("td",{children:_.numero_documento||""}),r.jsx("td",{children:_.usuario||""}),r.jsx("td",{children:_.fecha||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>m(_.id),children:"Detalle"})})]},String(_.id)))})]})}),f&&r.jsx(Wx,{onClose:()=>{g(!1),v()}}),p&&r.jsx(e_,{id:p,onClose:()=>{m(null),v()}})]})}function Wx({onClose:o}){const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,f]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(null),[_,j]=S.useState(null),[b,w]=S.useState(""),[A,O]=S.useState([]),[C,M]=S.useState(null),[B,K]=S.useState(1),[E,q]=S.useState(!1),[k,I]=S.useState(null);S.useEffect(()=>{(async()=>{try{const D=await re.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(D.data)?D.data:[])}catch{}try{const D=await re.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(D.data)?D.data:[])}catch{}})()},[]);async function ce(){if(b){I(null);try{const{data:D,error:W}=await re.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(W)throw W;if(!D){I("No se encontr compra con ese nmero de documento");return}f(D.id),v(D.proveedor_id);try{const{data:Q}=await re.from("proveedores").select("id, nombre").eq("id",D.proveedor_id).limit(1).single();Q&&Q.nombre&&j(Q.nombre)}catch{}const{data:pe}=await re.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",D.id),U=Array.isArray(pe)?pe:[],{data:L}=await re.from("devoluciones_proveedores").select("id").eq("numero_documento",b),ee=Array.isArray(L)?L.map(Q=>Q.id):[];let le={};if(ee.length>0){const{data:Q}=await re.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",ee);Array.isArray(Q)&&Q.forEach(se=>{const ae=String(se.producto_id);le[ae]=(le[ae]||0)+Number(se.cantidad)})}const fe=U.map(Q=>Q.producto_id),{data:T}=await re.from("inventario").select("id, nombre, sku").in("id",fe),z={};Array.isArray(T)&&T.forEach(Q=>{z[String(Q.id)]=Q});const P=U.map(Q=>{const se=String(Q.producto_id),ae=Number(Q.cantidad),de=le[se]||0,oe=Math.max(0,ae-de);return{producto_id:se,nombre:z[se]?.nombre||se,sku:z[se]?.sku,purchased:ae,returned:de,available:oe,costo_unitario:Number(Q.costo_unitario||0)}});p(P),u(P.map(Q=>({id:Q.producto_id,nombre:Q.nombre,sku:Q.sku})))}catch(D){I(D?.message||String(D))}}}function J(){if(!C){I("Selecciona un producto");return}if(!B||B<=0){I("Cantidad invlida");return}const D=l.find(pe=>pe.id===C),W=g.find(pe=>pe.producto_id===C);if(W&&B>W.available){I(`Cantidad excede disponible para devolucin (${W.available})`);return}O(pe=>[...pe,{producto_id:C,nombre:D?.nombre,cantidad:B}]),M(null),K(1),I(null),W&&(p(pe=>pe.map(U=>U.producto_id===W.producto_id?{...U,available:Math.max(0,U.available-B)}:U)),u(pe=>pe.map(U=>(U.id===W.producto_id,U))))}function F(D){O(W=>W.filter((pe,U)=>U!==D))}async function Z(){if(I(null),!m){I("Selecciona un proveedor");return}if(A.length===0){I("Agrega al menos un producto");return}q(!0);try{const D={proveedor_id:m,numero_documento:b||null,usuario:null},W=await re.from("devoluciones_proveedores").insert(D).select("id").single();if(W.error)throw W.error;const pe=W.data.id;try{const U=A.map(ee=>({devolucion_id:pe,producto_id:ee.producto_id,cantidad:ee.cantidad})),L=await re.from("devoluciones_proveedores_detalle").insert(U);L.error&&console.warn("No se pudo insertar detalles de devolucin",L.error)}catch(U){console.warn("Detalles tabla puede no existir",U)}try{const U=b?`Devolucin - ${b}`:`Devolucin ${pe}`;let L="sistema";try{const T=localStorage.getItem("user");if(T){const z=JSON.parse(T);L=z.username?`${z.username}${z.role?` (${z.role})`:""}`:String(z)}}catch{}const ee=new Date().toISOString(),le=A.map(T=>({producto_id:T.producto_id,cantidad:T.cantidad,tipo_de_movimiento:"SALIDA",referencia:U,usuario:L,fecha_salida:ee})),fe=await re.from("registro_de_inventario").insert(le);fe.error&&(console.warn("Error registrando en registro_de_inventario",fe.error),I("Devolucin guardada, pero fall el registro en inventario: "+fe.error.message))}catch(U){console.warn("Registro inventario fallo",U)}o()}catch(D){I(D?.message||String(D))}finally{q(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?r.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:_||String(m||"")}):r.jsxs("select",{className:"input",value:m??"",onChange:D=>v(D.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(D=>r.jsx("option",{value:D.id,children:D.nombre},String(D.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{className:"input",value:b,onChange:D=>w(D.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>ce(),children:"Buscar compra"})]}),d&&r.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&r.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[r.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[r.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Comprado"}),r.jsx("th",{children:"Devuelto"}),r.jsx("th",{children:"Disponible"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:g.map(D=>r.jsxs("tr",{children:[r.jsx("td",{children:D.nombre}),r.jsx("td",{style:{textAlign:"right"},children:Number(D.purchased).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(D.returned).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(D.available).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>{M(D.producto_id),K(D.available||1)},children:"Usar"})})]},D.producto_id))})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:C??"",onChange:D=>M(D.target.value||null),disabled:!!d,children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(D=>r.jsx("option",{value:D.id,children:D.nombre},D.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:D=>{const W=Number(D.target.value),pe=g.find(U=>U.producto_id===C);if(pe){const U=Number(pe.available||0);return isNaN(W)||W<1?K(1):W>U?K(U):K(W)}K(W)},min:1,max:C?g.find(D=>D.producto_id===C)?.available??void 0:void 0,disabled:(()=>{const D=g.find(W=>W.producto_id===C);return!!D&&Number(D.available||0)<=1})()}),r.jsx("button",{className:"btn-primary",onClick:J,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:A.map((D,W)=>r.jsxs("tr",{children:[r.jsx("td",{children:D.nombre}),r.jsx("td",{style:{textAlign:"right"},children:D.cantidad}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>F(W),children:"Quitar"})})]},`${D.producto_id}-${W}`))})]})})]})]}),k&&r.jsx("div",{style:{color:"red",marginTop:12},children:k}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:o,disabled:E,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:Z,disabled:E,children:E?"Guardando...":"Registrar devolucin"})]})]})})}function e_({id:o,onClose:a}){const[s,l]=S.useState([]),[u,d]=S.useState(!1),[f,g]=S.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await re.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const _=Array.isArray(m)?m:[];if(_.length>0){const j=_.map(A=>A.producto_id),{data:b}=await re.from("inventario").select("id, nombre, sku").in("id",j),w={};Array.isArray(b)&&b.forEach(A=>{w[String(A.id)]=A}),l(_.map(A=>({producto:w[String(A.producto_id)]?.nombre||String(A.producto_id),cantidad:A.cantidad})))}else{const{data:j}=await re.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(j)?j:[],w=b.map(C=>C.producto_id),{data:A}=await re.from("inventario").select("id, nombre, sku").in("id",w),O={};Array.isArray(A)&&A.forEach(C=>{O[String(C.id)]=C}),l(b.map(C=>({producto:O[String(C.producto_id)]?.nombre||String(C.producto_id),cantidad:C.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return S.useEffect(()=>{p()},[o]),r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&r.jsx("div",{children:"Cargando..."}),f&&r.jsx("div",{style:{color:"red"},children:f}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"})]})}),r.jsx("tbody",{children:s.map((m,v)=>r.jsxs("tr",{children:[r.jsx("td",{children:m.producto}),r.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const t_={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function n_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,m]=S.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await re.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};S.useEffect(()=>{v()},[]);const _=(b,w)=>{a(A=>A.map(O=>O.id===b?{...O,impuesto_venta:w}:O))},j=async b=>{const w=o.find(A=>A.id===b);if(w){d(b),m(null);try{const A={impuesto_venta:w.impuesto_venta??null},{error:O}=await re.from("impuesto").update(A).eq("id",b);if(O)throw O;await v()}catch(A){console.warn("Error guardando impuesto:",A),m(String(A.message||A))}finally{d(null)}}};return r.jsxs("div",{children:[r.jsx("h2",{children:"Impuestos"}),r.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?r.jsx("div",{children:"Cargando..."}):r.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>r.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8},children:t_[b.id]??`Impuesto #${b.id}`}),r.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),r.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>_(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:f!==b.id}),r.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:f===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[r.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),r.jsx("div",{style:{display:"flex",gap:8},children:f===b.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:()=>j(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):r.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&r.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&r.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const a_={dashboard:hx,datos:px,usuarios_internal:yx,usuarios_web:mx,cai:xx,facturas:_x,historial_facturas:jx,inventario_productos:Ax,precios_productos:Nx,precios_historico:kx,stock:zx,inventario_salidas:Ux,inventario_categorias:Dx,proveedores:Jx,caja_sesiones:Bx,caja_movimientos:Mx,rep_ventas:qx,rep_devoluciones:Lx,rep_ingresos_egresos:Hx,rep_compras:Ix,compras_main:Fx,devoluciones_proveedores:Zx,rep_export:Vx,cuentas_contables:$x,libro_diario:Gx,auditoria:Px,impuestos:n_};function i_({onLogout:o}){const[a,s]=S.useState("dashboard"),[l,u]=S.useState(null),[d,f]=S.useState({}),g=l||a,p=a_[g],v=(j=>{for(const b of np){if(b.id===j)return b.label;if(b.children){const w=b.children.find(A=>A.id===j);if(w)return w.label}}return"Panel de Administracin"})(g),_=j=>{if(j.id==="salir")return o();j.children&&j.children.length>0?(f(b=>({...b,[j.id]:!b[j.id]})),(j.id!==a||!l)&&(s(j.id),u(j.children[0].id))):(s(j.id),u(null))};return r.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[r.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[r.jsx("strong",{children:"Panel Admin"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),r.jsx("nav",{children:np.map(j=>r.jsxs("div",{style:{marginBottom:6},children:[r.jsxs("div",{onClick:()=>_(j),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===j.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[r.jsx("span",{children:j.label}),Array.isArray(j.children)&&j.children.length>0?r.jsx("span",{style:{marginLeft:8},children:d[j.id]?"":""}):null]}),Array.isArray(j.children)&&j.children.length>0&&d[j.id]&&r.jsx("div",{style:{marginLeft:12,marginTop:6},children:j.children.map(b=>r.jsx("div",{onClick:()=>{s(j.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},j.id))})]}),r.jsx("main",{style:{flex:1,padding:24},children:p?r.jsx(p,{}):r.jsx(dx,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function r_(){const[o,a]=S.useState(null);S.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return r.jsxs("div",{children:[!o&&r.jsx($0,{onLogin:s}),o&&o.role==="cajero"&&r.jsx(sx,{onLogout:l}),o&&o.role==="admin"&&r.jsx(i_,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&r.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[r.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),r.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',r.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),r.jsx("div",{style:{marginTop:18},children:r.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class s_ extends sp.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[r.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}xv.createRoot(document.getElementById("root")).render(r.jsx(s_,{children:r.jsx(r_,{})}));
