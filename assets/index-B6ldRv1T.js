function uv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function op(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function dv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var Zc={exports:{}},Wr={};var xg;function hv(){if(xg)return Wr;xg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var f=null;if(d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:f,ref:u!==void 0?u:null,props:d}}return Wr.Fragment=a,Wr.jsx=s,Wr.jsxs=s,Wr}var jg;function fv(){return jg||(jg=1,Zc.exports=hv()),Zc.exports}var r=fv(),Wc={exports:{}},es={},eu={exports:{}},tu={};var Sg;function gv(){return Sg||(Sg=1,(function(o){function a(C,z){var X=C.length;C.push(z);e:for(;0<X;){var ue=X-1>>>1,fe=C[ue];if(0<u(fe,z))C[ue]=z,C[X]=fe,X=ue;else break e}}function s(C){return C.length===0?null:C[0]}function l(C){if(C.length===0)return null;var z=C[0],X=C.pop();if(X!==z){C[0]=X;e:for(var ue=0,fe=C.length,A=fe>>>1;ue<A;){var U=2*(ue+1)-1,$=C[U],F=U+1,re=C[F];if(0>u($,X))F<fe&&0>u(re,$)?(C[ue]=re,C[F]=X,ue=F):(C[ue]=$,C[U]=X,ue=U);else if(F<fe&&0>u(re,X))C[ue]=re,C[F]=X,ue=F;else break e}}return z}function u(C,z){var X=C.sortIndex-z.sortIndex;return X!==0?X:C.id-z.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var f=Date,g=f.now();o.unstable_now=function(){return f.now()-g}}var p=[],m=[],v=1,_=null,j=3,b=!1,w=!1,N=!1,O=!1,T=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function K(C){for(var z=s(m);z!==null;){if(z.callback===null)l(m);else if(z.startTime<=C)l(m),z.sortIndex=z.expirationTime,a(p,z);else break;z=s(m)}}function E(C){if(N=!1,K(C),!w)if(s(p)!==null)w=!0,q||(q=!0,ye());else{var z=s(m);z!==null&&ie(E,z.startTime-C)}}var q=!1,D=-1,V=5,ge=-1;function J(){return O?!0:!(o.unstable_now()-ge<V)}function ce(){if(O=!1,q){var C=o.unstable_now();ge=C;var z=!0;try{e:{w=!1,N&&(N=!1,I(D),D=-1),b=!0;var X=j;try{t:{for(K(C),_=s(p);_!==null&&!(_.expirationTime>C&&J());){var ue=_.callback;if(typeof ue=="function"){_.callback=null,j=_.priorityLevel;var fe=ue(_.expirationTime<=C);if(C=o.unstable_now(),typeof fe=="function"){_.callback=fe,K(C),z=!0;break t}_===s(p)&&l(p),K(C)}else l(p);_=s(p)}if(_!==null)z=!0;else{var A=s(m);A!==null&&ie(E,A.startTime-C),z=!1}}break e}finally{_=null,j=X,b=!1}z=void 0}}finally{z?ye():q=!1}}}var ye;if(typeof M=="function")ye=function(){M(ce)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,Z=B.port2;B.port1.onmessage=ce,ye=function(){Z.postMessage(null)}}else ye=function(){T(ce,0)};function ie(C,z){D=T(function(){C(o.unstable_now())},z)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(C){C.callback=null},o.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<C?Math.floor(1e3/C):5},o.unstable_getCurrentPriorityLevel=function(){return j},o.unstable_next=function(C){switch(j){case 1:case 2:case 3:var z=3;break;default:z=j}var X=j;j=z;try{return C()}finally{j=X}},o.unstable_requestPaint=function(){O=!0},o.unstable_runWithPriority=function(C,z){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var X=j;j=C;try{return z()}finally{j=X}},o.unstable_scheduleCallback=function(C,z,X){var ue=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ue+X:ue):X=ue,C){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=X+fe,C={id:v++,callback:z,priorityLevel:C,startTime:X,expirationTime:fe,sortIndex:-1},X>ue?(C.sortIndex=X,a(m,C),s(p)===null&&C===s(m)&&(N?(I(D),D=-1):N=!0,ie(E,X-ue))):(C.sortIndex=fe,a(p,C),w||b||(w=!0,q||(q=!0,ye()))),C},o.unstable_shouldYield=J,o.unstable_wrapCallback=function(C){var z=j;return function(){var X=j;j=z;try{return C.apply(this,arguments)}finally{j=X}}}})(tu)),tu}var wg;function pv(){return wg||(wg=1,eu.exports=gv()),eu.exports}var nu={exports:{}},ke={};var Eg;function mv(){if(Eg)return ke;Eg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),j=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=j&&A[j]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,O={};function T(A,U,$){this.props=A,this.context=U,this.refs=O,this.updater=$||w}T.prototype.isReactComponent={},T.prototype.setState=function(A,U){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,U,"setState")},T.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function I(){}I.prototype=T.prototype;function M(A,U,$){this.props=A,this.context=U,this.refs=O,this.updater=$||w}var K=M.prototype=new I;K.constructor=M,N(K,T.prototype),K.isPureReactComponent=!0;var E=Array.isArray;function q(){}var D={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function ge(A,U,$){var F=$.ref;return{$$typeof:o,type:A,key:U,ref:F!==void 0?F:null,props:$}}function J(A,U){return ge(A.type,U,A.props)}function ce(A){return typeof A=="object"&&A!==null&&A.$$typeof===o}function ye(A){var U={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function($){return U[$]})}var B=/\/+/g;function Z(A,U){return typeof A=="object"&&A!==null&&A.key!=null?ye(""+A.key):U.toString(36)}function ie(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(q,q):(A.status="pending",A.then(function(U){A.status==="pending"&&(A.status="fulfilled",A.value=U)},function(U){A.status==="pending"&&(A.status="rejected",A.reason=U)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function C(A,U,$,F,re){var ne=typeof A;(ne==="undefined"||ne==="boolean")&&(A=null);var pe=!1;if(A===null)pe=!0;else switch(ne){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(A.$$typeof){case o:case a:pe=!0;break;case v:return pe=A._init,C(pe(A._payload),U,$,F,re)}}if(pe)return re=re(A),pe=F===""?"."+Z(A,0):F,E(re)?($="",pe!=null&&($=pe.replace(B,"$&/")+"/"),C(re,U,$,"",function(ze){return ze})):re!=null&&(ce(re)&&(re=J(re,$+(re.key==null||A&&A.key===re.key?"":(""+re.key).replace(B,"$&/")+"/")+pe)),U.push(re)),1;pe=0;var he=F===""?".":F+":";if(E(A))for(var xe=0;xe<A.length;xe++)F=A[xe],ne=he+Z(F,xe),pe+=C(F,U,$,ne,re);else if(xe=b(A),typeof xe=="function")for(A=xe.call(A),xe=0;!(F=A.next()).done;)F=F.value,ne=he+Z(F,xe++),pe+=C(F,U,$,ne,re);else if(ne==="object"){if(typeof A.then=="function")return C(ie(A),U,$,F,re);throw U=String(A),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return pe}function z(A,U,$){if(A==null)return A;var F=[],re=0;return C(A,F,"","",function(ne){return U.call($,ne,re++)}),F}function X(A){if(A._status===-1){var U=A._result;U=U(),U.then(function($){(A._status===0||A._status===-1)&&(A._status=1,A._result=$)},function($){(A._status===0||A._status===-1)&&(A._status=2,A._result=$)}),A._status===-1&&(A._status=0,A._result=U)}if(A._status===1)return A._result.default;throw A._result}var ue=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},fe={map:z,forEach:function(A,U,$){z(A,function(){U.apply(this,arguments)},$)},count:function(A){var U=0;return z(A,function(){U++}),U},toArray:function(A){return z(A,function(U){return U})||[]},only:function(A){if(!ce(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return ke.Activity=_,ke.Children=fe,ke.Component=T,ke.Fragment=s,ke.Profiler=u,ke.PureComponent=M,ke.StrictMode=l,ke.Suspense=p,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,ke.__COMPILER_RUNTIME={__proto__:null,c:function(A){return D.H.useMemoCache(A)}},ke.cache=function(A){return function(){return A.apply(null,arguments)}},ke.cacheSignal=function(){return null},ke.cloneElement=function(A,U,$){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var F=N({},A.props),re=A.key;if(U!=null)for(ne in U.key!==void 0&&(re=""+U.key),U)!V.call(U,ne)||ne==="key"||ne==="__self"||ne==="__source"||ne==="ref"&&U.ref===void 0||(F[ne]=U[ne]);var ne=arguments.length-2;if(ne===1)F.children=$;else if(1<ne){for(var pe=Array(ne),he=0;he<ne;he++)pe[he]=arguments[he+2];F.children=pe}return ge(A.type,re,F)},ke.createContext=function(A){return A={$$typeof:f,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:d,_context:A},A},ke.createElement=function(A,U,$){var F,re={},ne=null;if(U!=null)for(F in U.key!==void 0&&(ne=""+U.key),U)V.call(U,F)&&F!=="key"&&F!=="__self"&&F!=="__source"&&(re[F]=U[F]);var pe=arguments.length-2;if(pe===1)re.children=$;else if(1<pe){for(var he=Array(pe),xe=0;xe<pe;xe++)he[xe]=arguments[xe+2];re.children=he}if(A&&A.defaultProps)for(F in pe=A.defaultProps,pe)re[F]===void 0&&(re[F]=pe[F]);return ge(A,ne,re)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(A){return{$$typeof:g,render:A}},ke.isValidElement=ce,ke.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:X}},ke.memo=function(A,U){return{$$typeof:m,type:A,compare:U===void 0?null:U}},ke.startTransition=function(A){var U=D.T,$={};D.T=$;try{var F=A(),re=D.S;re!==null&&re($,F),typeof F=="object"&&F!==null&&typeof F.then=="function"&&F.then(q,ue)}catch(ne){ue(ne)}finally{U!==null&&$.types!==null&&(U.types=$.types),D.T=U}},ke.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},ke.use=function(A){return D.H.use(A)},ke.useActionState=function(A,U,$){return D.H.useActionState(A,U,$)},ke.useCallback=function(A,U){return D.H.useCallback(A,U)},ke.useContext=function(A){return D.H.useContext(A)},ke.useDebugValue=function(){},ke.useDeferredValue=function(A,U){return D.H.useDeferredValue(A,U)},ke.useEffect=function(A,U){return D.H.useEffect(A,U)},ke.useEffectEvent=function(A){return D.H.useEffectEvent(A)},ke.useId=function(){return D.H.useId()},ke.useImperativeHandle=function(A,U,$){return D.H.useImperativeHandle(A,U,$)},ke.useInsertionEffect=function(A,U){return D.H.useInsertionEffect(A,U)},ke.useLayoutEffect=function(A,U){return D.H.useLayoutEffect(A,U)},ke.useMemo=function(A,U){return D.H.useMemo(A,U)},ke.useOptimistic=function(A,U){return D.H.useOptimistic(A,U)},ke.useReducer=function(A,U,$){return D.H.useReducer(A,U,$)},ke.useRef=function(A){return D.H.useRef(A)},ke.useState=function(A){return D.H.useState(A)},ke.useSyncExternalStore=function(A,U,$){return D.H.useSyncExternalStore(A,U,$)},ke.useTransition=function(){return D.H.useTransition()},ke.version="19.2.0",ke}var Cg;function Cu(){return Cg||(Cg=1,nu.exports=mv()),nu.exports}var au={exports:{}},Ht={};var Tg;function yv(){if(Tg)return Ht;Tg=1;var o=Cu();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:_==null?null:""+_,children:p,containerInfo:m,implementation:v}}var f=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Ht.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Ht.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},Ht.flushSync=function(p){var m=f.T,v=l.p;try{if(f.T=null,l.p=2,p)return p()}finally{f.T=m,l.p=v,l.d.f()}},Ht.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},Ht.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Ht.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin),j=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:_,integrity:j,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:_,integrity:j,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Ht.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},Ht.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,_=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:_,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Ht.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},Ht.requestFormReset=function(p){l.d.r(p)},Ht.unstable_batchedUpdates=function(p,m){return p(m)},Ht.useFormState=function(p,m,v){return f.H.useFormState(p,m,v)},Ht.useFormStatus=function(){return f.H.useHostTransitionStatus()},Ht.version="19.2.0",Ht}var Ag;function cp(){if(Ag)return au.exports;Ag=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),au.exports=yv(),au.exports}var Ng;function vv(){if(Ng)return es;Ng=1;var o=pv(),a=Cu(),s=cp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,i=t;;){var c=n.return;if(c===null)break;var h=c.alternate;if(h===null){if(i=c.return,i!==null){n=i;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===n)return p(c),e;if(h===i)return p(c),t;h=h.sibling}throw Error(l(188))}if(n.return!==i.return)n=c,i=h;else{for(var y=!1,x=c.child;x;){if(x===n){y=!0,n=c,i=h;break}if(x===i){y=!0,i=c,n=h;break}x=x.sibling}if(!y){for(x=h.child;x;){if(x===n){y=!0,n=h,i=c;break}if(x===i){y=!0,i=h,n=c;break}x=x.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==i)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var _=Object.assign,j=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),M=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),ge=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),ce=Symbol.iterator;function ye(e){return e===null||typeof e!="object"?null:(e=ce&&e[ce]||e["@@iterator"],typeof e=="function"?e:null)}var B=Symbol.for("react.client.reference");function Z(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===B?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case N:return"Fragment";case T:return"Profiler";case O:return"StrictMode";case E:return"Suspense";case q:return"SuspenseList";case ge:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case M:return e.displayName||"Context";case I:return(e._context.displayName||"Context")+".Consumer";case K:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case D:return t=e.displayName||null,t!==null?t:Z(e.type)||"Memo";case V:t=e._payload,e=e._init;try{return Z(e(t))}catch{}}return null}var ie=Array.isArray,C=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},ue=[],fe=-1;function A(e){return{current:e}}function U(e){0>fe||(e.current=ue[fe],ue[fe]=null,fe--)}function $(e,t){fe++,ue[fe]=e.current,e.current=t}var F=A(null),re=A(null),ne=A(null),pe=A(null);function he(e,t){switch($(ne,t),$(re,e),$(F,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Pf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Pf(t),e=Gf(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(F),$(F,e)}function xe(){U(F),U(re),U(ne)}function ze(e){e.memoizedState!==null&&$(pe,e);var t=F.current,n=Gf(t,e.type);t!==n&&($(re,e),$(F,n))}function Pe(e){re.current===e&&(U(F),U(re)),pe.current===e&&(U(pe),Fr._currentValue=X)}var Ue,De;function Qe(e){if(Ue===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ue=t&&t[1]||"",De=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ue+e+De}var gt=!1;function qt(e,t){if(!e||gt)return"";gt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(Q){var Y=Q}Reflect.construct(e,[],se)}else{try{se.call()}catch(Q){Y=Q}e.call(se.prototype)}}else{try{throw Error()}catch(Q){Y=Q}(se=e())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(Q){if(Q&&Y&&typeof Q.stack=="string")return[Q.stack,Y.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=i.DetermineComponentFrameRoot(),y=h[0],x=h[1];if(y&&x){var R=y.split(`
`),G=x.split(`
`);for(c=i=0;i<R.length&&!R[i].includes("DetermineComponentFrameRoot");)i++;for(;c<G.length&&!G[c].includes("DetermineComponentFrameRoot");)c++;if(i===R.length||c===G.length)for(i=R.length-1,c=G.length-1;1<=i&&0<=c&&R[i]!==G[c];)c--;for(;1<=i&&0<=c;i--,c--)if(R[i]!==G[c]){if(i!==1||c!==1)do if(i--,c--,0>c||R[i]!==G[c]){var ee=`
`+R[i].replace(" at new "," at ");return e.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",e.displayName)),ee}while(1<=i&&0<=c);break}}}finally{gt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Qe(n):""}function Tt(e,t){switch(e.tag){case 26:case 27:case 5:return Qe(e.type);case 16:return Qe("Lazy");case 13:return e.child!==t&&t!==null?Qe("Suspense Fallback"):Qe("Suspense");case 19:return Qe("SuspenseList");case 0:case 15:return qt(e.type,!1);case 11:return qt(e.type.render,!1);case 1:return qt(e.type,!0);case 31:return Qe("Activity");default:return""}}function Yt(e){try{var t="",n=null;do t+=Tt(e,n),n=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var Vn=Object.prototype.hasOwnProperty,st=o.unstable_scheduleCallback,ht=o.unstable_cancelCallback,zn=o.unstable_shouldYield,Hl=o.unstable_requestPaint,Rt=o.unstable_now,Vl=o.unstable_getCurrentPriorityLevel,hi=o.unstable_ImmediatePriority,os=o.unstable_UserBlockingPriority,Ma=o.unstable_NormalPriority,$l=o.unstable_LowPriority,cs=o.unstable_IdlePriority,Pl=o.log,fi=o.unstable_setDisableYieldValue,qa=null,$t=null;function Un(e){if(typeof Pl=="function"&&fi(e),$t&&typeof $t.setStrictMode=="function")try{$t.setStrictMode(qa,e)}catch{}}var Pt=Math.clz32?Math.clz32:ds,Gl=Math.log,us=Math.LN2;function ds(e){return e>>>=0,e===0?32:31-(Gl(e)/us|0)|0}var gi=256,dn=262144,hn=4194304;function Dn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function pi(e,t,n){var i=e.pendingLanes;if(i===0)return 0;var c=0,h=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var x=i&134217727;return x!==0?(i=x&~h,i!==0?c=Dn(i):(y&=x,y!==0?c=Dn(y):n||(n=x&~e,n!==0&&(c=Dn(n))))):(x=i&~h,x!==0?c=Dn(x):y!==0?c=Dn(y):n||(n=i&~e,n!==0&&(c=Dn(n)))),c===0?0:t!==0&&t!==c&&(t&h)===0&&(h=c&-c,n=t&-t,h>=n||h===32&&(n&4194048)!==0)?t:c}function La(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function lr(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hs(){var e=hn;return hn<<=1,(hn&62914560)===0&&(hn=4194304),e}function Ia(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function En(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Kl(e,t,n,i,c,h){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var x=e.entanglements,R=e.expirationTimes,G=e.hiddenUpdates;for(n=y&~n;0<n;){var ee=31-Pt(n),se=1<<ee;x[ee]=0,R[ee]=-1;var Y=G[ee];if(Y!==null)for(G[ee]=null,ee=0;ee<Y.length;ee++){var Q=Y[ee];Q!==null&&(Q.lane&=-536870913)}n&=~se}i!==0&&fs(e,i,0),h!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=h&~(y&~t))}function fs(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-Pt(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&261930}function gs(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Pt(n),c=1<<i;c&t|e[i]&t&&(e[i]|=t),n&=~c}}function or(e,t){var n=t&-t;return n=(n&42)!==0?1:cr(n),(n&(e.suspendedLanes|t))!==0?0:n}function cr(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ha(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Bn(){var e=z.p;return e!==0?e:(e=window.event,e===void 0?32:gg(e.type))}function ps(e,t){var n=z.p;try{return z.p=e,t()}finally{z.p=n}}var Cn=Math.random().toString(36).slice(2),xt="__reactFiber$"+Cn,Lt="__reactProps$"+Cn,oa="__reactContainer$"+Cn,ur="__reactEvents$"+Cn,H="__reactListeners$"+Cn,te="__reactHandles$"+Cn,ve="__reactResources$"+Cn,oe="__reactMarker$"+Cn;function be(e){delete e[xt],delete e[Lt],delete e[ur],delete e[H],delete e[te]}function _e(e){var t=e[xt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[oa]||n[xt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Zf(e);e!==null;){if(n=e[xt])return n;e=Zf(e)}return t}e=n,n=e.parentNode}return null}function me(e){if(e=e[xt]||e[oa]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Te(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function de(e){var t=e[ve];return t||(t=e[ve]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function le(e){e[oe]=!0}var Re=new Set,Be={};function Ie(e,t){Gt(e,t),Gt(e+"Capture",t)}function Gt(e,t){for(Be[e]=t,e=0;e<t.length;e++)Re.add(t[e])}var lt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ot={},ct={};function $n(e){return Vn.call(ct,e)?!0:Vn.call(ot,e)?!1:lt.test(e)?ct[e]=!0:(ot[e]=!0,!1)}function Jt(e,t,n){if($n(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function ca(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function fn(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function It(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ua(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mn(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,h=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,h.call(this,y)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Oe(e){if(!e._valueTracker){var t=ua(e)?"checked":"value";e._valueTracker=Mn(e,t,""+e[t])}}function at(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=ua(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function vt(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var qe=/[\n"\\]/g;function He(e){return e.replace(qe,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function kt(e,t,n,i,c,h,y,x){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+It(t)):e.value!==""+It(t)&&(e.value=""+It(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?mi(e,y,It(t)):n!=null?mi(e,y,It(n)):i!=null&&e.removeAttribute("value"),c==null&&h!=null&&(e.defaultChecked=!!h),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?e.name=""+It(x):e.removeAttribute("name")}function dr(e,t,n,i,c,h,y,x){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||n!=null){if(!(h!=="submit"&&h!=="reset"||t!=null)){Oe(e);return}n=n!=null?""+It(n):"",t=t!=null?""+It(t):n,x||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=x?e.checked:!!i,e.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Oe(e)}function mi(e,t,n){t==="number"&&vt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function yi(e,t,n,i){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&i&&(e[n].defaultSelected=!0)}else{for(n=""+It(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function qu(e,t,n){if(t!=null&&(t=""+It(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+It(n):""}function Lu(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(l(92));if(ie(i)){if(1<i.length)throw Error(l(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=It(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i),Oe(e)}function vi(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var rm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Iu(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||rm.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Hu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&n[c]!==i&&Iu(e,c,i)}else for(var h in t)t.hasOwnProperty(h)&&Iu(e,h,t[h])}function Yl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(e){return lm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pn(){}var Jl=null;function Fl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var bi=null,_i=null;function Vu(e){var t=me(e);if(t&&(e=t.stateNode)){var n=e[Lt]||null;e:switch(e=t.stateNode,t.type){case"input":if(kt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+He(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var c=i[Lt]||null;if(!c)throw Error(l(90));kt(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&at(i)}break e;case"textarea":qu(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&yi(e,!!n.multiple,t,!1)}}}var Ql=!1;function $u(e,t,n){if(Ql)return e(t,n);Ql=!0;try{var i=e(t);return i}finally{if(Ql=!1,(bi!==null||_i!==null)&&(al(),bi&&(t=bi,e=_i,_i=bi=null,Vu(t),e)))for(t=0;t<e.length;t++)Vu(e[t])}}function hr(e,t){var n=e.stateNode;if(n===null)return null;var i=n[Lt]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xl=!1;if(Gn)try{var fr={};Object.defineProperty(fr,"passive",{get:function(){Xl=!0}}),window.addEventListener("test",fr,fr),window.removeEventListener("test",fr,fr)}catch{Xl=!1}var da=null,Zl=null,ys=null;function Pu(){if(ys)return ys;var e,t=Zl,n=t.length,i,c="value"in da?da.value:da.textContent,h=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(i=1;i<=y&&t[n-i]===c[h-i];i++);return ys=c.slice(e,1<i?1-i:void 0)}function vs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bs(){return!0}function Gu(){return!1}function Ft(e){function t(n,i,c,h,y){this._reactName=n,this._targetInst=c,this.type=i,this.nativeEvent=h,this.target=y,this.currentTarget=null;for(var x in e)e.hasOwnProperty(x)&&(n=e[x],this[x]=n?n(h):h[x]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?bs:Gu,this.isPropagationStopped=Gu,this}return _(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),t}var Va={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_s=Ft(Va),gr=_({},Va,{view:0,detail:0}),om=Ft(gr),Wl,eo,pr,xs=_({},gr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:no,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pr&&(pr&&e.type==="mousemove"?(Wl=e.screenX-pr.screenX,eo=e.screenY-pr.screenY):eo=Wl=0,pr=e),Wl)},movementY:function(e){return"movementY"in e?e.movementY:eo}}),Ku=Ft(xs),cm=_({},xs,{dataTransfer:0}),um=Ft(cm),dm=_({},gr,{relatedTarget:0}),to=Ft(dm),hm=_({},Va,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=Ft(hm),gm=_({},Va,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pm=Ft(gm),mm=_({},Va,{data:0}),Yu=Ft(mm),ym={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _m(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bm[e])?!!t[e]:!1}function no(){return _m}var xm=_({},gr,{key:function(e){if(e.key){var t=ym[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:no,charCode:function(e){return e.type==="keypress"?vs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jm=Ft(xm),Sm=_({},xs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ju=Ft(Sm),wm=_({},gr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:no}),Em=Ft(wm),Cm=_({},Va,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tm=Ft(Cm),Am=_({},xs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nm=Ft(Am),Om=_({},Va,{newState:0,oldState:0}),Rm=Ft(Om),km=[9,13,27,32],ao=Gn&&"CompositionEvent"in window,mr=null;Gn&&"documentMode"in document&&(mr=document.documentMode);var zm=Gn&&"TextEvent"in window&&!mr,Fu=Gn&&(!ao||mr&&8<mr&&11>=mr),Qu=" ",Xu=!1;function Zu(e,t){switch(e){case"keyup":return km.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xi=!1;function Um(e,t){switch(e){case"compositionend":return Wu(t);case"keypress":return t.which!==32?null:(Xu=!0,Qu);case"textInput":return e=t.data,e===Qu&&Xu?null:e;default:return null}}function Dm(e,t){if(xi)return e==="compositionend"||!ao&&Zu(e,t)?(e=Pu(),ys=Zl=da=null,xi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fu&&t.locale!=="ko"?null:t.data;default:return null}}var Bm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bm[e.type]:t==="textarea"}function td(e,t,n,i){bi?_i?_i.push(i):_i=[i]:bi=i,t=ul(t,"onChange"),0<t.length&&(n=new _s("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var yr=null,vr=null;function Mm(e){qf(e,0)}function js(e){var t=Te(e);if(at(t))return e}function nd(e,t){if(e==="change")return t}var ad=!1;if(Gn){var io;if(Gn){var ro="oninput"in document;if(!ro){var id=document.createElement("div");id.setAttribute("oninput","return;"),ro=typeof id.oninput=="function"}io=ro}else io=!1;ad=io&&(!document.documentMode||9<document.documentMode)}function rd(){yr&&(yr.detachEvent("onpropertychange",sd),vr=yr=null)}function sd(e){if(e.propertyName==="value"&&js(vr)){var t=[];td(t,vr,e,Fl(e)),$u(Mm,t)}}function qm(e,t,n){e==="focusin"?(rd(),yr=t,vr=n,yr.attachEvent("onpropertychange",sd)):e==="focusout"&&rd()}function Lm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return js(vr)}function Im(e,t){if(e==="click")return js(t)}function Hm(e,t){if(e==="input"||e==="change")return js(t)}function Vm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tn=typeof Object.is=="function"?Object.is:Vm;function br(e,t){if(tn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var c=n[i];if(!Vn.call(t,c)||!tn(e[c],t[c]))return!1}return!0}function ld(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function od(e,t){var n=ld(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ld(n)}}function cd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ud(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=vt(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=vt(e.document)}return t}function so(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var $m=Gn&&"documentMode"in document&&11>=document.documentMode,ji=null,lo=null,_r=null,oo=!1;function dd(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;oo||ji==null||ji!==vt(i)||(i=ji,"selectionStart"in i&&so(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),_r&&br(_r,i)||(_r=i,i=ul(lo,"onSelect"),0<i.length&&(t=new _s("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=ji)))}function $a(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Si={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionrun:$a("Transition","TransitionRun"),transitionstart:$a("Transition","TransitionStart"),transitioncancel:$a("Transition","TransitionCancel"),transitionend:$a("Transition","TransitionEnd")},co={},hd={};Gn&&(hd=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);function Pa(e){if(co[e])return co[e];if(!Si[e])return e;var t=Si[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in hd)return co[e]=t[n];return e}var fd=Pa("animationend"),gd=Pa("animationiteration"),pd=Pa("animationstart"),Pm=Pa("transitionrun"),Gm=Pa("transitionstart"),Km=Pa("transitioncancel"),md=Pa("transitionend"),yd=new Map,uo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");uo.push("scrollEnd");function Tn(e,t){yd.set(e,t),Ie(t,[e])}var Ss=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},gn=[],wi=0,ho=0;function ws(){for(var e=wi,t=ho=wi=0;t<e;){var n=gn[t];gn[t++]=null;var i=gn[t];gn[t++]=null;var c=gn[t];gn[t++]=null;var h=gn[t];if(gn[t++]=null,i!==null&&c!==null){var y=i.pending;y===null?c.next=c:(c.next=y.next,y.next=c),i.pending=c}h!==0&&vd(n,c,h)}}function Es(e,t,n,i){gn[wi++]=e,gn[wi++]=t,gn[wi++]=n,gn[wi++]=i,ho|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function fo(e,t,n,i){return Es(e,t,n,i),Cs(e)}function Ga(e,t){return Es(e,null,null,t),Cs(e)}function vd(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var c=!1,h=e.return;h!==null;)h.childLanes|=n,i=h.alternate,i!==null&&(i.childLanes|=n),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(c=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,c&&t!==null&&(c=31-Pt(n),e=h.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=n|536870912),h):null}function Cs(e){if(50<Vr)throw Vr=0,jc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ei={};function Ym(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nn(e,t,n,i){return new Ym(e,t,n,i)}function go(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Kn(e,t){var n=e.alternate;return n===null?(n=nn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function bd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ts(e,t,n,i,c,h){var y=0;if(i=e,typeof e=="function")go(e)&&(y=1);else if(typeof e=="string")y=Zy(e,n,F.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ge:return e=nn(31,n,t,c),e.elementType=ge,e.lanes=h,e;case N:return Ka(n.children,c,h,t);case O:y=8,c|=24;break;case T:return e=nn(12,n,t,c|2),e.elementType=T,e.lanes=h,e;case E:return e=nn(13,n,t,c),e.elementType=E,e.lanes=h,e;case q:return e=nn(19,n,t,c),e.elementType=q,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:y=10;break e;case I:y=9;break e;case K:y=11;break e;case D:y=14;break e;case V:y=16,i=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),i=null}return t=nn(y,n,t,c),t.elementType=e,t.type=i,t.lanes=h,t}function Ka(e,t,n,i){return e=nn(7,e,i,t),e.lanes=n,e}function po(e,t,n){return e=nn(6,e,null,t),e.lanes=n,e}function _d(e){var t=nn(18,null,null,0);return t.stateNode=e,t}function mo(e,t,n){return t=nn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var xd=new WeakMap;function pn(e,t){if(typeof e=="object"&&e!==null){var n=xd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Yt(t)},xd.set(e,t),t)}return{value:e,source:t,stack:Yt(t)}}var Ci=[],Ti=0,As=null,xr=0,mn=[],yn=0,ha=null,qn=1,Ln="";function Yn(e,t){Ci[Ti++]=xr,Ci[Ti++]=As,As=e,xr=t}function jd(e,t,n){mn[yn++]=qn,mn[yn++]=Ln,mn[yn++]=ha,ha=e;var i=qn;e=Ln;var c=32-Pt(i)-1;i&=~(1<<c),n+=1;var h=32-Pt(t)+c;if(30<h){var y=c-c%5;h=(i&(1<<y)-1).toString(32),i>>=y,c-=y,qn=1<<32-Pt(t)+c|n<<c|i,Ln=h+e}else qn=1<<h|n<<c|i,Ln=e}function yo(e){e.return!==null&&(Yn(e,1),jd(e,1,0))}function vo(e){for(;e===As;)As=Ci[--Ti],Ci[Ti]=null,xr=Ci[--Ti],Ci[Ti]=null;for(;e===ha;)ha=mn[--yn],mn[yn]=null,Ln=mn[--yn],mn[yn]=null,qn=mn[--yn],mn[yn]=null}function Sd(e,t){mn[yn++]=qn,mn[yn++]=Ln,mn[yn++]=ha,qn=t.id,Ln=t.overflow,ha=e}var zt=null,ut=null,Ye=!1,fa=null,vn=!1,bo=Error(l(519));function ga(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw jr(pn(t,e)),bo}function wd(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[xt]=e,t[Lt]=i,n){case"dialog":$e("cancel",t),$e("close",t);break;case"iframe":case"object":case"embed":$e("load",t);break;case"video":case"audio":for(n=0;n<Pr.length;n++)$e(Pr[n],t);break;case"source":$e("error",t);break;case"img":case"image":case"link":$e("error",t),$e("load",t);break;case"details":$e("toggle",t);break;case"input":$e("invalid",t),dr(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":$e("invalid",t);break;case"textarea":$e("invalid",t),Lu(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||Vf(t.textContent,n)?(i.popover!=null&&($e("beforetoggle",t),$e("toggle",t)),i.onScroll!=null&&$e("scroll",t),i.onScrollEnd!=null&&$e("scrollend",t),i.onClick!=null&&(t.onclick=Pn),t=!0):t=!1,t||ga(e,!0)}function Ed(e){for(zt=e.return;zt;)switch(zt.tag){case 5:case 31:case 13:vn=!1;return;case 27:case 3:vn=!0;return;default:zt=zt.return}}function Ai(e){if(e!==zt)return!1;if(!Ye)return Ed(e),Ye=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Mc(e.type,e.memoizedProps)),n=!n),n&&ut&&ga(e),Ed(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ut=Xf(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ut=Xf(e)}else t===27?(t=ut,Aa(e.type)?(e=Vc,Vc=null,ut=e):ut=t):ut=zt?_n(e.stateNode.nextSibling):null;return!0}function Ya(){ut=zt=null,Ye=!1}function _o(){var e=fa;return e!==null&&(Wt===null?Wt=e:Wt.push.apply(Wt,e),fa=null),e}function jr(e){fa===null?fa=[e]:fa.push(e)}var xo=A(null),Ja=null,Jn=null;function pa(e,t,n){$(xo,t._currentValue),t._currentValue=n}function Fn(e){e._currentValue=xo.current,U(xo)}function jo(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function So(e,t,n,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var h=c.dependencies;if(h!==null){var y=c.child;h=h.firstContext;e:for(;h!==null;){var x=h;h=c;for(var R=0;R<t.length;R++)if(x.context===t[R]){h.lanes|=n,x=h.alternate,x!==null&&(x.lanes|=n),jo(h.return,n,e),i||(y=null);break e}h=x.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,h=y.alternate,h!==null&&(h.lanes|=n),jo(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function Ni(e,t,n,i){e=null;for(var c=t,h=!1;c!==null;){if(!h){if((c.flags&524288)!==0)h=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var x=c.type;tn(c.pendingProps.value,y.value)||(e!==null?e.push(x):e=[x])}}else if(c===pe.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Fr):e=[Fr])}c=c.return}e!==null&&So(t,e,n,i),t.flags|=262144}function Ns(e){for(e=e.firstContext;e!==null;){if(!tn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Fa(e){Ja=e,Jn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ut(e){return Cd(Ja,e)}function Os(e,t){return Ja===null&&Fa(e),Cd(e,t)}function Cd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Jn===null){if(e===null)throw Error(l(308));Jn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Jn=Jn.next=t;return n}var Jm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Fm=o.unstable_scheduleCallback,Qm=o.unstable_NormalPriority,jt={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wo(){return{controller:new Jm,data:new Map,refCount:0}}function Sr(e){e.refCount--,e.refCount===0&&Fm(Qm,function(){e.controller.abort()})}var wr=null,Eo=0,Oi=0,Ri=null;function Xm(e,t){if(wr===null){var n=wr=[];Eo=0,Oi=Ac(),Ri={status:"pending",value:void 0,then:function(i){n.push(i)}}}return Eo++,t.then(Td,Td),t}function Td(){if(--Eo===0&&wr!==null){Ri!==null&&(Ri.status="fulfilled");var e=wr;wr=null,Oi=0,Ri=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Zm(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),i}var Ad=C.S;C.S=function(e,t){hf=Rt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Xm(e,t),Ad!==null&&Ad(e,t)};var Qa=A(null);function Co(){var e=Qa.current;return e!==null?e:it.pooledCache}function Rs(e,t){t===null?$(Qa,Qa.current):$(Qa,t.pool)}function Nd(){var e=Co();return e===null?null:{parent:jt._currentValue,pool:e}}var ki=Error(l(460)),To=Error(l(474)),ks=Error(l(542)),zs={then:function(){}};function Od(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Rd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Pn,Pn),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,zd(e),e;default:if(typeof t.status=="string")t.then(Pn,Pn);else{if(e=it,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,zd(e),e}throw Za=t,ki}}function Xa(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Za=n,ki):n}}var Za=null;function kd(){if(Za===null)throw Error(l(459));var e=Za;return Za=null,e}function zd(e){if(e===ki||e===ks)throw Error(l(483))}var zi=null,Er=0;function Us(e){var t=Er;return Er+=1,zi===null&&(zi=[]),Rd(zi,e,t)}function Cr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ds(e,t){throw t.$$typeof===j?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Ud(e){function t(L,k){if(e){var P=L.deletions;P===null?(L.deletions=[k],L.flags|=16):P.push(k)}}function n(L,k){if(!e)return null;for(;k!==null;)t(L,k),k=k.sibling;return null}function i(L){for(var k=new Map;L!==null;)L.key!==null?k.set(L.key,L):k.set(L.index,L),L=L.sibling;return k}function c(L,k){return L=Kn(L,k),L.index=0,L.sibling=null,L}function h(L,k,P){return L.index=P,e?(P=L.alternate,P!==null?(P=P.index,P<k?(L.flags|=67108866,k):P):(L.flags|=67108866,k)):(L.flags|=1048576,k)}function y(L){return e&&L.alternate===null&&(L.flags|=67108866),L}function x(L,k,P,ae){return k===null||k.tag!==6?(k=po(P,L.mode,ae),k.return=L,k):(k=c(k,P),k.return=L,k)}function R(L,k,P,ae){var Ce=P.type;return Ce===N?ee(L,k,P.props.children,ae,P.key):k!==null&&(k.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===V&&Xa(Ce)===k.type)?(k=c(k,P.props),Cr(k,P),k.return=L,k):(k=Ts(P.type,P.key,P.props,null,L.mode,ae),Cr(k,P),k.return=L,k)}function G(L,k,P,ae){return k===null||k.tag!==4||k.stateNode.containerInfo!==P.containerInfo||k.stateNode.implementation!==P.implementation?(k=mo(P,L.mode,ae),k.return=L,k):(k=c(k,P.children||[]),k.return=L,k)}function ee(L,k,P,ae,Ce){return k===null||k.tag!==7?(k=Ka(P,L.mode,ae,Ce),k.return=L,k):(k=c(k,P),k.return=L,k)}function se(L,k,P){if(typeof k=="string"&&k!==""||typeof k=="number"||typeof k=="bigint")return k=po(""+k,L.mode,P),k.return=L,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case b:return P=Ts(k.type,k.key,k.props,null,L.mode,P),Cr(P,k),P.return=L,P;case w:return k=mo(k,L.mode,P),k.return=L,k;case V:return k=Xa(k),se(L,k,P)}if(ie(k)||ye(k))return k=Ka(k,L.mode,P,null),k.return=L,k;if(typeof k.then=="function")return se(L,Us(k),P);if(k.$$typeof===M)return se(L,Os(L,k),P);Ds(L,k)}return null}function Y(L,k,P,ae){var Ce=k!==null?k.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return Ce!==null?null:x(L,k,""+P,ae);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case b:return P.key===Ce?R(L,k,P,ae):null;case w:return P.key===Ce?G(L,k,P,ae):null;case V:return P=Xa(P),Y(L,k,P,ae)}if(ie(P)||ye(P))return Ce!==null?null:ee(L,k,P,ae,null);if(typeof P.then=="function")return Y(L,k,Us(P),ae);if(P.$$typeof===M)return Y(L,k,Os(L,P),ae);Ds(L,P)}return null}function Q(L,k,P,ae,Ce){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return L=L.get(P)||null,x(k,L,""+ae,Ce);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case b:return L=L.get(ae.key===null?P:ae.key)||null,R(k,L,ae,Ce);case w:return L=L.get(ae.key===null?P:ae.key)||null,G(k,L,ae,Ce);case V:return ae=Xa(ae),Q(L,k,P,ae,Ce)}if(ie(ae)||ye(ae))return L=L.get(P)||null,ee(k,L,ae,Ce,null);if(typeof ae.then=="function")return Q(L,k,P,Us(ae),Ce);if(ae.$$typeof===M)return Q(L,k,P,Os(k,ae),Ce);Ds(k,ae)}return null}function je(L,k,P,ae){for(var Ce=null,Je=null,Se=k,Le=k=0,Ke=null;Se!==null&&Le<P.length;Le++){Se.index>Le?(Ke=Se,Se=null):Ke=Se.sibling;var Fe=Y(L,Se,P[Le],ae);if(Fe===null){Se===null&&(Se=Ke);break}e&&Se&&Fe.alternate===null&&t(L,Se),k=h(Fe,k,Le),Je===null?Ce=Fe:Je.sibling=Fe,Je=Fe,Se=Ke}if(Le===P.length)return n(L,Se),Ye&&Yn(L,Le),Ce;if(Se===null){for(;Le<P.length;Le++)Se=se(L,P[Le],ae),Se!==null&&(k=h(Se,k,Le),Je===null?Ce=Se:Je.sibling=Se,Je=Se);return Ye&&Yn(L,Le),Ce}for(Se=i(Se);Le<P.length;Le++)Ke=Q(Se,L,Le,P[Le],ae),Ke!==null&&(e&&Ke.alternate!==null&&Se.delete(Ke.key===null?Le:Ke.key),k=h(Ke,k,Le),Je===null?Ce=Ke:Je.sibling=Ke,Je=Ke);return e&&Se.forEach(function(za){return t(L,za)}),Ye&&Yn(L,Le),Ce}function Ae(L,k,P,ae){if(P==null)throw Error(l(151));for(var Ce=null,Je=null,Se=k,Le=k=0,Ke=null,Fe=P.next();Se!==null&&!Fe.done;Le++,Fe=P.next()){Se.index>Le?(Ke=Se,Se=null):Ke=Se.sibling;var za=Y(L,Se,Fe.value,ae);if(za===null){Se===null&&(Se=Ke);break}e&&Se&&za.alternate===null&&t(L,Se),k=h(za,k,Le),Je===null?Ce=za:Je.sibling=za,Je=za,Se=Ke}if(Fe.done)return n(L,Se),Ye&&Yn(L,Le),Ce;if(Se===null){for(;!Fe.done;Le++,Fe=P.next())Fe=se(L,Fe.value,ae),Fe!==null&&(k=h(Fe,k,Le),Je===null?Ce=Fe:Je.sibling=Fe,Je=Fe);return Ye&&Yn(L,Le),Ce}for(Se=i(Se);!Fe.done;Le++,Fe=P.next())Fe=Q(Se,L,Le,Fe.value,ae),Fe!==null&&(e&&Fe.alternate!==null&&Se.delete(Fe.key===null?Le:Fe.key),k=h(Fe,k,Le),Je===null?Ce=Fe:Je.sibling=Fe,Je=Fe);return e&&Se.forEach(function(cv){return t(L,cv)}),Ye&&Yn(L,Le),Ce}function nt(L,k,P,ae){if(typeof P=="object"&&P!==null&&P.type===N&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case b:e:{for(var Ce=P.key;k!==null;){if(k.key===Ce){if(Ce=P.type,Ce===N){if(k.tag===7){n(L,k.sibling),ae=c(k,P.props.children),ae.return=L,L=ae;break e}}else if(k.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===V&&Xa(Ce)===k.type){n(L,k.sibling),ae=c(k,P.props),Cr(ae,P),ae.return=L,L=ae;break e}n(L,k);break}else t(L,k);k=k.sibling}P.type===N?(ae=Ka(P.props.children,L.mode,ae,P.key),ae.return=L,L=ae):(ae=Ts(P.type,P.key,P.props,null,L.mode,ae),Cr(ae,P),ae.return=L,L=ae)}return y(L);case w:e:{for(Ce=P.key;k!==null;){if(k.key===Ce)if(k.tag===4&&k.stateNode.containerInfo===P.containerInfo&&k.stateNode.implementation===P.implementation){n(L,k.sibling),ae=c(k,P.children||[]),ae.return=L,L=ae;break e}else{n(L,k);break}else t(L,k);k=k.sibling}ae=mo(P,L.mode,ae),ae.return=L,L=ae}return y(L);case V:return P=Xa(P),nt(L,k,P,ae)}if(ie(P))return je(L,k,P,ae);if(ye(P)){if(Ce=ye(P),typeof Ce!="function")throw Error(l(150));return P=Ce.call(P),Ae(L,k,P,ae)}if(typeof P.then=="function")return nt(L,k,Us(P),ae);if(P.$$typeof===M)return nt(L,k,Os(L,P),ae);Ds(L,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,k!==null&&k.tag===6?(n(L,k.sibling),ae=c(k,P),ae.return=L,L=ae):(n(L,k),ae=po(P,L.mode,ae),ae.return=L,L=ae),y(L)):n(L,k)}return function(L,k,P,ae){try{Er=0;var Ce=nt(L,k,P,ae);return zi=null,Ce}catch(Se){if(Se===ki||Se===ks)throw Se;var Je=nn(29,Se,null,L.mode);return Je.lanes=ae,Je.return=L,Je}finally{}}}var Wa=Ud(!0),Dd=Ud(!1),ma=!1;function Ao(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function No(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ya(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function va(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Xe&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=Cs(e),vd(e,null,n),t}return Es(e,i,t,n),Cs(e)}function Tr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,gs(e,n)}}function Oo(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var c=null,h=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};h===null?c=h=y:h=h.next=y,n=n.next}while(n!==null);h===null?c=h=t:h=h.next=t}else c=h=t;n={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Ro=!1;function Ar(){if(Ro){var e=Ri;if(e!==null)throw e}}function Nr(e,t,n,i){Ro=!1;var c=e.updateQueue;ma=!1;var h=c.firstBaseUpdate,y=c.lastBaseUpdate,x=c.shared.pending;if(x!==null){c.shared.pending=null;var R=x,G=R.next;R.next=null,y===null?h=G:y.next=G,y=R;var ee=e.alternate;ee!==null&&(ee=ee.updateQueue,x=ee.lastBaseUpdate,x!==y&&(x===null?ee.firstBaseUpdate=G:x.next=G,ee.lastBaseUpdate=R))}if(h!==null){var se=c.baseState;y=0,ee=G=R=null,x=h;do{var Y=x.lane&-536870913,Q=Y!==x.lane;if(Q?(Ge&Y)===Y:(i&Y)===Y){Y!==0&&Y===Oi&&(Ro=!0),ee!==null&&(ee=ee.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var je=e,Ae=x;Y=t;var nt=n;switch(Ae.tag){case 1:if(je=Ae.payload,typeof je=="function"){se=je.call(nt,se,Y);break e}se=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Ae.payload,Y=typeof je=="function"?je.call(nt,se,Y):je,Y==null)break e;se=_({},se,Y);break e;case 2:ma=!0}}Y=x.callback,Y!==null&&(e.flags|=64,Q&&(e.flags|=8192),Q=c.callbacks,Q===null?c.callbacks=[Y]:Q.push(Y))}else Q={lane:Y,tag:x.tag,payload:x.payload,callback:x.callback,next:null},ee===null?(G=ee=Q,R=se):ee=ee.next=Q,y|=Y;if(x=x.next,x===null){if(x=c.shared.pending,x===null)break;Q=x,x=Q.next,Q.next=null,c.lastBaseUpdate=Q,c.shared.pending=null}}while(!0);ee===null&&(R=se),c.baseState=R,c.firstBaseUpdate=G,c.lastBaseUpdate=ee,h===null&&(c.shared.lanes=0),Sa|=y,e.lanes=y,e.memoizedState=se}}function Bd(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function Md(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Bd(n[e],t)}var Ui=A(null),Bs=A(0);function qd(e,t){e=ia,$(Bs,e),$(Ui,t),ia=e|t.baseLanes}function ko(){$(Bs,ia),$(Ui,Ui.current)}function zo(){ia=Bs.current,U(Ui),U(Bs)}var an=A(null),bn=null;function ba(e){var t=e.alternate;$(bt,bt.current&1),$(an,e),bn===null&&(t===null||Ui.current!==null||t.memoizedState!==null)&&(bn=e)}function Uo(e){$(bt,bt.current),$(an,e),bn===null&&(bn=e)}function Ld(e){e.tag===22?($(bt,bt.current),$(an,e),bn===null&&(bn=e)):_a()}function _a(){$(bt,bt.current),$(an,an.current)}function rn(e){U(an),bn===e&&(bn=null),U(bt)}var bt=A(0);function Ms(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Ic(n)||Hc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Qn=0,Me=null,et=null,St=null,qs=!1,Di=!1,ei=!1,Ls=0,Or=0,Bi=null,Wm=0;function mt(){throw Error(l(321))}function Do(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!tn(e[n],t[n]))return!1;return!0}function Bo(e,t,n,i,c,h){return Qn=h,Me=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,C.H=e===null||e.memoizedState===null?jh:Xo,ei=!1,h=n(i,c),ei=!1,Di&&(h=Hd(t,n,i,c)),Id(e),h}function Id(e){C.H=zr;var t=et!==null&&et.next!==null;if(Qn=0,St=et=Me=null,qs=!1,Or=0,Bi=null,t)throw Error(l(300));e===null||wt||(e=e.dependencies,e!==null&&Ns(e)&&(wt=!0))}function Hd(e,t,n,i){Me=e;var c=0;do{if(Di&&(Bi=null),Or=0,Di=!1,25<=c)throw Error(l(301));if(c+=1,St=et=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}C.H=Sh,h=t(n,i)}while(Di);return h}function ey(){var e=C.H,t=e.useState()[0];return t=typeof t.then=="function"?Rr(t):t,e=e.useState()[0],(et!==null?et.memoizedState:null)!==e&&(Me.flags|=1024),t}function Mo(){var e=Ls!==0;return Ls=0,e}function qo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Lo(e){if(qs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}qs=!1}Qn=0,St=et=Me=null,Di=!1,Or=Ls=0,Bi=null}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?Me.memoizedState=St=e:St=St.next=e,St}function _t(){if(et===null){var e=Me.alternate;e=e!==null?e.memoizedState:null}else e=et.next;var t=St===null?Me.memoizedState:St.next;if(t!==null)St=t,et=e;else{if(e===null)throw Me.alternate===null?Error(l(467)):Error(l(310));et=e,e={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},St===null?Me.memoizedState=St=e:St=St.next=e}return St}function Is(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rr(e){var t=Or;return Or+=1,Bi===null&&(Bi=[]),e=Rd(Bi,e,t),t=Me,(St===null?t.memoizedState:St.next)===null&&(t=t.alternate,C.H=t===null||t.memoizedState===null?jh:Xo),e}function Hs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Rr(e);if(e.$$typeof===M)return Ut(e)}throw Error(l(438,String(e)))}function Io(e){var t=null,n=Me.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=Me.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Is(),Me.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=J;return t.index++,n}function Xn(e,t){return typeof t=="function"?t(e):t}function Vs(e){var t=_t();return Ho(t,et,e)}function Ho(e,t,n){var i=e.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=n;var c=e.baseQueue,h=i.pending;if(h!==null){if(c!==null){var y=c.next;c.next=h.next,h.next=y}t.baseQueue=c=h,i.pending=null}if(h=e.baseState,c===null)e.memoizedState=h;else{t=c.next;var x=y=null,R=null,G=t,ee=!1;do{var se=G.lane&-536870913;if(se!==G.lane?(Ge&se)===se:(Qn&se)===se){var Y=G.revertLane;if(Y===0)R!==null&&(R=R.next={lane:0,revertLane:0,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null}),se===Oi&&(ee=!0);else if((Qn&Y)===Y){G=G.next,Y===Oi&&(ee=!0);continue}else se={lane:0,revertLane:G.revertLane,gesture:null,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},R===null?(x=R=se,y=h):R=R.next=se,Me.lanes|=Y,Sa|=Y;se=G.action,ei&&n(h,se),h=G.hasEagerState?G.eagerState:n(h,se)}else Y={lane:se,revertLane:G.revertLane,gesture:G.gesture,action:G.action,hasEagerState:G.hasEagerState,eagerState:G.eagerState,next:null},R===null?(x=R=Y,y=h):R=R.next=Y,Me.lanes|=se,Sa|=se;G=G.next}while(G!==null&&G!==t);if(R===null?y=h:R.next=x,!tn(h,e.memoizedState)&&(wt=!0,ee&&(n=Ri,n!==null)))throw n;e.memoizedState=h,e.baseState=y,e.baseQueue=R,i.lastRenderedState=h}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Vo(e){var t=_t(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var i=n.dispatch,c=n.pending,h=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do h=e(h,y.action),y=y.next;while(y!==c);tn(h,t.memoizedState)||(wt=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),n.lastRenderedState=h}return[h,i]}function Vd(e,t,n){var i=Me,c=_t(),h=Ye;if(h){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!tn((et||c).memoizedState,n);if(y&&(c.memoizedState=n,wt=!0),c=c.queue,Go(Gd.bind(null,i,c,e),[e]),c.getSnapshot!==t||y||St!==null&&St.memoizedState.tag&1){if(i.flags|=2048,Mi(9,{destroy:void 0},Pd.bind(null,i,c,n,t),null),it===null)throw Error(l(349));h||(Qn&127)!==0||$d(i,t,n)}return n}function $d(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Me.updateQueue,t===null?(t=Is(),Me.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Pd(e,t,n,i){t.value=n,t.getSnapshot=i,Kd(t)&&Yd(e)}function Gd(e,t,n){return n(function(){Kd(t)&&Yd(e)})}function Kd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tn(e,n)}catch{return!0}}function Yd(e){var t=Ga(e,2);t!==null&&en(t,e,2)}function $o(e){var t=Kt();if(typeof e=="function"){var n=e;if(e=n(),ei){Un(!0);try{n()}finally{Un(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:e},t}function Jd(e,t,n,i){return e.baseState=n,Ho(e,et,typeof i=="function"?i:Xn)}function ty(e,t,n,i,c){if(Gs(e))throw Error(l(485));if(e=t.action,e!==null){var h={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){h.listeners.push(y)}};C.T!==null?n(!0):h.isTransition=!1,i(h),n=t.pending,n===null?(h.next=t.pending=h,Fd(t,h)):(h.next=n.next,t.pending=n.next=h)}}function Fd(e,t){var n=t.action,i=t.payload,c=e.state;if(t.isTransition){var h=C.T,y={};C.T=y;try{var x=n(c,i),R=C.S;R!==null&&R(y,x),Qd(e,t,x)}catch(G){Po(e,t,G)}finally{h!==null&&y.types!==null&&(h.types=y.types),C.T=h}}else try{h=n(c,i),Qd(e,t,h)}catch(G){Po(e,t,G)}}function Qd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Xd(e,t,i)},function(i){return Po(e,t,i)}):Xd(e,t,n)}function Xd(e,t,n){t.status="fulfilled",t.value=n,Zd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Fd(e,n)))}function Po(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,Zd(t),t=t.next;while(t!==i)}e.action=null}function Zd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Wd(e,t){return t}function eh(e,t){if(Ye){var n=it.formState;if(n!==null){e:{var i=Me;if(Ye){if(ut){t:{for(var c=ut,h=vn;c.nodeType!==8;){if(!h){c=null;break t}if(c=_n(c.nextSibling),c===null){c=null;break t}}h=c.data,c=h==="F!"||h==="F"?c:null}if(c){ut=_n(c.nextSibling),i=c.data==="F!";break e}}ga(i)}i=!1}i&&(t=n[0])}}return n=Kt(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wd,lastRenderedState:t},n.queue=i,n=bh.bind(null,Me,i),i.dispatch=n,i=$o(!1),h=Qo.bind(null,Me,!1,i.queue),i=Kt(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,n=ty.bind(null,Me,c,h,n),c.dispatch=n,i.memoizedState=e,[t,n,!1]}function th(e){var t=_t();return nh(t,et,e)}function nh(e,t,n){if(t=Ho(e,t,Wd)[0],e=Vs(Xn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=Rr(t)}catch(y){throw y===ki?ks:y}else i=t;t=_t();var c=t.queue,h=c.dispatch;return n!==t.memoizedState&&(Me.flags|=2048,Mi(9,{destroy:void 0},ny.bind(null,c,n),null)),[i,h,e]}function ny(e,t){e.action=t}function ah(e){var t=_t(),n=et;if(n!==null)return nh(t,n,e);_t(),t=t.memoizedState,n=_t();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Mi(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},t=Me.updateQueue,t===null&&(t=Is(),Me.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function ih(){return _t().memoizedState}function $s(e,t,n,i){var c=Kt();Me.flags|=e,c.memoizedState=Mi(1|t,{destroy:void 0},n,i===void 0?null:i)}function Ps(e,t,n,i){var c=_t();i=i===void 0?null:i;var h=c.memoizedState.inst;et!==null&&i!==null&&Do(i,et.memoizedState.deps)?c.memoizedState=Mi(t,h,n,i):(Me.flags|=e,c.memoizedState=Mi(1|t,h,n,i))}function rh(e,t){$s(8390656,8,e,t)}function Go(e,t){Ps(2048,8,e,t)}function ay(e){Me.flags|=4;var t=Me.updateQueue;if(t===null)t=Is(),Me.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function sh(e){var t=_t().memoizedState;return ay({ref:t,nextImpl:e}),function(){if((Xe&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function lh(e,t){return Ps(4,2,e,t)}function oh(e,t){return Ps(4,4,e,t)}function ch(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function uh(e,t,n){n=n!=null?n.concat([e]):null,Ps(4,4,ch.bind(null,t,e),n)}function Ko(){}function dh(e,t){var n=_t();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&Do(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function hh(e,t){var n=_t();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&Do(t,i[1]))return i[0];if(i=e(),ei){Un(!0);try{e()}finally{Un(!1)}}return n.memoizedState=[i,t],i}function Yo(e,t,n){return n===void 0||(Qn&1073741824)!==0&&(Ge&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=gf(),Me.lanes|=e,Sa|=e,n)}function fh(e,t,n,i){return tn(n,t)?n:Ui.current!==null?(e=Yo(e,n,i),tn(e,t)||(wt=!0),e):(Qn&42)===0||(Qn&1073741824)!==0&&(Ge&261930)===0?(wt=!0,e.memoizedState=n):(e=gf(),Me.lanes|=e,Sa|=e,t)}function gh(e,t,n,i,c){var h=z.p;z.p=h!==0&&8>h?h:8;var y=C.T,x={};C.T=x,Qo(e,!1,t,n);try{var R=c(),G=C.S;if(G!==null&&G(x,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var ee=Zm(R,i);kr(e,t,ee,on(e))}else kr(e,t,i,on(e))}catch(se){kr(e,t,{then:function(){},status:"rejected",reason:se},on())}finally{z.p=h,y!==null&&x.types!==null&&(y.types=x.types),C.T=y}}function iy(){}function Jo(e,t,n,i){if(e.tag!==5)throw Error(l(476));var c=ph(e).queue;gh(e,c,t,X,n===null?iy:function(){return mh(e),n(i)})}function ph(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:X},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function mh(e){var t=ph(e);t.next===null&&(t=e.alternate.memoizedState),kr(e,t.next.queue,{},on())}function Fo(){return Ut(Fr)}function yh(){return _t().memoizedState}function vh(){return _t().memoizedState}function ry(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=on();e=ya(n);var i=va(t,e,n);i!==null&&(en(i,t,n),Tr(i,t,n)),t={cache:wo()},e.payload=t;return}t=t.return}}function sy(e,t,n){var i=on();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Gs(e)?_h(t,n):(n=fo(e,t,n,i),n!==null&&(en(n,e,i),xh(n,t,i)))}function bh(e,t,n){var i=on();kr(e,t,n,i)}function kr(e,t,n,i){var c={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gs(e))_h(t,c);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var y=t.lastRenderedState,x=h(y,n);if(c.hasEagerState=!0,c.eagerState=x,tn(x,y))return Es(e,t,c,0),it===null&&ws(),!1}catch{}finally{}if(n=fo(e,t,c,i),n!==null)return en(n,e,i),xh(n,t,i),!0}return!1}function Qo(e,t,n,i){if(i={lane:2,revertLane:Ac(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Gs(e)){if(t)throw Error(l(479))}else t=fo(e,n,i,2),t!==null&&en(t,e,2)}function Gs(e){var t=e.alternate;return e===Me||t!==null&&t===Me}function _h(e,t){Di=qs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function xh(e,t,n){if((n&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,gs(e,n)}}var zr={readContext:Ut,use:Hs,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useLayoutEffect:mt,useInsertionEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useSyncExternalStore:mt,useId:mt,useHostTransitionStatus:mt,useFormState:mt,useActionState:mt,useOptimistic:mt,useMemoCache:mt,useCacheRefresh:mt};zr.useEffectEvent=mt;var jh={readContext:Ut,use:Hs,useCallback:function(e,t){return Kt().memoizedState=[e,t===void 0?null:t],e},useContext:Ut,useEffect:rh,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,$s(4194308,4,ch.bind(null,t,e),n)},useLayoutEffect:function(e,t){return $s(4194308,4,e,t)},useInsertionEffect:function(e,t){$s(4,2,e,t)},useMemo:function(e,t){var n=Kt();t=t===void 0?null:t;var i=e();if(ei){Un(!0);try{e()}finally{Un(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Kt();if(n!==void 0){var c=n(t);if(ei){Un(!0);try{n(t)}finally{Un(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=sy.bind(null,Me,e),[i.memoizedState,e]},useRef:function(e){var t=Kt();return e={current:e},t.memoizedState=e},useState:function(e){e=$o(e);var t=e.queue,n=bh.bind(null,Me,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ko,useDeferredValue:function(e,t){var n=Kt();return Yo(n,e,t)},useTransition:function(){var e=$o(!1);return e=gh.bind(null,Me,e.queue,!0,!1),Kt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=Me,c=Kt();if(Ye){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),it===null)throw Error(l(349));(Ge&127)!==0||$d(i,t,n)}c.memoizedState=n;var h={value:n,getSnapshot:t};return c.queue=h,rh(Gd.bind(null,i,h,e),[e]),i.flags|=2048,Mi(9,{destroy:void 0},Pd.bind(null,i,h,n,t),null),n},useId:function(){var e=Kt(),t=it.identifierPrefix;if(Ye){var n=Ln,i=qn;n=(i&~(1<<32-Pt(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Ls++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Wm++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Fo,useFormState:eh,useActionState:eh,useOptimistic:function(e){var t=Kt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Qo.bind(null,Me,!0,n),n.dispatch=t,[e,t]},useMemoCache:Io,useCacheRefresh:function(){return Kt().memoizedState=ry.bind(null,Me)},useEffectEvent:function(e){var t=Kt(),n={impl:e};return t.memoizedState=n,function(){if((Xe&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},Xo={readContext:Ut,use:Hs,useCallback:dh,useContext:Ut,useEffect:Go,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:oh,useMemo:hh,useReducer:Vs,useRef:ih,useState:function(){return Vs(Xn)},useDebugValue:Ko,useDeferredValue:function(e,t){var n=_t();return fh(n,et.memoizedState,e,t)},useTransition:function(){var e=Vs(Xn)[0],t=_t().memoizedState;return[typeof e=="boolean"?e:Rr(e),t]},useSyncExternalStore:Vd,useId:yh,useHostTransitionStatus:Fo,useFormState:th,useActionState:th,useOptimistic:function(e,t){var n=_t();return Jd(n,et,e,t)},useMemoCache:Io,useCacheRefresh:vh};Xo.useEffectEvent=sh;var Sh={readContext:Ut,use:Hs,useCallback:dh,useContext:Ut,useEffect:Go,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:oh,useMemo:hh,useReducer:Vo,useRef:ih,useState:function(){return Vo(Xn)},useDebugValue:Ko,useDeferredValue:function(e,t){var n=_t();return et===null?Yo(n,e,t):fh(n,et.memoizedState,e,t)},useTransition:function(){var e=Vo(Xn)[0],t=_t().memoizedState;return[typeof e=="boolean"?e:Rr(e),t]},useSyncExternalStore:Vd,useId:yh,useHostTransitionStatus:Fo,useFormState:ah,useActionState:ah,useOptimistic:function(e,t){var n=_t();return et!==null?Jd(n,et,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Io,useCacheRefresh:vh};Sh.useEffectEvent=sh;function Zo(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:_({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wo={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=on(),c=ya(i);c.payload=t,n!=null&&(c.callback=n),t=va(e,c,i),t!==null&&(en(t,e,i),Tr(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=on(),c=ya(i);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=va(e,c,i),t!==null&&(en(t,e,i),Tr(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=on(),i=ya(n);i.tag=2,t!=null&&(i.callback=t),t=va(e,i,n),t!==null&&(en(t,e,n),Tr(t,e,n))}};function wh(e,t,n,i,c,h,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,h,y):t.prototype&&t.prototype.isPureReactComponent?!br(n,i)||!br(c,h):!0}function Eh(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Wo.enqueueReplaceState(t,t.state,null)}function ti(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=_({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Ch(e){Ss(e)}function Th(e){console.error(e)}function Ah(e){Ss(e)}function Ks(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Nh(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function ec(e,t,n){return n=ya(n),n.tag=3,n.payload={element:null},n.callback=function(){Ks(e,t)},n}function Oh(e){return e=ya(e),e.tag=3,e}function Rh(e,t,n,i){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=i.value;e.payload=function(){return c(h)},e.callback=function(){Nh(t,n,i)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Nh(t,n,i),typeof c!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})})}function ly(e,t,n,i,c){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Ni(t,n,c,!0),n=an.current,n!==null){switch(n.tag){case 31:case 13:return bn===null?il():n.alternate===null&&yt===0&&(yt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,i===zs?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),Ec(e,i,c)),!1;case 22:return n.flags|=65536,i===zs?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),Ec(e,i,c)),!1}throw Error(l(435,n.tag))}return Ec(e,i,c),il(),!1}if(Ye)return t=an.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==bo&&(e=Error(l(422),{cause:i}),jr(pn(e,n)))):(i!==bo&&(t=Error(l(423),{cause:i}),jr(pn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=pn(i,n),c=ec(e.stateNode,i,c),Oo(e,c),yt!==4&&(yt=2)),!1;var h=Error(l(520),{cause:i});if(h=pn(h,n),Hr===null?Hr=[h]:Hr.push(h),yt!==4&&(yt=2),t===null)return!0;i=pn(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=ec(n.stateNode,i,e),Oo(n,e),!1;case 1:if(t=n.type,h=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(wa===null||!wa.has(h))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Oh(c),Rh(c,e,n,i),Oo(n,c),!1}n=n.return}while(n!==null);return!1}var tc=Error(l(461)),wt=!1;function Dt(e,t,n,i){t.child=e===null?Dd(t,null,n,i):Wa(t,e.child,n,i)}function kh(e,t,n,i,c){n=n.render;var h=t.ref;if("ref"in i){var y={};for(var x in i)x!=="ref"&&(y[x]=i[x])}else y=i;return Fa(t),i=Bo(e,t,n,y,h,c),x=Mo(),e!==null&&!wt?(qo(e,t,c),Zn(e,t,c)):(Ye&&x&&yo(t),t.flags|=1,Dt(e,t,i,c),t.child)}function zh(e,t,n,i,c){if(e===null){var h=n.type;return typeof h=="function"&&!go(h)&&h.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=h,Uh(e,t,h,i,c)):(e=Ts(n.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!cc(e,c)){var y=h.memoizedProps;if(n=n.compare,n=n!==null?n:br,n(y,i)&&e.ref===t.ref)return Zn(e,t,c)}return t.flags|=1,e=Kn(h,i),e.ref=t.ref,e.return=t,t.child=e}function Uh(e,t,n,i,c){if(e!==null){var h=e.memoizedProps;if(br(h,i)&&e.ref===t.ref)if(wt=!1,t.pendingProps=i=h,cc(e,c))(e.flags&131072)!==0&&(wt=!0);else return t.lanes=e.lanes,Zn(e,t,c)}return nc(e,t,n,i,c)}function Dh(e,t,n,i){var c=i.children,h=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(h=h!==null?h.baseLanes|n:n,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~h}else i=0,t.child=null;return Bh(e,t,h,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Rs(t,h!==null?h.cachePool:null),h!==null?qd(t,h):ko(),Ld(t);else return i=t.lanes=536870912,Bh(e,t,h!==null?h.baseLanes|n:n,n,i)}else h!==null?(Rs(t,h.cachePool),qd(t,h),_a(),t.memoizedState=null):(e!==null&&Rs(t,null),ko(),_a());return Dt(e,t,c,n),t.child}function Ur(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bh(e,t,n,i,c){var h=Co();return h=h===null?null:{parent:jt._currentValue,pool:h},t.memoizedState={baseLanes:n,cachePool:h},e!==null&&Rs(t,null),ko(),Ld(t),e!==null&&Ni(e,t,i,!0),t.childLanes=c,null}function Ys(e,t){return t=Fs({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Mh(e,t,n){return Wa(t,e.child,null,n),e=Ys(t,t.pendingProps),e.flags|=2,rn(t),t.memoizedState=null,e}function oy(e,t,n){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ye){if(i.mode==="hidden")return e=Ys(t,i),t.lanes=536870912,Ur(null,e);if(Uo(t),(e=ut)?(e=Qf(e,vn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ha!==null?{id:qn,overflow:Ln}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,zt=t,ut=null)):e=null,e===null)throw ga(t);return t.lanes=536870912,null}return Ys(t,i)}var h=e.memoizedState;if(h!==null){var y=h.dehydrated;if(Uo(t),c)if(t.flags&256)t.flags&=-257,t=Mh(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(wt||Ni(e,t,n,!1),c=(n&e.childLanes)!==0,wt||c){if(i=it,i!==null&&(y=or(i,n),y!==0&&y!==h.retryLane))throw h.retryLane=y,Ga(e,y),en(i,e,y),tc;il(),t=Mh(e,t,n)}else e=h.treeContext,ut=_n(y.nextSibling),zt=t,Ye=!0,fa=null,vn=!1,e!==null&&Sd(t,e),t=Ys(t,i),t.flags|=4096;return t}return e=Kn(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Js(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function nc(e,t,n,i,c){return Fa(t),n=Bo(e,t,n,i,void 0,c),i=Mo(),e!==null&&!wt?(qo(e,t,c),Zn(e,t,c)):(Ye&&i&&yo(t),t.flags|=1,Dt(e,t,n,c),t.child)}function qh(e,t,n,i,c,h){return Fa(t),t.updateQueue=null,n=Hd(t,i,n,c),Id(e),i=Mo(),e!==null&&!wt?(qo(e,t,h),Zn(e,t,h)):(Ye&&i&&yo(t),t.flags|=1,Dt(e,t,n,h),t.child)}function Lh(e,t,n,i,c){if(Fa(t),t.stateNode===null){var h=Ei,y=n.contextType;typeof y=="object"&&y!==null&&(h=Ut(y)),h=new n(i,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Wo,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=i,h.state=t.memoizedState,h.refs={},Ao(t),y=n.contextType,h.context=typeof y=="object"&&y!==null?Ut(y):Ei,h.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(Zo(t,n,y,i),h.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(y=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),y!==h.state&&Wo.enqueueReplaceState(h,h.state,null),Nr(t,i,h,c),Ar(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){h=t.stateNode;var x=t.memoizedProps,R=ti(n,x);h.props=R;var G=h.context,ee=n.contextType;y=Ei,typeof ee=="object"&&ee!==null&&(y=Ut(ee));var se=n.getDerivedStateFromProps;ee=typeof se=="function"||typeof h.getSnapshotBeforeUpdate=="function",x=t.pendingProps!==x,ee||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(x||G!==y)&&Eh(t,h,i,y),ma=!1;var Y=t.memoizedState;h.state=Y,Nr(t,i,h,c),Ar(),G=t.memoizedState,x||Y!==G||ma?(typeof se=="function"&&(Zo(t,n,se,i),G=t.memoizedState),(R=ma||wh(t,n,R,i,Y,G,y))?(ee||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=G),h.props=i,h.state=G,h.context=y,i=R):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{h=t.stateNode,No(e,t),y=t.memoizedProps,ee=ti(n,y),h.props=ee,se=t.pendingProps,Y=h.context,G=n.contextType,R=Ei,typeof G=="object"&&G!==null&&(R=Ut(G)),x=n.getDerivedStateFromProps,(G=typeof x=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(y!==se||Y!==R)&&Eh(t,h,i,R),ma=!1,Y=t.memoizedState,h.state=Y,Nr(t,i,h,c),Ar();var Q=t.memoizedState;y!==se||Y!==Q||ma||e!==null&&e.dependencies!==null&&Ns(e.dependencies)?(typeof x=="function"&&(Zo(t,n,x,i),Q=t.memoizedState),(ee=ma||wh(t,n,ee,i,Y,Q,R)||e!==null&&e.dependencies!==null&&Ns(e.dependencies))?(G||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,Q,R),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,Q,R)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=Q),h.props=i,h.state=Q,h.context=R,i=ee):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),i=!1)}return h=i,Js(e,t),i=(t.flags&128)!==0,h||i?(h=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&i?(t.child=Wa(t,e.child,null,c),t.child=Wa(t,null,n,c)):Dt(e,t,n,c),t.memoizedState=h.state,e=t.child):e=Zn(e,t,c),e}function Ih(e,t,n,i){return Ya(),t.flags|=256,Dt(e,t,n,i),t.child}var ac={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ic(e){return{baseLanes:e,cachePool:Nd()}}function rc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=ln),e}function Hh(e,t,n){var i=t.pendingProps,c=!1,h=(t.flags&128)!==0,y;if((y=h)||(y=e!==null&&e.memoizedState===null?!1:(bt.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ye){if(c?ba(t):_a(),(e=ut)?(e=Qf(e,vn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ha!==null?{id:qn,overflow:Ln}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,zt=t,ut=null)):e=null,e===null)throw ga(t);return Hc(e)?t.lanes=32:t.lanes=536870912,null}var x=i.children;return i=i.fallback,c?(_a(),c=t.mode,x=Fs({mode:"hidden",children:x},c),i=Ka(i,c,n,null),x.return=t,i.return=t,x.sibling=i,t.child=x,i=t.child,i.memoizedState=ic(n),i.childLanes=rc(e,y,n),t.memoizedState=ac,Ur(null,i)):(ba(t),sc(t,x))}var R=e.memoizedState;if(R!==null&&(x=R.dehydrated,x!==null)){if(h)t.flags&256?(ba(t),t.flags&=-257,t=lc(e,t,n)):t.memoizedState!==null?(_a(),t.child=e.child,t.flags|=128,t=null):(_a(),x=i.fallback,c=t.mode,i=Fs({mode:"visible",children:i.children},c),x=Ka(x,c,n,null),x.flags|=2,i.return=t,x.return=t,i.sibling=x,t.child=i,Wa(t,e.child,null,n),i=t.child,i.memoizedState=ic(n),i.childLanes=rc(e,y,n),t.memoizedState=ac,t=Ur(null,i));else if(ba(t),Hc(x)){if(y=x.nextSibling&&x.nextSibling.dataset,y)var G=y.dgst;y=G,i=Error(l(419)),i.stack="",i.digest=y,jr({value:i,source:null,stack:null}),t=lc(e,t,n)}else if(wt||Ni(e,t,n,!1),y=(n&e.childLanes)!==0,wt||y){if(y=it,y!==null&&(i=or(y,n),i!==0&&i!==R.retryLane))throw R.retryLane=i,Ga(e,i),en(y,e,i),tc;Ic(x)||il(),t=lc(e,t,n)}else Ic(x)?(t.flags|=192,t.child=e.child,t=null):(e=R.treeContext,ut=_n(x.nextSibling),zt=t,Ye=!0,fa=null,vn=!1,e!==null&&Sd(t,e),t=sc(t,i.children),t.flags|=4096);return t}return c?(_a(),x=i.fallback,c=t.mode,R=e.child,G=R.sibling,i=Kn(R,{mode:"hidden",children:i.children}),i.subtreeFlags=R.subtreeFlags&65011712,G!==null?x=Kn(G,x):(x=Ka(x,c,n,null),x.flags|=2),x.return=t,i.return=t,i.sibling=x,t.child=i,Ur(null,i),i=t.child,x=e.child.memoizedState,x===null?x=ic(n):(c=x.cachePool,c!==null?(R=jt._currentValue,c=c.parent!==R?{parent:R,pool:R}:c):c=Nd(),x={baseLanes:x.baseLanes|n,cachePool:c}),i.memoizedState=x,i.childLanes=rc(e,y,n),t.memoizedState=ac,Ur(e.child,i)):(ba(t),n=e.child,e=n.sibling,n=Kn(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function sc(e,t){return t=Fs({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Fs(e,t){return e=nn(22,e,null,t),e.lanes=0,e}function lc(e,t,n){return Wa(t,e.child,null,n),e=sc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Vh(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),jo(e.return,t,n)}function oc(e,t,n,i,c,h){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:c,treeForkCount:h}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=n,y.tailMode=c,y.treeForkCount=h)}function $h(e,t,n){var i=t.pendingProps,c=i.revealOrder,h=i.tail;i=i.children;var y=bt.current,x=(y&2)!==0;if(x?(y=y&1|2,t.flags|=128):y&=1,$(bt,y),Dt(e,t,i,n),i=Ye?xr:0,!x&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vh(e,n,t);else if(e.tag===19)Vh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Ms(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),oc(t,!1,c,n,h,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Ms(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}oc(t,!0,n,null,h,i);break;case"together":oc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function Zn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Sa|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Ni(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Kn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Kn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Ns(e)))}function cy(e,t,n){switch(t.tag){case 3:he(t,t.stateNode.containerInfo),pa(t,jt,e.memoizedState.cache),Ya();break;case 27:case 5:ze(t);break;case 4:he(t,t.stateNode.containerInfo);break;case 10:pa(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Uo(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(ba(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Hh(e,t,n):(ba(t),e=Zn(e,t,n),e!==null?e.sibling:null);ba(t);break;case 19:var c=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Ni(e,t,n,!1),i=(n&t.childLanes)!==0),c){if(i)return $h(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),$(bt,bt.current),i)break;return null;case 22:return t.lanes=0,Dh(e,t,n,t.pendingProps);case 24:pa(t,jt,e.memoizedState.cache)}return Zn(e,t,n)}function Ph(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)wt=!0;else{if(!cc(e,n)&&(t.flags&128)===0)return wt=!1,cy(e,t,n);wt=(e.flags&131072)!==0}else wt=!1,Ye&&(t.flags&1048576)!==0&&jd(t,xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=Xa(t.elementType),t.type=e,typeof e=="function")go(e)?(i=ti(e,i),t.tag=1,t=Lh(null,t,e,i,n)):(t.tag=0,t=nc(null,t,e,i,n));else{if(e!=null){var c=e.$$typeof;if(c===K){t.tag=11,t=kh(null,t,e,i,n);break e}else if(c===D){t.tag=14,t=zh(null,t,e,i,n);break e}}throw t=Z(e)||e,Error(l(306,t,""))}}return t;case 0:return nc(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,c=ti(i,t.pendingProps),Lh(e,t,i,c,n);case 3:e:{if(he(t,t.stateNode.containerInfo),e===null)throw Error(l(387));i=t.pendingProps;var h=t.memoizedState;c=h.element,No(e,t),Nr(t,i,null,n);var y=t.memoizedState;if(i=y.cache,pa(t,jt,i),i!==h.cache&&So(t,[jt],n,!0),Ar(),i=y.element,h.isDehydrated)if(h={element:i,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=Ih(e,t,i,n);break e}else if(i!==c){c=pn(Error(l(424)),t),jr(c),t=Ih(e,t,i,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ut=_n(e.firstChild),zt=t,Ye=!0,fa=null,vn=!0,n=Dd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Ya(),i===c){t=Zn(e,t,n);break e}Dt(e,t,i,n)}t=t.child}return t;case 26:return Js(e,t),e===null?(n=ng(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ye||(n=t.type,e=t.pendingProps,i=dl(ne.current).createElement(n),i[xt]=t,i[Lt]=e,Bt(i,n,e),le(i),t.stateNode=i):t.memoizedState=ng(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return ze(t),e===null&&Ye&&(i=t.stateNode=Wf(t.type,t.pendingProps,ne.current),zt=t,vn=!0,c=ut,Aa(t.type)?(Vc=c,ut=_n(i.firstChild)):ut=c),Dt(e,t,t.pendingProps.children,n),Js(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ye&&((c=i=ut)&&(i=Ly(i,t.type,t.pendingProps,vn),i!==null?(t.stateNode=i,zt=t,ut=_n(i.firstChild),vn=!1,c=!0):c=!1),c||ga(t)),ze(t),c=t.type,h=t.pendingProps,y=e!==null?e.memoizedProps:null,i=h.children,Mc(c,h)?i=null:y!==null&&Mc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Bo(e,t,ey,null,null,n),Fr._currentValue=c),Js(e,t),Dt(e,t,i,n),t.child;case 6:return e===null&&Ye&&((e=n=ut)&&(n=Iy(n,t.pendingProps,vn),n!==null?(t.stateNode=n,zt=t,ut=null,e=!0):e=!1),e||ga(t)),null;case 13:return Hh(e,t,n);case 4:return he(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Wa(t,null,i,n):Dt(e,t,i,n),t.child;case 11:return kh(e,t,t.type,t.pendingProps,n);case 7:return Dt(e,t,t.pendingProps,n),t.child;case 8:return Dt(e,t,t.pendingProps.children,n),t.child;case 12:return Dt(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,pa(t,t.type,i.value),Dt(e,t,i.children,n),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,Fa(t),c=Ut(c),i=i(c),t.flags|=1,Dt(e,t,i,n),t.child;case 14:return zh(e,t,t.type,t.pendingProps,n);case 15:return Uh(e,t,t.type,t.pendingProps,n);case 19:return $h(e,t,n);case 31:return oy(e,t,n);case 22:return Dh(e,t,n,t.pendingProps);case 24:return Fa(t),i=Ut(jt),e===null?(c=Co(),c===null&&(c=it,h=wo(),c.pooledCache=h,h.refCount++,h!==null&&(c.pooledCacheLanes|=n),c=h),t.memoizedState={parent:i,cache:c},Ao(t),pa(t,jt,c)):((e.lanes&n)!==0&&(No(e,t),Nr(t,null,null,n),Ar()),c=e.memoizedState,h=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),pa(t,jt,i)):(i=h.cache,pa(t,jt,i),i!==c.cache&&So(t,[jt],n,!0))),Dt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Wn(e){e.flags|=4}function uc(e,t,n,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(vf())e.flags|=8192;else throw Za=zs,To}else e.flags&=-16777217}function Gh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!lg(t))if(vf())e.flags|=8192;else throw Za=zs,To}function Qs(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?hs():536870912,e.lanes|=t,Hi|=t)}function Dr(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function dt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function uy(e,t,n){var i=t.pendingProps;switch(vo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(t),null;case 1:return dt(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Fn(jt),xe(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ai(t)?Wn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,_o())),dt(t),null;case 26:var c=t.type,h=t.memoizedState;return e===null?(Wn(t),h!==null?(dt(t),Gh(t,h)):(dt(t),uc(t,c,null,i,n))):h?h!==e.memoizedState?(Wn(t),dt(t),Gh(t,h)):(dt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&Wn(t),dt(t),uc(t,c,e,i,n)),null;case 27:if(Pe(t),n=ne.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return dt(t),null}e=F.current,Ai(t)?wd(t):(e=Wf(c,i,n),t.stateNode=e,Wn(t))}return dt(t),null;case 5:if(Pe(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return dt(t),null}if(h=F.current,Ai(t))wd(t);else{var y=dl(ne.current);switch(h){case 1:h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":h=y.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?h.multiple=!0:i.size&&(h.size=i.size);break;default:h=typeof i.is=="string"?y.createElement(c,{is:i.is}):y.createElement(c)}}h[xt]=t,h[Lt]=i;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)h.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=h;e:switch(Bt(h,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Wn(t)}}return dt(t),uc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(l(166));if(e=ne.current,Ai(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,c=zt,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[xt]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Vf(e.nodeValue,n)),e||ga(t,!0)}else e=dl(e).createTextNode(i),e[xt]=t,t.stateNode=e}return dt(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(i=Ai(t),n!==null){if(e===null){if(!i)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[xt]=t}else Ya(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;dt(t),e=!1}else n=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(rn(t),t):(rn(t),null);if((t.flags&128)!==0)throw Error(l(558))}return dt(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Ai(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[xt]=t}else Ya(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;dt(t),c=!1}else c=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(rn(t),t):(rn(t),null)}return rn(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,e=e!==null&&e.memoizedState!==null,n&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==c&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Qs(t,t.updateQueue),dt(t),null);case 4:return xe(),e===null&&kc(t.stateNode.containerInfo),dt(t),null;case 10:return Fn(t.type),dt(t),null;case 19:if(U(bt),i=t.memoizedState,i===null)return dt(t),null;if(c=(t.flags&128)!==0,h=i.rendering,h===null)if(c)Dr(i,!1);else{if(yt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=Ms(e),h!==null){for(t.flags|=128,Dr(i,!1),e=h.updateQueue,t.updateQueue=e,Qs(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)bd(n,e),n=n.sibling;return $(bt,bt.current&1|2),Ye&&Yn(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Rt()>tl&&(t.flags|=128,c=!0,Dr(i,!1),t.lanes=4194304)}else{if(!c)if(e=Ms(h),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,Qs(t,e),Dr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!h.alternate&&!Ye)return dt(t),null}else 2*Rt()-i.renderingStartTime>tl&&n!==536870912&&(t.flags|=128,c=!0,Dr(i,!1),t.lanes=4194304);i.isBackwards?(h.sibling=t.child,t.child=h):(e=i.last,e!==null?e.sibling=h:t.child=h,i.last=h)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Rt(),e.sibling=null,n=bt.current,$(bt,c?n&1|2:n&1),Ye&&Yn(t,i.treeForkCount),e):(dt(t),null);case 22:case 23:return rn(t),zo(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(dt(t),t.subtreeFlags&6&&(t.flags|=8192)):dt(t),n=t.updateQueue,n!==null&&Qs(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&U(Qa),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Fn(jt),dt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function dy(e,t){switch(vo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fn(jt),xe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Pe(t),null;case 31:if(t.memoizedState!==null){if(rn(t),t.alternate===null)throw Error(l(340));Ya()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(rn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Ya()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return U(bt),null;case 4:return xe(),null;case 10:return Fn(t.type),null;case 22:case 23:return rn(t),zo(),e!==null&&U(Qa),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Fn(jt),null;case 25:return null;default:return null}}function Kh(e,t){switch(vo(t),t.tag){case 3:Fn(jt),xe();break;case 26:case 27:case 5:Pe(t);break;case 4:xe();break;case 31:t.memoizedState!==null&&rn(t);break;case 13:rn(t);break;case 19:U(bt);break;case 10:Fn(t.type);break;case 22:case 23:rn(t),zo(),e!==null&&U(Qa);break;case 24:Fn(jt)}}function Br(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var c=i.next;n=c;do{if((n.tag&e)===e){i=void 0;var h=n.create,y=n.inst;i=h(),y.destroy=i}n=n.next}while(n!==c)}}catch(x){We(t,t.return,x)}}function xa(e,t,n){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var h=c.next;i=h;do{if((i.tag&e)===e){var y=i.inst,x=y.destroy;if(x!==void 0){y.destroy=void 0,c=t;var R=n,G=x;try{G()}catch(ee){We(c,R,ee)}}}i=i.next}while(i!==h)}}catch(ee){We(t,t.return,ee)}}function Yh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Md(t,n)}catch(i){We(e,e.return,i)}}}function Jh(e,t,n){n.props=ti(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){We(e,t,i)}}function Mr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof n=="function"?e.refCleanup=n(i):n.current=i}}catch(c){We(e,t,c)}}function In(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(c){We(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){We(e,t,c)}else n.current=null}function Fh(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(c){We(e,e.return,c)}}function dc(e,t,n){try{var i=e.stateNode;zy(i,e.type,n,t),i[Lt]=t}catch(c){We(e,e.return,c)}}function Qh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Aa(e.type)||e.tag===4}function hc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Qh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Aa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fc(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pn));else if(i!==4&&(i===27&&Aa(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(fc(e,t,n),e=e.sibling;e!==null;)fc(e,t,n),e=e.sibling}function Xs(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(i===27&&Aa(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Xs(e,t,n),e=e.sibling;e!==null;)Xs(e,t,n),e=e.sibling}function Xh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Bt(t,i,n),t[xt]=e,t[Lt]=n}catch(h){We(e,e.return,h)}}var ea=!1,Et=!1,gc=!1,Zh=typeof WeakSet=="function"?WeakSet:Set,Ot=null;function hy(e,t){if(e=e.containerInfo,Dc=vl,e=ud(e),so(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var c=i.anchorOffset,h=i.focusNode;i=i.focusOffset;try{n.nodeType,h.nodeType}catch{n=null;break e}var y=0,x=-1,R=-1,G=0,ee=0,se=e,Y=null;t:for(;;){for(var Q;se!==n||c!==0&&se.nodeType!==3||(x=y+c),se!==h||i!==0&&se.nodeType!==3||(R=y+i),se.nodeType===3&&(y+=se.nodeValue.length),(Q=se.firstChild)!==null;)Y=se,se=Q;for(;;){if(se===e)break t;if(Y===n&&++G===c&&(x=y),Y===h&&++ee===i&&(R=y),(Q=se.nextSibling)!==null)break;se=Y,Y=se.parentNode}se=Q}n=x===-1||R===-1?null:{start:x,end:R}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bc={focusedElem:e,selectionRange:n},vl=!1,Ot=t;Ot!==null;)if(t=Ot,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ot=e;else for(;Ot!==null;){switch(t=Ot,h=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,n=t,c=h.memoizedProps,h=h.memoizedState,i=n.stateNode;try{var je=ti(n.type,c);e=i.getSnapshotBeforeUpdate(je,h),i.__reactInternalSnapshotBeforeUpdate=e}catch(Ae){We(n,n.return,Ae)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Lc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Lc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Ot=e;break}Ot=t.return}}function Wh(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:na(e,n),i&4&&Br(5,n);break;case 1:if(na(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){We(n,n.return,y)}else{var c=ti(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){We(n,n.return,y)}}i&64&&Yh(n),i&512&&Mr(n,n.return);break;case 3:if(na(e,n),i&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Md(e,t)}catch(y){We(n,n.return,y)}}break;case 27:t===null&&i&4&&Xh(n);case 26:case 5:na(e,n),t===null&&i&4&&Fh(n),i&512&&Mr(n,n.return);break;case 12:na(e,n);break;case 31:na(e,n),i&4&&nf(e,n);break;case 13:na(e,n),i&4&&af(e,n),i&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=xy.bind(null,n),Hy(e,n))));break;case 22:if(i=n.memoizedState!==null||ea,!i){t=t!==null&&t.memoizedState!==null||Et,c=ea;var h=Et;ea=i,(Et=t)&&!h?aa(e,n,(n.subtreeFlags&8772)!==0):na(e,n),ea=c,Et=h}break;case 30:break;default:na(e,n)}}function ef(e){var t=e.alternate;t!==null&&(e.alternate=null,ef(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ft=null,Qt=!1;function ta(e,t,n){for(n=n.child;n!==null;)tf(e,t,n),n=n.sibling}function tf(e,t,n){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(qa,n)}catch{}switch(n.tag){case 26:Et||In(n,t),ta(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Et||In(n,t);var i=ft,c=Qt;Aa(n.type)&&(ft=n.stateNode,Qt=!1),ta(e,t,n),Kr(n.stateNode),ft=i,Qt=c;break;case 5:Et||In(n,t);case 6:if(i=ft,c=Qt,ft=null,ta(e,t,n),ft=i,Qt=c,ft!==null)if(Qt)try{(ft.nodeType===9?ft.body:ft.nodeName==="HTML"?ft.ownerDocument.body:ft).removeChild(n.stateNode)}catch(h){We(n,t,h)}else try{ft.removeChild(n.stateNode)}catch(h){We(n,t,h)}break;case 18:ft!==null&&(Qt?(e=ft,Jf(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Fi(e)):Jf(ft,n.stateNode));break;case 4:i=ft,c=Qt,ft=n.stateNode.containerInfo,Qt=!0,ta(e,t,n),ft=i,Qt=c;break;case 0:case 11:case 14:case 15:xa(2,n,t),Et||xa(4,n,t),ta(e,t,n);break;case 1:Et||(In(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Jh(n,t,i)),ta(e,t,n);break;case 21:ta(e,t,n);break;case 22:Et=(i=Et)||n.memoizedState!==null,ta(e,t,n),Et=i;break;default:ta(e,t,n)}}function nf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Fi(e)}catch(n){We(t,t.return,n)}}}function af(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Fi(e)}catch(n){We(t,t.return,n)}}function fy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Zh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Zh),t;default:throw Error(l(435,e.tag))}}function Zs(e,t){var n=fy(e);t.forEach(function(i){if(!n.has(i)){n.add(i);var c=jy.bind(null,e,i);i.then(c,c)}})}function Xt(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var c=n[i],h=e,y=t,x=y;e:for(;x!==null;){switch(x.tag){case 27:if(Aa(x.type)){ft=x.stateNode,Qt=!1;break e}break;case 5:ft=x.stateNode,Qt=!1;break e;case 3:case 4:ft=x.stateNode.containerInfo,Qt=!0;break e}x=x.return}if(ft===null)throw Error(l(160));tf(h,y,c),ft=null,Qt=!1,h=c.alternate,h!==null&&(h.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)rf(t,e),t=t.sibling}var An=null;function rf(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Xt(t,e),Zt(e),i&4&&(xa(3,e,e.return),Br(3,e),xa(5,e,e.return));break;case 1:Xt(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),i&64&&ea&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var c=An;if(Xt(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),i&4){var h=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":h=c.getElementsByTagName("title")[0],(!h||h[oe]||h[xt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=c.createElement(i),c.head.insertBefore(h,c.querySelector("head > title"))),Bt(h,i,n),h[xt]=e,le(h),i=h;break e;case"link":var y=rg("link","href",c).get(i+(n.href||""));if(y){for(var x=0;x<y.length;x++)if(h=y[x],h.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&h.getAttribute("rel")===(n.rel==null?null:n.rel)&&h.getAttribute("title")===(n.title==null?null:n.title)&&h.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(x,1);break t}}h=c.createElement(i),Bt(h,i,n),c.head.appendChild(h);break;case"meta":if(y=rg("meta","content",c).get(i+(n.content||""))){for(x=0;x<y.length;x++)if(h=y[x],h.getAttribute("content")===(n.content==null?null:""+n.content)&&h.getAttribute("name")===(n.name==null?null:n.name)&&h.getAttribute("property")===(n.property==null?null:n.property)&&h.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&h.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(x,1);break t}}h=c.createElement(i),Bt(h,i,n),c.head.appendChild(h);break;default:throw Error(l(468,i))}h[xt]=e,le(h),i=h}e.stateNode=i}else sg(c,e.type,e.stateNode);else e.stateNode=ig(c,i,e.memoizedProps);else h!==i?(h===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):h.count--,i===null?sg(c,e.type,e.stateNode):ig(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&dc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Xt(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),n!==null&&i&4&&dc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Xt(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),e.flags&32){c=e.stateNode;try{vi(c,"")}catch(je){We(e,e.return,je)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,dc(e,c,n!==null?n.memoizedProps:c)),i&1024&&(gc=!0);break;case 6:if(Xt(t,e),Zt(e),i&4){if(e.stateNode===null)throw Error(l(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(je){We(e,e.return,je)}}break;case 3:if(gl=null,c=An,An=hl(t.containerInfo),Xt(t,e),An=c,Zt(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Fi(t.containerInfo)}catch(je){We(e,e.return,je)}gc&&(gc=!1,sf(e));break;case 4:i=An,An=hl(e.stateNode.containerInfo),Xt(t,e),Zt(e),An=i;break;case 12:Xt(t,e),Zt(e);break;case 31:Xt(t,e),Zt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 13:Xt(t,e),Zt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(el=Rt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 22:c=e.memoizedState!==null;var R=n!==null&&n.memoizedState!==null,G=ea,ee=Et;if(ea=G||c,Et=ee||R,Xt(t,e),Et=ee,ea=G,Zt(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||R||ea||Et||ni(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){R=n=t;try{if(h=R.stateNode,c)y=h.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{x=R.stateNode;var se=R.memoizedProps.style,Y=se!=null&&se.hasOwnProperty("display")?se.display:null;x.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(je){We(R,R.return,je)}}}else if(t.tag===6){if(n===null){R=t;try{R.stateNode.nodeValue=c?"":R.memoizedProps}catch(je){We(R,R.return,je)}}}else if(t.tag===18){if(n===null){R=t;try{var Q=R.stateNode;c?Ff(Q,!0):Ff(R.stateNode,!1)}catch(je){We(R,R.return,je)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,Zs(e,n))));break;case 19:Xt(t,e),Zt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 30:break;case 21:break;default:Xt(t,e),Zt(e)}}function Zt(e){var t=e.flags;if(t&2){try{for(var n,i=e.return;i!==null;){if(Qh(i)){n=i;break}i=i.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,h=hc(e);Xs(e,h,c);break;case 5:var y=n.stateNode;n.flags&32&&(vi(y,""),n.flags&=-33);var x=hc(e);Xs(e,x,y);break;case 3:case 4:var R=n.stateNode.containerInfo,G=hc(e);fc(e,G,R);break;default:throw Error(l(161))}}catch(ee){We(e,e.return,ee)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;sf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function na(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Wh(e,t.alternate,t),t=t.sibling}function ni(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:xa(4,t,t.return),ni(t);break;case 1:In(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Jh(t,t.return,n),ni(t);break;case 27:Kr(t.stateNode);case 26:case 5:In(t,t.return),ni(t);break;case 22:t.memoizedState===null&&ni(t);break;case 30:ni(t);break;default:ni(t)}e=e.sibling}}function aa(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,h=t,y=h.flags;switch(h.tag){case 0:case 11:case 15:aa(c,h,n),Br(4,h);break;case 1:if(aa(c,h,n),i=h,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(G){We(i,i.return,G)}if(i=h,c=i.updateQueue,c!==null){var x=i.stateNode;try{var R=c.shared.hiddenCallbacks;if(R!==null)for(c.shared.hiddenCallbacks=null,c=0;c<R.length;c++)Bd(R[c],x)}catch(G){We(i,i.return,G)}}n&&y&64&&Yh(h),Mr(h,h.return);break;case 27:Xh(h);case 26:case 5:aa(c,h,n),n&&i===null&&y&4&&Fh(h),Mr(h,h.return);break;case 12:aa(c,h,n);break;case 31:aa(c,h,n),n&&y&4&&nf(c,h);break;case 13:aa(c,h,n),n&&y&4&&af(c,h);break;case 22:h.memoizedState===null&&aa(c,h,n),Mr(h,h.return);break;case 30:break;default:aa(c,h,n)}t=t.sibling}}function pc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Sr(n))}function mc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Sr(e))}function Nn(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)lf(e,t,n,i),t=t.sibling}function lf(e,t,n,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Nn(e,t,n,i),c&2048&&Br(9,t);break;case 1:Nn(e,t,n,i);break;case 3:Nn(e,t,n,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Sr(e)));break;case 12:if(c&2048){Nn(e,t,n,i),e=t.stateNode;try{var h=t.memoizedProps,y=h.id,x=h.onPostCommit;typeof x=="function"&&x(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(R){We(t,t.return,R)}}else Nn(e,t,n,i);break;case 31:Nn(e,t,n,i);break;case 13:Nn(e,t,n,i);break;case 23:break;case 22:h=t.stateNode,y=t.alternate,t.memoizedState!==null?h._visibility&2?Nn(e,t,n,i):qr(e,t):h._visibility&2?Nn(e,t,n,i):(h._visibility|=2,qi(e,t,n,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&pc(y,t);break;case 24:Nn(e,t,n,i),c&2048&&mc(t.alternate,t);break;default:Nn(e,t,n,i)}}function qi(e,t,n,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var h=e,y=t,x=n,R=i,G=y.flags;switch(y.tag){case 0:case 11:case 15:qi(h,y,x,R,c),Br(8,y);break;case 23:break;case 22:var ee=y.stateNode;y.memoizedState!==null?ee._visibility&2?qi(h,y,x,R,c):qr(h,y):(ee._visibility|=2,qi(h,y,x,R,c)),c&&G&2048&&pc(y.alternate,y);break;case 24:qi(h,y,x,R,c),c&&G&2048&&mc(y.alternate,y);break;default:qi(h,y,x,R,c)}t=t.sibling}}function qr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,c=i.flags;switch(i.tag){case 22:qr(n,i),c&2048&&pc(i.alternate,i);break;case 24:qr(n,i),c&2048&&mc(i.alternate,i);break;default:qr(n,i)}t=t.sibling}}var Lr=8192;function Li(e,t,n){if(e.subtreeFlags&Lr)for(e=e.child;e!==null;)of(e,t,n),e=e.sibling}function of(e,t,n){switch(e.tag){case 26:Li(e,t,n),e.flags&Lr&&e.memoizedState!==null&&Wy(n,An,e.memoizedState,e.memoizedProps);break;case 5:Li(e,t,n);break;case 3:case 4:var i=An;An=hl(e.stateNode.containerInfo),Li(e,t,n),An=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Lr,Lr=16777216,Li(e,t,n),Lr=i):Li(e,t,n));break;default:Li(e,t,n)}}function cf(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ir(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Ot=i,df(i,e)}cf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)uf(e),e=e.sibling}function uf(e){switch(e.tag){case 0:case 11:case 15:Ir(e),e.flags&2048&&xa(9,e,e.return);break;case 3:Ir(e);break;case 12:Ir(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Ws(e)):Ir(e);break;default:Ir(e)}}function Ws(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Ot=i,df(i,e)}cf(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:xa(8,t,t.return),Ws(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Ws(t));break;default:Ws(t)}e=e.sibling}}function df(e,t){for(;Ot!==null;){var n=Ot;switch(n.tag){case 0:case 11:case 15:xa(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Sr(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,Ot=i;else e:for(n=e;Ot!==null;){i=Ot;var c=i.sibling,h=i.return;if(ef(i),i===n){Ot=null;break e}if(c!==null){c.return=h,Ot=c;break e}Ot=h}}}var gy={getCacheForType:function(e){var t=Ut(jt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Ut(jt).controller.signal}},py=typeof WeakMap=="function"?WeakMap:Map,Xe=0,it=null,Ve=null,Ge=0,Ze=0,sn=null,ja=!1,Ii=!1,yc=!1,ia=0,yt=0,Sa=0,ai=0,vc=0,ln=0,Hi=0,Hr=null,Wt=null,bc=!1,el=0,hf=0,tl=1/0,nl=null,wa=null,At=0,Ea=null,Vi=null,ra=0,_c=0,xc=null,ff=null,Vr=0,jc=null;function on(){return(Xe&2)!==0&&Ge!==0?Ge&-Ge:C.T!==null?Ac():Bn()}function gf(){if(ln===0)if((Ge&536870912)===0||Ye){var e=dn;dn<<=1,(dn&3932160)===0&&(dn=262144),ln=e}else ln=536870912;return e=an.current,e!==null&&(e.flags|=32),ln}function en(e,t,n){(e===it&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)&&($i(e,0),Ca(e,Ge,ln,!1)),En(e,n),((Xe&2)===0||e!==it)&&(e===it&&((Xe&2)===0&&(ai|=n),yt===4&&Ca(e,Ge,ln,!1)),Hn(e))}function pf(e,t,n){if((Xe&6)!==0)throw Error(l(327));var i=!n&&(t&127)===0&&(t&e.expiredLanes)===0||La(e,t),c=i?vy(e,t):wc(e,t,!0),h=i;do{if(c===0){Ii&&!i&&Ca(e,t,0,!1);break}else{if(n=e.current.alternate,h&&!my(n)){c=wc(e,t,!1),h=!1;continue}if(c===2){if(h=t,e.errorRecoveryDisabledLanes&h)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var x=e;c=Hr;var R=x.current.memoizedState.isDehydrated;if(R&&($i(x,y).flags|=256),y=wc(x,y,!1),y!==2){if(yc&&!R){x.errorRecoveryDisabledLanes|=h,ai|=h,c=4;break e}h=Wt,Wt=c,h!==null&&(Wt===null?Wt=h:Wt.push.apply(Wt,h))}c=y}if(h=!1,c!==2)continue}}if(c===1){$i(e,0),Ca(e,t,0,!0);break}e:{switch(i=e,h=c,h){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Ca(i,t,ln,!ja);break e;case 2:Wt=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=el+300-Rt(),10<c)){if(Ca(i,t,ln,!ja),pi(i,0,!0)!==0)break e;ra=t,i.timeoutHandle=Kf(mf.bind(null,i,n,Wt,nl,bc,t,ln,ai,Hi,ja,h,"Throttled",-0,0),c);break e}mf(i,n,Wt,nl,bc,t,ln,ai,Hi,ja,h,null,-0,0)}}break}while(!0);Hn(e)}function mf(e,t,n,i,c,h,y,x,R,G,ee,se,Y,Q){if(e.timeoutHandle=-1,se=t.subtreeFlags,se&8192||(se&16785408)===16785408){se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pn},of(t,h,se);var je=(h&62914560)===h?el-Rt():(h&4194048)===h?hf-Rt():0;if(je=ev(se,je),je!==null){ra=h,e.cancelPendingCommit=je(wf.bind(null,e,t,h,n,i,c,y,x,R,ee,se,null,Y,Q)),Ca(e,h,y,!G);return}}wf(e,t,h,n,i,c,y,x,R)}function my(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var c=n[i],h=c.getSnapshot;c=c.value;try{if(!tn(h(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ca(e,t,n,i){t&=~vc,t&=~ai,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var h=31-Pt(c),y=1<<h;i[h]=-1,c&=~y}n!==0&&fs(e,n,t)}function al(){return(Xe&6)===0?($r(0),!1):!0}function Sc(){if(Ve!==null){if(Ze===0)var e=Ve.return;else e=Ve,Jn=Ja=null,Lo(e),zi=null,Er=0,e=Ve;for(;e!==null;)Kh(e.alternate,e),e=e.return;Ve=null}}function $i(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,By(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),ra=0,Sc(),it=e,Ve=n=Kn(e.current,null),Ge=t,Ze=0,sn=null,ja=!1,Ii=La(e,t),yc=!1,Hi=ln=vc=ai=Sa=yt=0,Wt=Hr=null,bc=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-Pt(i),h=1<<c;t|=e[c],i&=~h}return ia=t,ws(),n}function yf(e,t){Me=null,C.H=zr,t===ki||t===ks?(t=kd(),Ze=3):t===To?(t=kd(),Ze=4):Ze=t===tc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,sn=t,Ve===null&&(yt=1,Ks(e,pn(t,e.current)))}function vf(){var e=an.current;return e===null?!0:(Ge&4194048)===Ge?bn===null:(Ge&62914560)===Ge||(Ge&536870912)!==0?e===bn:!1}function bf(){var e=C.H;return C.H=zr,e===null?zr:e}function _f(){var e=C.A;return C.A=gy,e}function il(){yt=4,ja||(Ge&4194048)!==Ge&&an.current!==null||(Ii=!0),(Sa&134217727)===0&&(ai&134217727)===0||it===null||Ca(it,Ge,ln,!1)}function wc(e,t,n){var i=Xe;Xe|=2;var c=bf(),h=_f();(it!==e||Ge!==t)&&(nl=null,$i(e,t)),t=!1;var y=yt;e:do try{if(Ze!==0&&Ve!==null){var x=Ve,R=sn;switch(Ze){case 8:Sc(),y=6;break e;case 3:case 2:case 9:case 6:an.current===null&&(t=!0);var G=Ze;if(Ze=0,sn=null,Pi(e,x,R,G),n&&Ii){y=0;break e}break;default:G=Ze,Ze=0,sn=null,Pi(e,x,R,G)}}yy(),y=yt;break}catch(ee){yf(e,ee)}while(!0);return t&&e.shellSuspendCounter++,Jn=Ja=null,Xe=i,C.H=c,C.A=h,Ve===null&&(it=null,Ge=0,ws()),y}function yy(){for(;Ve!==null;)xf(Ve)}function vy(e,t){var n=Xe;Xe|=2;var i=bf(),c=_f();it!==e||Ge!==t?(nl=null,tl=Rt()+500,$i(e,t)):Ii=La(e,t);e:do try{if(Ze!==0&&Ve!==null){t=Ve;var h=sn;t:switch(Ze){case 1:Ze=0,sn=null,Pi(e,t,h,1);break;case 2:case 9:if(Od(h)){Ze=0,sn=null,jf(t);break}t=function(){Ze!==2&&Ze!==9||it!==e||(Ze=7),Hn(e)},h.then(t,t);break e;case 3:Ze=7;break e;case 4:Ze=5;break e;case 7:Od(h)?(Ze=0,sn=null,jf(t)):(Ze=0,sn=null,Pi(e,t,h,7));break;case 5:var y=null;switch(Ve.tag){case 26:y=Ve.memoizedState;case 5:case 27:var x=Ve;if(y?lg(y):x.stateNode.complete){Ze=0,sn=null;var R=x.sibling;if(R!==null)Ve=R;else{var G=x.return;G!==null?(Ve=G,rl(G)):Ve=null}break t}}Ze=0,sn=null,Pi(e,t,h,5);break;case 6:Ze=0,sn=null,Pi(e,t,h,6);break;case 8:Sc(),yt=6;break e;default:throw Error(l(462))}}by();break}catch(ee){yf(e,ee)}while(!0);return Jn=Ja=null,C.H=i,C.A=c,Xe=n,Ve!==null?0:(it=null,Ge=0,ws(),yt)}function by(){for(;Ve!==null&&!zn();)xf(Ve)}function xf(e){var t=Ph(e.alternate,e,ia);e.memoizedProps=e.pendingProps,t===null?rl(e):Ve=t}function jf(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=qh(n,t,t.pendingProps,t.type,void 0,Ge);break;case 11:t=qh(n,t,t.pendingProps,t.type.render,t.ref,Ge);break;case 5:Lo(t);default:Kh(n,t),t=Ve=bd(t,ia),t=Ph(n,t,ia)}e.memoizedProps=e.pendingProps,t===null?rl(e):Ve=t}function Pi(e,t,n,i){Jn=Ja=null,Lo(t),zi=null,Er=0;var c=t.return;try{if(ly(e,c,t,n,Ge)){yt=1,Ks(e,pn(n,e.current)),Ve=null;return}}catch(h){if(c!==null)throw Ve=c,h;yt=1,Ks(e,pn(n,e.current)),Ve=null;return}t.flags&32768?(Ye||i===1?e=!0:Ii||(Ge&536870912)!==0?e=!1:(ja=e=!0,(i===2||i===9||i===3||i===6)&&(i=an.current,i!==null&&i.tag===13&&(i.flags|=16384))),Sf(t,e)):rl(t)}function rl(e){var t=e;do{if((t.flags&32768)!==0){Sf(t,ja);return}e=t.return;var n=uy(t.alternate,t,ia);if(n!==null){Ve=n;return}if(t=t.sibling,t!==null){Ve=t;return}Ve=t=e}while(t!==null);yt===0&&(yt=5)}function Sf(e,t){do{var n=dy(e.alternate,e);if(n!==null){n.flags&=32767,Ve=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ve=e;return}Ve=e=n}while(e!==null);yt=6,Ve=null}function wf(e,t,n,i,c,h,y,x,R){e.cancelPendingCommit=null;do sl();while(At!==0);if((Xe&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(h=t.lanes|t.childLanes,h|=ho,Kl(e,n,h,y,x,R),e===it&&(Ve=it=null,Ge=0),Vi=t,Ea=e,ra=n,_c=h,xc=c,ff=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Sy(Ma,function(){return Nf(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=C.T,C.T=null,c=z.p,z.p=2,y=Xe,Xe|=4;try{hy(e,t,n)}finally{Xe=y,z.p=c,C.T=i}}At=1,Ef(),Cf(),Tf()}}function Ef(){if(At===1){At=0;var e=Ea,t=Vi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=C.T,C.T=null;var i=z.p;z.p=2;var c=Xe;Xe|=4;try{rf(t,e);var h=Bc,y=ud(e.containerInfo),x=h.focusedElem,R=h.selectionRange;if(y!==x&&x&&x.ownerDocument&&cd(x.ownerDocument.documentElement,x)){if(R!==null&&so(x)){var G=R.start,ee=R.end;if(ee===void 0&&(ee=G),"selectionStart"in x)x.selectionStart=G,x.selectionEnd=Math.min(ee,x.value.length);else{var se=x.ownerDocument||document,Y=se&&se.defaultView||window;if(Y.getSelection){var Q=Y.getSelection(),je=x.textContent.length,Ae=Math.min(R.start,je),nt=R.end===void 0?Ae:Math.min(R.end,je);!Q.extend&&Ae>nt&&(y=nt,nt=Ae,Ae=y);var L=od(x,Ae),k=od(x,nt);if(L&&k&&(Q.rangeCount!==1||Q.anchorNode!==L.node||Q.anchorOffset!==L.offset||Q.focusNode!==k.node||Q.focusOffset!==k.offset)){var P=se.createRange();P.setStart(L.node,L.offset),Q.removeAllRanges(),Ae>nt?(Q.addRange(P),Q.extend(k.node,k.offset)):(P.setEnd(k.node,k.offset),Q.addRange(P))}}}}for(se=[],Q=x;Q=Q.parentNode;)Q.nodeType===1&&se.push({element:Q,left:Q.scrollLeft,top:Q.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<se.length;x++){var ae=se[x];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}vl=!!Dc,Bc=Dc=null}finally{Xe=c,z.p=i,C.T=n}}e.current=t,At=2}}function Cf(){if(At===2){At=0;var e=Ea,t=Vi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=C.T,C.T=null;var i=z.p;z.p=2;var c=Xe;Xe|=4;try{Wh(e,t.alternate,t)}finally{Xe=c,z.p=i,C.T=n}}At=3}}function Tf(){if(At===4||At===3){At=0,Hl();var e=Ea,t=Vi,n=ra,i=ff;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?At=5:(At=0,Vi=Ea=null,Af(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(wa=null),Ha(n),t=t.stateNode,$t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(qa,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=C.T,c=z.p,z.p=2,C.T=null;try{for(var h=e.onRecoverableError,y=0;y<i.length;y++){var x=i[y];h(x.value,{componentStack:x.stack})}}finally{C.T=t,z.p=c}}(ra&3)!==0&&sl(),Hn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===jc?Vr++:(Vr=0,jc=e):Vr=0,$r(0)}}function Af(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Sr(t)))}function sl(){return Ef(),Cf(),Tf(),Nf()}function Nf(){if(At!==5)return!1;var e=Ea,t=_c;_c=0;var n=Ha(ra),i=C.T,c=z.p;try{z.p=32>n?32:n,C.T=null,n=xc,xc=null;var h=Ea,y=ra;if(At=0,Vi=Ea=null,ra=0,(Xe&6)!==0)throw Error(l(331));var x=Xe;if(Xe|=4,uf(h.current),lf(h,h.current,y,n),Xe=x,$r(0,!1),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(qa,h)}catch{}return!0}finally{z.p=c,C.T=i,Af(e,t)}}function Of(e,t,n){t=pn(n,t),t=ec(e.stateNode,t,2),e=va(e,t,2),e!==null&&(En(e,2),Hn(e))}function We(e,t,n){if(e.tag===3)Of(e,e,n);else for(;t!==null;){if(t.tag===3){Of(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(wa===null||!wa.has(i))){e=pn(n,e),n=Oh(2),i=va(t,n,2),i!==null&&(Rh(n,i,t,e),En(i,2),Hn(i));break}}t=t.return}}function Ec(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new py;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(n)||(yc=!0,c.add(n),e=_y.bind(null,e,t,n),t.then(e,e))}function _y(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,it===e&&(Ge&n)===n&&(yt===4||yt===3&&(Ge&62914560)===Ge&&300>Rt()-el?(Xe&2)===0&&$i(e,0):vc|=n,Hi===Ge&&(Hi=0)),Hn(e)}function Rf(e,t){t===0&&(t=hs()),e=Ga(e,t),e!==null&&(En(e,t),Hn(e))}function xy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Rf(e,n)}function jy(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(t),Rf(e,n)}function Sy(e,t){return st(e,t)}var ll=null,Gi=null,Cc=!1,ol=!1,Tc=!1,Ta=0;function Hn(e){e!==Gi&&e.next===null&&(Gi===null?ll=Gi=e:Gi=Gi.next=e),ol=!0,Cc||(Cc=!0,Ey())}function $r(e,t){if(!Tc&&ol){Tc=!0;do for(var n=!1,i=ll;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var h=0;else{var y=i.suspendedLanes,x=i.pingedLanes;h=(1<<31-Pt(42|e)+1)-1,h&=c&~(y&~x),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(n=!0,Df(i,h))}else h=Ge,h=pi(i,i===it?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(h&3)===0||La(i,h)||(n=!0,Df(i,h));i=i.next}while(n);Tc=!1}}function wy(){kf()}function kf(){ol=Cc=!1;var e=0;Ta!==0&&Dy()&&(e=Ta);for(var t=Rt(),n=null,i=ll;i!==null;){var c=i.next,h=zf(i,t);h===0?(i.next=null,n===null?ll=c:n.next=c,c===null&&(Gi=n)):(n=i,(e!==0||(h&3)!==0)&&(ol=!0)),i=c}At!==0&&At!==5||$r(e),Ta!==0&&(Ta=0)}function zf(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var y=31-Pt(h),x=1<<y,R=c[y];R===-1?((x&n)===0||(x&i)!==0)&&(c[y]=lr(x,t)):R<=t&&(e.expiredLanes|=x),h&=~x}if(t=it,n=Ge,n=pi(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,n===0||e===t&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&ht(i),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||La(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&ht(i),Ha(n)){case 2:case 8:n=os;break;case 32:n=Ma;break;case 268435456:n=cs;break;default:n=Ma}return i=Uf.bind(null,e),n=st(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&ht(i),e.callbackPriority=2,e.callbackNode=null,2}function Uf(e,t){if(At!==0&&At!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(sl()&&e.callbackNode!==n)return null;var i=Ge;return i=pi(e,e===it?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(pf(e,i,t),zf(e,Rt()),e.callbackNode!=null&&e.callbackNode===n?Uf.bind(null,e):null)}function Df(e,t){if(sl())return null;pf(e,t,!0)}function Ey(){My(function(){(Xe&6)!==0?st(hi,wy):kf()})}function Ac(){if(Ta===0){var e=Oi;e===0&&(e=gi,gi<<=1,(gi&261888)===0&&(gi=256)),Ta=e}return Ta}function Bf(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ms(""+e)}function Mf(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Cy(e,t,n,i,c){if(t==="submit"&&n&&n.stateNode===c){var h=Bf((c[Lt]||null).action),y=i.submitter;y&&(t=(t=y[Lt]||null)?Bf(t.formAction):y.getAttribute("formAction"),t!==null&&(h=t,y=null));var x=new _s("action","action",null,i,c);e.push({event:x,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Ta!==0){var R=y?Mf(c,y):new FormData(c);Jo(n,{pending:!0,data:R,method:c.method,action:h},null,R)}}else typeof h=="function"&&(x.preventDefault(),R=y?Mf(c,y):new FormData(c),Jo(n,{pending:!0,data:R,method:c.method,action:h},h,R))},currentTarget:c}]})}}for(var Nc=0;Nc<uo.length;Nc++){var Oc=uo[Nc],Ty=Oc.toLowerCase(),Ay=Oc[0].toUpperCase()+Oc.slice(1);Tn(Ty,"on"+Ay)}Tn(fd,"onAnimationEnd"),Tn(gd,"onAnimationIteration"),Tn(pd,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(Pm,"onTransitionRun"),Tn(Gm,"onTransitionStart"),Tn(Km,"onTransitionCancel"),Tn(md,"onTransitionEnd"),Gt("onMouseEnter",["mouseout","mouseover"]),Gt("onMouseLeave",["mouseout","mouseover"]),Gt("onPointerEnter",["pointerout","pointerover"]),Gt("onPointerLeave",["pointerout","pointerover"]),Ie("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ie("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ie("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ie("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ie("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ie("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ny=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pr));function qf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],c=i.event;i=i.listeners;e:{var h=void 0;if(t)for(var y=i.length-1;0<=y;y--){var x=i[y],R=x.instance,G=x.currentTarget;if(x=x.listener,R!==h&&c.isPropagationStopped())break e;h=x,c.currentTarget=G;try{h(c)}catch(ee){Ss(ee)}c.currentTarget=null,h=R}else for(y=0;y<i.length;y++){if(x=i[y],R=x.instance,G=x.currentTarget,x=x.listener,R!==h&&c.isPropagationStopped())break e;h=x,c.currentTarget=G;try{h(c)}catch(ee){Ss(ee)}c.currentTarget=null,h=R}}}}function $e(e,t){var n=t[ur];n===void 0&&(n=t[ur]=new Set);var i=e+"__bubble";n.has(i)||(Lf(t,e,2,!1),n.add(i))}function Rc(e,t,n){var i=0;t&&(i|=4),Lf(n,e,i,t)}var cl="_reactListening"+Math.random().toString(36).slice(2);function kc(e){if(!e[cl]){e[cl]=!0,Re.forEach(function(n){n!=="selectionchange"&&(Ny.has(n)||Rc(n,!1,e),Rc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cl]||(t[cl]=!0,Rc("selectionchange",!1,t))}}function Lf(e,t,n,i){switch(gg(t)){case 2:var c=av;break;case 8:c=iv;break;default:c=Yc}n=c.bind(null,t,n,e),c=void 0,!Xl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function zc(e,t,n,i,c){var h=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var x=i.stateNode.containerInfo;if(x===c)break;if(y===4)for(y=i.return;y!==null;){var R=y.tag;if((R===3||R===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;x!==null;){if(y=_e(x),y===null)return;if(R=y.tag,R===5||R===6||R===26||R===27){i=h=y;continue e}x=x.parentNode}}i=i.return}$u(function(){var G=h,ee=Fl(n),se=[];e:{var Y=yd.get(e);if(Y!==void 0){var Q=_s,je=e;switch(e){case"keypress":if(vs(n)===0)break e;case"keydown":case"keyup":Q=jm;break;case"focusin":je="focus",Q=to;break;case"focusout":je="blur",Q=to;break;case"beforeblur":case"afterblur":Q=to;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Q=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Q=um;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Q=Em;break;case fd:case gd:case pd:Q=fm;break;case md:Q=Tm;break;case"scroll":case"scrollend":Q=om;break;case"wheel":Q=Nm;break;case"copy":case"cut":case"paste":Q=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Q=Ju;break;case"toggle":case"beforetoggle":Q=Rm}var Ae=(t&4)!==0,nt=!Ae&&(e==="scroll"||e==="scrollend"),L=Ae?Y!==null?Y+"Capture":null:Y;Ae=[];for(var k=G,P;k!==null;){var ae=k;if(P=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||P===null||L===null||(ae=hr(k,L),ae!=null&&Ae.push(Gr(k,ae,P))),nt)break;k=k.return}0<Ae.length&&(Y=new Q(Y,je,null,n,ee),se.push({event:Y,listeners:Ae}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",Q=e==="mouseout"||e==="pointerout",Y&&n!==Jl&&(je=n.relatedTarget||n.fromElement)&&(_e(je)||je[oa]))break e;if((Q||Y)&&(Y=ee.window===ee?ee:(Y=ee.ownerDocument)?Y.defaultView||Y.parentWindow:window,Q?(je=n.relatedTarget||n.toElement,Q=G,je=je?_e(je):null,je!==null&&(nt=d(je),Ae=je.tag,je!==nt||Ae!==5&&Ae!==27&&Ae!==6)&&(je=null)):(Q=null,je=G),Q!==je)){if(Ae=Ku,ae="onMouseLeave",L="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(Ae=Ju,ae="onPointerLeave",L="onPointerEnter",k="pointer"),nt=Q==null?Y:Te(Q),P=je==null?Y:Te(je),Y=new Ae(ae,k+"leave",Q,n,ee),Y.target=nt,Y.relatedTarget=P,ae=null,_e(ee)===G&&(Ae=new Ae(L,k+"enter",je,n,ee),Ae.target=P,Ae.relatedTarget=nt,ae=Ae),nt=ae,Q&&je)t:{for(Ae=Oy,L=Q,k=je,P=0,ae=L;ae;ae=Ae(ae))P++;ae=0;for(var Ce=k;Ce;Ce=Ae(Ce))ae++;for(;0<P-ae;)L=Ae(L),P--;for(;0<ae-P;)k=Ae(k),ae--;for(;P--;){if(L===k||k!==null&&L===k.alternate){Ae=L;break t}L=Ae(L),k=Ae(k)}Ae=null}else Ae=null;Q!==null&&If(se,Y,Q,Ae,!1),je!==null&&nt!==null&&If(se,nt,je,Ae,!0)}}e:{if(Y=G?Te(G):window,Q=Y.nodeName&&Y.nodeName.toLowerCase(),Q==="select"||Q==="input"&&Y.type==="file")var Je=nd;else if(ed(Y))if(ad)Je=Hm;else{Je=Lm;var Se=qm}else Q=Y.nodeName,!Q||Q.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?G&&Yl(G.elementType)&&(Je=nd):Je=Im;if(Je&&(Je=Je(e,G))){td(se,Je,n,ee);break e}Se&&Se(e,Y,G),e==="focusout"&&G&&Y.type==="number"&&G.memoizedProps.value!=null&&mi(Y,"number",Y.value)}switch(Se=G?Te(G):window,e){case"focusin":(ed(Se)||Se.contentEditable==="true")&&(ji=Se,lo=G,_r=null);break;case"focusout":_r=lo=ji=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,dd(se,n,ee);break;case"selectionchange":if($m)break;case"keydown":case"keyup":dd(se,n,ee)}var Le;if(ao)e:{switch(e){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else xi?Zu(e,n)&&(Ke="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ke="onCompositionStart");Ke&&(Fu&&n.locale!=="ko"&&(xi||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&xi&&(Le=Pu()):(da=ee,Zl="value"in da?da.value:da.textContent,xi=!0)),Se=ul(G,Ke),0<Se.length&&(Ke=new Yu(Ke,e,null,n,ee),se.push({event:Ke,listeners:Se}),Le?Ke.data=Le:(Le=Wu(n),Le!==null&&(Ke.data=Le)))),(Le=zm?Um(e,n):Dm(e,n))&&(Ke=ul(G,"onBeforeInput"),0<Ke.length&&(Se=new Yu("onBeforeInput","beforeinput",null,n,ee),se.push({event:Se,listeners:Ke}),Se.data=Le)),Cy(se,e,G,n,ee)}qf(se,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ul(e,t){for(var n=t+"Capture",i=[];e!==null;){var c=e,h=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||h===null||(c=hr(e,n),c!=null&&i.unshift(Gr(e,c,h)),c=hr(e,t),c!=null&&i.push(Gr(e,c,h))),e.tag===3)return i;e=e.return}return[]}function Oy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function If(e,t,n,i,c){for(var h=t._reactName,y=[];n!==null&&n!==i;){var x=n,R=x.alternate,G=x.stateNode;if(x=x.tag,R!==null&&R===i)break;x!==5&&x!==26&&x!==27||G===null||(R=G,c?(G=hr(n,h),G!=null&&y.unshift(Gr(n,G,R))):c||(G=hr(n,h),G!=null&&y.push(Gr(n,G,R)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var Ry=/\r\n?/g,ky=/\u0000|\uFFFD/g;function Hf(e){return(typeof e=="string"?e:""+e).replace(Ry,`
`).replace(ky,"")}function Vf(e,t){return t=Hf(t),Hf(e)===t}function tt(e,t,n,i,c,h){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||vi(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&vi(e,""+i);break;case"className":ca(e,"class",i);break;case"tabIndex":ca(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":ca(e,n,i);break;case"style":Hu(e,i,h);break;case"data":if(t!=="object"){ca(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(n==="formAction"?(t!=="input"&&tt(e,t,"name",c.name,c,null),tt(e,t,"formEncType",c.formEncType,c,null),tt(e,t,"formMethod",c.formMethod,c,null),tt(e,t,"formTarget",c.formTarget,c,null)):(tt(e,t,"encType",c.encType,c,null),tt(e,t,"method",c.method,c,null),tt(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=Pn);break;case"onScroll":i!=null&&$e("scroll",e);break;case"onScrollEnd":i!=null&&$e("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=ms(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":$e("beforetoggle",e),$e("toggle",e),Jt(e,"popover",i);break;case"xlinkActuate":fn(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":fn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":fn(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":fn(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":fn(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":fn(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":fn(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":fn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":fn(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Jt(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=sm.get(n)||n,Jt(e,n,i))}}function Uc(e,t,n,i,c,h){switch(n){case"style":Hu(e,i,h);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof i=="string"?vi(e,i):(typeof i=="number"||typeof i=="bigint")&&vi(e,""+i);break;case"onScroll":i!=null&&$e("scroll",e);break;case"onScrollEnd":i!=null&&$e("scrollend",e);break;case"onClick":i!=null&&(e.onclick=Pn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Be.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),h=e[Lt]||null,h=h!=null?h[n]:null,typeof h=="function"&&e.removeEventListener(t,h,c),typeof i=="function")){typeof h!="function"&&h!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,c);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):Jt(e,n,i)}}}function Bt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",e),$e("load",e);var i=!1,c=!1,h;for(h in n)if(n.hasOwnProperty(h)){var y=n[h];if(y!=null)switch(h){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:tt(e,t,h,y,n,null)}}c&&tt(e,t,"srcSet",n.srcSet,n,null),i&&tt(e,t,"src",n.src,n,null);return;case"input":$e("invalid",e);var x=h=y=c=null,R=null,G=null;for(i in n)if(n.hasOwnProperty(i)){var ee=n[i];if(ee!=null)switch(i){case"name":c=ee;break;case"type":y=ee;break;case"checked":R=ee;break;case"defaultChecked":G=ee;break;case"value":h=ee;break;case"defaultValue":x=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(l(137,t));break;default:tt(e,t,i,ee,n,null)}}dr(e,h,x,R,G,y,c,!1);return;case"select":$e("invalid",e),i=y=h=null;for(c in n)if(n.hasOwnProperty(c)&&(x=n[c],x!=null))switch(c){case"value":h=x;break;case"defaultValue":y=x;break;case"multiple":i=x;default:tt(e,t,c,x,n,null)}t=h,n=y,e.multiple=!!i,t!=null?yi(e,!!i,t,!1):n!=null&&yi(e,!!i,n,!0);return;case"textarea":$e("invalid",e),h=c=i=null;for(y in n)if(n.hasOwnProperty(y)&&(x=n[y],x!=null))switch(y){case"value":i=x;break;case"defaultValue":c=x;break;case"children":h=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(l(91));break;default:tt(e,t,y,x,n,null)}Lu(e,i,c,h);return;case"option":for(R in n)if(n.hasOwnProperty(R)&&(i=n[R],i!=null))switch(R){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:tt(e,t,R,i,n,null)}return;case"dialog":$e("beforetoggle",e),$e("toggle",e),$e("cancel",e),$e("close",e);break;case"iframe":case"object":$e("load",e);break;case"video":case"audio":for(i=0;i<Pr.length;i++)$e(Pr[i],e);break;case"image":$e("error",e),$e("load",e);break;case"details":$e("toggle",e);break;case"embed":case"source":case"link":$e("error",e),$e("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(G in n)if(n.hasOwnProperty(G)&&(i=n[G],i!=null))switch(G){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:tt(e,t,G,i,n,null)}return;default:if(Yl(t)){for(ee in n)n.hasOwnProperty(ee)&&(i=n[ee],i!==void 0&&Uc(e,t,ee,i,n,void 0));return}}for(x in n)n.hasOwnProperty(x)&&(i=n[x],i!=null&&tt(e,t,x,i,n,null))}function zy(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,h=null,y=null,x=null,R=null,G=null,ee=null;for(Q in n){var se=n[Q];if(n.hasOwnProperty(Q)&&se!=null)switch(Q){case"checked":break;case"value":break;case"defaultValue":R=se;default:i.hasOwnProperty(Q)||tt(e,t,Q,null,i,se)}}for(var Y in i){var Q=i[Y];if(se=n[Y],i.hasOwnProperty(Y)&&(Q!=null||se!=null))switch(Y){case"type":h=Q;break;case"name":c=Q;break;case"checked":G=Q;break;case"defaultChecked":ee=Q;break;case"value":y=Q;break;case"defaultValue":x=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(l(137,t));break;default:Q!==se&&tt(e,t,Y,Q,i,se)}}kt(e,y,x,R,G,ee,h,c);return;case"select":Q=y=x=Y=null;for(h in n)if(R=n[h],n.hasOwnProperty(h)&&R!=null)switch(h){case"value":break;case"multiple":Q=R;default:i.hasOwnProperty(h)||tt(e,t,h,null,i,R)}for(c in i)if(h=i[c],R=n[c],i.hasOwnProperty(c)&&(h!=null||R!=null))switch(c){case"value":Y=h;break;case"defaultValue":x=h;break;case"multiple":y=h;default:h!==R&&tt(e,t,c,h,i,R)}t=x,n=y,i=Q,Y!=null?yi(e,!!n,Y,!1):!!i!=!!n&&(t!=null?yi(e,!!n,t,!0):yi(e,!!n,n?[]:"",!1));return;case"textarea":Q=Y=null;for(x in n)if(c=n[x],n.hasOwnProperty(x)&&c!=null&&!i.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:tt(e,t,x,null,i,c)}for(y in i)if(c=i[y],h=n[y],i.hasOwnProperty(y)&&(c!=null||h!=null))switch(y){case"value":Y=c;break;case"defaultValue":Q=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==h&&tt(e,t,y,c,i,h)}qu(e,Y,Q);return;case"option":for(var je in n)if(Y=n[je],n.hasOwnProperty(je)&&Y!=null&&!i.hasOwnProperty(je))switch(je){case"selected":e.selected=!1;break;default:tt(e,t,je,null,i,Y)}for(R in i)if(Y=i[R],Q=n[R],i.hasOwnProperty(R)&&Y!==Q&&(Y!=null||Q!=null))switch(R){case"selected":e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:tt(e,t,R,Y,i,Q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in n)Y=n[Ae],n.hasOwnProperty(Ae)&&Y!=null&&!i.hasOwnProperty(Ae)&&tt(e,t,Ae,null,i,Y);for(G in i)if(Y=i[G],Q=n[G],i.hasOwnProperty(G)&&Y!==Q&&(Y!=null||Q!=null))switch(G){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(l(137,t));break;default:tt(e,t,G,Y,i,Q)}return;default:if(Yl(t)){for(var nt in n)Y=n[nt],n.hasOwnProperty(nt)&&Y!==void 0&&!i.hasOwnProperty(nt)&&Uc(e,t,nt,void 0,i,Y);for(ee in i)Y=i[ee],Q=n[ee],!i.hasOwnProperty(ee)||Y===Q||Y===void 0&&Q===void 0||Uc(e,t,ee,Y,i,Q);return}}for(var L in n)Y=n[L],n.hasOwnProperty(L)&&Y!=null&&!i.hasOwnProperty(L)&&tt(e,t,L,null,i,Y);for(se in i)Y=i[se],Q=n[se],!i.hasOwnProperty(se)||Y===Q||Y==null&&Q==null||tt(e,t,se,Y,i,Q)}function $f(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Uy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var c=n[i],h=c.transferSize,y=c.initiatorType,x=c.duration;if(h&&x&&$f(y)){for(y=0,x=c.responseEnd,i+=1;i<n.length;i++){var R=n[i],G=R.startTime;if(G>x)break;var ee=R.transferSize,se=R.initiatorType;ee&&$f(se)&&(R=R.responseEnd,y+=ee*(R<x?1:(x-G)/(R-G)))}if(--i,t+=8*(h+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Dc=null,Bc=null;function dl(e){return e.nodeType===9?e:e.ownerDocument}function Pf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gf(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Mc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qc=null;function Dy(){var e=window.event;return e&&e.type==="popstate"?e===qc?!1:(qc=e,!0):(qc=null,!1)}var Kf=typeof setTimeout=="function"?setTimeout:void 0,By=typeof clearTimeout=="function"?clearTimeout:void 0,Yf=typeof Promise=="function"?Promise:void 0,My=typeof queueMicrotask=="function"?queueMicrotask:typeof Yf<"u"?function(e){return Yf.resolve(null).then(e).catch(qy)}:Kf;function qy(e){setTimeout(function(){throw e})}function Aa(e){return e==="head"}function Jf(e,t){var n=t,i=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(i===0){e.removeChild(c),Fi(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")Kr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Kr(n);for(var h=n.firstChild;h;){var y=h.nextSibling,x=h.nodeName;h[oe]||x==="SCRIPT"||x==="STYLE"||x==="LINK"&&h.rel.toLowerCase()==="stylesheet"||n.removeChild(h),h=y}}else n==="body"&&Kr(e.ownerDocument.body);n=c}while(n);Fi(t)}function Ff(e,t){var n=e;e=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=i}while(n)}function Lc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Lc(n),be(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Ly(e,t,n,i){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[oe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=_n(e.nextSibling),e===null)break}return null}function Iy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=_n(e.nextSibling),e===null))return null;return e}function Qf(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=_n(e.nextSibling),e===null))return null;return e}function Ic(e){return e.data==="$?"||e.data==="$~"}function Hc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Hy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function _n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Vc=null;function Xf(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return _n(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function Zf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Wf(e,t,n){switch(t=dl(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Kr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);be(e)}var xn=new Map,eg=new Set;function hl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var sa=z.d;z.d={f:Vy,r:$y,D:Py,C:Gy,L:Ky,m:Yy,X:Fy,S:Jy,M:Qy};function Vy(){var e=sa.f(),t=al();return e||t}function $y(e){var t=me(e);t!==null&&t.tag===5&&t.type==="form"?mh(t):sa.r(e)}var Ki=typeof document>"u"?null:document;function tg(e,t,n){var i=Ki;if(i&&typeof t=="string"&&t){var c=He(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),eg.has(c)||(eg.add(c),e={rel:e,crossOrigin:n,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),Bt(t,"link",e),le(t),i.head.appendChild(t)))}}function Py(e){sa.D(e),tg("dns-prefetch",e,null)}function Gy(e,t){sa.C(e,t),tg("preconnect",e,t)}function Ky(e,t,n){sa.L(e,t,n);var i=Ki;if(i&&e&&t){var c='link[rel="preload"][as="'+He(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+He(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+He(n.imageSizes)+'"]')):c+='[href="'+He(e)+'"]';var h=c;switch(t){case"style":h=Yi(e);break;case"script":h=Ji(e)}xn.has(h)||(e=_({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),xn.set(h,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(Yr(h))||t==="script"&&i.querySelector(Jr(h))||(t=i.createElement("link"),Bt(t,"link",e),le(t),i.head.appendChild(t)))}}function Yy(e,t){sa.m(e,t);var n=Ki;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+He(i)+'"][href="'+He(e)+'"]',h=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Ji(e)}if(!xn.has(h)&&(e=_({rel:"modulepreload",href:e},t),xn.set(h,e),n.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Jr(h)))return}i=n.createElement("link"),Bt(i,"link",e),le(i),n.head.appendChild(i)}}}function Jy(e,t,n){sa.S(e,t,n);var i=Ki;if(i&&e){var c=de(i).hoistableStyles,h=Yi(e);t=t||"default";var y=c.get(h);if(!y){var x={loading:0,preload:null};if(y=i.querySelector(Yr(h)))x.loading=5;else{e=_({rel:"stylesheet",href:e,"data-precedence":t},n),(n=xn.get(h))&&$c(e,n);var R=y=i.createElement("link");le(R),Bt(R,"link",e),R._p=new Promise(function(G,ee){R.onload=G,R.onerror=ee}),R.addEventListener("load",function(){x.loading|=1}),R.addEventListener("error",function(){x.loading|=2}),x.loading|=4,fl(y,t,i)}y={type:"stylesheet",instance:y,count:1,state:x},c.set(h,y)}}}function Fy(e,t){sa.X(e,t);var n=Ki;if(n&&e){var i=de(n).hoistableScripts,c=Ji(e),h=i.get(c);h||(h=n.querySelector(Jr(c)),h||(e=_({src:e,async:!0},t),(t=xn.get(c))&&Pc(e,t),h=n.createElement("script"),le(h),Bt(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function Qy(e,t){sa.M(e,t);var n=Ki;if(n&&e){var i=de(n).hoistableScripts,c=Ji(e),h=i.get(c);h||(h=n.querySelector(Jr(c)),h||(e=_({src:e,async:!0,type:"module"},t),(t=xn.get(c))&&Pc(e,t),h=n.createElement("script"),le(h),Bt(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function ng(e,t,n,i){var c=(c=ne.current)?hl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Yi(n.href),n=de(c).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Yi(n.href);var h=de(c).hoistableStyles,y=h.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,y),(h=c.querySelector(Yr(e)))&&!h._p&&(y.instance=h,y.state.loading=5),xn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},xn.set(e,n),h||Xy(c,e,n,y.state))),t&&i===null)throw Error(l(528,""));return y}if(t&&i!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ji(n),n=de(c).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Yi(e){return'href="'+He(e)+'"'}function Yr(e){return'link[rel="stylesheet"]['+e+"]"}function ag(e){return _({},e,{"data-precedence":e.precedence,precedence:null})}function Xy(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Bt(t,"link",n),le(t),e.head.appendChild(t))}function Ji(e){return'[src="'+He(e)+'"]'}function Jr(e){return"script[async]"+e}function ig(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+He(n.href)+'"]');if(i)return t.instance=i,le(i),i;var c=_({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),le(i),Bt(i,"style",c),fl(i,n.precedence,e),t.instance=i;case"stylesheet":c=Yi(n.href);var h=e.querySelector(Yr(c));if(h)return t.state.loading|=4,t.instance=h,le(h),h;i=ag(n),(c=xn.get(c))&&$c(i,c),h=(e.ownerDocument||e).createElement("link"),le(h);var y=h;return y._p=new Promise(function(x,R){y.onload=x,y.onerror=R}),Bt(h,"link",i),t.state.loading|=4,fl(h,n.precedence,e),t.instance=h;case"script":return h=Ji(n.src),(c=e.querySelector(Jr(h)))?(t.instance=c,le(c),c):(i=n,(c=xn.get(h))&&(i=_({},n),Pc(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),le(c),Bt(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,fl(i,n.precedence,e));return t.instance}function fl(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,h=c,y=0;y<i.length;y++){var x=i[y];if(x.dataset.precedence===t)h=x;else if(h!==c)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function $c(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Pc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var gl=null;function rg(e,t,n){if(gl===null){var i=new Map,c=gl=new Map;c.set(n,i)}else c=gl,i=c.get(n),i||(i=new Map,c.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var h=n[c];if(!(h[oe]||h[xt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var y=h.getAttribute(t)||"";y=e+y;var x=i.get(y);x?x.push(h):i.set(y,[h])}}return i}function sg(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Zy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function lg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Wy(e,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=Yi(i.href),h=t.querySelector(Yr(c));if(h){t=h._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=pl.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=h,le(h);return}h=t.ownerDocument||t,i=ag(i),(c=xn.get(c))&&$c(i,c),h=h.createElement("link"),le(h);var y=h;y._p=new Promise(function(x,R){y.onload=x,y.onerror=R}),Bt(h,"link",i),n.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=pl.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Gc=0;function ev(e,t){return e.stylesheets&&e.count===0&&yl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+t);0<e.imgBytes&&Gc===0&&(Gc=62500*Uy());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>Gc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function pl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)yl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ml=null;function yl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ml=new Map,t.forEach(tv,e),ml=null,pl.call(e))}function tv(e,t){if(!(t.state.loading&4)){var n=ml.get(e);if(n)var i=n.get(null);else{n=new Map,ml.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<c.length;h++){var y=c[h];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),i=y)}i&&n.set(null,i)}c=t.instance,y=c.getAttribute("data-precedence"),h=n.get(y)||i,h===i&&n.set(null,c),n.set(y,c),this.count++,i=pl.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),h?h.parentNode.insertBefore(c,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Fr={$$typeof:M,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function nv(e,t,n,i,c,h,y,x,R){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ia(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ia(0),this.hiddenUpdates=Ia(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=h,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function og(e,t,n,i,c,h,y,x,R,G,ee,se){return e=new nv(e,t,n,y,R,G,ee,se,x),t=1,h===!0&&(t|=24),h=nn(3,null,null,t),e.current=h,h.stateNode=e,t=wo(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:i,isDehydrated:n,cache:t},Ao(h),e}function cg(e){return e?(e=Ei,e):Ei}function ug(e,t,n,i,c,h){c=cg(c),i.context===null?i.context=c:i.pendingContext=c,i=ya(t),i.payload={element:n},h=h===void 0?null:h,h!==null&&(i.callback=h),n=va(e,i,t),n!==null&&(en(n,e,t),Tr(n,e,t))}function dg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Kc(e,t){dg(e,t),(e=e.alternate)&&dg(e,t)}function hg(e){if(e.tag===13||e.tag===31){var t=Ga(e,67108864);t!==null&&en(t,e,67108864),Kc(e,67108864)}}function fg(e){if(e.tag===13||e.tag===31){var t=on();t=cr(t);var n=Ga(e,t);n!==null&&en(n,e,t),Kc(e,t)}}var vl=!0;function av(e,t,n,i){var c=C.T;C.T=null;var h=z.p;try{z.p=2,Yc(e,t,n,i)}finally{z.p=h,C.T=c}}function iv(e,t,n,i){var c=C.T;C.T=null;var h=z.p;try{z.p=8,Yc(e,t,n,i)}finally{z.p=h,C.T=c}}function Yc(e,t,n,i){if(vl){var c=Jc(i);if(c===null)zc(e,t,i,bl,n),pg(e,i);else if(sv(c,e,t,n,i))i.stopPropagation();else if(pg(e,i),t&4&&-1<rv.indexOf(e)){for(;c!==null;){var h=me(c);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var y=Dn(h.pendingLanes);if(y!==0){var x=h;for(x.pendingLanes|=2,x.entangledLanes|=2;y;){var R=1<<31-Pt(y);x.entanglements[1]|=R,y&=~R}Hn(h),(Xe&6)===0&&(tl=Rt()+500,$r(0))}}break;case 31:case 13:x=Ga(h,2),x!==null&&en(x,h,2),al(),Kc(h,2)}if(h=Jc(i),h===null&&zc(e,t,i,bl,n),h===c)break;c=h}c!==null&&i.stopPropagation()}else zc(e,t,i,null,n)}}function Jc(e){return e=Fl(e),Fc(e)}var bl=null;function Fc(e){if(bl=null,e=_e(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=f(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return bl=e,null}function gg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vl()){case hi:return 2;case os:return 8;case Ma:case $l:return 32;case cs:return 268435456;default:return 32}default:return 32}}var Qc=!1,Na=null,Oa=null,Ra=null,Qr=new Map,Xr=new Map,ka=[],rv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pg(e,t){switch(e){case"focusin":case"focusout":Na=null;break;case"dragenter":case"dragleave":Oa=null;break;case"mouseover":case"mouseout":Ra=null;break;case"pointerover":case"pointerout":Qr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xr.delete(t.pointerId)}}function Zr(e,t,n,i,c,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:h,targetContainers:[c]},t!==null&&(t=me(t),t!==null&&hg(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function sv(e,t,n,i,c){switch(t){case"focusin":return Na=Zr(Na,e,t,n,i,c),!0;case"dragenter":return Oa=Zr(Oa,e,t,n,i,c),!0;case"mouseover":return Ra=Zr(Ra,e,t,n,i,c),!0;case"pointerover":var h=c.pointerId;return Qr.set(h,Zr(Qr.get(h)||null,e,t,n,i,c)),!0;case"gotpointercapture":return h=c.pointerId,Xr.set(h,Zr(Xr.get(h)||null,e,t,n,i,c)),!0}return!1}function mg(e){var t=_e(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=f(n),t!==null){e.blockedOn=t,ps(e.priority,function(){fg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,ps(e.priority,function(){fg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _l(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jc(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Jl=i,n.target.dispatchEvent(i),Jl=null}else return t=me(n),t!==null&&hg(t),e.blockedOn=n,!1;t.shift()}return!0}function yg(e,t,n){_l(e)&&n.delete(t)}function lv(){Qc=!1,Na!==null&&_l(Na)&&(Na=null),Oa!==null&&_l(Oa)&&(Oa=null),Ra!==null&&_l(Ra)&&(Ra=null),Qr.forEach(yg),Xr.forEach(yg)}function xl(e,t){e.blockedOn===t&&(e.blockedOn=null,Qc||(Qc=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,lv)))}var jl=null;function vg(e){jl!==e&&(jl=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){jl===e&&(jl=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(Fc(i||n)===null)continue;break}var h=me(n);h!==null&&(e.splice(t,3),t-=3,Jo(h,{pending:!0,data:c,method:n.method,action:i},i,c))}}))}function Fi(e){function t(R){return xl(R,e)}Na!==null&&xl(Na,e),Oa!==null&&xl(Oa,e),Ra!==null&&xl(Ra,e),Qr.forEach(t),Xr.forEach(t);for(var n=0;n<ka.length;n++){var i=ka[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<ka.length&&(n=ka[0],n.blockedOn===null);)mg(n),n.blockedOn===null&&ka.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var c=n[i],h=n[i+1],y=c[Lt]||null;if(typeof h=="function")y||vg(n);else if(y){var x=null;if(h&&h.hasAttribute("formAction")){if(c=h,y=h[Lt]||null)x=y.formAction;else if(Fc(c)!==null)continue}else x=y.action;typeof x=="function"?n[i+1]=x:(n.splice(i,3),i-=3),vg(n)}}}function bg(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function Xc(e){this._internalRoot=e}Sl.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,i=on();ug(n,i,e,t,null,null)},Sl.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ug(e.current,2,null,e,null,null),al(),t[oa]=null}};function Sl(e){this._internalRoot=e}Sl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Bn();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ka.length&&t!==0&&t<ka[n].priority;n++);ka.splice(n,0,e),n===0&&mg(e)}};var _g=a.version;if(_g!=="19.2.0")throw Error(l(527,_g,"19.2.0"));z.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var ov={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:C,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{qa=wl.inject(ov),$t=wl}catch{}}return es.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,i="",c=Ch,h=Th,y=Ah;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=og(e,1,!1,null,null,n,i,null,c,h,y,bg),e[oa]=t.current,kc(e),new Xc(t)},es.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var i=!1,c="",h=Ch,y=Th,x=Ah,R=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(h=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(x=n.onRecoverableError),n.formState!==void 0&&(R=n.formState)),t=og(e,1,!0,t,n??null,i,c,R,h,y,x,bg),t.context=cg(null),n=t.current,i=on(),i=cr(i),c=ya(i),c.callback=null,va(n,c,i),n=i,t.current.lanes=n,En(t,n),Hn(t),e[oa]=t.current,kc(e),new Sl(t)},es.version="19.2.0",es}var Og;function bv(){if(Og)return Wc.exports;Og=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),Wc.exports=vv(),Wc.exports}var _v=bv(),S=Cu();const Tu=op(S);var fu=function(o,a){return fu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},fu(o,a)};function up(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");fu(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var Ul=function(){return Ul=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},Ul.apply(this,arguments)};function rr(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function dp(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(f=o[g])&&(d=(u<3?f(d):u>3?f(a,s,d):f(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function hp(o,a){return function(s,l){a(s,l,o)}}function fp(o,a,s,l,u,d){function f(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),_,j=!1,b=s.length-1;b>=0;b--){var w={};for(var N in l)w[N]=N==="access"?{}:l[N];for(var N in l.access)w.access[N]=l.access[N];w.addInitializer=function(T){if(j)throw new TypeError("Cannot add initializers after decoration has completed");d.push(f(T||null))};var O=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(O===void 0)continue;if(O===null||typeof O!="object")throw new TypeError("Object expected");(_=f(O.get))&&(v.get=_),(_=f(O.set))&&(v.set=_),(_=f(O.init))&&u.unshift(_)}else(_=f(O))&&(g==="field"?u.unshift(_):v[p]=_)}m&&Object.defineProperty(m,l.name,v),j=!0}function gp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function pp(o){return typeof o=="symbol"?o:"".concat(o)}function mp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function yp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function we(o,a,s,l){function u(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function g(v){try{m(l.next(v))}catch(_){f(_)}}function p(v){try{m(l.throw(v))}catch(_){f(_)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function vp(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=g(0),f.throw=g(1),f.return=g(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Ll=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function bp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&Ll(a,o,s)}function Dl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Au(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],f;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){f={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(f)throw f.error}}return d}function _p(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(Au(arguments[a]));return o}function xp(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],f=0,g=d.length;f<g;f++,u++)l[u]=d[f];return l}function jp(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function ir(o){return this instanceof ir?(this.v=o,this):new ir(o)}function Sp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",f),u[Symbol.asyncIterator]=function(){return this},u;function f(b){return function(w){return Promise.resolve(w).then(b,_)}}function g(b,w){l[b]&&(u[b]=function(N){return new Promise(function(O,T){d.push([b,N,O,T])>1||p(b,N)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(N){j(d[0][3],N)}}function m(b){b.value instanceof ir?Promise.resolve(b.value.v).then(v,_):j(d[0][2],b)}function v(b){p("next",b)}function _(b){p("throw",b)}function j(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function wp(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(f){return(s=!s)?{value:ir(o[u](f)),done:!1}:d?d(f):f}:d}}function Ep(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Dl=="function"?Dl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(f){return new Promise(function(g,p){f=o[d](f),u(g,p,f.done,f.value)})}}function u(d,f,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},f)}}function Cp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var xv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},gu=function(o){return gu=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},gu(o)};function Tp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=gu(o),l=0;l<s.length;l++)s[l]!=="default"&&Ll(a,o,s[l]);return xv(a,o),a}function Ap(o){return o&&o.__esModule?o:{default:o}}function Np(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function Op(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Rp(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function kp(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var jv=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function zp(o){function a(d){o.error=o.hasError?new jv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(f){return a(f),u()})}else l|=1}catch(f){a(f)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function Up(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,f){return l?a?".jsx":".js":u&&(!d||!f)?s:u+d+"."+f.toLowerCase()+"js"}):o}const Sv={__extends:up,__assign:Ul,__rest:rr,__decorate:dp,__param:hp,__esDecorate:fp,__runInitializers:gp,__propKey:pp,__setFunctionName:mp,__metadata:yp,__awaiter:we,__generator:vp,__createBinding:Ll,__exportStar:bp,__values:Dl,__read:Au,__spread:_p,__spreadArrays:xp,__spreadArray:jp,__await:ir,__asyncGenerator:Sp,__asyncDelegator:wp,__asyncValues:Ep,__makeTemplateObject:Cp,__importStar:Tp,__importDefault:Ap,__classPrivateFieldGet:Np,__classPrivateFieldSet:Op,__classPrivateFieldIn:Rp,__addDisposableResource:kp,__disposeResources:zp,__rewriteRelativeImportExtension:Up},wv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:kp,get __assign(){return Ul},__asyncDelegator:wp,__asyncGenerator:Sp,__asyncValues:Ep,__await:ir,__awaiter:we,__classPrivateFieldGet:Np,__classPrivateFieldIn:Rp,__classPrivateFieldSet:Op,__createBinding:Ll,__decorate:dp,__disposeResources:zp,__esDecorate:fp,__exportStar:bp,__extends:up,__generator:vp,__importDefault:Ap,__importStar:Tp,__makeTemplateObject:Cp,__metadata:yp,__param:hp,__propKey:pp,__read:Au,__rest:rr,__rewriteRelativeImportExtension:Up,__runInitializers:gp,__setFunctionName:mp,__spread:_p,__spreadArray:jp,__spreadArrays:xp,__values:Dl,default:Sv},Symbol.toStringTag,{value:"Module"})),Ev=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Nu extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Cv extends Nu{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Rg extends Nu{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class kg extends Nu{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var pu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(pu||(pu={}));class Tv{constructor(a,{headers:s={},customFetch:l,region:u=pu.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Ev(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return we(this,arguments,void 0,function*(s,l={}){var u;let d,f;try{const{headers:g,method:p,body:m,signal:v,timeout:_}=l;let j={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${s}`);b&&b!=="any"&&(j["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let N;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(j["Content-Type"]="application/octet-stream",N=m):typeof m=="string"?(j["Content-Type"]="text/plain",N=m):typeof FormData<"u"&&m instanceof FormData?N=m:(j["Content-Type"]="application/json",N=JSON.stringify(m)):N=m;let O=v;_&&(f=new AbortController,d=setTimeout(()=>f.abort(),_),v?(O=f.signal,v.addEventListener("abort",()=>f.abort())):O=f.signal);const T=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},j),this.headers),g),body:N,signal:O}).catch(E=>{throw new Cv(E)}),I=T.headers.get("x-relay-error");if(I&&I==="true")throw new Rg(T);if(!T.ok)throw new kg(T);let M=((u=T.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),K;return M==="application/json"?K=yield T.json():M==="application/octet-stream"||M==="application/pdf"?K=yield T.blob():M==="text/event-stream"?K=T:M==="multipart/form-data"?K=yield T.formData():K=yield T.text(),{data:K,error:null,response:T}}catch(g){return{data:null,error:g,response:g instanceof kg||g instanceof Rg?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Vt={};const sr=dv(wv);var El={},Cl={},Tl={},Al={},Nl={},Ol={},zg;function Dp(){if(zg)return Ol;zg=1,Object.defineProperty(Ol,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Ol.default=o,Ol}var Ug;function Bp(){if(Ug)return Nl;Ug=1,Object.defineProperty(Nl,"__esModule",{value:!0});const a=sr.__importDefault(Dp());class s{constructor(u){var d,f;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(f=u.isMaybeSingle)!==null&&f!==void 0?f:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let g=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,_,j;let b=null,w=null,N=null,O=p.status,T=p.statusText;if(p.ok){if(this.method!=="HEAD"){const E=await p.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=E:w=JSON.parse(E))}const M=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),K=(_=p.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");M&&K&&K.length>1&&(N=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,N=null,O=406,T="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const M=await p.text();try{b=JSON.parse(M),Array.isArray(b)&&p.status===404&&(w=[],b=null,O=200,T="OK")}catch{p.status===404&&M===""?(O=204,T="No Content"):b={message:M}}if(b&&this.isMaybeSingle&&(!((j=b?.details)===null||j===void 0)&&j.includes("0 rows"))&&(b=null,O=200,T="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:N,status:O,statusText:T}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,_;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=p?.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Nl.default=s,Nl}var Dg;function Mp(){if(Dg)return Al;Dg=1,Object.defineProperty(Al,"__esModule",{value:!0});const a=sr.__importDefault(Bp());class s extends a.default{select(u){let d=!1;const f=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:f,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:f=d}={}){const g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:f,referencedTable:g=f}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:f=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const _=[u?"analyze":null,d?"verbose":null,f?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),j=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${j}"; options=${_};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return Al.default=s,Al}var Bg;function Ou(){if(Bg)return Tl;Bg=1,Object.defineProperty(Tl,"__esModule",{value:!0});const a=sr.__importDefault(Mp()),s=new RegExp("[,()]");class l extends a.default{eq(d,f){return this.url.searchParams.append(d,`eq.${f}`),this}neq(d,f){return this.url.searchParams.append(d,`neq.${f}`),this}gt(d,f){return this.url.searchParams.append(d,`gt.${f}`),this}gte(d,f){return this.url.searchParams.append(d,`gte.${f}`),this}lt(d,f){return this.url.searchParams.append(d,`lt.${f}`),this}lte(d,f){return this.url.searchParams.append(d,`lte.${f}`),this}like(d,f){return this.url.searchParams.append(d,`like.${f}`),this}likeAllOf(d,f){return this.url.searchParams.append(d,`like(all).{${f.join(",")}}`),this}likeAnyOf(d,f){return this.url.searchParams.append(d,`like(any).{${f.join(",")}}`),this}ilike(d,f){return this.url.searchParams.append(d,`ilike.${f}`),this}ilikeAllOf(d,f){return this.url.searchParams.append(d,`ilike(all).{${f.join(",")}}`),this}ilikeAnyOf(d,f){return this.url.searchParams.append(d,`ilike(any).{${f.join(",")}}`),this}is(d,f){return this.url.searchParams.append(d,`is.${f}`),this}in(d,f){const g=Array.from(new Set(f)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cs.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cs.{${f.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(f)}`),this}containedBy(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cd.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cd.{${f.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(f)}`),this}rangeGt(d,f){return this.url.searchParams.append(d,`sr.${f}`),this}rangeGte(d,f){return this.url.searchParams.append(d,`nxl.${f}`),this}rangeLt(d,f){return this.url.searchParams.append(d,`sl.${f}`),this}rangeLte(d,f){return this.url.searchParams.append(d,`nxr.${f}`),this}rangeAdjacent(d,f){return this.url.searchParams.append(d,`adj.${f}`),this}overlaps(d,f){return typeof f=="string"?this.url.searchParams.append(d,`ov.${f}`):this.url.searchParams.append(d,`ov.{${f.join(",")}}`),this}textSearch(d,f,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${f}`),this}match(d){return Object.entries(d).forEach(([f,g])=>{this.url.searchParams.append(f,`eq.${g}`)}),this}not(d,f,g){return this.url.searchParams.append(d,`not.${f}.${g}`),this}or(d,{foreignTable:f,referencedTable:g=f}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,f,g){return this.url.searchParams.append(d,`${f}.${g}`),this}}return Tl.default=l,Tl}var Mg;function qp(){if(Mg)return Cl;Mg=1,Object.defineProperty(Cl,"__esModule",{value:!0});const a=sr.__importDefault(Ou());class s{constructor(u,{headers:d={},schema:f,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=f,this.fetch=g}select(u,d){const{head:f=!1,count:g}=d??{},p=f?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(_=>/\s/.test(_)&&!m?"":(_==='"'&&(m=!m),_)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:f=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,_)=>v.concat(Object.keys(_)),[]);if(m.length>0){const v=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:f=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const _=u.reduce((j,b)=>j.concat(Object.keys(b)),[]);if(_.length>0){const j=[...new Set(_)].map(b=>`"${b}"`);this.url.searchParams.set("columns",j.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var f;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:u}={}){var d;const f="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Cl.default=s,Cl}var qg;function Av(){if(qg)return El;qg=1,Object.defineProperty(El,"__esModule",{value:!0});const o=sr,a=o.__importDefault(qp()),s=o.__importDefault(Ou());class l{constructor(d,{headers:f={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(f),this.schemaName=g,this.fetch=p}from(d){const f=new URL(`${this.url}/${d}`);return new a.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,f={},{head:g=!1,get:p=!1,count:m}={}){var v;let _;const j=new URL(`${this.url}/rpc/${d}`);let b;g||p?(_=g?"HEAD":"GET",Object.entries(f).filter(([N,O])=>O!==void 0).map(([N,O])=>[N,Array.isArray(O)?`{${O.join(",")}}`:`${O}`]).forEach(([N,O])=>{j.searchParams.append(N,O)})):(_="POST",b=f);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new s.default({method:_,url:j,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return El.default=l,El}var Lg;function Nv(){if(Lg)return Vt;Lg=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.PostgrestError=Vt.PostgrestBuilder=Vt.PostgrestTransformBuilder=Vt.PostgrestFilterBuilder=Vt.PostgrestQueryBuilder=Vt.PostgrestClient=void 0;const o=sr,a=o.__importDefault(Av());Vt.PostgrestClient=a.default;const s=o.__importDefault(qp());Vt.PostgrestQueryBuilder=s.default;const l=o.__importDefault(Ou());Vt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Mp());Vt.PostgrestTransformBuilder=u.default;const d=o.__importDefault(Bp());Vt.PostgrestBuilder=d.default;const f=o.__importDefault(Dp());return Vt.PostgrestError=f.default,Vt.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:f.default},Vt}var Lp=Nv();const Ip=op(Lp),Ov=uv({__proto__:null,default:Ip},[Lp]),{PostgrestClient:Rv,PostgrestQueryBuilder:ux,PostgrestFilterBuilder:dx,PostgrestTransformBuilder:hx,PostgrestBuilder:fx,PostgrestError:gx}=Ip||Ov;class kv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const zv="2.81.1",Uv=`realtime-js/${zv}`,Hp="1.0.0",Dv="2.0.0",Ig=Hp,mu=1e4,Bv=1e3,Mv=100;var oi;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(oi||(oi={}));var Nt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Nt||(Nt={}));var jn;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(jn||(jn={}));var yu;(function(o){o.websocket="websocket"})(yu||(yu={}));var ci;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(ci||(ci={}));class qv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:f}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(l,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(d,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(u,j=>m.setUint8(v++,j.charCodeAt(0)));var _=new Uint8Array(p.byteLength+f.byteLength);return _.set(new Uint8Array(p),0),_.set(new Uint8Array(f),p.byteLength),_.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let _=new DataView(v),j=0;_.setUint8(j++,this.KINDS.userBroadcastPush),_.setUint8(j++,u.length),_.setUint8(j++,d.length),_.setUint8(j++,f.length),_.setUint8(j++,g.length),_.setUint8(j++,this.BINARY_ENCODING),Array.from(u,w=>_.setUint8(j++,w.charCodeAt(0))),Array.from(d,w=>_.setUint8(j++,w.charCodeAt(0))),Array.from(f,w=>_.setUint8(j++,w.charCodeAt(0))),Array.from(g,w=>_.setUint8(j++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,_=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,j=new ArrayBuffer(this.HEADER_LENGTH+_);let b=new DataView(j),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,f.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(d,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(f,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(g,O=>b.setUint8(w++,O.charCodeAt(0)));var N=new Uint8Array(j.byteLength+v.byteLength);return N.set(new Uint8Array(j),0),N.set(new Uint8Array(v),j.byteLength),N.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,f,g,p]=l;return s({join_ref:u,ref:d,topic:f,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+f));g=g+f;const _=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:_}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+f));p=p+f;const j=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:j,response:b};return{join_ref:m,ref:v,topic:_,event:jn.reply,payload:w}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let f=this.HEADER_LENGTH+2;const g=l.decode(a.slice(f,f+u));f=f+u;const p=l.decode(a.slice(f,f+d));f=f+d;const m=JSON.parse(l.decode(a.slice(f,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const _=l.decode(a.slice(p,p+f));p=p+f;const j=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(j)):j,w={type:this.BROADCAST,event:v,payload:b};return f>0&&(w.meta=JSON.parse(_)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Vp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(rt||(rt={}));const Hg=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,f)=>(d[f]=Lv(f,o,a,u),d),{}):{}},Lv=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,f=s[o];return d&&!l.includes(d)?$p(d,f):vu(f)},$p=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return $v(a,s)}switch(o){case rt.bool:return Iv(a);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return Hv(a);case rt.json:case rt.jsonb:return Vv(a);case rt.timestamp:return Pv(a);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return vu(a);default:return vu(a)}},vu=o=>o,Iv=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Hv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Vv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},$v=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const f=o.slice(1,s);try{d=JSON.parse("["+f+"]")}catch{d=f?f.split(","):[]}return d.map(g=>$p(a,g))}return o},Pv=o=>typeof o=="string"?o.replace(" ","T"):o,Pp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class iu{constructor(a,s,l={},u=mu){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Vg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Vg||(Vg={}));class ns{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ns.syncState(this.state,u,d,f),this.pendingDiffs.forEach(p=>{this.state=ns.syncDiff(this.state,p,d,f)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=ns.syncDiff(this.state,u,d,f),g())}),this.onJoin((u,d,f)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:f})}),this.onLeave((u,d,f)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),f=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{f[m]||(p[m]=v)}),this.map(f,(m,v)=>{const _=d[m];if(_){const j=v.map(O=>O.presence_ref),b=_.map(O=>O.presence_ref),w=v.filter(O=>b.indexOf(O.presence_ref)<0),N=_.filter(O=>j.indexOf(O.presence_ref)<0);w.length>0&&(g[m]=w),N.length>0&&(p[m]=N)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:f}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const _=a[g].map(b=>b.presence_ref),j=v.filter(b=>_.indexOf(b.presence_ref)<0);a[g].unshift(...j)}l(g,v,p)}),this.map(f,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(_=>_.presence_ref);m=m.filter(_=>v.indexOf(_.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $g;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})($g||($g={}));var as;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(as||(as={}));var la;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(la||(la={}));class Ru{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=Nt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new iu(this,jn.join,this.params,this.timeout),this.rejoinTimer=new Vp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nt.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Nt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(jn.reply,{},(f,g)=>{this._trigger(this._replyEventName(g),f)}),this.presence=new ns(this),this.broadcastEndpointURL=Pp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Nt.closed){const{config:{broadcast:f,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[as.PRESENCE]&&this.bindings[as.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,_={},j={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(la.CHANNEL_ERROR,b)),this._onClose(()=>a?.(la.CLOSED)),this.updateJoinPayload(Object.assign({config:j},_)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(la.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,O=(w=N?.length)!==null&&w!==void 0?w:0,T=[];for(let I=0;I<O;I++){const M=N[I],{filter:{event:K,schema:E,table:q,filter:D}}=M,V=b&&b[I];if(V&&V.event===K&&V.schema===E&&V.table===q&&V.filter===D)T.push(Object.assign(Object.assign({},M),{id:V.id}));else{this.unsubscribe(),this.state=Nt.errored,a?.(la.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,a&&a(la.SUBSCRIBED);return}}).receive("error",b=>{this.state=Nt.errored,a?.(la.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(la.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===Nt.joined&&a===as.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:f}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var f,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(f=this.params)===null||f===void 0?void 0:f.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=Nt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(jn.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new iu(this,jn.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Nt.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),f=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),f}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new iu(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Mv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const f=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=jn;if(l&&[g,p,m,v].indexOf(f)>=0&&l!==this._joinRef())return;let j=this._onMessage(f,s,l);if(s&&!j)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,N,O;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((O=(N=b.filter)===null||N===void 0?void 0:N.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===f}).map(b=>b.callback(j,l)):(d=this.bindings[f])===null||d===void 0||d.filter(b=>{var w,N,O,T,I,M;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in b){const K=b.id,E=(w=b.filter)===null||w===void 0?void 0:w.event;return K&&((N=s.ids)===null||N===void 0?void 0:N.includes(K))&&(E==="*"||E?.toLocaleLowerCase()===((O=s.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const K=(I=(T=b?.filter)===null||T===void 0?void 0:T.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return K==="*"||K===((M=s?.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===f}).map(b=>{if(typeof j=="object"&&"ids"in j){const w=j.data,{schema:N,table:O,commit_timestamp:T,type:I,errors:M}=w;j=Object.assign(Object.assign({},{schema:N,table:O,commit_timestamp:T,eventType:I,new:{},old:{},errors:M}),this._getPayloadRecords(w))}b.callback(j,l)})}_isClosed(){return this.state===Nt.closed}_isJoined(){return this.state===Nt.joined}_isJoining(){return this.state===Nt.joining}_isLeaving(){return this.state===Nt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Ru.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(jn.close,{},a)}_onError(a){this._on(jn.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Hg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Hg(a.columns,a.old_record)),s}}const ru=()=>{},Rl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Gv=[1e3,2e3,5e3,1e4],Kv=1e4,Yv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mu,this.transport=null,this.heartbeatIntervalMs=Rl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ru,this.ref=0,this.reconnectTimer=null,this.vsn=Ig,this.logger=ru,this.conn=null,this.sendBuffer=[],this.serializer=new qv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${yu.websocket}`,this.httpEndpoint=Pp(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=kv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case oi.connecting:return ci.Connecting;case oi.open:return ci.Open;case oi.closing:return ci.Closing;default:return ci.Closed}}isConnected(){return this.connectionState()===ci.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Ru(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,f=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Bv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Rl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:f}=s,g=f?`(${f})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,f)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===oi.open||this.conn.readyState===oi.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(jn.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Yv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:Uv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(jn.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Vp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Rl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,f,g,p,m,v,_,j,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:mu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Rl.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(f=a?.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:ru,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Ig,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Gv[w-1]||Kv),this.vsn){case Hp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,N)=>N(JSON.stringify(w))),this.decode=(_=a?.decode)!==null&&_!==void 0?_:((w,N)=>N(JSON.parse(w)));break;case Dv:this.encode=(j=a?.encode)!==null&&j!==void 0?j:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class ku extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function pt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Fv extends ku{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class bu extends ku{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const zu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Qv=()=>Response,_u=o=>{if(Array.isArray(o))return o.map(s=>_u(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=_u(l)}),a},Xv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},su=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},Zv=(o,a,s)=>we(void 0,void 0,void 0,function*(){const l=yield Qv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,f=u?.statusCode||d+"";a(new Fv(su(u),d,f))}).catch(u=>{a(new bu(su(u),u))}):a(new bu(su(o),o))}),Wv=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Xv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function ls(o,a,s,l,u,d){return we(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,Wv(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>f(p)).catch(p=>Zv(p,g,l))})})}function is(o,a,s,l){return we(this,void 0,void 0,function*(){return ls(o,"GET",a,s,l)})}function kn(o,a,s,l,u){return we(this,void 0,void 0,function*(){return ls(o,"POST",a,l,u,s)})}function xu(o,a,s,l,u){return we(this,void 0,void 0,function*(){return ls(o,"PUT",a,l,u,s)})}function eb(o,a,s,l){return we(this,void 0,void 0,function*(){return ls(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function Uu(o,a,s,l,u){return we(this,void 0,void 0,function*(){return ls(o,"DELETE",a,l,u,s)})}class tb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return we(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(pt(a))return{data:null,error:a};throw a}})}}var Gp;class nb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Gp]="BlobDownloadBuilder",this.promise=null}asStream(){return new tb(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return we(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(pt(a))return{data:null,error:a};throw a}})}}Gp=Symbol.toStringTag;const ab={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ib{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=zu(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return we(this,void 0,void 0,function*(){try{let d;const f=Object.assign(Object.assign({},Pg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(f.upsert)});const p=f.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",f.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!f.duplex&&(f.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),_=yield(a=="PUT"?xu:kn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},f?.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:_.Id,fullPath:_.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(pt(d))return{data:null,error:d};throw d}})}upload(a,s,l){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return we(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),f=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:Pg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const _=yield xu(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:_.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(pt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return we(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield kn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),f=new URL(this.url+d.url),g=f.searchParams.get("token");if(!g)throw new ku("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}update(a,s,l){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return we(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}copy(a,s,l){return we(this,void 0,void 0,function*(){try{return{data:{path:(yield kn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return we(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield kn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const f=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${f}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return we(this,void 0,void 0,function*(){try{const u=yield kn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),f=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>is(this.fetch,`${this.url}/${u}/${g}${f}`,{headers:this.headers,noResolveJson:!0});return new nb(p,this.shouldThrowOnError)}info(a){return we(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield is(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:_u(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}exists(a){return we(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield eb(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l)&&l instanceof bu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return we(this,void 0,void 0,function*(){try{return{data:yield Uu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}list(a,s,l){return we(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},ab),s),{prefix:a||""});return{data:yield kn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}listV2(a,s){return we(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield kn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const Kp="2.81.1",Yp={"X-Client-Info":`storage-js/${Kp}`};class rb{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=zu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return we(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield is(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}getBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}createBucket(a){return we(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return we(this,void 0,void 0,function*(){try{return{data:yield xu(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield Uu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class sb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=zu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}listBuckets(a){return we(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield is(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield Uu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}}const Du={"X-Client-Info":`storage-js/${Kp}`,"Content-Type":"application/json"};class Jp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function cn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class lu extends Jp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lb extends Jp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Gg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Gg||(Gg={}));const Bu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ob=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Kg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),cb=(o,a,s)=>we(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(f=>{const g=f?.statusCode||f?.code||u+"";a(new lu(Kg(f),u,g))}).catch(()=>{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new lu(g,u,f))});else{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new lu(g,u,f))}}else a(new lb(Kg(o),o))}),ub=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(ob(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function db(o,a,s,l,u,d){return we(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,ub(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>f(p)).catch(p=>cb(p,g,l))})})}function un(o,a,s,l,u){return we(this,void 0,void 0,function*(){return db(o,"POST",a,l,u,s)})}class hb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}getIndex(a,s){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(cn(l))return{data:null,error:l};throw l}})}listIndexes(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(cn(l))return{data:null,error:l};throw l}})}}class fb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return we(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield un(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}getVectors(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}listVectors(a){return we(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield un(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}queryVectors(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}deleteVectors(a){return we(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield un(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}}class gb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}getBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}listBuckets(){return we(this,arguments,void 0,function*(a={}){try{return{data:yield un(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}deleteBucket(a){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}}class pb extends gb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new mb(this.url,this.headers,a,this.fetch)}}class mb extends hb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return we(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return we(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return we(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return we(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new yb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class yb extends fb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return we(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return we(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return we(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return we(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return we(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vb extends rb{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new ib(this.url,this.headers,a,this.fetch)}get vectors(){return new pb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new sb(this.url+"/iceberg",this.headers,this.fetch)}}const bb="2.81.1";let ts="";typeof Deno<"u"?ts="deno":typeof document<"u"?ts="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ts="react-native":ts="node";const _b={"X-Client-Info":`supabase-js-${ts}/${bb}`},xb={headers:_b},jb={schema:"public"},Sb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wb={},Eb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Cb=()=>Headers,Tb=(o,a,s)=>{const l=Eb(s),u=Cb();return async(d,f)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(f?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},f),{headers:m}))}};function Ab(o){return o.endsWith("/")?o:o+"/"}function Nb(o,a){var s,l;const{db:u,auth:d,realtime:f,global:g}=o,{db:p,auth:m,realtime:v,global:_}=a,j={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),f),storage:{},global:Object.assign(Object.assign(Object.assign({},_),g),{headers:Object.assign(Object.assign({},(s=_?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?j.accessToken=o.accessToken:delete j.accessToken,j}function Ob(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ab(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Fp="2.81.1",tr=30*1e3,ju=3,ou=ju*tr,Rb="http://localhost:9999",kb="supabase.auth.token",zb={"X-Client-Info":`gotrue-js/${Fp}`},Su="X-Supabase-Api-Version",Qp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ub=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Db=600*1e3;class rs extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function Ee(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Bb extends rs{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function Mb(o){return Ee(o)&&o.name==="AuthApiError"}class ui extends rs{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class Ba extends rs{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class On extends Ba{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function qb(o){return Ee(o)&&o.name==="AuthSessionMissingError"}class Qi extends Ba{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class kl extends Ba{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class zl extends Ba{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Lb(o){return Ee(o)&&o.name==="AuthImplicitGrantRedirectError"}class Yg extends Ba{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wu extends Ba{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function cu(o){return Ee(o)&&o.name==="AuthRetryableFetchError"}class Jg extends Ba{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class Eu extends Ba{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fg=` 	
\r=`.split(""),Ib=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Fg.length;a+=1)o[Fg[a].charCodeAt(0)]=-2;for(let a=0;a<Bl.length;a+=1)o[Bl[a].charCodeAt(0)]=a;return o})();function Qg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Bl[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Bl[l]),a.queuedBits-=6}}function Xp(o,a,s){const l=Ib[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Xg(o){const a=[],s=f=>{a.push(String.fromCodePoint(f))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=f=>{$b(f,l,s)};for(let f=0;f<o.length;f+=1)Xp(o.charCodeAt(f),u,d);return a.join("")}function Hb(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Vb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Hb(l,a)}}function $b(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function ar(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)Xp(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Pb(o){const a=[];return Vb(o,s=>a.push(s)),new Uint8Array(a)}function di(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Qg(u,s,l)),Qg(null,s,l),a.join("")}function Gb(o){return Math.round(Date.now()/1e3)+o}function Kb(){return Symbol("auth-callback")}const Mt=()=>typeof window<"u"&&typeof document<"u",ii={tested:!1,writable:!1},Zp=()=>{if(!Mt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ii.tested)return ii.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ii.tested=!0,ii.writable=!0}catch{ii.tested=!0,ii.writable=!1}return ii.writable};function Yb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const Wp=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Jb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",nr=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},ri=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Ua=async(o,a)=>{await o.removeItem(a)};class Il{constructor(){this.promise=new Il.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Il.promiseConstructor=Promise;function uu(o){const a=o.split(".");if(a.length!==3)throw new Eu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!Ub.test(a[l]))throw new Eu("JWT not in base64url format");return{header:JSON.parse(Xg(a[0])),payload:JSON.parse(Xg(a[1])),signature:ar(a[2]),raw:{header:a[0],payload:a[1]}}}async function Fb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Qb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const f=await o(d);if(!a(d,null,f)){l(f);return}}catch(f){if(!a(d,f)){u(f);return}}})()})}function Xb(o){return("0"+o.toString(16)).substr(-2)}function Zb(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Xb).join("")}async function Wb(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function e0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await Wb(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Xi(o,a,s=!1){const l=Zb();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await nr(o,`${a}-code-verifier`,u);const d=await e0(l);return[d,l===d?"plain":"s256"]}const t0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function n0(o){const a=o.headers.get(Su);if(!a||!a.match(t0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function a0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function i0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const r0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zi(o){if(!r0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function du(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function Zg(o){return JSON.parse(JSON.stringify(o))}const li=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),l0=[502,503,504];async function Wg(o){var a;if(!Jb(o))throw new wu(li(o),0);if(l0.includes(o.status))throw new wu(li(o),o.status);let s;try{s=await o.json()}catch(d){throw new ui(li(d),d)}let l;const u=n0(o);if(u&&u.getTime()>=Qp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Jg(li(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new On}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,f)=>d&&typeof f=="string",!0))throw new Jg(li(s),o.status,s.weak_password.reasons);throw new Bb(li(s),o.status||500,l)}const o0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Ne(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[Su]||(d[Su]=Qp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const f=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(f.redirect_to=l.redirectTo);const g=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",p=await c0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function c0(o,a,s,l,u,d){const f=o0(a,l,u,d);let g;try{g=await o(s,Object.assign({},f))}catch(p){throw console.error(p),new wu(li(p),0)}if(g.ok||await Wg(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await Wg(p)}}function Rn(o){var a;let s=null;h0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Gb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function ep(o){const a=Rn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Da(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function u0(o){return{data:o,error:null}}function d0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,f=rr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},f);return{data:{properties:g,user:p},error:null}}function tp(o){return o}function h0(o){return o.access_token&&o.refresh_token&&o.expires_in}const hu=["global","local","others"];class f0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=Wp(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=hu[0]){if(hu.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hu.join(", ")}`);try{return await Ne(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Ee(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Da})}catch(l){if(Ee(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=rr(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:d0,redirectTo:s?.redirectTo})}catch(s){if(Ee(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Ne(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Da})}catch(s){if(Ee(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const _=await v.json(),j=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=N}),m.total=parseInt(j)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Ee(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){Zi(a);try{return await Ne(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Da})}catch(s){if(Ee(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){Zi(a);try{return await Ne(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:Da})}catch(l){if(Ee(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){Zi(a);try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:Da})}catch(l){if(Ee(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){Zi(a.userId);try{const{data:s,error:l}=await Ne(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _deleteFactor(a){Zi(a.userId),Zi(a.id);try{return{data:await Ne(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const _=await v.json(),j=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=N}),m.total=parseInt(j)),{data:Object.assign(Object.assign({},_),m),error:null}}catch(m){if(Ee(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Ne(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Ne(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Ee(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Ne(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Ne(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}}function np(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const Wi={debug:!!(globalThis&&Zp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class em extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class g0 extends em{}async function p0(o,a,s){Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new g0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Wi.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function m0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tm(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function y0(o){return parseInt(o,16)}function v0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function b0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:f,notBefore:g,requestId:p,resources:m,scheme:v,uri:_,version:j}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!_)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(j!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${j}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=tm(o.address),w=v?`${v}://${l}`:l,N=o.statement?`${o.statement}
`:"",O=`${w} wants you to sign in with your Ethereum account:
${b}

${N}`;let T=`URI: ${_}
Version: ${j}
Chain ID: ${s}${f?`
Nonce: ${f}`:""}
Issued At: ${d.toISOString()}`;if(u&&(T+=`
Expiration Time: ${u.toISOString()}`),g&&(T+=`
Not Before: ${g.toISOString()}`),p&&(T+=`
Request ID: ${p}`),m){let I=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);I+=`
- ${M}`}T+=I}return`${O}
${T}`}class Ct extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Ml extends Ct{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function _0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Ct({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Ct({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Ct({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new Ct({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Ct({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Ct({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Ct({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Ct({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const f=window.location.hostname;if(nm(f)){if(d.rp.id!==f)return new Ct({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ct({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Ct({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Ct({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ct({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function x0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Ct({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Ct({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(nm(l)){if(s.rpId!==l)return new Ct({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ct({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Ct({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ct({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class j0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const S0=new j0;function w0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=rr(o,["challenge","user","excludeCredentials"]),d=ar(a).buffer,f=Object.assign(Object.assign({},s),{id:ar(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:f});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:ar(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function E0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=rr(o,["challenge","allowCredentials"]),u=ar(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let f=0;f<s.length;f++){const g=s[f];d.allowCredentials[f]=Object.assign(Object.assign({},g),{id:ar(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function C0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:di(new Uint8Array(o.response.attestationObject)),clientDataJSON:di(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function T0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:di(new Uint8Array(u.authenticatorData)),clientDataJSON:di(new Uint8Array(u.clientDataJSON)),signature:di(new Uint8Array(u.signature)),userHandle:u.userHandle?di(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function nm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function ap(){var o,a;return!!(Mt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function A0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ml("Browser returned unexpected credential type",a)}:{data:null,error:new Ml("Empty credential response",a)}}catch(a){return{data:null,error:_0({error:a,options:o})}}}async function N0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ml("Browser returned unexpected credential type",a)}:{data:null,error:new Ml("Empty credential response",a)}}catch(a){return{data:null,error:x0({error:a,options:o})}}}const O0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},R0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ql(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const f=u[d];if(f!==void 0)if(Array.isArray(f))l[d]=f;else if(s(f))l[d]=f;else if(a(f)){const g=l[d];a(g)?l[d]=ql(g,f):l[d]=ql(f)}else l[d]=f}return l}function k0(o,a){return ql(O0,o,a||{})}function z0(o,a){return ql(R0,o,a||{})}class U0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:f,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!f)return{data:null,error:g};const p=u??S0.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=k0(f.webauthn.credential_options.publicKey,d?.create),{data:v,error:_}=await A0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}case"request":{const m=z0(f.webauthn.credential_options.publicKey,d?.request),{data:v,error:_}=await N0(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:_}}}}catch(f){return Ee(f)?{data:null,error:f}:{data:null,error:new ui("Unexpected error in challenge",f)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new rs("rpId is required for WebAuthn authentication")};try{if(!ap())return{data:null,error:new ui("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!f)return{data:null,error:g};const{webauthn:p}=f;return this._verify({factorId:a,challengeId:f.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(f){return Ee(f)?{data:null,error:f}:{data:null,error:new ui("Unexpected error in authenticate",f)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new rs("rpId is required for WebAuthn registration")};try{if(!ap())return{data:null,error:new ui("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this._enroll({friendlyName:a});if(!f)return await this.client.mfa.listFactors().then(v=>{var _;return(_=v.data)===null||_===void 0?void 0:_.all.find(j=>j.factor_type==="webauthn"&&j.friendly_name===a&&j.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:f.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(f){return Ee(f)?{data:null,error:f}:{data:null,error:new ui("Unexpected error in register",f)}}}}m0();const D0={url:Rb,storageKey:kb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ip(o,a,s){return await s()}const er={};class ss{get jwks(){var a,s;return(s=(a=er[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){er[this.storageKey]=Object.assign(Object.assign({},er[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=er[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){er[this.storageKey]=Object.assign(Object.assign({},er[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},D0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=ss.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,ss.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&Mt()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new f0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Wp(d.fetch),this.lock=d.lock||ip,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:Mt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=p0:this.lock=ip,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new U0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:Zp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=np(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=np(this.memoryStorage)),Mt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Fp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(Mt()&&(s=Yb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),Mt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Lb(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:f,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",f,"redirect type",g),await this._saveSession(f),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return Ee(s)?this._returnResult({error:s}):this._returnResult({error:new ui("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:Rn}),{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ee(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:_,options:j}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await Xi(this.storage,this.storageKey)),d=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:j?.emailRedirectTo,body:{email:v,password:_,data:(s=j?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:j?.captchaToken},code_challenge:b,code_challenge_method:w},xform:Rn})}else if("phone"in a){const{phone:v,password:_,options:j}=a;d=await Ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:_,data:(l=j?.data)!==null&&l!==void 0?l:{},channel:(u=j?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:j?.captchaToken}},xform:Rn})}else throw new kl("You must provide either an email or phone number and a password");const{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ee(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:f,options:g}=a;s=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else if("phone"in a){const{phone:d,password:f,options:g}=a;s=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else throw new kl("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Qi;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,f,g,p,m,v,_,j;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:N,wallet:O,statement:T,options:I}=a;let M;if(Mt())if(typeof O=="object")M=O;else{const ge=window;if("ethereum"in ge&&typeof ge.ethereum=="object"&&"request"in ge.ethereum&&typeof ge.ethereum.request=="function")M=ge.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=O}const K=new URL((s=I?.url)!==null&&s!==void 0?s:window.location.href),E=await M.request({method:"eth_requestAccounts"}).then(ge=>ge).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const q=tm(E[0]);let D=(l=I?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!D){const ge=await M.request({method:"eth_chainId"});D=y0(ge)}const V={domain:K.host,address:q,statement:T,uri:K.href,version:"1",chainId:D,nonce:(u=I?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(f=(d=I?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(g=I?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=I?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=I?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=I?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=b0(V),w=await M.request({method:"personal_sign",params:[v0(b),q]})}try{const{data:N,error:O}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(j=a.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:Rn});if(O)throw O;if(!N||!N.session||!N.user){const T=new Qi;return this._returnResult({data:{user:null,session:null},error:T})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:O})}catch(N){if(Ee(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async signInWithSolana(a){var s,l,u,d,f,g,p,m,v,_,j,b;let w,N;if("message"in a)w=a.message,N=a.signature;else{const{chain:O,wallet:T,statement:I,options:M}=a;let K;if(Mt())if(typeof T=="object")K=T;else{const q=window;if("solana"in q&&typeof q.solana=="object"&&("signIn"in q.solana&&typeof q.solana.signIn=="function"||"signMessage"in q.solana&&typeof q.solana.signMessage=="function"))K=q.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=T}const E=new URL((s=M?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in K&&K.signIn){const q=await K.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),I?{statement:I}:null));let D;if(Array.isArray(q)&&q[0]&&typeof q[0]=="object")D=q[0];else if(q&&typeof q=="object"&&"signedMessage"in q&&"signature"in q)D=q;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)w=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),N=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in K)||typeof K.signMessage!="function"||!("publicKey"in K)||typeof K!="object"||!K.publicKey||!("toBase58"in K.publicKey)||typeof K.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,K.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(u=(l=M?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=M?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((f=M?.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((g=M?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((p=M?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((_=(v=M?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||_===void 0)&&_.length?["Resources",...M.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const q=await K.signMessage(new TextEncoder().encode(w),"utf8");if(!q||!(q instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=q}}try{const{data:O,error:T}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:di(N)},!((j=a.options)===null||j===void 0)&&j.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Rn});if(T)throw T;if(!O||!O.session||!O.user){const I=new Qi;return this._returnResult({data:{user:null,session:null},error:I})}return O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),this._returnResult({data:Object.assign({},O),error:T})}catch(O){if(Ee(O))return this._returnResult({data:{user:null,session:null},error:O});throw O}}async _exchangeCodeForSession(a){const s=await ri(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:f}=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:Rn});if(await Ua(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!d||!d.session||!d.user){const g=new Qi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:f})}catch(d){if(Ee(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:f}=a,g=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:f,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Rn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new Qi;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,f;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Xi(this.storage,this.storageKey));const{error:_}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:_})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(f=p?.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new kl("You must provide either an email or phone number.")}catch(g){if(Ee(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:f,error:g}=await Ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:Rn});if(g)throw g;if(!f)throw new Error("An error occurred on token verification.");const p=f.session,m=f.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(Ee(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,f;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Xi(this.storage,this.storageKey));const m=await Ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:u0});return!((d=m.data)===null||d===void 0)&&d.url&&Mt()&&!(!((f=a.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(Ee(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new On;const{error:u}=await Ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(Ee(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:f}=await Ne(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:f,error:g}=await Ne(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:g})}throw new kl("You must provide either an email or phone number and a type")}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await ri(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<ou:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const f=await ri(this.userStorage,this.storageKey+"-user");f?.user?a.user=f.user:a.user=du()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};a.user=s0(a.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Da}):await this._useSession(async s=>{var l,u,d;const{data:f,error:g}=s;if(g)throw g;return!(!((l=f.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new On}:await Ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Da})})}catch(s){if(Ee(s))return qb(s)&&(await this._removeSession(),await Ua(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new On;const f=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await Xi(this.storage,this.storageKey));const{data:m,error:v}=await Ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:f.access_token,xform:Da});if(v)throw v;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(l){if(Ee(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new On;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:f}=uu(a.access_token);if(f.exp&&(l=f.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(Ee(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:f,error:g}=s;if(g)throw g;a=(l=f.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new On;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!Mt())throw new zl("No browser detected.");if(a.error||a.error_description||a.error_code)throw new zl(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Yg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zl("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Yg("No code detected.");const{data:I,error:M}=await this._exchangeCodeForSession(a.code);if(M)throw M;const K=new URL(window.location.href);return K.searchParams.delete("code"),window.history.replaceState(window.history.state,"",K.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:f,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!f||!m)throw new zl("No session defined in URL");const v=Math.round(Date.now()/1e3),_=parseInt(g);let j=v+_;p&&(j=parseInt(p));const b=j-v;b*1e3<=tr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${_}s`);const w=j-_;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,j,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,j,v);const{data:N,error:O}=await this._getUser(d);if(O)throw O;const T={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:_,expires_at:j,refresh_token:f,token_type:m,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:a.type},error:null})}catch(l){if(Ee(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await ri(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const f=(l=u.session)===null||l===void 0?void 0:l.access_token;if(f){const{error:g}=await this.admin.signOut(f,a);if(g&&!(Mb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await Ua(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Kb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:f}=s;if(f)throw f;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Xi(this.storage,this.storageKey,!0));try{return await Ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(Ee(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var f,g,p,m,v;const{data:_,error:j}=d;if(j)throw j;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(f=a.options)===null||f===void 0?void 0:f.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Ne(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=_.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return Mt()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(Ee(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:f,provider:g,token:p,access_token:m,nonce:v}=a,_=await Ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Rn}),{data:j,error:b}=_;return b?this._returnResult({data:{user:null,session:null},error:b}):!j||!j.session||!j.user?this._returnResult({data:{user:null,session:null},error:new Qi}):(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("USER_UPDATED",j.session)),this._returnResult({data:j,error:b}))}catch(u){if(Ee(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)throw f;return await Ne(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Qb(async u=>(u>0&&await Fb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Rn})),(u,d)=>{const f=200*Math.pow(2,u);return d&&cu(d)&&Date.now()+f-l<tr})}catch(l){if(this._debug(s,"error",l),Ee(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),Mt()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await ri(this.storage,this.storageKey);if(u&&this.userStorage){let f=await ri(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:u.user},await nr(this.userStorage,this.storageKey+"-user",f)),u.user=(a=f?.user)!==null&&a!==void 0?a:du()}else if(u&&!u.user&&!u.user){const f=await ri(this.storage,this.storageKey+"-user");f&&f?.user?(u.user=f.user,await Ua(this.storage,this.storageKey+"-user"),await nr(this.storage,this.storageKey,u)):u.user=du()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<ou;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${ou}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:f}=await this._callRefreshToken(u.refresh_token);f&&(console.error(f),cu(f)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:g}=await this._getUser(u.access_token);!g&&f?.user?(u.user=f.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(l,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new On;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Il;const{data:d,error:f}=await this._refreshAccessToken(a);if(f)throw f;if(!d.session)throw new On;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),Ee(d)){const f={data:null,error:d};return cu(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(f),f}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],f=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(f),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await nr(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=Zg(u);await nr(this.storage,this.storageKey,d)}else{const u=Zg(s);await nr(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await Ua(this.storage,this.storageKey),await Ua(this.storage,this.storageKey+"-code-verifier"),await Ua(this.storage,this.storageKey+"-user"),this.userStorage&&await Ua(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&Mt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),tr);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/tr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${tr}ms, refresh threshold is ${ju} ticks`),u<=ju&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof em)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Mt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,f]=await Xi(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(f)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Ne(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)return this._returnResult({data:null,error:f});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Ne(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?C0(a.webauthn.credential_response):T0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Ne(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:f,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=await Ne(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(f.error)return f;const{data:g}=f;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:w0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:E0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=uu(l.access_token);let f=null;d.aal&&(f=d.aal);let g=f;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Ne(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new On})})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new On});const f=await Ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Mt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(Ee(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new On});const f=await Ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Mt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(Ee(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Db>u)return l;const{data:d,error:f}=await Ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:f,raw:{header:g,payload:p}}=uu(l);s?.allowExpired||a0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:f},error:null}}const v=i0(u.alg),_=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,_,f,Pb(`${g}.${p}`)))throw new Eu("Invalid JWT signature");return{data:{claims:d,header:u,signature:f},error:null}}catch(l){if(Ee(l))return this._returnResult({data:null,error:l});throw l}}}ss.nextInstanceID={};const B0=ss;class M0 extends B0{constructor(a){super(a)}}class q0{constructor(a,s,l){var u,d,f;this.supabaseUrl=a,this.supabaseKey=s;const g=Ob(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:jb,realtime:wb,auth:Object.assign(Object.assign({},Sb),{storageKey:p}),global:xb},v=Nb(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,j)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(j)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=v.auth)!==null&&f!==void 0?f:{},this.headers,v.global.fetch),this.fetch=Tb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(_=>this.realtime.setAuth(_)).catch(_=>console.warn("Failed to set initial Realtime auth token:",_)),this.rest=new Rv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new vb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Tv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:f,flowType:g,lock:p,debug:m,throwOnError:v},_,j){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),_),storageKey:f,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:j,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Jv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const L0=(o,a,s)=>new q0(o,a,s);function I0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}I0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const H0="https://sqwqlvsjtimallidxrsz.supabase.co",V0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",W=L0(H0,V0,{auth:{persistSession:!1}}),Sn=Object.freeze(Object.defineProperty({__proto__:null,default:W,supabase:W},Symbol.toStringTag,{value:"Module"}));function $0({onLogin:o}){const[a,s]=S.useState(""),[l,u]=S.useState(""),[d,f]=S.useState(null);async function g(p){p.preventDefault(),f(null);try{const{data:m,error:v}=await W.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){f("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){f("Credenciales invlidas");return}const _=m;if(_.password===l){const j={id:_.id,username:_.username,role:_.role};localStorage.setItem("user",JSON.stringify(j));try{console.debug("Login: stored localStorage.user =",j)}catch{}try{if(_.role==="cajero"){const{data:b,error:w}=await W.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",_.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}f("Inicio de sesin correcto"),typeof o=="function"&&o()}else f("Credenciales invlidas")}catch(m){f(m.message||"Error al consultar la base de datos")}}return r.jsx("div",{className:"login-root",children:r.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[r.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),r.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),r.jsxs("div",{className:"login-inner",children:[r.jsxs("form",{onSubmit:g,children:[r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"username",children:"Usuario"}),r.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"password",children:"Contrasea"}),r.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),r.jsx("div",{children:r.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&r.jsx("p",{style:{marginTop:12},children:d}),r.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",r.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function P0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),r.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function G0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!0),[d,f]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,j]=S.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=S.useState(()=>{try{const T=localStorage.getItem("user");if(T)return JSON.parse(T).username||"usuario"}catch{}return"usuario"});S.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(T=>T.json()).then(T=>{const I=T&&Array.isArray(T.ingresos)?T.ingresos:[],M=localStorage.getItem("ingresosEfectivo");let K=[];try{M&&(K=JSON.parse(M))}catch{}const E=[...I,...K];s(E)}).catch(()=>{const T=localStorage.getItem("ingresosEfectivo");try{T&&s(JSON.parse(T))}catch{s([])}}).finally(()=>u(!1))},[]);function N(T){localStorage.setItem("ingresosEfectivo",JSON.stringify(T))}function O(T){if(T.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const I=a.length?Math.max(...a.map(E=>E.id))+1:1,M={id:I,factura:d||`F-${I}`,motivo:g,monto:Number(m),fechaHora:new Date(_).toISOString(),usuario:b},K=[...a,M];s(K),N(K),f(""),p(""),v(""),j(new Date().toISOString().slice(0,16))}return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?r.jsx("p",{children:"Cargando..."}):r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),r.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),r.jsx("tbody",{children:a.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(T=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:{padding:8},children:T.factura}),r.jsx("td",{style:{padding:8},children:T.motivo}),r.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",T.monto.toFixed(2)]}),r.jsx("td",{style:{padding:8},children:new Date(T.fechaHora).toLocaleString()}),r.jsx("td",{style:{padding:8},children:T.usuario})]},T.id))})]})})]}),r.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),r.jsxs("form",{onSubmit:O,style:{display:"grid",gap:8},children:[r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",r.jsx("input",{value:d,onChange:T=>f(T.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",r.jsx("input",{value:g,onChange:T=>p(T.target.value),className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",r.jsx("input",{value:m,onChange:T=>v(T.target.value===""?"":Number(T.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",r.jsx("input",{value:_,onChange:T=>j(T.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",r.jsx("input",{value:b,onChange:T=>w(T.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[r.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),r.jsx("button",{type:"button",onClick:()=>{f(""),p(""),v(""),j(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function K0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!1),[d,f]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(!1),[_,j]=S.useState(!1),[b,w]=S.useState(null),N=async()=>{u(!0);try{const{data:J,error:ce}=await W.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(ce)throw ce;const ye=Array.isArray(J)?J:[],B=Array.from(new Set(ye.map(C=>C.cliente_id).filter(Boolean)));let Z={};if(B.length>0)try{const{data:C}=await W.from("clientes").select("id,nombre").in("id",B);if(Array.isArray(C))for(const z of C)Z[String(z.id)]=z.nombre||""}catch(C){console.warn("Error cargando nombres de clientes:",C)}const ie=ye.map(C=>({...C,cliente_nombre:Z[String(C.cliente_id)]||null}));s(ie)}catch(J){console.warn("Error cargando cotizaciones:",J),s([])}u(!1)};S.useEffect(()=>{N()},[]);const[O,T]=S.useState(null),[I,M]=S.useState(null),[K,E]=S.useState(""),q=async J=>{f(J);try{const{data:ce,error:ye}=await W.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",J).maybeSingle();if(ye&&console.warn("Error cargando cabecera de cotizacion",ye),T(ce||null),ce&&ce.cliente_id)try{const{data:ie}=await W.from("clientes").select("id,nombre").eq("id",ce.cliente_id).maybeSingle();M(ie?.nombre||null)}catch{M(null)}else M(null);const{data:B,error:Z}=await W.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J);if(Z)throw Z;p(Array.isArray(B)?B:[]),v(!0)}catch(ce){console.warn("Error cargando detalles de cotizacion",ce),p([])}},D=async J=>{try{const{data:ce,error:ye}=await W.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J.id),B=Array.isArray(ce)?ce:[],Z={header:J,detalles:B};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(Z))}catch(ie){console.warn("No se pudo escribir localStorage",ie)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:Z}))}catch{}o()}catch(ce){console.warn("Error cargando detalles para editar",ce)}},V=async J=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:ce}=await W.from("cotizaciones_detalle").delete().eq("cotizacion_id",J);ce&&console.warn("Error eliminando detalles:",ce);const{error:ye}=await W.from("cotizaciones").delete().eq("id",J);if(ye)throw ye;N()}catch(ce){console.warn("Error eliminando cotizacion:",ce)}},ge=async()=>{if(b)try{const J={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:ce}=await W.from("cotizaciones").update(J).eq("id",b.id);if(ce&&console.warn("Error actualizando cotizacion:",ce),b.id){const{error:ye}=await W.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);ye&&console.warn("Error borrando detalles antiguos:",ye);const B=g.map(ie=>({...ie,cotizacion_id:b.id})),{error:Z}=await W.from("cotizaciones_detalle").insert(B);Z&&console.warn("Error insertando detalles actualizados:",Z)}j(!1),N()}catch(J){console.warn("Error guardando cotizacion editada:",J)}};return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),r.jsxs("div",{children:[r.jsx("button",{onClick:N,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),r.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),r.jsx("input",{placeholder:"Nmero o cliente",value:K,onChange:J=>E(J.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),r.jsx("button",{onClick:()=>E(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?r.jsx("div",{children:"Cargando..."}):a.length===0?r.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Nmero"}),r.jsx("th",{style:{padding:8},children:"Fecha"}),r.jsx("th",{style:{padding:8},children:"Usuario"}),r.jsx("th",{style:{padding:8},children:"Cliente ID"}),r.jsx("th",{style:{padding:8},children:"Total"}),r.jsx("th",{style:{padding:8},children:"Estado"}),r.jsx("th",{style:{padding:8},children:"Acciones"})]})}),r.jsx("tbody",{children:a.filter(J=>{if(!K)return!0;const ce=K.toLowerCase(),ye=(J.numero_cotizacion||"").toLowerCase(),B=(J.cliente_nombre||"")?.toLowerCase(),Z=(J.usuario||"").toLowerCase();return ye.includes(ce)||B.includes(ce)||Z.includes(ce)}).map(J=>r.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[r.jsx("td",{style:{padding:8},children:J.numero_cotizacion||""}),r.jsx("td",{style:{padding:8},children:J.fecha_cotizacion?new Date(J.fecha_cotizacion).toLocaleString():""}),r.jsx("td",{style:{padding:8},children:J.usuario||""}),r.jsx("td",{style:{padding:8},children:J.cliente_nombre||(J.cliente_id?String(J.cliente_id):"")}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||0).toFixed(2)]}),r.jsx("td",{style:{padding:8},children:J.estado||""}),r.jsxs("td",{style:{padding:8},children:[r.jsx("button",{onClick:()=>q(J.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(J.estado||"").toLowerCase()==="aceptada"?r.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):r.jsx("button",{onClick:()=>D(J),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),r.jsx("button",{onClick:()=>V(J.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},J.id))})]})]}),m&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),r.jsx("button",{onClick:()=>{v(!1),p([]),f(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[O&&r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Nmero:"})," ",O.numero_cotizacion]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Fecha:"})," ",O.fecha_cotizacion?new Date(O.fecha_cotizacion).toLocaleString():""]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Usuario:"})," ",O.usuario]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Cliente:"})," ",I??(O.cliente_id?String(O.cliente_id):"C/F")]})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Subtotal:"})," L ",Number(O.subtotal||0).toFixed(2)]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Impuesto:"})," L ",Number(O.impuesto||0).toFixed(2)]}),r.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[r.jsx("strong",{children:"Total:"})," L ",Number(O.total||0).toFixed(2)]})]})]}),r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Descripcin"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio U."}),r.jsx("th",{style:{padding:8},children:"Subtotal"}),r.jsx("th",{style:{padding:8},children:"Descuento"}),r.jsx("th",{style:{padding:8},children:"Total"})]})}),r.jsx("tbody",{children:g.map((J,ce)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:J.descripcion}),r.jsx("td",{style:{padding:8},children:J.cantidad}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.precio_unitario||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.subtotal||(J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.descuento||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||(J.subtotal||0)-(J.descuento||0)).toFixed(2)]})]},ce))})]})]})]})}),_&&b&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),r.jsx("button",{onClick:()=>{j(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Cliente"}),r.jsx("input",{value:b.cliente||"",onChange:J=>w({...b,cliente:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"RTN"}),r.jsx("input",{value:b.rtn||"",onChange:J=>w({...b,rtn:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"SKU"}),r.jsx("th",{style:{padding:8},children:"Nombre"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio"}),r.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),r.jsx("tbody",{children:g.map((J,ce)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:J.sku}),r.jsx("td",{style:{padding:8},children:J.nombre}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:J.cantidad||0,onChange:ye=>{const B=Number(ye.target.value||0),Z=[...g];Z[ce]={...Z[ce],cantidad:B},p(Z)},style:{width:80,padding:6}})}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:J.precio_unitario||0,onChange:ye=>{const B=Number(ye.target.value||0),Z=[...g];Z[ce]={...Z[ce],precio_unitario:B},p(Z)},style:{width:120,padding:6}})}),r.jsxs("td",{style:{padding:8},children:["L ",Number((J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]})]},ce))})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:()=>{j(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:ge,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function Y0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),r.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function J0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function F0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function Q0({open:o,onClose:a,onSelect:s}){const[l,u]=S.useState(""),[d,f]=S.useState(!1),[g,p]=S.useState([]);return S.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{f(!0);try{const{data:v,error:_}=await W.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(_)throw _;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&f(!1)}})(),()=>{m=!1}},[o]),S.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{f(!0);try{const v=String(l||"").trim();let _;if(v===""?_=await W.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):_=await W.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),_.error)throw _.error;p(Array.isArray(_.data)?_.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{f(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:r.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),r.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),r.jsx("th",{style:{padding:8}})]})}),r.jsxs("tbody",{children:[g.map(m=>r.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[r.jsx("td",{style:{padding:8},children:m.rtn}),r.jsx("td",{style:{padding:8},children:m.nombre}),r.jsx("td",{style:{padding:8},children:m.telefono}),r.jsx("td",{style:{padding:8},children:m.correo_electronico}),r.jsx("td",{style:{padding:8},children:r.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function X0({open:o,onClose:a,totalDue:s,onConfirm:l}){const[u,d]=S.useState(0),[f,g]=S.useState(0),[p,m]=S.useState(0);S.useEffect(()=>{o||(d(0),g(0),m(0))},[o]);const v=Number((Number(u)+Number(f)+Number(p)).toFixed(2)),_=Number((s-v).toFixed(2)),j=v>=s&&v>0,b=()=>{const w=[];u>0&&w.push(`efectivo:(${u.toFixed(2)})`),f>0&&w.push(`tarjeta:(${f.toFixed(2)})`),p>0&&w.push(`transferencia:(${p.toFixed(2)})`);const N=w.join(",");l({efectivo:u,tarjeta:f,transferencia:p,totalPaid:v,tipoPagoString:N}),a()};return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",r.jsxs("strong",{children:["L ",s.toFixed(2)]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Efectivo"}),r.jsx("input",{type:"number",value:u,onChange:w=>d(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Tarjeta"}),r.jsx("input",{type:"number",value:f,onChange:w=>g(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Transferencia"}),r.jsx("input",{type:"number",value:p,onChange:w=>m(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:r.jsxs("div",{children:[r.jsx("label",{children:"Total ingresado"}),r.jsxs("div",{style:{padding:8,borderRadius:6,border:"1px solid #e6edf3"},children:["L ",v.toFixed(2)]})]})})]}),r.jsx("div",{style:{marginTop:12},children:_>0?r.jsxs("div",{style:{color:"#ef4444"},children:["Falta: L ",_.toFixed(2)]}):r.jsxs("div",{style:{color:"#16a34a"},children:["Pago completo. Cambio/Exceso: L ",Math.abs(_).toFixed(2)]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:b,className:"btn-opaque",disabled:!j,style:{background:j?"#16a34a":"gray",color:"white"},children:"Confirmar pago"})]})]})]})}):null}function Z0({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:f}){return r.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:u}),r.jsx("th",{style:u,children:"Imagen"}),r.jsx("th",{style:u,children:"SKU"}),r.jsx("th",{style:u,children:"Nombre"}),r.jsx("th",{style:u,children:"Categora"}),r.jsx("th",{style:u,children:"Precio"}),r.jsx("th",{style:u,children:"Stock"}),r.jsx("th",{style:u,children:"Accin"})]})}),r.jsx("tbody",{children:o.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:d,children:r.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),r.jsx("td",{style:d,children:a[String(g.id)]?r.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?r.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),r.jsx("td",{style:d,children:r.jsx("code",{style:f,children:g.sku})}),r.jsx("td",{style:d,children:r.jsx("strong",{children:g.nombre})}),r.jsx("td",{style:d,children:r.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),r.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return r.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,_=v?p<1?"Agotado":"Sin precio":"Agregar";return r.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:_})})()})]},g.id))})]})})}function W0({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:f,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:_}){return r.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&r.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&r.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[r.jsx("span",{children:"Subtotal:"}),r.jsxs("span",{children:["L",u.toFixed(2)]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",color:"#16a34a",fontWeight:500},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsxs("div",{children:["ISV (",(f*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.isv||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto 18%: ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.imp18||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto turstico (",(p*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.tur||0),0)).toFixed(2)]})]})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[r.jsx("span",{children:"TOTAL:"}),r.jsxs("span",{children:["L",m.toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:[r.jsxs("div",{children:["Tax rates: ISV ",(f*100).toFixed(2),"%, 18% ",(g*100).toFixed(2),"%, Tur ",(p*100).toFixed(2),"%"]}),r.jsxs("details",{style:{marginTop:6},children:[r.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),r.jsx("div",{style:{marginTop:8},children:d.map(j=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[r.jsxs("div",{style:{color:"#0f172a"},children:[j.nombre,"  L",j.price.toFixed(2)]}),r.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",j.isv.toFixed(2),"  18%: L",j.imp18.toFixed(2),"  Tur: L",j.tur.toFixed(2)]})]},String(j.id)))})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[r.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),r.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?r.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):r.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(j=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",j.producto.sku,"] ",j.producto.nombre]}),r.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(j.producto.precio||0).toFixed(2)," c/u"]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("button",{onClick:()=>a(j.producto.id,-1),style:_,children:""}),r.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:j.cantidad}),r.jsx("button",{onClick:()=>a(j.producto.id,1),style:_,children:"+"}),r.jsx("button",{onClick:()=>s(j.producto.id),style:{..._,background:"#ef4444"},children:""})]})]},j.producto.id))})]})}function e_({userName:o,userRole:a,userId:s,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:f}){const[g,p]=S.useState(!1),m=S.useRef(null);return S.useEffect(()=>{function v(_){m.current&&!m.current.contains(_.target)&&p(!1)}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]),r.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[r.jsx("h1",{style:{margin:0,fontSize:"1.4rem",fontWeight:600},children:"Solutecc  -  Caja"}),r.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[r.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),r.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""}),s!=null&&r.jsxs("div",{style:{fontSize:"0.75rem",color:"#cbd5e1",marginTop:2},children:["ID: ",String(s)]})]}),r.jsxs("div",{style:{position:"relative"},ref:m,children:[r.jsx("button",{onClick:()=>p(v=>!v),"aria-expanded":g,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),g&&r.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[r.jsx("button",{onClick:()=>{p(!1),d()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),r.jsx("button",{onClick:()=>{p(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),r.jsx("button",{onClick:()=>{p(!1),f("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),r.jsx("button",{onClick:()=>{p(!1),f("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),r.jsx("button",{onClick:()=>{p(!1),f("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),r.jsx("button",{onClick:()=>{p(!1),f("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),r.jsx("button",{onClick:()=>{p(!1),f("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),r.jsx("button",{onClick:()=>{p(!1),f("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function t_({open:o,onClose:a,width:s=520,children:l,zIndex:u=9999}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:r.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:s,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})}):null}function n_({open:o,onClose:a,caiInfo:s,onRefresh:l}){const[u,d]=Tu.useState(!1);return r.jsx(t_,{open:o,onClose:a,width:520,children:r.jsxs("div",{children:[r.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),r.jsxs("div",{style:{color:"#475569",marginTop:8},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"CAI:"})," ",s?.cai??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Identificador:"})," ",s?.identificador??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango desde:"})," ",s?.rango_de??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango hasta:"})," ",s?.rango_hasta??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Fecha lmite emisin:"})," ",s?.fecha_vencimiento??s?.fecha_limite_emision??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Secuencia actual:"})," ",s?.secuencia_actual??"-"]})]}),r.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),r.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(f){console.debug("Error calling onRefresh from DatosFacturaModal:",f)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function a_({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),r.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?r.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):r.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),r.jsxs("div",{style:{flex:1},children:[r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"SKU:"})," ",a.sku]}),r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),r.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),r.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:r.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):r.jsx("div",{children:r.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function i_({open:o,onClose:a,onCancel:s,onSave:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),r.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function r_({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:f,taxRate:g,taxableSubtotal:p}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:"Elige si la factura ser para Cliente Final o para un Cliente registrado. Cliente Final genera una factura inmediata lista para imprimir. Cliente Normal permite ingresar datos del cliente."}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[r.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Factura para consumidor final. No requiere RTN."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar nombre y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar razn social y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]})]})]}),r.jsxs("div",{style:{width:220,borderLeft:"1px dashed #e6edf3",paddingLeft:16,display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontWeight:700},children:"Resumen"}),r.jsxs("div",{style:{color:"#475569"},children:["Items: ",r.jsx("strong",{children:d})]}),r.jsxs("div",{style:{color:"#475569"},children:["SubTotal: ",r.jsxs("strong",{children:["L ",f.toFixed(2)]})]}),r.jsxs("div",{style:{color:"#475569"},children:["ISV (",(g*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L ",(p*g).toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:18,fontWeight:800},children:["Total: L ",(f+p*g).toFixed(2)]}),r.jsx("div",{style:{marginTop:12,fontSize:12,color:"#94a3b8"},children:"Seleccione una opcin para continuar."})]})]})}):null}function s_({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:f,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:_,onTelefonoChange:j,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:N,onCancel:O,onOpenCreateCliente:T,onOpenPayment:I,paymentDone:M,submitClienteNormal:K}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{value:l,onChange:E=>v(E.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&r.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),r.jsx("input",{value:u,onChange:E=>_(E.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx(Q0,{open:p,onClose:()=>m(!1),onSelect:E=>{}}),r.jsx("button",{onClick:O,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:T,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),M?r.jsx("button",{onClick:K,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):r.jsx("button",{onClick:I,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function l_({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:f,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:_,onCreate:j}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",r.jsx("strong",{children:"juridico"}),"."]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),r.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),r.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),r.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),r.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{id:"exon",type:"checkbox",checked:f,onChange:b=>_(b.target.checked)}),r.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:async()=>{await j()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})}):null}function rp(o={},a="factura",s={}){const l=o.comercio||"Solutecc - Punto de Ventas",u=o.rtn||o.RTN||"C/F",d=o.direccion||"",f=o.telefono||"",g=o.email||o.EM||"",p=o.factura||String(Math.floor(Math.random()*9e5)+1e5),m=o.CAI||o.cai||"",v=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",j=o.rangoAutorizadoHasta||o.rango_hasta||"",b=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),w=o.identidad||o.rtnCliente||o.rtn||"C/F",N=new Date().toLocaleString(),O=Array.isArray(s.carrito)?s.carrito:[],T=typeof s.subtotal=="number"?s.subtotal:O.reduce((fe,A)=>fe+Number(A.producto&&A.producto.precio||A.precio||0)*(A.cantidad||1),0),I=typeof s.descuento=="number"?s.descuento:0,M=typeof s.exonerado=="number"?s.exonerado:0,K=typeof s.gravado=="number"?s.gravado:T,E=typeof s.exento=="number"?s.exento:0,q=typeof s.isvTotal=="number"?s.isvTotal:0,D=typeof s.imp18Total=="number"?s.imp18Total:0,V=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,ge=T+q+D+V,J=ge,ce=s.pagos||{},ye=typeof ce.efectivo=="number"?ce.efectivo:s.Efectivo||J,B=typeof ce.tarjeta=="number"?ce.tarjeta:s.Tarjeta||0,Z=typeof ce.transferencia=="number"?ce.transferencia:s.Transferencia||0,ie=typeof s.cambio=="number"?s.cambio:s.Cambio||0,z=O.map(fe=>{const A=String(fe.producto&&(fe.producto.nombre||fe.producto.descripcion)||fe.descripcion||fe.nombre||""),U=Number(fe.cantidad||0),$=Number((fe.producto&&(fe.producto.precio??fe.producto.precio_unitario))??fe.precio_unitario??fe.precio??0),F=$.toFixed(2),re=(U*$).toFixed(2);return`<tr><td>${fe.producto&&fe.producto.sku||fe.sku||""} ${A}</td><td style="text-align:center">${U}</td><td style="text-align:right">L ${F}</td><td style="text-align:right">L ${re}</td></tr>`}).join(`
`),X=o_(J);return`<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Factura</title>
	<style>
		@page { size: letter; margin: 0; }
		* { font-weight: bold !important; letter-spacing: 0 !important; word-spacing: 0 !important; margin: 0; padding: 0; line-height: 1 !important; }
		body { font-family: 'Arial', sans-serif; font-size: 10px; margin-top: 25px; margin:25px; padding: 0; color: #000; }
		.factura { width: 100%; margin: 0 auto; padding: 19px; box-sizing: border-box; max-width: 8.5in; }
		.titulo { font-size: 45px; color: #0066CC; text-align: center; }
		.factura-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 5px; }
		.factura-header img { width: 255px; height: 150px; margin:10px; }
		h3, p, h5 { font-size: 11px; margin: 0; padding: 0; }
		.tabla { width: 100%; border-collapse: collapse; margin-top: 3px; font-size: 10px; }
		.tabla th, .tabla td { border: 1px solid #000; padding: 2px; text-align: left; }
		.tabla th { background-color: gray; color: white; }
		.fecha, .right { text-align: right; }
		.totales { font-size: 10px; margin-top: 5px; }
		hr { border: none; border-top: 1px solid #000; margin: 3px 0; }
		.letr { font-size: 10px; text-align: center; }
		.firma { text-align: center; font-size: 10px; margin-top: 5px; }
		@media print { .tabla th { background-color: gray !important; color: white !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; } .factura { box-shadow: none; border-radius: 0; } .footer { display: none; } }
	</style>
</head>
<body>
	<div class="factura">
		<div class="factura-header">
			<img src="https://i.imgur.com/Tt5yzy0.jpeg" alt="Logo" />
			<h2 class="titulo">FACTURA</h2>
		</div>
		<hr />
		<h3>${l}</h3>
		<p>RTN: ${u}</p>
		<p>Direccin: ${d}</p>
		<p>Telfono: ${f}</p>
		<p>Email: ${g}</p>
		<hr />
		<p class="fecha">Fecha y hora: ${N}</p>
		<p>Factura No: ${p}</p>
		<p>CAI: ${m}</p>
		<p>Fecha lmite de emisin: ${v}</p>
		<p>Rango autorizado: ${_} al ${j}</p>
		<hr />
		<p>Cliente: ${b}</p>
		<p>RTN Cliente: ${w}</p>
		<hr />
		<table class="tabla">
			<thead>
				<tr>
					<th>Descripcin</th>
					<th>Cant</th>
					<th>Precio</th>
					<th>Total</th>
				</tr>
			</thead>
			<tbody>
				${z}
			</tbody>
		</table>
		<hr />
		<div class="totales">
			<p>Descuento: <span class="right">L ${I.toFixed(2)}</span></p>
			<p>Sub Total Exonerado: <span class="right">L ${Number(M).toFixed(2)}</span></p>
			<p>Sub Total Gravado: <span class="right">L ${Number(K).toFixed(2)}</span></p>
			<p>Sub Total Exento: <span class="right">L ${Number(E).toFixed(2)}</span></p>
			<p>Total Transaccin: <span class="right">L ${Number(ge).toFixed(2)}</span></p>
			 <p>Tasa Turistica 4%: <span class="right">L ${Number(V).toFixed(2)}</span></p>
			<p>ISV 15%: <span class="right">L ${Number(q).toFixed(2)}</span></p>
			<p>ISV 18%: <span class="right">L ${Number(D).toFixed(2)}</span></p>
			<hr />
			<p>Total Factura: <span class="right">L ${J.toFixed(2)}</span></p>
			<p>Efectivo: <span class="right">L ${Number(ye).toFixed(2)}</span></p>
			<p>Tarjeta: <span class="right">L ${Number(B).toFixed(2)}</span></p>
			<p>Transferencia: <span class="right">L ${Number(Z).toFixed(2)}</span></p>
			<p>Cambio: <span class="right">L ${Number(ie).toFixed(2)}</span></p>
		</div>
		<hr />
		<div class="letr">
			<p>Total Pagado: L ${J.toFixed(2)}</p>
			<p>*** ${X} Lempiras ***</p>
		</div>
		<hr />
		<div class="firma">
			<p>Firma del Cliente: ______________________</p>
			<p>Firma del Emisor: ______________________</p>
			<p>Original: Cliente</p>
			<p>Copia: Obligado tributario emisor</p>
			<h5>Para cualquier reclamo debe presentar su factura</h5>
			<h5>Gracias por su compra!</h5>
			<h5>LA FACTURA ES BENEFICIO DE TODOS EXJALA!</h5>
		</div>
	</div>
	<script>
		window.onload = function () {
			window.print();
			setTimeout(function () { window.close(); }, 1000);
		};
	<\/script>
</body>
</html>`}function o_(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const _=Math.floor(v/10),j=v%10;return s[_]+(j?" y "+a[j]:"")}if(v<1e3){const _=Math.floor(v/100),j=v%100;return(_===1&&j===0?"cien":l[_]||"")+(j?" "+u(j):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const f=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let _=u(v);m===2&&v===1&&(_="un"),f.unshift(_+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return f.join(" ").trim()}function c_({onLogout:o}){S.useEffect(()=>{const H=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=H||""}},[]);const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,f]=S.useState(""),[g,p]=S.useState("Todas"),[m,v]=S.useState(.15),[_,j]=S.useState(0),[b,w]=S.useState(0),N=["Todas",...Array.from(new Set(a.map(H=>H.categoria)))],O=a.filter(H=>(String(H.nombre||"").toLowerCase().includes(d.toLowerCase())||String(H.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||H.categoria===g)),T=l.reduce((H,te)=>H+Number(te.producto.precio||0)*te.cantidad,0);let I=0,M=0,K=0;for(const H of l){const te=Number(H.producto.precio||0)*H.cantidad,ve=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,be=!!H.producto.aplica_impuesto_turistico;if(!ve){if(oe){const _e=te*(_||0);M+=_e}else{const _e=te*(m||0);I+=_e}be&&(K+=te*(b||0))}}const E=T+I+M+K,q=l.map(H=>{const te=Number(H.producto.precio||0)*H.cantidad,ve=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,be=!!H.producto.aplica_impuesto_turistico;if(ve)return{id:H.producto.id,nombre:H.producto.nombre,price:te,isv:0,imp18:0,tur:0,totalTax:0};const _e=oe?0:te*(m||0),me=oe?te*(_||0):0,Te=be?te*(b||0):0;return{id:H.producto.id,nombre:H.producto.nombre,price:te,isv:_e,imp18:me,tur:Te,totalTax:_e+me+Te}}),D=H=>{const te=Number(H.stock??0),ve=Number(H.precio??0);te<1||ve<=0||u(oe=>oe.find(_e=>_e.producto.id===H.id)?oe.map(_e=>_e.producto.id===H.id?{..._e,cantidad:_e.cantidad+1}:_e):[...oe,{producto:H,cantidad:1}])},V=(H,te)=>{u(ve=>ve.map(oe=>{if(String(oe.producto.id)===String(H)){const be=oe.cantidad+te;return be>0?{...oe,cantidad:be}:oe}return oe}).filter(oe=>oe.cantidad>0))},ge=H=>{u(te=>te.filter(ve=>String(ve.producto.id)!==String(H)))},J=()=>u([]),[ce,ye]=S.useState(!1),[B,Z]=S.useState("factura"),[ie,C]=S.useState(!1),[z,X]=S.useState(null),[ue,fe]=S.useState(null),[A,U]=S.useState(!1),[$,F]=S.useState(!1),[re,ne]=S.useState(""),[pe,he]=S.useState(""),xe=S.useRef(null),ze=S.useRef(null),[Pe,Ue]=S.useState("final"),[De,Qe]=S.useState(""),[gt,qt]=S.useState(""),[Tt,Yt]=S.useState(!1),[Vn,st]=S.useState(!1),[ht,zn]=S.useState(!1),[Hl,Rt]=S.useState(!1),[Vl,hi]=S.useState(null),[os,Ma]=S.useState(!1),$l=async H=>{if(he(H),!H||String(H).trim()===""){ne("");return}try{if(Pe==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",H);const{data:be,error:_e}=await W.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",H).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:be,error:_e}),!_e&&be&&be.nombre){ne(be.nombre||""),Qe(be.telefono||""),qt(be.correo_electronico||""),Yt(!!be.exonerado),setTimeout(()=>{try{ze.current?.focus()}catch{}},50);return}else{ne(""),Qe(""),qt(""),Yt(!1);return}}const te="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",H);const{data:ve,error:oe}=await W.from(te).select("nombre").eq("rtn",H).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:ve,error:oe}),!oe&&ve&&ve.nombre?(ne(ve.nombre||""),setTimeout(()=>{try{ze.current?.focus()}catch{}},50)):ne("")}catch(te){console.warn("Error buscando cliente por RTN:",te)}},cs=H=>{if(H==="cotizacion"){Z("cotizacion"),ye(!0);return}Z(H),ye(!0)},Pl=async(H={})=>{try{if(!l||l.length===0)return null;const te=fi(),ve=I,oe=M,be=K,_e=Number(ve||0)+Number(oe||0)+Number(be||0),me=te+_e;let Te=H.cliente_id??null;if(!Te&&H.rtn)try{const{data:lt,error:ot}=await W.from("clientes").select("id").eq("rtn",H.rtn).maybeSingle();!ot&&lt&&lt.id&&(Te=lt.id)}catch{}const de=En||"system",le=String(Math.floor(Math.random()*9e5)+1e5),Re={cliente_id:Te,usuario:de,numero_cotizacion:le,validez_dias:30,subtotal:te,impuesto:_e,total:me,estado:"pendiente"};let Be=H.cotizacion_id??ue;if(Be){const lt={cliente_id:Re.cliente_id||null,usuario:Re.usuario,validez_dias:Re.validez_dias,subtotal:Re.subtotal,impuesto:Re.impuesto,total:Re.total,estado:Re.estado},{error:ot}=await W.from("cotizaciones").update(lt).eq("id",Be);if(ot)return console.warn("Error actualizando cotizacion:",ot),null}else{const{data:lt,error:ot}=await W.from("cotizaciones").insert([Re]).select("id").maybeSingle();if(ot)return console.warn("Error insertando cotizacion:",ot),null;if(Be=lt?.id||null,!Be)return null}const Ie=l.map(lt=>{const ot=Number(lt.producto.precio||0),ct=Number(lt.cantidad||0),$n=!!lt.producto.exento,Jt=!!lt.producto.aplica_impuesto_18,ca=!!lt.producto.aplica_impuesto_turistico,fn=$n||Jt?0:ot*(m||0)*ct,It=$n?0:Jt?ot*(_||0)*ct:0,ua=$n?0:ca?ot*(b||0)*ct:0,Mn=ot*ct,Oe=Mn+fn+It+ua;return{cotizacion_id:Be,producto_id:lt.producto.id||null,descripcion:lt.producto.nombre||"",cantidad:ct,precio_unitario:ot,subtotal:Mn,descuento:0,total:Oe}});try{await W.from("cotizaciones_detalle").delete().eq("cotizacion_id",Be)}catch{}const{error:Gt}=await W.from("cotizaciones_detalle").insert(Ie);return Gt?console.warn("Error insertando cotizaciones_detalle:",Gt):console.debug("Cotizacion guardada id=",Be),Be}catch(te){return console.warn("Error guardando cotizacion:",te),null}},fi=()=>l.reduce((H,te)=>H+Number(te.producto.precio||0)*te.cantidad,0),qa=()=>l.reduce((H,te)=>H+(te.producto.exento?0:Number(te.producto.precio||0)*te.cantidad),0),$t=async()=>{Ue("final"),ne("Consumidor Final"),he("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),Ma(!0),zn(!0),ye(!1)},Un=()=>{Ue("normal"),ne(""),he(""),Rt(!1),hi(null),U(!0),ye(!1)},Pt=()=>{Ue("juridico"),ne(""),he(""),Rt(!1),hi(null),U(!0),ye(!1)},Gl=async(H,te,ve)=>{const oe=rp({cliente:H,rtn:te},B,{carrito:l,subtotal:fi(),isvTotal:I,imp18Total:M,impTouristTotal:K});if(B==="factura"&&ue)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",ue);const{error:_e}=await W.from("cotizaciones").update({estado:"aceptada"}).eq("id",ue);if(_e)console.warn("Error marcando cotizacion (pre-print):",_e);else try{fe(null)}catch{}}catch(_e){console.warn("Error marcacion pre-print:",_e)}if(B==="factura")try{let _e=null,me=null;try{const Te=localStorage.getItem("user"),de=Te?JSON.parse(Te):null;me=de&&(de.id||de.user?.id||de.sub||de.user_id)?de.id||de.user?.id||de.sub||de.user_id:null;const le=de&&(de.username||de.user?.username||de.name||de.user?.name)?de.username||de.user?.username||de.name||de.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",Te),console.debug("PV: CAI lookup - parsed user object:",de),console.debug("PV: CAI lookup - extracted userId:",me,"typeof",typeof me),console.debug("PV: CAI lookup - extracted userNameFromStorage:",le),me){const Re=typeof me=="string"&&/^\d+$/.test(me)?Number(me):me;try{const{data:Be,error:Ie}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Re).order("id",{ascending:!1}).limit(1);!Ie&&Array.isArray(Be)&&Be.length>0&&(_e=Be[0])}catch(Be){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Be)}}if(!_e&&le)try{const{data:Re,error:Be}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",le).order("id",{ascending:!1}).limit(1);!Be&&Array.isArray(Re)&&Re.length>0&&(_e=Re[0])}catch(Re){console.debug("PV: CAI lookup by cajero failed:",Re)}}catch(Te){console.debug("No se pudo cargar CAI desde frontend:",Te)}await us({clienteName:H,rtn:te,paymentPayload:ve,caiData:_e,usuarioId:me})}catch(_e){console.warn("Error preparando venta antes de imprimir:",_e),alert("Error preparando venta antes de imprimir: "+String(_e))}const be=window.open("","_blank");if(be){be.document.open(),be.document.write(oe),be.document.close();try{be.focus(),be.print()}catch(_e){console.warn("Error during print (finalize):",_e)}setTimeout(()=>{try{be.close()}catch{}},800)}B==="factura"&&(J(),await ds()),B==="cotizacion"&&(X({cliente:H,rtn:te}),C(!0))},us=async({clienteName:H,rtn:te,paymentPayload:ve,caiData:oe,usuarioId:be})=>{if(!l||l.length===0)return null;const _e=ve&&ve.tipoPagoString?String(ve.tipoPagoString):"",me=ve&&ve.totalPaid?Number(ve.totalPaid||0):0,Te=me>Number(E||0)?me-Number(E||0):0;let de=String(Math.floor(Math.random()*9e5)+1e5);const le=Ha||oe||null;let Re=null,Be=0,Ie=null,Gt=null;if(le&&(le.rango_de!==void 0||le.secuencia_actual!==void 0))try{const Oe=le.rango_de!=null?String(le.rango_de):"",at=le.rango_hasta!=null?String(le.rango_hasta):"",vt=le.secuencia_actual!=null?String(le.secuencia_actual):"",qe=Number(String(Oe).replace(/[^0-9]/g,""))||0,He=Number(String(at).replace(/[^0-9]/g,""))||0,kt=Number(String(vt).replace(/[^0-9]/g,""))||qe||0;Be=Math.max((at||Oe||"").length,String(kt).length,1),Gt=String(kt).padStart(Be,"0"),de=(le.identificador?String(le.identificador):"")+Gt;const mi=kt+1;Re=mi,Ie=String(mi).padStart(Be,"0")}catch(Oe){console.debug("Error computing factura from caiInfoState, falling back to random:",Oe)}const lt={rtn:te||null,nombre_cliente:H||null,usuario:En||"system",factura:de,tipo_pago:_e,subtotal:Number(T||0),impuesto:Number(I+M+K||0),total:Number(E||0),estado:"pagada",cambio:String(Number(Te).toFixed(2)),cai:le?.cai??null,rango_desde:(le&&le.identificador?String(le.identificador):"")+(le?.rango_de!=null?String(le.rango_de):"")||null,rango_hasta:(le&&le.identificador?String(le.identificador):"")+(le?.rango_hasta!=null?String(le.rango_hasta):"")||null,fecha_limite_emision:le?.fecha_vencimiento??le?.fecha_limite_emision??null};let ot=null,ct=null;try{const Oe=await W.from("ventas").insert([lt]).select("id, factura");ot=Oe.data??Oe,ct=Oe.error??null}catch(Oe){ct=Oe}if(console.debug("Insert venta response:",{ventaInsRaw:ot,ventaErr:ct}),ct){const Oe=String(ct&&(ct.message||ct.msg||ct.details)||""),at=ct&&ct.code?String(ct.code):"";if(at==="PGRST204"||Oe.includes("Could not find the")||/column .* of 'ventas'/.test(Oe)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:Oe,code:at});const qe={...lt};delete qe.cai,delete qe.rango_desde,delete qe.rango_hasta,delete qe.fecha_limite_emision;try{const He=await W.from("ventas").insert([qe]).select("id, factura");if(ot=He.data??He,ct=He.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:ot,ventaErr:ct}),ct)throw ct}catch(He){throw console.error("Fallback insert also failed:",He),He}}else throw ct}const $n=Array.isArray(ot)?ot[0]:ot;let Jt=$n?$n.id||$n.id:null;if(!Jt)try{const{data:Oe,error:at}=await W.from("ventas").select("id").eq("factura",de).maybeSingle();at&&console.debug("Error buscando venta por factura (fallback):",at),Oe&&Oe.id&&(Jt=Oe.id)}catch(Oe){console.debug("fallback lookup error",Oe)}if(!Jt)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",ot),null;const ca=l.map(Oe=>{const at=Number(Oe.producto.precio||0),vt=Number(Oe.cantidad||0),qe=at*vt,He=0,kt=qe-He;return{venta_id:Jt,factura:de,producto_id:Oe.producto.id,cantidad:vt,precio_unitario:at,subtotal:qe,descuento:He,total:kt}});if(oe&&be&&(Oe=>typeof Oe=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Oe))(be))try{const Oe=l.map(qe=>({producto_id:String(qe.producto.id),cantidad:Number(qe.cantidad||0),precio_unitario:Number(qe.producto.precio||0),subtotal:Number((Number(qe.producto.precio||0)*qe.cantidad).toFixed(6)),descuento:0,total:Number((Number(qe.producto.precio||0)*qe.cantidad).toFixed(6))})),{data:at,error:vt}=await W.rpc("create_venta_with_detalle",{p_usuario_id:be,p_usuario:En||be,p_rtn:te||null,p_nombre_cliente:H||null,p_tipo_pago:_e,p_subtotal:Number(T||0),p_impuesto:Number(I+M+K||0),p_total:Number(E||0),p_cambio:String(Number(Te).toFixed(2)),p_detalles:Oe});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:at,rpcErr:vt}),vt)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",vt);else if(at&&Array.isArray(at)&&at.length>0){const qe=at[0];try{if(le&&le.id!=null)try{const{data:He,error:kt}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",le.id).maybeSingle();if(!kt&&He){Bn(He);try{localStorage.setItem("caiInfo",JSON.stringify(He))}catch{}}}catch(He){console.debug("Error refreshing cai after RPC:",He)}}catch(He){console.debug("Error during post-RPC cai refresh:",He)}return qe.venta_id||qe.venta_id===0?qe.venta_id:Jt}else if(at&&at.venta_id){try{if(le&&le.id!=null)try{const{data:qe,error:He}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",le.id).maybeSingle();if(!He&&qe){Bn(qe);try{localStorage.setItem("caiInfo",JSON.stringify(qe))}catch{}}}catch(qe){console.debug("Error refreshing cai after RPC (scalar):",qe)}}catch(qe){console.debug("Error during post-RPC cai refresh (scalar):",qe)}return at.venta_id}}catch(Oe){console.warn("Error calling RPC create_venta_with_detalle:",Oe)}else oe&&be&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",be);const{data:It,error:ua}=await W.from("ventas_detalle").insert(ca).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:It,detErr:ua}),ua)throw ua;const Mn=le&&(le.id||le.id===0)?le.id:null;if(Mn!=null&&Re!=null)try{const Oe=Ie??String(Re);try{const at=le?.rango_hasta!=null?String(le.rango_hasta):"",vt=Number(at.replace(/[^0-9]/g,""))||null,qe=Number(String(Oe).replace(/[^0-9]/g,""))||null;if(vt!=null&&qe!=null&&qe>vt)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:qe,rangoHastaNum:vt});else{const{error:He}=await W.from("cai").update({secuencia_actual:Oe}).eq("id",Mn);if(He)console.debug("Error updating cai.secuencia_actual (manual path):",He);else{console.debug("Updated cai.secuencia_actual to",Oe,"for cai id",Mn);try{const kt={...le||{},secuencia_actual:Oe};Bn(kt);try{localStorage.setItem("caiInfo",JSON.stringify(kt))}catch{}}catch(kt){console.debug("Error updating local caiInfoState/localStorage:",kt)}}}}catch(at){console.debug("Validation error while checking rango_hasta:",at);const{error:vt}=await W.from("cai").update({secuencia_actual:Oe}).eq("id",Mn);if(vt)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",vt);else{console.debug("Updated cai.secuencia_actual to",Oe,"for cai id",Mn);try{const qe={...le||{},secuencia_actual:Oe};Bn(qe);try{localStorage.setItem("caiInfo",JSON.stringify(qe))}catch{}}catch(qe){console.debug("Error updating local caiInfoState/localStorage (after validation):",qe)}}}}catch(Oe){console.debug("Exception updating cai.secuencia_actual:",Oe)}return Jt},ds=async()=>{if(B==="factura"&&ue)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",ue);const{error:H}=await W.from("cotizaciones").update({estado:"aceptada"}).eq("id",ue);H?console.warn("Error marcando cotizacion como facturado:",H):console.debug("Cotizacion marcada como facturado:",ue)}catch(H){console.warn("Error procesando cotizacion tras facturar",H)}};S.useEffect(()=>{A&&setTimeout(()=>{try{xe.current?.focus()}catch{}},80)},[A]);const gi=async()=>{try{if(pe&&re){const oe={rtn:pe,nombre:re},{error:be}=await W.from("clientenatural").upsert(oe,{onConflict:"rtn"});be&&console.warn("Error guardando clientenatural:",be)}}catch(oe){console.warn("Error upsert clientenatural:",oe)}try{if(pe&&re)if(Pe==="juridico"){const{data:oe,error:be}=await W.from("clientes").select("id").eq("rtn",pe).eq("tipo_cliente","juridico").maybeSingle();if(be&&console.warn("Error buscando cliente juridico:",be),oe&&oe.id){const{error:_e}=await W.from("clientes").update({nombre:re,telefono:De||null,correo_electronico:gt||null,exonerado:Tt}).eq("id",oe.id);_e&&console.warn("Error actualizando cliente juridico:",_e)}else{const{error:_e}=await W.from("clientes").insert([{nombre:re,rtn:pe,telefono:De||null,correo_electronico:gt||null,tipo_cliente:"juridico",exonerado:Tt}]);_e&&console.warn("Error insertando cliente juridico:",_e)}}else{const oe={rtn:pe,nombre:re},{error:be}=await W.from("clientenatural").upsert(oe,{onConflict:"rtn"});be&&console.warn("Error guardando clientenatural:",be)}}catch(oe){console.warn("Error upsert cliente:",oe)}const H=rp({cliente:re||"Cliente",rtn:pe||""},B,{carrito:l,subtotal:fi(),isvTotal:I,imp18Total:M,impTouristTotal:K});if(B==="factura"&&ue)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",ue);const{error:oe}=await W.from("cotizaciones").update({estado:"aceptada"}).eq("id",ue);if(oe)console.warn("Error marcando cotizacion como facturado (pre-print):",oe);else{console.debug("Cotizacion marcada como facturado (pre-print):",ue);try{fe(null)}catch{}}}catch(oe){console.warn("Error marcacion pre-print:",oe)}if(B==="factura")try{let oe=null,be=null;try{const _e=localStorage.getItem("user"),me=_e?JSON.parse(_e):null;be=me&&(me.id||me.user?.id||me.sub||me.user_id)?me.id||me.user?.id||me.sub||me.user_id:null;const Te=me&&(me.username||me.user?.username||me.name||me.user?.name)?me.username||me.user?.username||me.name||me.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",_e),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",me),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",be,"typeof",typeof be),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",Te),be){const de=typeof be=="string"&&/^\d+$/.test(be)?Number(be):be;try{const{data:le,error:Re}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",de).order("id",{ascending:!1}).limit(1);!Re&&Array.isArray(le)&&le.length>0&&(oe=le[0])}catch(le){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",le)}}if(!oe&&Te)try{const{data:de,error:le}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",Te).order("id",{ascending:!1}).limit(1);!le&&Array.isArray(de)&&de.length>0&&(oe=de[0])}catch(de){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",de)}}catch(_e){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",_e)}await us({clienteName:re||"Cliente",rtn:pe||null,paymentPayload:Vl,caiData:oe,usuarioId:be})}catch(oe){console.warn("Error insertando venta en flujo cliente normal:",oe)}const te=window.open("","_blank");if(te){te.document.open(),te.document.write(H),te.document.close();try{te.focus(),te.print()}catch(oe){console.warn("Error during print (cliente normal):",oe)}setTimeout(()=>{try{te.close()}catch{}},800)}await(async()=>{B==="factura"&&(J(),await ds()),B==="cotizacion"&&(X({cliente:re||"Cliente",rtn:pe||null}),C(!0))})(),U(!1)},[dn,hn]=S.useState(null),[Dn,pi]=S.useState([]),[La,lr]=S.useState(!1),[hs,Ia]=S.useState(null);S.useEffect(()=>{fetch("/data-base/inventario.json").then(async H=>{if(!H.ok)return console.warn("inventario.json no disponible, status",H.status),null;const te=H.headers.get("content-type")||"";if(!te.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",te),null;try{return await H.json()}catch(ve){return console.warn("Error parseando inventario.json:",ve),null}}).then(H=>{H&&Array.isArray(H.items)&&pi(H.items),console.log("inventario cargado:",H&&H.items?H.items.length:0)}).catch(H=>{console.warn("Error cargando inventario:",H)})},[]),S.useEffect(()=>{let H=!0;return(async()=>{try{const{data:te,error:ve}=await W.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(ve)throw ve;const oe=Array.isArray(te)?te:[],be=oe.map(de=>String(de.id));if(be.length===0){H&&s([]);return}const _e={};try{const{data:de,error:le}=await W.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(le)throw le;if(console.debug("PV: precios total rows",Array.isArray(de)?de.length:0),Array.isArray(de))for(const Re of de){const Be=String(Re.producto_id);_e[Be]||(_e[Be]=Number(Re.precio||0))}}catch(de){console.warn("Error cargando precios en PV:",de)}let me={};try{const{data:de,error:le}=await W.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",be);if(le)throw le;const Re=Array.isArray(de)?de:[];me={},be.forEach(Be=>me[Be]=0);for(const Be of Re){const Ie=String(Be.producto_id),Gt=Number(Be.cantidad)||0,lt=String(Be.tipo_de_movimiento||"").toUpperCase();lt==="ENTRADA"?me[Ie]=(me[Ie]||0)+Gt:lt==="SALIDA"&&(me[Ie]=(me[Ie]||0)-Gt)}}catch(de){console.warn("Error cargando registro_de_inventario en PV:",de),me={},be.forEach(le=>me[le]=0)}console.debug("PV: priceMap sample",Object.keys(_e).slice(0,5).map(de=>[de,_e[de]]));const Te=oe.map(de=>({id:String(de.id),sku:de.sku,nombre:de.nombre,categoria:de.categoria,imagen:de.imagen,precio:_e[String(de.id)]!==void 0?_e[String(de.id)]:de.precio!==void 0?Number(de.precio):0,exento:de.exento===!0||String(de.exento)==="true"||Number(de.exento)===1||!1,aplica_impuesto_18:de.aplica_impuesto_18===!0||String(de.aplica_impuesto_18)==="true"||Number(de.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:de.aplica_impuesto_turistico===!0||String(de.aplica_impuesto_turistico)==="true"||Number(de.aplica_impuesto_turistico)===1||!1,stock:Number((me[String(de.id)]||0).toFixed(2))}));H&&s(Te)}catch(te){console.warn("Error cargando productos desde inventario:",te),H&&s([])}})(),()=>{H=!1}},[]),S.useEffect(()=>{const H=ve=>{try{const oe=ve||(()=>{const me=localStorage.getItem("cotizacion_to_load");return me?JSON.parse(me):null})();if(!oe)return;try{fe(oe.header&&oe.header.id?String(oe.header.id):null)}catch{}const _e=(Array.isArray(oe.detalles)?oe.detalles:[]).map(me=>{const Te=a.find(le=>String(le.id)===String(me.producto_id));return{producto:Te?{...Te}:{id:String(me.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:me.sku??void 0,nombre:me.descripcion||me.nombre||"Artculo",precio:Number(me.precio_unitario||me.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(me.cantidad||1)}});_e.length>0&&u(_e);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};H();const te=ve=>{try{H(ve.detail)}catch{}};return window.addEventListener("cotizacion:load",te),()=>{window.removeEventListener("cotizacion:load",te)}},[a]);const[En,Kl]=S.useState(null),[fs,gs]=S.useState(null),[or,cr]=S.useState(null),[Ha,Bn]=S.useState(null),[ps,Cn]=S.useState(!1),[xt,Lt]=S.useState({}),oa=async()=>{try{let H=null;try{const te=localStorage.getItem("user"),ve=te?JSON.parse(te):null;let oe=or??(ve&&(ve.id||ve.user?.id||ve.sub||ve.user_id)?ve.id||ve.user?.id||ve.sub||ve.user_id:null);const be=En??(ve&&(ve.username||ve.user?.username||ve.name||ve.user?.name)?ve.username||ve.user?.username||ve.name||ve.user?.name:null),_e=oe!=null&&typeof oe=="string"&&/^\d+$/.test(oe)?Number(oe):oe;if(_e!=null)try{const{data:me,error:Te}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",_e).order("id",{ascending:!1}).limit(1);!Te&&Array.isArray(me)&&me.length>0&&(H=me[0])}catch(me){console.debug("refreshCaiInfo: lookup by usuario_id failed:",me)}if(!H&&be)try{const{data:me,error:Te}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",be).order("id",{ascending:!1}).limit(1);!Te&&Array.isArray(me)&&me.length>0&&(H=me[0])}catch(me){console.debug("refreshCaiInfo: lookup by cajero failed:",me)}}catch(te){console.debug("refreshCaiInfo: error building lookup params",te)}if(H){Bn(H);try{localStorage.setItem("caiInfo",JSON.stringify(H))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",H)}}catch(H){console.debug("refreshCaiInfo: unexpected error",H)}};S.useEffect(()=>{try{const H=localStorage.getItem("user");if(H){const te=JSON.parse(H);Kl(te.username||te.name||null),gs(te.role||null);let ve=null;try{ve=te&&(te.id||te.user?.id||te.sub||te.user_id)?te.id||te.user?.id||te.sub||te.user_id:null,cr(ve??null),console.debug("PV: localStorage.user parsed:",te),console.debug("PV: extracted userId for CAI/RPC usage:",ve)}catch(oe){console.debug("PV: error parsing localStorage.user for debug:",oe)}try{const oe=localStorage.getItem("caiInfo");if(oe){const be=JSON.parse(oe);Bn(be),console.debug("PV: loaded caiInfo from localStorage:",be),(async()=>{try{if(!(be&&be.rango_de!==void 0&&be.rango_hasta!==void 0&&be.fecha_vencimiento!==void 0&&be.secuencia_actual!==void 0)){const me=te&&(te.username||te.user?.username||te.name||te.user?.name)?te.username||te.user?.username||te.name||te.user?.name:null,Te=ve&&typeof ve=="string"&&/^\d+$/.test(ve)?Number(ve):ve;let de=null;try{if(Te!=null){const{data:le,error:Re}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Te).order("id",{ascending:!1}).limit(1);!Re&&Array.isArray(le)&&le.length>0&&(de=le[0])}}catch(le){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",le)}if(!de&&me)try{const{data:le,error:Re}=await W.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",me).order("id",{ascending:!1}).limit(1);!Re&&Array.isArray(le)&&le.length>0&&(de=le[0])}catch(le){console.debug("PV: refetch CAI by cajero failed:",le)}if(de){Bn(de);try{localStorage.setItem("caiInfo",JSON.stringify(de))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",de)}}}catch(_e){console.debug("PV: error trying to refresh caiInfo:",_e)}})()}}catch(oe){console.debug("PV: error parsing localStorage.caiInfo:",oe)}}}catch{}},[]),S.useEffect(()=>{let H=!0;return(async()=>{try{const{data:te,error:ve}=await W.from("impuesto").select("id, impuesto_venta");if(ve)throw ve;if(!te||!Array.isArray(te))return;const oe=Te=>{const de=te.find(Be=>Number(Be.id)===Te);if(!de)return null;const le=de.impuesto_venta;if(le==null)return null;const Re=Number(le);return Number.isNaN(Re)?null:Re>1?Re/100:Re},be=oe(1),_e=oe(2),me=oe(3);if(H){let Te=be,de=_e,le=me;try{if((Te===null||Te===0)&&H){const Be=(await W.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Ie=Be==null?null:Number(Be);Ie!=null&&!Number.isNaN(Ie)&&(Te=Ie>1?Ie/100:Ie)}if((de===null||de===0)&&H){const Be=(await W.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Ie=Be==null?null:Number(Be);Ie!=null&&!Number.isNaN(Ie)&&(de=Ie>1?Ie/100:Ie)}if((le===null||le===0)&&H){const Be=(await W.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Ie=Be==null?null:Number(Be);Ie!=null&&!Number.isNaN(Ie)&&(le=Ie>1?Ie/100:Ie)}}catch(Re){console.warn("PV: fallback single-id impuesto fetch failed",Re)}(Te===null||Te===0)&&(Te=.15),(de===null||de===0)&&(de=.18),(le===null||le===0)&&(le=.04),v(Te),j(de),w(le),console.debug("PV: impuestos raw rows",te),console.debug("PV: resolved tax rates",{taxRate:Te,tax18Rate:de,taxTouristRate:le})}}catch(te){console.warn("Error cargando impuesto en PV:",te)}})(),()=>{H=!1}},[]);const ur=H=>{console.log("openUbicacion",H,"entradasCount",Dn.length);let te=null;try{te=a.find(oe=>String(oe.sku||"")===String(H)||String(oe.id)===String(H))||null}catch{te=null}if(te){const oe=Number(te.stock??0),be={id:te.id,producto:te.nombre||"",sku:te.sku||"",imagen:te.imagen||null,descripcion:te.descripcion||"",ubicacion:te.ubicacion||null,cantidad:oe};Ia(be),lr(!0);return}const ve=Dn.find(oe=>oe.sku===H)||null;console.log("entrada encontrada",ve),Ia(ve),lr(!0)};if(S.useEffect(()=>{let H=!0;return(async()=>{try{const te="inventario",ve={};await Promise.all((a||[]).map(async oe=>{const be=oe.imagen;if(!be){ve[String(oe.id)]=null;return}const _e=String(be);if(_e.startsWith("http")){ve[String(oe.id)]=_e;return}let me=_e;const Te=String(_e).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);Te&&(me=decodeURIComponent(Te[2]));try{const de=await W.storage.from(te).getPublicUrl(me),le=de?.data?.publicUrl||de?.data?.publicURL||null;if(le){ve[String(oe.id)]=le;return}}catch{}try{const le=(await W.storage.from(te).createSignedUrl(me,604800))?.data?.signedUrl??null;ve[String(oe.id)]=le}catch{ve[String(oe.id)]=null}})),H&&Lt(ve)}catch(te){console.warn("Error resolviendo imgenes en PV",te)}})(),()=>{H=!1}},[a]),dn){if(dn==="DevolucionCaja")return r.jsx(P0,{onBack:()=>hn(null)});if(dn==="IngresoEfectivo")return r.jsx(G0,{onBack:()=>hn(null)});if(dn==="CotizacionesGuardadas")return r.jsx(K0,{onBack:()=>hn(null)});if(dn==="PedidosEnLinea")return r.jsx(Y0,{onBack:()=>hn(null)});if(dn==="CorteCajaParcial")return r.jsx(J0,{onBack:()=>hn(null)});if(dn==="CorteCajaTotal")return r.jsx(F0,{onBack:()=>hn(null)})}return r.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[r.jsx(e_,{userName:En,userRole:fs,userId:or,caiInfo:Ha,onLogout:o,onNavigate:H=>hn(H),onOpenDatosFactura:()=>Cn(!0)}),r.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[r.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:H=>f(H.target.value),onKeyDown:H=>{if(H.key==="Enter"){const te=String(d||"").trim().toLowerCase();if(!te)return;const oe=O.find(be=>String(be.sku||"").toLowerCase()===te)||O[0];if(oe){const be=Number(oe.stock??0),_e=Number(oe.precio??0);be>=1&&_e>0?D(oe):console.debug("No se puede agregar por stock/precio",{id:oe.id,stockNum:be,precioNum:_e})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),r.jsx("select",{value:g,onChange:H=>p(H.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:N.map(H=>r.jsx("option",{value:H,children:H},H))})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:r.jsx(Z0,{productos:O,imageUrls:xt,agregarAlCarrito:D,openUbicacion:ur,thStyle:u_,tdStyle:d_,skuStyle:h_})}),r.jsx(W0,{carrito:l,actualizarCantidad:V,eliminarDelCarrito:ge,vaciarCarrito:J,subtotal:T,perItemTaxes:q,taxRate:m,tax18Rate:_,taxTouristRate:b,total:E,openSelector:cs,btnStyle:f_})]})]}),r.jsx(a_,{open:La,selectedEntrada:hs,onClose:()=>{lr(!1),Ia(null)},imageUrls:xt}),r.jsx(X0,{open:ht,totalDue:E,onClose:()=>zn(!1),onConfirm:async H=>{if(hi(H),Rt(!0),os)try{Ma(!1),await Gl("Consumidor Final","C/F",H)}catch(te){console.warn("Error facturando despus del pago:",te)}zn(!1)}}),r.jsx(i_,{open:ie,onClose:()=>C(!1),onCancel:()=>{C(!1),X(null)},onSave:async()=>{C(!1);try{const H=await Pl(z||{});H&&fe(String(H))}catch(H){console.warn("Error guardando cotizacion desde confirm modal",H)}X(null)}}),r.jsx(r_,{open:ce,onClose:()=>ye(!1),doFacturaClienteFinal:$t,doFacturaClienteNormal:Un,doFacturaClienteJuridico:Pt,carritoLength:l.length,subtotal:fi(),taxRate:m,taxableSubtotal:qa()}),r.jsx(s_,{open:A,onClose:()=>U(!1),clienteTipo:Pe,clienteRTN:pe,clienteNombre:re,clienteTelefono:De,clienteCorreo:gt,clienteExonerado:Tt,clienteSearchOpen:$,setClienteSearchOpen:H=>F(H),onRTNChange:H=>$l(H),onNombreChange:H=>ne(H),onTelefonoChange:H=>Qe(H),onCorreoChange:H=>qt(H),onExoneradoChange:H=>Yt(H),onCreateCliente:()=>st(!0),onCancel:()=>U(!1),onOpenCreateCliente:()=>st(!0),onOpenPayment:()=>zn(!0),paymentDone:Hl,submitClienteNormal:gi}),r.jsx(l_,{open:Vn,onClose:()=>st(!1),clienteRTN:pe,clienteNombre:re,clienteTelefono:De,clienteCorreo:gt,clienteExonerado:Tt,onChangeRTN:H=>he(H),onChangeNombre:H=>ne(H),onChangeTelefono:H=>Qe(H),onChangeCorreo:H=>qt(H),onChangeExonerado:H=>Yt(H),onCreate:async()=>{try{if(!re||!pe)return;const{data:H,error:te}=await W.from("clientes").select("id").eq("rtn",pe).maybeSingle();if(te&&console.warn("Error buscando cliente al crear:",te),H&&H.id){const{error:ve}=await W.from("clientes").update({nombre:re,telefono:De||null,correo_electronica:gt||null,tipo_cliente:"juridico",exonerado:Tt}).eq("id",H.id);ve&&console.warn("Error actualizando cliente al crear:",ve)}else{const{error:ve}=await W.from("clientes").insert([{nombre:re,rtn:pe,telefono:De||null,correo_electronica:gt||null,tipo_cliente:"juridico",exonerado:Tt}]);ve&&console.warn("Error insertando cliente al crear:",ve)}}catch(H){console.warn("Error creando cliente juridico:",H)}st(!1)}}),r.jsx(n_,{open:ps,onClose:()=>Cn(!1),caiInfo:Ha,onRefresh:oa})]})}const u_={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},d_={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},h_={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},f_={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},sp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function g_({title:o,children:a}){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:o}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function p_(){const[o,a]=S.useState(null);return S.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Ventas (ltimos das)"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Flujo de caja"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Inventario por categora"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Promedios"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):r.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const m_="modulepreload",y_=function(o){return"/"+o},lp={},wn=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(_=>Promise.resolve(_).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};var f=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=y_(v),v in lp)return;lp[v]=!0;const _=v.endsWith(".css"),j=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${j}`))return;const b=document.createElement("link");if(b.rel=_?"stylesheet":m_,_||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),_)return new Promise((w,N)=>{b.addEventListener("load",w),b.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function am({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:f="Cancelar"}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),r.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:f}),r.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function v_(){const[o,a]=S.useState(null),[s,l]=S.useState(!1),[u,d]=S.useState(!1),[f,g]=S.useState({}),[p,m]=S.useState(null),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,N]=S.useState(!1),[O,T]=S.useState(null),[I,M]=S.useState(null),[K,E]=S.useState(!1),[q,D]=S.useState(""),[V,ge]=S.useState(""),[J,ce]=S.useState(null),[ye,B]=S.useState(null);S.useEffect(()=>{let U=!0;return(async()=>{l(!0);try{const $=(await wn(async()=>{const{default:ne}=await Promise.resolve().then(()=>Sn);return{default:ne}},void 0)).default,{data:F,error:re}=await $.from("empresa").select("*").limit(1).single();if(!U)return;if(re)throw re;if(F){a(F),g(F);try{localStorage.setItem("companyData",JSON.stringify(F))}catch{}l(!1);return}}catch($){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",$)}try{const $=localStorage.getItem("companyData");if($){a(JSON.parse($)),g(JSON.parse($)),l(!1);return}}catch{}try{const $=await fetch("/data-base/company.json");if(!$.ok)throw new Error("no json");const F=await $.json();if(!U)return;a(F),g(F)}catch{U&&a(null)}finally{U&&l(!1)}})(),()=>{U=!1}},[]),S.useEffect(()=>{o&&g(o)},[o]),S.useEffect(()=>{try{const U=localStorage.getItem("pendingCompanySave");if(U){const $=JSON.parse(U);_(!0),b($.payload??null),N(!!$.needsLogo)}}catch{}},[]),S.useEffect(()=>{let U=!0;return(async()=>{try{if(!o||!o.logo){U&&ce(null);return}const $=String(o.logo);if($.startsWith("http")){U&&ce($);return}const F=(await wn(async()=>{const{default:ze}=await Promise.resolve().then(()=>Sn);return{default:ze}},void 0)).default,re="logo",pe=(await F.storage.from(re).getPublicUrl($))?.data?.publicUrl??null;if(pe){U&&ce(pe);return}const xe=(await F.storage.from(re).createSignedUrl($,3600))?.data?.signedUrl??null;if(xe){U&&ce(xe);return}U&&ce(null)}catch($){console.warn("Error resolving company logo URL",$),U&&ce(null)}})(),()=>{U=!1}},[o?.logo]),S.useEffect(()=>{let U=!0;return(async()=>{try{if(p){U&&B(p);return}const $=f?.logo;if(!$){U&&B(null);return}const F=String($);if(F.startsWith("http")){U&&B(F);return}const re=(await wn(async()=>{const{default:Pe}=await Promise.resolve().then(()=>Sn);return{default:Pe}},void 0)).default,ne="logo",he=(await re.storage.from(ne).getPublicUrl(F))?.data?.publicUrl??null;if(he){U&&B(he);return}const ze=(await re.storage.from(ne).createSignedUrl(F,3600))?.data?.signedUrl??null;if(ze){U&&B(ze);return}U&&B(null)}catch($){console.warn("Error resolving edit logo URL",$),U&&B(null)}})(),()=>{U=!1}},[f?.logo,p]);function Z(){d(!0),g(o||{})}function ie(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function C(U){const{name:$,value:F}=U.target;g(re=>({...re,[$]:F}))}function z(U){const $=U.target.files?.[0]??null;if(g(F=>({...F,logoFile:$})),$)try{const F=URL.createObjectURL($);m(F)}catch{m(null)}else m(null)}function X(U=!1){const $="logo",F="https://sqwqlvsjtimallidxrsz.supabase.co";if(U){if(p)return p;const pe=f?.logo;if(!pe)return"/logo192.png";if(String(pe).startsWith("http"))return String(pe);let he=String(pe);return he.startsWith(`${$}/`)&&(he=he.slice($.length+1)),`${F}/storage/v1/object/public/${$}/${encodeURIComponent(he)}`}if(!o)return"/logo192.png";const re=o.logo;if(!re)return"/logo192.png";if(String(re).startsWith("http"))return String(re);let ne=String(re);return ne.startsWith(`${$}/`)&&(ne=ne.slice($.length+1)),`${F}/storage/v1/object/public/${$}/${encodeURIComponent(ne)}`}async function ue(){try{const U=(await wn(async()=>{const{default:he}=await Promise.resolve().then(()=>Sn);return{default:he}},void 0)).default,$={...f||{}};let F=null;const re=he=>{if(!he)return null;if(!he.startsWith("http"))return he;const xe=he.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return xe?decodeURIComponent(xe[2]):null},ne=o?.logo??null;try{const he=f&&f.logoFile instanceof File?f.logoFile:null,xe="logo";if(he){const Pe=`logo/${$.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${he.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,Ue=await U.storage.from(xe).upload(Pe,he,{upsert:!0});if(Ue.error)throw Ue.error;const De=Ue.data?.path??Pe;F=De,$.logo=De}}catch(he){console.warn("Logo upload error",he)}try{$.logoFile&&delete $.logoFile}catch{}let pe=null;try{if(o&&o.id){const{data:he,error:xe}=await U.from("empresa").update($).eq("id",o.id).select("*");if(xe)throw xe;pe=Array.isArray(he)?he[0]??null:he}else{const{data:he,error:xe}=await U.from("empresa").insert($).select("*");if(xe)throw xe;pe=Array.isArray(he)?he[0]??null:he}try{if(F){const he=re(ne);if(he&&he!==F){const ze=await U.storage.from("logo").remove([he]);ze.error&&console.warn("Failed to remove old company logo after DB update",ze.error)}}}catch(he){console.warn("Error removing old logo after DB success",he)}}catch(he){try{if(F){const ze=await U.storage.from("logo").remove([F]);ze.error&&console.warn("Failed to remove uploaded logo after DB error",ze.error)}}catch(xe){console.warn("Error cleaning uploaded logo after DB failure",xe)}throw he}a(pe),g(pe);try{console.debug("Empresa guardada, logo field:",pe?.logo)}catch{}try{M(pe?.logo??null)}catch{}try{D("Datos guardados"),ge("Los datos de la empresa se guardaron correctamente."),E(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(pe))}catch{}d(!1)}catch(U){console.error("Error guardando empresa en Supabase",U);try{T(U?.message||String(U))}catch{}try{const $={...f||{}};$.logoFile&&delete $.logoFile;const F=!!(f&&f.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:$,needsLogo:F,ts:Date.now()})),_(!0),b($),N(F),a(f);try{localStorage.setItem("companyData",JSON.stringify(f))}catch{}d(!1),D("Guardado localmente"),ge("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),E(!0)}catch($){console.error("Error saving locally",$)}}}async function fe(){const U=j;if(!U){D("Sin pendientes"),ge("No hay datos pendientes para enviar"),E(!0);return}try{const $=(await wn(async()=>{const{default:re}=await Promise.resolve().then(()=>Sn);return{default:re}},void 0)).default;let F=null;if(U.id){const{data:re,error:ne}=await $.from("empresa").update(U).eq("id",U.id).select("*");if(ne)throw ne;F=Array.isArray(re)?re[0]??null:re}else{const{data:re,error:ne}=await $.from("empresa").insert(U).select("*");if(ne)throw ne;F=Array.isArray(re)?re[0]??null:re}localStorage.removeItem("pendingCompanySave"),_(!1),b(null),N(!1),a(F),g(F),D("Sincronizado"),ge("Los datos pendientes se sincronizaron con Supabase correctamente."),E(!0)}catch($){console.error("Error reenviando datos pendientes",$),D("Error al reenviar"),ge("No se pudo reenviar los datos a Supabase: "+($?.message||String($))),E(!0)}}function A(){try{localStorage.removeItem("pendingCompanySave"),_(!1),b(null),N(!1),D("Pendiente descartado"),ge("El guardado pendiente fue descartado."),E(!0)}catch{}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?r.jsx("div",{children:"Cargando datos de la empresa..."}):o?r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?r.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",O?r.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(O)]}):null,w?r.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn-primary",onClick:fe,children:"Reintentar guardar en Supabase"}),r.jsx("button",{className:"btn-opaque",onClick:A,children:"Descartar pendiente"})]})]})}):null,I?r.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[r.jsx("strong",{children:"Logo guardado:"}),r.jsxs("div",{style:{marginTop:6},children:[r.jsx("a",{href:X(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),r.jsx("div",{style:{color:"#374151",fontSize:12},children:String(I)})]})]}):null,r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:r.jsx("img",{src:u?ye??X(!0):J??X(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),r.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"RTN:"})," ",u?r.jsx("input",{name:"rtn",value:f.rtn||"",onChange:C,className:"input"}):o.rtn]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Telfono:"})," ",u?r.jsx("input",{name:"telefono",value:f.telefono||"",onChange:C,className:"input"}):o.telefono]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Correo:"})," ",u?r.jsx("input",{name:"email",value:f.email||"",onChange:C,className:"input"}):o.email]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Direccin:"})," ",u?r.jsx("textarea",{name:"direccion",value:f.direccion||"",onChange:C,className:"input",style:{minHeight:64}}):o.direccion]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Logo (archivo o URL):"}),u?r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[r.jsx("input",{type:"file",accept:"image/*",onChange:z}),r.jsx("input",{name:"logo",value:f.logo||"",onChange:C,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):r.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?r.jsxs("div",{style:{marginTop:8},children:[r.jsx("small",{children:"Preview:"}),r.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:ue,className:"btn-primary",children:"Guardar"}),r.jsx("button",{type:"button",onClick:ie,className:"btn-opaque",children:"Cancelar"})]}):r.jsx(r.Fragment,{children:r.jsx("button",{type:"button",onClick:Z,className:"btn-primary",children:"Actualizar datos"})})})]}),r.jsx("div",{style:{flex:1,minWidth:320},children:r.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:r.jsx("img",{src:u?ye??X(!0):J??X(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),r.jsxs("p",{style:{margin:0},children:["RTN: ",r.jsx("strong",{children:o.rtn})]}),r.jsxs("p",{style:{margin:0},children:["Telfono: ",r.jsx("strong",{children:o.telefono})]}),r.jsxs("p",{style:{marginTop:8},children:["Correo: ",r.jsx("strong",{children:o.email})]}),r.jsxs("p",{style:{marginTop:8},children:["Direccin: ",r.jsx("strong",{children:o.direccion})]})]})})]}):r.jsx("div",{children:"No se encontraron datos de la empresa."}),r.jsx(am,{open:K,title:q,message:V,onClose:()=>E(!1)})]})}function b_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function __(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[j,b]=S.useState(""),[w,N]=S.useState(null),[O,T]=S.useState(""),[I,M]=S.useState(""),[K,E]=S.useState("");async function q(){l(!0),d(null);try{const{data:B,error:Z}=await W.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(Z)throw Z;a(Array.isArray(B)?B:[])}catch(B){d(B?.message||String(B)),a([])}finally{l(!1)}}async function D(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const B={username:p,password:v,role:"cajero"};j&&(B.nombre_usuario=j);const{error:Z}=await W.from("users").insert(B);if(Z)throw Z;m(""),_(""),b(""),await q()}catch(B){d(B?.message||String(B))}finally{l(!1)}}function V(B){N(B.id),T(B.username||""),E(B.nombre_usuario||""),M(""),d(null)}function ge(){N(null),T(""),M(""),E(""),d(null)}async function J(){if(w!=null){if(!O)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const B={username:O};I&&(B.password=I),B.nombre_usuario=K||null;const{error:Z}=await W.from("users").update(B).eq("id",w);if(Z)throw Z;ge(),await q()}catch(B){d(B?.message||String(B))}finally{l(!1)}}}async function ce(B,Z){if(Z!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:ie}=await W.from("users").delete().eq("id",B);if(ie)throw ie;await q()}catch(ie){d(ie?.message||String(ie))}finally{l(!1)}}}S.useEffect(()=>{let B=!0;return(async()=>B&&await q())(),()=>{B=!1}},[]);const ye=o.filter(B=>{if(!f)return!0;const Z=f.toLowerCase();return(B.username||"").toLowerCase().includes(Z)||(String(B.id)||"").includes(Z)||(B.role||"").toLowerCase().includes(Z)||(B.nombre_usuario||"").toLowerCase().includes(Z)});return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[r.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:f,onChange:B=>g(B.target.value),style:{minWidth:220}}),r.jsx("button",{onClick:()=>q(),className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${ye.length} usuarios`}),r.jsx("div",{style:{width:"100%",height:8}}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:B=>m(B.target.value)}),r.jsx("input",{placeholder:"Nombre",className:"input",value:j,onChange:B=>b(B.target.value)}),r.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:B=>_(B.target.value)}),r.jsx("button",{onClick:()=>D(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?r.jsx("div",{style:{color:"red",marginBottom:12},children:u}):r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"})]})}),r.jsx("tbody",{children:ye.map(B=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:B.id}),r.jsx("td",{style:{minWidth:180},children:w===B.id?r.jsx("input",{className:"input",value:O,onChange:Z=>T(Z.target.value)}):B.username||"-"}),r.jsx("td",{style:{minWidth:180},children:w===B.id?r.jsx("input",{className:"input",value:K,onChange:Z=>E(Z.target.value)}):B.nombre_usuario||"-"}),r.jsx("td",{style:{width:220},children:w===B.id?r.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:I,onChange:Z=>M(Z.target.value)}):B.role||"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:w===B.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>J(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),r.jsx("button",{onClick:()=>ge(),className:"btn-opaque",children:"Cancelar"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>V(B),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),B.role==="cajero"?r.jsx("button",{onClick:()=>ce(B.id,B.role),className:"btn-danger",children:"Eliminar"}):r.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},B.id))})]}),ye.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function x_({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:f}){const[g,p]=S.useState(null),[m,v]=S.useState(null),[_,j]=S.useState(!1),[b,w]=S.useState(null),[N,O]=S.useState(""),[T,I]=S.useState(""),[M,K]=S.useState(""),[E,q]=S.useState(""),[D,V]=S.useState(null),[ge,J]=S.useState(""),[ce,ye]=S.useState(!1),[B,Z]=S.useState(null);if(S.useEffect(()=>{if(!o||!s)return;w(s.caja??null),O(s.cai??""),J(s.identificador??""),I(s.rango_de??""),K(s.rango_hasta??""),q(s.fecha_vencimiento??""),V(s.secuencia_actual??null);const C=s.cajero??null;if(C){const z=l.find(X=>X.username===C||X.nombre_usuario===C);z?(p(z.id),v(null),j(!1)):(p(null),v(C),j(!0))}else p(null),v(null),j(!1);Z(null)},[o,s,l]),!o||!s)return null;async function ie(){if(!s){Z("Registro invlido");return}if(b!=null&&(b<1||b>5)){Z("La caja debe estar entre 1 y 5");return}ye(!0),Z(null);try{const C={cai:N??null,identificador:ge??null,rango_de:T??null,rango_hasta:M??null,fecha_vencimiento:E??null,secuencia_actual:D??null,caja:b??null};if(g!=null){const z=l.find(X=>X.id===g);C.cajero=z?z.username:null,C.usuario_id=z?z.id:null}else C.cajero=m??null,C.usuario_id=null;await f(s.id,C),a()}catch(C){Z(C?.message||String(C))}finally{ye(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:N,onChange:C=>O(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),r.jsx("input",{className:"input",value:ge,onChange:C=>J(C.target.value),placeholder:"Identificador (opcional)"}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:T,onChange:C=>I(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:M,onChange:C=>K(C.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:E,onChange:C=>q(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),r.jsx("input",{className:"input",value:D??"",onChange:C=>V(C.target.value===""?null:C.target.value),placeholder:"0"}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):_?"__custom__":"",onChange:C=>{const z=C.target.value;z===""?(p(null),v(null),j(!1)):z==="__custom__"?(p(null),j(!0)):/^\d+$/.test(z)&&(p(Number(z)),v(null),j(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(C=>r.jsxs("option",{value:String(C.id),children:[C.username,C.nombre_usuario?`  ${C.nombre_usuario}`:""]},C.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),_&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:C=>{v(C.target.value),p(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:C=>w(C.target.value===""?null:Number(C.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(C=>r.jsx("option",{value:C,children:C},C))]})]})]})]})]}),B&&r.jsx("div",{style:{color:"red",marginTop:12},children:B}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:ce,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ie,disabled:ce,style:{width:"auto",padding:"8px 14px"},children:ce?"Guardando...":"Guardar"})]})]})})}function j_({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[f,g]=S.useState(null),[p,m]=S.useState(null),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,N]=S.useState(""),[O,T]=S.useState(""),[I,M]=S.useState(""),[K,E]=S.useState(""),[q,D]=S.useState(null),[V,ge]=S.useState(""),[J,ce]=S.useState(!1),[ye,B]=S.useState(null);if(!o)return null;async function Z(){const ie=[];if(w||ie.push("CAI"),O||ie.push("Rango Desde"),I||ie.push("Rango Hasta"),K||ie.push("Fecha de Vencimiento"),j==null&&ie.push("Caja"),f==null&&!p&&ie.push("Cajero"),ie.length>0){B(`Campos obligatorios faltantes: ${ie.join(", ")}`);return}if(j!=null&&(j<1||j>5)){B("La caja debe estar entre 1 y 5");return}ce(!0),B(null);try{const C={cai:w??null,identificador:V??null,rango_de:O??null,rango_hasta:I??null,fecha_vencimiento:K??null,secuencia_actual:q??null,caja:j??null};if(f!=null){const z=s.find(X=>X.id===f);C.cajero=z?z.username:null,C.usuario_id=z?z.id:null}else C.cajero=p??null,C.usuario_id=null;await d(C),a()}catch(C){B(C?.message||String(C))}finally{ce(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:w,onChange:ie=>N(ie.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),r.jsx("input",{className:"input",value:V,onChange:ie=>ge(ie.target.value),placeholder:"Identificador (opcional)"}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:O,onChange:ie=>T(ie.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:I,onChange:ie=>M(ie.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:K,onChange:ie=>E(ie.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),r.jsx("input",{className:"input",value:q??"",onChange:ie=>D(ie.target.value===""?null:ie.target.value),placeholder:"0"}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:f!=null?String(f):v?"__custom__":"",onChange:ie=>{const C=ie.target.value;C===""?(g(null),m(null),_(!1)):C==="__custom__"?(g(null),_(!0)):/^\d+$/.test(C)&&(g(Number(C)),m(null),_(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(ie=>r.jsxs("option",{value:String(ie.id),children:[ie.username,ie.nombre_usuario?`  ${ie.nombre_usuario}`:""]},ie.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:ie=>{m(ie.target.value),g(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:j??"",onChange:ie=>b(ie.target.value===""?null:Number(ie.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(ie=>r.jsx("option",{value:ie,children:ie},ie))]})]})]})]})]}),ye&&r.jsx("div",{style:{color:"red",marginTop:12},children:ye}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:J,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:Z,disabled:J,style:{width:"auto",padding:"8px 14px"},children:J?"Creando...":"Crear"})]})]})})}function S_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState([]),[p,m]=S.useState(null),[v,_]=S.useState(!1),[j,b]=S.useState(!1);async function w(){l(!0),d(null);try{const{data:E,error:q}=await W.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(q)throw q;a(Array.isArray(E)?E:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}async function N(){try{const{data:E}=await W.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),N()},[]);const O=new Set(o.filter(E=>E.cajero).map(E=>String(E.cajero))),T=new Set(o.filter(E=>E.caja!=null).map(E=>Number(E.caja)));function I(E){m(E),_(!0),d(null)}function M(){_(!1),m(null)}async function K(E,q){l(!0),d(null);try{const{error:D}=await W.from("cai").update(q).eq("id",E);if(D)throw D;await w()}catch(D){throw d(D?.message||String(D)),D}finally{l(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"CAI"}),r.jsx("th",{children:"Identificador"}),r.jsx("th",{children:"Rango Desde"}),r.jsx("th",{children:"Rango Hasta"}),r.jsx("th",{children:"Vencimiento"}),r.jsx("th",{children:"Secuencia actual"}),r.jsx("th",{children:"Cajero"}),r.jsx("th",{children:"Usuario ID"}),r.jsx("th",{children:"Caja"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:200},children:E.cai}),r.jsx("td",{style:{minWidth:160},children:E.identificador??"-"}),r.jsx("td",{children:E.rango_de}),r.jsx("td",{children:E.rango_hasta}),r.jsx("td",{children:E.fecha_vencimiento}),r.jsx("td",{children:E.secuencia_actual??"-"}),r.jsx("td",{style:{minWidth:180},children:E.cajero||"-"}),r.jsx("td",{style:{minWidth:160},children:E.usuario_id??"-"}),r.jsx("td",{style:{width:120},children:E.caja??"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>I(E),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},E.id))})]}),o.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),r.jsx(x_,{open:v,onClose:M,row:p,cajeros:f,availableCajeros:p?f.filter(E=>!O.has(E.username)||E.username===p.cajero):f.filter(E=>!O.has(E.username)),availableCajas:p?[1,2,3,4,5].filter(E=>!T.has(E)||E===p.caja):[1,2,3,4,5].filter(E=>!T.has(E)),onSave:K}),r.jsx(j_,{open:j,onClose:()=>b(!1),cajeros:f,availableCajeros:f.filter(E=>!O.has(E.username)),availableCajas:[1,2,3,4,5].filter(E=>!T.has(E)),onCreate:async E=>{l(!0),d(null);try{const{error:q}=await W.from("cai").insert(E);if(q)throw q;await w(),b(!1)}catch(q){throw d(q?.message||String(q)),q}finally{l(!1)}}})]})}function w_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function E_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),r.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Mu=cp();function C_({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,f]=Tu.useState(!1);if(!o)return null;const g=async()=>{try{f(!0),await u()}finally{f(!1)}};return Mu.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("p",{children:s}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),r.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function T_({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[f,g]=S.useState({}),[p,m]=S.useState(!1),[v,_]=S.useState(null);if(S.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?_(l.imagen):_(null)},[l,o]),!o)return null;const j=(O,T)=>{g(I=>({...I,[O]:T}))},b=async O=>{O.preventDefault();try{m(!0),await d(f)}finally{m(!1)}},w=O=>O==="creado_en"?null:O==="id"?r.jsx("input",{className:"input",value:f[O]??"",readOnly:!0}):O.includes("publicacion")||O.includes("exento")||O.includes("aplica_impuesto")||O==="publicacion_web"?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("label",{className:"switch",children:[r.jsx("input",{type:"checkbox",checked:!!f[O],onChange:T=>j(O,T.target.checked)}),r.jsx("span",{className:"slider"})]}),r.jsx("span",{style:{fontSize:13},children:f[O]?"S":"No"})]}):O.includes("categoria")||O.includes("marca")?r.jsx("input",{type:"text",className:"input",value:f[O]??"",onChange:T=>j(O,T.target.value===""?null:T.target.value)}):O==="imagen"?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?r.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,r.jsx("input",{type:"file",accept:"image/*",onChange:T=>{const I=T.target.files&&T.target.files[0];if(j(O,I??null),I)try{const M=URL.createObjectURL(I);_(M)}catch{_(null)}else _(null)}}),v?r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{j(O,null),_(null)},children:"Eliminar imagen"}):null]}):r.jsx("input",{className:"input",value:f[O]??"",onChange:T=>j(O,T.target.value)}),N=r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsxs("form",{onSubmit:b,children:[r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(O=>r.jsxs("label",{style:{display:"block"},children:[r.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(O).replace(/_/g," ").toUpperCase()}),w(O)]},O))}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Mu.createPortal(N,typeof document<"u"&&document.body||document.createElement("div"))}function A_({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const f=a||{},[g,p]=S.useState(null),[m,v]=S.useState(null),[_,j]=S.useState(null),[b,w]=S.useState(null);return S.useEffect(()=>{let N=!0;return(async()=>{const T=typeof f.imagen=="string"?f.imagen:null;if(!T){N&&p(null);return}if(T.startsWith("http")){N&&(p(T),j(T));return}let I=T;const M=String(T).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);M&&(I=decodeURIComponent(M[2]));const K="inventario";try{const E=(await wn(async()=>{const{default:J}=await Promise.resolve().then(()=>Sn);return{default:J}},void 0)).default,q=await E.storage.from(K).getPublicUrl(I),D=q?.data?.publicUrl||q?.data?.publicURL||null;if(D){N&&(p(D),j(D));return}const V=await E.storage.from(K).createSignedUrl(I,3600*24*7);if(V.error){console.warn("ProductDetailModal createSignedUrl error",V.error),N&&p(null);return}const ge=V.data?.signedUrl??null;N&&(p(ge),j(ge))}catch(E){console.error("ProductDetailModal resolve error",E),N&&p(null)}})(),()=>{N=!1}},[f]),S.useEffect(()=>{let N=!0;return(async()=>{if(w(null),!!_)try{const T=await fetch(_,{method:"HEAD"});if(!N)return;w(`HEAD ${T.status} ${T.statusText} - content-type: ${T.headers.get("content-type")}`)}catch(T){if(!N)return;w(`FETCH_ERROR: ${String(T)}`)}})(),()=>{N=!1}},[_]),Mu.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:s}),r.jsxs("div",{style:{display:"flex",gap:18},children:[r.jsx("div",{style:{flex:1},children:r.jsx("table",{style:{width:"100%"},children:r.jsx("tbody",{children:Object.keys(f).map(N=>{const O=f[N];return N==="imagen"&&typeof O=="string"?null:r.jsxs("tr",{children:[r.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(N).replace(/_/g," ").toUpperCase()}),r.jsx("td",{style:{padding:6},children:String(O??"-")})]},N)})})})}),r.jsx("div",{style:{width:280,textAlign:"center"},children:g?r.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:N=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?r.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),r.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):r.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(f),children:"Editar"}),r.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(f.id),children:"Eliminar"}),r.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function N_({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:f,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:_=[]}){const[j,b]=S.useState(null),[w,N]=S.useState(!1),[O,T]=S.useState(null),[I,M]=S.useState(""),[K,E]=S.useState(!1),[q,D]=S.useState("add"),[V,ge]=S.useState({}),[J,ce]=S.useState(!1),[ye,B]=S.useState(null),[Z,ie]=S.useState(!1),[C,z]=S.useState(null),X=S.useRef(!0),ue=async()=>{N(!0),T(null);try{const ne=(await wn(async()=>{const{default:ze}=await Promise.resolve().then(()=>Sn);return{default:ze}},void 0)).default,pe=a||"*";let he=ne.from(o).select(pe).limit(l);f&&(Array.isArray(f)?f:String(f).split(",").map(Pe=>Pe.trim()).filter(Boolean)).forEach(Pe=>{const Ue=Pe.split(" ").map(gt=>gt.trim()).filter(Boolean),De=Ue[0],Qe=Ue[1]?Ue[1].toLowerCase():"asc";he=he.order(De,{ascending:Qe!=="desc"})}),g&&Object.entries(g).forEach(([ze,Pe])=>{Pe==null||Pe===""||(he=he.eq(ze,Pe))});const xe=await he;if(console.debug("SupabaseTable fetch result for",o,xe),!X.current)return;if(xe.error)throw xe.error;b(Array.isArray(xe.data)?xe.data:[])}catch(ne){console.error("SupabaseTable error",ne),T(ne?.message||String(ne)),b([])}finally{X.current&&N(!1)}};S.useEffect(()=>(X.current=!0,ue(),()=>{X.current=!1}),[o,a,l]);const fe=S.useMemo(()=>u&&u.length>0?u:!j||j.length===0?[]:Object.keys(j[0]),[u,j]),A=S.useMemo(()=>{if(!j)return null;const ne=(I||"").toString().trim().toLowerCase();if(!ne)return j;const pe=d&&d.length>0?d:fe;return j.filter(he=>pe.some(xe=>{const ze=he?.[xe];return ze==null?!1:String(ze).toLowerCase().includes(ne)}))},[j,I,d,fe]),U=()=>{p&&(D("add"),ge({}),E(!0))},$=ne=>{m&&(D("edit"),ge(ne),E(!0))},F=async ne=>{const pe=(await wn(async()=>{const{default:he}=await Promise.resolve().then(()=>Sn);return{default:he}},void 0)).default;try{const he="inventario",xe={...ne},ze=q==="edit"?V?.imagen??null:null,Pe=Ue=>{if(!Ue)return null;if(!Ue.startsWith("http"))return Ue;const De=Ue.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return De?decodeURIComponent(De[2]):null};if(xe.imagen&&xe.imagen instanceof File){const Ue=xe.imagen,De=xe.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Qe=`${o}/${De}/${Date.now()}_${Ue.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,gt=await pe.storage.from(he).upload(Qe,Ue,{upsert:!0});if(gt.error)throw gt.error;const qt=gt.data?.path??Qe;xe.imagen=qt;try{const Tt=Pe(ze);if(Tt&&Tt!==qt){const Yt=await pe.storage.from(he).remove([Tt]);Yt.error&&console.warn("Failed to remove old image",Yt.error)}}catch(Tt){console.warn("Error removing old image",Tt)}}if(q==="edit"&&(xe.imagen==null||xe.imagen===""))try{const Ue=Pe(V?.imagen??null);if(Ue){const De=await pe.storage.from(he).remove([Ue]);De.error&&console.warn("Failed to remove old image on clear",De.error)}}catch(Ue){console.warn("Error removing old image on clear",Ue)}if(q==="add"){const{error:Ue}=await pe.from(o).insert([xe]);if(Ue)throw Ue}else{const Ue=xe.id,De={...xe};delete De.id;const{error:Qe}=await pe.from(o).update(De).eq("id",Ue);if(Qe)throw Qe}E(!1),await ue()}catch(he){console.error("Error saving",he),T(he?.message||String(he))}},re=async()=>{if(ye==null)return;const ne=(await wn(async()=>{const{default:pe}=await Promise.resolve().then(()=>Sn);return{default:pe}},void 0)).default;try{if(!v)return;try{const he="inventario",xe=j?.find(De=>De.id===ye),ze=De=>{if(!De)return null;if(!De.startsWith("http"))return De;const Qe=De.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Qe?decodeURIComponent(Qe[2]):null},Pe=xe?.imagen??null,Ue=ze(Pe);if(Ue){const De=await ne.storage.from(he).remove([Ue]);De.error&&console.warn("Failed to remove image on delete",De.error)}}catch(he){console.warn("Error removing image before delete",he)}const{error:pe}=await ne.from(o).delete().eq("id",ye);if(pe)throw pe;ce(!1),B(null),await ue()}catch(pe){console.error("Error deleting",pe),T(pe?.message||String(pe))}};return r.jsxs("div",{style:{padding:18},children:[s?r.jsx("h2",{style:{marginTop:0},children:s}):null,r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("input",{placeholder:"Buscar...",value:I,onChange:ne=>M(ne.target.value),className:"input",style:{minWidth:240}}),r.jsx("button",{onClick:()=>{T(null),M(""),ue()},className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto"},children:r.jsx("button",{onClick:U,className:"btn-primary",children:"Agregar"})})]}),w&&r.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),O&&r.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",O]}),!w&&j&&j.length===0&&r.jsxs("div",{children:["No hay registros en la tabla ",r.jsx("strong",{children:o}),"."]}),!w&&A&&A.length>0&&r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[fe.map(ne=>r.jsx("th",{children:String(ne).replace(/_/g," ").toUpperCase()},ne)),r.jsx("th",{style:{width:140},children:"Acciones"})]})}),r.jsx("tbody",{children:A.map((ne,pe)=>r.jsxs("tr",{children:[fe.map(he=>{if(he==="imagen"){const xe=ne?.imagen??null;return xe||console.debug("SupabaseTable: row has no imagen for id",ne?.id,ne),r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:xe?r.jsx(im,{src:String(xe)}):r.jsx("span",{style:{color:"#6b7280"},children:"-"})},he)}return r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:O_(ne[he])},he)}),r.jsx("td",{className:"admin-actions",children:r.jsx("button",{className:"btn-opaque",onClick:()=>{z(ne),ie(!0)},children:"Ver"})})]},ne.id??pe))})]})}),r.jsx(T_,{open:K,title:q==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:fe.filter(ne=>!_.includes(ne)),initialData:V,onClose:()=>E(!1),onSave:F}),r.jsx(A_,{open:Z,data:C,title:`Detalle de ${o}`,onClose:()=>ie(!1),onEdit:ne=>{ie(!1),$(ne)},onDeleteClick:ne=>{ie(!1),B(ne),ce(!0)}}),r.jsx(C_,{open:J,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>ce(!1),onConfirm:re})]})}function O_(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return r.jsx(im,{src:o})}return String(o)}function im({src:o}){const[a,s]=S.useState(null),[l,u]=S.useState(null);return S.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await wn(async()=>{const{default:N}=await Promise.resolve().then(()=>Sn);return{default:N}},void 0)).default,v="inventario",_=await m.storage.from(v).getPublicUrl(g),j=_?.data?.publicUrl||_?.data?.publicURL||null;if(j){d&&s(j);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const w=b.data?.signedUrl??null;d&&s(w)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?r.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:r.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function R_(){const[o,a]=S.useState(null),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState([]);return S.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await wn(async()=>{const{default:D}=await Promise.resolve().then(()=>Sn);return{default:D}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],N=new Set(w.map(D=>D.categoria??"").filter(Boolean)),O=new Set(w.map(D=>D.marca??"").filter(Boolean)),T=w.length,I=w.filter(D=>!!D.publicacion_web).length,M=D=>{if(D==null)return!1;if(typeof D=="boolean")return D===!0;if(typeof D=="number")return D===1;const V=String(D).toLowerCase().trim();return V==="1"||V==="true"||V==="t"||V==="si"||V==="s"||V==="yes"},K=w.filter(D=>M(D.exento)).length,E=w.filter(D=>M(D.aplica_impuesto_18)).length,q=w.filter(D=>M(D.aplica_impuesto_turistico)).length;a({categorias:N.size,marcas:O.size,items:T,publicadas:I,exentos:K,aplica_impuesto_18:E,aplica_impuesto_turistico:q}),g(Array.from(N).sort()),m(Array.from(O).sort())}catch(j){console.error("Error loading inventario summary",j)}})(),()=>{v=!1}},[]),r.jsxs("div",{children:[r.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[r.jsx(si,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),r.jsx(si,{label:"Marcas",value:o?String(o.marcas):"..."}),r.jsx(si,{label:"Items",value:o?String(o.items):"..."}),r.jsx(si,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),r.jsx(si,{label:"Exentos",value:o?String(o.exentos):"..."}),r.jsx(si,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),r.jsx(si,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),r.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),f.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),r.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),p.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),r.jsx(N_,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function si({label:o,value:a}){return r.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),r.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function k_({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,f]=S.useState(null),[g,p]=S.useState(""),[m,v]=S.useState(!1),[_,j]=S.useState(null),[b,w]=S.useState(null),[N,O]=S.useState(null),[T,I]=S.useState(null),[M,K]=S.useState(null),[E,q]=S.useState(null),[D,V]=S.useState(null),[ge,J]=S.useState(null),[ce,ye]=S.useState(null),[B,Z]=S.useState(!1);S.useEffect(()=>{o&&(f(null),p(""),w(null),O(null),I(null),J(null),ye(null),j(null))},[o]);async function ie(){const z=[];if(d||z.push("Producto"),g||z.push("Precio"),z.length>0){j(`Faltan campos: ${z.join(", ")}`);return}const X=Number(g);if(isNaN(X)||X<0){j("Precio invlido");return}v(!0),j(null);try{await u({producto_id:d,precio:g});try{const ue={};if(M!==null&&(ue.exento=M),E!==null&&(ue.aplica_impuesto_18=E),D!==null&&(ue.aplica_impuesto_turistico=D),Object.keys(ue).length>0){const{error:fe}=await W.from("inventario").update(ue).eq("id",d);fe&&console.warn("Error actualizando inventario flags:",fe)}}catch(ue){console.warn("Error al persistir flags en inventario:",ue)}a()}catch(ue){j(ue?.message||String(ue))}finally{v(!1)}}function C(z){return z?Number(z.replace(",",".")):NaN}return S.useEffect(()=>{let z=!0;async function X(){if(w(null),O(null),I(null),J(null),ye(null),!d)return;const ue=C(g);if(!isNaN(ue)){Z(!0);try{const{data:fe,error:A}=await W.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(A)throw A;const U=Array.isArray(fe)?fe.map(st=>Number(st.costo_unitario)).filter(st=>!isNaN(st)):[],$=U.length>0?U.reduce((st,ht)=>st+ht,0)/U.length:0;if(!z)return;w($);let F=!1,re=!1,ne=!1;try{const{data:st,error:ht}=await W.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!ht&&st&&(F=!!st.exento,re=!!st.aplica_impuesto_18,ne=!!st.aplica_impuesto_turistico,M===null&&K(F),E===null&&q(re),D===null&&V(ne))}catch{}const{data:pe}=await W.from("impuesto").select("id, impuesto_venta"),he={};Array.isArray(pe)&&pe.forEach(st=>{he[String(st.id)]=Number(st.impuesto_venta)});const xe=M!==null?M:F,ze=E!==null?E:re,Pe=D!==null?D:ne;let Ue=0;xe?Ue=0:ze?Ue=he[2]??he[1]??0:Ue=he[1]??0;let De=0;Pe&&(De=he[3]??0);const Qe=(Ue||0)+(De||0),gt=Qe>1?Qe/100:Qe,qt=ue*gt;O(Qe),I(qt);const Tt=ue-$,Yt=$>0?Tt/$*100:null;J(Yt);const Vn=ue>0?(ue-$-qt)/ue*100:null;ye(Vn)}catch{}finally{z&&Z(!1)}}}return X(),()=>{z=!1}},[d,g,M,E,D]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:d??"",onChange:z=>f(z.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(z=>r.jsx("option",{value:z.id,children:z.nombre},z.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!M,onChange:z=>K(z.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!E,onChange:z=>q(z.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!D,onChange:z=>V(z.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:g,onChange:z=>p(z.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:T==null?"":T.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:ge==null?"":ge.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:ce==null?"":ce.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&r.jsx("div",{style:{color:"red",marginTop:12},children:_}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ie,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function z_({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[f,g]=S.useState(null),[p,m]=S.useState(""),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,N]=S.useState(null),[O,T]=S.useState(null),[I,M]=S.useState(null),[K,E]=S.useState(null),[q,D]=S.useState(null),[V,ge]=S.useState(null),[J,ce]=S.useState(null),[ye,B]=S.useState(null),[Z,ie]=S.useState(!1);S.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const X=Number(s.precio);m(isNaN(X)?String(s.precio):X.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function C(X){return X?Number(X.replace(",",".")):NaN}if(S.useEffect(()=>{let X=!0;async function ue(){if(N(null),T(null),M(null),ce(null),B(null),!o||!s||!f)return;const fe=C(p);if(!isNaN(fe)){ie(!0);try{const{data:A,error:U}=await W.from("compras_detalle").select("costo_unitario").eq("producto_id",f);if(U)throw U;const $=Array.isArray(A)?A.map(ht=>Number(ht.costo_unitario)).filter(ht=>!isNaN(ht)):[],F=$.length>0?$.reduce((ht,zn)=>ht+zn,0)/$.length:0;if(!X)return;N(F);let re=!1,ne=!1,pe=!1;try{const{data:ht,error:zn}=await W.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",f).single();!zn&&ht&&(re=!!ht.exento,ne=!!ht.aplica_impuesto_18,pe=!!ht.aplica_impuesto_turistico,K===null&&E(re),q===null&&D(ne),V===null&&ge(pe))}catch{}const{data:he}=await W.from("impuesto").select("id, impuesto_venta"),xe={};Array.isArray(he)&&he.forEach(ht=>xe[String(ht.id)]=Number(ht.impuesto_venta));const ze=K!==null?K:re,Pe=q!==null?q:ne,Ue=V!==null?V:pe;let De=0;ze?De=0:Pe?De=xe[2]??xe[1]??0:De=xe[1]??0;let Qe=0;Ue&&(Qe=xe[3]??0);const gt=(De||0)+(Qe||0),qt=gt>1?gt/100:gt,Tt=fe*qt;T(gt),M(Tt);const Yt=fe-F,Vn=F>0?Yt/F*100:null;ce(Vn);const st=fe>0?(fe-F-Tt)/fe*100:null;B(st)}catch{}finally{X&&ie(!1)}}}return ue(),()=>{X=!1}},[o,s,f,p,K,q,V]),!o||!s)return null;async function z(){const X=[];if(f||X.push("Producto"),p||X.push("Precio"),X.length>0){b(`Faltan campos: ${X.join(", ")}`);return}const ue=Number(p);if(isNaN(ue)||ue<0){b("Precio invlido");return}_(!0),b(null);try{const fe=s.id;await d(fe,{producto_id:f,precio:p});try{const A={};if(K!==null&&(A.exento=K),q!==null&&(A.aplica_impuesto_18=q),V!==null&&(A.aplica_impuesto_turistico=V),Object.keys(A).length>0&&f){const{error:U}=await W.from("inventario").update(A).eq("id",f);U&&console.warn("Error actualizando inventario flags:",U)}}catch(A){console.warn("Error al persistir flags en inventario:",A)}a()}catch(fe){b(fe?.message||String(fe))}finally{_(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:f??"",onChange:X=>g(X.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(X=>r.jsx("option",{value:X.id,children:X.nombre},X.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!K,onChange:X=>E(X.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!q,onChange:X=>D(X.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!V,onChange:X=>ge(X.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:p,onChange:X=>m(X.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:I==null?"":I.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:J==null?"":J.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:ye==null?"":ye.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),j&&r.jsx("div",{style:{color:"red",marginTop:12},children:j}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:z,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function U_(){const[o,a]=S.useState([]),[s,l]=S.useState([]),[u,d]=S.useState(!1),[f,g]=S.useState(null),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[j,b]=S.useState(null);async function w(){d(!0),g(null);try{const{data:E,error:q}=await W.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(q)throw q;a(Array.isArray(E)?E:[])}catch(E){g(E?.message||String(E)),a([])}finally{d(!1)}}async function N(){try{const{data:E}=await W.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),N()},[]);const O=new Set(o.map(E=>String(E.producto_id))),T=s.filter(E=>!O.has(E.id));function I(E){b(E),_(!0),g(null)}async function M(E){d(!0),g(null);try{const{error:q}=await W.from("precios").insert(E);if(q)throw q;try{const D={producto_id:E.producto_id,precio:E.precio},{error:V}=await W.from("precios_historico").insert(D);V&&console.warn("No se pudo insertar en precios_historico",V)}catch(D){console.warn("Error registrando precios_historico",D)}await w()}catch(q){throw g(q?.message||String(q)),q}finally{d(!1)}}async function K(E,q){d(!0),g(null);try{const{error:D}=await W.from("precios").update(q).eq("id",E);if(D)throw D;let V=q.producto_id,ge=q.precio;if(!V||ge===void 0)try{const{data:J}=await W.from("precios").select("producto_id, precio").eq("id",E).limit(1).single();J&&(V=V||J.producto_id,ge=ge===void 0?J.precio:ge)}catch{}try{if(V&&ge!==void 0){const J={producto_id:V,precio:ge},{error:ce}=await W.from("precios_historico").insert(J);ce&&console.warn("No se pudo insertar en precios_historico",ce)}}catch(J){console.warn("Error registrando precios_historico",J)}await w()}catch(D){throw g(D?.message||String(D)),D}finally{d(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{w(),N()},children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),f&&r.jsx("div",{style:{color:"red",marginBottom:12},children:f}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:220},children:s.find(q=>q.id===E.producto_id)?.nombre||E.producto_id}),r.jsx("td",{children:E.precio}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>I(E),children:"Editar"})})]},E.id))})]})}),r.jsx(k_,{open:p,onClose:()=>m(!1),products:T,onCreate:async E=>{await M(E),m(!1)}}),r.jsx(z_,{open:v,onClose:()=>{_(!1),b(null)},row:j,products:s,availableProducts:[...s.filter(E=>!O.has(E.id)),...j?s.filter(E=>E.id===j.producto_id):[]],onSave:async(E,q)=>{await K(E,q),_(!1),b(null)}})]})}function D_(){const[o,a]=S.useState(""),[s,l]=S.useState([]),[u,d]=S.useState(null),[f,g]=S.useState([]),[p,m]=S.useState(!1),[v,_]=S.useState(null);async function j(){if(_(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:N}=await W.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(N)throw N;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const O=w[0].id;d(O),await b(O)}}catch(w){_(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),_(null);try{const{data:N,error:O}=await W.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(O)throw O;g(Array.isArray(N)?N:[])}catch(N){_(N?.message||String(N)),g([])}finally{m(!1)}}return S.useEffect(()=>{u&&b(u)},[u]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>j(),children:"Buscar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${f.length} registros`})]}),v&&r.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),r.jsx("ul",{children:s.map(w=>r.jsxs("li",{style:{marginBottom:6},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),r.jsx("strong",{children:w.nombre})," ",r.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Actualizacion"})]})}),r.jsx("tbody",{children:f.map(w=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(w.id)}),r.jsx("td",{style:{minWidth:220},children:s.find(N=>N.id===w.producto_id)?.nombre||w.producto_id}),r.jsx("td",{children:Number(w.precio).toFixed(2)}),r.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function B_(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState({}),[v,_]=S.useState({}),[j,b]=S.useState(!1),[w,N]=S.useState(null);async function O(){b(!0),N(null);try{let T=W.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(T=T.ilike("sku",`%${o}%`)),s&&(T=T.ilike("marca",`%${s}%`)),u&&(T=T.ilike("modelo",`%${u}%`));const{data:I,error:M}=await T.order("nombre",{ascending:!0});if(M)throw M;const K=Array.isArray(I)?I:[];g(K);const E=K.map(J=>J.id);if(E.length===0){m({});return}const{data:q,error:D}=await W.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",E);if(D)throw D;const V=Array.isArray(q)?q:[],ge={};for(const J of K)ge[String(J.id)]=0;for(const J of V){const ce=String(J.producto_id),ye=Number(J.cantidad)||0,B=String(J.tipo_de_movimiento||"").toUpperCase();ge.hasOwnProperty(ce)||(ge[ce]=0),B==="ENTRADA"?ge[ce]=(ge[ce]||0)+ye:B==="SALIDA"&&(ge[ce]=(ge[ce]||0)-ye)}for(const J of Object.keys(ge))ge[J]=Number((ge[J]||0).toFixed(2));m(ge);try{const J=(await wn(async()=>{const{default:B}=await Promise.resolve().then(()=>Sn);return{default:B}},void 0)).default,ce="inventario",ye={};await Promise.all(K.map(async B=>{const Z=B.imagen;if(!Z){ye[String(B.id)]=null;return}const ie=String(Z);if(ie.startsWith("http")){ye[String(B.id)]=ie;return}let C=ie;const z=String(ie).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);z&&(C=decodeURIComponent(z[2]));try{const X=await J.storage.from(ce).getPublicUrl(C),ue=X?.data?.publicUrl||X?.data?.publicURL||null;if(ue){ye[String(B.id)]=ue;return}}catch{}try{const ue=(await J.storage.from(ce).createSignedUrl(C,604800))?.data?.signedUrl??null;ye[String(B.id)]=ue}catch{ye[String(B.id)]=null}})),_(ye)}catch{}}catch(T){N(T?.message||String(T)),g([]),m({})}finally{b(!1)}}return S.useEffect(()=>{O()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Stock"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:T=>a(T.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:T=>l(T.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:T=>d(T.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>O(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),O()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:j?"Cargando...":`${f.length} productos`})]}),w&&r.jsx("div",{style:{color:"red",marginBottom:12},children:w}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Imagen"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Marca"}),r.jsx("th",{children:"Modelo"}),r.jsx("th",{children:"Descripcin"}),r.jsx("th",{children:"Stock"})]})}),r.jsx("tbody",{children:f.map(T=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:v[String(T.id)]?r.jsx("img",{src:encodeURI(v[String(T.id)]),alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):T.imagen?r.jsx("img",{src:T.imagen,alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):""}),r.jsx("td",{children:T.sku||""}),r.jsx("td",{children:T.marca||""}),r.jsx("td",{children:T.modelo||""}),r.jsx("td",{style:{maxWidth:320},children:T.descripcion||""}),r.jsx("td",{style:{textAlign:"right"},children:p[String(T.id)]!=null?String(p[String(T.id)]):"0"})]},T.id))})]})]})]})}function M_(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState([]),[v,_]=S.useState(!1),[j,b]=S.useState([]),[w,N]=S.useState({}),[O,T]=S.useState(!1),[I,M]=S.useState(null);async function K(){T(!0),M(null),b([]);try{let V=null;if(o||s||u){let Z=W.from("inventario").select("id").order("nombre",{ascending:!0});o&&(Z=Z.ilike("sku",`%${o}%`)),s&&(Z=Z.ilike("marca",`%${s}%`)),u&&(Z=Z.ilike("categoria",`%${u}%`));const{data:ie,error:C}=await Z;if(C)throw C;if(V=Array.isArray(ie)?ie.map(z=>String(z.id)):[],V.length===0){b([]),N({}),T(!1);return}}let ge=W.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(V&&(ge=ge.in("producto_id",V)),v){const Z=new Date(Date.now()-864e5).toISOString();ge=ge.gte("fecha_salida",Z)}ge=ge.order("fecha_salida",{ascending:!1});const{data:J,error:ce}=await ge;if(ce)throw ce;const ye=Array.isArray(J)?J.map(Z=>({id:Z.id,producto_id:String(Z.producto_id),cantidad:Number(Z.cantidad),tipo_de_movimiento:Z.tipo_de_movimiento,referencia:Z.referencia,usuario:Z.usuario,fecha_salida:Z.fecha_salida})):[];b(ye);const B=Array.from(new Set(ye.map(Z=>Z.producto_id))).filter(Boolean);if(B.length>0){const{data:Z}=await W.from("inventario").select("id, nombre, sku, marca, categoria").in("id",B),ie={};Array.isArray(Z)&&Z.forEach(C=>{ie[String(C.id)]={id:C.id,nombre:C.nombre,sku:C.sku,marca:C.marca,categoria:C.categoria}}),N(ie)}else N({})}catch(V){M(V?.message||String(V)),b([])}finally{T(!1)}}async function E(){try{const{data:V,error:ge}=await W.from("inventario").select("marca, categoria");if(ge)throw ge;const J=new Set,ce=new Set;Array.isArray(V)&&V.forEach(ye=>{ye.marca&&J.add(String(ye.marca)),ye.categoria&&ce.add(String(ye.categoria))}),g(Array.from(J).sort()),m(Array.from(ce).sort())}catch(V){console.warn("Error loading filter options",V)}}S.useEffect(()=>{K(),E()},[]);const q=j.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="ENTRADA"),D=j.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="SALIDA");return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:V=>a(V.target.value)}),r.jsxs("select",{className:"input",value:s,onChange:V=>l(V.target.value),children:[r.jsx("option",{value:"",children:"-- Marca (todas) --"}),f.map(V=>r.jsx("option",{value:V,children:V},V))]}),r.jsxs("select",{className:"input",value:u,onChange:V=>d(V.target.value),children:[r.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(V=>r.jsx("option",{value:V,children:V},V))]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:v,onChange:V=>_(V.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),_(!1),K()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:O?"Cargando...":`${j.length} registros`})]}),I&&r.jsx("div",{style:{color:"red",marginBottom:12},children:I}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Entradas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:q.map(V=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(V.id)}),r.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),r.jsx("td",{children:w[V.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),r.jsx("td",{children:V.referencia||""}),r.jsx("td",{children:V.usuario||""}),r.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]}),r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Salidas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:D.map(V=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(V.id)}),r.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),r.jsx("td",{children:w[V.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),r.jsx("td",{children:V.referencia||""}),r.jsx("td",{children:V.usuario||""}),r.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]})]})]})}function q_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),r.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function L_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),r.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function I_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function H_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function V_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function $_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function P_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function G_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),r.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function K_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),r.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function Y_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),r.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function J_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),r.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function F_({open:o,onClose:a,onCreate:s}){const[l,u]=S.useState(""),[d,f]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[_,j]=S.useState(""),[b,w]=S.useState(""),[N,O]=S.useState(!0),[T,I]=S.useState(!1),[M,K]=S.useState(null);if(!o)return null;async function E(){const q=[];if(l.trim()||q.push("Nombre"),q.length){K(`Faltan campos: ${q.join(", ")}`);return}I(!0),K(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:b||void 0,activo:N}),u(""),f(""),p(""),v(""),j(""),w(""),O(!0),a()}catch(D){K(D?.message||String(D))}finally{I(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:l,onChange:q=>u(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:d,onChange:q=>f(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:g,onChange:q=>p(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:m,onChange:q=>v(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:_,onChange:q=>j(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:b,onChange:q=>w(q.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:N,onChange:q=>O(q.target.checked)})," ","Activo"]})]}),M&&r.jsx("div",{style:{color:"red",marginTop:12},children:M}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:T,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:E,disabled:T,style:{width:"auto",padding:"8px 14px"},children:T?"Creando...":"Crear"})]})]})})}function Q_({open:o,onClose:a,row:s,onSave:l}){const[u,d]=S.useState(""),[f,g]=S.useState(""),[p,m]=S.useState(""),[v,_]=S.useState(""),[j,b]=S.useState(""),[w,N]=S.useState(""),[O,T]=S.useState(!0),[I,M]=S.useState(!1),[K,E]=S.useState(null);if(S.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),_(s.correo||""),b(s.direccion||""),N(s.tipo_proveedor||""),T(s.activo??!0),E(null))},[o,s]),!o||!s)return null;async function q(){if(!s){E("No hay fila seleccionada");return}const D=[];if(u.trim()||D.push("Nombre"),D.length){E(`Faltan campos: ${D.join(", ")}`);return}M(!0),E(null);try{await l(s.id,{nombre:u.trim(),rtn:f.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:j.trim()||void 0,tipo_proveedor:w||void 0,activo:O}),a()}catch(V){E(V?.message||String(V))}finally{M(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:u,onChange:D=>d(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:f,onChange:D=>g(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:p,onChange:D=>m(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:v,onChange:D=>_(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:j,onChange:D=>b(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:w,onChange:D=>N(D.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:O,onChange:D=>T(D.target.checked)})," ","Activo"]})]}),K&&r.jsx("div",{style:{color:"red",marginTop:12},children:K}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:I,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:q,disabled:I,style:{width:"auto",padding:"8px 14px"},children:I?"Guardando...":"Guardar"})]})]})})}function X_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(""),[p,m]=S.useState(!1),[v,_]=S.useState(!1),[j,b]=S.useState(null),[w,N]=S.useState(!1),[O,T]=S.useState(null);async function I(q){l(!0),d(null);try{let D=null,V=null;if(q&&q.trim()){const J=`%${q.trim()}%`,ce=await W.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${J},rtn.ilike.${J}`).order("id",{ascending:!0});D=ce.data,V=ce.error}else{const ge=await W.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});D=ge.data,V=ge.error}if(V)throw V;a(Array.isArray(D)?D:[])}catch(D){d(D?.message||String(D)),a([])}finally{l(!1)}}S.useEffect(()=>{I()},[]),S.useEffect(()=>{const q=setTimeout(()=>{I(f)},350);return()=>clearTimeout(q)},[f]);async function M(q){l(!0),d(null);try{const D={...q};if(delete D.id,D.rtn){const{data:ge,error:J}=await W.from("proveedores").select("id, nombre").eq("rtn",D.rtn).limit(1);if(J)throw J;if(Array.isArray(ge)&&ge.length>0)throw new Error(`Ya existe un proveedor con RTN ${D.rtn}`)}const{error:V}=await W.from("proveedores").insert(D);if(V)throw V;await I()}catch(D){throw String(D).includes("Ya existe un proveedor")?d(String(D)):D?.code==="23505"||String(D).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(D?.message||String(D)),D}finally{l(!1)}}async function K(q,D){l(!0),d(null);try{const{error:V}=await W.from("proveedores").update(D).eq("id",q);if(V)throw V;await I()}catch(V){throw d(V?.message||String(V)),V}finally{l(!1)}}async function E(){if(O){l(!0),d(null);try{const{error:q}=await W.from("proveedores").delete().eq("id",O.id);if(q)throw q;N(!1),T(null),await I()}catch(q){d(q?.message||String(q))}finally{l(!1)}}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>I(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),r.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:f,onChange:q=>g(q.target.value),style:{width:260}}),r.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),I()},children:"Limpiar"})]}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"RTN"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Telfono"}),r.jsx("th",{children:"Correo"}),r.jsx("th",{children:"Direccin"}),r.jsx("th",{children:"Tipo"}),r.jsx("th",{children:"Activo"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(q=>r.jsxs("tr",{children:[r.jsx("td",{children:q.rtn||""}),r.jsx("td",{style:{minWidth:180},children:q.nombre}),r.jsx("td",{children:q.telefono||""}),r.jsx("td",{children:q.correo||""}),r.jsx("td",{children:q.direccion||""}),r.jsx("td",{children:q.tipo_proveedor||""}),r.jsx("td",{children:q.activo?"S":"No"}),r.jsxs("td",{style:{whiteSpace:"nowrap"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{b(q),_(!0)},children:"Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>{T(q),N(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},q.id))})]})}),r.jsx(F_,{open:p,onClose:()=>m(!1),onCreate:async q=>{await M(q),m(!1)}}),r.jsx(Q_,{open:v,onClose:()=>{_(!1),b(null)},row:j,onSave:async(q,D)=>{await K(q,D),_(!1),b(null)}}),r.jsx(am,{open:w,title:O?`Eliminar proveedor ${O.nombre}`:"Eliminar proveedor",message:O?`Confirma eliminar al proveedor ${O.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await E()},onCancel:()=>{N(!1),T(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function Z_({open:o,onClose:a,onCreated:s}){const[l,u]=S.useState([]),[d,f]=S.useState([]),[g,p]=S.useState(0),[m,v]=S.useState(null),[_,j]=S.useState(""),[b,w]=S.useState("factura"),[N,O]=S.useState([]),[T,I]=S.useState(null),[M,K]=S.useState(1),[E,q]=S.useState(null),[D,V]=S.useState(!1),[ge,J]=S.useState(null);if(S.useEffect(()=>{o&&(async()=>{try{const z=await W.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(z.data)?z.data:[])}catch{}try{const z=await W.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});f(Array.isArray(z.data)?z.data:[])}catch{}try{const z=await W.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),X=Array.isArray(z.data)&&z.data.length>0?z.data[0]:null,ue=X?Number(X.impuesto_venta):0;p(ue)}catch{}})()},[o]),!o)return null;function ce(){v(null),j(""),w("factura"),O([]),I(null),K(1),q(null),J(null)}function ye(){if(!T){J("Selecciona un producto");return}if(!E||E<=0){J("Costo unitario invlido");return}if(!M||M<=0){J("Cantidad invlida");return}const z=l.find(ue=>ue.id===T),X=ue=>{if(ue==null)return!1;if(typeof ue=="boolean")return ue===!0;if(typeof ue=="number")return ue===1;const fe=String(ue).toLowerCase().trim();return fe==="1"||fe==="true"||fe==="t"||fe==="si"||fe==="s"||fe==="yes"};O(ue=>[...ue,{producto_id:T,nombre:z?.nombre||"",cantidad:M,costo_unitario:E,exento:X(z?.exento)}]),I(null),K(1),q(null),J(null)}function B(z){O(X=>X.filter((ue,fe)=>fe!==z))}function Z(){const z=g,X=z>1?z/100:z;let ue=0,fe=0,A=0;for(const U of N){const $=U.cantidad*U.costo_unitario;let F=0,re=$;U.exento||(F=$*X,re=$-F),ue+=re,fe+=F,A+=$}return{subtotal:ue,impuesto:fe,total:A}}async function ie(){if(J(null),!m){J("Selecciona un proveedor");return}if(N.length===0){J("Agrega al menos un producto");return}V(!0);try{const{subtotal:z,impuesto:X,total:ue}=Z(),fe={proveedor_id:m,numero_documento:_||null,tipo_documento:b||null,subtotal:z,impuesto:X,total:ue,usuario:null},A=await W.from("compras").insert(fe).select("id").single();if(A.error)throw A.error;const U=A.data.id,$=N.map(re=>({compra_id:U,producto_id:re.producto_id,cantidad:re.cantidad,costo_unitario:re.costo_unitario})),F=await W.from("compras_detalle").insert($);if(F.error)throw await W.from("compras").delete().eq("id",U),F.error;try{const re=_?`Compra - ${_}`:`Compra ${U}`;let ne="sistema";try{const ze=localStorage.getItem("user");if(ze){const Pe=JSON.parse(ze);ne=Pe.username?`${Pe.username}${Pe.role?` (${Pe.role})`:""}`:String(Pe)}}catch{}const pe=new Date().toISOString(),he=N.map(ze=>({producto_id:ze.producto_id,cantidad:ze.cantidad,tipo_de_movimiento:"ENTRADA",referencia:re,usuario:ne,fecha_salida:pe})),xe=await W.from("registro_de_inventario").insert(he);xe.error&&(console.warn("Error registrando en registro_de_inventario",xe.error),J("Compra guardada, pero fall el registro en inventario: "+xe.error.message))}catch(re){console.warn("Registro inventario fallo",re)}ce(),a(),s&&s()}catch(z){J(z?.message||String(z))}finally{V(!1)}}const C=Z();return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),r.jsxs("select",{className:"input",value:m??"",onChange:z=>v(z.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(z=>r.jsx("option",{value:z.id,children:z.nombre},String(z.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),r.jsx("input",{className:"input",value:_,onChange:z=>j(z.target.value)}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),r.jsx("input",{className:"input",value:b,onChange:z=>w(z.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:T??"",onChange:z=>I(z.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(z=>r.jsx("option",{value:z.id,children:z.nombre},z.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:z=>K(Number(z.target.value))}),r.jsx("input",{className:"input",type:"number",style:{width:120},value:E??"",onChange:z=>q(Number(z.target.value)),placeholder:"Costo unitario"}),r.jsx("button",{className:"btn-primary",onClick:ye,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:N.map((z,X)=>{const ue=z.cantidad*z.costo_unitario,fe=g>1?g/100:g,A=z.exento?0:ue*fe,U=z.exento?ue:ue-A;return r.jsxs("tr",{children:[r.jsx("td",{children:z.nombre}),r.jsx("td",{children:z.cantidad}),r.jsx("td",{children:z.costo_unitario.toFixed(2)}),r.jsx("td",{children:A.toFixed(2)}),r.jsx("td",{children:U.toFixed(2)}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>B(X),children:"Quitar"})})]},`${z.producto_id}-${X}`)})})]})})]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:["Subtotal: ",r.jsx("strong",{children:C.subtotal.toFixed(2)})]}),r.jsxs("div",{children:["Impuesto: ",r.jsx("strong",{children:C.impuesto.toFixed(2)})]}),r.jsxs("div",{children:["Total: ",r.jsx("strong",{children:C.total.toFixed(2)})]})]})}),ge&&r.jsx("div",{style:{color:"red",marginTop:12},children:ge}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{ce(),a()},disabled:D,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ie,disabled:D,children:D?"Guardando...":"Confirmar compra"})]})]})})}function W_({open:o,compraId:a,onClose:s}){const[l,u]=S.useState([]),[d,f]=S.useState({}),[g,p]=S.useState({}),[m,v]=S.useState(0),[_,j]=S.useState(!1);return S.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{j(!0);try{const{data:w,error:N}=await W.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(N)throw N;const O=Array.isArray(w)?w:[];if(!b)return;u(O);const T=Array.from(new Set(O.map(I=>I.producto_id))).filter(Boolean);if(T.length>0){const{data:I}=await W.from("inventario").select("id, nombre, exento").in("id",T),M={},K={};Array.isArray(I)&&I.forEach(E=>{M[String(E.id)]={id:E.id,nombre:E.nombre},K[String(E.id)]=E.exento===!0||E.exento===1||String(E.exento).toLowerCase()==="true"}),b&&(f(M),p(K))}else f({});try{const{data:I}=await W.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),M=Array.isArray(I)&&I.length>0?I[0]:null,K=M?Number(M.impuesto_venta):0;b&&v(K)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&j(!1)}})(),()=>{b=!1}},[o,a]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),r.jsx("div",{style:{marginTop:8},children:_?r.jsx("div",{children:"Cargando..."}):r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),N=Number(b.costo_unitario),O=w*N,T=m>1?m/100:m,I=g[String(b.producto_id)]===!0,M=I?0:O*T,K=I?O:O-M;return r.jsxs("tr",{children:[r.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),r.jsx("td",{children:w.toFixed(2)}),r.jsx("td",{children:N.toFixed(2)}),r.jsx("td",{children:M.toFixed(2)}),r.jsx("td",{children:K.toFixed(2)}),r.jsx("td",{children:O.toFixed(2)})]},String(b.id))})}),r.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,N)=>{const O=Number(N.cantidad),T=Number(N.costo_unitario),I=O*T,M=m>1?m/100:m,K=g[String(N.producto_id)]===!0,E=K?0:I*M,q=K?I:I-E;return w.subtotal+=q,w.impuesto+=E,w.total+=I,w},{subtotal:0,impuesto:0,total:0});return r.jsxs("tr",{children:[r.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),r.jsx("td",{children:b.impuesto.toFixed(2)}),r.jsx("td",{children:b.subtotal.toFixed(2)}),r.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function ex(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(!1),[p,m]=S.useState(!1),[v,_]=S.useState(null),[j,b]=S.useState([]),[w,N]=S.useState(""),[O,T]=S.useState(""),[I,M]=S.useState(!1);async function K(){l(!0),d(null);try{let E=W.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const V=Number(w);isNaN(V)?E=E.eq("proveedor_id",w):E=E.eq("proveedor_id",V)}if(O&&(E=E.ilike("numero_documento",`%${O}%`)),I){const V=new Date(Date.now()-864e5).toISOString();E=E.gte("fecha_compra",V)}const{data:q,error:D}=await E.order("id",{ascending:!1});if(D)throw D;a(Array.isArray(q)?q:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}return S.useEffect(()=>{K()},[]),S.useEffect(()=>{let E=!0;return(async()=>{try{const{data:q}=await W.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!E)return;b(Array.isArray(q)?q:[])}catch{}})(),()=>{E=!1}},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:w,onChange:E=>N(E.target.value),children:[r.jsx("option",{value:"",children:"-- proveedor (todos) --"}),j.map(E=>r.jsx("option",{value:String(E.id),children:E.nombre},String(E.id)))]}),r.jsx("input",{className:"input",placeholder:"Nmero documento",value:O,onChange:E=>T(E.target.value)}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:I,onChange:E=>M(E.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{N(""),T(""),M(!1),K()},children:"Limpiar"})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>K(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),r.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(E.id)}),r.jsx("td",{children:String(E.proveedor_id)}),r.jsx("td",{children:E.numero_documento||""}),r.jsx("td",{children:E.fecha_compra||""}),r.jsx("td",{children:E.subtotal||""}),r.jsx("td",{children:E.impuesto||""}),r.jsx("td",{children:E.total||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{_(E.id),m(!0)},children:"Detalle"})})]},String(E.id)))})]})}),r.jsx(Z_,{open:f,onClose:()=>g(!1),onCreated:()=>{g(!1),K()}}),r.jsx(W_,{open:p,compraId:v,onClose:()=>{m(!1),_(null)}})]})}function tx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(!1),[p,m]=S.useState(null);async function v(){l(!0),d(null);try{const{data:_,error:j}=await W.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(j)throw j;a(Array.isArray(_)?_.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(_){d(_?.message||String(_)),a([])}finally{l(!1)}}return S.useEffect(()=>{v()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),r.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(_=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(_.id)}),r.jsx("td",{children:String(_.proveedor_id||"")}),r.jsx("td",{children:_.numero_documento||""}),r.jsx("td",{children:_.usuario||""}),r.jsx("td",{children:_.fecha||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>m(_.id),children:"Detalle"})})]},String(_.id)))})]})}),f&&r.jsx(nx,{onClose:()=>{g(!1),v()}}),p&&r.jsx(ax,{id:p,onClose:()=>{m(null),v()}})]})}function nx({onClose:o}){const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,f]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(null),[_,j]=S.useState(null),[b,w]=S.useState(""),[N,O]=S.useState([]),[T,I]=S.useState(null),[M,K]=S.useState(1),[E,q]=S.useState(!1),[D,V]=S.useState(null);S.useEffect(()=>{(async()=>{try{const B=await W.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(B.data)?B.data:[])}catch{}try{const B=await W.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(B.data)?B.data:[])}catch{}})()},[]);async function ge(){if(b){V(null);try{const{data:B,error:Z}=await W.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(Z)throw Z;if(!B){V("No se encontr compra con ese nmero de documento");return}f(B.id),v(B.proveedor_id);try{const{data:F}=await W.from("proveedores").select("id, nombre").eq("id",B.proveedor_id).limit(1).single();F&&F.nombre&&j(F.nombre)}catch{}const{data:ie}=await W.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",B.id),C=Array.isArray(ie)?ie:[],{data:z}=await W.from("devoluciones_proveedores").select("id").eq("numero_documento",b),X=Array.isArray(z)?z.map(F=>F.id):[];let ue={};if(X.length>0){const{data:F}=await W.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",X);Array.isArray(F)&&F.forEach(re=>{const ne=String(re.producto_id);ue[ne]=(ue[ne]||0)+Number(re.cantidad)})}const fe=C.map(F=>F.producto_id),{data:A}=await W.from("inventario").select("id, nombre, sku").in("id",fe),U={};Array.isArray(A)&&A.forEach(F=>{U[String(F.id)]=F});const $=C.map(F=>{const re=String(F.producto_id),ne=Number(F.cantidad),pe=ue[re]||0,he=Math.max(0,ne-pe);return{producto_id:re,nombre:U[re]?.nombre||re,sku:U[re]?.sku,purchased:ne,returned:pe,available:he,costo_unitario:Number(F.costo_unitario||0)}});p($),u($.map(F=>({id:F.producto_id,nombre:F.nombre,sku:F.sku})))}catch(B){V(B?.message||String(B))}}}function J(){if(!T){V("Selecciona un producto");return}if(!M||M<=0){V("Cantidad invlida");return}const B=l.find(ie=>ie.id===T),Z=g.find(ie=>ie.producto_id===T);if(Z&&M>Z.available){V(`Cantidad excede disponible para devolucin (${Z.available})`);return}O(ie=>[...ie,{producto_id:T,nombre:B?.nombre,cantidad:M}]),I(null),K(1),V(null),Z&&(p(ie=>ie.map(C=>C.producto_id===Z.producto_id?{...C,available:Math.max(0,C.available-M)}:C)),u(ie=>ie.map(C=>(C.id===Z.producto_id,C))))}function ce(B){O(Z=>Z.filter((ie,C)=>C!==B))}async function ye(){if(V(null),!m){V("Selecciona un proveedor");return}if(N.length===0){V("Agrega al menos un producto");return}q(!0);try{const B={proveedor_id:m,numero_documento:b||null,usuario:null},Z=await W.from("devoluciones_proveedores").insert(B).select("id").single();if(Z.error)throw Z.error;const ie=Z.data.id;try{const C=N.map(X=>({devolucion_id:ie,producto_id:X.producto_id,cantidad:X.cantidad})),z=await W.from("devoluciones_proveedores_detalle").insert(C);z.error&&console.warn("No se pudo insertar detalles de devolucin",z.error)}catch(C){console.warn("Detalles tabla puede no existir",C)}try{const C=b?`Devolucin - ${b}`:`Devolucin ${ie}`;let z="sistema";try{const A=localStorage.getItem("user");if(A){const U=JSON.parse(A);z=U.username?`${U.username}${U.role?` (${U.role})`:""}`:String(U)}}catch{}const X=new Date().toISOString(),ue=N.map(A=>({producto_id:A.producto_id,cantidad:A.cantidad,tipo_de_movimiento:"SALIDA",referencia:C,usuario:z,fecha_salida:X})),fe=await W.from("registro_de_inventario").insert(ue);fe.error&&(console.warn("Error registrando en registro_de_inventario",fe.error),V("Devolucin guardada, pero fall el registro en inventario: "+fe.error.message))}catch(C){console.warn("Registro inventario fallo",C)}o()}catch(B){V(B?.message||String(B))}finally{q(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?r.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:_||String(m||"")}):r.jsxs("select",{className:"input",value:m??"",onChange:B=>v(B.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(B=>r.jsx("option",{value:B.id,children:B.nombre},String(B.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{className:"input",value:b,onChange:B=>w(B.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>ge(),children:"Buscar compra"})]}),d&&r.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&r.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[r.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[r.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Comprado"}),r.jsx("th",{children:"Devuelto"}),r.jsx("th",{children:"Disponible"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:g.map(B=>r.jsxs("tr",{children:[r.jsx("td",{children:B.nombre}),r.jsx("td",{style:{textAlign:"right"},children:Number(B.purchased).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(B.returned).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(B.available).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>{I(B.producto_id),K(B.available||1)},children:"Usar"})})]},B.producto_id))})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:T??"",onChange:B=>I(B.target.value||null),disabled:!!d,children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(B=>r.jsx("option",{value:B.id,children:B.nombre},B.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:B=>{const Z=Number(B.target.value),ie=g.find(C=>C.producto_id===T);if(ie){const C=Number(ie.available||0);return isNaN(Z)||Z<1?K(1):Z>C?K(C):K(Z)}K(Z)},min:1,max:T?g.find(B=>B.producto_id===T)?.available??void 0:void 0,disabled:(()=>{const B=g.find(Z=>Z.producto_id===T);return!!B&&Number(B.available||0)<=1})()}),r.jsx("button",{className:"btn-primary",onClick:J,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:N.map((B,Z)=>r.jsxs("tr",{children:[r.jsx("td",{children:B.nombre}),r.jsx("td",{style:{textAlign:"right"},children:B.cantidad}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>ce(Z),children:"Quitar"})})]},`${B.producto_id}-${Z}`))})]})})]})]}),D&&r.jsx("div",{style:{color:"red",marginTop:12},children:D}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:o,disabled:E,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ye,disabled:E,children:E?"Guardando...":"Registrar devolucin"})]})]})})}function ax({id:o,onClose:a}){const[s,l]=S.useState([]),[u,d]=S.useState(!1),[f,g]=S.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await W.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const _=Array.isArray(m)?m:[];if(_.length>0){const j=_.map(N=>N.producto_id),{data:b}=await W.from("inventario").select("id, nombre, sku").in("id",j),w={};Array.isArray(b)&&b.forEach(N=>{w[String(N.id)]=N}),l(_.map(N=>({producto:w[String(N.producto_id)]?.nombre||String(N.producto_id),cantidad:N.cantidad})))}else{const{data:j}=await W.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(j)?j:[],w=b.map(T=>T.producto_id),{data:N}=await W.from("inventario").select("id, nombre, sku").in("id",w),O={};Array.isArray(N)&&N.forEach(T=>{O[String(T.id)]=T}),l(b.map(T=>({producto:O[String(T.producto_id)]?.nombre||String(T.producto_id),cantidad:T.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return S.useEffect(()=>{p()},[o]),r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&r.jsx("div",{children:"Cargando..."}),f&&r.jsx("div",{style:{color:"red"},children:f}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"})]})}),r.jsx("tbody",{children:s.map((m,v)=>r.jsxs("tr",{children:[r.jsx("td",{children:m.producto}),r.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const ix={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function rx(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,m]=S.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await W.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};S.useEffect(()=>{v()},[]);const _=(b,w)=>{a(N=>N.map(O=>O.id===b?{...O,impuesto_venta:w}:O))},j=async b=>{const w=o.find(N=>N.id===b);if(w){d(b),m(null);try{const N={impuesto_venta:w.impuesto_venta??null},{error:O}=await W.from("impuesto").update(N).eq("id",b);if(O)throw O;await v()}catch(N){console.warn("Error guardando impuesto:",N),m(String(N.message||N))}finally{d(null)}}};return r.jsxs("div",{children:[r.jsx("h2",{children:"Impuestos"}),r.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?r.jsx("div",{children:"Cargando..."}):r.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>r.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8},children:ix[b.id]??`Impuesto #${b.id}`}),r.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),r.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>_(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:f!==b.id}),r.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:f===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[r.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),r.jsx("div",{style:{display:"flex",gap:8},children:f===b.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:()=>j(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):r.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&r.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&r.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const sx={dashboard:p_,datos:v_,usuarios_internal:__,usuarios_web:b_,cai:S_,facturas:w_,historial_facturas:E_,inventario_productos:R_,precios_productos:U_,precios_historico:D_,stock:B_,inventario_salidas:M_,inventario_categorias:q_,proveedores:X_,caja_sesiones:L_,caja_movimientos:I_,rep_ventas:H_,rep_devoluciones:V_,rep_ingresos_egresos:$_,rep_compras:P_,compras_main:ex,devoluciones_proveedores:tx,rep_export:G_,cuentas_contables:K_,libro_diario:Y_,auditoria:J_,impuestos:rx};function lx({onLogout:o}){const[a,s]=S.useState("dashboard"),[l,u]=S.useState(null),[d,f]=S.useState({}),g=l||a,p=sx[g],v=(j=>{for(const b of sp){if(b.id===j)return b.label;if(b.children){const w=b.children.find(N=>N.id===j);if(w)return w.label}}return"Panel de Administracin"})(g),_=j=>{if(j.id==="salir")return o();j.children&&j.children.length>0?(f(b=>({...b,[j.id]:!b[j.id]})),(j.id!==a||!l)&&(s(j.id),u(j.children[0].id))):(s(j.id),u(null))};return r.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[r.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[r.jsx("strong",{children:"Panel Admin"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),r.jsx("nav",{children:sp.map(j=>r.jsxs("div",{style:{marginBottom:6},children:[r.jsxs("div",{onClick:()=>_(j),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===j.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[r.jsx("span",{children:j.label}),Array.isArray(j.children)&&j.children.length>0?r.jsx("span",{style:{marginLeft:8},children:d[j.id]?"":""}):null]}),Array.isArray(j.children)&&j.children.length>0&&d[j.id]&&r.jsx("div",{style:{marginLeft:12,marginTop:6},children:j.children.map(b=>r.jsx("div",{onClick:()=>{s(j.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},j.id))})]}),r.jsx("main",{style:{flex:1,padding:24},children:p?r.jsx(p,{}):r.jsx(g_,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function ox(){const[o,a]=S.useState(null);S.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return r.jsxs("div",{children:[!o&&r.jsx($0,{onLogin:s}),o&&o.role==="cajero"&&r.jsx(c_,{onLogout:l}),o&&o.role==="admin"&&r.jsx(lx,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&r.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[r.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),r.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',r.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),r.jsx("div",{style:{marginTop:18},children:r.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class cx extends Tu.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[r.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}_v.createRoot(document.getElementById("root")).render(r.jsx(cx,{children:r.jsx(ox,{})}));
