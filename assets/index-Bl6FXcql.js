function gb(o,a){for(var r=0;r<a.length;r++){const l=a[r];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function r(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=r(u);fetch(u.href,d)}})();function gp(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function pb(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var r=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};r.prototype=a.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(r,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),r}var ou={exports:{}},ds={};var Cg;function mb(){if(Cg)return ds;Cg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function r(l,u,d){var h=null;if(d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:h,ref:u!==void 0?u:null,props:d}}return ds.Fragment=a,ds.jsx=r,ds.jsxs=r,ds}var Tg;function yb(){return Tg||(Tg=1,ou.exports=mb()),ou.exports}var i=yb(),cu={exports:{}},fs={},uu={exports:{}},du={};var Ag;function bb(){return Ag||(Ag=1,(function(o){function a(C,z){var X=C.length;C.push(z);e:for(;0<X;){var me=X-1>>>1,K=C[me];if(0<u(K,z))C[me]=z,C[X]=K,X=me;else break e}}function r(C){return C.length===0?null:C[0]}function l(C){if(C.length===0)return null;var z=C[0],X=C.pop();if(X!==z){C[0]=X;e:for(var me=0,K=C.length,T=K>>>1;me<T;){var B=2*(me+1)-1,O=C[B],P=B+1,ie=C[P];if(0>u(O,X))P<K&&0>u(ie,O)?(C[me]=ie,C[P]=X,me=P):(C[me]=O,C[B]=X,me=B);else if(P<K&&0>u(ie,X))C[me]=ie,C[P]=X,me=P;else break e}}return z}function u(C,z){var X=C.sortIndex-z.sortIndex;return X!==0?X:C.id-z.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();o.unstable_now=function(){return h.now()-g}}var p=[],m=[],b=1,x=null,_=3,v=!1,w=!1,N=!1,R=!1,A=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(C){for(var z=r(m);z!==null;){if(z.callback===null)l(m);else if(z.startTime<=C)l(m),z.sortIndex=z.expirationTime,a(p,z);else break;z=r(m)}}function E(C){if(N=!1,G(C),!w)if(r(p)!==null)w=!0,D||(D=!0,de());else{var z=r(m);z!==null&&Y(E,z.startTime-C)}}var D=!1,L=-1,I=5,ce=-1;function ve(){return R?!0:!(o.unstable_now()-ce<I)}function Z(){if(R=!1,D){var C=o.unstable_now();ce=C;var z=!0;try{e:{w=!1,N&&(N=!1,$(L),L=-1),v=!0;var X=_;try{t:{for(G(C),x=r(p);x!==null&&!(x.expirationTime>C&&ve());){var me=x.callback;if(typeof me=="function"){x.callback=null,_=x.priorityLevel;var K=me(x.expirationTime<=C);if(C=o.unstable_now(),typeof K=="function"){x.callback=K,G(C),z=!0;break t}x===r(p)&&l(p),G(C)}else l(p);x=r(p)}if(x!==null)z=!0;else{var T=r(m);T!==null&&Y(E,T.startTime-C),z=!1}}break e}finally{x=null,_=X,v=!1}z=void 0}}finally{z?de():D=!1}}}var de;if(typeof M=="function")de=function(){M(Z)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,ee=H.port2;H.port1.onmessage=Z,de=function(){ee.postMessage(null)}}else de=function(){A(Z,0)};function Y(C,z){L=A(function(){C(o.unstable_now())},z)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(C){C.callback=null},o.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<C?Math.floor(1e3/C):5},o.unstable_getCurrentPriorityLevel=function(){return _},o.unstable_next=function(C){switch(_){case 1:case 2:case 3:var z=3;break;default:z=_}var X=_;_=z;try{return C()}finally{_=X}},o.unstable_requestPaint=function(){R=!0},o.unstable_runWithPriority=function(C,z){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var X=_;_=C;try{return z()}finally{_=X}},o.unstable_scheduleCallback=function(C,z,X){var me=o.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?me+X:me):X=me,C){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=X+K,C={id:b++,callback:z,priorityLevel:C,startTime:X,expirationTime:K,sortIndex:-1},X>me?(C.sortIndex=X,a(m,C),r(p)===null&&C===r(m)&&(N?($(L),L=-1):N=!0,Y(E,X-me))):(C.sortIndex=K,a(p,C),w||v||(w=!0,D||(D=!0,de()))),C},o.unstable_shouldYield=ve,o.unstable_wrapCallback=function(C){var z=_;return function(){var X=_;_=z;try{return C.apply(this,arguments)}finally{_=X}}}})(du)),du}var Ng;function vb(){return Ng||(Ng=1,uu.exports=bb()),uu.exports}var fu={exports:{}},He={};var Rg;function xb(){if(Rg)return He;Rg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),_=Symbol.iterator;function v(T){return T===null||typeof T!="object"?null:(T=_&&T[_]||T["@@iterator"],typeof T=="function"?T:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,R={};function A(T,B,O){this.props=T,this.context=B,this.refs=R,this.updater=O||w}A.prototype.isReactComponent={},A.prototype.setState=function(T,B){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,B,"setState")},A.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function $(){}$.prototype=A.prototype;function M(T,B,O){this.props=T,this.context=B,this.refs=R,this.updater=O||w}var G=M.prototype=new $;G.constructor=M,N(G,A.prototype),G.isPureReactComponent=!0;var E=Array.isArray;function D(){}var L={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function ce(T,B,O){var P=O.ref;return{$$typeof:o,type:T,key:B,ref:P!==void 0?P:null,props:O}}function ve(T,B){return ce(T.type,B,T.props)}function Z(T){return typeof T=="object"&&T!==null&&T.$$typeof===o}function de(T){var B={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(O){return B[O]})}var H=/\/+/g;function ee(T,B){return typeof T=="object"&&T!==null&&T.key!=null?de(""+T.key):B.toString(36)}function Y(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(D,D):(T.status="pending",T.then(function(B){T.status==="pending"&&(T.status="fulfilled",T.value=B)},function(B){T.status==="pending"&&(T.status="rejected",T.reason=B)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function C(T,B,O,P,ie){var oe=typeof T;(oe==="undefined"||oe==="boolean")&&(T=null);var k=!1;if(T===null)k=!0;else switch(oe){case"bigint":case"string":case"number":k=!0;break;case"object":switch(T.$$typeof){case o:case a:k=!0;break;case b:return k=T._init,C(k(T._payload),B,O,P,ie)}}if(k)return ie=ie(T),k=P===""?"."+ee(T,0):P,E(ie)?(O="",k!=null&&(O=k.replace(H,"$&/")+"/"),C(ie,B,O,"",function(Ee){return Ee})):ie!=null&&(Z(ie)&&(ie=ve(ie,O+(ie.key==null||T&&T.key===ie.key?"":(""+ie.key).replace(H,"$&/")+"/")+k)),B.push(ie)),1;k=0;var re=P===""?".":P+":";if(E(T))for(var be=0;be<T.length;be++)P=T[be],oe=re+ee(P,be),k+=C(P,B,O,oe,ie);else if(be=v(T),typeof be=="function")for(T=be.call(T),be=0;!(P=T.next()).done;)P=P.value,oe=re+ee(P,be++),k+=C(P,B,O,oe,ie);else if(oe==="object"){if(typeof T.then=="function")return C(Y(T),B,O,P,ie);throw B=String(T),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.")}return k}function z(T,B,O){if(T==null)return T;var P=[],ie=0;return C(T,P,"","",function(oe){return B.call(O,oe,ie++)}),P}function X(T){if(T._status===-1){var B=T._result;B=B(),B.then(function(O){(T._status===0||T._status===-1)&&(T._status=1,T._result=O)},function(O){(T._status===0||T._status===-1)&&(T._status=2,T._result=O)}),T._status===-1&&(T._status=0,T._result=B)}if(T._status===1)return T._result.default;throw T._result}var me=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var B=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(B))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},K={map:z,forEach:function(T,B,O){z(T,function(){B.apply(this,arguments)},O)},count:function(T){var B=0;return z(T,function(){B++}),B},toArray:function(T){return z(T,function(B){return B})||[]},only:function(T){if(!Z(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return He.Activity=x,He.Children=K,He.Component=A,He.Fragment=r,He.Profiler=u,He.PureComponent=M,He.StrictMode=l,He.Suspense=p,He.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,He.__COMPILER_RUNTIME={__proto__:null,c:function(T){return L.H.useMemoCache(T)}},He.cache=function(T){return function(){return T.apply(null,arguments)}},He.cacheSignal=function(){return null},He.cloneElement=function(T,B,O){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var P=N({},T.props),ie=T.key;if(B!=null)for(oe in B.key!==void 0&&(ie=""+B.key),B)!I.call(B,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&B.ref===void 0||(P[oe]=B[oe]);var oe=arguments.length-2;if(oe===1)P.children=O;else if(1<oe){for(var k=Array(oe),re=0;re<oe;re++)k[re]=arguments[re+2];P.children=k}return ce(T.type,ie,P)},He.createContext=function(T){return T={$$typeof:h,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:d,_context:T},T},He.createElement=function(T,B,O){var P,ie={},oe=null;if(B!=null)for(P in B.key!==void 0&&(oe=""+B.key),B)I.call(B,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(ie[P]=B[P]);var k=arguments.length-2;if(k===1)ie.children=O;else if(1<k){for(var re=Array(k),be=0;be<k;be++)re[be]=arguments[be+2];ie.children=re}if(T&&T.defaultProps)for(P in k=T.defaultProps,k)ie[P]===void 0&&(ie[P]=k[P]);return ce(T,oe,ie)},He.createRef=function(){return{current:null}},He.forwardRef=function(T){return{$$typeof:g,render:T}},He.isValidElement=Z,He.lazy=function(T){return{$$typeof:b,_payload:{_status:-1,_result:T},_init:X}},He.memo=function(T,B){return{$$typeof:m,type:T,compare:B===void 0?null:B}},He.startTransition=function(T){var B=L.T,O={};L.T=O;try{var P=T(),ie=L.S;ie!==null&&ie(O,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(D,me)}catch(oe){me(oe)}finally{B!==null&&O.types!==null&&(B.types=O.types),L.T=B}},He.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},He.use=function(T){return L.H.use(T)},He.useActionState=function(T,B,O){return L.H.useActionState(T,B,O)},He.useCallback=function(T,B){return L.H.useCallback(T,B)},He.useContext=function(T){return L.H.useContext(T)},He.useDebugValue=function(){},He.useDeferredValue=function(T,B){return L.H.useDeferredValue(T,B)},He.useEffect=function(T,B){return L.H.useEffect(T,B)},He.useEffectEvent=function(T){return L.H.useEffectEvent(T)},He.useId=function(){return L.H.useId()},He.useImperativeHandle=function(T,B,O){return L.H.useImperativeHandle(T,B,O)},He.useInsertionEffect=function(T,B){return L.H.useInsertionEffect(T,B)},He.useLayoutEffect=function(T,B){return L.H.useLayoutEffect(T,B)},He.useMemo=function(T,B){return L.H.useMemo(T,B)},He.useOptimistic=function(T,B){return L.H.useOptimistic(T,B)},He.useReducer=function(T,B,O){return L.H.useReducer(T,B,O)},He.useRef=function(T){return L.H.useRef(T)},He.useState=function(T){return L.H.useState(T)},He.useSyncExternalStore=function(T,B,O){return L.H.useSyncExternalStore(T,B,O)},He.useTransition=function(){return L.H.useTransition()},He.version="19.2.0",He}var Og;function Bu(){return Og||(Og=1,fu.exports=xb()),fu.exports}var hu={exports:{}},Kt={};var kg;function _b(){if(kg)return Kt;kg=1;var o=Bu();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var l={d:{f:r,r:function(){throw Error(a(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,b){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:x==null?null:""+x,children:p,containerInfo:m,implementation:b}}var h=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Kt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Kt.createPortal=function(p,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,b)},Kt.flushSync=function(p){var m=h.T,b=l.p;try{if(h.T=null,l.p=2,p)return p()}finally{h.T=m,l.p=b,l.d.f()}},Kt.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},Kt.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Kt.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var b=m.as,x=g(b,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,v=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;b==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:v}):b==="script"&&l.d.X(p,{crossOrigin:x,integrity:_,fetchPriority:v,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Kt.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var b=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},Kt.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var b=m.as,x=g(b,m.crossOrigin);l.d.L(p,b,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Kt.preloadModule=function(p,m){if(typeof p=="string")if(m){var b=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},Kt.requestFormReset=function(p){l.d.r(p)},Kt.unstable_batchedUpdates=function(p,m){return p(m)},Kt.useFormState=function(p,m,b){return h.H.useFormState(p,m,b)},Kt.useFormStatus=function(){return h.H.useHostTransitionStatus()},Kt.version="19.2.0",Kt}var zg;function pp(){if(zg)return hu.exports;zg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),hu.exports=_b(),hu.exports}var Ug;function jb(){if(Ug)return fs;Ug=1;var o=vb(),a=Bu(),r=pp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,s=t;;){var c=n.return;if(c===null)break;var f=c.alternate;if(f===null){if(s=c.return,s!==null){n=s;continue}break}if(c.child===f.child){for(f=c.child;f;){if(f===n)return p(c),e;if(f===s)return p(c),t;f=f.sibling}throw Error(l(188))}if(n.return!==s.return)n=c,s=f;else{for(var y=!1,S=c.child;S;){if(S===n){y=!0,n=c,s=f;break}if(S===s){y=!0,s=c,n=f;break}S=S.sibling}if(!y){for(S=f.child;S;){if(S===n){y=!0,n=f,s=c;break}if(S===s){y=!0,s=f,n=c;break}S=S.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==s)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function b(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=b(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,_=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),M=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),ce=Symbol.for("react.activity"),ve=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function de(e){return e===null||typeof e!="object"?null:(e=Z&&e[Z]||e["@@iterator"],typeof e=="function"?e:null)}var H=Symbol.for("react.client.reference");function ee(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===H?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case N:return"Fragment";case A:return"Profiler";case R:return"StrictMode";case E:return"Suspense";case D:return"SuspenseList";case ce:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case M:return e.displayName||"Context";case $:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case L:return t=e.displayName||null,t!==null?t:ee(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return ee(e(t))}catch{}}return null}var Y=Array.isArray,C=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},me=[],K=-1;function T(e){return{current:e}}function B(e){0>K||(e.current=me[K],me[K]=null,K--)}function O(e,t){K++,me[K]=e.current,e.current=t}var P=T(null),ie=T(null),oe=T(null),k=T(null);function re(e,t){switch(O(oe,t),O(ie,e),O(P,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Jh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Jh(t),e=Qh(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(P),O(P,e)}function be(){B(P),B(ie),B(oe)}function Ee(e){e.memoizedState!==null&&O(k,e);var t=P.current,n=Qh(t,e.type);t!==n&&(O(ie,e),O(P,n))}function we(e){ie.current===e&&(B(P),B(ie)),k.current===e&&(B(k),ls._currentValue=X)}var Re,ze;function Fe(e){if(Re===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Re=t&&t[1]||"",ze=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Re+e+ze}var xt=!1;function At(e,t){if(!e||xt)return"";xt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var ge=function(){throw Error()};if(Object.defineProperty(ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ge,[])}catch(ne){var W=ne}Reflect.construct(e,[],ge)}else{try{ge.call()}catch(ne){W=ne}e.call(ge.prototype)}}else{try{throw Error()}catch(ne){W=ne}(ge=e())&&typeof ge.catch=="function"&&ge.catch(function(){})}}catch(ne){if(ne&&W&&typeof ne.stack=="string")return[ne.stack,W.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=s.DetermineComponentFrameRoot(),y=f[0],S=f[1];if(y&&S){var U=y.split(`
`),Q=S.split(`
`);for(c=s=0;s<U.length&&!U[s].includes("DetermineComponentFrameRoot");)s++;for(;c<Q.length&&!Q[c].includes("DetermineComponentFrameRoot");)c++;if(s===U.length||c===Q.length)for(s=U.length-1,c=Q.length-1;1<=s&&0<=c&&U[s]!==Q[c];)c--;for(;1<=s&&0<=c;s--,c--)if(U[s]!==Q[c]){if(s!==1||c!==1)do if(s--,c--,0>c||U[s]!==Q[c]){var le=`
`+U[s].replace(" at new "," at ");return e.displayName&&le.includes("<anonymous>")&&(le=le.replace("<anonymous>",e.displayName)),le}while(1<=s&&0<=c);break}}}finally{xt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Fe(n):""}function pt(e,t){switch(e.tag){case 26:case 27:case 5:return Fe(e.type);case 16:return Fe("Lazy");case 13:return e.child!==t&&t!==null?Fe("Suspense Fallback"):Fe("Suspense");case 19:return Fe("SuspenseList");case 0:case 15:return At(e.type,!1);case 11:return At(e.type.render,!1);case 1:return At(e.type,!0);case 31:return Fe("Activity");default:return""}}function qt(e){try{var t="",n=null;do t+=pt(e,n),n=e,e=e.return;while(e);return t}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}var Bt=Object.prototype.hasOwnProperty,it=o.unstable_scheduleCallback,nt=o.unstable_cancelCallback,Dn=o.unstable_shouldYield,pa=o.unstable_requestPaint,Lt=o.unstable_now,no=o.unstable_getCurrentPriorityLevel,Fa=o.unstable_ImmediatePriority,_s=o.unstable_UserBlockingPriority,Ka=o.unstable_NormalPriority,yr=o.unstable_LowPriority,js=o.unstable_IdlePriority,wi=o.log,ao=o.unstable_setDisableYieldValue,Kn=null,Gt=null;function gn(e){if(typeof wi=="function"&&ao(e),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(Kn,e)}catch{}}var Jt=Math.clz32?Math.clz32:ws,Ss=Math.log,Ei=Math.LN2;function ws(e){return e>>>=0,e===0?32:31-(Ss(e)/Ei|0)|0}var Ci=256,Ya=262144,Ti=4194304;function Yn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ja(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var c=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var S=s&134217727;return S!==0?(s=S&~f,s!==0?c=Yn(s):(y&=S,y!==0?c=Yn(y):n||(n=S&~e,n!==0&&(c=Yn(n))))):(S=s&~f,S!==0?c=Yn(S):y!==0?c=Yn(y):n||(n=s&~e,n!==0&&(c=Yn(n)))),c===0?0:t!==0&&t!==c&&(t&f)===0&&(f=c&-c,n=t&-t,f>=n||f===32&&(n&4194048)!==0)?t:c}function Cn(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function io(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Es(){var e=Ti;return Ti<<=1,(Ti&62914560)===0&&(Ti=4194304),e}function br(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Qa(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Cs(e,t,n,s,c,f){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var S=e.entanglements,U=e.expirationTimes,Q=e.hiddenUpdates;for(n=y&~n;0<n;){var le=31-Jt(n),ge=1<<le;S[le]=0,U[le]=-1;var W=Q[le];if(W!==null)for(Q[le]=null,le=0;le<W.length;le++){var ne=W[le];ne!==null&&(ne.lane&=-536870913)}n&=~ge}s!==0&&vr(e,s,0),f!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function vr(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-Jt(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&261930}function xr(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Jt(n),c=1<<s;c&t|e[s]&t&&(e[s]|=t),n&=~c}}function Ts(e,t){var n=t&-t;return n=(n&42)!==0?1:Tn(n),(n&(e.suspendedLanes|t))!==0?0:n}function Tn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function An(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function _r(){var e=z.p;return e!==0?e:(e=window.event,e===void 0?32:vg(e.type))}function As(e,t){var n=z.p;try{return z.p=e,t()}finally{z.p=n}}var Bn=Math.random().toString(36).slice(2),wt="__reactFiber$"+Bn,Ft="__reactProps$"+Bn,Ln="__reactContainer$"+Bn,Xa="__reactEvents$"+Bn,ma="__reactListeners$"+Bn,ro="__reactHandles$"+Bn,Ns="__reactResources$"+Bn,Za="__reactMarker$"+Bn;function Ai(e){delete e[wt],delete e[Ft],delete e[Xa],delete e[ma],delete e[ro]}function ya(e){var t=e[wt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ln]||n[wt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ag(e);e!==null;){if(n=e[wt])return n;e=ag(e)}return t}e=n,n=e.parentNode}return null}function Mn(e){if(e=e[wt]||e[Ln]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function an(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function ba(e){var t=e[Ns];return t||(t=e[Ns]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Et(e){e[Za]=!0}var jr=new Set,Rs={};function Jn(e,t){va(e,t),va(e+"Capture",t)}function va(e,t){for(Rs[e]=t,e=0;e<t.length;e++)jr.add(t[e])}var V=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fe={},xe={};function ae(e){return Bt.call(xe,e)?!0:Bt.call(fe,e)?!1:V.test(e)?xe[e]=!0:(fe[e]=!0,!1)}function pe(e,t,n){if(ae(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function je(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function _e(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}function se(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ye(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ue(e,t,n){var s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var c=s.get,f=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Se(e){if(!e._valueTracker){var t=ye(e)?"checked":"value";e._valueTracker=ue(e,t,""+e[t])}}function Ue(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=ye(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Ae(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ft=/[\n"\\]/g;function mt(e){return e.replace(ft,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Ie(e,t,n,s,c,f,y,S){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+se(t)):e.value!==""+se(t)&&(e.value=""+se(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?yt(e,y,se(t)):n!=null?yt(e,y,se(n)):s!=null&&e.removeAttribute("value"),c==null&&f!=null&&(e.defaultChecked=!!f),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.name=""+se(S):e.removeAttribute("name")}function Ze(e,t,n,s,c,f,y,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||n!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){Se(e);return}n=n!=null?""+se(n):"",t=t!=null?""+se(t):n,S||t===e.value||(e.value=t),e.defaultValue=t}s=s??c,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=S?e.checked:!!s,e.defaultChecked=!!s,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Se(e)}function yt(e,t,n){t==="number"&&Ae(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function _t(e,t,n,s){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&s&&(e[n].defaultSelected=!0)}else{for(n=""+se(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,s&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function qn(e,t,n){if(t!=null&&(t=""+se(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+se(n):""}function Sr(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(l(92));if(Y(s)){if(1<s.length)throw Error(l(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=se(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s),Se(e)}function In(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Wa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hn(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||Wa.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ce(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var c in t)s=t[c],t.hasOwnProperty(c)&&n[c]!==s&&Hn(e,c,s)}else for(var f in t)t.hasOwnProperty(f)&&Hn(e,f,t[f])}function qe(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var We=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ke=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pe(e){return ke.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Ge(){}var Qn=null;function Xn(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ni=null,Ri=null;function Ku(e){var t=Mn(e);if(t&&(e=t.stateNode)){var n=e[Ft]||null;e:switch(e=t.stateNode,t.type){case"input":if(Ie(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+mt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var c=s[Ft]||null;if(!c)throw Error(l(90));Ie(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&Ue(s)}break e;case"textarea":qn(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&_t(e,!!n.multiple,t,!1)}}}var so=!1;function Yu(e,t,n){if(so)return e(t,n);so=!0;try{var s=e(t);return s}finally{if(so=!1,(Ni!==null||Ri!==null)&&(yl(),Ni&&(t=Ni,e=Ri,Ri=Ni=null,Ku(t),e)))for(t=0;t<e.length;t++)Ku(e[t])}}function wr(e,t){var n=e.stateNode;if(n===null)return null;var s=n[Ft]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lo=!1;if(Zn)try{var Er={};Object.defineProperty(Er,"passive",{get:function(){lo=!0}}),window.addEventListener("test",Er,Er),window.removeEventListener("test",Er,Er)}catch{lo=!1}var xa=null,oo=null,Os=null;function Ju(){if(Os)return Os;var e,t=oo,n=t.length,s,c="value"in xa?xa.value:xa.textContent,f=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(s=1;s<=y&&t[n-s]===c[f-s];s++);return Os=c.slice(e,1<s?1-s:void 0)}function ks(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zs(){return!0}function Qu(){return!1}function Xt(e){function t(n,s,c,f,y){this._reactName=n,this._targetInst=c,this.type=s,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(n=e[S],this[S]=n?n(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?zs:Qu,this.isPropagationStopped=Qu,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zs)},persist:function(){},isPersistent:zs}),t}var ei={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Us=Xt(ei),Cr=x({},ei,{view:0,detail:0}),fm=Xt(Cr),co,uo,Tr,Ds=x({},Cr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ho,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Tr&&(Tr&&e.type==="mousemove"?(co=e.screenX-Tr.screenX,uo=e.screenY-Tr.screenY):uo=co=0,Tr=e),co)},movementY:function(e){return"movementY"in e?e.movementY:uo}}),Xu=Xt(Ds),hm=x({},Ds,{dataTransfer:0}),gm=Xt(hm),pm=x({},Cr,{relatedTarget:0}),fo=Xt(pm),mm=x({},ei,{animationName:0,elapsedTime:0,pseudoElement:0}),ym=Xt(mm),bm=x({},ei,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vm=Xt(bm),xm=x({},ei,{data:0}),Zu=Xt(xm),_m={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Sm[e])?!!t[e]:!1}function ho(){return wm}var Em=x({},Cr,{key:function(e){if(e.key){var t=_m[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ks(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?jm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ho,charCode:function(e){return e.type==="keypress"?ks(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ks(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Cm=Xt(Em),Tm=x({},Ds,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wu=Xt(Tm),Am=x({},Cr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ho}),Nm=Xt(Am),Rm=x({},ei,{propertyName:0,elapsedTime:0,pseudoElement:0}),Om=Xt(Rm),km=x({},Ds,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zm=Xt(km),Um=x({},ei,{newState:0,oldState:0}),Dm=Xt(Um),Bm=[9,13,27,32],go=Zn&&"CompositionEvent"in window,Ar=null;Zn&&"documentMode"in document&&(Ar=document.documentMode);var Lm=Zn&&"TextEvent"in window&&!Ar,ed=Zn&&(!go||Ar&&8<Ar&&11>=Ar),td=" ",nd=!1;function ad(e,t){switch(e){case"keyup":return Bm.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function id(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Oi=!1;function Mm(e,t){switch(e){case"compositionend":return id(t);case"keypress":return t.which!==32?null:(nd=!0,td);case"textInput":return e=t.data,e===td&&nd?null:e;default:return null}}function qm(e,t){if(Oi)return e==="compositionend"||!go&&ad(e,t)?(e=Ju(),Os=oo=xa=null,Oi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ed&&t.locale!=="ko"?null:t.data;default:return null}}var Im={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Im[e.type]:t==="textarea"}function sd(e,t,n,s){Ni?Ri?Ri.push(s):Ri=[s]:Ni=s,t=wl(t,"onChange"),0<t.length&&(n=new Us("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Nr=null,Rr=null;function Hm(e){Ph(e,0)}function Bs(e){var t=an(e);if(Ue(t))return e}function ld(e,t){if(e==="change")return t}var od=!1;if(Zn){var po;if(Zn){var mo="oninput"in document;if(!mo){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),mo=typeof cd.oninput=="function"}po=mo}else po=!1;od=po&&(!document.documentMode||9<document.documentMode)}function ud(){Nr&&(Nr.detachEvent("onpropertychange",dd),Rr=Nr=null)}function dd(e){if(e.propertyName==="value"&&Bs(Rr)){var t=[];sd(t,Rr,e,Xn(e)),Yu(Hm,t)}}function $m(e,t,n){e==="focusin"?(ud(),Nr=t,Rr=n,Nr.attachEvent("onpropertychange",dd)):e==="focusout"&&ud()}function Pm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Bs(Rr)}function Vm(e,t){if(e==="click")return Bs(t)}function Gm(e,t){if(e==="input"||e==="change")return Bs(t)}function Fm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rn=typeof Object.is=="function"?Object.is:Fm;function Or(e,t){if(rn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var c=n[s];if(!Bt.call(t,c)||!rn(e[c],t[c]))return!1}return!0}function fd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hd(e,t){var n=fd(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fd(n)}}function gd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?gd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Ae(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ae(e.document)}return t}function yo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Km=Zn&&"documentMode"in document&&11>=document.documentMode,ki=null,bo=null,kr=null,vo=!1;function md(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;vo||ki==null||ki!==Ae(s)||(s=ki,"selectionStart"in s&&yo(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),kr&&Or(kr,s)||(kr=s,s=wl(bo,"onSelect"),0<s.length&&(t=new Us("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=ki)))}function ti(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var zi={animationend:ti("Animation","AnimationEnd"),animationiteration:ti("Animation","AnimationIteration"),animationstart:ti("Animation","AnimationStart"),transitionrun:ti("Transition","TransitionRun"),transitionstart:ti("Transition","TransitionStart"),transitioncancel:ti("Transition","TransitionCancel"),transitionend:ti("Transition","TransitionEnd")},xo={},yd={};Zn&&(yd=document.createElement("div").style,"AnimationEvent"in window||(delete zi.animationend.animation,delete zi.animationiteration.animation,delete zi.animationstart.animation),"TransitionEvent"in window||delete zi.transitionend.transition);function ni(e){if(xo[e])return xo[e];if(!zi[e])return e;var t=zi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in yd)return xo[e]=t[n];return e}var bd=ni("animationend"),vd=ni("animationiteration"),xd=ni("animationstart"),Ym=ni("transitionrun"),Jm=ni("transitionstart"),Qm=ni("transitioncancel"),_d=ni("transitionend"),jd=new Map,_o="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");_o.push("scrollEnd");function Nn(e,t){jd.set(e,t),Jn(t,[e])}var Ls=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},pn=[],Ui=0,jo=0;function Ms(){for(var e=Ui,t=jo=Ui=0;t<e;){var n=pn[t];pn[t++]=null;var s=pn[t];pn[t++]=null;var c=pn[t];pn[t++]=null;var f=pn[t];if(pn[t++]=null,s!==null&&c!==null){var y=s.pending;y===null?c.next=c:(c.next=y.next,y.next=c),s.pending=c}f!==0&&Sd(n,c,f)}}function qs(e,t,n,s){pn[Ui++]=e,pn[Ui++]=t,pn[Ui++]=n,pn[Ui++]=s,jo|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function So(e,t,n,s){return qs(e,t,n,s),Is(e)}function ai(e,t){return qs(e,null,null,t),Is(e)}function Sd(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var c=!1,f=e.return;f!==null;)f.childLanes|=n,s=f.alternate,s!==null&&(s.childLanes|=n),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(c=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,c&&t!==null&&(c=31-Jt(n),e=f.hiddenUpdates,s=e[c],s===null?e[c]=[t]:s.push(t),t.lane=n|536870912),f):null}function Is(e){if(50<es)throw es=0,kc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Di={};function Xm(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(e,t,n,s){return new Xm(e,t,n,s)}function wo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Wn(e,t){var n=e.alternate;return n===null?(n=sn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function wd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Hs(e,t,n,s,c,f){var y=0;if(s=e,typeof e=="function")wo(e)&&(y=1);else if(typeof e=="string")y=nb(e,n,P.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ce:return e=sn(31,n,t,c),e.elementType=ce,e.lanes=f,e;case N:return ii(n.children,c,f,t);case R:y=8,c|=24;break;case A:return e=sn(12,n,t,c|2),e.elementType=A,e.lanes=f,e;case E:return e=sn(13,n,t,c),e.elementType=E,e.lanes=f,e;case D:return e=sn(19,n,t,c),e.elementType=D,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:y=10;break e;case $:y=9;break e;case G:y=11;break e;case L:y=14;break e;case I:y=16,s=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),s=null}return t=sn(y,n,t,c),t.elementType=e,t.type=s,t.lanes=f,t}function ii(e,t,n,s){return e=sn(7,e,s,t),e.lanes=n,e}function Eo(e,t,n){return e=sn(6,e,null,t),e.lanes=n,e}function Ed(e){var t=sn(18,null,null,0);return t.stateNode=e,t}function Co(e,t,n){return t=sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Cd=new WeakMap;function mn(e,t){if(typeof e=="object"&&e!==null){var n=Cd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:qt(t)},Cd.set(e,t),t)}return{value:e,source:t,stack:qt(t)}}var Bi=[],Li=0,$s=null,zr=0,yn=[],bn=0,_a=null,$n=1,Pn="";function ea(e,t){Bi[Li++]=zr,Bi[Li++]=$s,$s=e,zr=t}function Td(e,t,n){yn[bn++]=$n,yn[bn++]=Pn,yn[bn++]=_a,_a=e;var s=$n;e=Pn;var c=32-Jt(s)-1;s&=~(1<<c),n+=1;var f=32-Jt(t)+c;if(30<f){var y=c-c%5;f=(s&(1<<y)-1).toString(32),s>>=y,c-=y,$n=1<<32-Jt(t)+c|n<<c|s,Pn=f+e}else $n=1<<f|n<<c|s,Pn=e}function To(e){e.return!==null&&(ea(e,1),Td(e,1,0))}function Ao(e){for(;e===$s;)$s=Bi[--Li],Bi[Li]=null,zr=Bi[--Li],Bi[Li]=null;for(;e===_a;)_a=yn[--bn],yn[bn]=null,Pn=yn[--bn],yn[bn]=null,$n=yn[--bn],yn[bn]=null}function Ad(e,t){yn[bn++]=$n,yn[bn++]=Pn,yn[bn++]=_a,$n=t.id,Pn=t.overflow,_a=e}var It=null,ht=null,Xe=!1,ja=null,vn=!1,No=Error(l(519));function Sa(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ur(mn(t,e)),No}function Nd(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[wt]=e,t[Ft]=s,n){case"dialog":Ye("cancel",t),Ye("close",t);break;case"iframe":case"object":case"embed":Ye("load",t);break;case"video":case"audio":for(n=0;n<ns.length;n++)Ye(ns[n],t);break;case"source":Ye("error",t);break;case"img":case"image":case"link":Ye("error",t),Ye("load",t);break;case"details":Ye("toggle",t);break;case"input":Ye("invalid",t),Ze(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0);break;case"select":Ye("invalid",t);break;case"textarea":Ye("invalid",t),Sr(t,s.value,s.defaultValue,s.children)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||Kh(t.textContent,n)?(s.popover!=null&&(Ye("beforetoggle",t),Ye("toggle",t)),s.onScroll!=null&&Ye("scroll",t),s.onScrollEnd!=null&&Ye("scrollend",t),s.onClick!=null&&(t.onclick=Ge),t=!0):t=!1,t||Sa(e,!0)}function Rd(e){for(It=e.return;It;)switch(It.tag){case 5:case 31:case 13:vn=!1;return;case 27:case 3:vn=!0;return;default:It=It.return}}function Mi(e){if(e!==It)return!1;if(!Xe)return Rd(e),Xe=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Kc(e.type,e.memoizedProps)),n=!n),n&&ht&&Sa(e),Rd(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ht=ng(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ht=ng(e)}else t===27?(t=ht,La(e.type)?(e=Zc,Zc=null,ht=e):ht=t):ht=It?_n(e.stateNode.nextSibling):null;return!0}function ri(){ht=It=null,Xe=!1}function Ro(){var e=ja;return e!==null&&(tn===null?tn=e:tn.push.apply(tn,e),ja=null),e}function Ur(e){ja===null?ja=[e]:ja.push(e)}var Oo=T(null),si=null,ta=null;function wa(e,t,n){O(Oo,t._currentValue),t._currentValue=n}function na(e){e._currentValue=Oo.current,B(Oo)}function ko(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function zo(e,t,n,s){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){var y=c.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=c;for(var U=0;U<t.length;U++)if(S.context===t[U]){f.lanes|=n,S=f.alternate,S!==null&&(S.lanes|=n),ko(f.return,n,e),s||(y=null);break e}f=S.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,f=y.alternate,f!==null&&(f.lanes|=n),ko(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function qi(e,t,n,s){e=null;for(var c=t,f=!1;c!==null;){if(!f){if((c.flags&524288)!==0)f=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var S=c.type;rn(c.pendingProps.value,y.value)||(e!==null?e.push(S):e=[S])}}else if(c===k.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(ls):e=[ls])}c=c.return}e!==null&&zo(t,e,n,s),t.flags|=262144}function Ps(e){for(e=e.firstContext;e!==null;){if(!rn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function li(e){si=e,ta=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Ht(e){return Od(si,e)}function Vs(e,t){return si===null&&li(e),Od(e,t)}function Od(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},ta===null){if(e===null)throw Error(l(308));ta=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ta=ta.next=t;return n}var Zm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Wm=o.unstable_scheduleCallback,ey=o.unstable_NormalPriority,Nt={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uo(){return{controller:new Zm,data:new Map,refCount:0}}function Dr(e){e.refCount--,e.refCount===0&&Wm(ey,function(){e.controller.abort()})}var Br=null,Do=0,Ii=0,Hi=null;function ty(e,t){if(Br===null){var n=Br=[];Do=0,Ii=Mc(),Hi={status:"pending",value:void 0,then:function(s){n.push(s)}}}return Do++,t.then(kd,kd),t}function kd(){if(--Do===0&&Br!==null){Hi!==null&&(Hi.status="fulfilled");var e=Br;Br=null,Ii=0,Hi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function ny(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(s.status="rejected",s.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),s}var zd=C.S;C.S=function(e,t){yh=Lt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&ty(e,t),zd!==null&&zd(e,t)};var oi=T(null);function Bo(){var e=oi.current;return e!==null?e:ut.pooledCache}function Gs(e,t){t===null?O(oi,oi.current):O(oi,t.pool)}function Ud(){var e=Bo();return e===null?null:{parent:Nt._currentValue,pool:e}}var $i=Error(l(460)),Lo=Error(l(474)),Fs=Error(l(542)),Ks={then:function(){}};function Dd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Bd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Ge,Ge),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Md(e),e;default:if(typeof t.status=="string")t.then(Ge,Ge);else{if(e=ut,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=s}},function(s){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Md(e),e}throw ui=t,$i}}function ci(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(ui=n,$i):n}}var ui=null;function Ld(){if(ui===null)throw Error(l(459));var e=ui;return ui=null,e}function Md(e){if(e===$i||e===Fs)throw Error(l(483))}var Pi=null,Lr=0;function Ys(e){var t=Lr;return Lr+=1,Pi===null&&(Pi=[]),Bd(Pi,e,t)}function Mr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Js(e,t){throw t.$$typeof===_?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function qd(e){function t(F,q){if(e){var J=F.deletions;J===null?(F.deletions=[q],F.flags|=16):J.push(q)}}function n(F,q){if(!e)return null;for(;q!==null;)t(F,q),q=q.sibling;return null}function s(F){for(var q=new Map;F!==null;)F.key!==null?q.set(F.key,F):q.set(F.index,F),F=F.sibling;return q}function c(F,q){return F=Wn(F,q),F.index=0,F.sibling=null,F}function f(F,q,J){return F.index=J,e?(J=F.alternate,J!==null?(J=J.index,J<q?(F.flags|=67108866,q):J):(F.flags|=67108866,q)):(F.flags|=1048576,q)}function y(F){return e&&F.alternate===null&&(F.flags|=67108866),F}function S(F,q,J,he){return q===null||q.tag!==6?(q=Eo(J,F.mode,he),q.return=F,q):(q=c(q,J),q.return=F,q)}function U(F,q,J,he){var Be=J.type;return Be===N?le(F,q,J.props.children,he,J.key):q!==null&&(q.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===I&&ci(Be)===q.type)?(q=c(q,J.props),Mr(q,J),q.return=F,q):(q=Hs(J.type,J.key,J.props,null,F.mode,he),Mr(q,J),q.return=F,q)}function Q(F,q,J,he){return q===null||q.tag!==4||q.stateNode.containerInfo!==J.containerInfo||q.stateNode.implementation!==J.implementation?(q=Co(J,F.mode,he),q.return=F,q):(q=c(q,J.children||[]),q.return=F,q)}function le(F,q,J,he,Be){return q===null||q.tag!==7?(q=ii(J,F.mode,he,Be),q.return=F,q):(q=c(q,J),q.return=F,q)}function ge(F,q,J){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=Eo(""+q,F.mode,J),q.return=F,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case v:return J=Hs(q.type,q.key,q.props,null,F.mode,J),Mr(J,q),J.return=F,J;case w:return q=Co(q,F.mode,J),q.return=F,q;case I:return q=ci(q),ge(F,q,J)}if(Y(q)||de(q))return q=ii(q,F.mode,J,null),q.return=F,q;if(typeof q.then=="function")return ge(F,Ys(q),J);if(q.$$typeof===M)return ge(F,Vs(F,q),J);Js(F,q)}return null}function W(F,q,J,he){var Be=q!==null?q.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return Be!==null?null:S(F,q,""+J,he);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case v:return J.key===Be?U(F,q,J,he):null;case w:return J.key===Be?Q(F,q,J,he):null;case I:return J=ci(J),W(F,q,J,he)}if(Y(J)||de(J))return Be!==null?null:le(F,q,J,he,null);if(typeof J.then=="function")return W(F,q,Ys(J),he);if(J.$$typeof===M)return W(F,q,Vs(F,J),he);Js(F,J)}return null}function ne(F,q,J,he,Be){if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return F=F.get(J)||null,S(q,F,""+he,Be);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case v:return F=F.get(he.key===null?J:he.key)||null,U(q,F,he,Be);case w:return F=F.get(he.key===null?J:he.key)||null,Q(q,F,he,Be);case I:return he=ci(he),ne(F,q,J,he,Be)}if(Y(he)||de(he))return F=F.get(J)||null,le(q,F,he,Be,null);if(typeof he.then=="function")return ne(F,q,J,Ys(he),Be);if(he.$$typeof===M)return ne(F,q,J,Vs(q,he),Be);Js(q,he)}return null}function Te(F,q,J,he){for(var Be=null,et=null,Ne=q,Ve=q=0,Qe=null;Ne!==null&&Ve<J.length;Ve++){Ne.index>Ve?(Qe=Ne,Ne=null):Qe=Ne.sibling;var tt=W(F,Ne,J[Ve],he);if(tt===null){Ne===null&&(Ne=Qe);break}e&&Ne&&tt.alternate===null&&t(F,Ne),q=f(tt,q,Ve),et===null?Be=tt:et.sibling=tt,et=tt,Ne=Qe}if(Ve===J.length)return n(F,Ne),Xe&&ea(F,Ve),Be;if(Ne===null){for(;Ve<J.length;Ve++)Ne=ge(F,J[Ve],he),Ne!==null&&(q=f(Ne,q,Ve),et===null?Be=Ne:et.sibling=Ne,et=Ne);return Xe&&ea(F,Ve),Be}for(Ne=s(Ne);Ve<J.length;Ve++)Qe=ne(Ne,F,Ve,J[Ve],he),Qe!==null&&(e&&Qe.alternate!==null&&Ne.delete(Qe.key===null?Ve:Qe.key),q=f(Qe,q,Ve),et===null?Be=Qe:et.sibling=Qe,et=Qe);return e&&Ne.forEach(function($a){return t(F,$a)}),Xe&&ea(F,Ve),Be}function Le(F,q,J,he){if(J==null)throw Error(l(151));for(var Be=null,et=null,Ne=q,Ve=q=0,Qe=null,tt=J.next();Ne!==null&&!tt.done;Ve++,tt=J.next()){Ne.index>Ve?(Qe=Ne,Ne=null):Qe=Ne.sibling;var $a=W(F,Ne,tt.value,he);if($a===null){Ne===null&&(Ne=Qe);break}e&&Ne&&$a.alternate===null&&t(F,Ne),q=f($a,q,Ve),et===null?Be=$a:et.sibling=$a,et=$a,Ne=Qe}if(tt.done)return n(F,Ne),Xe&&ea(F,Ve),Be;if(Ne===null){for(;!tt.done;Ve++,tt=J.next())tt=ge(F,tt.value,he),tt!==null&&(q=f(tt,q,Ve),et===null?Be=tt:et.sibling=tt,et=tt);return Xe&&ea(F,Ve),Be}for(Ne=s(Ne);!tt.done;Ve++,tt=J.next())tt=ne(Ne,F,Ve,tt.value,he),tt!==null&&(e&&tt.alternate!==null&&Ne.delete(tt.key===null?Ve:tt.key),q=f(tt,q,Ve),et===null?Be=tt:et.sibling=tt,et=tt);return e&&Ne.forEach(function(hb){return t(F,hb)}),Xe&&ea(F,Ve),Be}function ct(F,q,J,he){if(typeof J=="object"&&J!==null&&J.type===N&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case v:e:{for(var Be=J.key;q!==null;){if(q.key===Be){if(Be=J.type,Be===N){if(q.tag===7){n(F,q.sibling),he=c(q,J.props.children),he.return=F,F=he;break e}}else if(q.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===I&&ci(Be)===q.type){n(F,q.sibling),he=c(q,J.props),Mr(he,J),he.return=F,F=he;break e}n(F,q);break}else t(F,q);q=q.sibling}J.type===N?(he=ii(J.props.children,F.mode,he,J.key),he.return=F,F=he):(he=Hs(J.type,J.key,J.props,null,F.mode,he),Mr(he,J),he.return=F,F=he)}return y(F);case w:e:{for(Be=J.key;q!==null;){if(q.key===Be)if(q.tag===4&&q.stateNode.containerInfo===J.containerInfo&&q.stateNode.implementation===J.implementation){n(F,q.sibling),he=c(q,J.children||[]),he.return=F,F=he;break e}else{n(F,q);break}else t(F,q);q=q.sibling}he=Co(J,F.mode,he),he.return=F,F=he}return y(F);case I:return J=ci(J),ct(F,q,J,he)}if(Y(J))return Te(F,q,J,he);if(de(J)){if(Be=de(J),typeof Be!="function")throw Error(l(150));return J=Be.call(J),Le(F,q,J,he)}if(typeof J.then=="function")return ct(F,q,Ys(J),he);if(J.$$typeof===M)return ct(F,q,Vs(F,J),he);Js(F,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,q!==null&&q.tag===6?(n(F,q.sibling),he=c(q,J),he.return=F,F=he):(n(F,q),he=Eo(J,F.mode,he),he.return=F,F=he),y(F)):n(F,q)}return function(F,q,J,he){try{Lr=0;var Be=ct(F,q,J,he);return Pi=null,Be}catch(Ne){if(Ne===$i||Ne===Fs)throw Ne;var et=sn(29,Ne,null,F.mode);return et.lanes=he,et.return=F,et}finally{}}}var di=qd(!0),Id=qd(!1),Ea=!1;function Mo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ca(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ta(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(at&2)!==0){var c=s.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),s.pending=t,t=Is(e),Sd(e,null,n),t}return qs(e,s,t,n),Is(e)}function qr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,xr(e,n)}}function Io(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var c=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};f===null?c=f=y:f=f.next=y,n=n.next}while(n!==null);f===null?c=f=t:f=f.next=t}else c=f=t;n={baseState:s.baseState,firstBaseUpdate:c,lastBaseUpdate:f,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Ho=!1;function Ir(){if(Ho){var e=Hi;if(e!==null)throw e}}function Hr(e,t,n,s){Ho=!1;var c=e.updateQueue;Ea=!1;var f=c.firstBaseUpdate,y=c.lastBaseUpdate,S=c.shared.pending;if(S!==null){c.shared.pending=null;var U=S,Q=U.next;U.next=null,y===null?f=Q:y.next=Q,y=U;var le=e.alternate;le!==null&&(le=le.updateQueue,S=le.lastBaseUpdate,S!==y&&(S===null?le.firstBaseUpdate=Q:S.next=Q,le.lastBaseUpdate=U))}if(f!==null){var ge=c.baseState;y=0,le=Q=U=null,S=f;do{var W=S.lane&-536870913,ne=W!==S.lane;if(ne?(Je&W)===W:(s&W)===W){W!==0&&W===Ii&&(Ho=!0),le!==null&&(le=le.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Te=e,Le=S;W=t;var ct=n;switch(Le.tag){case 1:if(Te=Le.payload,typeof Te=="function"){ge=Te.call(ct,ge,W);break e}ge=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Le.payload,W=typeof Te=="function"?Te.call(ct,ge,W):Te,W==null)break e;ge=x({},ge,W);break e;case 2:Ea=!0}}W=S.callback,W!==null&&(e.flags|=64,ne&&(e.flags|=8192),ne=c.callbacks,ne===null?c.callbacks=[W]:ne.push(W))}else ne={lane:W,tag:S.tag,payload:S.payload,callback:S.callback,next:null},le===null?(Q=le=ne,U=ge):le=le.next=ne,y|=W;if(S=S.next,S===null){if(S=c.shared.pending,S===null)break;ne=S,S=ne.next,ne.next=null,c.lastBaseUpdate=ne,c.shared.pending=null}}while(!0);le===null&&(U=ge),c.baseState=U,c.firstBaseUpdate=Q,c.lastBaseUpdate=le,f===null&&(c.shared.lanes=0),ka|=y,e.lanes=y,e.memoizedState=ge}}function Hd(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function $d(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Hd(n[e],t)}var Vi=T(null),Qs=T(0);function Pd(e,t){e=da,O(Qs,e),O(Vi,t),da=e|t.baseLanes}function $o(){O(Qs,da),O(Vi,Vi.current)}function Po(){da=Qs.current,B(Vi),B(Qs)}var ln=T(null),xn=null;function Aa(e){var t=e.alternate;O(Ct,Ct.current&1),O(ln,e),xn===null&&(t===null||Vi.current!==null||t.memoizedState!==null)&&(xn=e)}function Vo(e){O(Ct,Ct.current),O(ln,e),xn===null&&(xn=e)}function Vd(e){e.tag===22?(O(Ct,Ct.current),O(ln,e),xn===null&&(xn=e)):Na()}function Na(){O(Ct,Ct.current),O(ln,ln.current)}function on(e){B(ln),xn===e&&(xn=null),B(Ct)}var Ct=T(0);function Xs(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Qc(n)||Xc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var aa=0,$e=null,lt=null,Rt=null,Zs=!1,Gi=!1,fi=!1,Ws=0,$r=0,Fi=null,ay=0;function jt(){throw Error(l(321))}function Go(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rn(e[n],t[n]))return!1;return!0}function Fo(e,t,n,s,c,f){return aa=f,$e=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,C.H=e===null||e.memoizedState===null?Af:lc,fi=!1,f=n(s,c),fi=!1,Gi&&(f=Fd(t,n,s,c)),Gd(e),f}function Gd(e){C.H=Gr;var t=lt!==null&&lt.next!==null;if(aa=0,Rt=lt=$e=null,Zs=!1,$r=0,Fi=null,t)throw Error(l(300));e===null||Ot||(e=e.dependencies,e!==null&&Ps(e)&&(Ot=!0))}function Fd(e,t,n,s){$e=e;var c=0;do{if(Gi&&(Fi=null),$r=0,Gi=!1,25<=c)throw Error(l(301));if(c+=1,Rt=lt=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}C.H=Nf,f=t(n,s)}while(Gi);return f}function iy(){var e=C.H,t=e.useState()[0];return t=typeof t.then=="function"?Pr(t):t,e=e.useState()[0],(lt!==null?lt.memoizedState:null)!==e&&($e.flags|=1024),t}function Ko(){var e=Ws!==0;return Ws=0,e}function Yo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Jo(e){if(Zs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Zs=!1}aa=0,Rt=lt=$e=null,Gi=!1,$r=Ws=0,Fi=null}function Qt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?$e.memoizedState=Rt=e:Rt=Rt.next=e,Rt}function Tt(){if(lt===null){var e=$e.alternate;e=e!==null?e.memoizedState:null}else e=lt.next;var t=Rt===null?$e.memoizedState:Rt.next;if(t!==null)Rt=t,lt=e;else{if(e===null)throw $e.alternate===null?Error(l(467)):Error(l(310));lt=e,e={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Rt===null?$e.memoizedState=Rt=e:Rt=Rt.next=e}return Rt}function el(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pr(e){var t=$r;return $r+=1,Fi===null&&(Fi=[]),e=Bd(Fi,e,t),t=$e,(Rt===null?t.memoizedState:Rt.next)===null&&(t=t.alternate,C.H=t===null||t.memoizedState===null?Af:lc),e}function tl(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Pr(e);if(e.$$typeof===M)return Ht(e)}throw Error(l(438,String(e)))}function Qo(e){var t=null,n=$e.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=$e.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=el(),$e.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=ve;return t.index++,n}function ia(e,t){return typeof t=="function"?t(e):t}function nl(e){var t=Tt();return Xo(t,lt,e)}function Xo(e,t,n){var s=e.queue;if(s===null)throw Error(l(311));s.lastRenderedReducer=n;var c=e.baseQueue,f=s.pending;if(f!==null){if(c!==null){var y=c.next;c.next=f.next,f.next=y}t.baseQueue=c=f,s.pending=null}if(f=e.baseState,c===null)e.memoizedState=f;else{t=c.next;var S=y=null,U=null,Q=t,le=!1;do{var ge=Q.lane&-536870913;if(ge!==Q.lane?(Je&ge)===ge:(aa&ge)===ge){var W=Q.revertLane;if(W===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ge===Ii&&(le=!0);else if((aa&W)===W){Q=Q.next,W===Ii&&(le=!0);continue}else ge={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(S=U=ge,y=f):U=U.next=ge,$e.lanes|=W,ka|=W;ge=Q.action,fi&&n(f,ge),f=Q.hasEagerState?Q.eagerState:n(f,ge)}else W={lane:ge,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(S=U=W,y=f):U=U.next=W,$e.lanes|=ge,ka|=ge;Q=Q.next}while(Q!==null&&Q!==t);if(U===null?y=f:U.next=S,!rn(f,e.memoizedState)&&(Ot=!0,le&&(n=Hi,n!==null)))throw n;e.memoizedState=f,e.baseState=y,e.baseQueue=U,s.lastRenderedState=f}return c===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Zo(e){var t=Tt(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var s=n.dispatch,c=n.pending,f=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do f=e(f,y.action),y=y.next;while(y!==c);rn(f,t.memoizedState)||(Ot=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,s]}function Kd(e,t,n){var s=$e,c=Tt(),f=Xe;if(f){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!rn((lt||c).memoizedState,n);if(y&&(c.memoizedState=n,Ot=!0),c=c.queue,tc(Qd.bind(null,s,c,e),[e]),c.getSnapshot!==t||y||Rt!==null&&Rt.memoizedState.tag&1){if(s.flags|=2048,Ki(9,{destroy:void 0},Jd.bind(null,s,c,n,t),null),ut===null)throw Error(l(349));f||(aa&127)!==0||Yd(s,t,n)}return n}function Yd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=$e.updateQueue,t===null?(t=el(),$e.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Jd(e,t,n,s){t.value=n,t.getSnapshot=s,Xd(t)&&Zd(e)}function Qd(e,t,n){return n(function(){Xd(t)&&Zd(e)})}function Xd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rn(e,n)}catch{return!0}}function Zd(e){var t=ai(e,2);t!==null&&nn(t,e,2)}function Wo(e){var t=Qt();if(typeof e=="function"){var n=e;if(e=n(),fi){gn(!0);try{n()}finally{gn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:e},t}function Wd(e,t,n,s){return e.baseState=n,Xo(e,lt,typeof s=="function"?s:ia)}function ry(e,t,n,s,c){if(rl(e))throw Error(l(485));if(e=t.action,e!==null){var f={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};C.T!==null?n(!0):f.isTransition=!1,s(f),n=t.pending,n===null?(f.next=t.pending=f,ef(t,f)):(f.next=n.next,t.pending=n.next=f)}}function ef(e,t){var n=t.action,s=t.payload,c=e.state;if(t.isTransition){var f=C.T,y={};C.T=y;try{var S=n(c,s),U=C.S;U!==null&&U(y,S),tf(e,t,S)}catch(Q){ec(e,t,Q)}finally{f!==null&&y.types!==null&&(f.types=y.types),C.T=f}}else try{f=n(c,s),tf(e,t,f)}catch(Q){ec(e,t,Q)}}function tf(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){nf(e,t,s)},function(s){return ec(e,t,s)}):nf(e,t,n)}function nf(e,t,n){t.status="fulfilled",t.value=n,af(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,ef(e,n)))}function ec(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,af(t),t=t.next;while(t!==s)}e.action=null}function af(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function rf(e,t){return t}function sf(e,t){if(Xe){var n=ut.formState;if(n!==null){e:{var s=$e;if(Xe){if(ht){t:{for(var c=ht,f=vn;c.nodeType!==8;){if(!f){c=null;break t}if(c=_n(c.nextSibling),c===null){c=null;break t}}f=c.data,c=f==="F!"||f==="F"?c:null}if(c){ht=_n(c.nextSibling),s=c.data==="F!";break e}}Sa(s)}s=!1}s&&(t=n[0])}}return n=Qt(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rf,lastRenderedState:t},n.queue=s,n=Ef.bind(null,$e,s),s.dispatch=n,s=Wo(!1),f=sc.bind(null,$e,!1,s.queue),s=Qt(),c={state:t,dispatch:null,action:e,pending:null},s.queue=c,n=ry.bind(null,$e,c,f,n),c.dispatch=n,s.memoizedState=e,[t,n,!1]}function lf(e){var t=Tt();return of(t,lt,e)}function of(e,t,n){if(t=Xo(e,t,rf)[0],e=nl(ia)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=Pr(t)}catch(y){throw y===$i?Fs:y}else s=t;t=Tt();var c=t.queue,f=c.dispatch;return n!==t.memoizedState&&($e.flags|=2048,Ki(9,{destroy:void 0},sy.bind(null,c,n),null)),[s,f,e]}function sy(e,t){e.action=t}function cf(e){var t=Tt(),n=lt;if(n!==null)return of(t,n,e);Tt(),t=t.memoizedState,n=Tt();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function Ki(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=$e.updateQueue,t===null&&(t=el(),$e.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function uf(){return Tt().memoizedState}function al(e,t,n,s){var c=Qt();$e.flags|=e,c.memoizedState=Ki(1|t,{destroy:void 0},n,s===void 0?null:s)}function il(e,t,n,s){var c=Tt();s=s===void 0?null:s;var f=c.memoizedState.inst;lt!==null&&s!==null&&Go(s,lt.memoizedState.deps)?c.memoizedState=Ki(t,f,n,s):($e.flags|=e,c.memoizedState=Ki(1|t,f,n,s))}function df(e,t){al(8390656,8,e,t)}function tc(e,t){il(2048,8,e,t)}function ly(e){$e.flags|=4;var t=$e.updateQueue;if(t===null)t=el(),$e.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function ff(e){var t=Tt().memoizedState;return ly({ref:t,nextImpl:e}),function(){if((at&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function hf(e,t){return il(4,2,e,t)}function gf(e,t){return il(4,4,e,t)}function pf(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function mf(e,t,n){n=n!=null?n.concat([e]):null,il(4,4,pf.bind(null,t,e),n)}function nc(){}function yf(e,t){var n=Tt();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&Go(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function bf(e,t){var n=Tt();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&Go(t,s[1]))return s[0];if(s=e(),fi){gn(!0);try{e()}finally{gn(!1)}}return n.memoizedState=[s,t],s}function ac(e,t,n){return n===void 0||(aa&1073741824)!==0&&(Je&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=vh(),$e.lanes|=e,ka|=e,n)}function vf(e,t,n,s){return rn(n,t)?n:Vi.current!==null?(e=ac(e,n,s),rn(e,t)||(Ot=!0),e):(aa&42)===0||(aa&1073741824)!==0&&(Je&261930)===0?(Ot=!0,e.memoizedState=n):(e=vh(),$e.lanes|=e,ka|=e,t)}function xf(e,t,n,s,c){var f=z.p;z.p=f!==0&&8>f?f:8;var y=C.T,S={};C.T=S,sc(e,!1,t,n);try{var U=c(),Q=C.S;if(Q!==null&&Q(S,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var le=ny(U,s);Vr(e,t,le,dn(e))}else Vr(e,t,s,dn(e))}catch(ge){Vr(e,t,{then:function(){},status:"rejected",reason:ge},dn())}finally{z.p=f,y!==null&&S.types!==null&&(y.types=S.types),C.T=y}}function oy(){}function ic(e,t,n,s){if(e.tag!==5)throw Error(l(476));var c=_f(e).queue;xf(e,c,t,X,n===null?oy:function(){return jf(e),n(s)})}function _f(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:X},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ia,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function jf(e){var t=_f(e);t.next===null&&(t=e.alternate.memoizedState),Vr(e,t.next.queue,{},dn())}function rc(){return Ht(ls)}function Sf(){return Tt().memoizedState}function wf(){return Tt().memoizedState}function cy(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=dn();e=Ca(n);var s=Ta(t,e,n);s!==null&&(nn(s,t,n),qr(s,t,n)),t={cache:Uo()},e.payload=t;return}t=t.return}}function uy(e,t,n){var s=dn();n={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},rl(e)?Cf(t,n):(n=So(e,t,n,s),n!==null&&(nn(n,e,s),Tf(n,t,s)))}function Ef(e,t,n){var s=dn();Vr(e,t,n,s)}function Vr(e,t,n,s){var c={lane:s,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(rl(e))Cf(t,c);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,S=f(y,n);if(c.hasEagerState=!0,c.eagerState=S,rn(S,y))return qs(e,t,c,0),ut===null&&Ms(),!1}catch{}finally{}if(n=So(e,t,c,s),n!==null)return nn(n,e,s),Tf(n,t,s),!0}return!1}function sc(e,t,n,s){if(s={lane:2,revertLane:Mc(),gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},rl(e)){if(t)throw Error(l(479))}else t=So(e,n,s,2),t!==null&&nn(t,e,2)}function rl(e){var t=e.alternate;return e===$e||t!==null&&t===$e}function Cf(e,t){Gi=Zs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Tf(e,t,n){if((n&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,xr(e,n)}}var Gr={readContext:Ht,use:tl,useCallback:jt,useContext:jt,useEffect:jt,useImperativeHandle:jt,useLayoutEffect:jt,useInsertionEffect:jt,useMemo:jt,useReducer:jt,useRef:jt,useState:jt,useDebugValue:jt,useDeferredValue:jt,useTransition:jt,useSyncExternalStore:jt,useId:jt,useHostTransitionStatus:jt,useFormState:jt,useActionState:jt,useOptimistic:jt,useMemoCache:jt,useCacheRefresh:jt};Gr.useEffectEvent=jt;var Af={readContext:Ht,use:tl,useCallback:function(e,t){return Qt().memoizedState=[e,t===void 0?null:t],e},useContext:Ht,useEffect:df,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,al(4194308,4,pf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return al(4194308,4,e,t)},useInsertionEffect:function(e,t){al(4,2,e,t)},useMemo:function(e,t){var n=Qt();t=t===void 0?null:t;var s=e();if(fi){gn(!0);try{e()}finally{gn(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=Qt();if(n!==void 0){var c=n(t);if(fi){gn(!0);try{n(t)}finally{gn(!1)}}}else c=t;return s.memoizedState=s.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},s.queue=e,e=e.dispatch=uy.bind(null,$e,e),[s.memoizedState,e]},useRef:function(e){var t=Qt();return e={current:e},t.memoizedState=e},useState:function(e){e=Wo(e);var t=e.queue,n=Ef.bind(null,$e,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:nc,useDeferredValue:function(e,t){var n=Qt();return ac(n,e,t)},useTransition:function(){var e=Wo(!1);return e=xf.bind(null,$e,e.queue,!0,!1),Qt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=$e,c=Qt();if(Xe){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),ut===null)throw Error(l(349));(Je&127)!==0||Yd(s,t,n)}c.memoizedState=n;var f={value:n,getSnapshot:t};return c.queue=f,df(Qd.bind(null,s,f,e),[e]),s.flags|=2048,Ki(9,{destroy:void 0},Jd.bind(null,s,f,n,t),null),n},useId:function(){var e=Qt(),t=ut.identifierPrefix;if(Xe){var n=Pn,s=$n;n=(s&~(1<<32-Jt(s)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Ws++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=ay++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:rc,useFormState:sf,useActionState:sf,useOptimistic:function(e){var t=Qt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=sc.bind(null,$e,!0,n),n.dispatch=t,[e,t]},useMemoCache:Qo,useCacheRefresh:function(){return Qt().memoizedState=cy.bind(null,$e)},useEffectEvent:function(e){var t=Qt(),n={impl:e};return t.memoizedState=n,function(){if((at&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},lc={readContext:Ht,use:tl,useCallback:yf,useContext:Ht,useEffect:tc,useImperativeHandle:mf,useInsertionEffect:hf,useLayoutEffect:gf,useMemo:bf,useReducer:nl,useRef:uf,useState:function(){return nl(ia)},useDebugValue:nc,useDeferredValue:function(e,t){var n=Tt();return vf(n,lt.memoizedState,e,t)},useTransition:function(){var e=nl(ia)[0],t=Tt().memoizedState;return[typeof e=="boolean"?e:Pr(e),t]},useSyncExternalStore:Kd,useId:Sf,useHostTransitionStatus:rc,useFormState:lf,useActionState:lf,useOptimistic:function(e,t){var n=Tt();return Wd(n,lt,e,t)},useMemoCache:Qo,useCacheRefresh:wf};lc.useEffectEvent=ff;var Nf={readContext:Ht,use:tl,useCallback:yf,useContext:Ht,useEffect:tc,useImperativeHandle:mf,useInsertionEffect:hf,useLayoutEffect:gf,useMemo:bf,useReducer:Zo,useRef:uf,useState:function(){return Zo(ia)},useDebugValue:nc,useDeferredValue:function(e,t){var n=Tt();return lt===null?ac(n,e,t):vf(n,lt.memoizedState,e,t)},useTransition:function(){var e=Zo(ia)[0],t=Tt().memoizedState;return[typeof e=="boolean"?e:Pr(e),t]},useSyncExternalStore:Kd,useId:Sf,useHostTransitionStatus:rc,useFormState:cf,useActionState:cf,useOptimistic:function(e,t){var n=Tt();return lt!==null?Wd(n,lt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Qo,useCacheRefresh:wf};Nf.useEffectEvent=ff;function oc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:x({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var cc={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=dn(),c=Ca(s);c.payload=t,n!=null&&(c.callback=n),t=Ta(e,c,s),t!==null&&(nn(t,e,s),qr(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=dn(),c=Ca(s);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=Ta(e,c,s),t!==null&&(nn(t,e,s),qr(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=dn(),s=Ca(n);s.tag=2,t!=null&&(s.callback=t),t=Ta(e,s,n),t!==null&&(nn(t,e,n),qr(t,e,n))}};function Rf(e,t,n,s,c,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,f,y):t.prototype&&t.prototype.isPureReactComponent?!Or(n,s)||!Or(c,f):!0}function Of(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&cc.enqueueReplaceState(t,t.state,null)}function hi(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=x({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function kf(e){Ls(e)}function zf(e){console.error(e)}function Uf(e){Ls(e)}function sl(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Df(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function uc(e,t,n){return n=Ca(n),n.tag=3,n.payload={element:null},n.callback=function(){sl(e,t)},n}function Bf(e){return e=Ca(e),e.tag=3,e}function Lf(e,t,n,s){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var f=s.value;e.payload=function(){return c(f)},e.callback=function(){Df(t,n,s)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Df(t,n,s),typeof c!="function"&&(za===null?za=new Set([this]):za.add(this));var S=s.stack;this.componentDidCatch(s.value,{componentStack:S!==null?S:""})})}function dy(e,t,n,s,c){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&qi(t,n,c,!0),n=ln.current,n!==null){switch(n.tag){case 31:case 13:return xn===null?bl():n.alternate===null&&St===0&&(St=3),n.flags&=-257,n.flags|=65536,n.lanes=c,s===Ks?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),Dc(e,s,c)),!1;case 22:return n.flags|=65536,s===Ks?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),Dc(e,s,c)),!1}throw Error(l(435,n.tag))}return Dc(e,s,c),bl(),!1}if(Xe)return t=ln.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,s!==No&&(e=Error(l(422),{cause:s}),Ur(mn(e,n)))):(s!==No&&(t=Error(l(423),{cause:s}),Ur(mn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,s=mn(s,n),c=uc(e.stateNode,s,c),Io(e,c),St!==4&&(St=2)),!1;var f=Error(l(520),{cause:s});if(f=mn(f,n),Wr===null?Wr=[f]:Wr.push(f),St!==4&&(St=2),t===null)return!0;s=mn(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=uc(n.stateNode,s,e),Io(n,e),!1;case 1:if(t=n.type,f=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(za===null||!za.has(f))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Bf(c),Lf(c,e,n,s),Io(n,c),!1}n=n.return}while(n!==null);return!1}var dc=Error(l(461)),Ot=!1;function $t(e,t,n,s){t.child=e===null?Id(t,null,n,s):di(t,e.child,n,s)}function Mf(e,t,n,s,c){n=n.render;var f=t.ref;if("ref"in s){var y={};for(var S in s)S!=="ref"&&(y[S]=s[S])}else y=s;return li(t),s=Fo(e,t,n,y,f,c),S=Ko(),e!==null&&!Ot?(Yo(e,t,c),ra(e,t,c)):(Xe&&S&&To(t),t.flags|=1,$t(e,t,s,c),t.child)}function qf(e,t,n,s,c){if(e===null){var f=n.type;return typeof f=="function"&&!wo(f)&&f.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=f,If(e,t,f,s,c)):(e=Hs(n.type,null,s,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!vc(e,c)){var y=f.memoizedProps;if(n=n.compare,n=n!==null?n:Or,n(y,s)&&e.ref===t.ref)return ra(e,t,c)}return t.flags|=1,e=Wn(f,s),e.ref=t.ref,e.return=t,t.child=e}function If(e,t,n,s,c){if(e!==null){var f=e.memoizedProps;if(Or(f,s)&&e.ref===t.ref)if(Ot=!1,t.pendingProps=s=f,vc(e,c))(e.flags&131072)!==0&&(Ot=!0);else return t.lanes=e.lanes,ra(e,t,c)}return fc(e,t,n,s,c)}function Hf(e,t,n,s){var c=s.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|n:n,e!==null){for(s=t.child=e.child,c=0;s!==null;)c=c|s.lanes|s.childLanes,s=s.sibling;s=c&~f}else s=0,t.child=null;return $f(e,t,f,n,s)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Gs(t,f!==null?f.cachePool:null),f!==null?Pd(t,f):$o(),Vd(t);else return s=t.lanes=536870912,$f(e,t,f!==null?f.baseLanes|n:n,n,s)}else f!==null?(Gs(t,f.cachePool),Pd(t,f),Na(),t.memoizedState=null):(e!==null&&Gs(t,null),$o(),Na());return $t(e,t,c,n),t.child}function Fr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function $f(e,t,n,s,c){var f=Bo();return f=f===null?null:{parent:Nt._currentValue,pool:f},t.memoizedState={baseLanes:n,cachePool:f},e!==null&&Gs(t,null),$o(),Vd(t),e!==null&&qi(e,t,s,!0),t.childLanes=c,null}function ll(e,t){return t=cl({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Pf(e,t,n){return di(t,e.child,null,n),e=ll(t,t.pendingProps),e.flags|=2,on(t),t.memoizedState=null,e}function fy(e,t,n){var s=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Xe){if(s.mode==="hidden")return e=ll(t,s),t.lanes=536870912,Fr(null,e);if(Vo(t),(e=ht)?(e=tg(e,vn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:_a!==null?{id:$n,overflow:Pn}:null,retryLane:536870912,hydrationErrors:null},n=Ed(e),n.return=t,t.child=n,It=t,ht=null)):e=null,e===null)throw Sa(t);return t.lanes=536870912,null}return ll(t,s)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if(Vo(t),c)if(t.flags&256)t.flags&=-257,t=Pf(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(Ot||qi(e,t,n,!1),c=(n&e.childLanes)!==0,Ot||c){if(s=ut,s!==null&&(y=Ts(s,n),y!==0&&y!==f.retryLane))throw f.retryLane=y,ai(e,y),nn(s,e,y),dc;bl(),t=Pf(e,t,n)}else e=f.treeContext,ht=_n(y.nextSibling),It=t,Xe=!0,ja=null,vn=!1,e!==null&&Ad(t,e),t=ll(t,s),t.flags|=4096;return t}return e=Wn(e.child,{mode:s.mode,children:s.children}),e.ref=t.ref,t.child=e,e.return=t,e}function ol(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function fc(e,t,n,s,c){return li(t),n=Fo(e,t,n,s,void 0,c),s=Ko(),e!==null&&!Ot?(Yo(e,t,c),ra(e,t,c)):(Xe&&s&&To(t),t.flags|=1,$t(e,t,n,c),t.child)}function Vf(e,t,n,s,c,f){return li(t),t.updateQueue=null,n=Fd(t,s,n,c),Gd(e),s=Ko(),e!==null&&!Ot?(Yo(e,t,f),ra(e,t,f)):(Xe&&s&&To(t),t.flags|=1,$t(e,t,n,f),t.child)}function Gf(e,t,n,s,c){if(li(t),t.stateNode===null){var f=Di,y=n.contextType;typeof y=="object"&&y!==null&&(f=Ht(y)),f=new n(s,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=cc,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=s,f.state=t.memoizedState,f.refs={},Mo(t),y=n.contextType,f.context=typeof y=="object"&&y!==null?Ht(y):Di,f.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(oc(t,n,y,s),f.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&cc.enqueueReplaceState(f,f.state,null),Hr(t,s,f,c),Ir(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){f=t.stateNode;var S=t.memoizedProps,U=hi(n,S);f.props=U;var Q=f.context,le=n.contextType;y=Di,typeof le=="object"&&le!==null&&(y=Ht(le));var ge=n.getDerivedStateFromProps;le=typeof ge=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=t.pendingProps!==S,le||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||Q!==y)&&Of(t,f,s,y),Ea=!1;var W=t.memoizedState;f.state=W,Hr(t,s,f,c),Ir(),Q=t.memoizedState,S||W!==Q||Ea?(typeof ge=="function"&&(oc(t,n,ge,s),Q=t.memoizedState),(U=Ea||Rf(t,n,U,s,W,Q,y))?(le||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=Q),f.props=s,f.state=Q,f.context=y,s=U):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{f=t.stateNode,qo(e,t),y=t.memoizedProps,le=hi(n,y),f.props=le,ge=t.pendingProps,W=f.context,Q=n.contextType,U=Di,typeof Q=="object"&&Q!==null&&(U=Ht(Q)),S=n.getDerivedStateFromProps,(Q=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==ge||W!==U)&&Of(t,f,s,U),Ea=!1,W=t.memoizedState,f.state=W,Hr(t,s,f,c),Ir();var ne=t.memoizedState;y!==ge||W!==ne||Ea||e!==null&&e.dependencies!==null&&Ps(e.dependencies)?(typeof S=="function"&&(oc(t,n,S,s),ne=t.memoizedState),(le=Ea||Rf(t,n,le,s,W,ne,U)||e!==null&&e.dependencies!==null&&Ps(e.dependencies))?(Q||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(s,ne,U),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(s,ne,U)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&W===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&W===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=ne),f.props=s,f.state=ne,f.context=U,s=le):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&W===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&W===e.memoizedState||(t.flags|=1024),s=!1)}return f=s,ol(e,t),s=(t.flags&128)!==0,f||s?(f=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&s?(t.child=di(t,e.child,null,c),t.child=di(t,null,n,c)):$t(e,t,n,c),t.memoizedState=f.state,e=t.child):e=ra(e,t,c),e}function Ff(e,t,n,s){return ri(),t.flags|=256,$t(e,t,n,s),t.child}var hc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function gc(e){return{baseLanes:e,cachePool:Ud()}}function pc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=un),e}function Kf(e,t,n){var s=t.pendingProps,c=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(Ct.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Xe){if(c?Aa(t):Na(),(e=ht)?(e=tg(e,vn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:_a!==null?{id:$n,overflow:Pn}:null,retryLane:536870912,hydrationErrors:null},n=Ed(e),n.return=t,t.child=n,It=t,ht=null)):e=null,e===null)throw Sa(t);return Xc(e)?t.lanes=32:t.lanes=536870912,null}var S=s.children;return s=s.fallback,c?(Na(),c=t.mode,S=cl({mode:"hidden",children:S},c),s=ii(s,c,n,null),S.return=t,s.return=t,S.sibling=s,t.child=S,s=t.child,s.memoizedState=gc(n),s.childLanes=pc(e,y,n),t.memoizedState=hc,Fr(null,s)):(Aa(t),mc(t,S))}var U=e.memoizedState;if(U!==null&&(S=U.dehydrated,S!==null)){if(f)t.flags&256?(Aa(t),t.flags&=-257,t=yc(e,t,n)):t.memoizedState!==null?(Na(),t.child=e.child,t.flags|=128,t=null):(Na(),S=s.fallback,c=t.mode,s=cl({mode:"visible",children:s.children},c),S=ii(S,c,n,null),S.flags|=2,s.return=t,S.return=t,s.sibling=S,t.child=s,di(t,e.child,null,n),s=t.child,s.memoizedState=gc(n),s.childLanes=pc(e,y,n),t.memoizedState=hc,t=Fr(null,s));else if(Aa(t),Xc(S)){if(y=S.nextSibling&&S.nextSibling.dataset,y)var Q=y.dgst;y=Q,s=Error(l(419)),s.stack="",s.digest=y,Ur({value:s,source:null,stack:null}),t=yc(e,t,n)}else if(Ot||qi(e,t,n,!1),y=(n&e.childLanes)!==0,Ot||y){if(y=ut,y!==null&&(s=Ts(y,n),s!==0&&s!==U.retryLane))throw U.retryLane=s,ai(e,s),nn(y,e,s),dc;Qc(S)||bl(),t=yc(e,t,n)}else Qc(S)?(t.flags|=192,t.child=e.child,t=null):(e=U.treeContext,ht=_n(S.nextSibling),It=t,Xe=!0,ja=null,vn=!1,e!==null&&Ad(t,e),t=mc(t,s.children),t.flags|=4096);return t}return c?(Na(),S=s.fallback,c=t.mode,U=e.child,Q=U.sibling,s=Wn(U,{mode:"hidden",children:s.children}),s.subtreeFlags=U.subtreeFlags&65011712,Q!==null?S=Wn(Q,S):(S=ii(S,c,n,null),S.flags|=2),S.return=t,s.return=t,s.sibling=S,t.child=s,Fr(null,s),s=t.child,S=e.child.memoizedState,S===null?S=gc(n):(c=S.cachePool,c!==null?(U=Nt._currentValue,c=c.parent!==U?{parent:U,pool:U}:c):c=Ud(),S={baseLanes:S.baseLanes|n,cachePool:c}),s.memoizedState=S,s.childLanes=pc(e,y,n),t.memoizedState=hc,Fr(e.child,s)):(Aa(t),n=e.child,e=n.sibling,n=Wn(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function mc(e,t){return t=cl({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function cl(e,t){return e=sn(22,e,null,t),e.lanes=0,e}function yc(e,t,n){return di(t,e.child,null,n),e=mc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Yf(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ko(e.return,t,n)}function bc(e,t,n,s,c,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:c,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=s,y.tail=n,y.tailMode=c,y.treeForkCount=f)}function Jf(e,t,n){var s=t.pendingProps,c=s.revealOrder,f=s.tail;s=s.children;var y=Ct.current,S=(y&2)!==0;if(S?(y=y&1|2,t.flags|=128):y&=1,O(Ct,y),$t(e,t,s,n),s=Xe?zr:0,!S&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Yf(e,n,t);else if(e.tag===19)Yf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Xs(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),bc(t,!1,c,n,f,s);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Xs(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}bc(t,!0,n,null,f,s);break;case"together":bc(t,!1,null,null,void 0,s);break;default:t.memoizedState=null}return t.child}function ra(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ka|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(qi(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Wn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Wn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function vc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Ps(e)))}function hy(e,t,n){switch(t.tag){case 3:re(t,t.stateNode.containerInfo),wa(t,Nt,e.memoizedState.cache),ri();break;case 27:case 5:Ee(t);break;case 4:re(t,t.stateNode.containerInfo);break;case 10:wa(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Vo(t),null;break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(Aa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Kf(e,t,n):(Aa(t),e=ra(e,t,n),e!==null?e.sibling:null);Aa(t);break;case 19:var c=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(qi(e,t,n,!1),s=(n&t.childLanes)!==0),c){if(s)return Jf(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),O(Ct,Ct.current),s)break;return null;case 22:return t.lanes=0,Hf(e,t,n,t.pendingProps);case 24:wa(t,Nt,e.memoizedState.cache)}return ra(e,t,n)}function Qf(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ot=!0;else{if(!vc(e,n)&&(t.flags&128)===0)return Ot=!1,hy(e,t,n);Ot=(e.flags&131072)!==0}else Ot=!1,Xe&&(t.flags&1048576)!==0&&Td(t,zr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var s=t.pendingProps;if(e=ci(t.elementType),t.type=e,typeof e=="function")wo(e)?(s=hi(e,s),t.tag=1,t=Gf(null,t,e,s,n)):(t.tag=0,t=fc(null,t,e,s,n));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=Mf(null,t,e,s,n);break e}else if(c===L){t.tag=14,t=qf(null,t,e,s,n);break e}}throw t=ee(e)||e,Error(l(306,t,""))}}return t;case 0:return fc(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,c=hi(s,t.pendingProps),Gf(e,t,s,c,n);case 3:e:{if(re(t,t.stateNode.containerInfo),e===null)throw Error(l(387));s=t.pendingProps;var f=t.memoizedState;c=f.element,qo(e,t),Hr(t,s,null,n);var y=t.memoizedState;if(s=y.cache,wa(t,Nt,s),s!==f.cache&&zo(t,[Nt],n,!0),Ir(),s=y.element,f.isDehydrated)if(f={element:s,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Ff(e,t,s,n);break e}else if(s!==c){c=mn(Error(l(424)),t),Ur(c),t=Ff(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ht=_n(e.firstChild),It=t,Xe=!0,ja=null,vn=!0,n=Id(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ri(),s===c){t=ra(e,t,n);break e}$t(e,t,s,n)}t=t.child}return t;case 26:return ol(e,t),e===null?(n=lg(t.type,null,t.pendingProps,null))?t.memoizedState=n:Xe||(n=t.type,e=t.pendingProps,s=El(oe.current).createElement(n),s[wt]=t,s[Ft]=e,Pt(s,n,e),Et(s),t.stateNode=s):t.memoizedState=lg(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ee(t),e===null&&Xe&&(s=t.stateNode=ig(t.type,t.pendingProps,oe.current),It=t,vn=!0,c=ht,La(t.type)?(Zc=c,ht=_n(s.firstChild)):ht=c),$t(e,t,t.pendingProps.children,n),ol(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Xe&&((c=s=ht)&&(s=Py(s,t.type,t.pendingProps,vn),s!==null?(t.stateNode=s,It=t,ht=_n(s.firstChild),vn=!1,c=!0):c=!1),c||Sa(t)),Ee(t),c=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,s=f.children,Kc(c,f)?s=null:y!==null&&Kc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Fo(e,t,iy,null,null,n),ls._currentValue=c),ol(e,t),$t(e,t,s,n),t.child;case 6:return e===null&&Xe&&((e=n=ht)&&(n=Vy(n,t.pendingProps,vn),n!==null?(t.stateNode=n,It=t,ht=null,e=!0):e=!1),e||Sa(t)),null;case 13:return Kf(e,t,n);case 4:return re(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=di(t,null,s,n):$t(e,t,s,n),t.child;case 11:return Mf(e,t,t.type,t.pendingProps,n);case 7:return $t(e,t,t.pendingProps,n),t.child;case 8:return $t(e,t,t.pendingProps.children,n),t.child;case 12:return $t(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,wa(t,t.type,s.value),$t(e,t,s.children,n),t.child;case 9:return c=t.type._context,s=t.pendingProps.children,li(t),c=Ht(c),s=s(c),t.flags|=1,$t(e,t,s,n),t.child;case 14:return qf(e,t,t.type,t.pendingProps,n);case 15:return If(e,t,t.type,t.pendingProps,n);case 19:return Jf(e,t,n);case 31:return fy(e,t,n);case 22:return Hf(e,t,n,t.pendingProps);case 24:return li(t),s=Ht(Nt),e===null?(c=Bo(),c===null&&(c=ut,f=Uo(),c.pooledCache=f,f.refCount++,f!==null&&(c.pooledCacheLanes|=n),c=f),t.memoizedState={parent:s,cache:c},Mo(t),wa(t,Nt,c)):((e.lanes&n)!==0&&(qo(e,t),Hr(t,null,null,n),Ir()),c=e.memoizedState,f=t.memoizedState,c.parent!==s?(c={parent:s,cache:s},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),wa(t,Nt,s)):(s=f.cache,wa(t,Nt,s),s!==c.cache&&zo(t,[Nt],n,!0))),$t(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function sa(e){e.flags|=4}function xc(e,t,n,s,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(Sh())e.flags|=8192;else throw ui=Ks,Lo}else e.flags&=-16777217}function Xf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!fg(t))if(Sh())e.flags|=8192;else throw ui=Ks,Lo}function ul(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Es():536870912,e.lanes|=t,Xi|=t)}function Kr(e,t){if(!Xe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function gt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,s|=c.subtreeFlags&65011712,s|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,s|=c.subtreeFlags,s|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function gy(e,t,n){var s=t.pendingProps;switch(Ao(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(t),null;case 1:return gt(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),na(Nt),be(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Mi(t)?sa(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Ro())),gt(t),null;case 26:var c=t.type,f=t.memoizedState;return e===null?(sa(t),f!==null?(gt(t),Xf(t,f)):(gt(t),xc(t,c,null,s,n))):f?f!==e.memoizedState?(sa(t),gt(t),Xf(t,f)):(gt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==s&&sa(t),gt(t),xc(t,c,e,s,n)),null;case 27:if(we(t),n=oe.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&sa(t);else{if(!s){if(t.stateNode===null)throw Error(l(166));return gt(t),null}e=P.current,Mi(t)?Nd(t):(e=ig(c,s,n),t.stateNode=e,sa(t))}return gt(t),null;case 5:if(we(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&sa(t);else{if(!s){if(t.stateNode===null)throw Error(l(166));return gt(t),null}if(f=P.current,Mi(t))Nd(t);else{var y=El(oe.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof s.is=="string"?y.createElement("select",{is:s.is}):y.createElement("select"),s.multiple?f.multiple=!0:s.size&&(f.size=s.size);break;default:f=typeof s.is=="string"?y.createElement(c,{is:s.is}):y.createElement(c)}}f[wt]=t,f[Ft]=s;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(Pt(f,c,s),c){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&sa(t)}}return gt(t),xc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&sa(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(l(166));if(e=oe.current,Mi(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,c=It,c!==null)switch(c.tag){case 27:case 5:s=c.memoizedProps}e[wt]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||Kh(e.nodeValue,n)),e||Sa(t,!0)}else e=El(e).createTextNode(s),e[wt]=t,t.stateNode=e}return gt(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(s=Mi(t),n!==null){if(e===null){if(!s)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[wt]=t}else ri(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;gt(t),e=!1}else n=Ro(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(on(t),t):(on(t),null);if((t.flags&128)!==0)throw Error(l(558))}return gt(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Mi(t),s!==null&&s.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[wt]=t}else ri(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;gt(t),c=!1}else c=Ro(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(on(t),t):(on(t),null)}return on(t),(t.flags&128)!==0?(t.lanes=n,t):(n=s!==null,e=e!==null&&e.memoizedState!==null,n&&(s=t.child,c=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(c=s.alternate.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ul(t,t.updateQueue),gt(t),null);case 4:return be(),e===null&&$c(t.stateNode.containerInfo),gt(t),null;case 10:return na(t.type),gt(t),null;case 19:if(B(Ct),s=t.memoizedState,s===null)return gt(t),null;if(c=(t.flags&128)!==0,f=s.rendering,f===null)if(c)Kr(s,!1);else{if(St!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=Xs(e),f!==null){for(t.flags|=128,Kr(s,!1),e=f.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)wd(n,e),n=n.sibling;return O(Ct,Ct.current&1|2),Xe&&ea(t,s.treeForkCount),t.child}e=e.sibling}s.tail!==null&&Lt()>pl&&(t.flags|=128,c=!0,Kr(s,!1),t.lanes=4194304)}else{if(!c)if(e=Xs(f),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),Kr(s,!0),s.tail===null&&s.tailMode==="hidden"&&!f.alternate&&!Xe)return gt(t),null}else 2*Lt()-s.renderingStartTime>pl&&n!==536870912&&(t.flags|=128,c=!0,Kr(s,!1),t.lanes=4194304);s.isBackwards?(f.sibling=t.child,t.child=f):(e=s.last,e!==null?e.sibling=f:t.child=f,s.last=f)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Lt(),e.sibling=null,n=Ct.current,O(Ct,c?n&1|2:n&1),Xe&&ea(t,s.treeForkCount),e):(gt(t),null);case 22:case 23:return on(t),Po(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(n&536870912)!==0&&(t.flags&128)===0&&(gt(t),t.subtreeFlags&6&&(t.flags|=8192)):gt(t),n=t.updateQueue,n!==null&&ul(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&B(oi),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),na(Nt),gt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function py(e,t){switch(Ao(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return na(Nt),be(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return we(t),null;case 31:if(t.memoizedState!==null){if(on(t),t.alternate===null)throw Error(l(340));ri()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(on(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));ri()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return B(Ct),null;case 4:return be(),null;case 10:return na(t.type),null;case 22:case 23:return on(t),Po(),e!==null&&B(oi),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return na(Nt),null;case 25:return null;default:return null}}function Zf(e,t){switch(Ao(t),t.tag){case 3:na(Nt),be();break;case 26:case 27:case 5:we(t);break;case 4:be();break;case 31:t.memoizedState!==null&&on(t);break;case 13:on(t);break;case 19:B(Ct);break;case 10:na(t.type);break;case 22:case 23:on(t),Po(),e!==null&&B(oi);break;case 24:na(Nt)}}function Yr(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var c=s.next;n=c;do{if((n.tag&e)===e){s=void 0;var f=n.create,y=n.inst;s=f(),y.destroy=s}n=n.next}while(n!==c)}}catch(S){st(t,t.return,S)}}function Ra(e,t,n){try{var s=t.updateQueue,c=s!==null?s.lastEffect:null;if(c!==null){var f=c.next;s=f;do{if((s.tag&e)===e){var y=s.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,c=t;var U=n,Q=S;try{Q()}catch(le){st(c,U,le)}}}s=s.next}while(s!==f)}}catch(le){st(t,t.return,le)}}function Wf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{$d(t,n)}catch(s){st(e,e.return,s)}}}function eh(e,t,n){n.props=hi(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){st(e,t,s)}}function Jr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(c){st(e,t,c)}}function Vn(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(c){st(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){st(e,t,c)}else n.current=null}function th(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(c){st(e,e.return,c)}}function _c(e,t,n){try{var s=e.stateNode;Ly(s,e.type,n,t),s[Ft]=t}catch(c){st(e,e.return,c)}}function nh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&La(e.type)||e.tag===4}function jc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||nh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&La(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Sc(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ge));else if(s!==4&&(s===27&&La(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(Sc(e,t,n),e=e.sibling;e!==null;)Sc(e,t,n),e=e.sibling}function dl(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&La(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(dl(e,t,n),e=e.sibling;e!==null;)dl(e,t,n),e=e.sibling}function ah(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Pt(t,s,n),t[wt]=e,t[Ft]=n}catch(f){st(e,e.return,f)}}var la=!1,kt=!1,wc=!1,ih=typeof WeakSet=="function"?WeakSet:Set,Mt=null;function my(e,t){if(e=e.containerInfo,Gc=kl,e=pd(e),yo(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var c=s.anchorOffset,f=s.focusNode;s=s.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var y=0,S=-1,U=-1,Q=0,le=0,ge=e,W=null;t:for(;;){for(var ne;ge!==n||c!==0&&ge.nodeType!==3||(S=y+c),ge!==f||s!==0&&ge.nodeType!==3||(U=y+s),ge.nodeType===3&&(y+=ge.nodeValue.length),(ne=ge.firstChild)!==null;)W=ge,ge=ne;for(;;){if(ge===e)break t;if(W===n&&++Q===c&&(S=y),W===f&&++le===s&&(U=y),(ne=ge.nextSibling)!==null)break;ge=W,W=ge.parentNode}ge=ne}n=S===-1||U===-1?null:{start:S,end:U}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fc={focusedElem:e,selectionRange:n},kl=!1,Mt=t;Mt!==null;)if(t=Mt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Mt=e;else for(;Mt!==null;){switch(t=Mt,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,n=t,c=f.memoizedProps,f=f.memoizedState,s=n.stateNode;try{var Te=hi(n.type,c);e=s.getSnapshotBeforeUpdate(Te,f),s.__reactInternalSnapshotBeforeUpdate=e}catch(Le){st(n,n.return,Le)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Jc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Jc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Mt=e;break}Mt=t.return}}function rh(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:ca(e,n),s&4&&Yr(5,n);break;case 1:if(ca(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){st(n,n.return,y)}else{var c=hi(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){st(n,n.return,y)}}s&64&&Wf(n),s&512&&Jr(n,n.return);break;case 3:if(ca(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{$d(e,t)}catch(y){st(n,n.return,y)}}break;case 27:t===null&&s&4&&ah(n);case 26:case 5:ca(e,n),t===null&&s&4&&th(n),s&512&&Jr(n,n.return);break;case 12:ca(e,n);break;case 31:ca(e,n),s&4&&oh(e,n);break;case 13:ca(e,n),s&4&&ch(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=Ey.bind(null,n),Gy(e,n))));break;case 22:if(s=n.memoizedState!==null||la,!s){t=t!==null&&t.memoizedState!==null||kt,c=la;var f=kt;la=s,(kt=t)&&!f?ua(e,n,(n.subtreeFlags&8772)!==0):ca(e,n),la=c,kt=f}break;case 30:break;default:ca(e,n)}}function sh(e){var t=e.alternate;t!==null&&(e.alternate=null,sh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Ai(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var bt=null,Zt=!1;function oa(e,t,n){for(n=n.child;n!==null;)lh(e,t,n),n=n.sibling}function lh(e,t,n){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(Kn,n)}catch{}switch(n.tag){case 26:kt||Vn(n,t),oa(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:kt||Vn(n,t);var s=bt,c=Zt;La(n.type)&&(bt=n.stateNode,Zt=!1),oa(e,t,n),is(n.stateNode),bt=s,Zt=c;break;case 5:kt||Vn(n,t);case 6:if(s=bt,c=Zt,bt=null,oa(e,t,n),bt=s,Zt=c,bt!==null)if(Zt)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(n.stateNode)}catch(f){st(n,t,f)}else try{bt.removeChild(n.stateNode)}catch(f){st(n,t,f)}break;case 18:bt!==null&&(Zt?(e=bt,Wh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),rr(e)):Wh(bt,n.stateNode));break;case 4:s=bt,c=Zt,bt=n.stateNode.containerInfo,Zt=!0,oa(e,t,n),bt=s,Zt=c;break;case 0:case 11:case 14:case 15:Ra(2,n,t),kt||Ra(4,n,t),oa(e,t,n);break;case 1:kt||(Vn(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&eh(n,t,s)),oa(e,t,n);break;case 21:oa(e,t,n);break;case 22:kt=(s=kt)||n.memoizedState!==null,oa(e,t,n),kt=s;break;default:oa(e,t,n)}}function oh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{rr(e)}catch(n){st(t,t.return,n)}}}function ch(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{rr(e)}catch(n){st(t,t.return,n)}}function yy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new ih),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new ih),t;default:throw Error(l(435,e.tag))}}function fl(e,t){var n=yy(e);t.forEach(function(s){if(!n.has(s)){n.add(s);var c=Cy.bind(null,e,s);s.then(c,c)}})}function Wt(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var c=n[s],f=e,y=t,S=y;e:for(;S!==null;){switch(S.tag){case 27:if(La(S.type)){bt=S.stateNode,Zt=!1;break e}break;case 5:bt=S.stateNode,Zt=!1;break e;case 3:case 4:bt=S.stateNode.containerInfo,Zt=!0;break e}S=S.return}if(bt===null)throw Error(l(160));lh(f,y,c),bt=null,Zt=!1,f=c.alternate,f!==null&&(f.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)uh(t,e),t=t.sibling}var Rn=null;function uh(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Wt(t,e),en(e),s&4&&(Ra(3,e,e.return),Yr(3,e),Ra(5,e,e.return));break;case 1:Wt(t,e),en(e),s&512&&(kt||n===null||Vn(n,n.return)),s&64&&la&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var c=Rn;if(Wt(t,e),en(e),s&512&&(kt||n===null||Vn(n,n.return)),s&4){var f=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(s){case"title":f=c.getElementsByTagName("title")[0],(!f||f[Za]||f[wt]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=c.createElement(s),c.head.insertBefore(f,c.querySelector("head > title"))),Pt(f,s,n),f[wt]=e,Et(f),s=f;break e;case"link":var y=ug("link","href",c).get(s+(n.href||""));if(y){for(var S=0;S<y.length;S++)if(f=y[S],f.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&f.getAttribute("rel")===(n.rel==null?null:n.rel)&&f.getAttribute("title")===(n.title==null?null:n.title)&&f.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(S,1);break t}}f=c.createElement(s),Pt(f,s,n),c.head.appendChild(f);break;case"meta":if(y=ug("meta","content",c).get(s+(n.content||""))){for(S=0;S<y.length;S++)if(f=y[S],f.getAttribute("content")===(n.content==null?null:""+n.content)&&f.getAttribute("name")===(n.name==null?null:n.name)&&f.getAttribute("property")===(n.property==null?null:n.property)&&f.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&f.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(S,1);break t}}f=c.createElement(s),Pt(f,s,n),c.head.appendChild(f);break;default:throw Error(l(468,s))}f[wt]=e,Et(f),s=f}e.stateNode=s}else dg(c,e.type,e.stateNode);else e.stateNode=cg(c,s,e.memoizedProps);else f!==s?(f===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):f.count--,s===null?dg(c,e.type,e.stateNode):cg(c,s,e.memoizedProps)):s===null&&e.stateNode!==null&&_c(e,e.memoizedProps,n.memoizedProps)}break;case 27:Wt(t,e),en(e),s&512&&(kt||n===null||Vn(n,n.return)),n!==null&&s&4&&_c(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Wt(t,e),en(e),s&512&&(kt||n===null||Vn(n,n.return)),e.flags&32){c=e.stateNode;try{In(c,"")}catch(Te){st(e,e.return,Te)}}s&4&&e.stateNode!=null&&(c=e.memoizedProps,_c(e,c,n!==null?n.memoizedProps:c)),s&1024&&(wc=!0);break;case 6:if(Wt(t,e),en(e),s&4){if(e.stateNode===null)throw Error(l(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(Te){st(e,e.return,Te)}}break;case 3:if(Al=null,c=Rn,Rn=Cl(t.containerInfo),Wt(t,e),Rn=c,en(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{rr(t.containerInfo)}catch(Te){st(e,e.return,Te)}wc&&(wc=!1,dh(e));break;case 4:s=Rn,Rn=Cl(e.stateNode.containerInfo),Wt(t,e),en(e),Rn=s;break;case 12:Wt(t,e),en(e);break;case 31:Wt(t,e),en(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,fl(e,s)));break;case 13:Wt(t,e),en(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(gl=Lt()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,fl(e,s)));break;case 22:c=e.memoizedState!==null;var U=n!==null&&n.memoizedState!==null,Q=la,le=kt;if(la=Q||c,kt=le||U,Wt(t,e),kt=le,la=Q,en(e),s&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||U||la||kt||gi(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){U=n=t;try{if(f=U.stateNode,c)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{S=U.stateNode;var ge=U.memoizedProps.style,W=ge!=null&&ge.hasOwnProperty("display")?ge.display:null;S.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(Te){st(U,U.return,Te)}}}else if(t.tag===6){if(n===null){U=t;try{U.stateNode.nodeValue=c?"":U.memoizedProps}catch(Te){st(U,U.return,Te)}}}else if(t.tag===18){if(n===null){U=t;try{var ne=U.stateNode;c?eg(ne,!0):eg(U.stateNode,!1)}catch(Te){st(U,U.return,Te)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,fl(e,n))));break;case 19:Wt(t,e),en(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,fl(e,s)));break;case 30:break;case 21:break;default:Wt(t,e),en(e)}}function en(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(nh(s)){n=s;break}s=s.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,f=jc(e);dl(e,f,c);break;case 5:var y=n.stateNode;n.flags&32&&(In(y,""),n.flags&=-33);var S=jc(e);dl(e,S,y);break;case 3:case 4:var U=n.stateNode.containerInfo,Q=jc(e);Sc(e,Q,U);break;default:throw Error(l(161))}}catch(le){st(e,e.return,le)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function dh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;dh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ca(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)rh(e,t.alternate,t),t=t.sibling}function gi(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Ra(4,t,t.return),gi(t);break;case 1:Vn(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&eh(t,t.return,n),gi(t);break;case 27:is(t.stateNode);case 26:case 5:Vn(t,t.return),gi(t);break;case 22:t.memoizedState===null&&gi(t);break;case 30:gi(t);break;default:gi(t)}e=e.sibling}}function ua(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,c=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:ua(c,f,n),Yr(4,f);break;case 1:if(ua(c,f,n),s=f,c=s.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(Q){st(s,s.return,Q)}if(s=f,c=s.updateQueue,c!==null){var S=s.stateNode;try{var U=c.shared.hiddenCallbacks;if(U!==null)for(c.shared.hiddenCallbacks=null,c=0;c<U.length;c++)Hd(U[c],S)}catch(Q){st(s,s.return,Q)}}n&&y&64&&Wf(f),Jr(f,f.return);break;case 27:ah(f);case 26:case 5:ua(c,f,n),n&&s===null&&y&4&&th(f),Jr(f,f.return);break;case 12:ua(c,f,n);break;case 31:ua(c,f,n),n&&y&4&&oh(c,f);break;case 13:ua(c,f,n),n&&y&4&&ch(c,f);break;case 22:f.memoizedState===null&&ua(c,f,n),Jr(f,f.return);break;case 30:break;default:ua(c,f,n)}t=t.sibling}}function Ec(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Dr(n))}function Cc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Dr(e))}function On(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)fh(e,t,n,s),t=t.sibling}function fh(e,t,n,s){var c=t.flags;switch(t.tag){case 0:case 11:case 15:On(e,t,n,s),c&2048&&Yr(9,t);break;case 1:On(e,t,n,s);break;case 3:On(e,t,n,s),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Dr(e)));break;case 12:if(c&2048){On(e,t,n,s),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,S=f.onPostCommit;typeof S=="function"&&S(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(U){st(t,t.return,U)}}else On(e,t,n,s);break;case 31:On(e,t,n,s);break;case 13:On(e,t,n,s);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?On(e,t,n,s):Qr(e,t):f._visibility&2?On(e,t,n,s):(f._visibility|=2,Yi(e,t,n,s,(t.subtreeFlags&10256)!==0||!1)),c&2048&&Ec(y,t);break;case 24:On(e,t,n,s),c&2048&&Cc(t.alternate,t);break;default:On(e,t,n,s)}}function Yi(e,t,n,s,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,S=n,U=s,Q=y.flags;switch(y.tag){case 0:case 11:case 15:Yi(f,y,S,U,c),Yr(8,y);break;case 23:break;case 22:var le=y.stateNode;y.memoizedState!==null?le._visibility&2?Yi(f,y,S,U,c):Qr(f,y):(le._visibility|=2,Yi(f,y,S,U,c)),c&&Q&2048&&Ec(y.alternate,y);break;case 24:Yi(f,y,S,U,c),c&&Q&2048&&Cc(y.alternate,y);break;default:Yi(f,y,S,U,c)}t=t.sibling}}function Qr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,c=s.flags;switch(s.tag){case 22:Qr(n,s),c&2048&&Ec(s.alternate,s);break;case 24:Qr(n,s),c&2048&&Cc(s.alternate,s);break;default:Qr(n,s)}t=t.sibling}}var Xr=8192;function Ji(e,t,n){if(e.subtreeFlags&Xr)for(e=e.child;e!==null;)hh(e,t,n),e=e.sibling}function hh(e,t,n){switch(e.tag){case 26:Ji(e,t,n),e.flags&Xr&&e.memoizedState!==null&&ab(n,Rn,e.memoizedState,e.memoizedProps);break;case 5:Ji(e,t,n);break;case 3:case 4:var s=Rn;Rn=Cl(e.stateNode.containerInfo),Ji(e,t,n),Rn=s;break;case 22:e.memoizedState===null&&(s=e.alternate,s!==null&&s.memoizedState!==null?(s=Xr,Xr=16777216,Ji(e,t,n),Xr=s):Ji(e,t,n));break;default:Ji(e,t,n)}}function gh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Zr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Mt=s,mh(s,e)}gh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ph(e),e=e.sibling}function ph(e){switch(e.tag){case 0:case 11:case 15:Zr(e),e.flags&2048&&Ra(9,e,e.return);break;case 3:Zr(e);break;case 12:Zr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,hl(e)):Zr(e);break;default:Zr(e)}}function hl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Mt=s,mh(s,e)}gh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Ra(8,t,t.return),hl(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,hl(t));break;default:hl(t)}e=e.sibling}}function mh(e,t){for(;Mt!==null;){var n=Mt;switch(n.tag){case 0:case 11:case 15:Ra(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:Dr(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,Mt=s;else e:for(n=e;Mt!==null;){s=Mt;var c=s.sibling,f=s.return;if(sh(s),s===n){Mt=null;break e}if(c!==null){c.return=f,Mt=c;break e}Mt=f}}}var by={getCacheForType:function(e){var t=Ht(Nt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Ht(Nt).controller.signal}},vy=typeof WeakMap=="function"?WeakMap:Map,at=0,ut=null,Ke=null,Je=0,rt=0,cn=null,Oa=!1,Qi=!1,Tc=!1,da=0,St=0,ka=0,pi=0,Ac=0,un=0,Xi=0,Wr=null,tn=null,Nc=!1,gl=0,yh=0,pl=1/0,ml=null,za=null,Ut=0,Ua=null,Zi=null,fa=0,Rc=0,Oc=null,bh=null,es=0,kc=null;function dn(){return(at&2)!==0&&Je!==0?Je&-Je:C.T!==null?Mc():_r()}function vh(){if(un===0)if((Je&536870912)===0||Xe){var e=Ya;Ya<<=1,(Ya&3932160)===0&&(Ya=262144),un=e}else un=536870912;return e=ln.current,e!==null&&(e.flags|=32),un}function nn(e,t,n){(e===ut&&(rt===2||rt===9)||e.cancelPendingCommit!==null)&&(Wi(e,0),Da(e,Je,un,!1)),Qa(e,n),((at&2)===0||e!==ut)&&(e===ut&&((at&2)===0&&(pi|=n),St===4&&Da(e,Je,un,!1)),Gn(e))}function xh(e,t,n){if((at&6)!==0)throw Error(l(327));var s=!n&&(t&127)===0&&(t&e.expiredLanes)===0||Cn(e,t),c=s?jy(e,t):Uc(e,t,!0),f=s;do{if(c===0){Qi&&!s&&Da(e,t,0,!1);break}else{if(n=e.current.alternate,f&&!xy(n)){c=Uc(e,t,!1),f=!1;continue}if(c===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var S=e;c=Wr;var U=S.current.memoizedState.isDehydrated;if(U&&(Wi(S,y).flags|=256),y=Uc(S,y,!1),y!==2){if(Tc&&!U){S.errorRecoveryDisabledLanes|=f,pi|=f,c=4;break e}f=tn,tn=c,f!==null&&(tn===null?tn=f:tn.push.apply(tn,f))}c=y}if(f=!1,c!==2)continue}}if(c===1){Wi(e,0),Da(e,t,0,!0);break}e:{switch(s=e,f=c,f){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Da(s,t,un,!Oa);break e;case 2:tn=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=gl+300-Lt(),10<c)){if(Da(s,t,un,!Oa),Ja(s,0,!0)!==0)break e;fa=t,s.timeoutHandle=Xh(_h.bind(null,s,n,tn,ml,Nc,t,un,pi,Xi,Oa,f,"Throttled",-0,0),c);break e}_h(s,n,tn,ml,Nc,t,un,pi,Xi,Oa,f,null,-0,0)}}break}while(!0);Gn(e)}function _h(e,t,n,s,c,f,y,S,U,Q,le,ge,W,ne){if(e.timeoutHandle=-1,ge=t.subtreeFlags,ge&8192||(ge&16785408)===16785408){ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ge},hh(t,f,ge);var Te=(f&62914560)===f?gl-Lt():(f&4194048)===f?yh-Lt():0;if(Te=ib(ge,Te),Te!==null){fa=f,e.cancelPendingCommit=Te(Nh.bind(null,e,t,f,n,s,c,y,S,U,le,ge,null,W,ne)),Da(e,f,y,!Q);return}}Nh(e,t,f,n,s,c,y,S,U)}function xy(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var c=n[s],f=c.getSnapshot;c=c.value;try{if(!rn(f(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Da(e,t,n,s){t&=~Ac,t&=~pi,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var c=t;0<c;){var f=31-Jt(c),y=1<<f;s[f]=-1,c&=~y}n!==0&&vr(e,n,t)}function yl(){return(at&6)===0?(ts(0),!1):!0}function zc(){if(Ke!==null){if(rt===0)var e=Ke.return;else e=Ke,ta=si=null,Jo(e),Pi=null,Lr=0,e=Ke;for(;e!==null;)Zf(e.alternate,e),e=e.return;Ke=null}}function Wi(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,Iy(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),fa=0,zc(),ut=e,Ke=n=Wn(e.current,null),Je=t,rt=0,cn=null,Oa=!1,Qi=Cn(e,t),Tc=!1,Xi=un=Ac=pi=ka=St=0,tn=Wr=null,Nc=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var c=31-Jt(s),f=1<<c;t|=e[c],s&=~f}return da=t,Ms(),n}function jh(e,t){$e=null,C.H=Gr,t===$i||t===Fs?(t=Ld(),rt=3):t===Lo?(t=Ld(),rt=4):rt=t===dc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,cn=t,Ke===null&&(St=1,sl(e,mn(t,e.current)))}function Sh(){var e=ln.current;return e===null?!0:(Je&4194048)===Je?xn===null:(Je&62914560)===Je||(Je&536870912)!==0?e===xn:!1}function wh(){var e=C.H;return C.H=Gr,e===null?Gr:e}function Eh(){var e=C.A;return C.A=by,e}function bl(){St=4,Oa||(Je&4194048)!==Je&&ln.current!==null||(Qi=!0),(ka&134217727)===0&&(pi&134217727)===0||ut===null||Da(ut,Je,un,!1)}function Uc(e,t,n){var s=at;at|=2;var c=wh(),f=Eh();(ut!==e||Je!==t)&&(ml=null,Wi(e,t)),t=!1;var y=St;e:do try{if(rt!==0&&Ke!==null){var S=Ke,U=cn;switch(rt){case 8:zc(),y=6;break e;case 3:case 2:case 9:case 6:ln.current===null&&(t=!0);var Q=rt;if(rt=0,cn=null,er(e,S,U,Q),n&&Qi){y=0;break e}break;default:Q=rt,rt=0,cn=null,er(e,S,U,Q)}}_y(),y=St;break}catch(le){jh(e,le)}while(!0);return t&&e.shellSuspendCounter++,ta=si=null,at=s,C.H=c,C.A=f,Ke===null&&(ut=null,Je=0,Ms()),y}function _y(){for(;Ke!==null;)Ch(Ke)}function jy(e,t){var n=at;at|=2;var s=wh(),c=Eh();ut!==e||Je!==t?(ml=null,pl=Lt()+500,Wi(e,t)):Qi=Cn(e,t);e:do try{if(rt!==0&&Ke!==null){t=Ke;var f=cn;t:switch(rt){case 1:rt=0,cn=null,er(e,t,f,1);break;case 2:case 9:if(Dd(f)){rt=0,cn=null,Th(t);break}t=function(){rt!==2&&rt!==9||ut!==e||(rt=7),Gn(e)},f.then(t,t);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:Dd(f)?(rt=0,cn=null,Th(t)):(rt=0,cn=null,er(e,t,f,7));break;case 5:var y=null;switch(Ke.tag){case 26:y=Ke.memoizedState;case 5:case 27:var S=Ke;if(y?fg(y):S.stateNode.complete){rt=0,cn=null;var U=S.sibling;if(U!==null)Ke=U;else{var Q=S.return;Q!==null?(Ke=Q,vl(Q)):Ke=null}break t}}rt=0,cn=null,er(e,t,f,5);break;case 6:rt=0,cn=null,er(e,t,f,6);break;case 8:zc(),St=6;break e;default:throw Error(l(462))}}Sy();break}catch(le){jh(e,le)}while(!0);return ta=si=null,C.H=s,C.A=c,at=n,Ke!==null?0:(ut=null,Je=0,Ms(),St)}function Sy(){for(;Ke!==null&&!Dn();)Ch(Ke)}function Ch(e){var t=Qf(e.alternate,e,da);e.memoizedProps=e.pendingProps,t===null?vl(e):Ke=t}function Th(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Vf(n,t,t.pendingProps,t.type,void 0,Je);break;case 11:t=Vf(n,t,t.pendingProps,t.type.render,t.ref,Je);break;case 5:Jo(t);default:Zf(n,t),t=Ke=wd(t,da),t=Qf(n,t,da)}e.memoizedProps=e.pendingProps,t===null?vl(e):Ke=t}function er(e,t,n,s){ta=si=null,Jo(t),Pi=null,Lr=0;var c=t.return;try{if(dy(e,c,t,n,Je)){St=1,sl(e,mn(n,e.current)),Ke=null;return}}catch(f){if(c!==null)throw Ke=c,f;St=1,sl(e,mn(n,e.current)),Ke=null;return}t.flags&32768?(Xe||s===1?e=!0:Qi||(Je&536870912)!==0?e=!1:(Oa=e=!0,(s===2||s===9||s===3||s===6)&&(s=ln.current,s!==null&&s.tag===13&&(s.flags|=16384))),Ah(t,e)):vl(t)}function vl(e){var t=e;do{if((t.flags&32768)!==0){Ah(t,Oa);return}e=t.return;var n=gy(t.alternate,t,da);if(n!==null){Ke=n;return}if(t=t.sibling,t!==null){Ke=t;return}Ke=t=e}while(t!==null);St===0&&(St=5)}function Ah(e,t){do{var n=py(e.alternate,e);if(n!==null){n.flags&=32767,Ke=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ke=e;return}Ke=e=n}while(e!==null);St=6,Ke=null}function Nh(e,t,n,s,c,f,y,S,U){e.cancelPendingCommit=null;do xl();while(Ut!==0);if((at&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(f=t.lanes|t.childLanes,f|=jo,Cs(e,n,f,y,S,U),e===ut&&(Ke=ut=null,Je=0),Zi=t,Ua=e,fa=n,Rc=f,Oc=c,bh=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ty(Ka,function(){return Uh(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=C.T,C.T=null,c=z.p,z.p=2,y=at,at|=4;try{my(e,t,n)}finally{at=y,z.p=c,C.T=s}}Ut=1,Rh(),Oh(),kh()}}function Rh(){if(Ut===1){Ut=0;var e=Ua,t=Zi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=C.T,C.T=null;var s=z.p;z.p=2;var c=at;at|=4;try{uh(t,e);var f=Fc,y=pd(e.containerInfo),S=f.focusedElem,U=f.selectionRange;if(y!==S&&S&&S.ownerDocument&&gd(S.ownerDocument.documentElement,S)){if(U!==null&&yo(S)){var Q=U.start,le=U.end;if(le===void 0&&(le=Q),"selectionStart"in S)S.selectionStart=Q,S.selectionEnd=Math.min(le,S.value.length);else{var ge=S.ownerDocument||document,W=ge&&ge.defaultView||window;if(W.getSelection){var ne=W.getSelection(),Te=S.textContent.length,Le=Math.min(U.start,Te),ct=U.end===void 0?Le:Math.min(U.end,Te);!ne.extend&&Le>ct&&(y=ct,ct=Le,Le=y);var F=hd(S,Le),q=hd(S,ct);if(F&&q&&(ne.rangeCount!==1||ne.anchorNode!==F.node||ne.anchorOffset!==F.offset||ne.focusNode!==q.node||ne.focusOffset!==q.offset)){var J=ge.createRange();J.setStart(F.node,F.offset),ne.removeAllRanges(),Le>ct?(ne.addRange(J),ne.extend(q.node,q.offset)):(J.setEnd(q.node,q.offset),ne.addRange(J))}}}}for(ge=[],ne=S;ne=ne.parentNode;)ne.nodeType===1&&ge.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<ge.length;S++){var he=ge[S];he.element.scrollLeft=he.left,he.element.scrollTop=he.top}}kl=!!Gc,Fc=Gc=null}finally{at=c,z.p=s,C.T=n}}e.current=t,Ut=2}}function Oh(){if(Ut===2){Ut=0;var e=Ua,t=Zi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=C.T,C.T=null;var s=z.p;z.p=2;var c=at;at|=4;try{rh(e,t.alternate,t)}finally{at=c,z.p=s,C.T=n}}Ut=3}}function kh(){if(Ut===4||Ut===3){Ut=0,pa();var e=Ua,t=Zi,n=fa,s=bh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ut=5:(Ut=0,Zi=Ua=null,zh(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(za=null),An(n),t=t.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(Kn,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=C.T,c=z.p,z.p=2,C.T=null;try{for(var f=e.onRecoverableError,y=0;y<s.length;y++){var S=s[y];f(S.value,{componentStack:S.stack})}}finally{C.T=t,z.p=c}}(fa&3)!==0&&xl(),Gn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===kc?es++:(es=0,kc=e):es=0,ts(0)}}function zh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Dr(t)))}function xl(){return Rh(),Oh(),kh(),Uh()}function Uh(){if(Ut!==5)return!1;var e=Ua,t=Rc;Rc=0;var n=An(fa),s=C.T,c=z.p;try{z.p=32>n?32:n,C.T=null,n=Oc,Oc=null;var f=Ua,y=fa;if(Ut=0,Zi=Ua=null,fa=0,(at&6)!==0)throw Error(l(331));var S=at;if(at|=4,ph(f.current),fh(f,f.current,y,n),at=S,ts(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(Kn,f)}catch{}return!0}finally{z.p=c,C.T=s,zh(e,t)}}function Dh(e,t,n){t=mn(n,t),t=uc(e.stateNode,t,2),e=Ta(e,t,2),e!==null&&(Qa(e,2),Gn(e))}function st(e,t,n){if(e.tag===3)Dh(e,e,n);else for(;t!==null;){if(t.tag===3){Dh(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(za===null||!za.has(s))){e=mn(n,e),n=Bf(2),s=Ta(t,n,2),s!==null&&(Lf(n,s,t,e),Qa(s,2),Gn(s));break}}t=t.return}}function Dc(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new vy;var c=new Set;s.set(t,c)}else c=s.get(t),c===void 0&&(c=new Set,s.set(t,c));c.has(n)||(Tc=!0,c.add(n),e=wy.bind(null,e,t,n),t.then(e,e))}function wy(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ut===e&&(Je&n)===n&&(St===4||St===3&&(Je&62914560)===Je&&300>Lt()-gl?(at&2)===0&&Wi(e,0):Ac|=n,Xi===Je&&(Xi=0)),Gn(e)}function Bh(e,t){t===0&&(t=Es()),e=ai(e,t),e!==null&&(Qa(e,t),Gn(e))}function Ey(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Bh(e,n)}function Cy(e,t){var n=0;switch(e.tag){case 31:case 13:var s=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(l(314))}s!==null&&s.delete(t),Bh(e,n)}function Ty(e,t){return it(e,t)}var _l=null,tr=null,Bc=!1,jl=!1,Lc=!1,Ba=0;function Gn(e){e!==tr&&e.next===null&&(tr===null?_l=tr=e:tr=tr.next=e),jl=!0,Bc||(Bc=!0,Ny())}function ts(e,t){if(!Lc&&jl){Lc=!0;do for(var n=!1,s=_l;s!==null;){if(e!==0){var c=s.pendingLanes;if(c===0)var f=0;else{var y=s.suspendedLanes,S=s.pingedLanes;f=(1<<31-Jt(42|e)+1)-1,f&=c&~(y&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(n=!0,Ih(s,f))}else f=Je,f=Ja(s,s===ut?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(f&3)===0||Cn(s,f)||(n=!0,Ih(s,f));s=s.next}while(n);Lc=!1}}function Ay(){Lh()}function Lh(){jl=Bc=!1;var e=0;Ba!==0&&qy()&&(e=Ba);for(var t=Lt(),n=null,s=_l;s!==null;){var c=s.next,f=Mh(s,t);f===0?(s.next=null,n===null?_l=c:n.next=c,c===null&&(tr=n)):(n=s,(e!==0||(f&3)!==0)&&(jl=!0)),s=c}Ut!==0&&Ut!==5||ts(e),Ba!==0&&(Ba=0)}function Mh(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,c=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Jt(f),S=1<<y,U=c[y];U===-1?((S&n)===0||(S&s)!==0)&&(c[y]=io(S,t)):U<=t&&(e.expiredLanes|=S),f&=~S}if(t=ut,n=Je,n=Ja(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(rt===2||rt===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&nt(s),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Cn(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&nt(s),An(n)){case 2:case 8:n=_s;break;case 32:n=Ka;break;case 268435456:n=js;break;default:n=Ka}return s=qh.bind(null,e),n=it(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&nt(s),e.callbackPriority=2,e.callbackNode=null,2}function qh(e,t){if(Ut!==0&&Ut!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(xl()&&e.callbackNode!==n)return null;var s=Je;return s=Ja(e,e===ut?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(xh(e,s,t),Mh(e,Lt()),e.callbackNode!=null&&e.callbackNode===n?qh.bind(null,e):null)}function Ih(e,t){if(xl())return null;xh(e,t,!0)}function Ny(){Hy(function(){(at&6)!==0?it(Fa,Ay):Lh()})}function Mc(){if(Ba===0){var e=Ii;e===0&&(e=Ci,Ci<<=1,(Ci&261888)===0&&(Ci=256)),Ba=e}return Ba}function Hh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Pe(""+e)}function $h(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ry(e,t,n,s,c){if(t==="submit"&&n&&n.stateNode===c){var f=Hh((c[Ft]||null).action),y=s.submitter;y&&(t=(t=y[Ft]||null)?Hh(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var S=new Us("action","action",null,s,c);e.push({event:S,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(Ba!==0){var U=y?$h(c,y):new FormData(c);ic(n,{pending:!0,data:U,method:c.method,action:f},null,U)}}else typeof f=="function"&&(S.preventDefault(),U=y?$h(c,y):new FormData(c),ic(n,{pending:!0,data:U,method:c.method,action:f},f,U))},currentTarget:c}]})}}for(var qc=0;qc<_o.length;qc++){var Ic=_o[qc],Oy=Ic.toLowerCase(),ky=Ic[0].toUpperCase()+Ic.slice(1);Nn(Oy,"on"+ky)}Nn(bd,"onAnimationEnd"),Nn(vd,"onAnimationIteration"),Nn(xd,"onAnimationStart"),Nn("dblclick","onDoubleClick"),Nn("focusin","onFocus"),Nn("focusout","onBlur"),Nn(Ym,"onTransitionRun"),Nn(Jm,"onTransitionStart"),Nn(Qm,"onTransitionCancel"),Nn(_d,"onTransitionEnd"),va("onMouseEnter",["mouseout","mouseover"]),va("onMouseLeave",["mouseout","mouseover"]),va("onPointerEnter",["pointerout","pointerover"]),va("onPointerLeave",["pointerout","pointerover"]),Jn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Jn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Jn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Jn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Jn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Jn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ns="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ns));function Ph(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],c=s.event;s=s.listeners;e:{var f=void 0;if(t)for(var y=s.length-1;0<=y;y--){var S=s[y],U=S.instance,Q=S.currentTarget;if(S=S.listener,U!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=Q;try{f(c)}catch(le){Ls(le)}c.currentTarget=null,f=U}else for(y=0;y<s.length;y++){if(S=s[y],U=S.instance,Q=S.currentTarget,S=S.listener,U!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=Q;try{f(c)}catch(le){Ls(le)}c.currentTarget=null,f=U}}}}function Ye(e,t){var n=t[Xa];n===void 0&&(n=t[Xa]=new Set);var s=e+"__bubble";n.has(s)||(Vh(t,e,2,!1),n.add(s))}function Hc(e,t,n){var s=0;t&&(s|=4),Vh(n,e,s,t)}var Sl="_reactListening"+Math.random().toString(36).slice(2);function $c(e){if(!e[Sl]){e[Sl]=!0,jr.forEach(function(n){n!=="selectionchange"&&(zy.has(n)||Hc(n,!1,e),Hc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Sl]||(t[Sl]=!0,Hc("selectionchange",!1,t))}}function Vh(e,t,n,s){switch(vg(t)){case 2:var c=lb;break;case 8:c=ob;break;default:c=au}n=c.bind(null,t,n,e),c=void 0,!lo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),s?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Pc(e,t,n,s,c){var f=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var y=s.tag;if(y===3||y===4){var S=s.stateNode.containerInfo;if(S===c)break;if(y===4)for(y=s.return;y!==null;){var U=y.tag;if((U===3||U===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;S!==null;){if(y=ya(S),y===null)return;if(U=y.tag,U===5||U===6||U===26||U===27){s=f=y;continue e}S=S.parentNode}}s=s.return}Yu(function(){var Q=f,le=Xn(n),ge=[];e:{var W=jd.get(e);if(W!==void 0){var ne=Us,Te=e;switch(e){case"keypress":if(ks(n)===0)break e;case"keydown":case"keyup":ne=Cm;break;case"focusin":Te="focus",ne=fo;break;case"focusout":Te="blur",ne=fo;break;case"beforeblur":case"afterblur":ne=fo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Xu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=gm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=Nm;break;case bd:case vd:case xd:ne=ym;break;case _d:ne=Om;break;case"scroll":case"scrollend":ne=fm;break;case"wheel":ne=zm;break;case"copy":case"cut":case"paste":ne=vm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=Wu;break;case"toggle":case"beforetoggle":ne=Dm}var Le=(t&4)!==0,ct=!Le&&(e==="scroll"||e==="scrollend"),F=Le?W!==null?W+"Capture":null:W;Le=[];for(var q=Q,J;q!==null;){var he=q;if(J=he.stateNode,he=he.tag,he!==5&&he!==26&&he!==27||J===null||F===null||(he=wr(q,F),he!=null&&Le.push(as(q,he,J))),ct)break;q=q.return}0<Le.length&&(W=new ne(W,Te,null,n,le),ge.push({event:W,listeners:Le}))}}if((t&7)===0){e:{if(W=e==="mouseover"||e==="pointerover",ne=e==="mouseout"||e==="pointerout",W&&n!==Qn&&(Te=n.relatedTarget||n.fromElement)&&(ya(Te)||Te[Ln]))break e;if((ne||W)&&(W=le.window===le?le:(W=le.ownerDocument)?W.defaultView||W.parentWindow:window,ne?(Te=n.relatedTarget||n.toElement,ne=Q,Te=Te?ya(Te):null,Te!==null&&(ct=d(Te),Le=Te.tag,Te!==ct||Le!==5&&Le!==27&&Le!==6)&&(Te=null)):(ne=null,Te=Q),ne!==Te)){if(Le=Xu,he="onMouseLeave",F="onMouseEnter",q="mouse",(e==="pointerout"||e==="pointerover")&&(Le=Wu,he="onPointerLeave",F="onPointerEnter",q="pointer"),ct=ne==null?W:an(ne),J=Te==null?W:an(Te),W=new Le(he,q+"leave",ne,n,le),W.target=ct,W.relatedTarget=J,he=null,ya(le)===Q&&(Le=new Le(F,q+"enter",Te,n,le),Le.target=J,Le.relatedTarget=ct,he=Le),ct=he,ne&&Te)t:{for(Le=Uy,F=ne,q=Te,J=0,he=F;he;he=Le(he))J++;he=0;for(var Be=q;Be;Be=Le(Be))he++;for(;0<J-he;)F=Le(F),J--;for(;0<he-J;)q=Le(q),he--;for(;J--;){if(F===q||q!==null&&F===q.alternate){Le=F;break t}F=Le(F),q=Le(q)}Le=null}else Le=null;ne!==null&&Gh(ge,W,ne,Le,!1),Te!==null&&ct!==null&&Gh(ge,ct,Te,Le,!0)}}e:{if(W=Q?an(Q):window,ne=W.nodeName&&W.nodeName.toLowerCase(),ne==="select"||ne==="input"&&W.type==="file")var et=ld;else if(rd(W))if(od)et=Gm;else{et=Pm;var Ne=$m}else ne=W.nodeName,!ne||ne.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?Q&&qe(Q.elementType)&&(et=ld):et=Vm;if(et&&(et=et(e,Q))){sd(ge,et,n,le);break e}Ne&&Ne(e,W,Q),e==="focusout"&&Q&&W.type==="number"&&Q.memoizedProps.value!=null&&yt(W,"number",W.value)}switch(Ne=Q?an(Q):window,e){case"focusin":(rd(Ne)||Ne.contentEditable==="true")&&(ki=Ne,bo=Q,kr=null);break;case"focusout":kr=bo=ki=null;break;case"mousedown":vo=!0;break;case"contextmenu":case"mouseup":case"dragend":vo=!1,md(ge,n,le);break;case"selectionchange":if(Km)break;case"keydown":case"keyup":md(ge,n,le)}var Ve;if(go)e:{switch(e){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else Oi?ad(e,n)&&(Qe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Qe="onCompositionStart");Qe&&(ed&&n.locale!=="ko"&&(Oi||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&Oi&&(Ve=Ju()):(xa=le,oo="value"in xa?xa.value:xa.textContent,Oi=!0)),Ne=wl(Q,Qe),0<Ne.length&&(Qe=new Zu(Qe,e,null,n,le),ge.push({event:Qe,listeners:Ne}),Ve?Qe.data=Ve:(Ve=id(n),Ve!==null&&(Qe.data=Ve)))),(Ve=Lm?Mm(e,n):qm(e,n))&&(Qe=wl(Q,"onBeforeInput"),0<Qe.length&&(Ne=new Zu("onBeforeInput","beforeinput",null,n,le),ge.push({event:Ne,listeners:Qe}),Ne.data=Ve)),Ry(ge,e,Q,n,le)}Ph(ge,t)})}function as(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wl(e,t){for(var n=t+"Capture",s=[];e!==null;){var c=e,f=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||f===null||(c=wr(e,n),c!=null&&s.unshift(as(e,c,f)),c=wr(e,t),c!=null&&s.push(as(e,c,f))),e.tag===3)return s;e=e.return}return[]}function Uy(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Gh(e,t,n,s,c){for(var f=t._reactName,y=[];n!==null&&n!==s;){var S=n,U=S.alternate,Q=S.stateNode;if(S=S.tag,U!==null&&U===s)break;S!==5&&S!==26&&S!==27||Q===null||(U=Q,c?(Q=wr(n,f),Q!=null&&y.unshift(as(n,Q,U))):c||(Q=wr(n,f),Q!=null&&y.push(as(n,Q,U)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var Dy=/\r\n?/g,By=/\u0000|\uFFFD/g;function Fh(e){return(typeof e=="string"?e:""+e).replace(Dy,`
`).replace(By,"")}function Kh(e,t){return t=Fh(t),Fh(e)===t}function ot(e,t,n,s,c,f){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||In(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&In(e,""+s);break;case"className":je(e,"class",s);break;case"tabIndex":je(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":je(e,n,s);break;case"style":Ce(e,s,f);break;case"data":if(t!=="object"){je(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Pe(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(n==="formAction"?(t!=="input"&&ot(e,t,"name",c.name,c,null),ot(e,t,"formEncType",c.formEncType,c,null),ot(e,t,"formMethod",c.formMethod,c,null),ot(e,t,"formTarget",c.formTarget,c,null)):(ot(e,t,"encType",c.encType,c,null),ot(e,t,"method",c.method,c,null),ot(e,t,"target",c.target,c,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Pe(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=Ge);break;case"onScroll":s!=null&&Ye("scroll",e);break;case"onScrollEnd":s!=null&&Ye("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(l(61));if(n=s.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=Pe(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":Ye("beforetoggle",e),Ye("toggle",e),pe(e,"popover",s);break;case"xlinkActuate":_e(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":_e(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":_e(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":_e(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":_e(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":_e(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":_e(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":_e(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":_e(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":pe(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=We.get(n)||n,pe(e,n,s))}}function Vc(e,t,n,s,c,f){switch(n){case"style":Ce(e,s,f);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(l(61));if(n=s.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof s=="string"?In(e,s):(typeof s=="number"||typeof s=="bigint")&&In(e,""+s);break;case"onScroll":s!=null&&Ye("scroll",e);break;case"onScrollEnd":s!=null&&Ye("scrollend",e);break;case"onClick":s!=null&&(e.onclick=Ge);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rs.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),f=e[Ft]||null,f=f!=null?f[n]:null,typeof f=="function"&&e.removeEventListener(t,f,c),typeof s=="function")){typeof f!="function"&&f!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,c);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):pe(e,n,s)}}}function Pt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ye("error",e),Ye("load",e);var s=!1,c=!1,f;for(f in n)if(n.hasOwnProperty(f)){var y=n[f];if(y!=null)switch(f){case"src":s=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:ot(e,t,f,y,n,null)}}c&&ot(e,t,"srcSet",n.srcSet,n,null),s&&ot(e,t,"src",n.src,n,null);return;case"input":Ye("invalid",e);var S=f=y=c=null,U=null,Q=null;for(s in n)if(n.hasOwnProperty(s)){var le=n[s];if(le!=null)switch(s){case"name":c=le;break;case"type":y=le;break;case"checked":U=le;break;case"defaultChecked":Q=le;break;case"value":f=le;break;case"defaultValue":S=le;break;case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(l(137,t));break;default:ot(e,t,s,le,n,null)}}Ze(e,f,S,U,Q,y,c,!1);return;case"select":Ye("invalid",e),s=y=f=null;for(c in n)if(n.hasOwnProperty(c)&&(S=n[c],S!=null))switch(c){case"value":f=S;break;case"defaultValue":y=S;break;case"multiple":s=S;default:ot(e,t,c,S,n,null)}t=f,n=y,e.multiple=!!s,t!=null?_t(e,!!s,t,!1):n!=null&&_t(e,!!s,n,!0);return;case"textarea":Ye("invalid",e),f=c=s=null;for(y in n)if(n.hasOwnProperty(y)&&(S=n[y],S!=null))switch(y){case"value":s=S;break;case"defaultValue":c=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(l(91));break;default:ot(e,t,y,S,n,null)}Sr(e,s,c,f);return;case"option":for(U in n)if(n.hasOwnProperty(U)&&(s=n[U],s!=null))switch(U){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:ot(e,t,U,s,n,null)}return;case"dialog":Ye("beforetoggle",e),Ye("toggle",e),Ye("cancel",e),Ye("close",e);break;case"iframe":case"object":Ye("load",e);break;case"video":case"audio":for(s=0;s<ns.length;s++)Ye(ns[s],e);break;case"image":Ye("error",e),Ye("load",e);break;case"details":Ye("toggle",e);break;case"embed":case"source":case"link":Ye("error",e),Ye("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in n)if(n.hasOwnProperty(Q)&&(s=n[Q],s!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:ot(e,t,Q,s,n,null)}return;default:if(qe(t)){for(le in n)n.hasOwnProperty(le)&&(s=n[le],s!==void 0&&Vc(e,t,le,s,n,void 0));return}}for(S in n)n.hasOwnProperty(S)&&(s=n[S],s!=null&&ot(e,t,S,s,n,null))}function Ly(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,f=null,y=null,S=null,U=null,Q=null,le=null;for(ne in n){var ge=n[ne];if(n.hasOwnProperty(ne)&&ge!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":U=ge;default:s.hasOwnProperty(ne)||ot(e,t,ne,null,s,ge)}}for(var W in s){var ne=s[W];if(ge=n[W],s.hasOwnProperty(W)&&(ne!=null||ge!=null))switch(W){case"type":f=ne;break;case"name":c=ne;break;case"checked":Q=ne;break;case"defaultChecked":le=ne;break;case"value":y=ne;break;case"defaultValue":S=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(l(137,t));break;default:ne!==ge&&ot(e,t,W,ne,s,ge)}}Ie(e,y,S,U,Q,le,f,c);return;case"select":ne=y=S=W=null;for(f in n)if(U=n[f],n.hasOwnProperty(f)&&U!=null)switch(f){case"value":break;case"multiple":ne=U;default:s.hasOwnProperty(f)||ot(e,t,f,null,s,U)}for(c in s)if(f=s[c],U=n[c],s.hasOwnProperty(c)&&(f!=null||U!=null))switch(c){case"value":W=f;break;case"defaultValue":S=f;break;case"multiple":y=f;default:f!==U&&ot(e,t,c,f,s,U)}t=S,n=y,s=ne,W!=null?_t(e,!!n,W,!1):!!s!=!!n&&(t!=null?_t(e,!!n,t,!0):_t(e,!!n,n?[]:"",!1));return;case"textarea":ne=W=null;for(S in n)if(c=n[S],n.hasOwnProperty(S)&&c!=null&&!s.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:ot(e,t,S,null,s,c)}for(y in s)if(c=s[y],f=n[y],s.hasOwnProperty(y)&&(c!=null||f!=null))switch(y){case"value":W=c;break;case"defaultValue":ne=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==f&&ot(e,t,y,c,s,f)}qn(e,W,ne);return;case"option":for(var Te in n)if(W=n[Te],n.hasOwnProperty(Te)&&W!=null&&!s.hasOwnProperty(Te))switch(Te){case"selected":e.selected=!1;break;default:ot(e,t,Te,null,s,W)}for(U in s)if(W=s[U],ne=n[U],s.hasOwnProperty(U)&&W!==ne&&(W!=null||ne!=null))switch(U){case"selected":e.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:ot(e,t,U,W,s,ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Le in n)W=n[Le],n.hasOwnProperty(Le)&&W!=null&&!s.hasOwnProperty(Le)&&ot(e,t,Le,null,s,W);for(Q in s)if(W=s[Q],ne=n[Q],s.hasOwnProperty(Q)&&W!==ne&&(W!=null||ne!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(l(137,t));break;default:ot(e,t,Q,W,s,ne)}return;default:if(qe(t)){for(var ct in n)W=n[ct],n.hasOwnProperty(ct)&&W!==void 0&&!s.hasOwnProperty(ct)&&Vc(e,t,ct,void 0,s,W);for(le in s)W=s[le],ne=n[le],!s.hasOwnProperty(le)||W===ne||W===void 0&&ne===void 0||Vc(e,t,le,W,s,ne);return}}for(var F in n)W=n[F],n.hasOwnProperty(F)&&W!=null&&!s.hasOwnProperty(F)&&ot(e,t,F,null,s,W);for(ge in s)W=s[ge],ne=n[ge],!s.hasOwnProperty(ge)||W===ne||W==null&&ne==null||ot(e,t,ge,W,s,ne)}function Yh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function My(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),s=0;s<n.length;s++){var c=n[s],f=c.transferSize,y=c.initiatorType,S=c.duration;if(f&&S&&Yh(y)){for(y=0,S=c.responseEnd,s+=1;s<n.length;s++){var U=n[s],Q=U.startTime;if(Q>S)break;var le=U.transferSize,ge=U.initiatorType;le&&Yh(ge)&&(U=U.responseEnd,y+=le*(U<S?1:(S-Q)/(U-Q)))}if(--s,t+=8*(f+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Gc=null,Fc=null;function El(e){return e.nodeType===9?e:e.ownerDocument}function Jh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qh(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Kc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yc=null;function qy(){var e=window.event;return e&&e.type==="popstate"?e===Yc?!1:(Yc=e,!0):(Yc=null,!1)}var Xh=typeof setTimeout=="function"?setTimeout:void 0,Iy=typeof clearTimeout=="function"?clearTimeout:void 0,Zh=typeof Promise=="function"?Promise:void 0,Hy=typeof queueMicrotask=="function"?queueMicrotask:typeof Zh<"u"?function(e){return Zh.resolve(null).then(e).catch($y)}:Xh;function $y(e){setTimeout(function(){throw e})}function La(e){return e==="head"}function Wh(e,t){var n=t,s=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(s===0){e.removeChild(c),rr(t);return}s--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")s++;else if(n==="html")is(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,is(n);for(var f=n.firstChild;f;){var y=f.nextSibling,S=f.nodeName;f[Za]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||n.removeChild(f),f=y}}else n==="body"&&is(e.ownerDocument.body);n=c}while(n);rr(t)}function eg(e,t){var n=e;e=0;do{var s=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=s}while(n)}function Jc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Jc(n),Ai(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Py(e,t,n,s){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[Za])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=_n(e.nextSibling),e===null)break}return null}function Vy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=_n(e.nextSibling),e===null))return null;return e}function tg(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=_n(e.nextSibling),e===null))return null;return e}function Qc(e){return e.data==="$?"||e.data==="$~"}function Xc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Gy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function _n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Zc=null;function ng(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return _n(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function ag(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function ig(e,t,n){switch(t=El(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function is(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ai(e)}var jn=new Map,rg=new Set;function Cl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ha=z.d;z.d={f:Fy,r:Ky,D:Yy,C:Jy,L:Qy,m:Xy,X:Wy,S:Zy,M:eb};function Fy(){var e=ha.f(),t=yl();return e||t}function Ky(e){var t=Mn(e);t!==null&&t.tag===5&&t.type==="form"?jf(t):ha.r(e)}var nr=typeof document>"u"?null:document;function sg(e,t,n){var s=nr;if(s&&typeof t=="string"&&t){var c=mt(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),rg.has(c)||(rg.add(c),e={rel:e,crossOrigin:n,href:t},s.querySelector(c)===null&&(t=s.createElement("link"),Pt(t,"link",e),Et(t),s.head.appendChild(t)))}}function Yy(e){ha.D(e),sg("dns-prefetch",e,null)}function Jy(e,t){ha.C(e,t),sg("preconnect",e,t)}function Qy(e,t,n){ha.L(e,t,n);var s=nr;if(s&&e&&t){var c='link[rel="preload"][as="'+mt(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+mt(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+mt(n.imageSizes)+'"]')):c+='[href="'+mt(e)+'"]';var f=c;switch(t){case"style":f=ar(e);break;case"script":f=ir(e)}jn.has(f)||(e=x({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),jn.set(f,e),s.querySelector(c)!==null||t==="style"&&s.querySelector(rs(f))||t==="script"&&s.querySelector(ss(f))||(t=s.createElement("link"),Pt(t,"link",e),Et(t),s.head.appendChild(t)))}}function Xy(e,t){ha.m(e,t);var n=nr;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+mt(s)+'"][href="'+mt(e)+'"]',f=c;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=ir(e)}if(!jn.has(f)&&(e=x({rel:"modulepreload",href:e},t),jn.set(f,e),n.querySelector(c)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(ss(f)))return}s=n.createElement("link"),Pt(s,"link",e),Et(s),n.head.appendChild(s)}}}function Zy(e,t,n){ha.S(e,t,n);var s=nr;if(s&&e){var c=ba(s).hoistableStyles,f=ar(e);t=t||"default";var y=c.get(f);if(!y){var S={loading:0,preload:null};if(y=s.querySelector(rs(f)))S.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},n),(n=jn.get(f))&&Wc(e,n);var U=y=s.createElement("link");Et(U),Pt(U,"link",e),U._p=new Promise(function(Q,le){U.onload=Q,U.onerror=le}),U.addEventListener("load",function(){S.loading|=1}),U.addEventListener("error",function(){S.loading|=2}),S.loading|=4,Tl(y,t,s)}y={type:"stylesheet",instance:y,count:1,state:S},c.set(f,y)}}}function Wy(e,t){ha.X(e,t);var n=nr;if(n&&e){var s=ba(n).hoistableScripts,c=ir(e),f=s.get(c);f||(f=n.querySelector(ss(c)),f||(e=x({src:e,async:!0},t),(t=jn.get(c))&&eu(e,t),f=n.createElement("script"),Et(f),Pt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},s.set(c,f))}}function eb(e,t){ha.M(e,t);var n=nr;if(n&&e){var s=ba(n).hoistableScripts,c=ir(e),f=s.get(c);f||(f=n.querySelector(ss(c)),f||(e=x({src:e,async:!0,type:"module"},t),(t=jn.get(c))&&eu(e,t),f=n.createElement("script"),Et(f),Pt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},s.set(c,f))}}function lg(e,t,n,s){var c=(c=oe.current)?Cl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=ar(n.href),n=ba(c).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=ar(n.href);var f=ba(c).hoistableStyles,y=f.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=c.querySelector(rs(e)))&&!f._p&&(y.instance=f,y.state.loading=5),jn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},jn.set(e,n),f||tb(c,e,n,y.state))),t&&s===null)throw Error(l(528,""));return y}if(t&&s!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=ir(n),n=ba(c).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function ar(e){return'href="'+mt(e)+'"'}function rs(e){return'link[rel="stylesheet"]['+e+"]"}function og(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function tb(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),Pt(t,"link",n),Et(t),e.head.appendChild(t))}function ir(e){return'[src="'+mt(e)+'"]'}function ss(e){return"script[async]"+e}function cg(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+mt(n.href)+'"]');if(s)return t.instance=s,Et(s),s;var c=x({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),Et(s),Pt(s,"style",c),Tl(s,n.precedence,e),t.instance=s;case"stylesheet":c=ar(n.href);var f=e.querySelector(rs(c));if(f)return t.state.loading|=4,t.instance=f,Et(f),f;s=og(n),(c=jn.get(c))&&Wc(s,c),f=(e.ownerDocument||e).createElement("link"),Et(f);var y=f;return y._p=new Promise(function(S,U){y.onload=S,y.onerror=U}),Pt(f,"link",s),t.state.loading|=4,Tl(f,n.precedence,e),t.instance=f;case"script":return f=ir(n.src),(c=e.querySelector(ss(f)))?(t.instance=c,Et(c),c):(s=n,(c=jn.get(f))&&(s=x({},n),eu(s,c)),e=e.ownerDocument||e,c=e.createElement("script"),Et(c),Pt(c,"link",s),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,Tl(s,n.precedence,e));return t.instance}function Tl(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=s.length?s[s.length-1]:null,f=c,y=0;y<s.length;y++){var S=s[y];if(S.dataset.precedence===t)f=S;else if(f!==c)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Wc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function eu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var Al=null;function ug(e,t,n){if(Al===null){var s=new Map,c=Al=new Map;c.set(n,s)}else c=Al,s=c.get(n),s||(s=new Map,c.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var f=n[c];if(!(f[Za]||f[wt]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var S=s.get(y);S?S.push(f):s.set(y,[f])}}return s}function dg(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function nb(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function fg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function ab(e,t,n,s){if(n.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=ar(s.href),f=t.querySelector(rs(c));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=Nl.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=f,Et(f);return}f=t.ownerDocument||t,s=og(s),(c=jn.get(c))&&Wc(s,c),f=f.createElement("link"),Et(f);var y=f;y._p=new Promise(function(S,U){y.onload=S,y.onerror=U}),Pt(f,"link",s),n.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=Nl.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var tu=0;function ib(e,t){return e.stylesheets&&e.count===0&&Ol(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var s=setTimeout(function(){if(e.stylesheets&&Ol(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&tu===0&&(tu=62500*My());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Ol(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>tu?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(s),clearTimeout(c)}}:null}function Nl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ol(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var Rl=null;function Ol(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,Rl=new Map,t.forEach(rb,e),Rl=null,Nl.call(e))}function rb(e,t){if(!(t.state.loading&4)){var n=Rl.get(e);if(n)var s=n.get(null);else{n=new Map,Rl.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<c.length;f++){var y=c[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),s=y)}s&&n.set(null,s)}c=t.instance,y=c.getAttribute("data-precedence"),f=n.get(y)||s,f===s&&n.set(null,c),n.set(y,c),this.count++,s=Nl.bind(this),c.addEventListener("load",s),c.addEventListener("error",s),f?f.parentNode.insertBefore(c,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var ls={$$typeof:M,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function sb(e,t,n,s,c,f,y,S,U){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=br(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=br(0),this.hiddenUpdates=br(null),this.identifierPrefix=s,this.onUncaughtError=c,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function hg(e,t,n,s,c,f,y,S,U,Q,le,ge){return e=new sb(e,t,n,y,U,Q,le,ge,S),t=1,f===!0&&(t|=24),f=sn(3,null,null,t),e.current=f,f.stateNode=e,t=Uo(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:s,isDehydrated:n,cache:t},Mo(f),e}function gg(e){return e?(e=Di,e):Di}function pg(e,t,n,s,c,f){c=gg(c),s.context===null?s.context=c:s.pendingContext=c,s=Ca(t),s.payload={element:n},f=f===void 0?null:f,f!==null&&(s.callback=f),n=Ta(e,s,t),n!==null&&(nn(n,e,t),qr(n,e,t))}function mg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function nu(e,t){mg(e,t),(e=e.alternate)&&mg(e,t)}function yg(e){if(e.tag===13||e.tag===31){var t=ai(e,67108864);t!==null&&nn(t,e,67108864),nu(e,67108864)}}function bg(e){if(e.tag===13||e.tag===31){var t=dn();t=Tn(t);var n=ai(e,t);n!==null&&nn(n,e,t),nu(e,t)}}var kl=!0;function lb(e,t,n,s){var c=C.T;C.T=null;var f=z.p;try{z.p=2,au(e,t,n,s)}finally{z.p=f,C.T=c}}function ob(e,t,n,s){var c=C.T;C.T=null;var f=z.p;try{z.p=8,au(e,t,n,s)}finally{z.p=f,C.T=c}}function au(e,t,n,s){if(kl){var c=iu(s);if(c===null)Pc(e,t,s,zl,n),xg(e,s);else if(ub(c,e,t,n,s))s.stopPropagation();else if(xg(e,s),t&4&&-1<cb.indexOf(e)){for(;c!==null;){var f=Mn(c);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=Yn(f.pendingLanes);if(y!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var U=1<<31-Jt(y);S.entanglements[1]|=U,y&=~U}Gn(f),(at&6)===0&&(pl=Lt()+500,ts(0))}}break;case 31:case 13:S=ai(f,2),S!==null&&nn(S,f,2),yl(),nu(f,2)}if(f=iu(s),f===null&&Pc(e,t,s,zl,n),f===c)break;c=f}c!==null&&s.stopPropagation()}else Pc(e,t,s,null,n)}}function iu(e){return e=Xn(e),ru(e)}var zl=null;function ru(e){if(zl=null,e=ya(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=h(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return zl=e,null}function vg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(no()){case Fa:return 2;case _s:return 8;case Ka:case yr:return 32;case js:return 268435456;default:return 32}default:return 32}}var su=!1,Ma=null,qa=null,Ia=null,os=new Map,cs=new Map,Ha=[],cb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xg(e,t){switch(e){case"focusin":case"focusout":Ma=null;break;case"dragenter":case"dragleave":qa=null;break;case"mouseover":case"mouseout":Ia=null;break;case"pointerover":case"pointerout":os.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":cs.delete(t.pointerId)}}function us(e,t,n,s,c,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:f,targetContainers:[c]},t!==null&&(t=Mn(t),t!==null&&yg(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function ub(e,t,n,s,c){switch(t){case"focusin":return Ma=us(Ma,e,t,n,s,c),!0;case"dragenter":return qa=us(qa,e,t,n,s,c),!0;case"mouseover":return Ia=us(Ia,e,t,n,s,c),!0;case"pointerover":var f=c.pointerId;return os.set(f,us(os.get(f)||null,e,t,n,s,c)),!0;case"gotpointercapture":return f=c.pointerId,cs.set(f,us(cs.get(f)||null,e,t,n,s,c)),!0}return!1}function _g(e){var t=ya(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){e.blockedOn=t,As(e.priority,function(){bg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,As(e.priority,function(){bg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ul(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=iu(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Qn=s,n.target.dispatchEvent(s),Qn=null}else return t=Mn(n),t!==null&&yg(t),e.blockedOn=n,!1;t.shift()}return!0}function jg(e,t,n){Ul(e)&&n.delete(t)}function db(){su=!1,Ma!==null&&Ul(Ma)&&(Ma=null),qa!==null&&Ul(qa)&&(qa=null),Ia!==null&&Ul(Ia)&&(Ia=null),os.forEach(jg),cs.forEach(jg)}function Dl(e,t){e.blockedOn===t&&(e.blockedOn=null,su||(su=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,db)))}var Bl=null;function Sg(e){Bl!==e&&(Bl=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){Bl===e&&(Bl=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],c=e[t+2];if(typeof s!="function"){if(ru(s||n)===null)continue;break}var f=Mn(n);f!==null&&(e.splice(t,3),t-=3,ic(f,{pending:!0,data:c,method:n.method,action:s},s,c))}}))}function rr(e){function t(U){return Dl(U,e)}Ma!==null&&Dl(Ma,e),qa!==null&&Dl(qa,e),Ia!==null&&Dl(Ia,e),os.forEach(t),cs.forEach(t);for(var n=0;n<Ha.length;n++){var s=Ha[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Ha.length&&(n=Ha[0],n.blockedOn===null);)_g(n),n.blockedOn===null&&Ha.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var c=n[s],f=n[s+1],y=c[Ft]||null;if(typeof f=="function")y||Sg(n);else if(y){var S=null;if(f&&f.hasAttribute("formAction")){if(c=f,y=f[Ft]||null)S=y.formAction;else if(ru(c)!==null)continue}else S=y.action;typeof S=="function"?n[s+1]=S:(n.splice(s,3),s-=3),Sg(n)}}}function wg(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),s||setTimeout(n,20)}function n(){if(!s&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var s=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){s=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function lu(e){this._internalRoot=e}Ll.prototype.render=lu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,s=dn();pg(n,s,e,t,null,null)},Ll.prototype.unmount=lu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;pg(e.current,2,null,e,null,null),yl(),t[Ln]=null}};function Ll(e){this._internalRoot=e}Ll.prototype.unstable_scheduleHydration=function(e){if(e){var t=_r();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ha.length&&t!==0&&t<Ha[n].priority;n++);Ha.splice(n,0,e),n===0&&_g(e)}};var Eg=a.version;if(Eg!=="19.2.0")throw Error(l(527,Eg,"19.2.0"));z.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?b(e):null,e=e===null?null:e.stateNode,e};var fb={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:C,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ml.isDisabled&&Ml.supportsFiber)try{Kn=Ml.inject(fb),Gt=Ml}catch{}}return fs.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,s="",c=kf,f=zf,y=Uf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=hg(e,1,!1,null,null,n,s,null,c,f,y,wg),e[Ln]=t.current,$c(e),new lu(t)},fs.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var s=!1,c="",f=kf,y=zf,S=Uf,U=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(S=n.onRecoverableError),n.formState!==void 0&&(U=n.formState)),t=hg(e,1,!0,t,n??null,s,c,U,f,y,S,wg),t.context=gg(null),n=t.current,s=dn(),s=Tn(s),c=Ca(s),c.callback=null,Ta(n,c,s),n=s,t.current.lanes=n,Qa(t,n),Gn(t),e[Ln]=t.current,$c(e),new Ll(t)},fs.version="19.2.0",fs}var Dg;function Sb(){if(Dg)return cu.exports;Dg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),cu.exports=jb(),cu.exports}var wb=Sb(),j=Bu();const Wl=gp(j);var Su=function(o,a){return Su=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,l){r.__proto__=l}||function(r,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(r[u]=l[u])},Su(o,a)};function mp(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");Su(o,a);function r(){this.constructor=o}o.prototype=a===null?Object.create(a):(r.prototype=a.prototype,new r)}var Yl=function(){return Yl=Object.assign||function(a){for(var r,l=1,u=arguments.length;l<u;l++){r=arguments[l];for(var d in r)Object.prototype.hasOwnProperty.call(r,d)&&(a[d]=r[d])}return a},Yl.apply(this,arguments)};function pr(o,a){var r={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(r[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(r[l[u]]=o[l[u]]);return r}function yp(o,a,r,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,r):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,r,l);else for(var g=o.length-1;g>=0;g--)(h=o[g])&&(d=(u<3?h(d):u>3?h(a,r,d):h(a,r))||d);return u>3&&d&&Object.defineProperty(a,r,d),d}function bp(o,a){return function(r,l){a(r,l,o)}}function vp(o,a,r,l,u,d){function h(A){if(A!==void 0&&typeof A!="function")throw new TypeError("Function expected");return A}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,b=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),x,_=!1,v=r.length-1;v>=0;v--){var w={};for(var N in l)w[N]=N==="access"?{}:l[N];for(var N in l.access)w.access[N]=l.access[N];w.addInitializer=function(A){if(_)throw new TypeError("Cannot add initializers after decoration has completed");d.push(h(A||null))};var R=(0,r[v])(g==="accessor"?{get:b.get,set:b.set}:b[p],w);if(g==="accessor"){if(R===void 0)continue;if(R===null||typeof R!="object")throw new TypeError("Object expected");(x=h(R.get))&&(b.get=x),(x=h(R.set))&&(b.set=x),(x=h(R.init))&&u.unshift(x)}else(x=h(R))&&(g==="field"?u.unshift(x):b[p]=x)}m&&Object.defineProperty(m,l.name,b),_=!0}function xp(o,a,r){for(var l=arguments.length>2,u=0;u<a.length;u++)r=l?a[u].call(o,r):a[u].call(o);return l?r:void 0}function _p(o){return typeof o=="symbol"?o:"".concat(o)}function jp(o,a,r){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:r?"".concat(r," ",a):a})}function Sp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function Oe(o,a,r,l){function u(d){return d instanceof r?d:new r(function(h){h(d)})}return new(r||(r=Promise))(function(d,h){function g(b){try{m(l.next(b))}catch(x){h(x)}}function p(b){try{m(l.throw(b))}catch(x){h(x)}}function m(b){b.done?d(b.value):u(b.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function wp(o,a){var r={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=g(0),h.throw=g(1),h.return=g(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(b){return p([m,b])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;h&&(h=0,m[0]&&(r=0)),r;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,u=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(d=r.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){r.label=m[1];break}if(m[0]===6&&r.label<d[1]){r.label=d[1],d=m;break}if(d&&r.label<d[2]){r.label=d[2],r.ops.push(m);break}d[2]&&r.ops.pop(),r.trys.pop();continue}m=a.call(o,r)}catch(b){m=[6,b],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var eo=Object.create?(function(o,a,r,l){l===void 0&&(l=r);var u=Object.getOwnPropertyDescriptor(a,r);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[r]}}),Object.defineProperty(o,l,u)}):(function(o,a,r,l){l===void 0&&(l=r),o[l]=a[r]});function Ep(o,a){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(a,r)&&eo(a,o,r)}function Jl(o){var a=typeof Symbol=="function"&&Symbol.iterator,r=a&&o[a],l=0;if(r)return r.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Lu(o,a){var r=typeof Symbol=="function"&&o[Symbol.iterator];if(!r)return o;var l=r.call(o),u,d=[],h;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){h={error:g}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(h)throw h.error}}return d}function Cp(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(Lu(arguments[a]));return o}function Tp(){for(var o=0,a=0,r=arguments.length;a<r;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<r;a++)for(var d=arguments[a],h=0,g=d.length;h<g;h++,u++)l[u]=d[h];return l}function Ap(o,a,r){if(r||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function gr(o){return this instanceof gr?(this.v=o,this):new gr(o)}function Np(o,a,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=r.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",h),u[Symbol.asyncIterator]=function(){return this},u;function h(v){return function(w){return Promise.resolve(w).then(v,x)}}function g(v,w){l[v]&&(u[v]=function(N){return new Promise(function(R,A){d.push([v,N,R,A])>1||p(v,N)})},w&&(u[v]=w(u[v])))}function p(v,w){try{m(l[v](w))}catch(N){_(d[0][3],N)}}function m(v){v.value instanceof gr?Promise.resolve(v.value.v).then(b,x):_(d[0][2],v)}function b(v){p("next",v)}function x(v){p("throw",v)}function _(v,w){v(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function Rp(o){var a,r;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(h){return(r=!r)?{value:gr(o[u](h)),done:!1}:d?d(h):h}:d}}function Op(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],r;return a?a.call(o):(o=typeof Jl=="function"?Jl(o):o[Symbol.iterator](),r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r);function l(d){r[d]=o[d]&&function(h){return new Promise(function(g,p){h=o[d](h),u(g,p,h.done,h.value)})}}function u(d,h,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},h)}}function kp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var Eb=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},wu=function(o){return wu=Object.getOwnPropertyNames||function(a){var r=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(r[r.length]=l);return r},wu(o)};function zp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var r=wu(o),l=0;l<r.length;l++)r[l]!=="default"&&eo(a,o,r[l]);return Eb(a,o),a}function Up(o){return o&&o.__esModule?o:{default:o}}function Dp(o,a,r,l){if(r==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?l:r==="a"?l.call(o):l?l.value:a.get(o)}function Bp(o,a,r,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,r):u?u.value=r:a.set(o,r),r}function Lp(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function Mp(o,a,r){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],r&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:r})}else r&&o.stack.push({async:!0});return a}var Cb=typeof SuppressedError=="function"?SuppressedError:function(o,a,r){var l=new Error(r);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function qp(o){function a(d){o.error=o.hasError?new Cb(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var r,l=0;function u(){for(;r=o.stack.pop();)try{if(!r.async&&l===1)return l=0,o.stack.push(r),Promise.resolve().then(u);if(r.dispose){var d=r.dispose.call(r.value);if(r.async)return l|=2,Promise.resolve(d).then(u,function(h){return a(h),u()})}else l|=1}catch(h){a(h)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function Ip(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,l,u,d,h){return l?a?".jsx":".js":u&&(!d||!h)?r:u+d+"."+h.toLowerCase()+"js"}):o}const Tb={__extends:mp,__assign:Yl,__rest:pr,__decorate:yp,__param:bp,__esDecorate:vp,__runInitializers:xp,__propKey:_p,__setFunctionName:jp,__metadata:Sp,__awaiter:Oe,__generator:wp,__createBinding:eo,__exportStar:Ep,__values:Jl,__read:Lu,__spread:Cp,__spreadArrays:Tp,__spreadArray:Ap,__await:gr,__asyncGenerator:Np,__asyncDelegator:Rp,__asyncValues:Op,__makeTemplateObject:kp,__importStar:zp,__importDefault:Up,__classPrivateFieldGet:Dp,__classPrivateFieldSet:Bp,__classPrivateFieldIn:Lp,__addDisposableResource:Mp,__disposeResources:qp,__rewriteRelativeImportExtension:Ip},Ab=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Mp,get __assign(){return Yl},__asyncDelegator:Rp,__asyncGenerator:Np,__asyncValues:Op,__await:gr,__awaiter:Oe,__classPrivateFieldGet:Dp,__classPrivateFieldIn:Lp,__classPrivateFieldSet:Bp,__createBinding:eo,__decorate:yp,__disposeResources:qp,__esDecorate:vp,__exportStar:Ep,__extends:mp,__generator:wp,__importDefault:Up,__importStar:zp,__makeTemplateObject:kp,__metadata:Sp,__param:bp,__propKey:_p,__read:Lu,__rest:pr,__rewriteRelativeImportExtension:Ip,__runInitializers:xp,__setFunctionName:jp,__spread:Cp,__spreadArray:Ap,__spreadArrays:Tp,__values:Jl,default:Tb},Symbol.toStringTag,{value:"Module"})),Nb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Mu extends Error{constructor(a,r="FunctionsError",l){super(a),this.name=r,this.context=l}}class Rb extends Mu{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Bg extends Mu{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Lg extends Mu{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var Eu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(Eu||(Eu={}));class Ob{constructor(a,{headers:r={},customFetch:l,region:u=Eu.Any}={}){this.url=a,this.headers=r,this.region=u,this.fetch=Nb(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return Oe(this,arguments,void 0,function*(r,l={}){var u;let d,h;try{const{headers:g,method:p,body:m,signal:b,timeout:x}=l;let _={},{region:v}=l;v||(v=this.region);const w=new URL(`${this.url}/${r}`);v&&v!=="any"&&(_["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let N;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",N=m):typeof m=="string"?(_["Content-Type"]="text/plain",N=m):typeof FormData<"u"&&m instanceof FormData?N=m:(_["Content-Type"]="application/json",N=JSON.stringify(m)):N=m;let R=b;x&&(h=new AbortController,d=setTimeout(()=>h.abort(),x),b?(R=h.signal,b.addEventListener("abort",()=>h.abort())):R=h.signal);const A=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),g),body:N,signal:R}).catch(E=>{throw new Rb(E)}),$=A.headers.get("x-relay-error");if($&&$==="true")throw new Bg(A);if(!A.ok)throw new Lg(A);let M=((u=A.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),G;return M==="application/json"?G=yield A.json():M==="application/octet-stream"||M==="application/pdf"?G=yield A.blob():M==="text/event-stream"?G=A:M==="multipart/form-data"?G=yield A.formData():G=yield A.text(),{data:G,error:null,response:A}}catch(g){return{data:null,error:g,response:g instanceof Lg||g instanceof Bg?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Yt={};const mr=pb(Ab);var ql={},Il={},Hl={},$l={},Pl={},Vl={},Mg;function Hp(){if(Mg)return Vl;Mg=1,Object.defineProperty(Vl,"__esModule",{value:!0});class o extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Vl.default=o,Vl}var qg;function $p(){if(qg)return Pl;qg=1,Object.defineProperty(Pl,"__esModule",{value:!0});const a=mr.__importDefault(Hp());class r{constructor(u){var d,h;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(h=u.isMaybeSingle)!==null&&h!==void 0?h:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,b,x,_;let v=null,w=null,N=null,R=p.status,A=p.statusText;if(p.ok){if(this.method!=="HEAD"){const E=await p.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=E:w=JSON.parse(E))}const M=(b=this.headers.get("Prefer"))===null||b===void 0?void 0:b.match(/count=(exact|planned|estimated)/),G=(x=p.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");M&&G&&G.length>1&&(N=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(v={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,N=null,R=406,A="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const M=await p.text();try{v=JSON.parse(M),Array.isArray(v)&&p.status===404&&(w=[],v=null,R=200,A="OK")}catch{p.status===404&&M===""?(R=204,A="No Content"):v={message:M}}if(v&&this.isMaybeSingle&&(!((_=v?.details)===null||_===void 0)&&_.includes("0 rows"))&&(v=null,R=200,A="OK"),v&&this.shouldThrowOnError)throw new a.default(v)}return{error:v,data:w,count:N,status:R,statusText:A}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,b,x;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(b=p?.stack)!==null&&b!==void 0?b:""}`,hint:"",code:`${(x=p?.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Pl.default=r,Pl}var Ig;function Pp(){if(Ig)return $l;Ig=1,Object.defineProperty($l,"__esModule",{value:!0});const a=mr.__importDefault($p());class r extends a.default{select(u){let d=!1;const h=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",h),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:h,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",b=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${b?`${b},`:""}${u}.${d?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:h=d}={}){const g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:h,referencedTable:g=h}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:h=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var b;const x=[u?"analyze":null,d?"verbose":null,h?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),_=(b=this.headers.get("Accept"))!==null&&b!==void 0?b:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${_}"; options=${x};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return $l.default=r,$l}var Hg;function qu(){if(Hg)return Hl;Hg=1,Object.defineProperty(Hl,"__esModule",{value:!0});const a=mr.__importDefault(Pp()),r=new RegExp("[,()]");class l extends a.default{eq(d,h){return this.url.searchParams.append(d,`eq.${h}`),this}neq(d,h){return this.url.searchParams.append(d,`neq.${h}`),this}gt(d,h){return this.url.searchParams.append(d,`gt.${h}`),this}gte(d,h){return this.url.searchParams.append(d,`gte.${h}`),this}lt(d,h){return this.url.searchParams.append(d,`lt.${h}`),this}lte(d,h){return this.url.searchParams.append(d,`lte.${h}`),this}like(d,h){return this.url.searchParams.append(d,`like.${h}`),this}likeAllOf(d,h){return this.url.searchParams.append(d,`like(all).{${h.join(",")}}`),this}likeAnyOf(d,h){return this.url.searchParams.append(d,`like(any).{${h.join(",")}}`),this}ilike(d,h){return this.url.searchParams.append(d,`ilike.${h}`),this}ilikeAllOf(d,h){return this.url.searchParams.append(d,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(d,h){return this.url.searchParams.append(d,`ilike(any).{${h.join(",")}}`),this}is(d,h){return this.url.searchParams.append(d,`is.${h}`),this}in(d,h){const g=Array.from(new Set(h)).map(p=>typeof p=="string"&&r.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cs.{${h.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(h)}`),this}containedBy(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cd.{${h.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(h)}`),this}rangeGt(d,h){return this.url.searchParams.append(d,`sr.${h}`),this}rangeGte(d,h){return this.url.searchParams.append(d,`nxl.${h}`),this}rangeLt(d,h){return this.url.searchParams.append(d,`sl.${h}`),this}rangeLte(d,h){return this.url.searchParams.append(d,`nxr.${h}`),this}rangeAdjacent(d,h){return this.url.searchParams.append(d,`adj.${h}`),this}overlaps(d,h){return typeof h=="string"?this.url.searchParams.append(d,`ov.${h}`):this.url.searchParams.append(d,`ov.{${h.join(",")}}`),this}textSearch(d,h,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const b=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${b}.${h}`),this}match(d){return Object.entries(d).forEach(([h,g])=>{this.url.searchParams.append(h,`eq.${g}`)}),this}not(d,h,g){return this.url.searchParams.append(d,`not.${h}.${g}`),this}or(d,{foreignTable:h,referencedTable:g=h}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,h,g){return this.url.searchParams.append(d,`${h}.${g}`),this}}return Hl.default=l,Hl}var $g;function Vp(){if($g)return Il;$g=1,Object.defineProperty(Il,"__esModule",{value:!0});const a=mr.__importDefault(qu());class r{constructor(u,{headers:d={},schema:h,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=h,this.fetch=g}select(u,d){const{head:h=!1,count:g}=d??{},p=h?"HEAD":"GET";let m=!1;const b=(u??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",b),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:h=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((b,x)=>b.concat(Object.keys(x)),[]);if(m.length>0){const b=[...new Set(m)].map(x=>`"${x}"`);this.url.searchParams.set("columns",b.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:h=!1,count:g,defaultToNull:p=!0}={}){var m;const b="POST";if(this.headers.append("Prefer",`resolution=${h?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const x=u.reduce((_,v)=>_.concat(Object.keys(v)),[]);if(x.length>0){const _=[...new Set(x)].map(v=>`"${v}"`);this.url.searchParams.set("columns",_.join(","))}}return new a.default({method:b,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var h;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}delete({count:u}={}){var d;const h="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Il.default=r,Il}var Pg;function kb(){if(Pg)return ql;Pg=1,Object.defineProperty(ql,"__esModule",{value:!0});const o=mr,a=o.__importDefault(Vp()),r=o.__importDefault(qu());class l{constructor(d,{headers:h={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(h),this.schemaName=g,this.fetch=p}from(d){const h=new URL(`${this.url}/${d}`);return new a.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,h={},{head:g=!1,get:p=!1,count:m}={}){var b;let x;const _=new URL(`${this.url}/rpc/${d}`);let v;g||p?(x=g?"HEAD":"GET",Object.entries(h).filter(([N,R])=>R!==void 0).map(([N,R])=>[N,Array.isArray(R)?`{${R.join(",")}}`:`${R}`]).forEach(([N,R])=>{_.searchParams.append(N,R)})):(x="POST",v=h);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new r.default({method:x,url:_,headers:w,schema:this.schemaName,body:v,fetch:(b=this.fetch)!==null&&b!==void 0?b:fetch})}}return ql.default=l,ql}var Vg;function zb(){if(Vg)return Yt;Vg=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.PostgrestError=Yt.PostgrestBuilder=Yt.PostgrestTransformBuilder=Yt.PostgrestFilterBuilder=Yt.PostgrestQueryBuilder=Yt.PostgrestClient=void 0;const o=mr,a=o.__importDefault(kb());Yt.PostgrestClient=a.default;const r=o.__importDefault(Vp());Yt.PostgrestQueryBuilder=r.default;const l=o.__importDefault(qu());Yt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Pp());Yt.PostgrestTransformBuilder=u.default;const d=o.__importDefault($p());Yt.PostgrestBuilder=d.default;const h=o.__importDefault(Hp());return Yt.PostgrestError=h.default,Yt.default={PostgrestClient:a.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:h.default},Yt}var Gp=zb();const Fp=gp(Gp),Ub=gb({__proto__:null,default:Fp},[Gp]),{PostgrestClient:Db,PostgrestQueryBuilder:b_,PostgrestFilterBuilder:v_,PostgrestTransformBuilder:x_,PostgrestBuilder:__,PostgrestError:j_}=Fp||Ub;class Bb{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const l=r.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let r=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(r+=`

Suggested solution: ${a.workaround}`),new Error(r)}static createWebSocket(a,r){const l=this.getWebSocketConstructor();return new l(a,r)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const Lb="2.81.1",Mb=`realtime-js/${Lb}`,Kp="1.0.0",qb="2.0.0",Gg=Kp,Cu=1e4,Ib=1e3,Hb=100;var xi;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(xi||(xi={}));var Dt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Dt||(Dt={}));var Sn;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(Sn||(Sn={}));var Tu;(function(o){o.websocket="websocket"})(Tu||(Tu={}));var _i;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(_i||(_i={}));class $b{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,r){if(this._isArrayBuffer(a.payload))return r(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return r(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:r,ref:l,event:u,topic:d,payload:h}=a,g=this.META_LENGTH+r.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),b=0;m.setUint8(b++,this.KINDS.push),m.setUint8(b++,r.length),m.setUint8(b++,l.length),m.setUint8(b++,d.length),m.setUint8(b++,u.length),Array.from(r,_=>m.setUint8(b++,_.charCodeAt(0))),Array.from(l,_=>m.setUint8(b++,_.charCodeAt(0))),Array.from(d,_=>m.setUint8(b++,_.charCodeAt(0))),Array.from(u,_=>m.setUint8(b++,_.charCodeAt(0)));var x=new Uint8Array(p.byteLength+h.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(h),p.byteLength),x.buffer}_binaryEncodeUserBroadcastPush(a){var r;return this._isArrayBuffer((r=a.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var r,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(r=a.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,b=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(b),_=0;x.setUint8(_++,this.KINDS.userBroadcastPush),x.setUint8(_++,u.length),x.setUint8(_++,d.length),x.setUint8(_++,h.length),x.setUint8(_++,g.length),x.setUint8(_++,this.BINARY_ENCODING),Array.from(u,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(d,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(h,w=>x.setUint8(_++,w.charCodeAt(0))),Array.from(g,w=>x.setUint8(_++,w.charCodeAt(0)));var v=new Uint8Array(b.byteLength+p.byteLength);return v.set(new Uint8Array(b),0),v.set(new Uint8Array(p),b.byteLength),v.buffer}_encodeJsonUserBroadcastPush(a){var r,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(r=a.payload)===null||r===void 0?void 0:r.payload)!==null&&l!==void 0?l:{},b=new TextEncoder().encode(JSON.stringify(p)).buffer,x=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,_=new ArrayBuffer(this.HEADER_LENGTH+x);let v=new DataView(_),w=0;v.setUint8(w++,this.KINDS.userBroadcastPush),v.setUint8(w++,u.length),v.setUint8(w++,d.length),v.setUint8(w++,h.length),v.setUint8(w++,g.length),v.setUint8(w++,this.JSON_ENCODING),Array.from(u,R=>v.setUint8(w++,R.charCodeAt(0))),Array.from(d,R=>v.setUint8(w++,R.charCodeAt(0))),Array.from(h,R=>v.setUint8(w++,R.charCodeAt(0))),Array.from(g,R=>v.setUint8(w++,R.charCodeAt(0)));var N=new Uint8Array(_.byteLength+b.byteLength);return N.set(new Uint8Array(_),0),N.set(new Uint8Array(b),_.byteLength),N.buffer}decode(a,r){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return r(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,h,g,p]=l;return r({join_ref:u,ref:d,topic:h,event:g,payload:p})}return r({})}_binaryDecode(a){const r=new DataView(a),l=r.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,r,u);case this.KINDS.reply:return this._decodeReply(a,r,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,r,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,r,u)}}_decodePush(a,r,l){const u=r.getUint8(1),d=r.getUint8(2),h=r.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const b=l.decode(a.slice(g,g+h));g=g+h;const x=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:b,payload:x}}_decodeReply(a,r,l){const u=r.getUint8(1),d=r.getUint8(2),h=r.getUint8(3),g=r.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const b=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=l.decode(a.slice(p,p+g));p=p+g;const v=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:_,response:v};return{join_ref:m,ref:b,topic:x,event:Sn.reply,payload:w}}_decodeBroadcast(a,r,l){const u=r.getUint8(1),d=r.getUint8(2);let h=this.HEADER_LENGTH+2;const g=l.decode(a.slice(h,h+u));h=h+u;const p=l.decode(a.slice(h,h+d));h=h+d;const m=JSON.parse(l.decode(a.slice(h,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,r,l){const u=r.getUint8(1),d=r.getUint8(2),h=r.getUint8(3),g=r.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const b=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=a.slice(p,a.byteLength),v=g===this.JSON_ENCODING?JSON.parse(l.decode(_)):_,w={type:this.BROADCAST,event:b,payload:v};return h>0&&(w.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var r;return a instanceof ArrayBuffer||((r=a?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}}class Yp{constructor(a,r){this.callback=a,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var dt;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(dt||(dt={}));const Fg=(o,a,r={})=>{var l;const u=(l=r.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,h)=>(d[h]=Pb(h,o,a,u),d),{}):{}},Pb=(o,a,r,l)=>{const u=a.find(g=>g.name===o),d=u?.type,h=r[o];return d&&!l.includes(d)?Jp(d,h):Au(h)},Jp=(o,a)=>{if(o.charAt(0)==="_"){const r=o.slice(1,o.length);return Kb(a,r)}switch(o){case dt.bool:return Vb(a);case dt.float4:case dt.float8:case dt.int2:case dt.int4:case dt.int8:case dt.numeric:case dt.oid:return Gb(a);case dt.json:case dt.jsonb:return Fb(a);case dt.timestamp:return Yb(a);case dt.abstime:case dt.date:case dt.daterange:case dt.int4range:case dt.int8range:case dt.money:case dt.reltime:case dt.text:case dt.time:case dt.timestamptz:case dt.timetz:case dt.tsrange:case dt.tstzrange:return Au(a);default:return Au(a)}},Au=o=>o,Vb=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Gb=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Fb=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},Kb=(o,a)=>{if(typeof o!="string")return o;const r=o.length-1,l=o[r];if(o[0]==="{"&&l==="}"){let d;const h=o.slice(1,r);try{d=JSON.parse("["+h+"]")}catch{d=h?h.split(","):[]}return d.map(g=>Jp(a,g))}return o},Yb=o=>typeof o=="string"?o.replace(" ","T"):o,Qp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class gu{constructor(a,r,l={},u=Cu){this.channel=a,this.event=r,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,r){var l;return this._hasReceived(a)&&r((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:r}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(r))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Kg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Kg||(Kg={}));class gs{constructor(a,r){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gs.syncState(this.state,u,d,h),this.pendingDiffs.forEach(p=>{this.state=gs.syncDiff(this.state,p,d,h)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=gs.syncDiff(this.state,u,d,h),g())}),this.onJoin((u,d,h)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:h})}),this.onLeave((u,d,h)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,r,l,u){const d=this.cloneDeep(a),h=this.transformState(r),g={},p={};return this.map(d,(m,b)=>{h[m]||(p[m]=b)}),this.map(h,(m,b)=>{const x=d[m];if(x){const _=b.map(R=>R.presence_ref),v=x.map(R=>R.presence_ref),w=b.filter(R=>v.indexOf(R.presence_ref)<0),N=x.filter(R=>_.indexOf(R.presence_ref)<0);w.length>0&&(g[m]=w),N.length>0&&(p[m]=N)}else g[m]=b}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,r,l,u){const{joins:d,leaves:h}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const b=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),b.length>0){const x=a[g].map(v=>v.presence_ref),_=b.filter(v=>x.indexOf(v.presence_ref)<0);a[g].unshift(..._)}l(g,b,p)}),this.map(h,(g,p)=>{let m=a[g];if(!m)return;const b=p.map(x=>x.presence_ref);m=m.filter(x=>b.indexOf(x.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,r){return Object.getOwnPropertyNames(a).map(l=>r(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((r,l)=>{const u=a[l];return"metas"in u?r[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):r[l]=u,r},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Yg;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Yg||(Yg={}));var ps;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(ps||(ps={}));var ga;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(ga||(ga={}));class Iu{constructor(a,r={config:{}},l){var u,d;if(this.topic=a,this.params=r,this.socket=l,this.bindings={},this.state=Dt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new gu(this,Sn.join,this.params,this.timeout),this.rejoinTimer=new Yp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Dt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Dt.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=Dt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Sn.reply,{},(h,g)=>{this._trigger(this._replyEventName(g),h)}),this.presence=new gs(this),this.broadcastEndpointURL=Qp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,r=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Dt.closed){const{config:{broadcast:h,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(v=>v.filter))!==null&&u!==void 0?u:[],b=!!this.bindings[ps.PRESENCE]&&this.bindings[ps.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,x={},_={broadcast:h,presence:Object.assign(Object.assign({},g),{enabled:b}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(v=>a?.(ga.CHANNEL_ERROR,v)),this._onClose(()=>a?.(ga.CLOSED)),this.updateJoinPayload(Object.assign({config:_},x)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var w;if(this.socket.setAuth(),v===void 0){a?.(ga.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,R=(w=N?.length)!==null&&w!==void 0?w:0,A=[];for(let $=0;$<R;$++){const M=N[$],{filter:{event:G,schema:E,table:D,filter:L}}=M,I=v&&v[$];if(I&&I.event===G&&I.schema===E&&I.table===D&&I.filter===L)A.push(Object.assign(Object.assign({},M),{id:I.id}));else{this.unsubscribe(),this.state=Dt.errored,a?.(ga.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,a&&a(ga.SUBSCRIBED);return}}).receive("error",v=>{this.state=Dt.errored,a?.(ga.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{a?.(ga.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,r={}){return await this.send({type:"presence",event:"track",payload:a},r.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,r,l){return this.state===Dt.joined&&a===ps.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,r,l)}async httpSend(a,r,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const h={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:r,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,r={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:h}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:h,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=r.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var h,g,p;const m=this._push(a.type,a,r.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(h=this.params)===null||h===void 0?void 0:h.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=Dt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Sn.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new gu(this,Sn.leave,{},a),l.receive("ok",()=>{r(),u("ok")}).receive("timeout",()=>{r(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Dt.closed,this.bindings={}}async _fetchWithTimeout(a,r,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),h=await this.socket.fetch(a,Object.assign(Object.assign({},r),{signal:u.signal}));return clearTimeout(d),h}_push(a,r,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new gu(this,a,r,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Hb){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(a,r,l){return r}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,r,l){var u,d;const h=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:b}=Sn;if(l&&[g,p,m,b].indexOf(h)>=0&&l!==this._joinRef())return;let _=this._onMessage(h,r,l);if(r&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(v=>{var w,N,R;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((R=(N=v.filter)===null||N===void 0?void 0:N.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===h}).map(v=>v.callback(_,l)):(d=this.bindings[h])===null||d===void 0||d.filter(v=>{var w,N,R,A,$,M;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in v){const G=v.id,E=(w=v.filter)===null||w===void 0?void 0:w.event;return G&&((N=r.ids)===null||N===void 0?void 0:N.includes(G))&&(E==="*"||E?.toLocaleLowerCase()===((R=r.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))}else{const G=($=(A=v?.filter)===null||A===void 0?void 0:A.event)===null||$===void 0?void 0:$.toLocaleLowerCase();return G==="*"||G===((M=r?.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===h}).map(v=>{if(typeof _=="object"&&"ids"in _){const w=_.data,{schema:N,table:R,commit_timestamp:A,type:$,errors:M}=w;_=Object.assign(Object.assign({},{schema:N,table:R,commit_timestamp:A,eventType:$,new:{},old:{},errors:M}),this._getPayloadRecords(w))}v.callback(_,l)})}_isClosed(){return this.state===Dt.closed}_isJoined(){return this.state===Dt.joined}_isJoining(){return this.state===Dt.joining}_isLeaving(){return this.state===Dt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,r,l){const u=a.toLocaleLowerCase(),d={type:u,filter:r,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,r){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Iu.isEqual(u.filter,r))})),this}static isEqual(a,r){if(Object.keys(a).length!==Object.keys(r).length)return!1;for(const l in a)if(a[l]!==r[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(Sn.close,{},a)}_onError(a){this._on(Sn.error,{},r=>a(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Dt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const r={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(r.new=Fg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(r.old=Fg(a.columns,a.old_record)),r}}const pu=()=>{},Gl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Jb=[1e3,2e3,5e3,1e4],Qb=1e4,Xb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Zb{constructor(a,r){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Cu,this.transport=null,this.heartbeatIntervalMs=Gl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=pu,this.ref=0,this.reconnectTimer=null,this.vsn=Gg,this.logger=pu,this.conn=null,this.sendBuffer=[],this.serializer=new $b,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=r?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${a}/${Tu.websocket}`,this.httpEndpoint=Qp(a),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Bb.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const r=a.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const r=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const a=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,r,l){this.logger(a,r,l)}connectionState(){switch(this.conn&&this.conn.readyState){case xi.connecting:return _i.Connecting;case xi.open:return _i.Open;case xi.closing:return _i.Closing;default:return _i.Closed}}isConnected(){return this.connectionState()===_i.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,r={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Iu(`realtime:${a}`,r,this);return this.channels.push(d),d}}push(a){const{topic:r,event:l,payload:u,ref:d}=a,h=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${r} ${l} (${d})`,u),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Ib,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Gl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let r=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${a}"`),r.unsubscribe())}_remove(a){this.channels=this.channels.filter(r=>r.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:h}=r,g=h?`(${h})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,h)),this._triggerStateCallbacks("message",r)})}_clearTimer(a){var r;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===xi.open||this.conn.readyState===xi.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var r;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(Sn.error))}_appendParams(a,r){if(Object.keys(r).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(r);return`${a}${l}${u}`}_workerObjectUrl(a){let r;if(a)r=a;else{const l=new Blob([Xb],{type:"application/javascript"});r=URL.createObjectURL(l)}return r}_setConnectionState(a,r=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(a=null){let r;a?r=a:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(l=>{const u={access_token:r,version:Mb};r&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(Sn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${a}`,r)})}_triggerStateCallbacks(a,r){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(r)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Yp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Gl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var r,l,u,d,h,g,p,m,b,x,_,v;switch(this.transport=(r=a?.transport)!==null&&r!==void 0?r:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:Cu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Gl.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(h=a?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:pu,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Gg,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Jb[w-1]||Qb),this.vsn){case Kp:this.encode=(b=a?.encode)!==null&&b!==void 0?b:((w,N)=>N(JSON.stringify(w))),this.decode=(x=a?.decode)!==null&&x!==void 0?x:((w,N)=>N(JSON.parse(w)));break;case qb:this.encode=(_=a?.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(v=a?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class Hu extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function vt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Wb extends Hu{constructor(a,r,l){super(a),this.name="StorageApiError",this.status=r,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Nu extends Hu{constructor(a,r){super(a),this.name="StorageUnknownError",this.originalError=r}}const $u=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ev=()=>Response,Ru=o=>{if(Array.isArray(o))return o.map(r=>Ru(r));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([r,l])=>{const u=r.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=Ru(l)}),a},tv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},mu=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},nv=(o,a,r)=>Oe(void 0,void 0,void 0,function*(){const l=yield ev();o instanceof l&&!r?.noResolveJson?o.json().then(u=>{const d=o.status||500,h=u?.statusCode||d+"";a(new Wb(mu(u),d,h))}).catch(u=>{a(new Nu(mu(u),u))}):a(new Nu(mu(o),o))}),av=(o,a,r,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(tv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),r))};function vs(o,a,r,l,u,d){return Oe(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(r,av(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>nv(p,g,l))})})}function ms(o,a,r,l){return Oe(this,void 0,void 0,function*(){return vs(o,"GET",a,r,l)})}function Un(o,a,r,l,u){return Oe(this,void 0,void 0,function*(){return vs(o,"POST",a,l,u,r)})}function Ou(o,a,r,l,u){return Oe(this,void 0,void 0,function*(){return vs(o,"PUT",a,l,u,r)})}function iv(o,a,r,l){return Oe(this,void 0,void 0,function*(){return vs(o,"HEAD",a,Object.assign(Object.assign({},r),{noResolveJson:!0}),l)})}function Pu(o,a,r,l,u){return Oe(this,void 0,void 0,function*(){return vs(o,"DELETE",a,l,u,r)})}class rv{constructor(a,r){this.downloadFn=a,this.shouldThrowOnError=r}then(a,r){return this.execute().then(a,r)}execute(){return Oe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(vt(a))return{data:null,error:a};throw a}})}}var Xp;class sv{constructor(a,r){this.downloadFn=a,this.shouldThrowOnError=r,this[Xp]="BlobDownloadBuilder",this.promise=null}asStream(){return new rv(this.downloadFn,this.shouldThrowOnError)}then(a,r){return this.getPromise().then(a,r)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Oe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(vt(a))return{data:null,error:a};throw a}})}}Xp=Symbol.toStringTag;const lv={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ov{constructor(a,r={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=r,this.bucketId=l,this.fetch=$u(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,r,l,u){return Oe(this,void 0,void 0,function*(){try{let d;const h=Object.assign(Object.assign({},Jg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",h.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!h.duplex&&(h.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(r),b=this._getFinalPath(m),x=yield(a=="PUT"?Ou:Un)(this.fetch,`${this.url}/object/${b}`,d,Object.assign({headers:g},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:m,id:x.Id,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(vt(d))return{data:null,error:d};throw d}})}upload(a,r,l){return Oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,r,l)})}uploadToSignedUrl(a,r,l,u){return Oe(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),h=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${h}`);g.searchParams.set("token",r);try{let p;const m=Object.assign({upsert:Jg.upsert},u),b=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,b["cache-control"]=`max-age=${m.cacheControl}`,b["content-type"]=m.contentType);const x=yield Ou(this.fetch,g.toString(),p,{headers:b});return{data:{path:d,fullPath:x.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(vt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,r){return Oe(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);r?.upsert&&(u["x-upsert"]="true");const d=yield Un(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),h=new URL(this.url+d.url),g=h.searchParams.get("token");if(!g)throw new Hu("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}update(a,r,l){return Oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,r,l)})}move(a,r,l){return Oe(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:r,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}copy(a,r,l){return Oe(this,void 0,void 0,function*(){try{return{data:{path:(yield Un(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:r,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,r,l){return Oe(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield Un(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:r},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const h=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${h}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,r,l){return Oe(this,void 0,void 0,function*(){try{const u=yield Un(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}download(a,r){const u=typeof r?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(r?.transform||{}),h=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>ms(this.fetch,`${this.url}/${u}/${g}${h}`,{headers:this.headers,noResolveJson:!0});return new sv(p,this.shouldThrowOnError)}info(a){return Oe(this,void 0,void 0,function*(){const r=this._getFinalPath(a);try{const l=yield ms(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ru(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}exists(a){return Oe(this,void 0,void 0,function*(){const r=this._getFinalPath(a);try{return yield iv(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l)&&l instanceof Nu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,r){const l=this._getFinalPath(a),u=[],d=r?.download?`download=${r.download===!0?"":r.download}`:"";d!==""&&u.push(d);const g=typeof r?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(r?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Pu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}list(a,r,l){return Oe(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},lv),r),{prefix:a||""});return{data:yield Un(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}listV2(a,r){return Oe(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield Un(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},r),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const r=[];return a.width&&r.push(`width=${a.width}`),a.height&&r.push(`height=${a.height}`),a.resize&&r.push(`resize=${a.resize}`),a.format&&r.push(`format=${a.format}`),a.quality&&r.push(`quality=${a.quality}`),r.join("&")}}const Zp="2.81.1",Wp={"X-Client-Info":`storage-js/${Zp}`};class cv{constructor(a,r={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Wp),r),this.fetch=$u(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return Oe(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(a);return{data:yield ms(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}getBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield ms(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}createBucket(a){return Oe(this,arguments,void 0,function*(r,l={public:!1}){try{return{data:yield Un(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(vt(u))return{data:null,error:u};throw u}})}updateBucket(a,r){return Oe(this,void 0,void 0,function*(){try{return{data:yield Ou(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(vt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}deleteBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Pu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(a){const r={};return a&&("limit"in a&&(r.limit=String(a.limit)),"offset"in a&&(r.offset=String(a.offset)),a.search&&(r.search=a.search),a.sortColumn&&(r.sortColumn=a.sortColumn),a.sortOrder&&(r.sortOrder=a.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class uv{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Wp),r),this.fetch=$u(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}listBuckets(a){return Oe(this,void 0,void 0,function*(){try{const r=new URLSearchParams;a?.limit!==void 0&&r.set("limit",a.limit.toString()),a?.offset!==void 0&&r.set("offset",a.offset.toString()),a?.sortColumn&&r.set("sortColumn",a.sortColumn),a?.sortOrder&&r.set("sortOrder",a.sortOrder),a?.search&&r.set("search",a.search);const l=r.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield ms(this.fetch,u,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}deleteBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield Pu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(vt(r))return{data:null,error:r};throw r}})}}const Vu={"X-Client-Info":`storage-js/${Zp}`,"Content-Type":"application/json"};class em extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function fn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class yu extends em{constructor(a,r,l){super(a),this.name="StorageVectorsApiError",this.status=r,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dv extends em{constructor(a,r){super(a),this.name="StorageVectorsUnknownError",this.originalError=r}}var Qg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Qg||(Qg={}));const Gu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),fv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Xg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),hv=(o,a,r)=>Oe(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!r?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(h=>{const g=h?.statusCode||h?.code||u+"";a(new yu(Xg(h),u,g))}).catch(()=>{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new yu(g,u,h))});else{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new yu(g,u,h))}}else a(new dv(Xg(o),o))}),gv=(o,a,r,l)=>{const u={method:o,headers:a?.headers||{}};return l?(fv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),r)):u};function pv(o,a,r,l,u,d){return Oe(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(r,gv(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>h(p)).catch(p=>hv(p,g,l))})})}function hn(o,a,r,l,u){return Oe(this,void 0,void 0,function*(){return pv(o,"POST",a,l,u,r)})}class mv{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vu),r),this.fetch=Gu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return Oe(this,void 0,void 0,function*(){try{return{data:(yield hn(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}getIndex(a,r){return Oe(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:r},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(fn(l))return{data:null,error:l};throw l}})}listIndexes(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}deleteIndex(a,r){return Oe(this,void 0,void 0,function*(){try{return{data:(yield hn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:r},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(fn(l))return{data:null,error:l};throw l}})}}class yv{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vu),r),this.fetch=Gu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return Oe(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield hn(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}getVectors(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}listVectors(a){return Oe(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield hn(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}queryVectors(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}deleteVectors(a){return Oe(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield hn(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}}class bv{constructor(a,r={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Vu),r),this.fetch=Gu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:(yield hn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}getBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}listBuckets(){return Oe(this,arguments,void 0,function*(a={}){try{return{data:yield hn(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}deleteBucket(a){return Oe(this,void 0,void 0,function*(){try{return{data:(yield hn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fn(r))return{data:null,error:r};throw r}})}}class vv extends bv{constructor(a,r={}){super(a,r.headers||{},r.fetch)}from(a){return new xv(this.url,this.headers,a,this.fetch)}}class xv extends mv{constructor(a,r,l,u){super(a,r,u),this.vectorBucketName=l}createIndex(a){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Oe(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Oe(this,arguments,void 0,function*(r={}){return a.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Oe(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Oe(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new _v(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class _v extends yv{constructor(a,r,l,u,d){super(a,r,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Oe(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Oe(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Oe(this,arguments,void 0,function*(r={}){return a.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Oe(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Oe(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class jv extends cv{constructor(a,r={},l,u){super(a,r,l,u)}from(a){return new ov(this.url,this.headers,a,this.fetch)}get vectors(){return new vv(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new uv(this.url+"/iceberg",this.headers,this.fetch)}}const Sv="2.81.1";let hs="";typeof Deno<"u"?hs="deno":typeof document<"u"?hs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?hs="react-native":hs="node";const wv={"X-Client-Info":`supabase-js-${hs}/${Sv}`},Ev={headers:wv},Cv={schema:"public"},Tv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Av={},Nv=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Rv=()=>Headers,Ov=(o,a,r)=>{const l=Nv(r),u=Rv();return async(d,h)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(h?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},h),{headers:m}))}};function kv(o){return o.endsWith("/")?o:o+"/"}function zv(o,a){var r,l;const{db:u,auth:d,realtime:h,global:g}=o,{db:p,auth:m,realtime:b,global:x}=a,_={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},b),h),storage:{},global:Object.assign(Object.assign(Object.assign({},x),g),{headers:Object.assign(Object.assign({},(r=x?.headers)!==null&&r!==void 0?r:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?_.accessToken=o.accessToken:delete _.accessToken,_}function Uv(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(kv(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const tm="2.81.1",dr=30*1e3,ku=3,bu=ku*dr,Dv="http://localhost:9999",Bv="supabase.auth.token",Lv={"X-Client-Info":`gotrue-js/${tm}`},zu="X-Supabase-Api-Version",nm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Mv=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,qv=600*1e3;class ys extends Error{constructor(a,r,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=l}}function De(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Iv extends ys{constructor(a,r,l){super(a,r,l),this.name="AuthApiError",this.status=r,this.code=l}}function Hv(o){return De(o)&&o.name==="AuthApiError"}class ji extends ys{constructor(a,r){super(a),this.name="AuthUnknownError",this.originalError=r}}class Ga extends ys{constructor(a,r,l,u){super(a,l,u),this.name=r,this.status=l}}class kn extends Ga{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $v(o){return De(o)&&o.name==="AuthSessionMissingError"}class sr extends Ga{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fl extends Ga{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Kl extends Ga{constructor(a,r=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Pv(o){return De(o)&&o.name==="AuthImplicitGrantRedirectError"}class Zg extends Ga{constructor(a,r=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Uu extends Ga{constructor(a,r){super(a,"AuthRetryableFetchError",r,void 0)}}function vu(o){return De(o)&&o.name==="AuthRetryableFetchError"}class Wg extends Ga{constructor(a,r,l){super(a,"AuthWeakPasswordError",r,"weak_password"),this.reasons=l}}class Du extends Ga{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ql="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ep=` 	
\r=`.split(""),Vv=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<ep.length;a+=1)o[ep[a].charCodeAt(0)]=-2;for(let a=0;a<Ql.length;a+=1)o[Ql[a].charCodeAt(0)]=a;return o})();function tp(o,a,r){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;r(Ql[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;r(Ql[l]),a.queuedBits-=6}}function am(o,a,r){const l=Vv[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)r(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function np(o){const a=[],r=h=>{a.push(String.fromCodePoint(h))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=h=>{Kv(h,l,r)};for(let h=0;h<o.length;h+=1)am(o.charCodeAt(h),u,d);return a.join("")}function Gv(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Fv(o,a){for(let r=0;r<o.length;r+=1){let l=o.charCodeAt(r);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(r+1)-56320&65535|u)+65536,r+=1}Gv(l,a)}}function Kv(o,a,r){if(a.utf8seq===0){if(o<=127){r(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&r(a.codepoint)}}function hr(o){const a=[],r={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)am(o.charCodeAt(u),r,l);return new Uint8Array(a)}function Yv(o){const a=[];return Fv(o,r=>a.push(r)),new Uint8Array(a)}function Si(o){const a=[],r={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>tp(u,r,l)),tp(null,r,l),a.join("")}function Jv(o){return Math.round(Date.now()/1e3)+o}function Qv(){return Symbol("auth-callback")}const Vt=()=>typeof window<"u"&&typeof document<"u",mi={tested:!1,writable:!1},im=()=>{if(!Vt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(mi.tested)return mi.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),mi.tested=!0,mi.writable=!0}catch{mi.tested=!0,mi.writable=!1}return mi.writable};function Xv(o){const a={},r=new URL(o);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return r.searchParams.forEach((l,u)=>{a[u]=l}),a}const rm=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Zv=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",fr=async(o,a,r)=>{await o.setItem(a,JSON.stringify(r))},yi=async(o,a)=>{const r=await o.getItem(a);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Pa=async(o,a)=>{await o.removeItem(a)};class to{constructor(){this.promise=new to.promiseConstructor((a,r)=>{this.resolve=a,this.reject=r})}}to.promiseConstructor=Promise;function xu(o){const a=o.split(".");if(a.length!==3)throw new Du("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!Mv.test(a[l]))throw new Du("JWT not in base64url format");return{header:JSON.parse(np(a[0])),payload:JSON.parse(np(a[1])),signature:hr(a[2]),raw:{header:a[0],payload:a[1]}}}async function Wv(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function e0(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const h=await o(d);if(!a(d,null,h)){l(h);return}}catch(h){if(!a(d,h)){u(h);return}}})()})}function t0(o){return("0"+o.toString(16)).substr(-2)}function n0(){const a=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=r.length;let u="";for(let d=0;d<56;d++)u+=r.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,t0).join("")}async function a0(o){const r=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",r),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function i0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const r=await a0(o);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lr(o,a,r=!1){const l=n0();let u=l;r&&(u+="/PASSWORD_RECOVERY"),await fr(o,`${a}-code-verifier`,u);const d=await i0(l);return[d,l===d?"plain":"s256"]}const r0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function s0(o){const a=o.headers.get(zu);if(!a||!a.match(r0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function l0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function o0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const c0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function or(o){if(!c0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function _u(){const o={};return new Proxy(o,{get:(a,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function u0(o,a){return new Proxy(o,{get:(r,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(r,l,u)}})}function ap(o){return JSON.parse(JSON.stringify(o))}const vi=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),d0=[502,503,504];async function ip(o){var a;if(!Zv(o))throw new Uu(vi(o),0);if(d0.includes(o.status))throw new Uu(vi(o),o.status);let r;try{r=await o.json()}catch(d){throw new ji(vi(d),d)}let l;const u=s0(o);if(u&&u.getTime()>=nm["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?l=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(l=r.error_code),l){if(l==="weak_password")throw new Wg(vi(r),o.status,((a=r.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new kn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((d,h)=>d&&typeof h=="string",!0))throw new Wg(vi(r),o.status,r.weak_password.reasons);throw new Iv(vi(r),o.status||500,l)}const f0=(o,a,r,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),r))};async function Me(o,a,r,l){var u;const d=Object.assign({},l?.headers);d[zu]||(d[zu]=nm["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const h=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(h.redirect_to=l.redirectTo);const g=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await h0(o,a,r+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function h0(o,a,r,l,u,d){const h=f0(a,l,u,d);let g;try{g=await o(r,Object.assign({},h))}catch(p){throw console.error(p),new Uu(vi(p),0)}if(g.ok||await ip(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await ip(p)}}function zn(o){var a;let r=null;m0(o)&&(r=Object.assign({},o),o.expires_at||(r.expires_at=Jv(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:r,user:l},error:null}}function rp(o){const a=zn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((r,l)=>r&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Va(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function g0(o){return{data:o,error:null}}function p0(o){const{action_link:a,email_otp:r,hashed_token:l,redirect_to:u,verification_type:d}=o,h=pr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:r,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},h);return{data:{properties:g,user:p},error:null}}function sp(o){return o}function m0(o){return o.access_token&&o.refresh_token&&o.expires_in}const ju=["global","local","others"];class y0{constructor({url:a="",headers:r={},fetch:l}){this.url=a,this.headers=r,this.fetch=rm(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,r=ju[0]){if(ju.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ju.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(De(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,r={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Va})}catch(l){if(De(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:r}=a,l=pr(a,["options"]),u=Object.assign(Object.assign({},l),r);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:p0,redirectTo:r?.redirectTo})}catch(r){if(De(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(a){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Va})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async listUsers(a){var r,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},b=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=a?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:sp});if(b.error)throw b.error;const x=await b.json(),_=(h=b.headers.get("x-total-count"))!==null&&h!==void 0?h:0,v=(p=(g=b.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return v.length>0&&(v.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(w.split(";")[1].split("=")[1]);m[`${R}Page`]=N}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(De(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){or(a);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Va})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async updateUserById(a,r){or(a);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:r,headers:this.headers,xform:Va})}catch(l){if(De(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,r=!1){or(a);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:r},xform:Va})}catch(l){if(De(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){or(a.userId);try{const{data:r,error:l}=await Me(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:r,error:l}}catch(r){if(De(r))return{data:null,error:r};throw r}}async _deleteFactor(a){or(a.userId),or(a.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}}async _listOAuthClients(a){var r,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},b=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(r=a?.page)===null||r===void 0?void 0:r.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:sp});if(b.error)throw b.error;const x=await b.json(),_=(h=b.headers.get("x-total-count"))!==null&&h!==void 0?h:0,v=(p=(g=b.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return v.length>0&&(v.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(w.split(";")[1].split("=")[1]);m[`${R}Page`]=N}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(De(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(De(r))return{data:null,error:r};throw r}}async _getOAuthClient(a){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(De(r))return{data:null,error:r};throw r}}async _updateOAuthClient(a,r){try{return await Me(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:r,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(De(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(a){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(De(r))return{data:null,error:r};throw r}}}function lp(o={}){return{getItem:a=>o[a]||null,setItem:(a,r)=>{o[a]=r},removeItem:a=>{delete o[a]}}}const cr={debug:!!(globalThis&&im()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sm extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class b0 extends sm{}async function v0(o,a,r){cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),cr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await r()}finally{cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw cr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new b0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(cr.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function x0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function lm(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function _0(o){return parseInt(o,16)}function j0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function S0(o){var a;const{chainId:r,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:h,notBefore:g,requestId:p,resources:m,scheme:b,uri:x,version:_}=o;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const v=lm(o.address),w=b?`${b}://${l}`:l,N=o.statement?`${o.statement}
`:"",R=`${w} wants you to sign in with your Ethereum account:
${v}

${N}`;let A=`URI: ${x}
Version: ${_}
Chain ID: ${r}${h?`
Nonce: ${h}`:""}
Issued At: ${d.toISOString()}`;if(u&&(A+=`
Expiration Time: ${u.toISOString()}`),g&&(A+=`
Not Before: ${g.toISOString()}`),p&&(A+=`
Request ID: ${p}`),m){let $=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);$+=`
- ${M}`}A+=$}return`${R}
${A}`}class zt extends Error{constructor({message:a,code:r,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=r}}class Xl extends zt{constructor(a,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:a}),this.name="WebAuthnUnknownError",this.originalError=r}}function w0({error:o,options:a}){var r,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new zt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((r=d.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new zt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new zt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new zt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new zt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new zt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new zt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new zt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const h=window.location.hostname;if(om(h)){if(d.rp.id!==h)return new zt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new zt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new zt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function E0({error:o,options:a}){const{publicKey:r}=a;if(!r)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new zt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new zt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(om(l)){if(r.rpId!==l)return new zt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new zt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class C0{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const T0=new C0;function A0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:r,excludeCredentials:l}=o,u=pr(o,["challenge","user","excludeCredentials"]),d=hr(a).buffer,h=Object.assign(Object.assign({},r),{id:hr(r.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:h});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:hr(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function N0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:r}=o,l=pr(o,["challenge","allowCredentials"]),u=hr(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(r&&r.length>0){d.allowCredentials=new Array(r.length);for(let h=0;h<r.length;h++){const g=r[h];d.allowCredentials[h]=Object.assign(Object.assign({},g),{id:hr(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function R0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const r=o;return{id:o.id,rawId:o.id,response:{attestationObject:Si(new Uint8Array(o.response.attestationObject)),clientDataJSON:Si(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=r.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function O0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const r=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:Si(new Uint8Array(u.authenticatorData)),clientDataJSON:Si(new Uint8Array(u.clientDataJSON)),signature:Si(new Uint8Array(u.signature)),userHandle:u.userHandle?Si(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=r.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function om(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function op(){var o,a;return!!(Vt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function k0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Xl("Browser returned unexpected credential type",a)}:{data:null,error:new Xl("Empty credential response",a)}}catch(a){return{data:null,error:w0({error:a,options:o})}}}async function z0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Xl("Browser returned unexpected credential type",a)}:{data:null,error:new Xl("Empty credential response",a)}}catch(a){return{data:null,error:E0({error:a,options:o})}}}const U0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},D0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Zl(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),r=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const h=u[d];if(h!==void 0)if(Array.isArray(h))l[d]=h;else if(r(h))l[d]=h;else if(a(h)){const g=l[d];a(g)?l[d]=Zl(g,h):l[d]=Zl(h)}else l[d]=h}return l}function B0(o,a){return Zl(U0,o,a||{})}function L0(o,a){return Zl(D0,o,a||{})}class M0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:r,friendlyName:l,signal:u},d){try{const{data:h,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:r});if(!h)return{data:null,error:g};const p=u??T0.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=B0(h.webauthn.credential_options.publicKey,d?.create),{data:b,error:x}=await k0({publicKey:m,signal:p});return b?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:b}},error:null}:{data:null,error:x}}case"request":{const m=L0(h.webauthn.credential_options.publicKey,d?.request),{data:b,error:x}=await z0(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:p}));return b?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:b}},error:null}:{data:null,error:x}}}}catch(h){return De(h)?{data:null,error:h}:{data:null,error:new ji("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:r,webauthn:l}){return this.client.mfa.verify({factorId:r,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!r)return{data:null,error:new ys("rpId is required for WebAuthn authentication")};try{if(!op())return{data:null,error:new ji("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this.challenge({factorId:a,webauthn:{rpId:r,rpOrigins:l},signal:u},{request:d});if(!h)return{data:null,error:g};const{webauthn:p}=h;return this._verify({factorId:a,challengeId:h.challengeId,webauthn:{type:p.type,rpId:r,rpOrigins:l,credential_response:p.credential_response}})}catch(h){return De(h)?{data:null,error:h}:{data:null,error:new ji("Unexpected error in authenticate",h)}}}async _register({friendlyName:a,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!r)return{data:null,error:new ys("rpId is required for WebAuthn registration")};try{if(!op())return{data:null,error:new ji("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this._enroll({friendlyName:a});if(!h)return await this.client.mfa.listFactors().then(b=>{var x;return(x=b.data)===null||x===void 0?void 0:x.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===a&&_.status!=="unverified")}).then(b=>b?this.client.mfa.unenroll({factorId:b?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:r,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:h.id,challengeId:p.challengeId,webauthn:{rpId:r,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(h){return De(h)?{data:null,error:h}:{data:null,error:new ji("Unexpected error in register",h)}}}}x0();const q0={url:Dv,storageKey:Bv,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Lv,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function cp(o,a,r){return await r()}const ur={};class bs{get jwks(){var a,r;return(r=(a=ur[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(a){ur[this.storageKey]=Object.assign(Object.assign({},ur[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,r;return(r=(a=ur[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){ur[this.storageKey]=Object.assign(Object.assign({},ur[this.storageKey]),{cachedAt:a})}constructor(a){var r,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},q0),a);if(this.storageKey=d.storageKey,this.instanceID=(r=bs.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,bs.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&Vt()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new y0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=rm(d.fetch),this.lock=d.lock||cp,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:Vt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=v0:this.lock=cp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new M0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:im()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lp(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=lp(this.memoryStorage)),Vt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${tm}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let r={},l="none";if(Vt()&&(r=Xv(window.location.href),this._isImplicitGrantCallback(r)?l="implicit":await this._isPKCECallback(r)&&(l="pkce")),Vt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(r,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Pv(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:h,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",h,"redirect type",g),await this._saveSession(h),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return De(r)?this._returnResult({error:r}):this._returnResult({error:new ji("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var r,l,u;try{const d=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(r=a?.options)===null||r===void 0?void 0:r.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:zn}),{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(De(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var r,l,u;try{let d;if("email"in a){const{email:b,password:x,options:_}=a;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await lr(this.storage,this.storageKey)),d=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_?.emailRedirectTo,body:{email:b,password:x,data:(r=_?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:_?.captchaToken},code_challenge:v,code_challenge_method:w},xform:zn})}else if("phone"in a){const{phone:b,password:x,options:_}=a;d=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:x,data:(l=_?.data)!==null&&l!==void 0?l:{},channel:(u=_?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:_?.captchaToken}},xform:zn})}else throw new Fl("You must provide either an email or phone number and a password");const{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(De(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let r;if("email"in a){const{email:d,password:h,options:g}=a;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:rp})}else if("phone"in a){const{phone:d,password:h,options:g}=a;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:rp})}else throw new Fl("You must provide either an email or phone number and a password");const{data:l,error:u}=r;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new sr;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(a){var r,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(r=a.options)===null||r===void 0?void 0:r.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:r}=a;switch(r){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(a){var r,l,u,d,h,g,p,m,b,x,_;let v,w;if("message"in a)v=a.message,w=a.signature;else{const{chain:N,wallet:R,statement:A,options:$}=a;let M;if(Vt())if(typeof R=="object")M=R;else{const ce=window;if("ethereum"in ce&&typeof ce.ethereum=="object"&&"request"in ce.ethereum&&typeof ce.ethereum.request=="function")M=ce.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!$?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=R}const G=new URL((r=$?.url)!==null&&r!==void 0?r:window.location.href),E=await M.request({method:"eth_requestAccounts"}).then(ce=>ce).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const D=lm(E[0]);let L=(l=$?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!L){const ce=await M.request({method:"eth_chainId"});L=_0(ce)}const I={domain:G.host,address:D,statement:A,uri:G.href,version:"1",chainId:L,nonce:(u=$?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(h=(d=$?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(g=$?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=$?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=$?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(b=$?.signInWithEthereum)===null||b===void 0?void 0:b.resources};v=S0(I),w=await M.request({method:"personal_sign",params:[j0(v),D]})}try{const{data:N,error:R}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:w},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(_=a.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:zn});if(R)throw R;if(!N||!N.session||!N.user){const A=new sr;return this._returnResult({data:{user:null,session:null},error:A})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:R})}catch(N){if(De(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async signInWithSolana(a){var r,l,u,d,h,g,p,m,b,x,_,v;let w,N;if("message"in a)w=a.message,N=a.signature;else{const{chain:R,wallet:A,statement:$,options:M}=a;let G;if(Vt())if(typeof A=="object")G=A;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))G=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=A}const E=new URL((r=M?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in G&&G.signIn){const D=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),$?{statement:$}:null));let L;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")L=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)L=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)w=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),N=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...$?["",$,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(u=(l=M?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=M?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((h=M?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((g=M?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((p=M?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((x=(b=M?.signInWithSolana)===null||b===void 0?void 0:b.resources)===null||x===void 0)&&x.length?["Resources",...M.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const D=await G.signMessage(new TextEncoder().encode(w),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=D}}try{const{data:R,error:A}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:Si(N)},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(v=a.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:zn});if(A)throw A;if(!R||!R.session||!R.user){const $=new sr;return this._returnResult({data:{user:null,session:null},error:$})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:A})}catch(R){if(De(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async _exchangeCodeForSession(a){const r=await yi(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(r??"").split("/");try{const{data:d,error:h}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:zn});if(await Pa(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!d||!d.session||!d.user){const g=new sr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:h})}catch(d){if(De(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:r,provider:l,token:u,access_token:d,nonce:h}=a,g=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:h,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:zn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const b=new sr;return this._returnResult({data:{user:null,session:null},error:b})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(a){var r,l,u,d,h;try{if("email"in a){const{email:g,options:p}=a;let m=null,b=null;this.flowType==="pkce"&&([m,b]=await lr(this.storage,this.storageKey));const{error:x}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(r=p?.data)!==null&&r!==void 0?r:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:b},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:b}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(h=p?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:b})}throw new Fl("You must provide either an email or phone number.")}catch(g){if(De(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var r,l;try{let u,d;"options"in a&&(u=(r=a.options)===null||r===void 0?void 0:r.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:h,error:g}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:zn});if(g)throw g;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,m=h.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(De(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var r,l,u,d,h;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await lr(this.storage,this.storageKey));const m=await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(r=a.options)===null||r===void 0?void 0:r.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:g0});return!((d=m.data)===null||d===void 0)&&d.url&&Vt()&&!(!((h=a.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(De(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:r},error:l}=a;if(l)throw l;if(!r)throw new kn;const{error:u}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(De(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const r=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:h}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:h,error:g}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:g})}throw new Fl("You must provide either an email or phone number and a type")}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(a,r){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await r()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=r();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await a(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const r=await yi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?a=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<bu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const h=await yi(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=_u()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};a.user=u0(a.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Va}):await this._useSession(async r=>{var l,u,d;const{data:h,error:g}=r;if(g)throw g;return!(!((l=h.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kn}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Va})})}catch(r){if(De(r))return $v(r)&&(await this._removeSession(),await Pa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(a,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,r))}async _updateUser(a,r={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new kn;const h=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await lr(this.storage,this.storageKey));const{data:m,error:b}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:h.access_token,xform:Va});if(b)throw b;return h.user=m.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(l){if(De(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new kn;const r=Date.now()/1e3;let l=r,u=!0,d=null;const{payload:h}=xu(a.access_token);if(h.exp&&(l=h.exp,u=l<=r),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-r,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(r){if(De(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async r=>{var l;if(!a){const{data:h,error:g}=r;if(g)throw g;a=(l=h.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new kn;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(a,r){try{if(!Vt())throw new Kl("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Kl(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Zg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Kl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Zg("No code detected.");const{data:$,error:M}=await this._exchangeCodeForSession(a.code);if(M)throw M;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:$.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:h,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!h||!m)throw new Kl("No session defined in URL");const b=Math.round(Date.now()/1e3),x=parseInt(g);let _=b+x;p&&(_=parseInt(p));const v=_-b;v*1e3<=dr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${x}s`);const w=_-x;b-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,_,b):b-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,_,b);const{data:N,error:R}=await this._getUser(d);if(R)throw R;const A={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:x,expires_at:_,refresh_token:h,token_type:m,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:a.type},error:null})}catch(l){if(De(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const r=await yi(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&r)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async r=>{var l;const{data:u,error:d}=r;if(d)return this._returnResult({error:d});const h=(l=u.session)===null||l===void 0?void 0:l.access_token;if(h){const{error:g}=await this.admin.signOut(h,a);if(g&&!(Hv(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await Pa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const r=Qv(),l={id:r,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async r=>{var l,u;try{const{data:{session:d},error:h}=r;if(h)throw h;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,r={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await lr(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(d){if(De(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:r,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=r.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var r;try{const{data:l,error:u}=await this._useSession(async d=>{var h,g,p,m,b;const{data:x,error:_}=d;if(_)throw _;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",v,{headers:this.headers,jwt:(b=(m=x.session)===null||m===void 0?void 0:m.access_token)!==null&&b!==void 0?b:void 0})});if(u)throw u;return Vt()&&!(!((r=a.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(De(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async r=>{var l;try{const{error:u,data:{session:d}}=r;if(u)throw u;const{options:h,provider:g,token:p,access_token:m,nonce:b}=a,x=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:b,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:zn}),{data:_,error:v}=x;return v?this._returnResult({data:{user:null,session:null},error:v}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new sr}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:v}))}catch(u){if(De(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async r=>{var l,u;const{data:d,error:h}=r;if(h)throw h;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(a){const r=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(r,"begin");try{const l=Date.now();return await e0(async u=>(u>0&&await Wv(200*Math.pow(2,u-1)),this._debug(r,"refreshing attempt",u),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:zn})),(u,d)=>{const h=200*Math.pow(2,u);return d&&vu(d)&&Date.now()+h-l<dr})}catch(l){if(this._debug(r,"error",l),De(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(r,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,r){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",r,"url",l),Vt()&&!r.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,r;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await yi(this.storage,this.storageKey);if(u&&this.userStorage){let h=await yi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:u.user},await fr(this.userStorage,this.storageKey+"-user",h)),u.user=(a=h?.user)!==null&&a!==void 0?a:_u()}else if(u&&!u.user&&!u.user){const h=await yi(this.storage,this.storageKey+"-user");h&&h?.user?(u.user=h.user,await Pa(this.storage,this.storageKey+"-user"),await fr(this.storage,this.storageKey,u)):u.user=_u()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((r=u.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<bu;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${bu}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:h}=await this._callRefreshToken(u.refresh_token);h&&(console.error(h),vu(h)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:g}=await this._getUser(u.access_token);!g&&h?.user?(u.user=h.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(l,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var r,l;if(!a)throw new kn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new to;const{data:d,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!d.session)throw new kn;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),De(d)){const h={data:null,error:d};return vu(d)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(h),h}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,r,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",r,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:r});const d=[],h=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,r)}catch(p){d.push(p)}});if(await Promise.all(h),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const r=Object.assign({},a),l=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&r.user&&await fr(this.userStorage,this.storageKey+"-user",{user:r.user});const u=Object.assign({},r);delete u.user;const d=ap(u);await fr(this.storage,this.storageKey,d)}else{const u=ap(r);await fr(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await Pa(this.storage,this.storageKey),await Pa(this.storage,this.storageKey+"-code-verifier"),await Pa(this.storage,this.storageKey+"-user"),this.userStorage&&await Pa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&Vt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),dr);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async r=>{const{data:{session:l}}=r;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/dr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${dr}ms, refresh threshold is ${ku} ticks`),u<=ku&&await this._callRefreshToken(l.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof sm)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Vt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const r=`#_onVisibilityChanged(${a})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,r,l){const u=[`provider=${encodeURIComponent(r)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,h]=await lr(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(h)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async r=>{var l;const{data:u,error:d}=r;return d?this._returnResult({data:null,error:d}):await Me(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(a){try{return await this._useSession(async r=>{var l,u;const{data:d,error:h}=r;if(h)return this._returnResult({data:null,error:h});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var l;const{data:u,error:d}=r;if(d)return this._returnResult({data:null,error:d});const h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?R0(a.webauthn.credential_response):O0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Me(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var l;const{data:u,error:d}=r;if(d)return this._returnResult({data:null,error:d});const h=await Me(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(h.error)return h;const{data:g}=h;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:A0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:N0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(a){const{data:r,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:r.id,code:a.code})}async _listFactors(){var a;const{data:{user:r},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=r?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,r;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=xu(l.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((r=(a=l.user.factors)===null||a===void 0?void 0:a.filter(b=>b.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async r=>{const{data:{session:l},error:u}=r;return u?this._returnResult({data:null,error:u}):l?await Me(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new kn})})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(a,r){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new kn});const h=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&Vt()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(De(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,r){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new kn});const h=await Me(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&Vt()&&!r?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(De(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,r={keys:[]}){let l=r.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+qv>u)return l;const{data:d,error:h}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,r={}){try{let l=a;if(!l){const{data:v,error:w}=await this.getSession();if(w||!v.session)return this._returnResult({data:null,error:w});l=v.session.access_token}const{header:u,payload:d,signature:h,raw:{header:g,payload:p}}=xu(l);r?.allowExpired||l0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!m){const{error:v}=await this.getUser(l);if(v)throw v;return{data:{claims:d,header:u,signature:h},error:null}}const b=o0(u.alg),x=await crypto.subtle.importKey("jwk",m,b,!0,["verify"]);if(!await crypto.subtle.verify(b,x,h,Yv(`${g}.${p}`)))throw new Du("Invalid JWT signature");return{data:{claims:d,header:u,signature:h},error:null}}catch(l){if(De(l))return this._returnResult({data:null,error:l});throw l}}}bs.nextInstanceID={};const I0=bs;class H0 extends I0{constructor(a){super(a)}}class $0{constructor(a,r,l){var u,d,h;this.supabaseUrl=a,this.supabaseKey=r;const g=Uv(a);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:Cv,realtime:Av,auth:Object.assign(Object.assign({},Tv),{storageKey:p}),global:Ev},b=zv(l??{},m);this.storageKey=(u=b.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=b.global.headers)!==null&&d!==void 0?d:{},b.accessToken?(this.accessToken=b.accessToken,this.auth=new Proxy({},{get:(x,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=b.auth)!==null&&h!==void 0?h:{},this.headers,b.global.fetch),this.fetch=Ov(r,this._getAccessToken.bind(this),b.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},b.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new Db(new URL("rest/v1",g).href,{headers:this.headers,schema:b.db.schema,fetch:this.fetch}),this.storage=new jv(this.storageUrl.href,this.headers,this.fetch,l?.storage),b.accessToken||this._listenForAuthEvents()}get functions(){return new Ob(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,r={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,r,l)}channel(a,r={config:{}}){return this.realtime.channel(a,r)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,r;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(r=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:r,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:h,flowType:g,lock:p,debug:m,throwOnError:b},x,_){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new H0({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),x),storageKey:h,autoRefreshToken:a,persistSession:r,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:b,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Zb(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,l)=>{this._handleTokenChanged(r,"CLIENT",l?.access_token)})}_handleTokenChanged(a,r,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const P0=(o,a,r)=>new $0(o,a,r);function V0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}V0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const G0="https://sqwqlvsjtimallidxrsz.supabase.co",F0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",te=P0(G0,F0,{auth:{persistSession:!1}}),wn=Object.freeze(Object.defineProperty({__proto__:null,default:te,supabase:te},Symbol.toStringTag,{value:"Module"}));async function xs(){try{const{data:o,error:a}=await te.from("empresa").select("*").limit(1).maybeSingle();if(a)throw a;const r=o||null;if(!r)return null;try{const l=r.logo;if(!l)r.logoUrl=null;else if(String(l).startsWith("http"))r.logoUrl=String(l);else{const u="logo";try{const h=(await te.storage.from(u).getPublicUrl(String(l)))?.data?.publicUrl??null;if(h)r.logoUrl=h;else{const g=await te.storage.from(u).createSignedUrl(String(l),3600);r.logoUrl=g?.data?.signedUrl??null}}catch{const h="https://sqwqlvsjtimallidxrsz.supabase.co";let g=String(l);g.startsWith(`${u}/`)&&(g=g.slice(u.length+1)),r.logoUrl=`${h}/storage/v1/object/public/${u}/${encodeURIComponent(g)}`}}}catch{r.logoUrl=null}return r}catch(o){return console.warn("getCompanyData error",o),null}}function K0({onLogin:o}){const[a,r]=j.useState(""),[l,u]=j.useState(""),[d,h]=j.useState(null);async function g(p){p.preventDefault(),h(null);try{const{data:m,error:b}=await te.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(b){h("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",b),b?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){h("Credenciales invlidas");return}const x=m;if(x.password===l){const _={id:x.id,username:x.username,role:x.role};localStorage.setItem("user",JSON.stringify(_));try{console.debug("Login: stored localStorage.user =",_)}catch{}try{if(x.role==="cajero"){const{data:v,error:w}=await te.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",x.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(v)&&v.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(v[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",v[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(v){console.debug("Login: error fetching cai for cajero",v)}h("Inicio de sesin correcto"),typeof o=="function"&&o()}else h("Credenciales invlidas")}catch(m){h(m.message||"Error al consultar la base de datos")}}return i.jsx("div",{className:"login-root",children:i.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[i.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),i.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),i.jsxs("div",{className:"login-inner",children:[i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"username",children:"Usuario"}),i.jsx("input",{id:"username",className:"input",value:a,onChange:p=>r(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"password",children:"Contrasea"}),i.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),i.jsx("div",{children:i.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&i.jsx("p",{style:{marginTop:12},children:d}),i.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",i.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function Y0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),i.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function J0({onBack:o}){const[a,r]=j.useState([]),[l,u]=j.useState(!0),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,b]=j.useState(""),[x,_]=j.useState(()=>new Date().toISOString().slice(0,16)),[v,w]=j.useState(()=>{try{const A=localStorage.getItem("user");if(A)return JSON.parse(A).username||"usuario"}catch{}return"usuario"});j.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(A=>A.json()).then(A=>{const $=A&&Array.isArray(A.ingresos)?A.ingresos:[],M=localStorage.getItem("ingresosEfectivo");let G=[];try{M&&(G=JSON.parse(M))}catch{}const E=[...$,...G];r(E)}).catch(()=>{const A=localStorage.getItem("ingresosEfectivo");try{A&&r(JSON.parse(A))}catch{r([])}}).finally(()=>u(!1))},[]);function N(A){localStorage.setItem("ingresosEfectivo",JSON.stringify(A))}function R(A){if(A.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const $=a.length?Math.max(...a.map(E=>E.id))+1:1,M={id:$,factura:d||`F-${$}`,motivo:g,monto:Number(m),fechaHora:new Date(x).toISOString(),usuario:v},G=[...a,M];r(G),N(G),h(""),p(""),b(""),_(new Date().toISOString().slice(0,16))}return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?i.jsx("p",{children:"Cargando..."}):i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),i.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),i.jsx("tbody",{children:a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(A=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:{padding:8},children:A.factura}),i.jsx("td",{style:{padding:8},children:A.motivo}),i.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",A.monto.toFixed(2)]}),i.jsx("td",{style:{padding:8},children:new Date(A.fechaHora).toLocaleString()}),i.jsx("td",{style:{padding:8},children:A.usuario})]},A.id))})]})})]}),i.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),i.jsxs("form",{onSubmit:R,style:{display:"grid",gap:8},children:[i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",i.jsx("input",{value:d,onChange:A=>h(A.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",i.jsx("input",{value:g,onChange:A=>p(A.target.value),className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",i.jsx("input",{value:m,onChange:A=>b(A.target.value===""?"":Number(A.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",i.jsx("input",{value:x,onChange:A=>_(A.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",i.jsx("input",{value:v,onChange:A=>w(A.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[i.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),i.jsx("button",{type:"button",onClick:()=>{h(""),p(""),b(""),_(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}async function cm(o={},a="cotizacion",r={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const K=await xs();K&&(l=l||K.nombre||K.comercio||l,u=u||K.rtn||u,d=d||K.direccion||K.direccion_fiscal||d,h=h||K.telefono||K.telefono_fijo||h,g=g||K.email||K.correo||g,p=p||K.logoUrl||K.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const K=await fetch(String(p),{mode:"cors"});if(K.ok){const T=await K.blob(),B=await new Promise(O=>{const P=new FileReader;P.onloadend=()=>{O(typeof P.result=="string"?P.result:null)},P.onerror=()=>{O(null)},P.readAsDataURL(T)});B&&(p=B)}}}catch{}let m=o.cotizacion||o.numero_cotizacion||o.numeroCotizacion||o.numero||o.Nmero||"";const b=o.cliente||"Cotizacin Cliente",x=o.identidad||o.rtn||r.identidad||"C/F",_=Array.isArray(r.carrito)?r.carrito:[],v=typeof r.subtotal=="number"?r.subtotal:_.reduce((K,T)=>K+Number(T.producto&&T.producto.precio||T.precio||0)*(T.cantidad||1),0),w=typeof r.descuento=="number"?r.descuento:0,N=typeof r.exonerado=="number"?r.exonerado:0,R=typeof r.gravado=="number"?r.gravado:v,A=typeof r.exento=="number"?r.exento:0,$=typeof r.isvTotal=="number"?r.isvTotal:0,M=typeof r.imp18Total=="number"?r.imp18Total:0,G=typeof r.impTouristTotal=="number"?r.impTouristTotal:0,E=typeof r.total=="number"?r.total:null,D=v+($||0)+(M||0)+(G||0),L=E??D,I=L,ce=r.pagos||{},ve=typeof ce.efectivo=="number"?ce.efectivo:typeof r.Efectivo=="number"?r.Efectivo:0,Z=typeof ce.tarjeta=="number"?ce.tarjeta:typeof r.Tarjeta=="number"?r.Tarjeta:0,de=typeof ce.transferencia=="number"?ce.transferencia:typeof r.Transferencia=="number"?r.Transferencia:0,H=typeof ce.totalPaid=="number"?ce.totalPaid:ve+Z+de;let ee;if(typeof ce.cambio=="number")ee=ce.cambio;else if(typeof r.cambio=="number")ee=r.cambio;else{const K=Number(H)-Number(I||0);ee=isNaN(K)?0:K>0?K:0}const C=_.map(K=>{const T=String(K.producto&&(K.producto.nombre||K.producto.descripcion)||K.descripcion||K.nombre||""),B=Number(K.cantidad||0),O=Number((K.producto&&(K.producto.precio??K.producto.precio_unitario))??K.precio_unitario??K.precio??0),P=!!(K.producto&&K.producto.exento)||!!K.exento,ie=!!(K.producto&&K.producto.aplica_impuesto_18)||!!K.aplica_impuesto_18,oe=!!(K.producto&&K.producto.aplica_impuesto_turistico)||!!K.aplica_impuesto_turistico,k=ie?r.tax18Rate??r.tax18??0:r.taxRate??r.tax??0,re=oe?r.taxTouristRate??r.taxTourist??0:0,be=(Number(k)||0)+(Number(re)||0);let Ee=O;!P&&be>0&&(Ee=O/(1+be));const we=Number(Ee||0).toFixed(2),Re=Ee*B,ze=Number(Re||0).toFixed(2);return`<tr><td>${K.producto&&K.producto.sku||K.sku||""} ${T}</td><td style="text-align:center">${B}</td><td style="text-align:right">L ${we}</td><td style="text-align:right">L ${ze}</td></tr>`}).join(`
`),z=(Number(ve)||0)+(Number(de)||0)+(Number(Z)||0)-(Number(ee)||0),X=isNaN(z)?0:z;return Q0(X),`<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cotizacin Detallada</title>
  <style>
    @page { size: letter; margin: 0.5in; }
    * { letter-spacing: 0 !important; word-spacing: 0 !important; margin: 0; padding: 0; line-height: 1.2 !important; box-sizing: border-box; }
    body { font-family: 'Arial', sans-serif; font-size: 10px; color: #000; margin: 0; padding: 0; }
    .factura-container { width: 100%; max-width: 8.5in; margin: 0 auto; padding: 0.25in; }
    .divider { border: none; border-top: 1px solid #ddd; margin: 8px 0; }
    .header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; gap: 12px; }
    .header img { width: 140px; height: auto; object-fit: contain; margin-right: 12px; }
    .header-title { font-size: 28px; color: #0f172a; text-align: right; flex-grow: 1; font-weight: 700 !important; }
    .info-section h3, .info-section p { font-size: 11px; margin-bottom: 3px; }

    /* Tabla: diseo moderno para impresin */
    .tabla { width: 100%; border-collapse: separate; border-spacing: 0; margin-top: 10px; font-size: 10px; box-shadow: 0 2px 6px rgba(2,6,23,0.06); border-radius: 6px; overflow: hidden; }
    .tabla thead tr { background: linear-gradient(180deg,#0f172a,#0b1220); color: #fff; }
    .tabla th { padding: 10px 8px; text-align: left; font-size: 10px; text-transform: uppercase; letter-spacing: 0.6px; font-weight: 700 !important; border-bottom: 1px solid rgba(255,255,255,0.08); }
    .tabla td { padding: 10px 8px; font-size: 10px; vertical-align: middle; background: #fff; font-weight: 400 !important; border-bottom: 1px solid #eef2f7; }
    .tabla tbody tr:nth-child(even) td { background: #f8fafc; }
    .tabla td:nth-child(2), .tabla td:nth-child(3), .tabla td:nth-child(4) { text-align: right; }
    .tabla td:first-child { text-align: left; }
    .tabla tfoot td { font-weight: 700 !important; }

    .totals-section { margin-top: 8px; display: grid; grid-template-columns: 1fr 1fr; gap: 4px 0; }
    .totals-section span.label { text-align: left; padding-left: 2px; font-weight: 600 !important; }
    .totals-section span.value { text-align: right; padding-right: 2px; font-weight: 700 !important; }
    .total-final { font-size: 11px; margin-top: 6px; border-top: 1px solid #e6edf3; padding-top: 6px; font-weight: 800 !important; }
    .footer-info { text-align: center; margin-top: 12px; font-size: 10px; color: #374151; }
    .letras { font-size: 11px; margin: 6px 0; text-align: center; }
    .firma-section { margin-top: 16px; display: flex; justify-content: space-around; text-align: center; }
    .copias-info { text-align: center; margin-top: 8px; }
    .final-message { font-size: 10px; text-align: center; margin-top: 10px; color: #374151; }

    @media print {
      .factura-container { box-shadow: none; border-radius: 0; }
      .tabla thead tr { background: #0f172a !important; color: #fff !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .tabla th, .tabla td { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    }

    html, body, .factura-container, .header, .header-title, .header-title-container, .tabla, .tabla th, .totals-section, .total-final, .footer-info { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; color-adjust: exact !important; }
    .header-title-container { text-align: right; }
    .numero-factura { font-size: 22px; color: #0f172a; margin-top: -3px; font-weight: 700 !important; }
  </style>
</head>
<body>
  <main class="factura-container">

    <header class="header">
      <img src="${p}" alt="Logo del Comercio" />
      <div class="header-title-container">
        <h1 class="header-title">COTIZACIN</h1>
        <h2 class="numero-factura">No. ${m||""}</h2>
      </div>
    </header>

    <hr class="divider" />

    <section class="info-section">
      <h3>${l}</h3>
      <p>RTN: ${u}</p>
      <p>Direccin: ${d}</p>
      <p>Telfono: ${h}</p>
      <p>Email: ${g}</p>
    </section>
    <hr class="divider" />

    <section class="info-section">
      <p>Cliente: ${b}</p>
      <p>RTN Cliente: ${x}</p>
    </section>
    <hr class="divider" />

    <section class="details-section">
      <table class="tabla">
        <thead>
          <tr>
            <th>Descripcin</th>
            <th style="width: 10%;">Cant</th>
            <th style="width: 15%;">Precio unitario</th>
            <th style="width: 15%;">Total</th>
          </tr>
        </thead>
        <tbody>
          ${C} </tbody>
      </table>
    </section>
    <hr class="divider" />

  <section class="totals-section">
    <span class="label">Descuento:</span> <span class="value">L ${w.toFixed(2)}</span>
    <span class="label">Sub Total Exonerado:</span> <span class="value">L ${Number(N).toFixed(2)}</span>
    <span class="label">Sub Total Gravado:</span> <span class="value">L ${Number(R).toFixed(2)}</span>
    <span class="label">Sub Total Exento:</span> <span class="value">L ${Number(A).toFixed(2)}</span>
    <span class="label">Tasa Turstica 4%:</span> <span class="value">L ${Number(G).toFixed(2)}</span>
    <span class="label">ISV 15%:</span> <span class="value">L ${Number($).toFixed(2)}</span>
    <span class="label">ISV 18%:</span> <span class="value">L ${Number(M).toFixed(2)}</span>
  </section>

  <section class="transaccion-section"><hr class="divider" />
    <span class="label">TOTAL TRANSACCIN:</span>
    <span class="value">L ${Number(L).toFixed(2)}</span>
  </section>

  <hr class="divider" />

    <section class="totals-section total-final">
      <span class="label">**TOTAL COTIZACIN:**</span> <span class="value">**L ${I.toFixed(2)}**</span>
     </section>
    <hr class="divider" />

    <footer class="footer-info">
      
      <div class="final-message">
     <h5 >
  Cotizacin sujeta a cambios.
</h5>
        <h5>Gracias por su preferencia!</h5>
      </div>
    </footer>

  </main>
</body>
</html>`}function Q0(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],r=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(b){if(b===0)return"";if(b<21)return a[b];if(b<100){const x=Math.floor(b/10),_=b%10;return r[x]+(_?" y "+a[_]:"")}if(b<1e3){const x=Math.floor(b/100),_=b%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const b=g%1e3;if(b){let x=u(b);m===2&&b===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}function X0({onBack:o}){const[a,r]=j.useState([]),[l,u]=j.useState(!1),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,b]=j.useState(!1),[x,_]=j.useState(!1),[v,w]=j.useState(null),N=async()=>{u(!0);try{const{data:Z,error:de}=await te.from("cotizaciones").select("*").order("fecha_cotizacion",{ascending:!1});if(de)throw de;const H=Array.isArray(Z)?Z:[],ee=Array.from(new Set(H.map(z=>z.cliente_id).filter(Boolean)));let Y={};if(ee.length>0)try{const{data:z}=await te.from("clientes").select("id,nombre").in("id",ee);if(Array.isArray(z))for(const X of z)Y[String(X.id)]=X.nombre||""}catch(z){console.warn("Error cargando nombres de clientes:",z)}const C=H.map(z=>({...z,cliente_nombre:Y[String(z.cliente_id)]||null}));r(C)}catch(Z){console.warn("Error cargando cotizaciones:",Z),r([])}u(!1)};j.useEffect(()=>{N()},[]);const[R,A]=j.useState(null),[$,M]=j.useState(null),[G,E]=j.useState(""),D=async Z=>{h(Z);try{const{data:de,error:H}=await te.from("cotizaciones").select("*").eq("id",Z).maybeSingle();if(H&&console.warn("Error cargando cabecera de cotizacion",H),A(de||null),de&&de.cliente_id)try{const{data:C}=await te.from("clientes").select("id,nombre").eq("id",de.cliente_id).maybeSingle();M(C?.nombre||null)}catch{M(null)}else M(null);const{data:ee,error:Y}=await te.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Z);if(Y)throw Y;p(Array.isArray(ee)?ee:[]),b(!0)}catch(de){console.warn("Error cargando detalles de cotizacion",de),p([])}},L=async Z=>{try{const{data:de,error:H}=await te.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Z.id),ee=Array.isArray(de)?de:[],Y={header:Z,detalles:ee};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(Y))}catch(C){console.warn("No se pudo escribir localStorage",C)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:Y}))}catch{}o()}catch(de){console.warn("Error cargando detalles para editar",de)}},I=async Z=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:de}=await te.from("cotizaciones_detalle").delete().eq("cotizacion_id",Z);de&&console.warn("Error eliminando detalles:",de);const{error:H}=await te.from("cotizaciones").delete().eq("id",Z);if(H)throw H;N()}catch(de){console.warn("Error eliminando cotizacion:",de)}},ce=async Z=>{try{const{data:de,error:H}=await te.from("cotizaciones").select("*").eq("id",Z).maybeSingle();if(H||!de){console.warn("Error fetching cotizacion header for reprint",H);return}const{data:ee,error:Y}=await te.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Z);if(Y){console.warn("Error fetching cotizacion detalles for reprint",Y);return}const C=Array.isArray(ee)?ee.map(K=>({producto:{sku:K.sku||""},descripcion:K.descripcion||K.nombre||"",cantidad:Number(K.cantidad||1),precio_unitario:Number(K.precio_unitario||K.precio||0),subtotal:Number(K.subtotal||0),total:Number(K.total||0)})):[],z={cliente:de.cliente||null,rtn:de.rtn||null,cotizacion:de.numero_cotizacion||de.Nmero||null},X={carrito:C,subtotal:Number(de.subtotal||0),isvTotal:Number(de.isv||de.impuesto||0),imp18Total:Number(de.impuesto_18||0),impTouristTotal:Number(de.impuesto_turistico||0),total:Number(de.total||0)},me=await cm(z,"cotizacion",X);try{const K=document.createElement("iframe");K.style.position="fixed",K.style.right="0",K.style.bottom="0",K.style.width="0",K.style.height="0",K.style.border="0",K.style.overflow="hidden",K.setAttribute("aria-hidden","true"),document.body.appendChild(K);const T=K.contentWindow,B=K.contentDocument||K.contentWindow?.document;if(!B||!T)try{document.body.removeChild(K)}catch{}else{B.open(),B.write(me),B.close();const O=()=>{try{T.focus(),T.print()}catch(ie){console.warn("Error during iframe print (reprint):",ie)}setTimeout(()=>{try{document.body.removeChild(K)}catch{}},800)},P=()=>{try{const ie=B.images;if(ie&&ie.length>0){let oe=0;for(let k=0;k<ie.length;k++){const re=ie[k];re.complete?oe++:(re.addEventListener("load",()=>{oe++,oe===ie.length&&O()}),re.addEventListener("error",()=>{oe++,oe===ie.length&&O()}))}oe===ie.length&&O()}else O()}catch{try{T.addEventListener("load",O)}catch{}setTimeout(O,1e3)}};try{B.readyState==="complete"?P():(T.addEventListener("load",P),setTimeout(P,1500))}catch{setTimeout(P,800)}}}catch(K){console.warn("Reprint direct failed, opening new window fallback",K);const T=window.open("","_blank");T&&(T.document.open(),T.document.write(me),T.document.close(),setTimeout(()=>{try{T.print(),T.close()}catch{}},800))}}catch(de){console.warn("Error reprinting cotizacion",de)}},ve=async()=>{if(v)try{const Z={cliente:v.cliente||null,rtn:v.rtn||null,nota:v.nota||null,subtotal:Number(v.subtotal||0),isv:Number(v.isv||0),impuesto_18:Number(v.impuesto_18||0),impuesto_turistico:Number(v.impuesto_turistico||0),total:Number(v.total||0)},{error:de}=await te.from("cotizaciones").update(Z).eq("id",v.id);if(de&&console.warn("Error actualizando cotizacion:",de),v.id){const{error:H}=await te.from("cotizaciones_detalle").delete().eq("cotizacion_id",v.id);H&&console.warn("Error borrando detalles antiguos:",H);const ee=g.map(C=>({...C,cotizacion_id:v.id})),{error:Y}=await te.from("cotizaciones_detalle").insert(ee);Y&&console.warn("Error insertando detalles actualizados:",Y)}_(!1),N()}catch(Z){console.warn("Error guardando cotizacion editada:",Z)}};return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),i.jsxs("div",{children:[i.jsx("button",{onClick:N,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),i.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),i.jsx("input",{placeholder:"Nmero o cliente",value:G,onChange:Z=>E(Z.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),i.jsx("button",{onClick:()=>E(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?i.jsx("div",{children:"Cargando..."}):a.length===0?i.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Nmero"}),i.jsx("th",{style:{padding:8},children:"Fecha"}),i.jsx("th",{style:{padding:8},children:"Usuario"}),i.jsx("th",{style:{padding:8},children:"Cliente ID"}),i.jsx("th",{style:{padding:8},children:"Total"}),i.jsx("th",{style:{padding:8},children:"Estado"}),i.jsx("th",{style:{padding:8},children:"Acciones"})]})}),i.jsx("tbody",{children:a.filter(Z=>{if(!G)return!0;const de=G.toLowerCase(),H=(Z.numero_cotizacion||Z.Nmero||"").toLowerCase(),ee=(Z.cliente_nombre||"")?.toLowerCase(),Y=(Z.usuario||"").toLowerCase();return H.includes(de)||ee.includes(de)||Y.includes(de)}).map(Z=>i.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[i.jsx("td",{style:{padding:8},children:Z.numero_cotizacion||Z.Nmero||""}),i.jsx("td",{style:{padding:8},children:Z.fecha_cotizacion?new Date(Z.fecha_cotizacion).toLocaleString():""}),i.jsx("td",{style:{padding:8},children:Z.usuario||""}),i.jsx("td",{style:{padding:8},children:Z.cliente_nombre||(Z.cliente_id?String(Z.cliente_id):"")}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Z.total||0).toFixed(2)]}),i.jsx("td",{style:{padding:8},children:Z.estado||""}),i.jsxs("td",{style:{padding:8},children:[i.jsx("button",{onClick:()=>D(Z.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),i.jsx("button",{onClick:()=>ce(Z.id),className:"btn-opaque",style:{marginRight:6},children:"Reimprimir"}),String(Z.estado||"").toLowerCase()==="aceptada"?i.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):i.jsx("button",{onClick:()=>L(Z),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),i.jsx("button",{onClick:()=>I(Z.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},Z.id))})]})]}),m&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),i.jsx("button",{onClick:()=>{b(!1),p([]),h(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[R&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[i.jsxs("div",{children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Nmero:"})," ",R.numero_cotizacion||R.Nmero||""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Fecha:"})," ",R.fecha_cotizacion?new Date(R.fecha_cotizacion).toLocaleString():""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Usuario:"})," ",R.usuario]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Cliente:"})," ",$??(R.cliente_id?String(R.cliente_id):"C/F")]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Subtotal:"})," L ",Number(R.subtotal||0).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Impuesto:"})," L ",Number(R.impuesto||0).toFixed(2)]}),i.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[i.jsx("strong",{children:"Total:"})," L ",Number(R.total||0).toFixed(2)]})]})]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Descripcin"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio U."}),i.jsx("th",{style:{padding:8},children:"Subtotal"}),i.jsx("th",{style:{padding:8},children:"Descuento"}),i.jsx("th",{style:{padding:8},children:"Total"})]})}),i.jsx("tbody",{children:g.map((Z,de)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:Z.descripcion}),i.jsx("td",{style:{padding:8},children:Z.cantidad}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Z.precio_unitario||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Z.subtotal||(Z.precio_unitario||0)*(Z.cantidad||0)).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Z.descuento||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Z.total||(Z.subtotal||0)-(Z.descuento||0)).toFixed(2)]})]},de))})]})]})]})}),x&&v&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",v.id]}),i.jsx("button",{onClick:()=>{_(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{children:"Cliente"}),i.jsx("input",{value:v.cliente||"",onChange:Z=>w({...v,cliente:Z.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),i.jsxs("div",{children:[i.jsx("label",{children:"RTN"}),i.jsx("input",{value:v.rtn||"",onChange:Z=>w({...v,rtn:Z.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"SKU"}),i.jsx("th",{style:{padding:8},children:"Nombre"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio"}),i.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),i.jsx("tbody",{children:g.map((Z,de)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:Z.sku}),i.jsx("td",{style:{padding:8},children:Z.nombre}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:Z.cantidad||0,onChange:H=>{const ee=Number(H.target.value||0),Y=[...g];Y[de]={...Y[de],cantidad:ee},p(Y)},style:{width:80,padding:6}})}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:Z.precio_unitario||0,onChange:H=>{const ee=Number(H.target.value||0),Y=[...g];Y[de]={...Y[de],precio_unitario:ee},p(Y)},style:{width:120,padding:6}})}),i.jsxs("td",{style:{padding:8},children:["L ",Number((Z.precio_unitario||0)*(Z.cantidad||0)).toFixed(2)]})]},de))})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:()=>{_(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:ve,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function Z0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),i.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function W0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function ex({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function Fn({children:o,style:a,className:r}){const[l,u]=j.useState(!1);j.useEffect(()=>{const h=setTimeout(()=>u(!0),10);return()=>clearTimeout(h)},[]);const d={transform:l?"scale(1)":"scale(0.94)",opacity:l?1:0,transition:"transform 180ms cubic-bezier(.2,.9,.2,1), opacity 160ms ease",transformOrigin:"center center"};return i.jsx("div",{className:r,style:{...d,...a},children:o})}function tx({open:o,onClose:a,onSelect:r}){const[l,u]=j.useState(""),[d,h]=j.useState(!1),[g,p]=j.useState([]);return j.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{h(!0);try{const{data:b,error:x}=await te.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(x)throw x;m&&p(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando clientes:",b)}finally{m&&h(!1)}})(),()=>{m=!1}},[o]),j.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{h(!0);try{const b=String(l||"").trim();let x;if(b===""?x=await te.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):x=await te.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${b}%,rtn.ilike.%${b}%`).order("id",{ascending:!1}).limit(100),x.error)throw x.error;p(Array.isArray(x.data)?x.data:[])}catch(b){console.warn("Error buscando clientes:",b)}finally{h(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),i.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),i.jsx("th",{style:{padding:8}})]})}),i.jsxs("tbody",{children:[g.map(m=>i.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[i.jsx("td",{style:{padding:8},children:m.rtn}),i.jsx("td",{style:{padding:8},children:m.nombre}),i.jsx("td",{style:{padding:8},children:m.telefono}),i.jsx("td",{style:{padding:8},children:m.correo_electronico}),i.jsx("td",{style:{padding:8},children:i.jsx("button",{onClick:()=>{r(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})})}):null}function nx({open:o,onClose:a,totalDue:r,onConfirm:l,exchangeRate:u}){const[d,h]=j.useState([]),[g,p]=j.useState("efectivo"),[m,b]=j.useState(0),[x,_]=j.useState(""),[v,w]=j.useState(""),[N,R]=j.useState(""),[A,$]=j.useState(""),[M,G]=j.useState(""),[E,D]=j.useState(0),[L,I]=j.useState(null),[ce,ve]=j.useState(!1);j.useEffect(()=>{o||(h([]),p("efectivo"),b(0),_(""),w(""),R(""),$(""),G(""),I(null),ve(!1))},[o]);const Z=O=>{const P=Number(O);return Number.isFinite(P)?Number(P.toFixed(2)):0},de=()=>{const O=Z(m);if(O<=0)return;const P={id:String(Date.now())+Math.random().toString(36).slice(2,7),tipo:g,monto:O,usd_monto:g==="dolares"?Number((E||0).toFixed(2)):void 0,banco:x||void 0,tarjeta:v||void 0,factura:N||void 0,autorizador:A||void 0,referencia:M||void 0};h(ie=>[...ie,P]),b(0),_(""),w(""),R(""),$(""),G("")},H=O=>{h(P=>P.filter(ie=>ie.id!==O))},ee=d.filter(O=>O.tipo==="efectivo").reduce((O,P)=>O+P.monto,0),Y=d.filter(O=>O.tipo==="tarjeta").reduce((O,P)=>O+P.monto,0),C=d.filter(O=>O.tipo==="transferencia").reduce((O,P)=>O+P.monto,0),z=d.filter(O=>O.tipo==="dolares").reduce((O,P)=>O+P.monto,0),X=Number((ee+Y+C+z).toFixed(2)),me=Number((r-X).toFixed(2)),K=X>=r&&X>0,T=O=>new Intl.NumberFormat("es-HN",{style:"currency",currency:"HNL"}).format(O).replace("HNL","L"),B=()=>{(async()=>{const O=[];ee>0&&O.push(`efectivo:(${ee.toFixed(2)})`),Y>0&&O.push(`tarjeta:(${Y.toFixed(2)})`),C>0&&O.push(`transferencia:(${C.toFixed(2)})`);const P=O.join(",");try{ve(!0),await new Promise(ie=>setTimeout(ie,1500)),await l({efectivo:ee,tarjeta:Y,transferencia:C,totalPaid:X,tipoPagoString:P,pagos:d})}catch(ie){console.warn("Error en handleConfirm:",ie)}finally{try{ve(!1)}catch{}try{a()}catch{}}})()};return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:1100,maxWidth:"99%",background:"white",borderRadius:10,padding:16,maxHeight:"94vh",overflow:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:10,display:"grid",gridTemplateColumns:"1fr 420px",gap:14,fontSize:13},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",i.jsx("strong",{children:T(r)})]}),i.jsx("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:6,marginBottom:12,fontSize:13},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #efefef"},children:[i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Monto"}),i.jsx("th",{children:"Detalles"}),i.jsx("th",{})]})}),i.jsxs("tbody",{children:[d.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,style:{padding:12,color:"#666"},children:"No hay pagos registrados"})}),d.map(O=>i.jsxs("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[i.jsx("td",{style:{padding:"6px 4px"},children:O.tipo}),i.jsx("td",{style:{padding:"6px 4px"},children:T(O.monto)}),i.jsxs("td",{style:{padding:"6px 4px",fontSize:12},children:[O.tipo==="efectivo"&&i.jsx("span",{children:""}),O.tipo==="tarjeta"&&i.jsxs("span",{children:[O.banco||"-"," / ",O.tarjeta||"-"," / ",O.factura||"-"]}),O.tipo==="transferencia"&&i.jsxs("span",{children:[O.banco||"-"," / ",O.referencia||"-"]})]}),i.jsx("td",{style:{padding:"8px 4px",textAlign:"right"},children:i.jsx("button",{onClick:()=>I(O.id),className:"btn-opaque","aria-label":"Eliminar pago",title:"Eliminar pago",style:{background:"transparent",border:"none",padding:6,cursor:"pointer",color:"#ef4444"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",focusable:"false",children:[i.jsx("polyline",{points:"3 6 5 6 21 6"}),i.jsx("path",{d:"M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"}),i.jsx("path",{d:"M10 11v6"}),i.jsx("path",{d:"M14 11v6"}),i.jsx("path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"})]})})})]},O.id))]})]})}),i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:8,fontSize:13},children:[i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Efectivo"}),i.jsx("div",{style:{fontWeight:600},children:T(ee)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Tarjeta"}),i.jsx("div",{style:{fontWeight:600},children:T(Y)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Transferencia"}),i.jsx("div",{style:{fontWeight:600},children:T(C)})]}),i.jsxs("div",{style:{marginLeft:"auto",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Total ingresado"}),i.jsx("div",{style:{fontWeight:700},children:T(X)}),i.jsx("div",{style:{marginTop:6,color:me>0?"#ef4444":"#16a34a"},children:me>0?`Falta ${T(me)}`:`Cambio ${T(Math.abs(me))}`})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:10,fontSize:13},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de pago"}),i.jsxs("select",{value:g,onChange:O=>{p(O.target.value),b(0),D(0),_(""),w(""),R(""),$(""),G("")},style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"efectivo",children:"Efectivo"}),i.jsx("option",{value:"tarjeta",children:"Tarjeta"}),i.jsx("option",{value:"transferencia",children:"Transferencia"}),i.jsx("option",{value:"dolares",children:"Dlares"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Monto"}),g==="dolares"?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"$"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:E,onChange:O=>{const P=Z(O.target.value);D(P);const ie=Number((P*u).toFixed(2));b(ie)},style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"L (convertido)"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:m,readOnly:!0,style:{width:"100%",padding:6,borderRadius:6,fontSize:13,background:"#f9fafb"}})]})]}):i.jsx("input",{type:"number",min:0,step:"0.01",value:m,onChange:O=>b(Z(O.target.value)),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),g==="dolares"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de cambio (Lps por $)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("div",{style:{fontSize:14,fontWeight:600},children:[u.toFixed(2)," L"]}),i.jsx("div",{style:{fontSize:13,color:"#666"},children:"(Editable en el encabezado de Punto de Ventas)"})]})]}),g==="efectivo"&&i.jsx("div",{style:{fontSize:13,color:"#444",marginBottom:8},children:'Pago en efectivo: solo indique el monto y presione "Agregar".'}),g==="tarjeta"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:O=>_(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras "}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente "}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas "}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda "}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores "}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tarjeta (ltimos 4)"}),i.jsx("input",{value:v,onChange:O=>w(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Factura"}),i.jsx("input",{value:N,onChange:O=>R(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Autorizador"}),i.jsx("input",{value:A,onChange:O=>$(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]})]}),g==="transferencia"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:O=>_(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras  (Banco de Amrica Central Honduras)"}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente  Banocc"}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas  (Banco del Pas)"}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda  Davi"}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores  BanTrab"}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Referencia"}),i.jsx("input",{value:M,onChange:O=>G(O.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:10},children:[i.jsx("button",{onClick:de,className:"btn-opaque",style:{background:"#0ea5a4",color:"white",padding:"6px 10px",borderRadius:6,fontSize:13},children:"Agregar"}),i.jsx("button",{onClick:()=>{b(r-X)},className:"btn-opaque",style:{background:"transparent",fontSize:13},children:"Exacto"})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",fontSize:13,padding:"6px 10px"},children:"Cancelar"}),i.jsx("button",{onClick:B,className:"btn-opaque",disabled:!K,style:{background:K?"#16a34a":"gray",color:"white",fontSize:13,padding:"6px 12px"},children:"Registrar y guardar venta"})]}),L&&i.jsx("div",{role:"dialog","aria-modal":"true",onClick:()=>I(null),style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3},children:i.jsxs("div",{onClick:O=>O.stopPropagation(),style:{width:360,background:"white",borderRadius:8,padding:14,boxShadow:"0 10px 30px rgba(0,0,0,0.15)",position:"relative"},children:[i.jsx("button",{"aria-label":"Cerrar",title:"Cerrar",onClick:()=>I(null),style:{position:"absolute",right:8,top:8,background:"transparent",border:"none",padding:6,cursor:"pointer",color:"#666"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),i.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Confirmar eliminacin"}),i.jsx("div",{style:{marginBottom:12},children:"Eliminar este pago? Esta accin no se puede deshacer."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{onClick:()=>I(null),className:"btn-opaque",style:{background:"transparent",padding:"6px 10px"},children:"Cancelar"}),i.jsx("button",{onClick:()=>{L&&(H(L),I(null))},className:"btn-opaque",style:{background:"#ef4444",color:"white",padding:"6px 10px"},children:"Eliminar"})]})]})}),ce&&i.jsx("div",{role:"status","aria-live":"polite",style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:12500,background:"rgba(2,6,23,0.6)"},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.98)",padding:18,borderRadius:10,display:"flex",flexDirection:"column",alignItems:"center",gap:12,boxShadow:"0 10px 30px rgba(0,0,0,0.25)"},children:[i.jsx("svg",{width:"56",height:"56",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:i.jsxs("g",{transform:"translate(0,0)",children:[i.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"#e6edf3",strokeWidth:"3",fill:"none"}),i.jsx("path",{d:"M22 12a10 10 0 0 1-10 10",stroke:"#0ea5a4",strokeWidth:"3",strokeLinecap:"round",children:i.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 12 12",to:"360 12 12",dur:"1s",repeatCount:"indefinite"})})]})}),i.jsx("div",{style:{fontSize:15,fontWeight:700},children:"Generando factura"})]})})]})})}):null}function ax({productos:o,imageUrls:a,agregarAlCarrito:r,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:h}){return i.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:i.jsxs("tr",{children:[i.jsx("th",{style:u}),i.jsx("th",{style:u,children:"Imagen"}),i.jsx("th",{style:u,children:"SKU"}),i.jsx("th",{style:u,children:"Nombre"}),i.jsx("th",{style:u,children:"Categora"}),i.jsx("th",{style:u,children:"Precio"}),i.jsx("th",{style:u,children:"Stock"}),i.jsx("th",{style:u,children:"Accin"})]})}),i.jsx("tbody",{children:o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:d,children:i.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),i.jsx("td",{style:d,children:a[String(g.id)]?i.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?i.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),i.jsx("td",{style:d,children:i.jsx("code",{style:h,children:g.sku})}),i.jsx("td",{style:d,children:i.jsx("strong",{children:g.nombre})}),i.jsx("td",{style:d,children:i.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),i.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return i.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),b=p<1||m<=0,x=b?p<1?"Agotado":"Sin precio":"Agregar";return i.jsx("button",{onClick:()=>r(g),disabled:b,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:b?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:x})})()})]},g.id))})]})})}function ix({carrito:o,actualizarCantidad:a,eliminarDelCarrito:r,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:h,tax18Rate:g,taxTouristRate:p,total:m,openSelector:b,btnStyle:x}){return i.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&i.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&i.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[i.jsx("span",{children:"TOTAL:"}),i.jsxs("span",{children:["L",m.toFixed(2)]})]})," ",i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["L",u.toFixed(2)]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[i.jsxs("div",{children:["ISV (",h*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,v)=>_+(v.isv||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto 18%: ",i.jsxs("strong",{children:["L",Number(d.reduce((_,v)=>_+(v.imp18||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto turstico (",p*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,v)=>_+(v.tur||0),0)).toFixed(2)]})]})]})}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:i.jsxs("details",{style:{marginTop:6},children:[i.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),i.jsx("div",{style:{marginTop:8},children:d.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[i.jsxs("div",{style:{color:"#0f172a"},children:[_.nombre,"  L",_.price.toFixed(2)]}),i.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",_.isv.toFixed(2),"  18%: L",_.imp18.toFixed(2),"  Tur: L",_.tur.toFixed(2)]})]},String(_.id)))})]})}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[i.jsx("button",{onClick:()=>b("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),i.jsx("button",{onClick:()=>b("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?i.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):i.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",_.producto.sku,"] ",_.producto.nombre]}),i.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(_.producto.precio||0).toFixed(2)," c/u"]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("button",{onClick:()=>a(_.producto.id,-1),style:x,children:""}),i.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:_.cantidad}),i.jsx("button",{onClick:()=>a(_.producto.id,1),style:x,children:"+"}),i.jsx("button",{onClick:()=>r(_.producto.id),style:{...x,background:"#ef4444"},children:""})]})]},_.producto.id))})]})}function rx({userName:o,userRole:a,userId:r,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:h,onPrintFormatChange:g,onOpenCajaConfig:p,printFormat:m}){const[b,x]=j.useState(!1),[_,v]=j.useState(!1),w=j.useRef(null),[N,R]=j.useState(null),[A,$]=j.useState(null);return j.useEffect(()=>{function M(G){w.current&&!w.current.contains(G.target)&&x(!1)}return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[]),j.useEffect(()=>{let M=!0;return(async()=>{try{const G=await xs();if(!M||!G)return;const E=G.nombre||G.comercio||G.name||null,D=G.logoUrl||G.logo||null;E&&R(String(E)),D&&$(String(D))}catch{}})(),()=>{M=!1}},[]),i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        .pv-zoom-modal { animation: pv-zoom-in 220ms ease-out both; transform-origin: center; }
        @keyframes pv-zoom-in {
          from { opacity: 0; transform: scale(0.96) translateY(-6px); }
          to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .pv-backdrop { background: rgba(2,6,23,0.6); }
        .pv-logout-title { font-size: 1.05rem; font-weight: 800; }
        .pv-logout-body { color: #334155; margin-top: 6px; margin-bottom: 10px; }
      `}),i.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[A?i.jsx("img",{src:A,alt:"logo",style:{width:40,height:40,objectFit:"contain",borderRadius:6}}):null,i.jsx("div",{style:{margin:0,fontSize:"1.05rem",fontWeight:700},children:N||"Punto de Ventas"})]}),i.jsx("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:i.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""})}),i.jsxs("div",{style:{position:"relative"},ref:w,children:[i.jsx("button",{onClick:()=>x(M=>!M),"aria-expanded":b,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),b&&i.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[i.jsx("button",{onClick:()=>{x(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),i.jsx("button",{onClick:()=>{x(!1),p&&p()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Configuracin de caja"}),i.jsx("button",{onClick:()=>{x(!1),h("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),i.jsx("button",{onClick:()=>{x(!1),h("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),i.jsx("button",{onClick:()=>{x(!1),h("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),i.jsx("button",{onClick:()=>{x(!1),h("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),i.jsx("button",{onClick:()=>{x(!1),h("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),i.jsx("button",{onClick:()=>{x(!1),h("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"}),i.jsx("button",{onClick:()=>{x(!1),v(!0)},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"})]}),_&&i.jsx("div",{role:"dialog","aria-modal":"true",className:"pv-backdrop",style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3},onClick:()=>v(!1),children:i.jsxs("div",{onClick:M=>M.stopPropagation(),className:"pv-zoom-modal",style:{width:380,background:"white",borderRadius:10,padding:18,boxShadow:"0 18px 40px rgba(2,6,23,0.35)"},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",gap:12},children:i.jsxs("div",{children:[i.jsx("div",{className:"pv-logout-title",children:"Confirmar cierre de sesin"}),i.jsx("div",{className:"pv-logout-body",children:" Deseas continuar?"})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:()=>v(!1),className:"btn-opaque",style:{background:"transparent",padding:"8px 12px",borderRadius:8},children:"Cancelar"}),i.jsx("button",{onClick:()=>{v(!1);try{d()}catch{}},className:"btn-opaque",style:{background:"#ef4444",color:"white",padding:"8px 12px",borderRadius:8},children:"Cerrar sesin"})]})]})})]})]})]})}function sx({open:o,onClose:a,printFormat:r,onPrintFormatChange:l,exchangeRate:u,onExchangeRateChange:d}){const[h,g]=j.useState(u||0),[p,m]=j.useState(r||"carta");if(j.useEffect(()=>{g(u||0)},[u,o]),j.useEffect(()=>{m(r||"carta")},[r,o]),!o)return null;const b=()=>{try{l(p)}catch{}try{d(Number((h||0).toFixed(2)))}catch{}a()};return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:420,background:"white",borderRadius:10,padding:16,boxShadow:"0 8px 30px rgba(0,0,0,0.2)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h4",{style:{margin:0},children:"Configuracin de caja"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cerrar"})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{style:{display:"block",marginBottom:8},children:"Impresin"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("button",{onClick:()=>m("carta"),className:"btn-opaque",style:{padding:"6px 10px",background:p==="carta"?"#0ea5e9":"transparent",color:p==="carta"?"white":"#0b1724"},children:"Carta"}),i.jsx("button",{onClick:()=>m("cinta"),className:"btn-opaque",style:{padding:"6px 10px",background:p==="cinta"?"#0ea5e9":"transparent",color:p==="cinta"?"white":"#0b1724"},children:"Cinta"})]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{style:{display:"block",marginBottom:8},children:"Tipo de cambio Lps / $"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:h,onChange:x=>g(Number(x.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:b,className:"btn-opaque",style:{background:"#16a34a",color:"white"},children:"Guardar"})]})]})})})}function lx({open:o,onClose:a,width:r=520,children:l,zIndex:u=9999}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:i.jsx(Fn,{children:i.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:r,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})})}):null}function ox({open:o,onClose:a,caiInfo:r,onRefresh:l}){const[u,d]=Wl.useState(!1);return i.jsx(lx,{open:o,onClose:a,width:520,children:i.jsxs("div",{children:[i.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),i.jsxs("div",{style:{color:"#475569",marginTop:8},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"CAI:"})," ",r?.cai??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Identificador:"})," ",r?.identificador??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango desde:"})," ",r?.rango_de??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango hasta:"})," ",r?.rango_hasta??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Fecha lmite emisin:"})," ",r?.fecha_vencimiento??r?.fecha_limite_emision??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Secuencia actual:"})," ",r?.secuencia_actual??"-"]})]}),i.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),i.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(h){console.debug("Error calling onRefresh from DatosFacturaModal:",h)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function cx({open:o,selectedEntrada:a,onClose:r,imageUrls:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),i.jsx("button",{onClick:r,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?i.jsx("div",{children:i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?i.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):i.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),i.jsxs("div",{style:{flex:1},children:[i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"SKU:"})," ",a.sku]}),i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),i.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),i.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:i.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):i.jsx("div",{children:i.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})})}):null}function ux({open:o,onClose:a,onCancel:r,onSave:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:r,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),i.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})})}):null}function dx({open:o,onClose:a,doFacturaClienteFinal:r,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:h,taxRate:g,taxableSubtotal:p}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(Fn,{children:i.jsx("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[i.jsxs("div",{onClick:r,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Consumidor final"})]}),i.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar datos del cliente"})]}),i.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Razn social / RTN"})]})]})]})})})}):null}function fx({open:o,onClose:a,clienteTipo:r,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:h,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:b,onNombreChange:x,onTelefonoChange:_,onCorreoChange:v,onExoneradoChange:w,onCreateCliente:N,onCancel:R,onOpenCreateCliente:A,onOpenPayment:$,paymentDone:M,submitClienteNormal:G}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:r==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569",marginTop:6},children:r==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{value:l,onChange:E=>b(E.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),r==="juridico"&&i.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:r==="juridico"?"Razn social":"Nombre completo"}),i.jsx("input",{value:u,onChange:E=>x(E.target.value),placeholder:r==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx(tx,{open:p,onClose:()=>m(!1),onSelect:E=>{try{if(E&&typeof E=="object"){const D=E.rtn||"",L=E.nombre||"",I=E.telefono||"",ce=E.correo_electronico||"",ve=!!E.exonerado;try{b(String(D||""))}catch{}try{x(String(L||""))}catch{}try{_(String(I||""))}catch{}try{v(String(ce||""))}catch{}try{w(!!ve)}catch{}}}catch{}m(!1)}}),i.jsx("button",{onClick:R,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:A,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),M?i.jsx("button",{onClick:G,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):i.jsx("button",{onClick:$,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})})}):null}function hx({open:o,onClose:a,clienteRTN:r,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:h,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:b,onChangeExonerado:x,onCreate:_}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",i.jsx("strong",{children:"juridico"}),"."]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),i.jsx("input",{value:r,onChange:v=>g(v.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),i.jsx("input",{value:l,onChange:v=>p(v.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),i.jsx("input",{value:u,onChange:v=>m(v.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),i.jsx("input",{value:d,onChange:v=>b(v.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{id:"exon",type:"checkbox",checked:h,onChange:v=>x(v.target.checked)}),i.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:async()=>{await _()},className:"btn-opaque",style:{opacity:!l||!r?.6:1},disabled:!l||!r,children:"Crear cliente"})]})]})})}):null}function gx({open:o,onClose:a,carritoLength:r,subtotal:l,saveCotizacion:u,finalizePrint:d}){const[h,g]=j.useState("final"),[p,m]=j.useState(""),[b,x]=j.useState(""),[_,v]=j.useState(!1),[w,N]=j.useState(null),[R,A]=j.useState(!1);if(!o)return null;const $=D=>{g(D),N(null),D==="final"?(m("99999999999999"),x("Consumidor Final")):(m(""),x(""))},M=async()=>{if(p){v(!0);try{const{data:D,error:L}=await te.from("clientes").select("*").eq("rtn",p).maybeSingle();!L&&D?(N(D),x(D.nombre||"")):N(null)}catch{N(null)}finally{v(!1)}}},G=async()=>{if(!(!p||!b)){A(!0);try{const D={rtn:p,nombre:b,tipo_cliente:"juridico"},{data:L,error:I}=await te.from("clientes").insert([D]).select().maybeSingle();!I&&L&&N(L)}catch(D){console.warn("Error creando cliente juridico",D)}finally{A(!1)}}},E=async()=>{if(r===0)return;A(!0);let D=b,L=p||null;h==="final"&&(D="Consumidor Final",L="99999999999999");try{await new Promise(ce=>setTimeout(ce,1200));const I=await u({cliente:D,rtn:L});try{const ce=I&&I.numero?I.numero:null;await d(D,L,ce)}catch(ce){console.warn("Error during finalizePrint after cotizacion save",ce)}a()}catch(I){console.warn("Error generando cotizacion",I)}finally{A(!1)}};return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx(Fn,{children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Generar Cotizacin"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsxs("label",{style:{flex:1},children:[i.jsx("input",{type:"radio",checked:h==="final",onChange:()=>$("final")})," Consumidor Final"]}),i.jsxs("label",{style:{flex:1},children:[i.jsx("input",{type:"radio",checked:h==="normal",onChange:()=>$("normal")})," Cliente Normal"]}),i.jsxs("label",{style:{flex:1},children:[i.jsx("input",{type:"radio",checked:h==="juridico",onChange:()=>$("juridico")})," Jurdico"]})]}),i.jsxs("div",{style:{marginTop:12},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{children:"RTN o Identificacin"}),i.jsx("input",{value:p,onChange:D=>m(D.target.value),placeholder:h==="final"?"99999999999999":"00000000000000",style:{width:"100%",padding:8,marginTop:6}})]}),i.jsxs("div",{children:[i.jsx("label",{children:"Razn social / Nombre"}),i.jsx("input",{value:b,onChange:D=>x(D.target.value),placeholder:h==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{width:"100%",padding:8,marginTop:6}})]})]}),h==="juridico"&&i.jsxs("div",{style:{marginTop:8,display:"flex",gap:8},children:[i.jsx("button",{onClick:M,className:"btn-opaque",disabled:_,children:_?"Buscando...":"Buscar"}),i.jsx("button",{onClick:G,className:"btn-opaque",disabled:R||!p||!b,children:R?"Creando...":"Crear Cliente"})]}),w&&i.jsxs("div",{style:{marginTop:10,padding:8,background:"#f8fafc",borderRadius:8},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Encontrado:"})," ",w.nombre]}),i.jsxs("div",{children:["RTN: ",w.rtn]})]})]}),i.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:E,className:"btn-opaque",disabled:R||r===0,children:R?"Generando cotizacin (1.2s)...":"Generar Cotizacin"})]})]})]})})})}async function up(o={},a="factura",r={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const k=await xs();k&&(l=l||k.nombre||k.comercio||l,u=u||k.rtn||u,d=d||k.direccion||k.direccion_fiscal||d,h=h||k.telefono||k.telefono_fijo||h,g=g||k.email||k.correo||g,p=p||k.logoUrl||k.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const k=await fetch(String(p),{mode:"cors"});if(k.ok){const re=await k.blob(),be=await new Promise(Ee=>{const we=new FileReader;we.onloadend=()=>{Ee(typeof we.result=="string"?we.result:null)},we.onerror=()=>{Ee(null)},we.readAsDataURL(re)});be&&(p=be)}}}catch{}let m=o.factura||"",b=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",v=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let k=o.caiInfo||null;if(!k&&typeof window<"u"){const re=window.localStorage.getItem("caiInfo");if(re)try{k=JSON.parse(re)}catch{k=null}}if(k&&(b=b||k.cai||k.CAI||"",x=x||k.fecha_vencimiento||k.fecha_limite_emision||"",_=_||k.rango_de||k.rangoDesde||"",v=v||k.rango_hasta||k.rangoHasta||"",w=w||k.identificador||"",!m))try{const re=k.identificador?String(k.identificador):"",be=k.secuencia_actual!=null?String(k.secuencia_actual):k.rango_de!=null?String(k.rango_de):"",Ee=String(be).replace(/[^0-9]/g,"")||"";let we=0;(k.rango_hasta||k.rango_de)&&(we=Math.max(String(k.rango_hasta||k.rango_de).length,Ee.length));const Re=Ee?String(Ee).padStart(we||Ee.length||1,"0"):"";m=(re||"")+(Re||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const N=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),R=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||r.identidad||"C/F",A=new Date().toLocaleString(),$=Array.isArray(r.carrito)?r.carrito:[],M=typeof r.subtotal=="number"?r.subtotal:$.reduce((k,re)=>k+Number(re.producto&&re.producto.precio||re.precio||0)*(re.cantidad||1),0),G=typeof r.descuento=="number"?r.descuento:0,E=typeof r.exonerado=="number"?r.exonerado:0,D=typeof r.gravado=="number"?r.gravado:M,L=typeof r.exento=="number"?r.exento:0,I=typeof r.isvTotal=="number"?r.isvTotal:0,ce=typeof r.imp18Total=="number"?r.imp18Total:0,ve=typeof r.impTouristTotal=="number"?r.impTouristTotal:0,Z=typeof r.total=="number"?r.total:null,de=M+(I||0)+(ce||0)+(ve||0),H=Z??de,ee=H,Y=r.pagos||{},C=typeof Y.efectivo=="number"?Y.efectivo:typeof r.Efectivo=="number"?r.Efectivo:0,z=typeof Y.tarjeta=="number"?Y.tarjeta:typeof r.Tarjeta=="number"?r.Tarjeta:0,X=typeof Y.transferencia=="number"?Y.transferencia:typeof r.Transferencia=="number"?r.Transferencia:0,me=typeof Y.totalPaid=="number"?Y.totalPaid:C+z+X;let K;if(typeof Y.cambio=="number")K=Y.cambio;else if(typeof r.cambio=="number")K=r.cambio;else{const k=Number(me)-Number(ee||0);K=isNaN(k)?0:k>0?k:0}const B=$.map(k=>{const re=String(k.producto&&(k.producto.nombre||k.producto.descripcion)||k.descripcion||k.nombre||""),be=Number(k.cantidad||0),Ee=Number((k.producto&&(k.producto.precio??k.producto.precio_unitario))??k.precio_unitario??k.precio??0),we=!!(k.producto&&k.producto.exento)||!!k.exento,Re=!!(k.producto&&k.producto.aplica_impuesto_18)||!!k.aplica_impuesto_18,ze=!!(k.producto&&k.producto.aplica_impuesto_turistico)||!!k.aplica_impuesto_turistico,Fe=Re?r.tax18Rate??r.tax18??0:r.taxRate??r.tax??0,xt=ze?r.taxTouristRate??r.taxTourist??0:0,At=(Number(Fe)||0)+(Number(xt)||0);let pt=Ee;!we&&At>0&&(pt=Ee/(1+At));const qt=Number(pt||0).toFixed(2),Bt=pt*be,it=Number(Bt||0).toFixed(2);return`<tr><td>${k.producto&&k.producto.sku||k.sku||""} ${re}</td><td style="text-align:center">${be}</td><td style="text-align:right">L ${qt}</td><td style="text-align:right">L ${it}</td></tr>`}).join(`
`),O=(Number(C)||0)+(Number(X)||0)+(Number(z)||0)-(Number(K)||0),P=isNaN(O)?0:O,ie=px(P);return`
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Factura Detallada</title>
	<style>
		@page { size: letter; margin: 0.5in; }
		* { letter-spacing: 0 !important; word-spacing: 0 !important; margin: 0; padding: 0; line-height: 1.2 !important; box-sizing: border-box; }
		body { font-family: 'Arial', sans-serif; font-size: 10px; color: #000; margin: 0; padding: 0; }
		.factura-container { width: 100%; max-width: 8.5in; margin: 0 auto; padding: 0.25in; }
		.divider { border: none; border-top: 1px solid #ddd; margin: 8px 0; }
		.header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; gap: 12px; }
		.header img { width: 140px; height: auto; object-fit: contain; margin-right: 12px; }
		.header-title { font-size: 28px; color: #0f172a; text-align: right; flex-grow: 1; font-weight: 700 !important; }
		.info-section h3, .info-section p { font-size: 11px; margin-bottom: 3px; }

		/* Tabla: diseo moderno para impresin (igual que cotizacin) */
		.tabla { width: 100%; border-collapse: separate; border-spacing: 0; margin-top: 10px; font-size: 10px; box-shadow: 0 2px 6px rgba(2,6,23,0.06); border-radius: 6px; overflow: hidden; }
		.tabla thead tr { background: linear-gradient(180deg,#0f172a,#0b1220); color: #fff; }
		.tabla th { padding: 10px 8px; text-align: left; font-size: 10px; text-transform: uppercase; letter-spacing: 0.6px; font-weight: 700 !important; border-bottom: 1px solid rgba(255,255,255,0.08); }
		.tabla td { padding: 10px 8px; font-size: 10px; vertical-align: middle; background: #fff; font-weight: 400 !important; border-bottom: 1px solid #eef2f7; }
		.tabla tbody tr:nth-child(even) td { background: #f8fafc; }
		.tabla td:nth-child(2), .tabla td:nth-child(3), .tabla td:nth-child(4) { text-align: right; }
		.tabla td:first-child { text-align: left; }
		.tabla tfoot td { font-weight: 700 !important; }

		.totals-section { margin-top: 8px; display: grid; grid-template-columns: 1fr 1fr; gap: 4px 0; }
		.totals-section span.label { text-align: left; padding-left: 2px; font-weight: 600 !important; }
		.totals-section span.value { text-align: right; padding-right: 2px; font-weight: 700 !important; }
		.total-final { font-size: 11px; margin-top: 6px; border-top: 1px solid #e6edf3; padding-top: 6px; font-weight: 800 !important; }
		.footer-info { text-align: center; margin-top: 12px; font-size: 10px; color: #374151; }
		.letras { font-size: 11px; margin: 6px 0; text-align: center; }
		.firma-section { margin-top: 16px; display: flex; justify-content: space-around; text-align: center; }
		.copias-info { text-align: center; margin-top: 8px; }
		.final-message { font-size: 10px; text-align: center; margin-top: 10px; color: #374151; }

		@media print {
			.factura-container { box-shadow: none; border-radius: 0; }
			.tabla thead tr { background: #0f172a !important; color: #fff !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
			.tabla th, .tabla td { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
		}

		html, body, .factura-container, .header, .header-title, .header-title-container, .tabla, .tabla th, .totals-section, .total-final, .footer-info { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; color-adjust: exact !important; }
		.header-title-container { text-align: right; }
		.numero-factura { font-size: 22px; color: #0f172a; margin-top: -3px; font-weight: 700 !important; }
	</style>
</head>
<body>
	<main class="factura-container">

		<header class="header">
    <img src="${p}" alt="Logo del Comercio" />
    <div class="header-title-container">
        <h1 class="header-title">FACTURA</h1>
        <h2 class="numero-factura">No. ${m}</h2>
    </div>
</header>

		<hr class="divider" />

		<section class="info-section">
			<h3>${l}</h3>
			<p>RTN: ${u}</p>
			<p>Direccin: ${d}</p>
			<p>Telfono: ${h}</p>
			<p>Email: ${g}</p>
		</section>
		<hr class="divider" />

		<section class="info-dates">
			<p>Fecha y hora: ${A}</p>
			<p>Factura No: ${m}</p>
			<p>CAI: ${b}</p>
			<p>Fecha lmite de emisin: ${x}</p>
			<p>Rango autorizado: ${w?w+" "+_+" al "+w+" "+v:_+" al "+v}</p>
		</section>
		<hr class="divider" />

		<section class="info-section">
			<p>Cliente: ${N}</p>
			<p>RTN Cliente: ${R}</p>
		</section>
		<hr class="divider" />

		<section class="details-section">
			<table class="tabla">
				<thead>
					<tr>
						<th>Descripcin</th>
						<th style="width: 10%;">Cant</th>
							<th style="width: 15%;">Precio unitario</th>
							<th style="width: 15%;">Total</th>
					</tr>
				</thead>
				<tbody>
					${B} </tbody>
			</table>
		</section>
		<hr class="divider" />

	<section class="totals-section">
    <span class="label">Descuento:</span> <span class="value">L ${G.toFixed(2)}</span>
    <span class="label">Sub Total Exonerado:</span> <span class="value">L ${Number(E).toFixed(2)}</span>
    <span class="label">Sub Total Gravado:</span> <span class="value">L ${Number(D).toFixed(2)}</span>
    <span class="label">Sub Total Exento:</span> <span class="value">L ${Number(L).toFixed(2)}</span>
    <span class="label">Tasa Turstica 4%:</span> <span class="value">L ${Number(ve).toFixed(2)}</span>
    <span class="label">ISV 15%:</span> <span class="value">L ${Number(I).toFixed(2)}</span>
    <span class="label">ISV 18%:</span> <span class="value">L ${Number(ce).toFixed(2)}</span>
</section>

<section class="transaccion-section"><hr class="divider" />
    <span class="label">TOTAL TRANSACCIN:</span>
    <span class="value">L ${Number(H).toFixed(2)}</span>
</section>

<hr class="divider" />


		<section class="totals-section total-final">
			<span class="label">**TOTAL FACTURA:**</span> <span class="value">**L ${ee.toFixed(2)}**</span>
			<span class="label">Efectivo:</span> <span class="value">L ${Number(C).toFixed(2)}</span>
			<span class="label">Tarjeta:</span> <span class="value">L ${Number(z).toFixed(2)}</span>
			<span class="label">Transferencia:</span> <span class="value">L ${Number(X).toFixed(2)}</span>
			<span class="label">Cambio:</span> <span class="value">L ${Number(K).toFixed(2)}</span>
		</section>
		<hr class="divider" />

		<footer class="footer-info">
			<div class="letras">
				<p>Total Pagado: L ${P.toFixed(2)}</p>
				<p>*** ${ie} Lempiras ***</p>
			</div>
			<hr class="divider" />
			
			<div class="firma-section">
				<p>Firma del Cliente: ______________________</p>
				<p>Firma del Emisor: ______________________</p>
			</div>
			
			<div class="copias-info">
				<p>Original: Cliente | Copia: Obligado tributario emisor</p>
			</div>
			
			<div class="final-message">
				<h5>Para cualquier reclamo debe presentar su factura</h5>
				<h5>Gracias por su compra!</h5>
				<h5>LA FACTURA ES BENEFICIO DE TODOS EXJALA!</h5>
			</div>
		</footer>

	</main>
</body>
</html>`}function px(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],r=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(b){if(b===0)return"";if(b<21)return a[b];if(b<100){const x=Math.floor(b/10),_=b%10;return r[x]+(_?" y "+a[_]:"")}if(b<1e3){const x=Math.floor(b/100),_=b%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const b=g%1e3;if(b){let x=u(b);m===2&&b===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}async function dp(o={},a="factura",r={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const k=await xs();k&&(l=l||k.nombre||k.comercio||l,u=u||k.rtn||u,d=d||k.direccion||k.direccion_fiscal||d,h=h||k.telefono||k.telefono_fijo||h,g=g||k.email||k.correo||g,p=p||k.logoUrl||k.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const k=await fetch(String(p),{mode:"cors"});if(k.ok){const re=await k.blob(),be=await new Promise(Ee=>{const we=new FileReader;we.onloadend=()=>{Ee(typeof we.result=="string"?we.result:null)},we.onerror=()=>{Ee(null)},we.readAsDataURL(re)});be&&(p=be)}}}catch{}let m=o.factura||"",b=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",v=o.rangoAutorizadoHasta||o.rango_hasta||"",w=o.identificador||o.identificadorCAI||"";try{let k=o.caiInfo||null;if(!k&&typeof window<"u"){const re=window.localStorage.getItem("caiInfo");if(re)try{k=JSON.parse(re)}catch{k=null}}if(k&&(b=b||k.cai||k.CAI||"",x=x||k.fecha_vencimiento||k.fecha_limite_emision||"",_=_||k.rango_de||k.rangoDesde||"",v=v||k.rango_hasta||k.rangoHasta||"",w=w||k.identificador||"",!m))try{const re=k.identificador?String(k.identificador):"",be=k.secuencia_actual!=null?String(k.secuencia_actual):k.rango_de!=null?String(k.rango_de):"",Ee=String(be).replace(/[^0-9]/g,"")||"";let we=0;(k.rango_hasta||k.rango_de)&&(we=Math.max(String(k.rango_hasta||k.rango_de).length,Ee.length));const Re=Ee?String(Ee).padStart(we||Ee.length||1,"0"):"";m=(re||"")+(Re||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const N=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),R=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||r.identidad||"C/F",A=new Date().toLocaleString(),$=Array.isArray(r.carrito)?r.carrito:[],M=typeof r.subtotal=="number"?r.subtotal:$.reduce((k,re)=>k+Number(re.producto&&re.producto.precio||re.precio||0)*(re.cantidad||1),0),G=typeof r.descuento=="number"?r.descuento:0,E=typeof r.exonerado=="number"?r.exonerado:0,D=typeof r.gravado=="number"?r.gravado:M,L=typeof r.exento=="number"?r.exento:0,I=typeof r.isvTotal=="number"?r.isvTotal:0,ce=typeof r.imp18Total=="number"?r.imp18Total:0,ve=typeof r.impTouristTotal=="number"?r.impTouristTotal:0,Z=typeof r.total=="number"?r.total:null,de=M+(I||0)+(ce||0)+(ve||0),H=Z??de,ee=H,Y=r.pagos||{},C=typeof Y.efectivo=="number"?Y.efectivo:typeof r.Efectivo=="number"?r.Efectivo:0,z=typeof Y.tarjeta=="number"?Y.tarjeta:typeof r.Tarjeta=="number"?r.Tarjeta:0,X=typeof Y.transferencia=="number"?Y.transferencia:typeof r.Transferencia=="number"?r.Transferencia:0,me=typeof Y.totalPaid=="number"?Y.totalPaid:C+z+X;let K;if(typeof Y.cambio=="number")K=Y.cambio;else if(typeof r.cambio=="number")K=r.cambio;else{const k=Number(me)-Number(ee||0);K=isNaN(k)?0:k>0?k:0}const B=$.map(k=>{const re=String(k.producto&&(k.producto.nombre||k.producto.descripcion)||k.descripcion||k.nombre||""),be=Number(k.cantidad||0),Ee=Number((k.producto&&(k.producto.precio??k.producto.precio_unitario))??k.precio_unitario??k.precio??0),we=!!(k.producto&&k.producto.exento)||!!k.exento,Re=!!(k.producto&&k.producto.aplica_impuesto_18)||!!k.aplica_impuesto_18,ze=!!(k.producto&&k.producto.aplica_impuesto_turistico)||!!k.aplica_impuesto_turistico,Fe=Re?r.tax18Rate??r.tax18??0:r.taxRate??r.tax??0,xt=ze?r.taxTouristRate??r.taxTourist??0:0,At=(Number(Fe)||0)+(Number(xt)||0);let pt=Ee;!we&&At>0&&(pt=Ee/(1+At));const qt=Number(pt||0).toFixed(2),Bt=pt*be,it=Number(Bt||0).toFixed(2);return`<tr><td>${k.producto&&k.producto.sku||k.sku||""} ${re}</td><td style="text-align:center">${be}</td><td style="text-align:right">L ${qt}</td><td style="text-align:right">L ${it}</td></tr>`}).join(`
`),O=(Number(C)||0)+(Number(X)||0)+(Number(z)||0)-(Number(K)||0),P=isNaN(O)?0:O,ie=mx(P);return`<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Factura Cinta</title>

<style>
    body {
        font-family: monospace;
        font-size: 12px;
        width: 260px; /* tamao para impresora trmica 58mm */
        margin: 0 auto;
        padding: 0;
    }

    .center { text-align: center; }
    .line { border-top: 1px dashed #000; margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 2px 0; }
    th { border-bottom: 1px solid #000; }
    .right { text-align: right; }
    .left { text-align: left; }
    .bold { font-weight: bold; }
</style>
</head>

<body>

<div class="center">
    <img src="${p}" alt="logo" style="width:120px; height:auto;" />
</div>

<div class="center bold">FACTURA</div>
<div class="center">No. ${m}</div>

<div class="line"></div>

<div class="center bold">${l}</div>
<p>RTN: ${u}</p>
<p>Direccin: ${d}</p>
<p>Tel: ${h}</p>
<p>Email: ${g}</p>

<div class="line"></div>

<p>Fecha/Hora: ${A}</p>
<p>CAI: ${b}</p>
<p>F. Lmite: ${x}</p>
<p>Rango:  
${w?w+" "+_+" al "+w+" "+v:_+" al "+v}</p>

<div class="line"></div>

<p>Cliente: ${N}</p>
<p>RTN Cliente: ${R}</p>

<div class="line"></div>

<table>
    <thead>
        <tr>
            <th class="left">Descripcin</th>
            <th class="right">Cant</th>
            <th class="right">P.U</th>
            <th class="right">Total</th>
        </tr>
    </thead>
    <tbody>
        ${B}
    </tbody>
</table>

<div class="line"></div>

<p>Descuento: <span class="right">L ${G.toFixed(2)}</span></p>
<p>SubT Exonerado: <span class="right">L ${Number(E).toFixed(2)}</span></p>
<p>SubT Gravado: <span class="right">L ${Number(D).toFixed(2)}</span></p>
<p>SubT Exento: <span class="right">L ${Number(L).toFixed(2)}</span></p>
<p>Tasa Turstica 4%: <span class="right">L ${Number(ve).toFixed(2)}</span></p>
<p>ISV 15%: <span class="right">L ${Number(I).toFixed(2)}</span></p>
<p>ISV 18%: <span class="right">L ${Number(ce).toFixed(2)}</span></p>

<div class="line"></div>

<p class="bold">TOTAL TRANSACCIN:
   <span class="right bold">L ${Number(H).toFixed(2)}</span>
</p>

<div class="line"></div>

<p class="bold">TOTAL FACTURA :
   <span class="right bold">L ${ee.toFixed(2)}</span>
</p>

<p>Efectivo: <span class="right">L ${Number(C).toFixed(2)}</span></p>
<p>Tarjeta: <span class="right">L ${Number(z).toFixed(2)}</span></p>
<p>Transferencia: <span class="right">L ${Number(X).toFixed(2)}</span></p>
<p>Cambio: <span class="right">L ${Number(K).toFixed(2)}</span></p>

<div class="line"></div>

<div class="center">
    <p>Total Pagado: L ${P.toFixed(2)}</p>
    <p>*** ${ie} Lempiras ***</p>
</div>

<div class="line"></div>

<p>Firma Cliente: ____________________</p>
<p>Firma Emisor: _____________________</p>

<div class="center">
    <p>Original: Cliente</p>
    <p>Copia: Obligado tributario emisor</p>
</div>

<div class="center">
    <p>Para cualquier reclamo debe<br/>presentar su factura</p>
    <p>Gracias por su compra!</p>
    <p>LA FACTURA ES BENEFICIO DE TODOS,<br/>EXJALA!</p>
</div>

</body>
</html>
`}function mx(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],r=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(b){if(b===0)return"";if(b<21)return a[b];if(b<100){const x=Math.floor(b/10),_=b%10;return r[x]+(_?" y "+a[_]:"")}if(b<1e3){const x=Math.floor(b/100),_=b%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const b=g%1e3;if(b){let x=u(b);m===2&&b===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}function yx({onLogout:o}){j.useEffect(()=>{const V=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=V||""}},[]);const[a,r]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(""),[g,p]=j.useState("Todas"),[m,b]=j.useState(.15),[x,_]=j.useState(0),[v,w]=j.useState(0),[N,R]=j.useState(26.27),A=["Todas",...Array.from(new Set(a.map(V=>V.categoria)))],$=a.filter(V=>(String(V.nombre||"").toLowerCase().includes(d.toLowerCase())||String(V.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||V.categoria===g)),M=l.reduce((V,fe)=>V+Number(fe.producto.precio||0)*fe.cantidad,0);let G=0,E=0,D=0;for(const V of l){const fe=Number(V.producto.precio||0)*V.cantidad,xe=!!V.producto.exento,ae=!!V.producto.aplica_impuesto_18,pe=!!V.producto.aplica_impuesto_turistico;if(xe)continue;const je=ae?x||0:m||0,_e=pe&&v||0,se=(Number(je)||0)+(Number(_e)||0);if(se<=0)continue;const ye=fe-fe/(1+se);ae?E+=ye*(je/se):G+=ye*(je/se),pe&&(D+=ye*(_e/se))}const L=async(V,fe,xe)=>{try{yr.current=!0,await Cs(V,fe,null,xe||ie)}catch(ae){console.warn("Error printing cotizacion direct:",ae)}finally{yr.current=!1}},I=M,ce=Math.max(0,M-(G+E+D)),ve=l.map(V=>{const fe=Number(V.producto.precio||0)*V.cantidad,xe=!!V.producto.exento,ae=!!V.producto.aplica_impuesto_18,pe=!!V.producto.aplica_impuesto_turistico;if(xe)return{id:V.producto.id,nombre:V.producto.nombre,price:fe,isv:0,imp18:0,tur:0,totalTax:0};const je=ae?x||0:m||0,_e=pe&&v||0,se=(Number(je)||0)+(Number(_e)||0);if(se<=0)return{id:V.producto.id,nombre:V.producto.nombre,price:fe,isv:0,imp18:0,tur:0,totalTax:0};const ye=fe-fe/(1+se),ue=ae?0:ye*(je/se),Se=ae?ye*(je/se):0,Ue=pe?ye*(_e/se):0;return{id:V.producto.id,nombre:V.producto.nombre,price:fe,isv:ue,imp18:Se,tur:Ue,totalTax:ue+Se+Ue}}),Z=V=>{const fe=Number(V.stock??0),xe=Number(V.precio??0);fe<1||xe<=0||u(ae=>ae.find(je=>je.producto.id===V.id)?ae.map(je=>je.producto.id===V.id?{...je,cantidad:je.cantidad+1}:je):[...ae,{producto:V,cantidad:1}])},de=(V,fe)=>{u(xe=>xe.map(ae=>{if(String(ae.producto.id)===String(V)){const pe=ae.cantidad+fe;return pe>0?{...ae,cantidad:pe}:ae}return ae}).filter(ae=>ae.cantidad>0))},H=V=>{u(fe=>fe.filter(xe=>String(xe.producto.id)!==String(V)))},ee=()=>u([]),[Y,C]=j.useState(!1),[z,X]=j.useState("factura"),[me,K]=j.useState(!1),[T,B]=j.useState(null),[O,P]=j.useState(null),[ie,oe]=j.useState(null),[k,re]=j.useState(!1),[be,Ee]=j.useState(!1),[we,Re]=j.useState(""),[ze,Fe]=j.useState(""),xt=j.useRef(null),At=j.useRef(null),[pt,qt]=j.useState("final"),[Bt,it]=j.useState(""),[nt,Dn]=j.useState(""),[pa,Lt]=j.useState(!1),[no,Fa]=j.useState(!1),[_s,Ka]=j.useState(!1),yr=j.useRef(!1),[js,wi]=j.useState(!1),[ao,Kn]=j.useState(!1),[Gt,gn]=j.useState(null),[Jt,Ss]=j.useState(!1),[Ei,ws]=j.useState("carta"),[Ci,Ya]=j.useState(!1),Ti=async V=>{if(Fe(V),!V||String(V).trim()===""){Re("");return}try{if(pt==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",V);const{data:pe,error:je}=await te.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",V).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:pe,error:je}),!je&&pe&&pe.nombre){Re(pe.nombre||""),it(pe.telefono||""),Dn(pe.correo_electronico||""),Lt(!!pe.exonerado),setTimeout(()=>{try{At.current?.focus()}catch{}},50);return}else{Re(""),it(""),Dn(""),Lt(!1);return}}const fe="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",V);const{data:xe,error:ae}=await te.from(fe).select("nombre").eq("rtn",V).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:xe,error:ae}),!ae&&xe&&xe.nombre?(Re(xe.nombre||""),setTimeout(()=>{try{At.current?.focus()}catch{}},50)):Re("")}catch(fe){console.warn("Error buscando cliente por RTN:",fe)}},Yn=V=>{if(V==="cotizacion"){X("cotizacion"),Ka(!0);return}X(V),C(!0)},Ja=async(V={})=>{try{if(!l||l.length===0)return null;const fe=Cn(),xe=G,ae=E,pe=D,je=Number(xe||0)+Number(ae||0)+Number(pe||0),_e=fe+je;let se=V.cliente_id??null;if(!se&&V.rtn)try{const{data:Ie,error:Ze}=await te.from("clientes").select("id").eq("rtn",V.rtn).maybeSingle();!Ze&&Ie&&Ie.id&&(se=Ie.id)}catch{}const ye=ma||"system",ue=String(Math.floor(Math.random()*9e5)+1e5),Se={cliente_id:se,usuario:ye,numero_cotizacion:ue,validez_dias:30,subtotal:fe,impuesto:je,total:_e,estado:"pendiente"};let Ue=V.cotizacion_id??O,Ae=null;if(Ue){const Ie={cliente_id:Se.cliente_id||null,usuario:Se.usuario,validez_dias:Se.validez_dias,subtotal:Se.subtotal,impuesto:Se.impuesto,total:Se.total,estado:Se.estado},{error:Ze}=await te.from("cotizaciones").update(Ie).eq("id",Ue);if(Ze)return console.warn("Error actualizando cotizacion:",Ze),null;try{const{data:yt,error:_t}=await te.from("cotizaciones").select("*").eq("id",Ue).maybeSingle();if(!_t&&yt){Ae=yt.numero_cotizacion||yt.Nmero||null;try{oe(Ae)}catch{}}}catch{}}else{const{data:Ie,error:Ze}=await te.from("cotizaciones").insert([Se]).select("*").maybeSingle();if(Ze)return console.warn("Error insertando cotizacion:",Ze),null;Ue=Ie?.id||null;try{if(Ue){const{data:yt,error:_t}=await te.from("cotizaciones").select("*").eq("id",Ue).maybeSingle();!_t&&yt?Ae=yt.numero_cotizacion||yt.Nmero||ue:Ae=Ie?.numero_cotizacion||Ie?.Nmero||ue}else Ae=Ie?.numero_cotizacion||Ie?.Nmero||ue}catch{Ae=Ie?.numero_cotizacion||Ie?.Nmero||ue}try{oe(Ae)}catch{}if(!Ue)return null}const ft=l.map(Ie=>{const Ze=Number(Ie.producto.precio||0),yt=Number(Ie.cantidad||0),_t=!!Ie.producto.exento,qn=!!Ie.producto.aplica_impuesto_18,Sr=!!Ie.producto.aplica_impuesto_turistico,In=_t||qn?0:Ze*(m||0)*yt,Wa=_t?0:qn?Ze*(x||0)*yt:0,Hn=_t?0:Sr?Ze*(v||0)*yt:0,Ce=Ze*yt,qe=Ce+In+Wa+Hn;return{cotizacion_id:Ue,producto_id:Ie.producto.id||null,descripcion:Ie.producto.nombre||"",cantidad:yt,precio_unitario:Ze,subtotal:Ce,descuento:0,total:qe}});try{await te.from("cotizaciones_detalle").delete().eq("cotizacion_id",Ue)}catch{}const{error:mt}=await te.from("cotizaciones_detalle").insert(ft);mt?console.warn("Error insertando cotizaciones_detalle:",mt):console.debug("Cotizacion guardada id=",Ue);try{ee()}catch(Ie){console.debug("Error vaciando carrito tras guardar cotizacion:",Ie)}try{await Xa()}catch(Ie){console.debug("Error refrescando productos tras guardar cotizacion:",Ie)}return{id:Ue,numero:Ae}}catch(fe){return console.warn("Error guardando cotizacion:",fe),null}},Cn=()=>{const V=l.reduce((pe,je)=>pe+Number(je.producto.precio||0)*je.cantidad,0);let fe=0,xe=0,ae=0;for(const pe of l){const je=Number(pe.producto.precio||0)*pe.cantidad,_e=!!pe.producto.exento,se=!!pe.producto.aplica_impuesto_18,ye=!!pe.producto.aplica_impuesto_turistico;if(_e)continue;const ue=se?x||0:m||0,Se=ye&&v||0,Ue=(Number(ue)||0)+(Number(Se)||0);if(Ue<=0)continue;const Ae=je-je/(1+Ue);se?xe+=Ae*(ue/Ue):fe+=Ae*(ue/Ue),ye&&(ae+=Ae*(Se/Ue))}return Math.max(0,V-(fe+xe+ae))},io=()=>l.reduce((V,fe)=>V+(fe.producto.exento?0:Number(fe.producto.precio||0)*fe.cantidad),0),Es=async()=>{qt("final"),Re("Consumidor Final"),Fe("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),Ss(!0),wi(!0),C(!1)},br=()=>{qt("normal"),Re(""),Fe(""),Kn(!1),gn(null),re(!0),C(!1)},Qa=()=>{qt("juridico"),Re(""),Fe(""),Kn(!1),gn(null),re(!0),C(!1)},Cs=async(V,fe,xe,ae)=>{let pe=Ei==="cinta"?dp:up;const je={cliente:V,rtn:fe};if(z==="cotizacion"){pe=cm;const se=ae||ie||null;se&&(je.cotizacion=se),je.cotizacion==null&&ie&&(je.Nmero=ie)}const _e=await pe(je,z,{carrito:l,subtotal:Cn(),isvTotal:G,imp18Total:E,impTouristTotal:D,taxRate:m,tax18Rate:x,taxTouristRate:v,total:I,pagos:xe});if(z==="factura"&&O)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",O);const{error:se}=await te.from("cotizaciones").update({estado:"aceptada"}).eq("id",O);if(se)console.warn("Error marcando cotizacion (pre-print):",se);else try{P(null)}catch{}}catch(se){console.warn("Error marcacion pre-print:",se)}if(z==="factura")try{let se=null,ye=null;try{const ue=localStorage.getItem("user"),Se=ue?JSON.parse(ue):null;ye=Se&&(Se.id||Se.user?.id||Se.sub||Se.user_id)?Se.id||Se.user?.id||Se.sub||Se.user_id:null;const Ue=Se&&(Se.username||Se.user?.username||Se.name||Se.user?.name)?Se.username||Se.user?.username||Se.name||Se.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",ue),console.debug("PV: CAI lookup - parsed user object:",Se),console.debug("PV: CAI lookup - extracted userId:",ye,"typeof",typeof ye),console.debug("PV: CAI lookup - extracted userNameFromStorage:",Ue),ye){const Ae=typeof ye=="string"&&/^\d+$/.test(ye)?Number(ye):ye;try{const{data:ft,error:mt}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Ae).order("id",{ascending:!1}).limit(1);!mt&&Array.isArray(ft)&&ft.length>0&&(se=ft[0])}catch(ft){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",ft)}}if(!se&&Ue)try{const{data:Ae,error:ft}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",Ue).order("id",{ascending:!1}).limit(1);!ft&&Array.isArray(Ae)&&Ae.length>0&&(se=Ae[0])}catch(Ae){console.debug("PV: CAI lookup by cajero failed:",Ae)}}catch(ue){console.debug("No se pudo cargar CAI desde frontend:",ue)}await vr({clienteName:V,rtn:fe,paymentPayload:xe,caiData:se,usuarioId:ye})}catch(se){console.warn("Error preparando venta antes de imprimir:",se),alert("Error preparando venta antes de imprimir: "+String(se))}try{const se=document.createElement("iframe");se.style.position="fixed",se.style.right="0",se.style.bottom="0",se.style.width="0",se.style.height="0",se.style.border="0",se.style.overflow="hidden",se.setAttribute("aria-hidden","true"),document.body.appendChild(se);const ye=se.contentWindow,ue=se.contentDocument||se.contentWindow?.document;if(!ue||!ye)try{document.body.removeChild(se)}catch{}else{ue.open(),ue.write(_e),ue.close();const Se=()=>{try{ye.focus(),ye.print()}catch(Ae){console.warn("Error during iframe print (finalize):",Ae)}setTimeout(()=>{try{document.body.removeChild(se)}catch{}},800)},Ue=()=>{try{const Ae=ue.images;if(Ae&&Ae.length>0){let ft=0;for(let mt=0;mt<Ae.length;mt++){const Ie=Ae[mt];Ie.complete?ft++:(Ie.addEventListener("load",()=>{ft++,ft===Ae.length&&Se()}),Ie.addEventListener("error",()=>{ft++,ft===Ae.length&&Se()}))}ft===Ae.length&&Se()}else Se()}catch{try{ye.addEventListener("load",Se)}catch{}setTimeout(Se,1e3)}};try{ue.readyState==="complete"?Ue():(ye.addEventListener("load",Ue),setTimeout(Ue,1500))}catch{setTimeout(Ue,800)}}}catch(se){console.warn("Direct print failed, falling back to opening new window",se);const ye=window.open("","_blank");ye&&(ye.document.open(),ye.document.write(_e),ye.document.close(),setTimeout(()=>{try{ye.print(),ye.close()}catch{}},800))}z==="factura"&&(ee(),await xr()),z==="cotizacion"&&(B({cliente:V,rtn:fe}),yr.current?(K(!1),B(null)):K(!0))},vr=async({clienteName:V,rtn:fe,paymentPayload:xe,caiData:ae,usuarioId:pe})=>{if(!l||l.length===0)return null;const je=xe&&xe.tipoPagoString?String(xe.tipoPagoString):"",_e=xe&&xe.totalPaid?Number(xe.totalPaid||0):0,se=_e>Number(I||0)?_e-Number(I||0):0;let ye=String(Math.floor(Math.random()*9e5)+1e5);const ue=Mn||ae||null;let Se=null,Ue=0,Ae=null,ft=null;if(ue&&(ue.rango_de!==void 0||ue.secuencia_actual!==void 0))try{const Ce=ue.rango_de!=null?String(ue.rango_de):"",qe=ue.rango_hasta!=null?String(ue.rango_hasta):"",We=ue.secuencia_actual!=null?String(ue.secuencia_actual):"",ke=Number(String(Ce).replace(/[^0-9]/g,""))||0,Pe=Number(String(qe).replace(/[^0-9]/g,""))||0,Ge=Number(String(We).replace(/[^0-9]/g,""))||ke||0;Ue=Math.max((qe||Ce||"").length,String(Ge).length,1),ft=String(Ge).padStart(Ue,"0"),ye=(ue.identificador?String(ue.identificador):"")+ft;const Xn=Ge+1;Se=Xn,Ae=String(Xn).padStart(Ue,"0")}catch(Ce){console.debug("Error computing factura from caiInfoState, falling back to random:",Ce)}const mt={rtn:fe||null,nombre_cliente:V||null,usuario:ma||"system",factura:ye,tipo_pago:je,subtotal:Number(ce||0),impuesto:Number(G+E+D||0),total:Number(I||0),estado:"pagada",cambio:String(Number(se).toFixed(2)),cai:ue?.cai??null,rango_desde:(ue&&ue.identificador?String(ue.identificador):"")+(ue?.rango_de!=null?String(ue.rango_de):"")||null,rango_hasta:(ue&&ue.identificador?String(ue.identificador):"")+(ue?.rango_hasta!=null?String(ue.rango_hasta):"")||null,fecha_limite_emision:ue?.fecha_vencimiento??ue?.fecha_limite_emision??null};let Ie=null,Ze=null;try{const Ce=await te.from("ventas").insert([mt]).select("id, factura");Ie=Ce.data??Ce,Ze=Ce.error??null}catch(Ce){Ze=Ce}if(console.debug("Insert venta response:",{ventaInsRaw:Ie,ventaErr:Ze}),Ze){const Ce=String(Ze&&(Ze.message||Ze.msg||Ze.details)||""),qe=Ze&&Ze.code?String(Ze.code):"";if(qe==="PGRST204"||Ce.includes("Could not find the")||/column .* of 'ventas'/.test(Ce)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:Ce,code:qe});const ke={...mt};delete ke.cai,delete ke.rango_desde,delete ke.rango_hasta,delete ke.fecha_limite_emision;try{const Pe=await te.from("ventas").insert([ke]).select("id, factura");if(Ie=Pe.data??Pe,Ze=Pe.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:Ie,ventaErr:Ze}),Ze)throw Ze}catch(Pe){throw console.error("Fallback insert also failed:",Pe),Pe}}else throw Ze}const yt=Array.isArray(Ie)?Ie[0]:Ie;let _t=yt?yt.id||yt.id:null;if(!_t)try{const{data:Ce,error:qe}=await te.from("ventas").select("id").eq("factura",ye).maybeSingle();qe&&console.debug("Error buscando venta por factura (fallback):",qe),Ce&&Ce.id&&(_t=Ce.id)}catch(Ce){console.debug("fallback lookup error",Ce)}if(!_t)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",Ie),null;const qn=l.map(Ce=>{const qe=Number(Ce.producto.precio||0),We=Number(Ce.cantidad||0),ke=qe*We,Pe=0,Ge=ke-Pe;return{venta_id:_t,factura:ye,producto_id:Ce.producto.id,cantidad:We,precio_unitario:qe,subtotal:ke,descuento:Pe,total:Ge}});if(ae&&pe&&(Ce=>typeof Ce=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Ce))(pe))try{const Ce=l.map(ke=>({producto_id:String(ke.producto.id),cantidad:Number(ke.cantidad||0),precio_unitario:Number(ke.producto.precio||0),subtotal:Number((Number(ke.producto.precio||0)*ke.cantidad).toFixed(6)),descuento:0,total:Number((Number(ke.producto.precio||0)*ke.cantidad).toFixed(6))})),{data:qe,error:We}=await te.rpc("create_venta_with_detalle",{p_usuario_id:pe,p_usuario:ma||pe,p_rtn:fe||null,p_nombre_cliente:V||null,p_tipo_pago:je,p_subtotal:Number(ce||0),p_impuesto:Number(G+E+D||0),p_total:Number(I||0),p_cambio:String(Number(se).toFixed(2)),p_detalles:Ce});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:qe,rpcErr:We}),We)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",We);else if(qe&&Array.isArray(qe)&&qe.length>0){const ke=qe[0];try{if(ue&&ue.id!=null)try{const{data:Pe,error:Ge}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",ue.id).maybeSingle();if(!Ge&&Pe){an(Pe);try{localStorage.setItem("caiInfo",JSON.stringify(Pe))}catch{}}}catch(Pe){console.debug("Error refreshing cai after RPC:",Pe)}}catch(Pe){console.debug("Error during post-RPC cai refresh:",Pe)}return ke.venta_id||ke.venta_id===0?ke.venta_id:_t}else if(qe&&qe.venta_id){try{if(ue&&ue.id!=null)try{const{data:ke,error:Pe}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",ue.id).maybeSingle();if(!Pe&&ke){an(ke);try{localStorage.setItem("caiInfo",JSON.stringify(ke))}catch{}}}catch(ke){console.debug("Error refreshing cai after RPC (scalar):",ke)}}catch(ke){console.debug("Error during post-RPC cai refresh (scalar):",ke)}return qe.venta_id}}catch(Ce){console.warn("Error calling RPC create_venta_with_detalle:",Ce)}else ae&&pe&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",pe);const{data:In,error:Wa}=await te.from("ventas_detalle").insert(qn).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:In,detErr:Wa}),Wa)throw Wa;try{const Ce=`venta: ${ye}`;let qe=ma||"sistema";try{const Pe=localStorage.getItem("user");if(Pe){const Ge=JSON.parse(Pe);qe=Ge&&(Ge.username||Ge.user?.username||Ge.name||Ge.user?.name)?Ge.username||Ge.user?.username||Ge.name||Ge.user?.name:String(Ge)}}catch{}const We=new Date().toISOString(),ke=qn.map(Pe=>({producto_id:Pe.producto_id,cantidad:Pe.cantidad,tipo_de_movimiento:"SALIDA",referencia:Ce,usuario:qe,fecha_salida:We}));if(ke.length>0){const{data:Pe,error:Ge}=await te.from("registro_de_inventario").insert(ke).select("id");Ge?console.warn("Error registrando salida en registro_de_inventario:",Ge):console.debug("Registro_de_inventario inserciones (salida):",Pe)}}catch(Ce){console.warn("Excepcin registrando salidas en registro_de_inventario:",Ce)}try{const Ce={};for(const qe of qn){const We=String(qe.producto_id),ke=Number(qe.cantidad||0);Ce[We]||(Ce[We]=0),Ce[We]+=ke}for(const qe of Object.keys(Ce))try{const We=Number(Ce[qe]||0);if(We<=0)continue;const{data:ke,error:Pe}=await te.from("inventario").select("stock").eq("id",qe).maybeSingle();if(Pe){console.warn("Error leyendo stock de inventario para producto",qe,Pe);continue}const Ge=ke&&ke.stock!=null?Number(ke.stock):0,Qn=Math.max(0,Ge-We),{error:Xn}=await te.from("inventario").update({stock:Qn}).eq("id",qe);Xn?console.warn("Error actualizando stock para producto",qe,Xn):console.debug("Stock actualizado para producto",qe,"de",Ge,"a",Qn)}catch(We){console.warn("Excepcin actualizando stock para producto",qe,We)}}catch(Ce){console.warn("Excepcin agregada en proceso de actualizacin de stock:",Ce)}try{if(xe&&Array.isArray(xe.pagos)&&xe.pagos.length>0){const Ce=xe.pagos.map(ke=>({venta_id:_t,tipo:ke.tipo,monto:Number(ke.monto||0),banco:ke.banco||null,tarjeta:ke.tarjeta||null,factura:ye||ke.factura||null,autorizador:ke.autorizador||null,referencia:ke.referencia||null,meta:ke.meta||null,created_by:typeof pe=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(pe)?pe:null})),{data:qe,error:We}=await te.from("pagos").insert(Ce).select("id");We?console.warn("Error insertando pagos en tabla pagos:",We):console.debug("Pagos insertados:",qe)}}catch(Ce){console.warn("Excepcin insertando pagos:",Ce)}const Hn=ue&&(ue.id||ue.id===0)?ue.id:null;if(Hn!=null&&Se!=null)try{const Ce=Ae??String(Se);try{const qe=ue?.rango_hasta!=null?String(ue.rango_hasta):"",We=Number(qe.replace(/[^0-9]/g,""))||null,ke=Number(String(Ce).replace(/[^0-9]/g,""))||null;if(We!=null&&ke!=null&&ke>We)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:ke,rangoHastaNum:We});else{const{error:Pe}=await te.from("cai").update({secuencia_actual:Ce}).eq("id",Hn);if(Pe)console.debug("Error updating cai.secuencia_actual (manual path):",Pe);else{console.debug("Updated cai.secuencia_actual to",Ce,"for cai id",Hn);try{const Ge={...ue||{},secuencia_actual:Ce};an(Ge);try{localStorage.setItem("caiInfo",JSON.stringify(Ge))}catch{}}catch(Ge){console.debug("Error updating local caiInfoState/localStorage:",Ge)}}}}catch(qe){console.debug("Validation error while checking rango_hasta:",qe);const{error:We}=await te.from("cai").update({secuencia_actual:Ce}).eq("id",Hn);if(We)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",We);else{console.debug("Updated cai.secuencia_actual to",Ce,"for cai id",Hn);try{const ke={...ue||{},secuencia_actual:Ce};an(ke);try{localStorage.setItem("caiInfo",JSON.stringify(ke))}catch{}}catch(ke){console.debug("Error updating local caiInfoState/localStorage (after validation):",ke)}}}}catch(Ce){console.debug("Exception updating cai.secuencia_actual:",Ce)}try{await Xa()}catch(Ce){console.debug("refreshProducts after insertVenta failed",Ce)}return _t},xr=async()=>{if(z==="factura"&&O)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",O);const{error:V}=await te.from("cotizaciones").update({estado:"aceptada"}).eq("id",O);V?console.warn("Error marcando cotizacion como facturado:",V):console.debug("Cotizacion marcada como facturado:",O)}catch(V){console.warn("Error procesando cotizacion tras facturar",V)}};j.useEffect(()=>{k&&setTimeout(()=>{try{xt.current?.focus()}catch{}},80)},[k]);const Ts=async()=>{try{if(ze&&we){const ae={rtn:ze,nombre:we},{error:pe}=await te.from("clientenatural").upsert(ae,{onConflict:"rtn"});pe&&console.warn("Error guardando clientenatural:",pe)}}catch(ae){console.warn("Error upsert clientenatural:",ae)}try{if(ze&&we)if(pt==="juridico"){const{data:ae,error:pe}=await te.from("clientes").select("id").eq("rtn",ze).eq("tipo_cliente","juridico").maybeSingle();if(pe&&console.warn("Error buscando cliente juridico:",pe),ae&&ae.id){const{error:je}=await te.from("clientes").update({nombre:we,telefono:Bt||null,correo_electronico:nt||null,exonerado:pa}).eq("id",ae.id);je&&console.warn("Error actualizando cliente juridico:",je)}else{const{error:je}=await te.from("clientes").insert([{nombre:we,rtn:ze,telefono:Bt||null,correo_electronico:nt||null,tipo_cliente:"juridico",exonerado:pa}]);je&&console.warn("Error insertando cliente juridico:",je)}}else{const ae={rtn:ze,nombre:we},{error:pe}=await te.from("clientenatural").upsert(ae,{onConflict:"rtn"});pe&&console.warn("Error guardando clientenatural:",pe)}}catch(ae){console.warn("Error upsert cliente:",ae)}const fe=await(Ei==="cinta"?dp:up)({cliente:we||"Cliente",rtn:ze||""},z,{carrito:l,subtotal:Cn(),isvTotal:G,imp18Total:E,impTouristTotal:D,taxRate:m,tax18Rate:x,taxTouristRate:v,total:I,pagos:Gt});if(z==="factura"&&O)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",O);const{error:ae}=await te.from("cotizaciones").update({estado:"aceptada"}).eq("id",O);if(ae)console.warn("Error marcando cotizacion como facturado (pre-print):",ae);else{console.debug("Cotizacion marcada como facturado (pre-print):",O);try{P(null)}catch{}}}catch(ae){console.warn("Error marcacion pre-print:",ae)}if(z==="factura")try{let ae=null,pe=null;try{const je=localStorage.getItem("user"),_e=je?JSON.parse(je):null;pe=_e&&(_e.id||_e.user?.id||_e.sub||_e.user_id)?_e.id||_e.user?.id||_e.sub||_e.user_id:null;const se=_e&&(_e.username||_e.user?.username||_e.name||_e.user?.name)?_e.username||_e.user?.username||_e.name||_e.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",je),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",_e),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",pe,"typeof",typeof pe),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",se),pe){const ye=typeof pe=="string"&&/^\d+$/.test(pe)?Number(pe):pe;try{const{data:ue,error:Se}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",ye).order("id",{ascending:!1}).limit(1);!Se&&Array.isArray(ue)&&ue.length>0&&(ae=ue[0])}catch(ue){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",ue)}}if(!ae&&se)try{const{data:ye,error:ue}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",se).order("id",{ascending:!1}).limit(1);!ue&&Array.isArray(ye)&&ye.length>0&&(ae=ye[0])}catch(ye){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",ye)}}catch(je){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",je)}await vr({clienteName:we||"Cliente",rtn:ze||null,paymentPayload:Gt,caiData:ae,usuarioId:pe})}catch(ae){console.warn("Error insertando venta en flujo cliente normal:",ae)}try{const ae=document.createElement("iframe");ae.style.position="fixed",ae.style.right="0",ae.style.bottom="0",ae.style.width="0",ae.style.height="0",ae.style.border="0",ae.style.overflow="hidden",ae.setAttribute("aria-hidden","true"),document.body.appendChild(ae);const pe=ae.contentWindow,je=ae.contentDocument||ae.contentWindow?.document;if(!je||!pe)try{document.body.removeChild(ae)}catch{}else{je.open(),je.write(fe),je.close();const _e=()=>{try{pe.focus(),pe.print()}catch(ye){console.warn("Error during iframe print (cliente normal):",ye)}setTimeout(()=>{try{document.body.removeChild(ae)}catch{}},800)},se=()=>{try{const ye=je.images;if(ye&&ye.length>0){let ue=0;for(let Se=0;Se<ye.length;Se++){const Ue=ye[Se];Ue.complete?ue++:(Ue.addEventListener("load",()=>{ue++,ue===ye.length&&_e()}),Ue.addEventListener("error",()=>{ue++,ue===ye.length&&_e()}))}ue===ye.length&&_e()}else _e()}catch{try{pe.addEventListener("load",_e)}catch{}setTimeout(_e,1e3)}};try{je.readyState==="complete"?se():(pe.addEventListener("load",se),setTimeout(se,1500))}catch{setTimeout(se,800)}}}catch(ae){console.warn("Direct print (cliente normal) failed, falling back to new window",ae);const pe=window.open("","_blank");pe&&(pe.document.open(),pe.document.write(fe),pe.document.close(),setTimeout(()=>{try{pe.print(),pe.close()}catch{}},800))}await(async()=>{z==="factura"&&(ee(),await xr()),z==="cotizacion"&&(B({cliente:we||"Cliente",rtn:ze||null}),K(!0))})(),re(!1)},[Tn,An]=j.useState(null),[_r,As]=j.useState([]),[Bn,wt]=j.useState(!1),[Ft,Ln]=j.useState(null);j.useEffect(()=>{fetch("/data-base/inventario.json").then(async V=>{if(!V.ok)return console.warn("inventario.json no disponible, status",V.status),null;const fe=V.headers.get("content-type")||"";if(!fe.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",fe),null;try{return await V.json()}catch(xe){return console.warn("Error parseando inventario.json:",xe),null}}).then(V=>{V&&Array.isArray(V.items)&&As(V.items),console.log("inventario cargado:",V&&V.items?V.items.length:0)}).catch(V=>{console.warn("Error cargando inventario:",V)})},[]);const Xa=async()=>{try{const{data:V,error:fe}=await te.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(fe)throw fe;const xe=Array.isArray(V)?V:[],ae=xe.map(se=>String(se.id));if(ae.length===0){r([]);return}const pe={};try{const{data:se,error:ye}=await te.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(ye)throw ye;if(Array.isArray(se))for(const ue of se){const Se=String(ue.producto_id);pe[Se]||(pe[Se]=Number(ue.precio||0))}}catch(se){console.warn("Error cargando precios en PV:",se)}let je={};try{const{data:se,error:ye}=await te.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",ae);if(ye)throw ye;const ue=Array.isArray(se)?se:[];je={},ae.forEach(Se=>je[Se]=0);for(const Se of ue){const Ue=String(Se.producto_id),Ae=Number(Se.cantidad)||0,ft=String(Se.tipo_de_movimiento||"").toUpperCase();ft==="ENTRADA"?je[Ue]=(je[Ue]||0)+Ae:ft==="SALIDA"&&(je[Ue]=(je[Ue]||0)-Ae)}}catch(se){console.warn("Error cargando registro_de_inventario en PV:",se),je={},ae.forEach(ye=>je[ye]=0)}const _e=xe.map(se=>({id:String(se.id),sku:se.sku,nombre:se.nombre,categoria:se.categoria,imagen:se.imagen,precio:pe[String(se.id)]!==void 0?pe[String(se.id)]:se.precio!==void 0?Number(se.precio):0,exento:se.exento===!0||String(se.exento)==="true"||Number(se.exento)===1||!1,aplica_impuesto_18:se.aplica_impuesto_18===!0||String(se.aplica_impuesto_18)==="true"||Number(se.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:se.aplica_impuesto_turistico===!0||String(se.aplica_impuesto_turistico)==="true"||Number(se.aplica_impuesto_turistico)===1||!1,stock:Number((je[String(se.id)]||0).toFixed(2))}));r(_e)}catch(V){console.warn("Error cargando productos desde inventario:",V),r([])}};j.useEffect(()=>{let V=!0;return Xa().catch(fe=>{V&&console.warn("refreshProducts error",fe)}),()=>{V=!1}},[]),j.useEffect(()=>{const V=xe=>{try{const ae=xe||(()=>{const _e=localStorage.getItem("cotizacion_to_load");return _e?JSON.parse(_e):null})();if(!ae)return;try{P(ae.header&&ae.header.id?String(ae.header.id):null)}catch{}try{const _e=ae.header&&(ae.header.numero_cotizacion||ae.header.Nmero||ae.header.numero)?ae.header.numero_cotizacion||ae.header.Nmero||ae.header.numero:null;_e&&oe(_e)}catch{}const je=(Array.isArray(ae.detalles)?ae.detalles:[]).map(_e=>{const se=a.find(ue=>String(ue.id)===String(_e.producto_id));return{producto:se?{...se}:{id:String(_e.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:_e.sku??void 0,nombre:_e.descripcion||_e.nombre||"Artculo",precio:Number(_e.precio_unitario||_e.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(_e.cantidad||1)}});je.length>0&&u(je);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};V();const fe=xe=>{try{V(xe.detail)}catch{}};return window.addEventListener("cotizacion:load",fe),()=>{window.removeEventListener("cotizacion:load",fe)}},[a]);const[ma,ro]=j.useState(null),[Ns,Za]=j.useState(null),[Ai,ya]=j.useState(null),[Mn,an]=j.useState(null),[ba,Et]=j.useState(!1),[jr,Rs]=j.useState({}),Jn=async()=>{try{let V=null;try{const fe=localStorage.getItem("user"),xe=fe?JSON.parse(fe):null;let ae=Ai??(xe&&(xe.id||xe.user?.id||xe.sub||xe.user_id)?xe.id||xe.user?.id||xe.sub||xe.user_id:null);const pe=ma??(xe&&(xe.username||xe.user?.username||xe.name||xe.user?.name)?xe.username||xe.user?.username||xe.name||xe.user?.name:null),je=ae!=null&&typeof ae=="string"&&/^\d+$/.test(ae)?Number(ae):ae;if(je!=null)try{const{data:_e,error:se}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",je).order("id",{ascending:!1}).limit(1);!se&&Array.isArray(_e)&&_e.length>0&&(V=_e[0])}catch(_e){console.debug("refreshCaiInfo: lookup by usuario_id failed:",_e)}if(!V&&pe)try{const{data:_e,error:se}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",pe).order("id",{ascending:!1}).limit(1);!se&&Array.isArray(_e)&&_e.length>0&&(V=_e[0])}catch(_e){console.debug("refreshCaiInfo: lookup by cajero failed:",_e)}}catch(fe){console.debug("refreshCaiInfo: error building lookup params",fe)}if(V){an(V);try{localStorage.setItem("caiInfo",JSON.stringify(V))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",V)}}catch(V){console.debug("refreshCaiInfo: unexpected error",V)}};j.useEffect(()=>{try{const V=localStorage.getItem("user");if(V){const fe=JSON.parse(V);ro(fe.username||fe.name||null),Za(fe.role||null);let xe=null;try{xe=fe&&(fe.id||fe.user?.id||fe.sub||fe.user_id)?fe.id||fe.user?.id||fe.sub||fe.user_id:null,ya(xe??null),console.debug("PV: localStorage.user parsed:",fe),console.debug("PV: extracted userId for CAI/RPC usage:",xe)}catch(ae){console.debug("PV: error parsing localStorage.user for debug:",ae)}try{const ae=localStorage.getItem("caiInfo");if(ae){const pe=JSON.parse(ae);an(pe),console.debug("PV: loaded caiInfo from localStorage:",pe),(async()=>{try{if(!(pe&&pe.rango_de!==void 0&&pe.rango_hasta!==void 0&&pe.fecha_vencimiento!==void 0&&pe.secuencia_actual!==void 0)){const _e=fe&&(fe.username||fe.user?.username||fe.name||fe.user?.name)?fe.username||fe.user?.username||fe.name||fe.user?.name:null,se=xe&&typeof xe=="string"&&/^\d+$/.test(xe)?Number(xe):xe;let ye=null;try{if(se!=null){const{data:ue,error:Se}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",se).order("id",{ascending:!1}).limit(1);!Se&&Array.isArray(ue)&&ue.length>0&&(ye=ue[0])}}catch(ue){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",ue)}if(!ye&&_e)try{const{data:ue,error:Se}=await te.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",_e).order("id",{ascending:!1}).limit(1);!Se&&Array.isArray(ue)&&ue.length>0&&(ye=ue[0])}catch(ue){console.debug("PV: refetch CAI by cajero failed:",ue)}if(ye){an(ye);try{localStorage.setItem("caiInfo",JSON.stringify(ye))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",ye)}}}catch(je){console.debug("PV: error trying to refresh caiInfo:",je)}})()}}catch(ae){console.debug("PV: error parsing localStorage.caiInfo:",ae)}}}catch{}},[]),j.useEffect(()=>{let V=!0;return(async()=>{try{const{data:fe,error:xe}=await te.from("impuesto").select("id, impuesto_venta");if(xe)throw xe;if(!fe||!Array.isArray(fe))return;const ae=se=>{const ye=fe.find(Ue=>Number(Ue.id)===se);if(!ye)return null;const ue=ye.impuesto_venta;if(ue==null)return null;const Se=Number(ue);return Number.isNaN(Se)?null:Se>1?Se/100:Se},pe=ae(1),je=ae(2),_e=ae(3);if(V){let se=pe,ye=je,ue=_e;try{if((se===null||se===0)&&V){const Ue=(await te.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Ae=Ue==null?null:Number(Ue);Ae!=null&&!Number.isNaN(Ae)&&(se=Ae>1?Ae/100:Ae)}if((ye===null||ye===0)&&V){const Ue=(await te.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Ae=Ue==null?null:Number(Ue);Ae!=null&&!Number.isNaN(Ae)&&(ye=Ae>1?Ae/100:Ae)}if((ue===null||ue===0)&&V){const Ue=(await te.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Ae=Ue==null?null:Number(Ue);Ae!=null&&!Number.isNaN(Ae)&&(ue=Ae>1?Ae/100:Ae)}}catch(Se){console.warn("PV: fallback single-id impuesto fetch failed",Se)}(se===null||se===0)&&(se=.15),(ye===null||ye===0)&&(ye=.18),(ue===null||ue===0)&&(ue=.04),b(se),_(ye),w(ue),console.debug("PV: impuestos raw rows",fe),console.debug("PV: resolved tax rates",{taxRate:se,tax18Rate:ye,taxTouristRate:ue})}}catch(fe){console.warn("Error cargando impuesto en PV:",fe)}})(),()=>{V=!1}},[]);const va=V=>{console.log("openUbicacion",V,"entradasCount",_r.length);let fe=null;try{fe=a.find(ae=>String(ae.sku||"")===String(V)||String(ae.id)===String(V))||null}catch{fe=null}if(fe){const ae=Number(fe.stock??0),pe={id:fe.id,producto:fe.nombre||"",sku:fe.sku||"",imagen:fe.imagen||null,descripcion:fe.descripcion||"",ubicacion:fe.ubicacion||null,cantidad:ae};Ln(pe),wt(!0);return}const xe=_r.find(ae=>ae.sku===V)||null;console.log("entrada encontrada",xe),Ln(xe),wt(!0)};if(j.useEffect(()=>{let V=!0;return(async()=>{try{const fe="inventario",xe={};await Promise.all((a||[]).map(async ae=>{const pe=ae.imagen;if(!pe){xe[String(ae.id)]=null;return}const je=String(pe);if(je.startsWith("http")){xe[String(ae.id)]=je;return}let _e=je;const se=String(je).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);se&&(_e=decodeURIComponent(se[2]));try{const ye=await te.storage.from(fe).getPublicUrl(_e),ue=ye?.data?.publicUrl||ye?.data?.publicURL||null;if(ue){xe[String(ae.id)]=ue;return}}catch{}try{const ue=(await te.storage.from(fe).createSignedUrl(_e,604800))?.data?.signedUrl??null;xe[String(ae.id)]=ue}catch{xe[String(ae.id)]=null}})),V&&Rs(xe)}catch(fe){console.warn("Error resolviendo imgenes en PV",fe)}})(),()=>{V=!1}},[a]),Tn){if(Tn==="DevolucionCaja")return i.jsx(Y0,{onBack:()=>An(null)});if(Tn==="IngresoEfectivo")return i.jsx(J0,{onBack:()=>An(null)});if(Tn==="CotizacionesGuardadas")return i.jsx(X0,{onBack:()=>An(null)});if(Tn==="PedidosEnLinea")return i.jsx(Z0,{onBack:()=>An(null)});if(Tn==="CorteCajaParcial")return i.jsx(W0,{onBack:()=>An(null)});if(Tn==="CorteCajaTotal")return i.jsx(ex,{onBack:()=>An(null)})}return i.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[i.jsx(rx,{userName:ma,userRole:Ns,userId:Ai,caiInfo:Mn,onLogout:o,onNavigate:V=>An(V),onOpenDatosFactura:()=>Et(!0),onPrintFormatChange:V=>ws(V),onOpenCajaConfig:()=>Ya(!0),printFormat:Ei}),i.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[i.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:V=>h(V.target.value),onKeyDown:V=>{if(V.key==="Enter"){const fe=String(d||"").trim().toLowerCase();if(!fe)return;const ae=$.find(pe=>String(pe.sku||"").toLowerCase()===fe)||$[0];if(ae){const pe=Number(ae.stock??0),je=Number(ae.precio??0);pe>=1&&je>0?Z(ae):console.debug("No se puede agregar por stock/precio",{id:ae.id,stockNum:pe,precioNum:je})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),i.jsx("select",{value:g,onChange:V=>p(V.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:A.map(V=>i.jsx("option",{value:V,children:V},V))})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:i.jsx(ax,{productos:$,imageUrls:jr,agregarAlCarrito:Z,openUbicacion:va,thStyle:bx,tdStyle:vx,skuStyle:xx})}),i.jsx(ix,{carrito:l,actualizarCantidad:de,eliminarDelCarrito:H,vaciarCarrito:ee,subtotal:ce,perItemTaxes:ve,taxRate:m,tax18Rate:x,taxTouristRate:v,total:I,openSelector:Yn,btnStyle:_x})]})]}),i.jsx(cx,{open:Bn,selectedEntrada:Ft,onClose:()=>{wt(!1),Ln(null)},imageUrls:jr}),i.jsx(nx,{open:js,totalDue:I,exchangeRate:N,onClose:()=>wi(!1),onConfirm:async V=>{if(gn(V),Kn(!0),Jt)try{Ss(!1),await Cs("Consumidor Final","C/F",V)}catch(fe){console.warn("Error facturando despus del pago:",fe)}wi(!1)}}),i.jsx(Wl.Suspense,{fallback:null}),i.jsx(sx,{open:Ci,onClose:()=>Ya(!1),printFormat:Ei,onPrintFormatChange:V=>ws(V),exchangeRate:N,onExchangeRateChange:V=>R(V)}),i.jsx(ux,{open:me,onClose:()=>K(!1),onCancel:()=>{K(!1),B(null)},onSave:async()=>{K(!1);try{const V=await Ja(T||{});V&&V.id&&P(String(V.id))}catch(V){console.warn("Error guardando cotizacion desde confirm modal",V)}B(null)}}),i.jsx(gx,{open:_s,onClose:()=>Ka(!1),carritoLength:l.length,subtotal:Cn(),saveCotizacion:Ja,finalizePrint:L}),i.jsx(dx,{open:Y,onClose:()=>C(!1),doFacturaClienteFinal:Es,doFacturaClienteNormal:br,doFacturaClienteJuridico:Qa,carritoLength:l.length,subtotal:Cn(),taxRate:m,taxableSubtotal:io()}),i.jsx(fx,{open:k,onClose:()=>re(!1),clienteTipo:pt,clienteRTN:ze,clienteNombre:we,clienteTelefono:Bt,clienteCorreo:nt,clienteExonerado:pa,clienteSearchOpen:be,setClienteSearchOpen:V=>Ee(V),onRTNChange:V=>Ti(V),onNombreChange:V=>Re(V),onTelefonoChange:V=>it(V),onCorreoChange:V=>Dn(V),onExoneradoChange:V=>Lt(V),onCreateCliente:()=>Fa(!0),onCancel:()=>re(!1),onOpenCreateCliente:()=>Fa(!0),onOpenPayment:()=>wi(!0),paymentDone:ao,submitClienteNormal:Ts}),i.jsx(hx,{open:no,onClose:()=>Fa(!1),clienteRTN:ze,clienteNombre:we,clienteTelefono:Bt,clienteCorreo:nt,clienteExonerado:pa,onChangeRTN:V=>Fe(V),onChangeNombre:V=>Re(V),onChangeTelefono:V=>it(V),onChangeCorreo:V=>Dn(V),onChangeExonerado:V=>Lt(V),onCreate:async()=>{try{if(!we||!ze)return;const{data:V,error:fe}=await te.from("clientes").select("id").eq("rtn",ze).maybeSingle();if(fe&&console.warn("Error buscando cliente al crear:",fe),V&&V.id){const{error:xe}=await te.from("clientes").update({nombre:we,telefono:Bt||null,correo_electronica:nt||null,tipo_cliente:"juridico",exonerado:pa}).eq("id",V.id);xe&&console.warn("Error actualizando cliente al crear:",xe)}else{const{error:xe}=await te.from("clientes").insert([{nombre:we,rtn:ze,telefono:Bt||null,correo_electronica:nt||null,tipo_cliente:"juridico",exonerado:pa}]);xe&&console.warn("Error insertando cliente al crear:",xe)}}catch(V){console.warn("Error creando cliente juridico:",V)}Fa(!1)}}),i.jsx(ox,{open:ba,onClose:()=>Et(!1),caiInfo:Mn,onRefresh:Jn})]})}const bx={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},vx={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},xx={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},_x={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},fp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function jx({title:o,children:a}){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:o}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function Sx(){const[o,a]=j.useState(null);return j.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(r=>r.json()).then(r=>a(r)).catch(()=>a(null))},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Ventas (ltimos das)"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Flujo de caja"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Inventario por categora"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Promedios"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):i.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const wx="modulepreload",Ex=function(o){return"/"+o},hp={},En=function(a,r,l){let u=Promise.resolve();if(r&&r.length>0){let m=function(b){return Promise.all(b.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var h=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(r.map(b=>{if(b=Ex(b),b in hp)return;hp[b]=!0;const x=b.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${_}`))return;const v=document.createElement("link");if(v.rel=x?"stylesheet":wx,x||(v.as="script"),v.crossOrigin="",v.href=b,p&&v.setAttribute("nonce",p),document.head.appendChild(v),x)return new Promise((w,N)=>{v.addEventListener("load",w),v.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${b}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function um({open:o,title:a="Confirmado",message:r="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:h="Cancelar"}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("div",{style:{marginTop:8,color:"#334155"},children:r}),i.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:h}),i.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function Cx(){const[o,a]=j.useState(null),[r,l]=j.useState(!1),[u,d]=j.useState(!1),[h,g]=j.useState({}),[p,m]=j.useState(null),[b,x]=j.useState(!1),[_,v]=j.useState(null),[w,N]=j.useState(!1),[R,A]=j.useState(null),[$,M]=j.useState(null),[G,E]=j.useState(!1),[D,L]=j.useState(""),[I,ce]=j.useState(""),[ve,Z]=j.useState(null),[de,H]=j.useState(null);j.useEffect(()=>{let B=!0;return(async()=>{l(!0);try{const O=(await En(async()=>{const{default:oe}=await Promise.resolve().then(()=>wn);return{default:oe}},void 0)).default,{data:P,error:ie}=await O.from("empresa").select("*").limit(1).single();if(!B)return;if(ie)throw ie;if(P){a(P),g(P);try{localStorage.setItem("companyData",JSON.stringify(P))}catch{}l(!1);return}}catch(O){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",O)}try{const O=localStorage.getItem("companyData");if(O){a(JSON.parse(O)),g(JSON.parse(O)),l(!1);return}}catch{}try{const O=await fetch("/data-base/company.json");if(!O.ok)throw new Error("no json");const P=await O.json();if(!B)return;a(P),g(P)}catch{B&&a(null)}finally{B&&l(!1)}})(),()=>{B=!1}},[]),j.useEffect(()=>{o&&g(o)},[o]),j.useEffect(()=>{try{const B=localStorage.getItem("pendingCompanySave");if(B){const O=JSON.parse(B);x(!0),v(O.payload??null),N(!!O.needsLogo)}}catch{}},[]),j.useEffect(()=>{let B=!0;return(async()=>{try{if(!o||!o.logo){B&&Z(null);return}const O=String(o.logo);if(O.startsWith("http")){B&&Z(O);return}const P=(await En(async()=>{const{default:Ee}=await Promise.resolve().then(()=>wn);return{default:Ee}},void 0)).default,ie="logo",k=(await P.storage.from(ie).getPublicUrl(O))?.data?.publicUrl??null;if(k){B&&Z(k);return}const be=(await P.storage.from(ie).createSignedUrl(O,3600))?.data?.signedUrl??null;if(be){B&&Z(be);return}B&&Z(null)}catch(O){console.warn("Error resolving company logo URL",O),B&&Z(null)}})(),()=>{B=!1}},[o?.logo]),j.useEffect(()=>{let B=!0;return(async()=>{try{if(p){B&&H(p);return}const O=h?.logo;if(!O){B&&H(null);return}const P=String(O);if(P.startsWith("http")){B&&H(P);return}const ie=(await En(async()=>{const{default:we}=await Promise.resolve().then(()=>wn);return{default:we}},void 0)).default,oe="logo",re=(await ie.storage.from(oe).getPublicUrl(P))?.data?.publicUrl??null;if(re){B&&H(re);return}const Ee=(await ie.storage.from(oe).createSignedUrl(P,3600))?.data?.signedUrl??null;if(Ee){B&&H(Ee);return}B&&H(null)}catch(O){console.warn("Error resolving edit logo URL",O),B&&H(null)}})(),()=>{B=!1}},[h?.logo,p]);function ee(){d(!0),g(o||{})}function Y(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function C(B){const{name:O,value:P}=B.target;g(ie=>({...ie,[O]:P}))}function z(B){const O=B.target.files?.[0]??null;if(g(P=>({...P,logoFile:O})),O)try{const P=URL.createObjectURL(O);m(P)}catch{m(null)}else m(null)}function X(B=!1){const O="logo",P="https://sqwqlvsjtimallidxrsz.supabase.co";if(B){if(p)return p;const k=h?.logo;if(!k)return"/logo192.png";if(String(k).startsWith("http"))return String(k);let re=String(k);return re.startsWith(`${O}/`)&&(re=re.slice(O.length+1)),`${P}/storage/v1/object/public/${O}/${encodeURIComponent(re)}`}if(!o)return"/logo192.png";const ie=o.logo;if(!ie)return"/logo192.png";if(String(ie).startsWith("http"))return String(ie);let oe=String(ie);return oe.startsWith(`${O}/`)&&(oe=oe.slice(O.length+1)),`${P}/storage/v1/object/public/${O}/${encodeURIComponent(oe)}`}async function me(){try{const B=(await En(async()=>{const{default:re}=await Promise.resolve().then(()=>wn);return{default:re}},void 0)).default,O={...h||{}};let P=null;const ie=re=>{if(!re)return null;if(!re.startsWith("http"))return re;const be=re.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return be?decodeURIComponent(be[2]):null},oe=o?.logo??null;try{const re=h&&h.logoFile instanceof File?h.logoFile:null,be="logo";if(re){const we=`logo/${O.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${re.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,Re=await B.storage.from(be).upload(we,re,{upsert:!0});if(Re.error)throw Re.error;const ze=Re.data?.path??we;P=ze,O.logo=ze}}catch(re){console.warn("Logo upload error",re)}try{O.logoFile&&delete O.logoFile}catch{}let k=null;try{if(o&&o.id){const{data:re,error:be}=await B.from("empresa").update(O).eq("id",o.id).select("*");if(be)throw be;k=Array.isArray(re)?re[0]??null:re}else{const{data:re,error:be}=await B.from("empresa").insert(O).select("*");if(be)throw be;k=Array.isArray(re)?re[0]??null:re}try{if(P){const re=ie(oe);if(re&&re!==P){const Ee=await B.storage.from("logo").remove([re]);Ee.error&&console.warn("Failed to remove old company logo after DB update",Ee.error)}}}catch(re){console.warn("Error removing old logo after DB success",re)}}catch(re){try{if(P){const Ee=await B.storage.from("logo").remove([P]);Ee.error&&console.warn("Failed to remove uploaded logo after DB error",Ee.error)}}catch(be){console.warn("Error cleaning uploaded logo after DB failure",be)}throw re}a(k),g(k);try{console.debug("Empresa guardada, logo field:",k?.logo)}catch{}try{M(k?.logo??null)}catch{}try{L("Datos guardados"),ce("Los datos de la empresa se guardaron correctamente."),E(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(k))}catch{}d(!1)}catch(B){console.error("Error guardando empresa en Supabase",B);try{A(B?.message||String(B))}catch{}try{const O={...h||{}};O.logoFile&&delete O.logoFile;const P=!!(h&&h.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:O,needsLogo:P,ts:Date.now()})),x(!0),v(O),N(P),a(h);try{localStorage.setItem("companyData",JSON.stringify(h))}catch{}d(!1),L("Guardado localmente"),ce("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),E(!0)}catch(O){console.error("Error saving locally",O)}}}async function K(){const B=_;if(!B){L("Sin pendientes"),ce("No hay datos pendientes para enviar"),E(!0);return}try{const O=(await En(async()=>{const{default:ie}=await Promise.resolve().then(()=>wn);return{default:ie}},void 0)).default;let P=null;if(B.id){const{data:ie,error:oe}=await O.from("empresa").update(B).eq("id",B.id).select("*");if(oe)throw oe;P=Array.isArray(ie)?ie[0]??null:ie}else{const{data:ie,error:oe}=await O.from("empresa").insert(B).select("*");if(oe)throw oe;P=Array.isArray(ie)?ie[0]??null:ie}localStorage.removeItem("pendingCompanySave"),x(!1),v(null),N(!1),a(P),g(P),L("Sincronizado"),ce("Los datos pendientes se sincronizaron con Supabase correctamente."),E(!0)}catch(O){console.error("Error reenviando datos pendientes",O),L("Error al reenviar"),ce("No se pudo reenviar los datos a Supabase: "+(O?.message||String(O))),E(!0)}}function T(){try{localStorage.removeItem("pendingCompanySave"),x(!1),v(null),N(!1),L("Pendiente descartado"),ce("El guardado pendiente fue descartado."),E(!0)}catch{}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),r?i.jsx("div",{children:"Cargando datos de la empresa..."}):o?i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[b?i.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",R?i.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(R)]}):null,w?i.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("button",{className:"btn-primary",onClick:K,children:"Reintentar guardar en Supabase"}),i.jsx("button",{className:"btn-opaque",onClick:T,children:"Descartar pendiente"})]})]})}):null,$?i.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[i.jsx("strong",{children:"Logo guardado:"}),i.jsxs("div",{style:{marginTop:6},children:[i.jsx("a",{href:X(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),i.jsx("div",{style:{color:"#374151",fontSize:12},children:String($)})]})]}):null,i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:i.jsx("img",{src:u?de??X(!0):ve??X(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),i.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"RTN:"})," ",u?i.jsx("input",{name:"rtn",value:h.rtn||"",onChange:C,className:"input"}):o.rtn]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Telfono:"})," ",u?i.jsx("input",{name:"telefono",value:h.telefono||"",onChange:C,className:"input"}):o.telefono]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Correo:"})," ",u?i.jsx("input",{name:"email",value:h.email||"",onChange:C,className:"input"}):o.email]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Direccin:"})," ",u?i.jsx("textarea",{name:"direccion",value:h.direccion||"",onChange:C,className:"input",style:{minHeight:64}}):o.direccion]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Logo (archivo o URL):"}),u?i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[i.jsx("input",{type:"file",accept:"image/*",onChange:z}),i.jsx("input",{name:"logo",value:h.logo||"",onChange:C,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):i.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?i.jsxs("div",{style:{marginTop:8},children:[i.jsx("small",{children:"Preview:"}),i.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:me,className:"btn-primary",children:"Guardar"}),i.jsx("button",{type:"button",onClick:Y,className:"btn-opaque",children:"Cancelar"})]}):i.jsx(i.Fragment,{children:i.jsx("button",{type:"button",onClick:ee,className:"btn-primary",children:"Actualizar datos"})})})]}),i.jsx("div",{style:{flex:1,minWidth:320},children:i.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:i.jsx("img",{src:u?de??X(!0):ve??X(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),i.jsxs("p",{style:{margin:0},children:["RTN: ",i.jsx("strong",{children:o.rtn})]}),i.jsxs("p",{style:{margin:0},children:["Telfono: ",i.jsx("strong",{children:o.telefono})]}),i.jsxs("p",{style:{marginTop:8},children:["Correo: ",i.jsx("strong",{children:o.email})]}),i.jsxs("p",{style:{marginTop:8},children:["Direccin: ",i.jsx("strong",{children:o.direccion})]})]})})]}):i.jsx("div",{children:"No se encontraron datos de la empresa."}),i.jsx(um,{open:G,title:D,message:I,onClose:()=>E(!1)})]})}function Tx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function Ax(){const[o,a]=j.useState([]),[r,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(""),[b,x]=j.useState(""),[_,v]=j.useState(""),[w,N]=j.useState(null),[R,A]=j.useState(""),[$,M]=j.useState(""),[G,E]=j.useState("");async function D(){l(!0),d(null);try{const{data:H,error:ee}=await te.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(ee)throw ee;a(Array.isArray(H)?H:[])}catch(H){d(H?.message||String(H)),a([])}finally{l(!1)}}async function L(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!b)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const H={username:p,password:b,role:"cajero"};_&&(H.nombre_usuario=_);const{error:ee}=await te.from("users").insert(H);if(ee)throw ee;m(""),x(""),v(""),await D()}catch(H){d(H?.message||String(H))}finally{l(!1)}}function I(H){N(H.id),A(H.username||""),E(H.nombre_usuario||""),M(""),d(null)}function ce(){N(null),A(""),M(""),E(""),d(null)}async function ve(){if(w!=null){if(!R)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const H={username:R};$&&(H.password=$),H.nombre_usuario=G||null;const{error:ee}=await te.from("users").update(H).eq("id",w);if(ee)throw ee;ce(),await D()}catch(H){d(H?.message||String(H))}finally{l(!1)}}}async function Z(H,ee){if(ee!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:Y}=await te.from("users").delete().eq("id",H);if(Y)throw Y;await D()}catch(Y){d(Y?.message||String(Y))}finally{l(!1)}}}j.useEffect(()=>{let H=!0;return(async()=>H&&await D())(),()=>{H=!1}},[]);const de=o.filter(H=>{if(!h)return!0;const ee=h.toLowerCase();return(H.username||"").toLowerCase().includes(ee)||(String(H.id)||"").includes(ee)||(H.role||"").toLowerCase().includes(ee)||(H.nombre_usuario||"").toLowerCase().includes(ee)});return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[i.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:h,onChange:H=>g(H.target.value),style:{minWidth:220}}),i.jsx("button",{onClick:()=>D(),className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${de.length} usuarios`}),i.jsx("div",{style:{width:"100%",height:8}}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:H=>m(H.target.value)}),i.jsx("input",{placeholder:"Nombre",className:"input",value:_,onChange:H=>v(H.target.value)}),i.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:b,onChange:H=>x(H.target.value)}),i.jsx("button",{onClick:()=>L(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?i.jsx("div",{style:{color:"red",marginBottom:12},children:u}):i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Rol"})]})}),i.jsx("tbody",{children:de.map(H=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:H.id}),i.jsx("td",{style:{minWidth:180},children:w===H.id?i.jsx("input",{className:"input",value:R,onChange:ee=>A(ee.target.value)}):H.username||"-"}),i.jsx("td",{style:{minWidth:180},children:w===H.id?i.jsx("input",{className:"input",value:G,onChange:ee=>E(ee.target.value)}):H.nombre_usuario||"-"}),i.jsx("td",{style:{width:220},children:w===H.id?i.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:$,onChange:ee=>M(ee.target.value)}):H.role||"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:w===H.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ve(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),i.jsx("button",{onClick:()=>ce(),className:"btn-opaque",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>I(H),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),H.role==="cajero"?i.jsx("button",{onClick:()=>Z(H.id,H.role),className:"btn-danger",children:"Eliminar"}):i.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},H.id))})]}),de.length===0&&!r&&i.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function Nx({open:o,onClose:a,row:r,cajeros:l,availableCajeros:u,availableCajas:d,onSave:h}){const[g,p]=j.useState(null),[m,b]=j.useState(null),[x,_]=j.useState(!1),[v,w]=j.useState(null),[N,R]=j.useState(""),[A,$]=j.useState(""),[M,G]=j.useState(""),[E,D]=j.useState(""),[L,I]=j.useState(null),[ce,ve]=j.useState(""),[Z,de]=j.useState(!1),[H,ee]=j.useState(null);if(j.useEffect(()=>{if(!o||!r)return;w(r.caja??null),R(r.cai??""),ve(r.identificador??""),$(r.rango_de??""),G(r.rango_hasta??""),D(r.fecha_vencimiento??""),I(r.secuencia_actual??null);const C=r.cajero??null;if(C){const z=l.find(X=>X.username===C||X.nombre_usuario===C);z?(p(z.id),b(null),_(!1)):(p(null),b(C),_(!0))}else p(null),b(null),_(!1);ee(null)},[o,r,l]),!o||!r)return null;async function Y(){if(!r){ee("Registro invlido");return}if(v!=null&&(v<1||v>5)){ee("La caja debe estar entre 1 y 5");return}de(!0),ee(null);try{const C={cai:N??null,identificador:ce??null,rango_de:A??null,rango_hasta:M??null,fecha_vencimiento:E??null,secuencia_actual:L??null,caja:v??null};if(g!=null){const z=l.find(X=>X.id===g);C.cajero=z?z.username:null,C.usuario_id=z?z.id:null}else C.cajero=m??null,C.usuario_id=null;await h(r.id,C),a()}catch(C){ee(C?.message||String(C))}finally{de(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",r.id]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:N,onChange:C=>R(C.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:ce,onChange:C=>ve(C.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:A,onChange:C=>$(C.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:M,onChange:C=>G(C.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:E,onChange:C=>D(C.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:L??"",onChange:C=>I(C.target.value===""?null:C.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):x?"__custom__":"",onChange:C=>{const z=C.target.value;z===""?(p(null),b(null),_(!1)):z==="__custom__"?(p(null),_(!0)):/^\d+$/.test(z)&&(p(Number(z)),b(null),_(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(C=>i.jsxs("option",{value:String(C.id),children:[C.username,C.nombre_usuario?`  ${C.nombre_usuario}`:""]},C.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),x&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:C=>{b(C.target.value),p(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:v??"",onChange:C=>w(C.target.value===""?null:Number(C.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(C=>i.jsx("option",{value:C,children:C},C))]})]})]})]})]}),H&&i.jsx("div",{style:{color:"red",marginTop:12},children:H}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:Z,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:Y,disabled:Z,style:{width:"auto",padding:"8px 14px"},children:Z?"Guardando...":"Guardar"})]})]})})}function Rx({open:o,onClose:a,cajeros:r,availableCajeros:l,availableCajas:u,onCreate:d}){const[h,g]=j.useState(null),[p,m]=j.useState(null),[b,x]=j.useState(!1),[_,v]=j.useState(null),[w,N]=j.useState(""),[R,A]=j.useState(""),[$,M]=j.useState(""),[G,E]=j.useState(""),[D,L]=j.useState(null),[I,ce]=j.useState(""),[ve,Z]=j.useState(!1),[de,H]=j.useState(null);if(!o)return null;async function ee(){const Y=[];if(w||Y.push("CAI"),R||Y.push("Rango Desde"),$||Y.push("Rango Hasta"),G||Y.push("Fecha de Vencimiento"),_==null&&Y.push("Caja"),h==null&&!p&&Y.push("Cajero"),Y.length>0){H(`Campos obligatorios faltantes: ${Y.join(", ")}`);return}if(_!=null&&(_<1||_>5)){H("La caja debe estar entre 1 y 5");return}Z(!0),H(null);try{const C={cai:w??null,identificador:I??null,rango_de:R??null,rango_hasta:$??null,fecha_vencimiento:G??null,secuencia_actual:D??null,caja:_??null};if(h!=null){const z=r.find(X=>X.id===h);C.cajero=z?z.username:null,C.usuario_id=z?z.id:null}else C.cajero=p??null,C.usuario_id=null;await d(C),a()}catch(C){H(C?.message||String(C))}finally{Z(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:w,onChange:Y=>N(Y.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:I,onChange:Y=>ce(Y.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:R,onChange:Y=>A(Y.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:$,onChange:Y=>M(Y.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:G,onChange:Y=>E(Y.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:D??"",onChange:Y=>L(Y.target.value===""?null:Y.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:h!=null?String(h):b?"__custom__":"",onChange:Y=>{const C=Y.target.value;C===""?(g(null),m(null),x(!1)):C==="__custom__"?(g(null),x(!0)):/^\d+$/.test(C)&&(g(Number(C)),m(null),x(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(l??r).map(Y=>i.jsxs("option",{value:String(Y.id),children:[Y.username,Y.nombre_usuario?`  ${Y.nombre_usuario}`:""]},Y.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),b&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:Y=>{m(Y.target.value),g(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:_??"",onChange:Y=>v(Y.target.value===""?null:Number(Y.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(Y=>i.jsx("option",{value:Y,children:Y},Y))]})]})]})]})]}),de&&i.jsx("div",{style:{color:"red",marginTop:12},children:de}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:ve,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:ee,disabled:ve,style:{width:"auto",padding:"8px 14px"},children:ve?"Creando...":"Crear"})]})]})})}function Ox(){const[o,a]=j.useState([]),[r,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(null),[b,x]=j.useState(!1),[_,v]=j.useState(!1);async function w(){l(!0),d(null);try{const{data:E,error:D}=await te.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(D)throw D;a(Array.isArray(E)?E:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}async function N(){try{const{data:E}=await te.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(E)?E:[])}catch{}}j.useEffect(()=>{w(),N()},[]);const R=new Set(o.filter(E=>E.cajero).map(E=>String(E.cajero))),A=new Set(o.filter(E=>E.caja!=null).map(E=>Number(E.caja)));function $(E){m(E),x(!0),d(null)}function M(){x(!1),m(null)}async function G(E,D){l(!0),d(null);try{const{error:L}=await te.from("cai").update(D).eq("id",E);if(L)throw L;await w()}catch(L){throw d(L?.message||String(L)),L}finally{l(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>v(!0),style:{marginLeft:6},children:"Agregar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${o.length} registros`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"CAI"}),i.jsx("th",{children:"Identificador"}),i.jsx("th",{children:"Rango Desde"}),i.jsx("th",{children:"Rango Hasta"}),i.jsx("th",{children:"Vencimiento"}),i.jsx("th",{children:"Secuencia actual"}),i.jsx("th",{children:"Cajero"}),i.jsx("th",{children:"Usuario ID"}),i.jsx("th",{children:"Caja"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(E=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:E.id}),i.jsx("td",{style:{minWidth:200},children:E.cai}),i.jsx("td",{style:{minWidth:160},children:E.identificador??"-"}),i.jsx("td",{children:E.rango_de}),i.jsx("td",{children:E.rango_hasta}),i.jsx("td",{children:E.fecha_vencimiento}),i.jsx("td",{children:E.secuencia_actual??"-"}),i.jsx("td",{style:{minWidth:180},children:E.cajero||"-"}),i.jsx("td",{style:{minWidth:160},children:E.usuario_id??"-"}),i.jsx("td",{style:{width:120},children:E.caja??"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx(i.Fragment,{children:i.jsx("button",{onClick:()=>$(E),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},E.id))})]}),o.length===0&&!r&&i.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),i.jsx(Nx,{open:b,onClose:M,row:p,cajeros:h,availableCajeros:p?h.filter(E=>!R.has(E.username)||E.username===p.cajero):h.filter(E=>!R.has(E.username)),availableCajas:p?[1,2,3,4,5].filter(E=>!A.has(E)||E===p.caja):[1,2,3,4,5].filter(E=>!A.has(E)),onSave:G}),i.jsx(Rx,{open:_,onClose:()=>v(!1),cajeros:h,availableCajeros:h.filter(E=>!R.has(E.username)),availableCajas:[1,2,3,4,5].filter(E=>!A.has(E)),onCreate:async E=>{l(!0),d(null);try{const{error:D}=await te.from("cai").insert(E);if(D)throw D;await w(),v(!1)}catch(D){throw d(D?.message||String(D)),D}finally{l(!1)}}})]})}function kx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function zx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),i.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Fu=pp();function Ux({open:o,title:a="Confirmar",message:r="Ests seguro?",onClose:l,onConfirm:u}){const[d,h]=Wl.useState(!1);if(!o)return null;const g=async()=>{try{h(!0),await u()}finally{h(!1)}};return Fu.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("p",{children:r}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),i.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function Dx({open:o,title:a="Formulario",columns:r,initialData:l={},onClose:u,onSave:d}){const[h,g]=j.useState({}),[p,m]=j.useState(!1),[b,x]=j.useState(null);if(j.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?x(l.imagen):x(null)},[l,o]),!o)return null;const _=(R,A)=>{g($=>({...$,[R]:A}))},v=async R=>{R.preventDefault();try{m(!0),await d(h)}finally{m(!1)}},w=R=>R==="creado_en"?null:R==="id"?i.jsx("input",{className:"input",value:h[R]??"",readOnly:!0}):R.includes("publicacion")||R.includes("exento")||R.includes("aplica_impuesto")||R==="publicacion_web"?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("label",{className:"switch",children:[i.jsx("input",{type:"checkbox",checked:!!h[R],onChange:A=>_(R,A.target.checked)}),i.jsx("span",{className:"slider"})]}),i.jsx("span",{style:{fontSize:13},children:h[R]?"S":"No"})]}):R.includes("categoria")||R.includes("marca")?i.jsx("input",{type:"text",className:"input",value:h[R]??"",onChange:A=>_(R,A.target.value===""?null:A.target.value)}):R==="imagen"?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[b?i.jsx("img",{src:b,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,i.jsx("input",{type:"file",accept:"image/*",onChange:A=>{const $=A.target.files&&A.target.files[0];if(_(R,$??null),$)try{const M=URL.createObjectURL($);x(M)}catch{x(null)}else x(null)}}),b?i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{_(R,null),x(null)},children:"Eliminar imagen"}):null]}):i.jsx("input",{className:"input",value:h[R]??"",onChange:A=>_(R,A.target.value)}),N=i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsxs("form",{onSubmit:v,children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:r.map(R=>i.jsxs("label",{style:{display:"block"},children:[i.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(R).replace(/_/g," ").toUpperCase()}),w(R)]},R))}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Fu.createPortal(N,typeof document<"u"&&document.body||document.createElement("div"))}function Bx({open:o,data:a,title:r="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const h=a||{},[g,p]=j.useState(null),[m,b]=j.useState(null),[x,_]=j.useState(null),[v,w]=j.useState(null);return j.useEffect(()=>{let N=!0;return(async()=>{const A=typeof h.imagen=="string"?h.imagen:null;if(!A){N&&p(null);return}if(A.startsWith("http")){N&&(p(A),_(A));return}let $=A;const M=String(A).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);M&&($=decodeURIComponent(M[2]));const G="inventario";try{const E=(await En(async()=>{const{default:ve}=await Promise.resolve().then(()=>wn);return{default:ve}},void 0)).default,D=await E.storage.from(G).getPublicUrl($),L=D?.data?.publicUrl||D?.data?.publicURL||null;if(L){N&&(p(L),_(L));return}const I=await E.storage.from(G).createSignedUrl($,3600*24*7);if(I.error){console.warn("ProductDetailModal createSignedUrl error",I.error),N&&p(null);return}const ce=I.data?.signedUrl??null;N&&(p(ce),_(ce))}catch(E){console.error("ProductDetailModal resolve error",E),N&&p(null)}})(),()=>{N=!1}},[h]),j.useEffect(()=>{let N=!0;return(async()=>{if(w(null),!!x)try{const A=await fetch(x,{method:"HEAD"});if(!N)return;w(`HEAD ${A.status} ${A.statusText} - content-type: ${A.headers.get("content-type")}`)}catch(A){if(!N)return;w(`FETCH_ERROR: ${String(A)}`)}})(),()=>{N=!1}},[x]),Fu.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:r}),i.jsxs("div",{style:{display:"flex",gap:18},children:[i.jsx("div",{style:{flex:1},children:i.jsx("table",{style:{width:"100%"},children:i.jsx("tbody",{children:Object.keys(h).map(N=>{const R=h[N];return N==="imagen"&&typeof R=="string"?null:i.jsxs("tr",{children:[i.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(N).replace(/_/g," ").toUpperCase()}),i.jsx("td",{style:{padding:6},children:String(R??"-")})]},N)})})})}),i.jsx("div",{style:{width:280,textAlign:"center"},children:g?i.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:N=>{console.warn("Image load failed for",g),b(g),p(null)}}):m?i.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[i.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),i.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):i.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(h),children:"Editar"}),i.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(h.id),children:"Eliminar"}),i.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function Lx({table:o,select:a,title:r,limit:l=500,columns:u,searchColumns:d,order:h,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:b=!1,formExclude:x=[]}){const[_,v]=j.useState(null),[w,N]=j.useState(!1),[R,A]=j.useState(null),[$,M]=j.useState(""),[G,E]=j.useState(!1),[D,L]=j.useState("add"),[I,ce]=j.useState({}),[ve,Z]=j.useState(!1),[de,H]=j.useState(null),[ee,Y]=j.useState(!1),[C,z]=j.useState(null),X=j.useRef(!0),me=async()=>{N(!0),A(null);try{const oe=(await En(async()=>{const{default:Ee}=await Promise.resolve().then(()=>wn);return{default:Ee}},void 0)).default,k=a||"*";let re=oe.from(o).select(k).limit(l);h&&(Array.isArray(h)?h:String(h).split(",").map(we=>we.trim()).filter(Boolean)).forEach(we=>{const Re=we.split(" ").map(xt=>xt.trim()).filter(Boolean),ze=Re[0],Fe=Re[1]?Re[1].toLowerCase():"asc";re=re.order(ze,{ascending:Fe!=="desc"})}),g&&Object.entries(g).forEach(([Ee,we])=>{we==null||we===""||(re=re.eq(Ee,we))});const be=await re;if(console.debug("SupabaseTable fetch result for",o,be),!X.current)return;if(be.error)throw be.error;v(Array.isArray(be.data)?be.data:[])}catch(oe){console.error("SupabaseTable error",oe),A(oe?.message||String(oe)),v([])}finally{X.current&&N(!1)}};j.useEffect(()=>(X.current=!0,me(),()=>{X.current=!1}),[o,a,l]);const K=j.useMemo(()=>u&&u.length>0?u:!_||_.length===0?[]:Object.keys(_[0]),[u,_]),T=j.useMemo(()=>{if(!_)return null;const oe=($||"").toString().trim().toLowerCase();if(!oe)return _;const k=d&&d.length>0?d:K;return _.filter(re=>k.some(be=>{const Ee=re?.[be];return Ee==null?!1:String(Ee).toLowerCase().includes(oe)}))},[_,$,d,K]),B=()=>{p&&(L("add"),ce({}),E(!0))},O=oe=>{m&&(L("edit"),ce(oe),E(!0))},P=async oe=>{const k=(await En(async()=>{const{default:re}=await Promise.resolve().then(()=>wn);return{default:re}},void 0)).default;try{const re="inventario",be={...oe},Ee=D==="edit"?I?.imagen??null:null,we=Re=>{if(!Re)return null;if(!Re.startsWith("http"))return Re;const ze=Re.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return ze?decodeURIComponent(ze[2]):null};if(be.imagen&&be.imagen instanceof File){const Re=be.imagen,ze=be.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Fe=`${o}/${ze}/${Date.now()}_${Re.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,xt=await k.storage.from(re).upload(Fe,Re,{upsert:!0});if(xt.error)throw xt.error;const At=xt.data?.path??Fe;be.imagen=At;try{const pt=we(Ee);if(pt&&pt!==At){const qt=await k.storage.from(re).remove([pt]);qt.error&&console.warn("Failed to remove old image",qt.error)}}catch(pt){console.warn("Error removing old image",pt)}}if(D==="edit"&&(be.imagen==null||be.imagen===""))try{const Re=we(I?.imagen??null);if(Re){const ze=await k.storage.from(re).remove([Re]);ze.error&&console.warn("Failed to remove old image on clear",ze.error)}}catch(Re){console.warn("Error removing old image on clear",Re)}if(D==="add"){const{error:Re}=await k.from(o).insert([be]);if(Re)throw Re}else{const Re=be.id,ze={...be};delete ze.id;const{error:Fe}=await k.from(o).update(ze).eq("id",Re);if(Fe)throw Fe}E(!1),await me()}catch(re){console.error("Error saving",re),A(re?.message||String(re))}},ie=async()=>{if(de==null)return;const oe=(await En(async()=>{const{default:k}=await Promise.resolve().then(()=>wn);return{default:k}},void 0)).default;try{if(!b)return;try{const re="inventario",be=_?.find(ze=>ze.id===de),Ee=ze=>{if(!ze)return null;if(!ze.startsWith("http"))return ze;const Fe=ze.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Fe?decodeURIComponent(Fe[2]):null},we=be?.imagen??null,Re=Ee(we);if(Re){const ze=await oe.storage.from(re).remove([Re]);ze.error&&console.warn("Failed to remove image on delete",ze.error)}}catch(re){console.warn("Error removing image before delete",re)}const{error:k}=await oe.from(o).delete().eq("id",de);if(k)throw k;Z(!1),H(null),await me()}catch(k){console.error("Error deleting",k),A(k?.message||String(k))}};return i.jsxs("div",{style:{padding:18},children:[r?i.jsx("h2",{style:{marginTop:0},children:r}):null,i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("input",{placeholder:"Buscar...",value:$,onChange:oe=>M(oe.target.value),className:"input",style:{minWidth:240}}),i.jsx("button",{onClick:()=>{A(null),M(""),me()},className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto"},children:i.jsx("button",{onClick:B,className:"btn-primary",children:"Agregar"})})]}),w&&i.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),R&&i.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",R]}),!w&&_&&_.length===0&&i.jsxs("div",{children:["No hay registros en la tabla ",i.jsx("strong",{children:o}),"."]}),!w&&T&&T.length>0&&i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[K.map(oe=>i.jsx("th",{children:String(oe).replace(/_/g," ").toUpperCase()},oe)),i.jsx("th",{style:{width:140},children:"Acciones"})]})}),i.jsx("tbody",{children:T.map((oe,k)=>i.jsxs("tr",{children:[K.map(re=>{if(re==="imagen"){const be=oe?.imagen??null;return be||console.debug("SupabaseTable: row has no imagen for id",oe?.id,oe),i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:be?i.jsx(dm,{src:String(be)}):i.jsx("span",{style:{color:"#6b7280"},children:"-"})},re)}return i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:Mx(oe[re])},re)}),i.jsx("td",{className:"admin-actions",children:i.jsx("button",{className:"btn-opaque",onClick:()=>{z(oe),Y(!0)},children:"Ver"})})]},oe.id??k))})]})}),i.jsx(Dx,{open:G,title:D==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:K.filter(oe=>!x.includes(oe)),initialData:I,onClose:()=>E(!1),onSave:P}),i.jsx(Bx,{open:ee,data:C,title:`Detalle de ${o}`,onClose:()=>Y(!1),onEdit:oe=>{Y(!1),O(oe)},onDeleteClick:oe=>{Y(!1),H(oe),Z(!0)}}),i.jsx(Ux,{open:ve,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>Z(!1),onConfirm:ie})]})}function Mx(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return i.jsx(dm,{src:o})}return String(o)}function dm({src:o}){const[a,r]=j.useState(null),[l,u]=j.useState(null);return j.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&r(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await En(async()=>{const{default:N}=await Promise.resolve().then(()=>wn);return{default:N}},void 0)).default,b="inventario",x=await m.storage.from(b).getPublicUrl(g),_=x?.data?.publicUrl||x?.data?.publicURL||null;if(_){d&&r(_);return}const v=await m.storage.from(b).createSignedUrl(g,3600*24*7);if(v.error){console.warn("Thumbnail createSignedUrl error",v.error),d&&r(null);return}const w=v.data?.signedUrl??null;d&&r(w)}catch(m){console.error("Thumbnail resolve error",m),d&&r(null)}})(),()=>{d=!1}},[o]),!a&&!l?i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?i.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),r(null)}}):i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:i.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function qx(){const[o,a]=j.useState(null),[r,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]);return j.useEffect(()=>{let b=!0;return(async()=>{try{const v=await(await En(async()=>{const{default:L}=await Promise.resolve().then(()=>wn);return{default:L}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!b)return;const w=Array.isArray(v.data)?v.data:[],N=new Set(w.map(L=>L.categoria??"").filter(Boolean)),R=new Set(w.map(L=>L.marca??"").filter(Boolean)),A=w.length,$=w.filter(L=>!!L.publicacion_web).length,M=L=>{if(L==null)return!1;if(typeof L=="boolean")return L===!0;if(typeof L=="number")return L===1;const I=String(L).toLowerCase().trim();return I==="1"||I==="true"||I==="t"||I==="si"||I==="s"||I==="yes"},G=w.filter(L=>M(L.exento)).length,E=w.filter(L=>M(L.aplica_impuesto_18)).length,D=w.filter(L=>M(L.aplica_impuesto_turistico)).length;a({categorias:N.size,marcas:R.size,items:A,publicadas:$,exentos:G,aplica_impuesto_18:E,aplica_impuesto_turistico:D}),g(Array.from(N).sort()),m(Array.from(R).sort())}catch(_){console.error("Error loading inventario summary",_)}})(),()=>{b=!1}},[]),i.jsxs("div",{children:[i.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[i.jsx(bi,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),i.jsx(bi,{label:"Marcas",value:o?String(o.marcas):"..."}),i.jsx(bi,{label:"Items",value:o?String(o.items):"..."}),i.jsx(bi,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),i.jsx(bi,{label:"Exentos",value:o?String(o.exentos):"..."}),i.jsx(bi,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),i.jsx(bi,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),i.jsxs("select",{value:r,onChange:b=>l(b.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),h.map(b=>i.jsx("option",{value:b,children:b},b))]})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),i.jsxs("select",{value:u,onChange:b=>d(b.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),p.map(b=>i.jsx("option",{value:b,children:b},b))]})]}),i.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),i.jsx(Lx,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:r||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function bi({label:o,value:a}){return i.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),i.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function Ix({open:o,onClose:a,products:r,availableCajas:l,onCreate:u}){const[d,h]=j.useState(null),[g,p]=j.useState(""),[m,b]=j.useState(!1),[x,_]=j.useState(null),[v,w]=j.useState(null),[N,R]=j.useState(null),[A,$]=j.useState(null),[M,G]=j.useState(null),[E,D]=j.useState(null),[L,I]=j.useState(null),[ce,ve]=j.useState(null),[Z,de]=j.useState(null),[H,ee]=j.useState(!1);j.useEffect(()=>{o&&(h(null),p(""),w(null),R(null),$(null),ve(null),de(null),_(null))},[o]);async function Y(){const z=[];if(d||z.push("Producto"),g||z.push("Precio"),z.length>0){_(`Faltan campos: ${z.join(", ")}`);return}const X=Number(g);if(isNaN(X)||X<0){_("Precio invlido");return}b(!0),_(null);try{await u({producto_id:d,precio:g});try{const me={};if(M!==null&&(me.exento=M),E!==null&&(me.aplica_impuesto_18=E),L!==null&&(me.aplica_impuesto_turistico=L),Object.keys(me).length>0){const{error:K}=await te.from("inventario").update(me).eq("id",d);K&&console.warn("Error actualizando inventario flags:",K)}}catch(me){console.warn("Error al persistir flags en inventario:",me)}a()}catch(me){_(me?.message||String(me))}finally{b(!1)}}function C(z){return z?Number(z.replace(",",".")):NaN}return j.useEffect(()=>{let z=!0;async function X(){if(w(null),R(null),$(null),ve(null),de(null),!d)return;const me=C(g);if(!isNaN(me)){ee(!0);try{const{data:K,error:T}=await te.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(T)throw T;const B=Array.isArray(K)?K.map(it=>Number(it.costo_unitario)).filter(it=>!isNaN(it)):[],O=B.length>0?B.reduce((it,nt)=>it+nt,0)/B.length:0;if(!z)return;w(O);let P=!1,ie=!1,oe=!1;try{const{data:it,error:nt}=await te.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!nt&&it&&(P=!!it.exento,ie=!!it.aplica_impuesto_18,oe=!!it.aplica_impuesto_turistico,M===null&&G(P),E===null&&D(ie),L===null&&I(oe))}catch{}const{data:k}=await te.from("impuesto").select("id, impuesto_venta"),re={};Array.isArray(k)&&k.forEach(it=>{re[String(it.id)]=Number(it.impuesto_venta)});const be=M!==null?M:P,Ee=E!==null?E:ie,we=L!==null?L:oe;let Re=0;be?Re=0:Ee?Re=re[2]??re[1]??0:Re=re[1]??0;let ze=0;we&&(ze=re[3]??0);const Fe=(Re||0)+(ze||0),xt=Fe>1?Fe/100:Fe,At=me*xt;R(Fe),$(At);const pt=me-O,qt=O>0?pt/O*100:null;ve(qt);const Bt=me>0?(me-O-At)/me*100:null;de(Bt)}catch{}finally{z&&ee(!1)}}}return X(),()=>{z=!1}},[d,g,M,E,L]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:d??"",onChange:z=>h(z.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),r.map(z=>i.jsx("option",{value:z.id,children:z.nombre},z.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!M,onChange:z=>G(z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!E,onChange:z=>D(z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!L,onChange:z=>I(z.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:g,onChange:z=>p(z.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:v==null?"":v.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:A==null?"":A.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:ce==null?"":ce.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:Z==null?"":Z.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&i.jsx("div",{style:{color:"red",marginTop:12},children:x}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:Y,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function Hx({open:o,onClose:a,row:r,products:l,availableProducts:u,onSave:d}){const[h,g]=j.useState(null),[p,m]=j.useState(""),[b,x]=j.useState(!1),[_,v]=j.useState(null),[w,N]=j.useState(null),[R,A]=j.useState(null),[$,M]=j.useState(null),[G,E]=j.useState(null),[D,L]=j.useState(null),[I,ce]=j.useState(null),[ve,Z]=j.useState(null),[de,H]=j.useState(null),[ee,Y]=j.useState(!1);j.useEffect(()=>{if(!(!o||!r)){g(r.producto_id);try{const X=Number(r.precio);m(isNaN(X)?String(r.precio):X.toFixed(2))}catch{m(r.precio)}v(null)}},[o,r]);function C(X){return X?Number(X.replace(",",".")):NaN}if(j.useEffect(()=>{let X=!0;async function me(){if(N(null),A(null),M(null),Z(null),H(null),!o||!r||!h)return;const K=C(p);if(!isNaN(K)){Y(!0);try{const{data:T,error:B}=await te.from("compras_detalle").select("costo_unitario").eq("producto_id",h);if(B)throw B;const O=Array.isArray(T)?T.map(nt=>Number(nt.costo_unitario)).filter(nt=>!isNaN(nt)):[],P=O.length>0?O.reduce((nt,Dn)=>nt+Dn,0)/O.length:0;if(!X)return;N(P);let ie=!1,oe=!1,k=!1;try{const{data:nt,error:Dn}=await te.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",h).single();!Dn&&nt&&(ie=!!nt.exento,oe=!!nt.aplica_impuesto_18,k=!!nt.aplica_impuesto_turistico,G===null&&E(ie),D===null&&L(oe),I===null&&ce(k))}catch{}const{data:re}=await te.from("impuesto").select("id, impuesto_venta"),be={};Array.isArray(re)&&re.forEach(nt=>be[String(nt.id)]=Number(nt.impuesto_venta));const Ee=G!==null?G:ie,we=D!==null?D:oe,Re=I!==null?I:k;let ze=0;Ee?ze=0:we?ze=be[2]??be[1]??0:ze=be[1]??0;let Fe=0;Re&&(Fe=be[3]??0);const xt=(ze||0)+(Fe||0),At=xt>1?xt/100:xt,pt=K*At;A(xt),M(pt);const qt=K-P,Bt=P>0?qt/P*100:null;Z(Bt);const it=K>0?(K-P-pt)/K*100:null;H(it)}catch{}finally{X&&Y(!1)}}}return me(),()=>{X=!1}},[o,r,h,p,G,D,I]),!o||!r)return null;async function z(){const X=[];if(h||X.push("Producto"),p||X.push("Precio"),X.length>0){v(`Faltan campos: ${X.join(", ")}`);return}const me=Number(p);if(isNaN(me)||me<0){v("Precio invlido");return}x(!0),v(null);try{const K=r.id;await d(K,{producto_id:h,precio:p});try{const T={};if(G!==null&&(T.exento=G),D!==null&&(T.aplica_impuesto_18=D),I!==null&&(T.aplica_impuesto_turistico=I),Object.keys(T).length>0&&h){const{error:B}=await te.from("inventario").update(T).eq("id",h);B&&console.warn("Error actualizando inventario flags:",B)}}catch(T){console.warn("Error al persistir flags en inventario:",T)}a()}catch(K){v(K?.message||String(K))}finally{x(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",r.id]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:h??"",onChange:X=>g(X.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(X=>i.jsx("option",{value:X.id,children:X.nombre},X.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!G,onChange:X=>E(X.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!D,onChange:X=>L(X.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!I,onChange:X=>ce(X.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:p,onChange:X=>m(X.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:$==null?"":$.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:ve==null?"":ve.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:de==null?"":de.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&i.jsx("div",{style:{color:"red",marginTop:12},children:_}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:b,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:z,disabled:b,style:{width:"auto",padding:"8px 14px"},children:b?"Guardando...":"Guardar"})]})]})})}function $x(){const[o,a]=j.useState([]),[r,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null),[p,m]=j.useState(!1),[b,x]=j.useState(!1),[_,v]=j.useState(null);async function w(){d(!0),g(null);try{const{data:E,error:D}=await te.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(D)throw D;a(Array.isArray(E)?E:[])}catch(E){g(E?.message||String(E)),a([])}finally{d(!1)}}async function N(){try{const{data:E}=await te.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(E)?E:[])}catch{}}j.useEffect(()=>{w(),N()},[]);const R=new Set(o.map(E=>String(E.producto_id))),A=r.filter(E=>!R.has(E.id));function $(E){v(E),x(!0),g(null)}async function M(E){d(!0),g(null);try{const{error:D}=await te.from("precios").insert(E);if(D)throw D;try{const L={producto_id:E.producto_id,precio:E.precio},{error:I}=await te.from("precios_historico").insert(L);I&&console.warn("No se pudo insertar en precios_historico",I)}catch(L){console.warn("Error registrando precios_historico",L)}await w()}catch(D){throw g(D?.message||String(D)),D}finally{d(!1)}}async function G(E,D){d(!0),g(null);try{const{error:L}=await te.from("precios").update(D).eq("id",E);if(L)throw L;let I=D.producto_id,ce=D.precio;if(!I||ce===void 0)try{const{data:ve}=await te.from("precios").select("producto_id, precio").eq("id",E).limit(1).single();ve&&(I=I||ve.producto_id,ce=ce===void 0?ve.precio:ce)}catch{}try{if(I&&ce!==void 0){const ve={producto_id:I,precio:ce},{error:Z}=await te.from("precios_historico").insert(ve);Z&&console.warn("No se pudo insertar en precios_historico",Z)}}catch(ve){console.warn("Error registrando precios_historico",ve)}await w()}catch(L){throw g(L?.message||String(L)),L}finally{d(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{w(),N()},children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),h&&i.jsx("div",{style:{color:"red",marginBottom:12},children:h}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(E=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:E.id}),i.jsx("td",{style:{minWidth:220},children:r.find(D=>D.id===E.producto_id)?.nombre||E.producto_id}),i.jsx("td",{children:E.precio}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>$(E),children:"Editar"})})]},E.id))})]})}),i.jsx(Ix,{open:p,onClose:()=>m(!1),products:A,onCreate:async E=>{await M(E),m(!1)}}),i.jsx(Hx,{open:b,onClose:()=>{x(!1),v(null)},row:_,products:r,availableProducts:[...r.filter(E=>!R.has(E.id)),..._?r.filter(E=>E.id===_.producto_id):[]],onSave:async(E,D)=>{await G(E,D),x(!1),v(null)}})]})}function Px(){const[o,a]=j.useState(""),[r,l]=j.useState([]),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(!1),[b,x]=j.useState(null);async function _(){if(x(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:N}=await te.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(N)throw N;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const R=w[0].id;d(R),await v(R)}}catch(w){x(w?.message||String(w))}finally{m(!1)}}}async function v(w){m(!0),x(null);try{const{data:N,error:R}=await te.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(R)throw R;g(Array.isArray(N)?N:[])}catch(N){x(N?.message||String(N)),g([])}finally{m(!1)}}return j.useEffect(()=>{u&&v(u)},[u]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>_(),children:"Buscar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${h.length} registros`})]}),b&&i.jsx("div",{style:{color:"red",marginBottom:12},children:b}),r.length>0&&i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),i.jsx("ul",{children:r.map(w=>i.jsxs("li",{style:{marginBottom:6},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),i.jsx("strong",{children:w.nombre})," ",i.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Actualizacion"})]})}),i.jsx("tbody",{children:h.map(w=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(w.id)}),i.jsx("td",{style:{minWidth:220},children:r.find(N=>N.id===w.producto_id)?.nombre||w.producto_id}),i.jsx("td",{children:Number(w.precio).toFixed(2)}),i.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function Vx(){const[o,a]=j.useState(""),[r,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState({}),[b,x]=j.useState({}),[_,v]=j.useState(!1),[w,N]=j.useState(null);async function R(){v(!0),N(null);try{let A=te.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(A=A.ilike("sku",`%${o}%`)),r&&(A=A.ilike("marca",`%${r}%`)),u&&(A=A.ilike("modelo",`%${u}%`));const{data:$,error:M}=await A.order("nombre",{ascending:!0});if(M)throw M;const G=Array.isArray($)?$:[];g(G);const E=G.map(ve=>ve.id);if(E.length===0){m({});return}const{data:D,error:L}=await te.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",E);if(L)throw L;const I=Array.isArray(D)?D:[],ce={};for(const ve of G)ce[String(ve.id)]=0;for(const ve of I){const Z=String(ve.producto_id),de=Number(ve.cantidad)||0,H=String(ve.tipo_de_movimiento||"").toUpperCase();ce.hasOwnProperty(Z)||(ce[Z]=0),H==="ENTRADA"?ce[Z]=(ce[Z]||0)+de:H==="SALIDA"&&(ce[Z]=(ce[Z]||0)-de)}for(const ve of Object.keys(ce))ce[ve]=Number((ce[ve]||0).toFixed(2));m(ce);try{const ve=(await En(async()=>{const{default:H}=await Promise.resolve().then(()=>wn);return{default:H}},void 0)).default,Z="inventario",de={};await Promise.all(G.map(async H=>{const ee=H.imagen;if(!ee){de[String(H.id)]=null;return}const Y=String(ee);if(Y.startsWith("http")){de[String(H.id)]=Y;return}let C=Y;const z=String(Y).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);z&&(C=decodeURIComponent(z[2]));try{const X=await ve.storage.from(Z).getPublicUrl(C),me=X?.data?.publicUrl||X?.data?.publicURL||null;if(me){de[String(H.id)]=me;return}}catch{}try{const me=(await ve.storage.from(Z).createSignedUrl(C,604800))?.data?.signedUrl??null;de[String(H.id)]=me}catch{de[String(H.id)]=null}})),x(de)}catch{}}catch(A){N(A?.message||String(A)),g([]),m({})}finally{v(!1)}}return j.useEffect(()=>{R()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Stock"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:A=>a(A.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Marca",value:r,onChange:A=>l(A.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:A=>d(A.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>R(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),R()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:_?"Cargando...":`${h.length} productos`})]}),w&&i.jsx("div",{style:{color:"red",marginBottom:12},children:w}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Imagen"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Marca"}),i.jsx("th",{children:"Modelo"}),i.jsx("th",{children:"Descripcin"}),i.jsx("th",{children:"Stock"})]})}),i.jsx("tbody",{children:h.map(A=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:b[String(A.id)]?i.jsx("img",{src:encodeURI(b[String(A.id)]),alt:A.nombre,style:{width:48,height:48,objectFit:"cover"},onError:$=>{$.currentTarget.src=""}}):A.imagen?i.jsx("img",{src:A.imagen,alt:A.nombre,style:{width:48,height:48,objectFit:"cover"},onError:$=>{$.currentTarget.src=""}}):""}),i.jsx("td",{children:A.sku||""}),i.jsx("td",{children:A.marca||""}),i.jsx("td",{children:A.modelo||""}),i.jsx("td",{style:{maxWidth:320},children:A.descripcion||""}),i.jsx("td",{style:{textAlign:"right"},children:p[String(A.id)]!=null?String(p[String(A.id)]):"0"})]},A.id))})]})]})]})}function Gx(){const[o,a]=j.useState(""),[r,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]),[b,x]=j.useState(!1),[_,v]=j.useState([]),[w,N]=j.useState({}),[R,A]=j.useState(!1),[$,M]=j.useState(null);async function G(){A(!0),M(null),v([]);try{let I=null;if(o||r||u){let ee=te.from("inventario").select("id").order("nombre",{ascending:!0});o&&(ee=ee.ilike("sku",`%${o}%`)),r&&(ee=ee.ilike("marca",`%${r}%`)),u&&(ee=ee.ilike("categoria",`%${u}%`));const{data:Y,error:C}=await ee;if(C)throw C;if(I=Array.isArray(Y)?Y.map(z=>String(z.id)):[],I.length===0){v([]),N({}),A(!1);return}}let ce=te.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(I&&(ce=ce.in("producto_id",I)),b){const ee=new Date(Date.now()-864e5).toISOString();ce=ce.gte("fecha_salida",ee)}ce=ce.order("fecha_salida",{ascending:!1});const{data:ve,error:Z}=await ce;if(Z)throw Z;const de=Array.isArray(ve)?ve.map(ee=>({id:ee.id,producto_id:String(ee.producto_id),cantidad:Number(ee.cantidad),tipo_de_movimiento:ee.tipo_de_movimiento,referencia:ee.referencia,usuario:ee.usuario,fecha_salida:ee.fecha_salida})):[];v(de);const H=Array.from(new Set(de.map(ee=>ee.producto_id))).filter(Boolean);if(H.length>0){const{data:ee}=await te.from("inventario").select("id, nombre, sku, marca, categoria").in("id",H),Y={};Array.isArray(ee)&&ee.forEach(C=>{Y[String(C.id)]={id:C.id,nombre:C.nombre,sku:C.sku,marca:C.marca,categoria:C.categoria}}),N(Y)}else N({})}catch(I){M(I?.message||String(I)),v([])}finally{A(!1)}}async function E(){try{const{data:I,error:ce}=await te.from("inventario").select("marca, categoria");if(ce)throw ce;const ve=new Set,Z=new Set;Array.isArray(I)&&I.forEach(de=>{de.marca&&ve.add(String(de.marca)),de.categoria&&Z.add(String(de.categoria))}),g(Array.from(ve).sort()),m(Array.from(Z).sort())}catch(I){console.warn("Error loading filter options",I)}}j.useEffect(()=>{G(),E()},[]);const D=_.filter(I=>String(I.tipo_de_movimiento).toUpperCase()==="ENTRADA"),L=_.filter(I=>String(I.tipo_de_movimiento).toUpperCase()==="SALIDA");return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:I=>a(I.target.value)}),i.jsxs("select",{className:"input",value:r,onChange:I=>l(I.target.value),children:[i.jsx("option",{value:"",children:"-- Marca (todas) --"}),h.map(I=>i.jsx("option",{value:I,children:I},I))]}),i.jsxs("select",{className:"input",value:u,onChange:I=>d(I.target.value),children:[i.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(I=>i.jsx("option",{value:I,children:I},I))]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:b,onChange:I=>x(I.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),x(!1),G()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:R?"Cargando...":`${_.length} registros`})]}),$&&i.jsx("div",{style:{color:"red",marginBottom:12},children:$}),i.jsxs("div",{style:{display:"flex",gap:12},children:[i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Entradas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:D.map(I=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String(I.id)}),i.jsx("td",{style:{minWidth:120},children:w[I.producto_id]?.sku||I.producto_id}),i.jsx("td",{children:w[I.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number(I.cantidad).toFixed(2)}),i.jsx("td",{children:I.referencia||""}),i.jsx("td",{children:I.usuario||""}),i.jsx("td",{children:I.fecha_salida||""})]},String(I.id)))})]})]}),i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Salidas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:L.map(I=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String(I.id)}),i.jsx("td",{style:{minWidth:120},children:w[I.producto_id]?.sku||I.producto_id}),i.jsx("td",{children:w[I.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number(I.cantidad).toFixed(2)}),i.jsx("td",{children:I.referencia||""}),i.jsx("td",{children:I.usuario||""}),i.jsx("td",{children:I.fecha_salida||""})]},String(I.id)))})]})]})]})]})}function Fx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),i.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function Kx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),i.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function Yx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function Jx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function Qx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function Xx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function Zx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function Wx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),i.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function e_(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),i.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function t_(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),i.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function n_(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),i.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function a_({open:o,onClose:a,onCreate:r}){const[l,u]=j.useState(""),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,b]=j.useState(""),[x,_]=j.useState(""),[v,w]=j.useState(""),[N,R]=j.useState(!0),[A,$]=j.useState(!1),[M,G]=j.useState(null);if(!o)return null;async function E(){const D=[];if(l.trim()||D.push("Nombre"),D.length){G(`Faltan campos: ${D.join(", ")}`);return}$(!0),G(null);try{await r({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:v||void 0,activo:N}),u(""),h(""),p(""),b(""),_(""),w(""),R(!0),a()}catch(L){G(L?.message||String(L))}finally{$(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:l,onChange:D=>u(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:d,onChange:D=>h(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:g,onChange:D=>p(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:m,onChange:D=>b(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:x,onChange:D=>_(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:v,onChange:D=>w(D.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:N,onChange:D=>R(D.target.checked)})," ","Activo"]})]}),M&&i.jsx("div",{style:{color:"red",marginTop:12},children:M}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:A,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:E,disabled:A,style:{width:"auto",padding:"8px 14px"},children:A?"Creando...":"Crear"})]})]})})}function i_({open:o,onClose:a,row:r,onSave:l}){const[u,d]=j.useState(""),[h,g]=j.useState(""),[p,m]=j.useState(""),[b,x]=j.useState(""),[_,v]=j.useState(""),[w,N]=j.useState(""),[R,A]=j.useState(!0),[$,M]=j.useState(!1),[G,E]=j.useState(null);if(j.useEffect(()=>{!o||!r||(d(r.nombre||""),g(r.rtn||""),m(r.telefono||""),x(r.correo||""),v(r.direccion||""),N(r.tipo_proveedor||""),A(r.activo??!0),E(null))},[o,r]),!o||!r)return null;async function D(){if(!r){E("No hay fila seleccionada");return}const L=[];if(u.trim()||L.push("Nombre"),L.length){E(`Faltan campos: ${L.join(", ")}`);return}M(!0),E(null);try{await l(r.id,{nombre:u.trim(),rtn:h.trim()||void 0,telefono:p.trim()||void 0,correo:b.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:w||void 0,activo:R}),a()}catch(I){E(I?.message||String(I))}finally{M(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(r.id)]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:u,onChange:L=>d(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:h,onChange:L=>g(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:p,onChange:L=>m(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:b,onChange:L=>x(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:_,onChange:L=>v(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:w,onChange:L=>N(L.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:R,onChange:L=>A(L.target.checked)})," ","Activo"]})]}),G&&i.jsx("div",{style:{color:"red",marginTop:12},children:G}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:$,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:D,disabled:$,style:{width:"auto",padding:"8px 14px"},children:$?"Guardando...":"Guardar"})]})]})})}function r_(){const[o,a]=j.useState([]),[r,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(!1),[b,x]=j.useState(!1),[_,v]=j.useState(null),[w,N]=j.useState(!1),[R,A]=j.useState(null);async function $(D){l(!0),d(null);try{let L=null,I=null;if(D&&D.trim()){const ve=`%${D.trim()}%`,Z=await te.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${ve},rtn.ilike.${ve}`).order("id",{ascending:!0});L=Z.data,I=Z.error}else{const ce=await te.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});L=ce.data,I=ce.error}if(I)throw I;a(Array.isArray(L)?L:[])}catch(L){d(L?.message||String(L)),a([])}finally{l(!1)}}j.useEffect(()=>{$()},[]),j.useEffect(()=>{const D=setTimeout(()=>{$(h)},350);return()=>clearTimeout(D)},[h]);async function M(D){l(!0),d(null);try{const L={...D};if(delete L.id,L.rtn){const{data:ce,error:ve}=await te.from("proveedores").select("id, nombre").eq("rtn",L.rtn).limit(1);if(ve)throw ve;if(Array.isArray(ce)&&ce.length>0)throw new Error(`Ya existe un proveedor con RTN ${L.rtn}`)}const{error:I}=await te.from("proveedores").insert(L);if(I)throw I;await $()}catch(L){throw String(L).includes("Ya existe un proveedor")?d(String(L)):L?.code==="23505"||String(L).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(L?.message||String(L)),L}finally{l(!1)}}async function G(D,L){l(!0),d(null);try{const{error:I}=await te.from("proveedores").update(L).eq("id",D);if(I)throw I;await $()}catch(I){throw d(I?.message||String(I)),I}finally{l(!1)}}async function E(){if(R){l(!0),d(null);try{const{error:D}=await te.from("proveedores").delete().eq("id",R.id);if(D)throw D;N(!1),A(null),await $()}catch(D){d(D?.message||String(D))}finally{l(!1)}}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>$(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),i.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:h,onChange:D=>g(D.target.value),style:{width:260}}),i.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),$()},children:"Limpiar"})]}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${o.length} proveedores`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"RTN"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Telfono"}),i.jsx("th",{children:"Correo"}),i.jsx("th",{children:"Direccin"}),i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Activo"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(D=>i.jsxs("tr",{children:[i.jsx("td",{children:D.rtn||""}),i.jsx("td",{style:{minWidth:180},children:D.nombre}),i.jsx("td",{children:D.telefono||""}),i.jsx("td",{children:D.correo||""}),i.jsx("td",{children:D.direccion||""}),i.jsx("td",{children:D.tipo_proveedor||""}),i.jsx("td",{children:D.activo?"S":"No"}),i.jsxs("td",{style:{whiteSpace:"nowrap"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{v(D),x(!0)},children:"Editar"}),i.jsx("button",{className:"btn-danger",onClick:()=>{A(D),N(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},D.id))})]})}),i.jsx(a_,{open:p,onClose:()=>m(!1),onCreate:async D=>{await M(D),m(!1)}}),i.jsx(i_,{open:b,onClose:()=>{x(!1),v(null)},row:_,onSave:async(D,L)=>{await G(D,L),x(!1),v(null)}}),i.jsx(um,{open:w,title:R?`Eliminar proveedor ${R.nombre}`:"Eliminar proveedor",message:R?`Confirma eliminar al proveedor ${R.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await E()},onCancel:()=>{N(!1),A(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function s_({open:o,onClose:a,onCreated:r}){const[l,u]=j.useState([]),[d,h]=j.useState([]),[g,p]=j.useState(0),[m,b]=j.useState(null),[x,_]=j.useState(""),[v,w]=j.useState("factura"),[N,R]=j.useState([]),[A,$]=j.useState(null),[M,G]=j.useState(1),[E,D]=j.useState(null),[L,I]=j.useState(!1),[ce,ve]=j.useState(null);if(j.useEffect(()=>{o&&(async()=>{try{const z=await te.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(z.data)?z.data:[])}catch{}try{const z=await te.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});h(Array.isArray(z.data)?z.data:[])}catch{}try{const z=await te.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),X=Array.isArray(z.data)&&z.data.length>0?z.data[0]:null,me=X?Number(X.impuesto_venta):0;p(me)}catch{}})()},[o]),!o)return null;function Z(){b(null),_(""),w("factura"),R([]),$(null),G(1),D(null),ve(null)}function de(){if(!A){ve("Selecciona un producto");return}if(!E||E<=0){ve("Costo unitario invlido");return}if(!M||M<=0){ve("Cantidad invlida");return}const z=l.find(me=>me.id===A),X=me=>{if(me==null)return!1;if(typeof me=="boolean")return me===!0;if(typeof me=="number")return me===1;const K=String(me).toLowerCase().trim();return K==="1"||K==="true"||K==="t"||K==="si"||K==="s"||K==="yes"};R(me=>[...me,{producto_id:A,nombre:z?.nombre||"",cantidad:M,costo_unitario:E,exento:X(z?.exento)}]),$(null),G(1),D(null),ve(null)}function H(z){R(X=>X.filter((me,K)=>K!==z))}function ee(){const z=g,X=z>1?z/100:z;let me=0,K=0,T=0;for(const B of N){const O=B.cantidad*B.costo_unitario;let P=0,ie=O;B.exento||(P=O*X,ie=O-P),me+=ie,K+=P,T+=O}return{subtotal:me,impuesto:K,total:T}}async function Y(){if(ve(null),!m){ve("Selecciona un proveedor");return}if(N.length===0){ve("Agrega al menos un producto");return}I(!0);try{const{subtotal:z,impuesto:X,total:me}=ee(),K={proveedor_id:m,numero_documento:x||null,tipo_documento:v||null,subtotal:z,impuesto:X,total:me,usuario:null},T=await te.from("compras").insert(K).select("id").single();if(T.error)throw T.error;const B=T.data.id,O=N.map(ie=>({compra_id:B,producto_id:ie.producto_id,cantidad:ie.cantidad,costo_unitario:ie.costo_unitario})),P=await te.from("compras_detalle").insert(O);if(P.error)throw await te.from("compras").delete().eq("id",B),P.error;try{const ie=x?`Compra - ${x}`:`Compra ${B}`;let oe="sistema";try{const Ee=localStorage.getItem("user");if(Ee){const we=JSON.parse(Ee);oe=we.username?`${we.username}${we.role?` (${we.role})`:""}`:String(we)}}catch{}const k=new Date().toISOString(),re=N.map(Ee=>({producto_id:Ee.producto_id,cantidad:Ee.cantidad,tipo_de_movimiento:"ENTRADA",referencia:ie,usuario:oe,fecha_salida:k})),be=await te.from("registro_de_inventario").insert(re);be.error&&(console.warn("Error registrando en registro_de_inventario",be.error),ve("Compra guardada, pero fall el registro en inventario: "+be.error.message))}catch(ie){console.warn("Registro inventario fallo",ie)}Z(),a(),r&&r()}catch(z){ve(z?.message||String(z))}finally{I(!1)}}const C=ee();return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),i.jsxs("select",{className:"input",value:m??"",onChange:z=>b(z.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(z=>i.jsx("option",{value:z.id,children:z.nombre},String(z.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),i.jsx("input",{className:"input",value:x,onChange:z=>_(z.target.value)}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),i.jsx("input",{className:"input",value:v,onChange:z=>w(z.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:A??"",onChange:z=>$(z.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(z=>i.jsx("option",{value:z.id,children:z.nombre},z.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:z=>G(Number(z.target.value))}),i.jsx("input",{className:"input",type:"number",style:{width:120},value:E??"",onChange:z=>D(Number(z.target.value)),placeholder:"Costo unitario"}),i.jsx("button",{className:"btn-primary",onClick:de,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:N.map((z,X)=>{const me=z.cantidad*z.costo_unitario,K=g>1?g/100:g,T=z.exento?0:me*K,B=z.exento?me:me-T;return i.jsxs("tr",{children:[i.jsx("td",{children:z.nombre}),i.jsx("td",{children:z.cantidad}),i.jsx("td",{children:z.costo_unitario.toFixed(2)}),i.jsx("td",{children:T.toFixed(2)}),i.jsx("td",{children:B.toFixed(2)}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>H(X),children:"Quitar"})})]},`${z.producto_id}-${X}`)})})]})})]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:["Subtotal: ",i.jsx("strong",{children:C.subtotal.toFixed(2)})]}),i.jsxs("div",{children:["Impuesto: ",i.jsx("strong",{children:C.impuesto.toFixed(2)})]}),i.jsxs("div",{children:["Total: ",i.jsx("strong",{children:C.total.toFixed(2)})]})]})}),ce&&i.jsx("div",{style:{color:"red",marginTop:12},children:ce}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{Z(),a()},disabled:L,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:Y,disabled:L,children:L?"Guardando...":"Confirmar compra"})]})]})})}function l_({open:o,compraId:a,onClose:r}){const[l,u]=j.useState([]),[d,h]=j.useState({}),[g,p]=j.useState({}),[m,b]=j.useState(0),[x,_]=j.useState(!1);return j.useEffect(()=>{if(!o||a==null)return;let v=!0;return(async()=>{_(!0);try{const{data:w,error:N}=await te.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(N)throw N;const R=Array.isArray(w)?w:[];if(!v)return;u(R);const A=Array.from(new Set(R.map($=>$.producto_id))).filter(Boolean);if(A.length>0){const{data:$}=await te.from("inventario").select("id, nombre, exento").in("id",A),M={},G={};Array.isArray($)&&$.forEach(E=>{M[String(E.id)]={id:E.id,nombre:E.nombre},G[String(E.id)]=E.exento===!0||E.exento===1||String(E.exento).toLowerCase()==="true"}),v&&(h(M),p(G))}else h({});try{const{data:$}=await te.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),M=Array.isArray($)&&$.length>0?$[0]:null,G=M?Number(M.impuesto_venta):0;v&&b(G)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{v&&_(!1)}})(),()=>{v=!1}},[o,a]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),i.jsx("div",{style:{marginTop:8},children:x?i.jsx("div",{children:"Cargando..."}):i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:l.map(v=>{const w=Number(v.cantidad),N=Number(v.costo_unitario),R=w*N,A=m>1?m/100:m,$=g[String(v.producto_id)]===!0,M=$?0:R*A,G=$?R:R-M;return i.jsxs("tr",{children:[i.jsx("td",{children:d[String(v.producto_id)]?d[String(v.producto_id)].nombre:String(v.producto_id)}),i.jsx("td",{children:w.toFixed(2)}),i.jsx("td",{children:N.toFixed(2)}),i.jsx("td",{children:M.toFixed(2)}),i.jsx("td",{children:G.toFixed(2)}),i.jsx("td",{children:R.toFixed(2)})]},String(v.id))})}),i.jsx("tfoot",{children:l.length>0&&(()=>{const v=l.reduce((w,N)=>{const R=Number(N.cantidad),A=Number(N.costo_unitario),$=R*A,M=m>1?m/100:m,G=g[String(N.producto_id)]===!0,E=G?0:$*M,D=G?$:$-E;return w.subtotal+=D,w.impuesto+=E,w.total+=$,w},{subtotal:0,impuesto:0,total:0});return i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),i.jsx("td",{children:v.impuesto.toFixed(2)}),i.jsx("td",{children:v.subtotal.toFixed(2)}),i.jsx("td",{children:v.total.toFixed(2)})]})})()})]})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:r,children:"Cerrar"})})]})}):null}function o_(){const[o,a]=j.useState([]),[r,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(!1),[b,x]=j.useState(null),[_,v]=j.useState([]),[w,N]=j.useState(""),[R,A]=j.useState(""),[$,M]=j.useState(!1);async function G(){l(!0),d(null);try{let E=te.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const I=Number(w);isNaN(I)?E=E.eq("proveedor_id",w):E=E.eq("proveedor_id",I)}if(R&&(E=E.ilike("numero_documento",`%${R}%`)),$){const I=new Date(Date.now()-864e5).toISOString();E=E.gte("fecha_compra",I)}const{data:D,error:L}=await E.order("id",{ascending:!1});if(L)throw L;a(Array.isArray(D)?D:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}return j.useEffect(()=>{G()},[]),j.useEffect(()=>{let E=!0;return(async()=>{try{const{data:D}=await te.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!E)return;v(Array.isArray(D)?D:[])}catch{}})(),()=>{E=!1}},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:w,onChange:E=>N(E.target.value),children:[i.jsx("option",{value:"",children:"-- proveedor (todos) --"}),_.map(E=>i.jsx("option",{value:String(E.id),children:E.nombre},String(E.id)))]}),i.jsx("input",{className:"input",placeholder:"Nmero documento",value:R,onChange:E=>A(E.target.value)}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:$,onChange:E=>M(E.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{N(""),A(""),M(!1),G()},children:"Limpiar"})]}),i.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),i.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:r?"Cargando...":`${o.length} compras`})]})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:o.map(E=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(E.id)}),i.jsx("td",{children:String(E.proveedor_id)}),i.jsx("td",{children:E.numero_documento||""}),i.jsx("td",{children:E.fecha_compra||""}),i.jsx("td",{children:E.subtotal||""}),i.jsx("td",{children:E.impuesto||""}),i.jsx("td",{children:E.total||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{x(E.id),m(!0)},children:"Detalle"})})]},String(E.id)))})]})}),i.jsx(s_,{open:h,onClose:()=>g(!1),onCreated:()=>{g(!1),G()}}),i.jsx(l_,{open:p,compraId:b,onClose:()=>{m(!1),x(null)}})]})}function c_(){const[o,a]=j.useState([]),[r,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(null);async function b(){l(!0),d(null);try{const{data:x,error:_}=await te.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(_)throw _;a(Array.isArray(x)?x.map(v=>({id:v.id,proveedor_id:v.proveedor_id,numero_documento:v.numero_documento,usuario:v.usuario,fecha:v.created_at})):[])}catch(x){d(x?.message||String(x)),a([])}finally{l(!1)}}return j.useEffect(()=>{b()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),i.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:r?"Cargando...":`${o.length} devoluciones`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(x=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(x.id)}),i.jsx("td",{children:String(x.proveedor_id||"")}),i.jsx("td",{children:x.numero_documento||""}),i.jsx("td",{children:x.usuario||""}),i.jsx("td",{children:x.fecha||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>m(x.id),children:"Detalle"})})]},String(x.id)))})]})}),h&&i.jsx(u_,{onClose:()=>{g(!1),b()}}),p&&i.jsx(d_,{id:p,onClose:()=>{m(null),b()}})]})}function u_({onClose:o}){const[a,r]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,b]=j.useState(null),[x,_]=j.useState(null),[v,w]=j.useState(""),[N,R]=j.useState([]),[A,$]=j.useState(null),[M,G]=j.useState(1),[E,D]=j.useState(!1),[L,I]=j.useState(null);j.useEffect(()=>{(async()=>{try{const H=await te.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});r(Array.isArray(H.data)?H.data:[])}catch{}try{const H=await te.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(H.data)?H.data:[])}catch{}})()},[]);async function ce(){if(v){I(null);try{const{data:H,error:ee}=await te.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",v).limit(1).single();if(ee)throw ee;if(!H){I("No se encontr compra con ese nmero de documento");return}h(H.id),b(H.proveedor_id);try{const{data:P}=await te.from("proveedores").select("id, nombre").eq("id",H.proveedor_id).limit(1).single();P&&P.nombre&&_(P.nombre)}catch{}const{data:Y}=await te.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",H.id),C=Array.isArray(Y)?Y:[],{data:z}=await te.from("devoluciones_proveedores").select("id").eq("numero_documento",v),X=Array.isArray(z)?z.map(P=>P.id):[];let me={};if(X.length>0){const{data:P}=await te.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",X);Array.isArray(P)&&P.forEach(ie=>{const oe=String(ie.producto_id);me[oe]=(me[oe]||0)+Number(ie.cantidad)})}const K=C.map(P=>P.producto_id),{data:T}=await te.from("inventario").select("id, nombre, sku").in("id",K),B={};Array.isArray(T)&&T.forEach(P=>{B[String(P.id)]=P});const O=C.map(P=>{const ie=String(P.producto_id),oe=Number(P.cantidad),k=me[ie]||0,re=Math.max(0,oe-k);return{producto_id:ie,nombre:B[ie]?.nombre||ie,sku:B[ie]?.sku,purchased:oe,returned:k,available:re,costo_unitario:Number(P.costo_unitario||0)}});p(O),u(O.map(P=>({id:P.producto_id,nombre:P.nombre,sku:P.sku})))}catch(H){I(H?.message||String(H))}}}function ve(){if(!A){I("Selecciona un producto");return}if(!M||M<=0){I("Cantidad invlida");return}const H=l.find(Y=>Y.id===A),ee=g.find(Y=>Y.producto_id===A);if(ee&&M>ee.available){I(`Cantidad excede disponible para devolucin (${ee.available})`);return}R(Y=>[...Y,{producto_id:A,nombre:H?.nombre,cantidad:M}]),$(null),G(1),I(null),ee&&(p(Y=>Y.map(C=>C.producto_id===ee.producto_id?{...C,available:Math.max(0,C.available-M)}:C)),u(Y=>Y.map(C=>(C.id===ee.producto_id,C))))}function Z(H){R(ee=>ee.filter((Y,C)=>C!==H))}async function de(){if(I(null),!m){I("Selecciona un proveedor");return}if(N.length===0){I("Agrega al menos un producto");return}D(!0);try{const H={proveedor_id:m,numero_documento:v||null,usuario:null},ee=await te.from("devoluciones_proveedores").insert(H).select("id").single();if(ee.error)throw ee.error;const Y=ee.data.id;try{const C=N.map(X=>({devolucion_id:Y,producto_id:X.producto_id,cantidad:X.cantidad})),z=await te.from("devoluciones_proveedores_detalle").insert(C);z.error&&console.warn("No se pudo insertar detalles de devolucin",z.error)}catch(C){console.warn("Detalles tabla puede no existir",C)}try{const C=v?`Devolucin - ${v}`:`Devolucin ${Y}`;let z="sistema";try{const T=localStorage.getItem("user");if(T){const B=JSON.parse(T);z=B.username?`${B.username}${B.role?` (${B.role})`:""}`:String(B)}}catch{}const X=new Date().toISOString(),me=N.map(T=>({producto_id:T.producto_id,cantidad:T.cantidad,tipo_de_movimiento:"SALIDA",referencia:C,usuario:z,fecha_salida:X})),K=await te.from("registro_de_inventario").insert(me);K.error&&(console.warn("Error registrando en registro_de_inventario",K.error),I("Devolucin guardada, pero fall el registro en inventario: "+K.error.message))}catch(C){console.warn("Registro inventario fallo",C)}o()}catch(H){I(H?.message||String(H))}finally{D(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?i.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:x||String(m||"")}):i.jsxs("select",{className:"input",value:m??"",onChange:H=>b(H.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(H=>i.jsx("option",{value:H.id,children:H.nombre},String(H.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{className:"input",value:v,onChange:H=>w(H.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>ce(),children:"Buscar compra"})]}),d&&i.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&i.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[i.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[i.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Comprado"}),i.jsx("th",{children:"Devuelto"}),i.jsx("th",{children:"Disponible"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:g.map(H=>i.jsxs("tr",{children:[i.jsx("td",{children:H.nombre}),i.jsx("td",{style:{textAlign:"right"},children:Number(H.purchased).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(H.returned).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(H.available).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>{$(H.producto_id),G(H.available||1)},children:"Usar"})})]},H.producto_id))})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:A??"",onChange:H=>$(H.target.value||null),disabled:!!d,children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(H=>i.jsx("option",{value:H.id,children:H.nombre},H.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:H=>{const ee=Number(H.target.value),Y=g.find(C=>C.producto_id===A);if(Y){const C=Number(Y.available||0);return isNaN(ee)||ee<1?G(1):ee>C?G(C):G(ee)}G(ee)},min:1,max:A?g.find(H=>H.producto_id===A)?.available??void 0:void 0,disabled:(()=>{const H=g.find(ee=>ee.producto_id===A);return!!H&&Number(H.available||0)<=1})()}),i.jsx("button",{className:"btn-primary",onClick:ve,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:N.map((H,ee)=>i.jsxs("tr",{children:[i.jsx("td",{children:H.nombre}),i.jsx("td",{style:{textAlign:"right"},children:H.cantidad}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>Z(ee),children:"Quitar"})})]},`${H.producto_id}-${ee}`))})]})})]})]}),L&&i.jsx("div",{style:{color:"red",marginTop:12},children:L}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:o,disabled:E,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:de,disabled:E,children:E?"Guardando...":"Registrar devolucin"})]})]})})}function d_({id:o,onClose:a}){const[r,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:b}=await te.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(b)throw b;const x=Array.isArray(m)?m:[];if(x.length>0){const _=x.map(N=>N.producto_id),{data:v}=await te.from("inventario").select("id, nombre, sku").in("id",_),w={};Array.isArray(v)&&v.forEach(N=>{w[String(N.id)]=N}),l(x.map(N=>({producto:w[String(N.producto_id)]?.nombre||String(N.producto_id),cantidad:N.cantidad})))}else{const{data:_}=await te.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),v=Array.isArray(_)?_:[],w=v.map(A=>A.producto_id),{data:N}=await te.from("inventario").select("id, nombre, sku").in("id",w),R={};Array.isArray(N)&&N.forEach(A=>{R[String(A.id)]=A}),l(v.map(A=>({producto:R[String(A.producto_id)]?.nombre||String(A.producto_id),cantidad:A.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return j.useEffect(()=>{p()},[o]),i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&i.jsx("div",{children:"Cargando..."}),h&&i.jsx("div",{style:{color:"red"},children:h}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"})]})}),i.jsx("tbody",{children:r.map((m,b)=>i.jsxs("tr",{children:[i.jsx("td",{children:m.producto}),i.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},b))})]}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const f_={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function h_(){const[o,a]=j.useState([]),[r,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(null),[p,m]=j.useState(null),b=async()=>{l(!0),m(null);try{const{data:v,error:w}=await te.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando impuestos:",v),m(String(v.message||v))}finally{l(!1)}};j.useEffect(()=>{b()},[]);const x=(v,w)=>{a(N=>N.map(R=>R.id===v?{...R,impuesto_venta:w}:R))},_=async v=>{const w=o.find(N=>N.id===v);if(w){d(v),m(null);try{const N={impuesto_venta:w.impuesto_venta??null},{error:R}=await te.from("impuesto").update(N).eq("id",v);if(R)throw R;await b()}catch(N){console.warn("Error guardando impuesto:",N),m(String(N.message||N))}finally{d(null)}}};return i.jsxs("div",{children:[i.jsx("h2",{children:"Impuestos"}),i.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),r?i.jsx("div",{children:"Cargando..."}):i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(v=>i.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:f_[v.id]??`Impuesto #${v.id}`}),i.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",v.id]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),i.jsx("input",{type:"text",value:v.impuesto_venta??"",onChange:w=>x(v.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:h!==v.id}),i.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:h===v.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[i.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===v.id?"Guardando...":""}),i.jsx("div",{style:{display:"flex",gap:8},children:h===v.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{g(null),b()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:()=>_(v.id),className:"btn-opaque",disabled:u===v.id,style:{opacity:u===v.id?.6:1},children:"Guardar"})]}):i.jsx("button",{onClick:()=>g(v.id),className:"btn-opaque",children:"Actualizar"})})]})]},v.id)),o.length===0&&i.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&i.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const g_={dashboard:Sx,datos:Cx,usuarios_internal:Ax,usuarios_web:Tx,cai:Ox,facturas:kx,historial_facturas:zx,inventario_productos:qx,precios_productos:$x,precios_historico:Px,stock:Vx,inventario_salidas:Gx,inventario_categorias:Fx,proveedores:r_,caja_sesiones:Kx,caja_movimientos:Yx,rep_ventas:Jx,rep_devoluciones:Qx,rep_ingresos_egresos:Xx,rep_compras:Zx,compras_main:o_,devoluciones_proveedores:c_,rep_export:Wx,cuentas_contables:e_,libro_diario:t_,auditoria:n_,impuestos:h_};function p_({onLogout:o}){const[a,r]=j.useState("dashboard"),[l,u]=j.useState(null),[d,h]=j.useState({}),g=l||a,p=g_[g],b=(_=>{for(const v of fp){if(v.id===_)return v.label;if(v.children){const w=v.children.find(N=>N.id===_);if(w)return w.label}}return"Panel de Administracin"})(g),x=_=>{if(_.id==="salir")return o();_.children&&_.children.length>0?(h(v=>({...v,[_.id]:!v[_.id]})),(_.id!==a||!l)&&(r(_.id),u(_.children[0].id))):(r(_.id),u(null))};return i.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[i.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[i.jsx("strong",{children:"Panel Admin"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),i.jsx("nav",{children:fp.map(_=>i.jsxs("div",{style:{marginBottom:6},children:[i.jsxs("div",{onClick:()=>x(_),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===_.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[i.jsx("span",{children:_.label}),Array.isArray(_.children)&&_.children.length>0?i.jsx("span",{style:{marginLeft:8},children:d[_.id]?"":""}):null]}),Array.isArray(_.children)&&_.children.length>0&&d[_.id]&&i.jsx("div",{style:{marginLeft:12,marginTop:6},children:_.children.map(v=>i.jsx("div",{onClick:()=>{r(_.id),u(v.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===v.id?"#e2e8f0":"#cbd5e1",background:l===v.id?"rgba(255,255,255,0.04)":"transparent"},children:v.label},v.id))})]},_.id))})]}),i.jsx("main",{style:{flex:1,padding:24},children:p?i.jsx(p,{}):i.jsx(jx,{title:b,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function m_(){const[o,a]=j.useState(null);j.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]),j.useEffect(()=>{let u=!0;return(async()=>{try{const d=await xs();if(!u||!d)return;const h=d.nombre||d.comercio||d.name||"";h&&(document.title=String(h));const g=d.logoUrl||d.logo||null;if(g)try{let p=document.querySelector("link[rel~='icon']");p||(p=document.createElement("link"),p.rel="icon",document.getElementsByTagName("head")[0].appendChild(p)),p.href=String(g)}catch{}}catch{}})(),()=>{u=!1}},[]);function r(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return i.jsxs("div",{children:[!o&&i.jsx(K0,{onLogin:r}),o&&o.role==="cajero"&&i.jsx(yx,{onLogout:l}),o&&o.role==="admin"&&i.jsx(p_,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&i.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[i.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),i.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',i.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),i.jsx("div",{style:{marginTop:18},children:i.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class y_ extends Wl.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,r){console.error("ErrorBoundary caught:",a,r),this.setState({error:a,info:r})}render(){return this.state.error?i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[i.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}wb.createRoot(document.getElementById("root")).render(i.jsx(y_,{children:i.jsx(m_,{})}));
