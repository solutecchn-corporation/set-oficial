function uv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function op(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function dv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var Zc={exports:{}},Wr={};var xg;function hv(){if(xg)return Wr;xg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var f=null;if(d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:f,ref:u!==void 0?u:null,props:d}}return Wr.Fragment=a,Wr.jsx=s,Wr.jsxs=s,Wr}var jg;function fv(){return jg||(jg=1,Zc.exports=hv()),Zc.exports}var r=fv(),Wc={exports:{}},es={},eu={exports:{}},tu={};var Sg;function gv(){return Sg||(Sg=1,(function(o){function a(C,U){var F=C.length;C.push(U);e:for(;0<F;){var ce=F-1>>>1,_e=C[ce];if(0<u(_e,U))C[ce]=U,C[F]=_e,F=ce;else break e}}function s(C){return C.length===0?null:C[0]}function l(C){if(C.length===0)return null;var U=C[0],F=C.pop();if(F!==U){C[0]=F;e:for(var ce=0,_e=C.length,O=_e>>>1;ce<O;){var z=2*(ce+1)-1,K=C[z],J=z+1,re=C[J];if(0>u(K,F))J<_e&&0>u(re,K)?(C[ce]=re,C[J]=F,ce=J):(C[ce]=K,C[z]=F,ce=z);else if(J<_e&&0>u(re,F))C[ce]=re,C[J]=F,ce=J;else break e}}return U}function u(C,U){var F=C.sortIndex-U.sortIndex;return F!==0?F:C.id-U.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var f=Date,g=f.now();o.unstable_now=function(){return f.now()-g}}var p=[],m=[],v=1,x=null,S=3,b=!1,w=!1,A=!1,N=!1,T=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function G(C){for(var U=s(m);U!==null;){if(U.callback===null)l(m);else if(U.startTime<=C)l(m),U.sortIndex=U.expirationTime,a(p,U);else break;U=s(m)}}function E(C){if(A=!1,G(C),!w)if(s(p)!==null)w=!0,L||(L=!0,me());else{var U=s(m);U!==null&&ie(E,U.startTime-C)}}var L=!1,D=-1,V=5,ge=-1;function Q(){return N?!0:!(o.unstable_now()-ge<V)}function de(){if(N=!1,L){var C=o.unstable_now();ge=C;var U=!0;try{e:{w=!1,A&&(A=!1,M(D),D=-1),b=!0;var F=S;try{t:{for(G(C),x=s(p);x!==null&&!(x.expirationTime>C&&Q());){var ce=x.callback;if(typeof ce=="function"){x.callback=null,S=x.priorityLevel;var _e=ce(x.expirationTime<=C);if(C=o.unstable_now(),typeof _e=="function"){x.callback=_e,G(C),U=!0;break t}x===s(p)&&l(p),G(C)}else l(p);x=s(p)}if(x!==null)U=!0;else{var O=s(m);O!==null&&ie(E,O.startTime-C),U=!1}}break e}finally{x=null,S=F,b=!1}U=void 0}}finally{U?me():L=!1}}}var me;if(typeof B=="function")me=function(){B(de)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,W=q.port2;q.port1.onmessage=de,me=function(){W.postMessage(null)}}else me=function(){T(de,0)};function ie(C,U){D=T(function(){C(o.unstable_now())},U)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(C){C.callback=null},o.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<C?Math.floor(1e3/C):5},o.unstable_getCurrentPriorityLevel=function(){return S},o.unstable_next=function(C){switch(S){case 1:case 2:case 3:var U=3;break;default:U=S}var F=S;S=U;try{return C()}finally{S=F}},o.unstable_requestPaint=function(){N=!0},o.unstable_runWithPriority=function(C,U){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var F=S;S=C;try{return U()}finally{S=F}},o.unstable_scheduleCallback=function(C,U,F){var ce=o.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?ce+F:ce):F=ce,C){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=F+_e,C={id:v++,callback:U,priorityLevel:C,startTime:F,expirationTime:_e,sortIndex:-1},F>ce?(C.sortIndex=F,a(m,C),s(p)===null&&C===s(m)&&(A?(M(D),D=-1):A=!0,ie(E,F-ce))):(C.sortIndex=_e,a(p,C),w||b||(w=!0,L||(L=!0,me()))),C},o.unstable_shouldYield=Q,o.unstable_wrapCallback=function(C){var U=S;return function(){var F=S;S=U;try{return C.apply(this,arguments)}finally{S=F}}}})(tu)),tu}var wg;function pv(){return wg||(wg=1,eu.exports=gv()),eu.exports}var nu={exports:{}},ke={};var Eg;function mv(){if(Eg)return ke;Eg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),S=Symbol.iterator;function b(O){return O===null||typeof O!="object"?null:(O=S&&O[S]||O["@@iterator"],typeof O=="function"?O:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,N={};function T(O,z,K){this.props=O,this.context=z,this.refs=N,this.updater=K||w}T.prototype.isReactComponent={},T.prototype.setState=function(O,z){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,z,"setState")},T.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function M(){}M.prototype=T.prototype;function B(O,z,K){this.props=O,this.context=z,this.refs=N,this.updater=K||w}var G=B.prototype=new M;G.constructor=B,A(G,T.prototype),G.isPureReactComponent=!0;var E=Array.isArray;function L(){}var D={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function ge(O,z,K){var J=K.ref;return{$$typeof:o,type:O,key:z,ref:J!==void 0?J:null,props:K}}function Q(O,z){return ge(O.type,z,O.props)}function de(O){return typeof O=="object"&&O!==null&&O.$$typeof===o}function me(O){var z={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(K){return z[K]})}var q=/\/+/g;function W(O,z){return typeof O=="object"&&O!==null&&O.key!=null?me(""+O.key):z.toString(36)}function ie(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(L,L):(O.status="pending",O.then(function(z){O.status==="pending"&&(O.status="fulfilled",O.value=z)},function(z){O.status==="pending"&&(O.status="rejected",O.reason=z)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function C(O,z,K,J,re){var ae=typeof O;(ae==="undefined"||ae==="boolean")&&(O=null);var fe=!1;if(O===null)fe=!0;else switch(ae){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(O.$$typeof){case o:case a:fe=!0;break;case v:return fe=O._init,C(fe(O._payload),z,K,J,re)}}if(fe)return re=re(O),fe=J===""?"."+W(O,0):J,E(re)?(K="",fe!=null&&(K=fe.replace(q,"$&/")+"/"),C(re,z,K,"",function(Ue){return Ue})):re!=null&&(de(re)&&(re=Q(re,K+(re.key==null||O&&O.key===re.key?"":(""+re.key).replace(q,"$&/")+"/")+fe)),z.push(re)),1;fe=0;var he=J===""?".":J+":";if(E(O))for(var xe=0;xe<O.length;xe++)J=O[xe],ae=he+W(J,xe),fe+=C(J,z,K,ae,re);else if(xe=b(O),typeof xe=="function")for(O=xe.call(O),xe=0;!(J=O.next()).done;)J=J.value,ae=he+W(J,xe++),fe+=C(J,z,K,ae,re);else if(ae==="object"){if(typeof O.then=="function")return C(ie(O),z,K,J,re);throw z=String(O),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return fe}function U(O,z,K){if(O==null)return O;var J=[],re=0;return C(O,J,"","",function(ae){return z.call(K,ae,re++)}),J}function F(O){if(O._status===-1){var z=O._result;z=z(),z.then(function(K){(O._status===0||O._status===-1)&&(O._status=1,O._result=K)},function(K){(O._status===0||O._status===-1)&&(O._status=2,O._result=K)}),O._status===-1&&(O._status=0,O._result=z)}if(O._status===1)return O._result.default;throw O._result}var ce=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},_e={map:U,forEach:function(O,z,K){U(O,function(){z.apply(this,arguments)},K)},count:function(O){var z=0;return U(O,function(){z++}),z},toArray:function(O){return U(O,function(z){return z})||[]},only:function(O){if(!de(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return ke.Activity=x,ke.Children=_e,ke.Component=T,ke.Fragment=s,ke.Profiler=u,ke.PureComponent=B,ke.StrictMode=l,ke.Suspense=p,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,ke.__COMPILER_RUNTIME={__proto__:null,c:function(O){return D.H.useMemoCache(O)}},ke.cache=function(O){return function(){return O.apply(null,arguments)}},ke.cacheSignal=function(){return null},ke.cloneElement=function(O,z,K){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var J=A({},O.props),re=O.key;if(z!=null)for(ae in z.key!==void 0&&(re=""+z.key),z)!V.call(z,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&z.ref===void 0||(J[ae]=z[ae]);var ae=arguments.length-2;if(ae===1)J.children=K;else if(1<ae){for(var fe=Array(ae),he=0;he<ae;he++)fe[he]=arguments[he+2];J.children=fe}return ge(O.type,re,J)},ke.createContext=function(O){return O={$$typeof:f,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:d,_context:O},O},ke.createElement=function(O,z,K){var J,re={},ae=null;if(z!=null)for(J in z.key!==void 0&&(ae=""+z.key),z)V.call(z,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(re[J]=z[J]);var fe=arguments.length-2;if(fe===1)re.children=K;else if(1<fe){for(var he=Array(fe),xe=0;xe<fe;xe++)he[xe]=arguments[xe+2];re.children=he}if(O&&O.defaultProps)for(J in fe=O.defaultProps,fe)re[J]===void 0&&(re[J]=fe[J]);return ge(O,ae,re)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(O){return{$$typeof:g,render:O}},ke.isValidElement=de,ke.lazy=function(O){return{$$typeof:v,_payload:{_status:-1,_result:O},_init:F}},ke.memo=function(O,z){return{$$typeof:m,type:O,compare:z===void 0?null:z}},ke.startTransition=function(O){var z=D.T,K={};D.T=K;try{var J=O(),re=D.S;re!==null&&re(K,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(L,ce)}catch(ae){ce(ae)}finally{z!==null&&K.types!==null&&(z.types=K.types),D.T=z}},ke.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},ke.use=function(O){return D.H.use(O)},ke.useActionState=function(O,z,K){return D.H.useActionState(O,z,K)},ke.useCallback=function(O,z){return D.H.useCallback(O,z)},ke.useContext=function(O){return D.H.useContext(O)},ke.useDebugValue=function(){},ke.useDeferredValue=function(O,z){return D.H.useDeferredValue(O,z)},ke.useEffect=function(O,z){return D.H.useEffect(O,z)},ke.useEffectEvent=function(O){return D.H.useEffectEvent(O)},ke.useId=function(){return D.H.useId()},ke.useImperativeHandle=function(O,z,K){return D.H.useImperativeHandle(O,z,K)},ke.useInsertionEffect=function(O,z){return D.H.useInsertionEffect(O,z)},ke.useLayoutEffect=function(O,z){return D.H.useLayoutEffect(O,z)},ke.useMemo=function(O,z){return D.H.useMemo(O,z)},ke.useOptimistic=function(O,z){return D.H.useOptimistic(O,z)},ke.useReducer=function(O,z,K){return D.H.useReducer(O,z,K)},ke.useRef=function(O){return D.H.useRef(O)},ke.useState=function(O){return D.H.useState(O)},ke.useSyncExternalStore=function(O,z,K){return D.H.useSyncExternalStore(O,z,K)},ke.useTransition=function(){return D.H.useTransition()},ke.version="19.2.0",ke}var Cg;function Cu(){return Cg||(Cg=1,nu.exports=mv()),nu.exports}var au={exports:{}},Ht={};var Tg;function yv(){if(Tg)return Ht;Tg=1;var o=Cu();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:x==null?null:""+x,children:p,containerInfo:m,implementation:v}}var f=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Ht.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Ht.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},Ht.flushSync=function(p){var m=f.T,v=l.p;try{if(f.T=null,l.p=2,p)return p()}finally{f.T=m,l.p=v,l.d.f()}},Ht.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},Ht.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Ht.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin),S=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:S,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:x,integrity:S,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Ht.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},Ht.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Ht.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},Ht.requestFormReset=function(p){l.d.r(p)},Ht.unstable_batchedUpdates=function(p,m){return p(m)},Ht.useFormState=function(p,m,v){return f.H.useFormState(p,m,v)},Ht.useFormStatus=function(){return f.H.useHostTransitionStatus()},Ht.version="19.2.0",Ht}var Ag;function cp(){if(Ag)return au.exports;Ag=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),au.exports=yv(),au.exports}var Og;function vv(){if(Og)return es;Og=1;var o=pv(),a=Cu(),s=cp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,i=t;;){var c=n.return;if(c===null)break;var h=c.alternate;if(h===null){if(i=c.return,i!==null){n=i;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===n)return p(c),e;if(h===i)return p(c),t;h=h.sibling}throw Error(l(188))}if(n.return!==i.return)n=c,i=h;else{for(var y=!1,_=c.child;_;){if(_===n){y=!0,n=c,i=h;break}if(_===i){y=!0,i=c,n=h;break}_=_.sibling}if(!y){for(_=h.child;_;){if(_===n){y=!0,n=h,i=c;break}if(_===i){y=!0,i=h,n=c;break}_=_.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==i)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,S=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),B=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),ge=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),de=Symbol.iterator;function me(e){return e===null||typeof e!="object"?null:(e=de&&e[de]||e["@@iterator"],typeof e=="function"?e:null)}var q=Symbol.for("react.client.reference");function W(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case A:return"Fragment";case T:return"Profiler";case N:return"StrictMode";case E:return"Suspense";case L:return"SuspenseList";case ge:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case B:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case D:return t=e.displayName||null,t!==null?t:W(e.type)||"Memo";case V:t=e._payload,e=e._init;try{return W(e(t))}catch{}}return null}var ie=Array.isArray,C=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F={pending:!1,data:null,method:null,action:null},ce=[],_e=-1;function O(e){return{current:e}}function z(e){0>_e||(e.current=ce[_e],ce[_e]=null,_e--)}function K(e,t){_e++,ce[_e]=e.current,e.current=t}var J=O(null),re=O(null),ae=O(null),fe=O(null);function he(e,t){switch(K(ae,t),K(re,e),K(J,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Pf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Pf(t),e=Gf(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(J),K(J,e)}function xe(){z(J),z(re),z(ae)}function Ue(e){e.memoizedState!==null&&K(fe,e);var t=J.current,n=Gf(t,e.type);t!==n&&(K(re,e),K(J,n))}function Pe(e){re.current===e&&(z(J),z(re)),fe.current===e&&(z(fe),Qr._currentValue=F)}var ze,De;function Xe(e){if(ze===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ze=t&&t[1]||"",De=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ze+e+De}var gt=!1;function qt(e,t){if(!e||gt)return"";gt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(X){var Y=X}Reflect.construct(e,[],se)}else{try{se.call()}catch(X){Y=X}e.call(se.prototype)}}else{try{throw Error()}catch(X){Y=X}(se=e())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(X){if(X&&Y&&typeof X.stack=="string")return[X.stack,Y.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=i.DetermineComponentFrameRoot(),y=h[0],_=h[1];if(y&&_){var R=y.split(`
`),P=_.split(`
`);for(c=i=0;i<R.length&&!R[i].includes("DetermineComponentFrameRoot");)i++;for(;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;if(i===R.length||c===P.length)for(i=R.length-1,c=P.length-1;1<=i&&0<=c&&R[i]!==P[c];)c--;for(;1<=i&&0<=c;i--,c--)if(R[i]!==P[c]){if(i!==1||c!==1)do if(i--,c--,0>c||R[i]!==P[c]){var ee=`
`+R[i].replace(" at new "," at ");return e.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",e.displayName)),ee}while(1<=i&&0<=c);break}}}finally{gt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Xe(n):""}function Tt(e,t){switch(e.tag){case 26:case 27:case 5:return Xe(e.type);case 16:return Xe("Lazy");case 13:return e.child!==t&&t!==null?Xe("Suspense Fallback"):Xe("Suspense");case 19:return Xe("SuspenseList");case 0:case 15:return qt(e.type,!1);case 11:return qt(e.type.render,!1);case 1:return qt(e.type,!0);case 31:return Xe("Activity");default:return""}}function Yt(e){try{var t="",n=null;do t+=Tt(e,n),n=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var Vn=Object.prototype.hasOwnProperty,st=o.unstable_scheduleCallback,ht=o.unstable_cancelCallback,Un=o.unstable_shouldYield,Hl=o.unstable_requestPaint,Rt=o.unstable_now,Vl=o.unstable_getCurrentPriorityLevel,hi=o.unstable_ImmediatePriority,os=o.unstable_UserBlockingPriority,Ma=o.unstable_NormalPriority,$l=o.unstable_LowPriority,cs=o.unstable_IdlePriority,Pl=o.log,fi=o.unstable_setDisableYieldValue,qa=null,$t=null;function zn(e){if(typeof Pl=="function"&&fi(e),$t&&typeof $t.setStrictMode=="function")try{$t.setStrictMode(qa,e)}catch{}}var Pt=Math.clz32?Math.clz32:ds,Gl=Math.log,us=Math.LN2;function ds(e){return e>>>=0,e===0?32:31-(Gl(e)/us|0)|0}var gi=256,dn=262144,hn=4194304;function Dn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function pi(e,t,n){var i=e.pendingLanes;if(i===0)return 0;var c=0,h=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var _=i&134217727;return _!==0?(i=_&~h,i!==0?c=Dn(i):(y&=_,y!==0?c=Dn(y):n||(n=_&~e,n!==0&&(c=Dn(n))))):(_=i&~h,_!==0?c=Dn(_):y!==0?c=Dn(y):n||(n=i&~e,n!==0&&(c=Dn(n)))),c===0?0:t!==0&&t!==c&&(t&h)===0&&(h=c&-c,n=t&-t,h>=n||h===32&&(n&4194048)!==0)?t:c}function La(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function lr(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hs(){var e=hn;return hn<<=1,(hn&62914560)===0&&(hn=4194304),e}function Ia(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function En(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Kl(e,t,n,i,c,h){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var _=e.entanglements,R=e.expirationTimes,P=e.hiddenUpdates;for(n=y&~n;0<n;){var ee=31-Pt(n),se=1<<ee;_[ee]=0,R[ee]=-1;var Y=P[ee];if(Y!==null)for(P[ee]=null,ee=0;ee<Y.length;ee++){var X=Y[ee];X!==null&&(X.lane&=-536870913)}n&=~se}i!==0&&fs(e,i,0),h!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=h&~(y&~t))}function fs(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-Pt(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&261930}function gs(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Pt(n),c=1<<i;c&t|e[i]&t&&(e[i]|=t),n&=~c}}function or(e,t){var n=t&-t;return n=(n&42)!==0?1:cr(n),(n&(e.suspendedLanes|t))!==0?0:n}function cr(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ha(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function Bn(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:gg(e.type))}function ps(e,t){var n=U.p;try{return U.p=e,t()}finally{U.p=n}}var Cn=Math.random().toString(36).slice(2),xt="__reactFiber$"+Cn,Lt="__reactProps$"+Cn,oa="__reactContainer$"+Cn,ur="__reactEvents$"+Cn,H="__reactListeners$"+Cn,te="__reactHandles$"+Cn,ye="__reactResources$"+Cn,oe="__reactMarker$"+Cn;function ve(e){delete e[xt],delete e[Lt],delete e[ur],delete e[H],delete e[te]}function be(e){var t=e[xt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[oa]||n[xt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Zf(e);e!==null;){if(n=e[xt])return n;e=Zf(e)}return t}e=n,n=e.parentNode}return null}function pe(e){if(e=e[xt]||e[oa]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function Te(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function ue(e){var t=e[ye];return t||(t=e[ye]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function le(e){e[oe]=!0}var Re=new Set,Be={};function Ie(e,t){Gt(e,t),Gt(e+"Capture",t)}function Gt(e,t){for(Be[e]=t,e=0;e<t.length;e++)Re.add(t[e])}var lt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ot={},ct={};function $n(e){return Vn.call(ct,e)?!0:Vn.call(ot,e)?!1:lt.test(e)?ct[e]=!0:(ot[e]=!0,!1)}function Jt(e,t,n){if($n(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function ca(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function fn(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function It(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ua(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mn(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,h=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,h.call(this,y)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ne(e){if(!e._valueTracker){var t=ua(e)?"checked":"value";e._valueTracker=Mn(e,t,""+e[t])}}function at(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=ua(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function vt(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var qe=/[\n"\\]/g;function He(e){return e.replace(qe,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function kt(e,t,n,i,c,h,y,_){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+It(t)):e.value!==""+It(t)&&(e.value=""+It(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?mi(e,y,It(t)):n!=null?mi(e,y,It(n)):i!=null&&e.removeAttribute("value"),c==null&&h!=null&&(e.defaultChecked=!!h),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?e.name=""+It(_):e.removeAttribute("name")}function dr(e,t,n,i,c,h,y,_){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||n!=null){if(!(h!=="submit"&&h!=="reset"||t!=null)){Ne(e);return}n=n!=null?""+It(n):"",t=t!=null?""+It(t):n,_||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=_?e.checked:!!i,e.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Ne(e)}function mi(e,t,n){t==="number"&&vt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function yi(e,t,n,i){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&i&&(e[n].defaultSelected=!0)}else{for(n=""+It(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function qu(e,t,n){if(t!=null&&(t=""+It(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+It(n):""}function Lu(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(l(92));if(ie(i)){if(1<i.length)throw Error(l(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=It(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i),Ne(e)}function vi(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var rm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Iu(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||rm.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Hu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&n[c]!==i&&Iu(e,c,i)}else for(var h in t)t.hasOwnProperty(h)&&Iu(e,h,t[h])}function Yl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(e){return lm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pn(){}var Jl=null;function Ql(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var bi=null,_i=null;function Vu(e){var t=pe(e);if(t&&(e=t.stateNode)){var n=e[Lt]||null;e:switch(e=t.stateNode,t.type){case"input":if(kt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+He(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var c=i[Lt]||null;if(!c)throw Error(l(90));kt(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&at(i)}break e;case"textarea":qu(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&yi(e,!!n.multiple,t,!1)}}}var Xl=!1;function $u(e,t,n){if(Xl)return e(t,n);Xl=!0;try{var i=e(t);return i}finally{if(Xl=!1,(bi!==null||_i!==null)&&(al(),bi&&(t=bi,e=_i,_i=bi=null,Vu(t),e)))for(t=0;t<e.length;t++)Vu(e[t])}}function hr(e,t){var n=e.stateNode;if(n===null)return null;var i=n[Lt]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fl=!1;if(Gn)try{var fr={};Object.defineProperty(fr,"passive",{get:function(){Fl=!0}}),window.addEventListener("test",fr,fr),window.removeEventListener("test",fr,fr)}catch{Fl=!1}var da=null,Zl=null,ys=null;function Pu(){if(ys)return ys;var e,t=Zl,n=t.length,i,c="value"in da?da.value:da.textContent,h=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(i=1;i<=y&&t[n-i]===c[h-i];i++);return ys=c.slice(e,1<i?1-i:void 0)}function vs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bs(){return!0}function Gu(){return!1}function Qt(e){function t(n,i,c,h,y){this._reactName=n,this._targetInst=c,this.type=i,this.nativeEvent=h,this.target=y,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(n=e[_],this[_]=n?n(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?bs:Gu,this.isPropagationStopped=Gu,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),t}var Va={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_s=Qt(Va),gr=x({},Va,{view:0,detail:0}),om=Qt(gr),Wl,eo,pr,xs=x({},gr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:no,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pr&&(pr&&e.type==="mousemove"?(Wl=e.screenX-pr.screenX,eo=e.screenY-pr.screenY):eo=Wl=0,pr=e),Wl)},movementY:function(e){return"movementY"in e?e.movementY:eo}}),Ku=Qt(xs),cm=x({},xs,{dataTransfer:0}),um=Qt(cm),dm=x({},gr,{relatedTarget:0}),to=Qt(dm),hm=x({},Va,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=Qt(hm),gm=x({},Va,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pm=Qt(gm),mm=x({},Va,{data:0}),Yu=Qt(mm),ym={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _m(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bm[e])?!!t[e]:!1}function no(){return _m}var xm=x({},gr,{key:function(e){if(e.key){var t=ym[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:no,charCode:function(e){return e.type==="keypress"?vs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jm=Qt(xm),Sm=x({},xs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ju=Qt(Sm),wm=x({},gr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:no}),Em=Qt(wm),Cm=x({},Va,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tm=Qt(Cm),Am=x({},xs,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Om=Qt(Am),Nm=x({},Va,{newState:0,oldState:0}),Rm=Qt(Nm),km=[9,13,27,32],ao=Gn&&"CompositionEvent"in window,mr=null;Gn&&"documentMode"in document&&(mr=document.documentMode);var Um=Gn&&"TextEvent"in window&&!mr,Qu=Gn&&(!ao||mr&&8<mr&&11>=mr),Xu=" ",Fu=!1;function Zu(e,t){switch(e){case"keyup":return km.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xi=!1;function zm(e,t){switch(e){case"compositionend":return Wu(t);case"keypress":return t.which!==32?null:(Fu=!0,Xu);case"textInput":return e=t.data,e===Xu&&Fu?null:e;default:return null}}function Dm(e,t){if(xi)return e==="compositionend"||!ao&&Zu(e,t)?(e=Pu(),ys=Zl=da=null,xi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qu&&t.locale!=="ko"?null:t.data;default:return null}}var Bm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ed(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bm[e.type]:t==="textarea"}function td(e,t,n,i){bi?_i?_i.push(i):_i=[i]:bi=i,t=ul(t,"onChange"),0<t.length&&(n=new _s("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var yr=null,vr=null;function Mm(e){qf(e,0)}function js(e){var t=Te(e);if(at(t))return e}function nd(e,t){if(e==="change")return t}var ad=!1;if(Gn){var io;if(Gn){var ro="oninput"in document;if(!ro){var id=document.createElement("div");id.setAttribute("oninput","return;"),ro=typeof id.oninput=="function"}io=ro}else io=!1;ad=io&&(!document.documentMode||9<document.documentMode)}function rd(){yr&&(yr.detachEvent("onpropertychange",sd),vr=yr=null)}function sd(e){if(e.propertyName==="value"&&js(vr)){var t=[];td(t,vr,e,Ql(e)),$u(Mm,t)}}function qm(e,t,n){e==="focusin"?(rd(),yr=t,vr=n,yr.attachEvent("onpropertychange",sd)):e==="focusout"&&rd()}function Lm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return js(vr)}function Im(e,t){if(e==="click")return js(t)}function Hm(e,t){if(e==="input"||e==="change")return js(t)}function Vm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tn=typeof Object.is=="function"?Object.is:Vm;function br(e,t){if(tn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var c=n[i];if(!Vn.call(t,c)||!tn(e[c],t[c]))return!1}return!0}function ld(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function od(e,t){var n=ld(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ld(n)}}function cd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ud(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=vt(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=vt(e.document)}return t}function so(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var $m=Gn&&"documentMode"in document&&11>=document.documentMode,ji=null,lo=null,_r=null,oo=!1;function dd(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;oo||ji==null||ji!==vt(i)||(i=ji,"selectionStart"in i&&so(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),_r&&br(_r,i)||(_r=i,i=ul(lo,"onSelect"),0<i.length&&(t=new _s("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=ji)))}function $a(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Si={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionrun:$a("Transition","TransitionRun"),transitionstart:$a("Transition","TransitionStart"),transitioncancel:$a("Transition","TransitionCancel"),transitionend:$a("Transition","TransitionEnd")},co={},hd={};Gn&&(hd=document.createElement("div").style,"AnimationEvent"in window||(delete Si.animationend.animation,delete Si.animationiteration.animation,delete Si.animationstart.animation),"TransitionEvent"in window||delete Si.transitionend.transition);function Pa(e){if(co[e])return co[e];if(!Si[e])return e;var t=Si[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in hd)return co[e]=t[n];return e}var fd=Pa("animationend"),gd=Pa("animationiteration"),pd=Pa("animationstart"),Pm=Pa("transitionrun"),Gm=Pa("transitionstart"),Km=Pa("transitioncancel"),md=Pa("transitionend"),yd=new Map,uo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");uo.push("scrollEnd");function Tn(e,t){yd.set(e,t),Ie(t,[e])}var Ss=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},gn=[],wi=0,ho=0;function ws(){for(var e=wi,t=ho=wi=0;t<e;){var n=gn[t];gn[t++]=null;var i=gn[t];gn[t++]=null;var c=gn[t];gn[t++]=null;var h=gn[t];if(gn[t++]=null,i!==null&&c!==null){var y=i.pending;y===null?c.next=c:(c.next=y.next,y.next=c),i.pending=c}h!==0&&vd(n,c,h)}}function Es(e,t,n,i){gn[wi++]=e,gn[wi++]=t,gn[wi++]=n,gn[wi++]=i,ho|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function fo(e,t,n,i){return Es(e,t,n,i),Cs(e)}function Ga(e,t){return Es(e,null,null,t),Cs(e)}function vd(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var c=!1,h=e.return;h!==null;)h.childLanes|=n,i=h.alternate,i!==null&&(i.childLanes|=n),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(c=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,c&&t!==null&&(c=31-Pt(n),e=h.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=n|536870912),h):null}function Cs(e){if(50<Vr)throw Vr=0,jc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ei={};function Ym(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function nn(e,t,n,i){return new Ym(e,t,n,i)}function go(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Kn(e,t){var n=e.alternate;return n===null?(n=nn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function bd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ts(e,t,n,i,c,h){var y=0;if(i=e,typeof e=="function")go(e)&&(y=1);else if(typeof e=="string")y=Zy(e,n,J.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ge:return e=nn(31,n,t,c),e.elementType=ge,e.lanes=h,e;case A:return Ka(n.children,c,h,t);case N:y=8,c|=24;break;case T:return e=nn(12,n,t,c|2),e.elementType=T,e.lanes=h,e;case E:return e=nn(13,n,t,c),e.elementType=E,e.lanes=h,e;case L:return e=nn(19,n,t,c),e.elementType=L,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B:y=10;break e;case M:y=9;break e;case G:y=11;break e;case D:y=14;break e;case V:y=16,i=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),i=null}return t=nn(y,n,t,c),t.elementType=e,t.type=i,t.lanes=h,t}function Ka(e,t,n,i){return e=nn(7,e,i,t),e.lanes=n,e}function po(e,t,n){return e=nn(6,e,null,t),e.lanes=n,e}function _d(e){var t=nn(18,null,null,0);return t.stateNode=e,t}function mo(e,t,n){return t=nn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var xd=new WeakMap;function pn(e,t){if(typeof e=="object"&&e!==null){var n=xd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:Yt(t)},xd.set(e,t),t)}return{value:e,source:t,stack:Yt(t)}}var Ci=[],Ti=0,As=null,xr=0,mn=[],yn=0,ha=null,qn=1,Ln="";function Yn(e,t){Ci[Ti++]=xr,Ci[Ti++]=As,As=e,xr=t}function jd(e,t,n){mn[yn++]=qn,mn[yn++]=Ln,mn[yn++]=ha,ha=e;var i=qn;e=Ln;var c=32-Pt(i)-1;i&=~(1<<c),n+=1;var h=32-Pt(t)+c;if(30<h){var y=c-c%5;h=(i&(1<<y)-1).toString(32),i>>=y,c-=y,qn=1<<32-Pt(t)+c|n<<c|i,Ln=h+e}else qn=1<<h|n<<c|i,Ln=e}function yo(e){e.return!==null&&(Yn(e,1),jd(e,1,0))}function vo(e){for(;e===As;)As=Ci[--Ti],Ci[Ti]=null,xr=Ci[--Ti],Ci[Ti]=null;for(;e===ha;)ha=mn[--yn],mn[yn]=null,Ln=mn[--yn],mn[yn]=null,qn=mn[--yn],mn[yn]=null}function Sd(e,t){mn[yn++]=qn,mn[yn++]=Ln,mn[yn++]=ha,qn=t.id,Ln=t.overflow,ha=e}var Ut=null,ut=null,Ye=!1,fa=null,vn=!1,bo=Error(l(519));function ga(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw jr(pn(t,e)),bo}function wd(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[xt]=e,t[Lt]=i,n){case"dialog":$e("cancel",t),$e("close",t);break;case"iframe":case"object":case"embed":$e("load",t);break;case"video":case"audio":for(n=0;n<Pr.length;n++)$e(Pr[n],t);break;case"source":$e("error",t);break;case"img":case"image":case"link":$e("error",t),$e("load",t);break;case"details":$e("toggle",t);break;case"input":$e("invalid",t),dr(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":$e("invalid",t);break;case"textarea":$e("invalid",t),Lu(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||Vf(t.textContent,n)?(i.popover!=null&&($e("beforetoggle",t),$e("toggle",t)),i.onScroll!=null&&$e("scroll",t),i.onScrollEnd!=null&&$e("scrollend",t),i.onClick!=null&&(t.onclick=Pn),t=!0):t=!1,t||ga(e,!0)}function Ed(e){for(Ut=e.return;Ut;)switch(Ut.tag){case 5:case 31:case 13:vn=!1;return;case 27:case 3:vn=!0;return;default:Ut=Ut.return}}function Ai(e){if(e!==Ut)return!1;if(!Ye)return Ed(e),Ye=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Mc(e.type,e.memoizedProps)),n=!n),n&&ut&&ga(e),Ed(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ut=Ff(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ut=Ff(e)}else t===27?(t=ut,Aa(e.type)?(e=Vc,Vc=null,ut=e):ut=t):ut=Ut?_n(e.stateNode.nextSibling):null;return!0}function Ya(){ut=Ut=null,Ye=!1}function _o(){var e=fa;return e!==null&&(Wt===null?Wt=e:Wt.push.apply(Wt,e),fa=null),e}function jr(e){fa===null?fa=[e]:fa.push(e)}var xo=O(null),Ja=null,Jn=null;function pa(e,t,n){K(xo,t._currentValue),t._currentValue=n}function Qn(e){e._currentValue=xo.current,z(xo)}function jo(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function So(e,t,n,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var h=c.dependencies;if(h!==null){var y=c.child;h=h.firstContext;e:for(;h!==null;){var _=h;h=c;for(var R=0;R<t.length;R++)if(_.context===t[R]){h.lanes|=n,_=h.alternate,_!==null&&(_.lanes|=n),jo(h.return,n,e),i||(y=null);break e}h=_.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,h=y.alternate,h!==null&&(h.lanes|=n),jo(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function Oi(e,t,n,i){e=null;for(var c=t,h=!1;c!==null;){if(!h){if((c.flags&524288)!==0)h=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var _=c.type;tn(c.pendingProps.value,y.value)||(e!==null?e.push(_):e=[_])}}else if(c===fe.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Qr):e=[Qr])}c=c.return}e!==null&&So(t,e,n,i),t.flags|=262144}function Os(e){for(e=e.firstContext;e!==null;){if(!tn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Qa(e){Ja=e,Jn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function zt(e){return Cd(Ja,e)}function Ns(e,t){return Ja===null&&Qa(e),Cd(e,t)}function Cd(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Jn===null){if(e===null)throw Error(l(308));Jn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Jn=Jn.next=t;return n}var Jm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Qm=o.unstable_scheduleCallback,Xm=o.unstable_NormalPriority,jt={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wo(){return{controller:new Jm,data:new Map,refCount:0}}function Sr(e){e.refCount--,e.refCount===0&&Qm(Xm,function(){e.controller.abort()})}var wr=null,Eo=0,Ni=0,Ri=null;function Fm(e,t){if(wr===null){var n=wr=[];Eo=0,Ni=Ac(),Ri={status:"pending",value:void 0,then:function(i){n.push(i)}}}return Eo++,t.then(Td,Td),t}function Td(){if(--Eo===0&&wr!==null){Ri!==null&&(Ri.status="fulfilled");var e=wr;wr=null,Ni=0,Ri=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Zm(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),i}var Ad=C.S;C.S=function(e,t){hf=Rt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Fm(e,t),Ad!==null&&Ad(e,t)};var Xa=O(null);function Co(){var e=Xa.current;return e!==null?e:it.pooledCache}function Rs(e,t){t===null?K(Xa,Xa.current):K(Xa,t.pool)}function Od(){var e=Co();return e===null?null:{parent:jt._currentValue,pool:e}}var ki=Error(l(460)),To=Error(l(474)),ks=Error(l(542)),Us={then:function(){}};function Nd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Rd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Pn,Pn),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ud(e),e;default:if(typeof t.status=="string")t.then(Pn,Pn);else{if(e=it,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Ud(e),e}throw Za=t,ki}}function Fa(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Za=n,ki):n}}var Za=null;function kd(){if(Za===null)throw Error(l(459));var e=Za;return Za=null,e}function Ud(e){if(e===ki||e===ks)throw Error(l(483))}var Ui=null,Er=0;function zs(e){var t=Er;return Er+=1,Ui===null&&(Ui=[]),Rd(Ui,e,t)}function Cr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ds(e,t){throw t.$$typeof===S?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function zd(e){function t(I,k){if(e){var $=I.deletions;$===null?(I.deletions=[k],I.flags|=16):$.push(k)}}function n(I,k){if(!e)return null;for(;k!==null;)t(I,k),k=k.sibling;return null}function i(I){for(var k=new Map;I!==null;)I.key!==null?k.set(I.key,I):k.set(I.index,I),I=I.sibling;return k}function c(I,k){return I=Kn(I,k),I.index=0,I.sibling=null,I}function h(I,k,$){return I.index=$,e?($=I.alternate,$!==null?($=$.index,$<k?(I.flags|=67108866,k):$):(I.flags|=67108866,k)):(I.flags|=1048576,k)}function y(I){return e&&I.alternate===null&&(I.flags|=67108866),I}function _(I,k,$,ne){return k===null||k.tag!==6?(k=po($,I.mode,ne),k.return=I,k):(k=c(k,$),k.return=I,k)}function R(I,k,$,ne){var Ce=$.type;return Ce===A?ee(I,k,$.props.children,ne,$.key):k!==null&&(k.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===V&&Fa(Ce)===k.type)?(k=c(k,$.props),Cr(k,$),k.return=I,k):(k=Ts($.type,$.key,$.props,null,I.mode,ne),Cr(k,$),k.return=I,k)}function P(I,k,$,ne){return k===null||k.tag!==4||k.stateNode.containerInfo!==$.containerInfo||k.stateNode.implementation!==$.implementation?(k=mo($,I.mode,ne),k.return=I,k):(k=c(k,$.children||[]),k.return=I,k)}function ee(I,k,$,ne,Ce){return k===null||k.tag!==7?(k=Ka($,I.mode,ne,Ce),k.return=I,k):(k=c(k,$),k.return=I,k)}function se(I,k,$){if(typeof k=="string"&&k!==""||typeof k=="number"||typeof k=="bigint")return k=po(""+k,I.mode,$),k.return=I,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case b:return $=Ts(k.type,k.key,k.props,null,I.mode,$),Cr($,k),$.return=I,$;case w:return k=mo(k,I.mode,$),k.return=I,k;case V:return k=Fa(k),se(I,k,$)}if(ie(k)||me(k))return k=Ka(k,I.mode,$,null),k.return=I,k;if(typeof k.then=="function")return se(I,zs(k),$);if(k.$$typeof===B)return se(I,Ns(I,k),$);Ds(I,k)}return null}function Y(I,k,$,ne){var Ce=k!==null?k.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return Ce!==null?null:_(I,k,""+$,ne);if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return $.key===Ce?R(I,k,$,ne):null;case w:return $.key===Ce?P(I,k,$,ne):null;case V:return $=Fa($),Y(I,k,$,ne)}if(ie($)||me($))return Ce!==null?null:ee(I,k,$,ne,null);if(typeof $.then=="function")return Y(I,k,zs($),ne);if($.$$typeof===B)return Y(I,k,Ns(I,$),ne);Ds(I,$)}return null}function X(I,k,$,ne,Ce){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return I=I.get($)||null,_(k,I,""+ne,Ce);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case b:return I=I.get(ne.key===null?$:ne.key)||null,R(k,I,ne,Ce);case w:return I=I.get(ne.key===null?$:ne.key)||null,P(k,I,ne,Ce);case V:return ne=Fa(ne),X(I,k,$,ne,Ce)}if(ie(ne)||me(ne))return I=I.get($)||null,ee(k,I,ne,Ce,null);if(typeof ne.then=="function")return X(I,k,$,zs(ne),Ce);if(ne.$$typeof===B)return X(I,k,$,Ns(k,ne),Ce);Ds(k,ne)}return null}function je(I,k,$,ne){for(var Ce=null,Je=null,Se=k,Le=k=0,Ke=null;Se!==null&&Le<$.length;Le++){Se.index>Le?(Ke=Se,Se=null):Ke=Se.sibling;var Qe=Y(I,Se,$[Le],ne);if(Qe===null){Se===null&&(Se=Ke);break}e&&Se&&Qe.alternate===null&&t(I,Se),k=h(Qe,k,Le),Je===null?Ce=Qe:Je.sibling=Qe,Je=Qe,Se=Ke}if(Le===$.length)return n(I,Se),Ye&&Yn(I,Le),Ce;if(Se===null){for(;Le<$.length;Le++)Se=se(I,$[Le],ne),Se!==null&&(k=h(Se,k,Le),Je===null?Ce=Se:Je.sibling=Se,Je=Se);return Ye&&Yn(I,Le),Ce}for(Se=i(Se);Le<$.length;Le++)Ke=X(Se,I,Le,$[Le],ne),Ke!==null&&(e&&Ke.alternate!==null&&Se.delete(Ke.key===null?Le:Ke.key),k=h(Ke,k,Le),Je===null?Ce=Ke:Je.sibling=Ke,Je=Ke);return e&&Se.forEach(function(Ua){return t(I,Ua)}),Ye&&Yn(I,Le),Ce}function Ae(I,k,$,ne){if($==null)throw Error(l(151));for(var Ce=null,Je=null,Se=k,Le=k=0,Ke=null,Qe=$.next();Se!==null&&!Qe.done;Le++,Qe=$.next()){Se.index>Le?(Ke=Se,Se=null):Ke=Se.sibling;var Ua=Y(I,Se,Qe.value,ne);if(Ua===null){Se===null&&(Se=Ke);break}e&&Se&&Ua.alternate===null&&t(I,Se),k=h(Ua,k,Le),Je===null?Ce=Ua:Je.sibling=Ua,Je=Ua,Se=Ke}if(Qe.done)return n(I,Se),Ye&&Yn(I,Le),Ce;if(Se===null){for(;!Qe.done;Le++,Qe=$.next())Qe=se(I,Qe.value,ne),Qe!==null&&(k=h(Qe,k,Le),Je===null?Ce=Qe:Je.sibling=Qe,Je=Qe);return Ye&&Yn(I,Le),Ce}for(Se=i(Se);!Qe.done;Le++,Qe=$.next())Qe=X(Se,I,Le,Qe.value,ne),Qe!==null&&(e&&Qe.alternate!==null&&Se.delete(Qe.key===null?Le:Qe.key),k=h(Qe,k,Le),Je===null?Ce=Qe:Je.sibling=Qe,Je=Qe);return e&&Se.forEach(function(cv){return t(I,cv)}),Ye&&Yn(I,Le),Ce}function nt(I,k,$,ne){if(typeof $=="object"&&$!==null&&$.type===A&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case b:e:{for(var Ce=$.key;k!==null;){if(k.key===Ce){if(Ce=$.type,Ce===A){if(k.tag===7){n(I,k.sibling),ne=c(k,$.props.children),ne.return=I,I=ne;break e}}else if(k.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===V&&Fa(Ce)===k.type){n(I,k.sibling),ne=c(k,$.props),Cr(ne,$),ne.return=I,I=ne;break e}n(I,k);break}else t(I,k);k=k.sibling}$.type===A?(ne=Ka($.props.children,I.mode,ne,$.key),ne.return=I,I=ne):(ne=Ts($.type,$.key,$.props,null,I.mode,ne),Cr(ne,$),ne.return=I,I=ne)}return y(I);case w:e:{for(Ce=$.key;k!==null;){if(k.key===Ce)if(k.tag===4&&k.stateNode.containerInfo===$.containerInfo&&k.stateNode.implementation===$.implementation){n(I,k.sibling),ne=c(k,$.children||[]),ne.return=I,I=ne;break e}else{n(I,k);break}else t(I,k);k=k.sibling}ne=mo($,I.mode,ne),ne.return=I,I=ne}return y(I);case V:return $=Fa($),nt(I,k,$,ne)}if(ie($))return je(I,k,$,ne);if(me($)){if(Ce=me($),typeof Ce!="function")throw Error(l(150));return $=Ce.call($),Ae(I,k,$,ne)}if(typeof $.then=="function")return nt(I,k,zs($),ne);if($.$$typeof===B)return nt(I,k,Ns(I,$),ne);Ds(I,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,k!==null&&k.tag===6?(n(I,k.sibling),ne=c(k,$),ne.return=I,I=ne):(n(I,k),ne=po($,I.mode,ne),ne.return=I,I=ne),y(I)):n(I,k)}return function(I,k,$,ne){try{Er=0;var Ce=nt(I,k,$,ne);return Ui=null,Ce}catch(Se){if(Se===ki||Se===ks)throw Se;var Je=nn(29,Se,null,I.mode);return Je.lanes=ne,Je.return=I,Je}finally{}}}var Wa=zd(!0),Dd=zd(!1),ma=!1;function Ao(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ya(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function va(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Fe&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=Cs(e),vd(e,null,n),t}return Es(e,i,t,n),Cs(e)}function Tr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,gs(e,n)}}function No(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var c=null,h=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};h===null?c=h=y:h=h.next=y,n=n.next}while(n!==null);h===null?c=h=t:h=h.next=t}else c=h=t;n={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Ro=!1;function Ar(){if(Ro){var e=Ri;if(e!==null)throw e}}function Or(e,t,n,i){Ro=!1;var c=e.updateQueue;ma=!1;var h=c.firstBaseUpdate,y=c.lastBaseUpdate,_=c.shared.pending;if(_!==null){c.shared.pending=null;var R=_,P=R.next;R.next=null,y===null?h=P:y.next=P,y=R;var ee=e.alternate;ee!==null&&(ee=ee.updateQueue,_=ee.lastBaseUpdate,_!==y&&(_===null?ee.firstBaseUpdate=P:_.next=P,ee.lastBaseUpdate=R))}if(h!==null){var se=c.baseState;y=0,ee=P=R=null,_=h;do{var Y=_.lane&-536870913,X=Y!==_.lane;if(X?(Ge&Y)===Y:(i&Y)===Y){Y!==0&&Y===Ni&&(Ro=!0),ee!==null&&(ee=ee.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});e:{var je=e,Ae=_;Y=t;var nt=n;switch(Ae.tag){case 1:if(je=Ae.payload,typeof je=="function"){se=je.call(nt,se,Y);break e}se=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Ae.payload,Y=typeof je=="function"?je.call(nt,se,Y):je,Y==null)break e;se=x({},se,Y);break e;case 2:ma=!0}}Y=_.callback,Y!==null&&(e.flags|=64,X&&(e.flags|=8192),X=c.callbacks,X===null?c.callbacks=[Y]:X.push(Y))}else X={lane:Y,tag:_.tag,payload:_.payload,callback:_.callback,next:null},ee===null?(P=ee=X,R=se):ee=ee.next=X,y|=Y;if(_=_.next,_===null){if(_=c.shared.pending,_===null)break;X=_,_=X.next,X.next=null,c.lastBaseUpdate=X,c.shared.pending=null}}while(!0);ee===null&&(R=se),c.baseState=R,c.firstBaseUpdate=P,c.lastBaseUpdate=ee,h===null&&(c.shared.lanes=0),Sa|=y,e.lanes=y,e.memoizedState=se}}function Bd(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function Md(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Bd(n[e],t)}var zi=O(null),Bs=O(0);function qd(e,t){e=ia,K(Bs,e),K(zi,t),ia=e|t.baseLanes}function ko(){K(Bs,ia),K(zi,zi.current)}function Uo(){ia=Bs.current,z(zi),z(Bs)}var an=O(null),bn=null;function ba(e){var t=e.alternate;K(bt,bt.current&1),K(an,e),bn===null&&(t===null||zi.current!==null||t.memoizedState!==null)&&(bn=e)}function zo(e){K(bt,bt.current),K(an,e),bn===null&&(bn=e)}function Ld(e){e.tag===22?(K(bt,bt.current),K(an,e),bn===null&&(bn=e)):_a()}function _a(){K(bt,bt.current),K(an,an.current)}function rn(e){z(an),bn===e&&(bn=null),z(bt)}var bt=O(0);function Ms(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Ic(n)||Hc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Xn=0,Me=null,et=null,St=null,qs=!1,Di=!1,ei=!1,Ls=0,Nr=0,Bi=null,Wm=0;function mt(){throw Error(l(321))}function Do(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!tn(e[n],t[n]))return!1;return!0}function Bo(e,t,n,i,c,h){return Xn=h,Me=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,C.H=e===null||e.memoizedState===null?jh:Fo,ei=!1,h=n(i,c),ei=!1,Di&&(h=Hd(t,n,i,c)),Id(e),h}function Id(e){C.H=Ur;var t=et!==null&&et.next!==null;if(Xn=0,St=et=Me=null,qs=!1,Nr=0,Bi=null,t)throw Error(l(300));e===null||wt||(e=e.dependencies,e!==null&&Os(e)&&(wt=!0))}function Hd(e,t,n,i){Me=e;var c=0;do{if(Di&&(Bi=null),Nr=0,Di=!1,25<=c)throw Error(l(301));if(c+=1,St=et=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}C.H=Sh,h=t(n,i)}while(Di);return h}function ey(){var e=C.H,t=e.useState()[0];return t=typeof t.then=="function"?Rr(t):t,e=e.useState()[0],(et!==null?et.memoizedState:null)!==e&&(Me.flags|=1024),t}function Mo(){var e=Ls!==0;return Ls=0,e}function qo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Lo(e){if(qs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}qs=!1}Xn=0,St=et=Me=null,Di=!1,Nr=Ls=0,Bi=null}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return St===null?Me.memoizedState=St=e:St=St.next=e,St}function _t(){if(et===null){var e=Me.alternate;e=e!==null?e.memoizedState:null}else e=et.next;var t=St===null?Me.memoizedState:St.next;if(t!==null)St=t,et=e;else{if(e===null)throw Me.alternate===null?Error(l(467)):Error(l(310));et=e,e={memoizedState:et.memoizedState,baseState:et.baseState,baseQueue:et.baseQueue,queue:et.queue,next:null},St===null?Me.memoizedState=St=e:St=St.next=e}return St}function Is(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Rr(e){var t=Nr;return Nr+=1,Bi===null&&(Bi=[]),e=Rd(Bi,e,t),t=Me,(St===null?t.memoizedState:St.next)===null&&(t=t.alternate,C.H=t===null||t.memoizedState===null?jh:Fo),e}function Hs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Rr(e);if(e.$$typeof===B)return zt(e)}throw Error(l(438,String(e)))}function Io(e){var t=null,n=Me.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=Me.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Is(),Me.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=Q;return t.index++,n}function Fn(e,t){return typeof t=="function"?t(e):t}function Vs(e){var t=_t();return Ho(t,et,e)}function Ho(e,t,n){var i=e.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=n;var c=e.baseQueue,h=i.pending;if(h!==null){if(c!==null){var y=c.next;c.next=h.next,h.next=y}t.baseQueue=c=h,i.pending=null}if(h=e.baseState,c===null)e.memoizedState=h;else{t=c.next;var _=y=null,R=null,P=t,ee=!1;do{var se=P.lane&-536870913;if(se!==P.lane?(Ge&se)===se:(Xn&se)===se){var Y=P.revertLane;if(Y===0)R!==null&&(R=R.next={lane:0,revertLane:0,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),se===Ni&&(ee=!0);else if((Xn&Y)===Y){P=P.next,Y===Ni&&(ee=!0);continue}else se={lane:0,revertLane:P.revertLane,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},R===null?(_=R=se,y=h):R=R.next=se,Me.lanes|=Y,Sa|=Y;se=P.action,ei&&n(h,se),h=P.hasEagerState?P.eagerState:n(h,se)}else Y={lane:se,revertLane:P.revertLane,gesture:P.gesture,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},R===null?(_=R=Y,y=h):R=R.next=Y,Me.lanes|=se,Sa|=se;P=P.next}while(P!==null&&P!==t);if(R===null?y=h:R.next=_,!tn(h,e.memoizedState)&&(wt=!0,ee&&(n=Ri,n!==null)))throw n;e.memoizedState=h,e.baseState=y,e.baseQueue=R,i.lastRenderedState=h}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Vo(e){var t=_t(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var i=n.dispatch,c=n.pending,h=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do h=e(h,y.action),y=y.next;while(y!==c);tn(h,t.memoizedState)||(wt=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),n.lastRenderedState=h}return[h,i]}function Vd(e,t,n){var i=Me,c=_t(),h=Ye;if(h){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!tn((et||c).memoizedState,n);if(y&&(c.memoizedState=n,wt=!0),c=c.queue,Go(Gd.bind(null,i,c,e),[e]),c.getSnapshot!==t||y||St!==null&&St.memoizedState.tag&1){if(i.flags|=2048,Mi(9,{destroy:void 0},Pd.bind(null,i,c,n,t),null),it===null)throw Error(l(349));h||(Xn&127)!==0||$d(i,t,n)}return n}function $d(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Me.updateQueue,t===null?(t=Is(),Me.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Pd(e,t,n,i){t.value=n,t.getSnapshot=i,Kd(t)&&Yd(e)}function Gd(e,t,n){return n(function(){Kd(t)&&Yd(e)})}function Kd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tn(e,n)}catch{return!0}}function Yd(e){var t=Ga(e,2);t!==null&&en(t,e,2)}function $o(e){var t=Kt();if(typeof e=="function"){var n=e;if(e=n(),ei){zn(!0);try{n()}finally{zn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:e},t}function Jd(e,t,n,i){return e.baseState=n,Ho(e,et,typeof i=="function"?i:Fn)}function ty(e,t,n,i,c){if(Gs(e))throw Error(l(485));if(e=t.action,e!==null){var h={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){h.listeners.push(y)}};C.T!==null?n(!0):h.isTransition=!1,i(h),n=t.pending,n===null?(h.next=t.pending=h,Qd(t,h)):(h.next=n.next,t.pending=n.next=h)}}function Qd(e,t){var n=t.action,i=t.payload,c=e.state;if(t.isTransition){var h=C.T,y={};C.T=y;try{var _=n(c,i),R=C.S;R!==null&&R(y,_),Xd(e,t,_)}catch(P){Po(e,t,P)}finally{h!==null&&y.types!==null&&(h.types=y.types),C.T=h}}else try{h=n(c,i),Xd(e,t,h)}catch(P){Po(e,t,P)}}function Xd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Fd(e,t,i)},function(i){return Po(e,t,i)}):Fd(e,t,n)}function Fd(e,t,n){t.status="fulfilled",t.value=n,Zd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Qd(e,n)))}function Po(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,Zd(t),t=t.next;while(t!==i)}e.action=null}function Zd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Wd(e,t){return t}function eh(e,t){if(Ye){var n=it.formState;if(n!==null){e:{var i=Me;if(Ye){if(ut){t:{for(var c=ut,h=vn;c.nodeType!==8;){if(!h){c=null;break t}if(c=_n(c.nextSibling),c===null){c=null;break t}}h=c.data,c=h==="F!"||h==="F"?c:null}if(c){ut=_n(c.nextSibling),i=c.data==="F!";break e}}ga(i)}i=!1}i&&(t=n[0])}}return n=Kt(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wd,lastRenderedState:t},n.queue=i,n=bh.bind(null,Me,i),i.dispatch=n,i=$o(!1),h=Xo.bind(null,Me,!1,i.queue),i=Kt(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,n=ty.bind(null,Me,c,h,n),c.dispatch=n,i.memoizedState=e,[t,n,!1]}function th(e){var t=_t();return nh(t,et,e)}function nh(e,t,n){if(t=Ho(e,t,Wd)[0],e=Vs(Fn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=Rr(t)}catch(y){throw y===ki?ks:y}else i=t;t=_t();var c=t.queue,h=c.dispatch;return n!==t.memoizedState&&(Me.flags|=2048,Mi(9,{destroy:void 0},ny.bind(null,c,n),null)),[i,h,e]}function ny(e,t){e.action=t}function ah(e){var t=_t(),n=et;if(n!==null)return nh(t,n,e);_t(),t=t.memoizedState,n=_t();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Mi(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},t=Me.updateQueue,t===null&&(t=Is(),Me.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function ih(){return _t().memoizedState}function $s(e,t,n,i){var c=Kt();Me.flags|=e,c.memoizedState=Mi(1|t,{destroy:void 0},n,i===void 0?null:i)}function Ps(e,t,n,i){var c=_t();i=i===void 0?null:i;var h=c.memoizedState.inst;et!==null&&i!==null&&Do(i,et.memoizedState.deps)?c.memoizedState=Mi(t,h,n,i):(Me.flags|=e,c.memoizedState=Mi(1|t,h,n,i))}function rh(e,t){$s(8390656,8,e,t)}function Go(e,t){Ps(2048,8,e,t)}function ay(e){Me.flags|=4;var t=Me.updateQueue;if(t===null)t=Is(),Me.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function sh(e){var t=_t().memoizedState;return ay({ref:t,nextImpl:e}),function(){if((Fe&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function lh(e,t){return Ps(4,2,e,t)}function oh(e,t){return Ps(4,4,e,t)}function ch(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function uh(e,t,n){n=n!=null?n.concat([e]):null,Ps(4,4,ch.bind(null,t,e),n)}function Ko(){}function dh(e,t){var n=_t();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&Do(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function hh(e,t){var n=_t();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&Do(t,i[1]))return i[0];if(i=e(),ei){zn(!0);try{e()}finally{zn(!1)}}return n.memoizedState=[i,t],i}function Yo(e,t,n){return n===void 0||(Xn&1073741824)!==0&&(Ge&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=gf(),Me.lanes|=e,Sa|=e,n)}function fh(e,t,n,i){return tn(n,t)?n:zi.current!==null?(e=Yo(e,n,i),tn(e,t)||(wt=!0),e):(Xn&42)===0||(Xn&1073741824)!==0&&(Ge&261930)===0?(wt=!0,e.memoizedState=n):(e=gf(),Me.lanes|=e,Sa|=e,t)}function gh(e,t,n,i,c){var h=U.p;U.p=h!==0&&8>h?h:8;var y=C.T,_={};C.T=_,Xo(e,!1,t,n);try{var R=c(),P=C.S;if(P!==null&&P(_,R),R!==null&&typeof R=="object"&&typeof R.then=="function"){var ee=Zm(R,i);kr(e,t,ee,on(e))}else kr(e,t,i,on(e))}catch(se){kr(e,t,{then:function(){},status:"rejected",reason:se},on())}finally{U.p=h,y!==null&&_.types!==null&&(y.types=_.types),C.T=y}}function iy(){}function Jo(e,t,n,i){if(e.tag!==5)throw Error(l(476));var c=ph(e).queue;gh(e,c,t,F,n===null?iy:function(){return mh(e),n(i)})}function ph(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:F,baseState:F,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:F},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function mh(e){var t=ph(e);t.next===null&&(t=e.alternate.memoizedState),kr(e,t.next.queue,{},on())}function Qo(){return zt(Qr)}function yh(){return _t().memoizedState}function vh(){return _t().memoizedState}function ry(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=on();e=ya(n);var i=va(t,e,n);i!==null&&(en(i,t,n),Tr(i,t,n)),t={cache:wo()},e.payload=t;return}t=t.return}}function sy(e,t,n){var i=on();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Gs(e)?_h(t,n):(n=fo(e,t,n,i),n!==null&&(en(n,e,i),xh(n,t,i)))}function bh(e,t,n){var i=on();kr(e,t,n,i)}function kr(e,t,n,i){var c={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Gs(e))_h(t,c);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var y=t.lastRenderedState,_=h(y,n);if(c.hasEagerState=!0,c.eagerState=_,tn(_,y))return Es(e,t,c,0),it===null&&ws(),!1}catch{}finally{}if(n=fo(e,t,c,i),n!==null)return en(n,e,i),xh(n,t,i),!0}return!1}function Xo(e,t,n,i){if(i={lane:2,revertLane:Ac(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Gs(e)){if(t)throw Error(l(479))}else t=fo(e,n,i,2),t!==null&&en(t,e,2)}function Gs(e){var t=e.alternate;return e===Me||t!==null&&t===Me}function _h(e,t){Di=qs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function xh(e,t,n){if((n&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,gs(e,n)}}var Ur={readContext:zt,use:Hs,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useLayoutEffect:mt,useInsertionEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useSyncExternalStore:mt,useId:mt,useHostTransitionStatus:mt,useFormState:mt,useActionState:mt,useOptimistic:mt,useMemoCache:mt,useCacheRefresh:mt};Ur.useEffectEvent=mt;var jh={readContext:zt,use:Hs,useCallback:function(e,t){return Kt().memoizedState=[e,t===void 0?null:t],e},useContext:zt,useEffect:rh,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,$s(4194308,4,ch.bind(null,t,e),n)},useLayoutEffect:function(e,t){return $s(4194308,4,e,t)},useInsertionEffect:function(e,t){$s(4,2,e,t)},useMemo:function(e,t){var n=Kt();t=t===void 0?null:t;var i=e();if(ei){zn(!0);try{e()}finally{zn(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Kt();if(n!==void 0){var c=n(t);if(ei){zn(!0);try{n(t)}finally{zn(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=sy.bind(null,Me,e),[i.memoizedState,e]},useRef:function(e){var t=Kt();return e={current:e},t.memoizedState=e},useState:function(e){e=$o(e);var t=e.queue,n=bh.bind(null,Me,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ko,useDeferredValue:function(e,t){var n=Kt();return Yo(n,e,t)},useTransition:function(){var e=$o(!1);return e=gh.bind(null,Me,e.queue,!0,!1),Kt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=Me,c=Kt();if(Ye){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),it===null)throw Error(l(349));(Ge&127)!==0||$d(i,t,n)}c.memoizedState=n;var h={value:n,getSnapshot:t};return c.queue=h,rh(Gd.bind(null,i,h,e),[e]),i.flags|=2048,Mi(9,{destroy:void 0},Pd.bind(null,i,h,n,t),null),n},useId:function(){var e=Kt(),t=it.identifierPrefix;if(Ye){var n=Ln,i=qn;n=(i&~(1<<32-Pt(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Ls++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Wm++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Qo,useFormState:eh,useActionState:eh,useOptimistic:function(e){var t=Kt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Xo.bind(null,Me,!0,n),n.dispatch=t,[e,t]},useMemoCache:Io,useCacheRefresh:function(){return Kt().memoizedState=ry.bind(null,Me)},useEffectEvent:function(e){var t=Kt(),n={impl:e};return t.memoizedState=n,function(){if((Fe&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},Fo={readContext:zt,use:Hs,useCallback:dh,useContext:zt,useEffect:Go,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:oh,useMemo:hh,useReducer:Vs,useRef:ih,useState:function(){return Vs(Fn)},useDebugValue:Ko,useDeferredValue:function(e,t){var n=_t();return fh(n,et.memoizedState,e,t)},useTransition:function(){var e=Vs(Fn)[0],t=_t().memoizedState;return[typeof e=="boolean"?e:Rr(e),t]},useSyncExternalStore:Vd,useId:yh,useHostTransitionStatus:Qo,useFormState:th,useActionState:th,useOptimistic:function(e,t){var n=_t();return Jd(n,et,e,t)},useMemoCache:Io,useCacheRefresh:vh};Fo.useEffectEvent=sh;var Sh={readContext:zt,use:Hs,useCallback:dh,useContext:zt,useEffect:Go,useImperativeHandle:uh,useInsertionEffect:lh,useLayoutEffect:oh,useMemo:hh,useReducer:Vo,useRef:ih,useState:function(){return Vo(Fn)},useDebugValue:Ko,useDeferredValue:function(e,t){var n=_t();return et===null?Yo(n,e,t):fh(n,et.memoizedState,e,t)},useTransition:function(){var e=Vo(Fn)[0],t=_t().memoizedState;return[typeof e=="boolean"?e:Rr(e),t]},useSyncExternalStore:Vd,useId:yh,useHostTransitionStatus:Qo,useFormState:ah,useActionState:ah,useOptimistic:function(e,t){var n=_t();return et!==null?Jd(n,et,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Io,useCacheRefresh:vh};Sh.useEffectEvent=sh;function Zo(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:x({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wo={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=on(),c=ya(i);c.payload=t,n!=null&&(c.callback=n),t=va(e,c,i),t!==null&&(en(t,e,i),Tr(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=on(),c=ya(i);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=va(e,c,i),t!==null&&(en(t,e,i),Tr(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=on(),i=ya(n);i.tag=2,t!=null&&(i.callback=t),t=va(e,i,n),t!==null&&(en(t,e,n),Tr(t,e,n))}};function wh(e,t,n,i,c,h,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,h,y):t.prototype&&t.prototype.isPureReactComponent?!br(n,i)||!br(c,h):!0}function Eh(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Wo.enqueueReplaceState(t,t.state,null)}function ti(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=x({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Ch(e){Ss(e)}function Th(e){console.error(e)}function Ah(e){Ss(e)}function Ks(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Oh(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function ec(e,t,n){return n=ya(n),n.tag=3,n.payload={element:null},n.callback=function(){Ks(e,t)},n}function Nh(e){return e=ya(e),e.tag=3,e}function Rh(e,t,n,i){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=i.value;e.payload=function(){return c(h)},e.callback=function(){Oh(t,n,i)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Oh(t,n,i),typeof c!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var _=i.stack;this.componentDidCatch(i.value,{componentStack:_!==null?_:""})})}function ly(e,t,n,i,c){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Oi(t,n,c,!0),n=an.current,n!==null){switch(n.tag){case 31:case 13:return bn===null?il():n.alternate===null&&yt===0&&(yt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,i===Us?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),Ec(e,i,c)),!1;case 22:return n.flags|=65536,i===Us?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),Ec(e,i,c)),!1}throw Error(l(435,n.tag))}return Ec(e,i,c),il(),!1}if(Ye)return t=an.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==bo&&(e=Error(l(422),{cause:i}),jr(pn(e,n)))):(i!==bo&&(t=Error(l(423),{cause:i}),jr(pn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=pn(i,n),c=ec(e.stateNode,i,c),No(e,c),yt!==4&&(yt=2)),!1;var h=Error(l(520),{cause:i});if(h=pn(h,n),Hr===null?Hr=[h]:Hr.push(h),yt!==4&&(yt=2),t===null)return!0;i=pn(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=ec(n.stateNode,i,e),No(n,e),!1;case 1:if(t=n.type,h=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(wa===null||!wa.has(h))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Nh(c),Rh(c,e,n,i),No(n,c),!1}n=n.return}while(n!==null);return!1}var tc=Error(l(461)),wt=!1;function Dt(e,t,n,i){t.child=e===null?Dd(t,null,n,i):Wa(t,e.child,n,i)}function kh(e,t,n,i,c){n=n.render;var h=t.ref;if("ref"in i){var y={};for(var _ in i)_!=="ref"&&(y[_]=i[_])}else y=i;return Qa(t),i=Bo(e,t,n,y,h,c),_=Mo(),e!==null&&!wt?(qo(e,t,c),Zn(e,t,c)):(Ye&&_&&yo(t),t.flags|=1,Dt(e,t,i,c),t.child)}function Uh(e,t,n,i,c){if(e===null){var h=n.type;return typeof h=="function"&&!go(h)&&h.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=h,zh(e,t,h,i,c)):(e=Ts(n.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!cc(e,c)){var y=h.memoizedProps;if(n=n.compare,n=n!==null?n:br,n(y,i)&&e.ref===t.ref)return Zn(e,t,c)}return t.flags|=1,e=Kn(h,i),e.ref=t.ref,e.return=t,t.child=e}function zh(e,t,n,i,c){if(e!==null){var h=e.memoizedProps;if(br(h,i)&&e.ref===t.ref)if(wt=!1,t.pendingProps=i=h,cc(e,c))(e.flags&131072)!==0&&(wt=!0);else return t.lanes=e.lanes,Zn(e,t,c)}return nc(e,t,n,i,c)}function Dh(e,t,n,i){var c=i.children,h=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(h=h!==null?h.baseLanes|n:n,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~h}else i=0,t.child=null;return Bh(e,t,h,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Rs(t,h!==null?h.cachePool:null),h!==null?qd(t,h):ko(),Ld(t);else return i=t.lanes=536870912,Bh(e,t,h!==null?h.baseLanes|n:n,n,i)}else h!==null?(Rs(t,h.cachePool),qd(t,h),_a(),t.memoizedState=null):(e!==null&&Rs(t,null),ko(),_a());return Dt(e,t,c,n),t.child}function zr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bh(e,t,n,i,c){var h=Co();return h=h===null?null:{parent:jt._currentValue,pool:h},t.memoizedState={baseLanes:n,cachePool:h},e!==null&&Rs(t,null),ko(),Ld(t),e!==null&&Oi(e,t,i,!0),t.childLanes=c,null}function Ys(e,t){return t=Qs({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Mh(e,t,n){return Wa(t,e.child,null,n),e=Ys(t,t.pendingProps),e.flags|=2,rn(t),t.memoizedState=null,e}function oy(e,t,n){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ye){if(i.mode==="hidden")return e=Ys(t,i),t.lanes=536870912,zr(null,e);if(zo(t),(e=ut)?(e=Xf(e,vn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ha!==null?{id:qn,overflow:Ln}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,Ut=t,ut=null)):e=null,e===null)throw ga(t);return t.lanes=536870912,null}return Ys(t,i)}var h=e.memoizedState;if(h!==null){var y=h.dehydrated;if(zo(t),c)if(t.flags&256)t.flags&=-257,t=Mh(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(wt||Oi(e,t,n,!1),c=(n&e.childLanes)!==0,wt||c){if(i=it,i!==null&&(y=or(i,n),y!==0&&y!==h.retryLane))throw h.retryLane=y,Ga(e,y),en(i,e,y),tc;il(),t=Mh(e,t,n)}else e=h.treeContext,ut=_n(y.nextSibling),Ut=t,Ye=!0,fa=null,vn=!1,e!==null&&Sd(t,e),t=Ys(t,i),t.flags|=4096;return t}return e=Kn(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Js(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function nc(e,t,n,i,c){return Qa(t),n=Bo(e,t,n,i,void 0,c),i=Mo(),e!==null&&!wt?(qo(e,t,c),Zn(e,t,c)):(Ye&&i&&yo(t),t.flags|=1,Dt(e,t,n,c),t.child)}function qh(e,t,n,i,c,h){return Qa(t),t.updateQueue=null,n=Hd(t,i,n,c),Id(e),i=Mo(),e!==null&&!wt?(qo(e,t,h),Zn(e,t,h)):(Ye&&i&&yo(t),t.flags|=1,Dt(e,t,n,h),t.child)}function Lh(e,t,n,i,c){if(Qa(t),t.stateNode===null){var h=Ei,y=n.contextType;typeof y=="object"&&y!==null&&(h=zt(y)),h=new n(i,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Wo,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=i,h.state=t.memoizedState,h.refs={},Ao(t),y=n.contextType,h.context=typeof y=="object"&&y!==null?zt(y):Ei,h.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(Zo(t,n,y,i),h.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(y=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),y!==h.state&&Wo.enqueueReplaceState(h,h.state,null),Or(t,i,h,c),Ar(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){h=t.stateNode;var _=t.memoizedProps,R=ti(n,_);h.props=R;var P=h.context,ee=n.contextType;y=Ei,typeof ee=="object"&&ee!==null&&(y=zt(ee));var se=n.getDerivedStateFromProps;ee=typeof se=="function"||typeof h.getSnapshotBeforeUpdate=="function",_=t.pendingProps!==_,ee||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(_||P!==y)&&Eh(t,h,i,y),ma=!1;var Y=t.memoizedState;h.state=Y,Or(t,i,h,c),Ar(),P=t.memoizedState,_||Y!==P||ma?(typeof se=="function"&&(Zo(t,n,se,i),P=t.memoizedState),(R=ma||wh(t,n,R,i,Y,P,y))?(ee||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=P),h.props=i,h.state=P,h.context=y,i=R):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{h=t.stateNode,Oo(e,t),y=t.memoizedProps,ee=ti(n,y),h.props=ee,se=t.pendingProps,Y=h.context,P=n.contextType,R=Ei,typeof P=="object"&&P!==null&&(R=zt(P)),_=n.getDerivedStateFromProps,(P=typeof _=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(y!==se||Y!==R)&&Eh(t,h,i,R),ma=!1,Y=t.memoizedState,h.state=Y,Or(t,i,h,c),Ar();var X=t.memoizedState;y!==se||Y!==X||ma||e!==null&&e.dependencies!==null&&Os(e.dependencies)?(typeof _=="function"&&(Zo(t,n,_,i),X=t.memoizedState),(ee=ma||wh(t,n,ee,i,Y,X,R)||e!==null&&e.dependencies!==null&&Os(e.dependencies))?(P||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,X,R),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,X,R)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=X),h.props=i,h.state=X,h.context=R,i=ee):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),i=!1)}return h=i,Js(e,t),i=(t.flags&128)!==0,h||i?(h=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&i?(t.child=Wa(t,e.child,null,c),t.child=Wa(t,null,n,c)):Dt(e,t,n,c),t.memoizedState=h.state,e=t.child):e=Zn(e,t,c),e}function Ih(e,t,n,i){return Ya(),t.flags|=256,Dt(e,t,n,i),t.child}var ac={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ic(e){return{baseLanes:e,cachePool:Od()}}function rc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=ln),e}function Hh(e,t,n){var i=t.pendingProps,c=!1,h=(t.flags&128)!==0,y;if((y=h)||(y=e!==null&&e.memoizedState===null?!1:(bt.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ye){if(c?ba(t):_a(),(e=ut)?(e=Xf(e,vn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:ha!==null?{id:qn,overflow:Ln}:null,retryLane:536870912,hydrationErrors:null},n=_d(e),n.return=t,t.child=n,Ut=t,ut=null)):e=null,e===null)throw ga(t);return Hc(e)?t.lanes=32:t.lanes=536870912,null}var _=i.children;return i=i.fallback,c?(_a(),c=t.mode,_=Qs({mode:"hidden",children:_},c),i=Ka(i,c,n,null),_.return=t,i.return=t,_.sibling=i,t.child=_,i=t.child,i.memoizedState=ic(n),i.childLanes=rc(e,y,n),t.memoizedState=ac,zr(null,i)):(ba(t),sc(t,_))}var R=e.memoizedState;if(R!==null&&(_=R.dehydrated,_!==null)){if(h)t.flags&256?(ba(t),t.flags&=-257,t=lc(e,t,n)):t.memoizedState!==null?(_a(),t.child=e.child,t.flags|=128,t=null):(_a(),_=i.fallback,c=t.mode,i=Qs({mode:"visible",children:i.children},c),_=Ka(_,c,n,null),_.flags|=2,i.return=t,_.return=t,i.sibling=_,t.child=i,Wa(t,e.child,null,n),i=t.child,i.memoizedState=ic(n),i.childLanes=rc(e,y,n),t.memoizedState=ac,t=zr(null,i));else if(ba(t),Hc(_)){if(y=_.nextSibling&&_.nextSibling.dataset,y)var P=y.dgst;y=P,i=Error(l(419)),i.stack="",i.digest=y,jr({value:i,source:null,stack:null}),t=lc(e,t,n)}else if(wt||Oi(e,t,n,!1),y=(n&e.childLanes)!==0,wt||y){if(y=it,y!==null&&(i=or(y,n),i!==0&&i!==R.retryLane))throw R.retryLane=i,Ga(e,i),en(y,e,i),tc;Ic(_)||il(),t=lc(e,t,n)}else Ic(_)?(t.flags|=192,t.child=e.child,t=null):(e=R.treeContext,ut=_n(_.nextSibling),Ut=t,Ye=!0,fa=null,vn=!1,e!==null&&Sd(t,e),t=sc(t,i.children),t.flags|=4096);return t}return c?(_a(),_=i.fallback,c=t.mode,R=e.child,P=R.sibling,i=Kn(R,{mode:"hidden",children:i.children}),i.subtreeFlags=R.subtreeFlags&65011712,P!==null?_=Kn(P,_):(_=Ka(_,c,n,null),_.flags|=2),_.return=t,i.return=t,i.sibling=_,t.child=i,zr(null,i),i=t.child,_=e.child.memoizedState,_===null?_=ic(n):(c=_.cachePool,c!==null?(R=jt._currentValue,c=c.parent!==R?{parent:R,pool:R}:c):c=Od(),_={baseLanes:_.baseLanes|n,cachePool:c}),i.memoizedState=_,i.childLanes=rc(e,y,n),t.memoizedState=ac,zr(e.child,i)):(ba(t),n=e.child,e=n.sibling,n=Kn(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function sc(e,t){return t=Qs({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Qs(e,t){return e=nn(22,e,null,t),e.lanes=0,e}function lc(e,t,n){return Wa(t,e.child,null,n),e=sc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Vh(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),jo(e.return,t,n)}function oc(e,t,n,i,c,h){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:c,treeForkCount:h}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=n,y.tailMode=c,y.treeForkCount=h)}function $h(e,t,n){var i=t.pendingProps,c=i.revealOrder,h=i.tail;i=i.children;var y=bt.current,_=(y&2)!==0;if(_?(y=y&1|2,t.flags|=128):y&=1,K(bt,y),Dt(e,t,i,n),i=Ye?xr:0,!_&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vh(e,n,t);else if(e.tag===19)Vh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Ms(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),oc(t,!1,c,n,h,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Ms(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}oc(t,!0,n,null,h,i);break;case"together":oc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function Zn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Sa|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Oi(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Kn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Kn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Os(e)))}function cy(e,t,n){switch(t.tag){case 3:he(t,t.stateNode.containerInfo),pa(t,jt,e.memoizedState.cache),Ya();break;case 27:case 5:Ue(t);break;case 4:he(t,t.stateNode.containerInfo);break;case 10:pa(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,zo(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(ba(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Hh(e,t,n):(ba(t),e=Zn(e,t,n),e!==null?e.sibling:null);ba(t);break;case 19:var c=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Oi(e,t,n,!1),i=(n&t.childLanes)!==0),c){if(i)return $h(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),K(bt,bt.current),i)break;return null;case 22:return t.lanes=0,Dh(e,t,n,t.pendingProps);case 24:pa(t,jt,e.memoizedState.cache)}return Zn(e,t,n)}function Ph(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)wt=!0;else{if(!cc(e,n)&&(t.flags&128)===0)return wt=!1,cy(e,t,n);wt=(e.flags&131072)!==0}else wt=!1,Ye&&(t.flags&1048576)!==0&&jd(t,xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=Fa(t.elementType),t.type=e,typeof e=="function")go(e)?(i=ti(e,i),t.tag=1,t=Lh(null,t,e,i,n)):(t.tag=0,t=nc(null,t,e,i,n));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=kh(null,t,e,i,n);break e}else if(c===D){t.tag=14,t=Uh(null,t,e,i,n);break e}}throw t=W(e)||e,Error(l(306,t,""))}}return t;case 0:return nc(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,c=ti(i,t.pendingProps),Lh(e,t,i,c,n);case 3:e:{if(he(t,t.stateNode.containerInfo),e===null)throw Error(l(387));i=t.pendingProps;var h=t.memoizedState;c=h.element,Oo(e,t),Or(t,i,null,n);var y=t.memoizedState;if(i=y.cache,pa(t,jt,i),i!==h.cache&&So(t,[jt],n,!0),Ar(),i=y.element,h.isDehydrated)if(h={element:i,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=Ih(e,t,i,n);break e}else if(i!==c){c=pn(Error(l(424)),t),jr(c),t=Ih(e,t,i,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ut=_n(e.firstChild),Ut=t,Ye=!0,fa=null,vn=!0,n=Dd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Ya(),i===c){t=Zn(e,t,n);break e}Dt(e,t,i,n)}t=t.child}return t;case 26:return Js(e,t),e===null?(n=ng(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ye||(n=t.type,e=t.pendingProps,i=dl(ae.current).createElement(n),i[xt]=t,i[Lt]=e,Bt(i,n,e),le(i),t.stateNode=i):t.memoizedState=ng(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ue(t),e===null&&Ye&&(i=t.stateNode=Wf(t.type,t.pendingProps,ae.current),Ut=t,vn=!0,c=ut,Aa(t.type)?(Vc=c,ut=_n(i.firstChild)):ut=c),Dt(e,t,t.pendingProps.children,n),Js(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ye&&((c=i=ut)&&(i=Ly(i,t.type,t.pendingProps,vn),i!==null?(t.stateNode=i,Ut=t,ut=_n(i.firstChild),vn=!1,c=!0):c=!1),c||ga(t)),Ue(t),c=t.type,h=t.pendingProps,y=e!==null?e.memoizedProps:null,i=h.children,Mc(c,h)?i=null:y!==null&&Mc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Bo(e,t,ey,null,null,n),Qr._currentValue=c),Js(e,t),Dt(e,t,i,n),t.child;case 6:return e===null&&Ye&&((e=n=ut)&&(n=Iy(n,t.pendingProps,vn),n!==null?(t.stateNode=n,Ut=t,ut=null,e=!0):e=!1),e||ga(t)),null;case 13:return Hh(e,t,n);case 4:return he(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Wa(t,null,i,n):Dt(e,t,i,n),t.child;case 11:return kh(e,t,t.type,t.pendingProps,n);case 7:return Dt(e,t,t.pendingProps,n),t.child;case 8:return Dt(e,t,t.pendingProps.children,n),t.child;case 12:return Dt(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,pa(t,t.type,i.value),Dt(e,t,i.children,n),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,Qa(t),c=zt(c),i=i(c),t.flags|=1,Dt(e,t,i,n),t.child;case 14:return Uh(e,t,t.type,t.pendingProps,n);case 15:return zh(e,t,t.type,t.pendingProps,n);case 19:return $h(e,t,n);case 31:return oy(e,t,n);case 22:return Dh(e,t,n,t.pendingProps);case 24:return Qa(t),i=zt(jt),e===null?(c=Co(),c===null&&(c=it,h=wo(),c.pooledCache=h,h.refCount++,h!==null&&(c.pooledCacheLanes|=n),c=h),t.memoizedState={parent:i,cache:c},Ao(t),pa(t,jt,c)):((e.lanes&n)!==0&&(Oo(e,t),Or(t,null,null,n),Ar()),c=e.memoizedState,h=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),pa(t,jt,i)):(i=h.cache,pa(t,jt,i),i!==c.cache&&So(t,[jt],n,!0))),Dt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Wn(e){e.flags|=4}function uc(e,t,n,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(vf())e.flags|=8192;else throw Za=Us,To}else e.flags&=-16777217}function Gh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!lg(t))if(vf())e.flags|=8192;else throw Za=Us,To}function Xs(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?hs():536870912,e.lanes|=t,Hi|=t)}function Dr(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function dt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function uy(e,t,n){var i=t.pendingProps;switch(vo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dt(t),null;case 1:return dt(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Qn(jt),xe(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ai(t)?Wn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,_o())),dt(t),null;case 26:var c=t.type,h=t.memoizedState;return e===null?(Wn(t),h!==null?(dt(t),Gh(t,h)):(dt(t),uc(t,c,null,i,n))):h?h!==e.memoizedState?(Wn(t),dt(t),Gh(t,h)):(dt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&Wn(t),dt(t),uc(t,c,e,i,n)),null;case 27:if(Pe(t),n=ae.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return dt(t),null}e=J.current,Ai(t)?wd(t):(e=Wf(c,i,n),t.stateNode=e,Wn(t))}return dt(t),null;case 5:if(Pe(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return dt(t),null}if(h=J.current,Ai(t))wd(t);else{var y=dl(ae.current);switch(h){case 1:h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":h=y.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?h.multiple=!0:i.size&&(h.size=i.size);break;default:h=typeof i.is=="string"?y.createElement(c,{is:i.is}):y.createElement(c)}}h[xt]=t,h[Lt]=i;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)h.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=h;e:switch(Bt(h,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Wn(t)}}return dt(t),uc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Wn(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(l(166));if(e=ae.current,Ai(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,c=Ut,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[xt]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Vf(e.nodeValue,n)),e||ga(t,!0)}else e=dl(e).createTextNode(i),e[xt]=t,t.stateNode=e}return dt(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(i=Ai(t),n!==null){if(e===null){if(!i)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[xt]=t}else Ya(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;dt(t),e=!1}else n=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(rn(t),t):(rn(t),null);if((t.flags&128)!==0)throw Error(l(558))}return dt(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Ai(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[xt]=t}else Ya(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;dt(t),c=!1}else c=_o(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(rn(t),t):(rn(t),null)}return rn(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,e=e!==null&&e.memoizedState!==null,n&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==c&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Xs(t,t.updateQueue),dt(t),null);case 4:return xe(),e===null&&kc(t.stateNode.containerInfo),dt(t),null;case 10:return Qn(t.type),dt(t),null;case 19:if(z(bt),i=t.memoizedState,i===null)return dt(t),null;if(c=(t.flags&128)!==0,h=i.rendering,h===null)if(c)Dr(i,!1);else{if(yt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=Ms(e),h!==null){for(t.flags|=128,Dr(i,!1),e=h.updateQueue,t.updateQueue=e,Xs(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)bd(n,e),n=n.sibling;return K(bt,bt.current&1|2),Ye&&Yn(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Rt()>tl&&(t.flags|=128,c=!0,Dr(i,!1),t.lanes=4194304)}else{if(!c)if(e=Ms(h),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,Xs(t,e),Dr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!h.alternate&&!Ye)return dt(t),null}else 2*Rt()-i.renderingStartTime>tl&&n!==536870912&&(t.flags|=128,c=!0,Dr(i,!1),t.lanes=4194304);i.isBackwards?(h.sibling=t.child,t.child=h):(e=i.last,e!==null?e.sibling=h:t.child=h,i.last=h)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Rt(),e.sibling=null,n=bt.current,K(bt,c?n&1|2:n&1),Ye&&Yn(t,i.treeForkCount),e):(dt(t),null);case 22:case 23:return rn(t),Uo(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(dt(t),t.subtreeFlags&6&&(t.flags|=8192)):dt(t),n=t.updateQueue,n!==null&&Xs(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&z(Xa),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Qn(jt),dt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function dy(e,t){switch(vo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qn(jt),xe(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Pe(t),null;case 31:if(t.memoizedState!==null){if(rn(t),t.alternate===null)throw Error(l(340));Ya()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(rn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Ya()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return z(bt),null;case 4:return xe(),null;case 10:return Qn(t.type),null;case 22:case 23:return rn(t),Uo(),e!==null&&z(Xa),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Qn(jt),null;case 25:return null;default:return null}}function Kh(e,t){switch(vo(t),t.tag){case 3:Qn(jt),xe();break;case 26:case 27:case 5:Pe(t);break;case 4:xe();break;case 31:t.memoizedState!==null&&rn(t);break;case 13:rn(t);break;case 19:z(bt);break;case 10:Qn(t.type);break;case 22:case 23:rn(t),Uo(),e!==null&&z(Xa);break;case 24:Qn(jt)}}function Br(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var c=i.next;n=c;do{if((n.tag&e)===e){i=void 0;var h=n.create,y=n.inst;i=h(),y.destroy=i}n=n.next}while(n!==c)}}catch(_){We(t,t.return,_)}}function xa(e,t,n){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var h=c.next;i=h;do{if((i.tag&e)===e){var y=i.inst,_=y.destroy;if(_!==void 0){y.destroy=void 0,c=t;var R=n,P=_;try{P()}catch(ee){We(c,R,ee)}}}i=i.next}while(i!==h)}}catch(ee){We(t,t.return,ee)}}function Yh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Md(t,n)}catch(i){We(e,e.return,i)}}}function Jh(e,t,n){n.props=ti(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){We(e,t,i)}}function Mr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof n=="function"?e.refCleanup=n(i):n.current=i}}catch(c){We(e,t,c)}}function In(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(c){We(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){We(e,t,c)}else n.current=null}function Qh(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(c){We(e,e.return,c)}}function dc(e,t,n){try{var i=e.stateNode;Uy(i,e.type,n,t),i[Lt]=t}catch(c){We(e,e.return,c)}}function Xh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Aa(e.type)||e.tag===4}function hc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Xh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Aa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fc(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pn));else if(i!==4&&(i===27&&Aa(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(fc(e,t,n),e=e.sibling;e!==null;)fc(e,t,n),e=e.sibling}function Fs(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(i===27&&Aa(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Fs(e,t,n),e=e.sibling;e!==null;)Fs(e,t,n),e=e.sibling}function Fh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Bt(t,i,n),t[xt]=e,t[Lt]=n}catch(h){We(e,e.return,h)}}var ea=!1,Et=!1,gc=!1,Zh=typeof WeakSet=="function"?WeakSet:Set,Nt=null;function hy(e,t){if(e=e.containerInfo,Dc=vl,e=ud(e),so(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var c=i.anchorOffset,h=i.focusNode;i=i.focusOffset;try{n.nodeType,h.nodeType}catch{n=null;break e}var y=0,_=-1,R=-1,P=0,ee=0,se=e,Y=null;t:for(;;){for(var X;se!==n||c!==0&&se.nodeType!==3||(_=y+c),se!==h||i!==0&&se.nodeType!==3||(R=y+i),se.nodeType===3&&(y+=se.nodeValue.length),(X=se.firstChild)!==null;)Y=se,se=X;for(;;){if(se===e)break t;if(Y===n&&++P===c&&(_=y),Y===h&&++ee===i&&(R=y),(X=se.nextSibling)!==null)break;se=Y,Y=se.parentNode}se=X}n=_===-1||R===-1?null:{start:_,end:R}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bc={focusedElem:e,selectionRange:n},vl=!1,Nt=t;Nt!==null;)if(t=Nt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Nt=e;else for(;Nt!==null;){switch(t=Nt,h=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,n=t,c=h.memoizedProps,h=h.memoizedState,i=n.stateNode;try{var je=ti(n.type,c);e=i.getSnapshotBeforeUpdate(je,h),i.__reactInternalSnapshotBeforeUpdate=e}catch(Ae){We(n,n.return,Ae)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Lc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Lc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Nt=e;break}Nt=t.return}}function Wh(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:na(e,n),i&4&&Br(5,n);break;case 1:if(na(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){We(n,n.return,y)}else{var c=ti(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){We(n,n.return,y)}}i&64&&Yh(n),i&512&&Mr(n,n.return);break;case 3:if(na(e,n),i&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Md(e,t)}catch(y){We(n,n.return,y)}}break;case 27:t===null&&i&4&&Fh(n);case 26:case 5:na(e,n),t===null&&i&4&&Qh(n),i&512&&Mr(n,n.return);break;case 12:na(e,n);break;case 31:na(e,n),i&4&&nf(e,n);break;case 13:na(e,n),i&4&&af(e,n),i&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=xy.bind(null,n),Hy(e,n))));break;case 22:if(i=n.memoizedState!==null||ea,!i){t=t!==null&&t.memoizedState!==null||Et,c=ea;var h=Et;ea=i,(Et=t)&&!h?aa(e,n,(n.subtreeFlags&8772)!==0):na(e,n),ea=c,Et=h}break;case 30:break;default:na(e,n)}}function ef(e){var t=e.alternate;t!==null&&(e.alternate=null,ef(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&ve(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ft=null,Xt=!1;function ta(e,t,n){for(n=n.child;n!==null;)tf(e,t,n),n=n.sibling}function tf(e,t,n){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(qa,n)}catch{}switch(n.tag){case 26:Et||In(n,t),ta(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Et||In(n,t);var i=ft,c=Xt;Aa(n.type)&&(ft=n.stateNode,Xt=!1),ta(e,t,n),Kr(n.stateNode),ft=i,Xt=c;break;case 5:Et||In(n,t);case 6:if(i=ft,c=Xt,ft=null,ta(e,t,n),ft=i,Xt=c,ft!==null)if(Xt)try{(ft.nodeType===9?ft.body:ft.nodeName==="HTML"?ft.ownerDocument.body:ft).removeChild(n.stateNode)}catch(h){We(n,t,h)}else try{ft.removeChild(n.stateNode)}catch(h){We(n,t,h)}break;case 18:ft!==null&&(Xt?(e=ft,Jf(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Qi(e)):Jf(ft,n.stateNode));break;case 4:i=ft,c=Xt,ft=n.stateNode.containerInfo,Xt=!0,ta(e,t,n),ft=i,Xt=c;break;case 0:case 11:case 14:case 15:xa(2,n,t),Et||xa(4,n,t),ta(e,t,n);break;case 1:Et||(In(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Jh(n,t,i)),ta(e,t,n);break;case 21:ta(e,t,n);break;case 22:Et=(i=Et)||n.memoizedState!==null,ta(e,t,n),Et=i;break;default:ta(e,t,n)}}function nf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Qi(e)}catch(n){We(t,t.return,n)}}}function af(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Qi(e)}catch(n){We(t,t.return,n)}}function fy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Zh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Zh),t;default:throw Error(l(435,e.tag))}}function Zs(e,t){var n=fy(e);t.forEach(function(i){if(!n.has(i)){n.add(i);var c=jy.bind(null,e,i);i.then(c,c)}})}function Ft(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var c=n[i],h=e,y=t,_=y;e:for(;_!==null;){switch(_.tag){case 27:if(Aa(_.type)){ft=_.stateNode,Xt=!1;break e}break;case 5:ft=_.stateNode,Xt=!1;break e;case 3:case 4:ft=_.stateNode.containerInfo,Xt=!0;break e}_=_.return}if(ft===null)throw Error(l(160));tf(h,y,c),ft=null,Xt=!1,h=c.alternate,h!==null&&(h.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)rf(t,e),t=t.sibling}var An=null;function rf(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ft(t,e),Zt(e),i&4&&(xa(3,e,e.return),Br(3,e),xa(5,e,e.return));break;case 1:Ft(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),i&64&&ea&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var c=An;if(Ft(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),i&4){var h=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":h=c.getElementsByTagName("title")[0],(!h||h[oe]||h[xt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=c.createElement(i),c.head.insertBefore(h,c.querySelector("head > title"))),Bt(h,i,n),h[xt]=e,le(h),i=h;break e;case"link":var y=rg("link","href",c).get(i+(n.href||""));if(y){for(var _=0;_<y.length;_++)if(h=y[_],h.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&h.getAttribute("rel")===(n.rel==null?null:n.rel)&&h.getAttribute("title")===(n.title==null?null:n.title)&&h.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(_,1);break t}}h=c.createElement(i),Bt(h,i,n),c.head.appendChild(h);break;case"meta":if(y=rg("meta","content",c).get(i+(n.content||""))){for(_=0;_<y.length;_++)if(h=y[_],h.getAttribute("content")===(n.content==null?null:""+n.content)&&h.getAttribute("name")===(n.name==null?null:n.name)&&h.getAttribute("property")===(n.property==null?null:n.property)&&h.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&h.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(_,1);break t}}h=c.createElement(i),Bt(h,i,n),c.head.appendChild(h);break;default:throw Error(l(468,i))}h[xt]=e,le(h),i=h}e.stateNode=i}else sg(c,e.type,e.stateNode);else e.stateNode=ig(c,i,e.memoizedProps);else h!==i?(h===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):h.count--,i===null?sg(c,e.type,e.stateNode):ig(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&dc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ft(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),n!==null&&i&4&&dc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ft(t,e),Zt(e),i&512&&(Et||n===null||In(n,n.return)),e.flags&32){c=e.stateNode;try{vi(c,"")}catch(je){We(e,e.return,je)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,dc(e,c,n!==null?n.memoizedProps:c)),i&1024&&(gc=!0);break;case 6:if(Ft(t,e),Zt(e),i&4){if(e.stateNode===null)throw Error(l(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(je){We(e,e.return,je)}}break;case 3:if(gl=null,c=An,An=hl(t.containerInfo),Ft(t,e),An=c,Zt(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Qi(t.containerInfo)}catch(je){We(e,e.return,je)}gc&&(gc=!1,sf(e));break;case 4:i=An,An=hl(e.stateNode.containerInfo),Ft(t,e),Zt(e),An=i;break;case 12:Ft(t,e),Zt(e);break;case 31:Ft(t,e),Zt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 13:Ft(t,e),Zt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(el=Rt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 22:c=e.memoizedState!==null;var R=n!==null&&n.memoizedState!==null,P=ea,ee=Et;if(ea=P||c,Et=ee||R,Ft(t,e),Et=ee,ea=P,Zt(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||R||ea||Et||ni(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){R=n=t;try{if(h=R.stateNode,c)y=h.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{_=R.stateNode;var se=R.memoizedProps.style,Y=se!=null&&se.hasOwnProperty("display")?se.display:null;_.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(je){We(R,R.return,je)}}}else if(t.tag===6){if(n===null){R=t;try{R.stateNode.nodeValue=c?"":R.memoizedProps}catch(je){We(R,R.return,je)}}}else if(t.tag===18){if(n===null){R=t;try{var X=R.stateNode;c?Qf(X,!0):Qf(R.stateNode,!1)}catch(je){We(R,R.return,je)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,Zs(e,n))));break;case 19:Ft(t,e),Zt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Zs(e,i)));break;case 30:break;case 21:break;default:Ft(t,e),Zt(e)}}function Zt(e){var t=e.flags;if(t&2){try{for(var n,i=e.return;i!==null;){if(Xh(i)){n=i;break}i=i.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,h=hc(e);Fs(e,h,c);break;case 5:var y=n.stateNode;n.flags&32&&(vi(y,""),n.flags&=-33);var _=hc(e);Fs(e,_,y);break;case 3:case 4:var R=n.stateNode.containerInfo,P=hc(e);fc(e,P,R);break;default:throw Error(l(161))}}catch(ee){We(e,e.return,ee)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;sf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function na(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Wh(e,t.alternate,t),t=t.sibling}function ni(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:xa(4,t,t.return),ni(t);break;case 1:In(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Jh(t,t.return,n),ni(t);break;case 27:Kr(t.stateNode);case 26:case 5:In(t,t.return),ni(t);break;case 22:t.memoizedState===null&&ni(t);break;case 30:ni(t);break;default:ni(t)}e=e.sibling}}function aa(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,h=t,y=h.flags;switch(h.tag){case 0:case 11:case 15:aa(c,h,n),Br(4,h);break;case 1:if(aa(c,h,n),i=h,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(P){We(i,i.return,P)}if(i=h,c=i.updateQueue,c!==null){var _=i.stateNode;try{var R=c.shared.hiddenCallbacks;if(R!==null)for(c.shared.hiddenCallbacks=null,c=0;c<R.length;c++)Bd(R[c],_)}catch(P){We(i,i.return,P)}}n&&y&64&&Yh(h),Mr(h,h.return);break;case 27:Fh(h);case 26:case 5:aa(c,h,n),n&&i===null&&y&4&&Qh(h),Mr(h,h.return);break;case 12:aa(c,h,n);break;case 31:aa(c,h,n),n&&y&4&&nf(c,h);break;case 13:aa(c,h,n),n&&y&4&&af(c,h);break;case 22:h.memoizedState===null&&aa(c,h,n),Mr(h,h.return);break;case 30:break;default:aa(c,h,n)}t=t.sibling}}function pc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Sr(n))}function mc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Sr(e))}function On(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)lf(e,t,n,i),t=t.sibling}function lf(e,t,n,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:On(e,t,n,i),c&2048&&Br(9,t);break;case 1:On(e,t,n,i);break;case 3:On(e,t,n,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Sr(e)));break;case 12:if(c&2048){On(e,t,n,i),e=t.stateNode;try{var h=t.memoizedProps,y=h.id,_=h.onPostCommit;typeof _=="function"&&_(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(R){We(t,t.return,R)}}else On(e,t,n,i);break;case 31:On(e,t,n,i);break;case 13:On(e,t,n,i);break;case 23:break;case 22:h=t.stateNode,y=t.alternate,t.memoizedState!==null?h._visibility&2?On(e,t,n,i):qr(e,t):h._visibility&2?On(e,t,n,i):(h._visibility|=2,qi(e,t,n,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&pc(y,t);break;case 24:On(e,t,n,i),c&2048&&mc(t.alternate,t);break;default:On(e,t,n,i)}}function qi(e,t,n,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var h=e,y=t,_=n,R=i,P=y.flags;switch(y.tag){case 0:case 11:case 15:qi(h,y,_,R,c),Br(8,y);break;case 23:break;case 22:var ee=y.stateNode;y.memoizedState!==null?ee._visibility&2?qi(h,y,_,R,c):qr(h,y):(ee._visibility|=2,qi(h,y,_,R,c)),c&&P&2048&&pc(y.alternate,y);break;case 24:qi(h,y,_,R,c),c&&P&2048&&mc(y.alternate,y);break;default:qi(h,y,_,R,c)}t=t.sibling}}function qr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,c=i.flags;switch(i.tag){case 22:qr(n,i),c&2048&&pc(i.alternate,i);break;case 24:qr(n,i),c&2048&&mc(i.alternate,i);break;default:qr(n,i)}t=t.sibling}}var Lr=8192;function Li(e,t,n){if(e.subtreeFlags&Lr)for(e=e.child;e!==null;)of(e,t,n),e=e.sibling}function of(e,t,n){switch(e.tag){case 26:Li(e,t,n),e.flags&Lr&&e.memoizedState!==null&&Wy(n,An,e.memoizedState,e.memoizedProps);break;case 5:Li(e,t,n);break;case 3:case 4:var i=An;An=hl(e.stateNode.containerInfo),Li(e,t,n),An=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=Lr,Lr=16777216,Li(e,t,n),Lr=i):Li(e,t,n));break;default:Li(e,t,n)}}function cf(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Ir(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Nt=i,df(i,e)}cf(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)uf(e),e=e.sibling}function uf(e){switch(e.tag){case 0:case 11:case 15:Ir(e),e.flags&2048&&xa(9,e,e.return);break;case 3:Ir(e);break;case 12:Ir(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Ws(e)):Ir(e);break;default:Ir(e)}}function Ws(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];Nt=i,df(i,e)}cf(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:xa(8,t,t.return),Ws(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Ws(t));break;default:Ws(t)}e=e.sibling}}function df(e,t){for(;Nt!==null;){var n=Nt;switch(n.tag){case 0:case 11:case 15:xa(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Sr(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,Nt=i;else e:for(n=e;Nt!==null;){i=Nt;var c=i.sibling,h=i.return;if(ef(i),i===n){Nt=null;break e}if(c!==null){c.return=h,Nt=c;break e}Nt=h}}}var gy={getCacheForType:function(e){var t=zt(jt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return zt(jt).controller.signal}},py=typeof WeakMap=="function"?WeakMap:Map,Fe=0,it=null,Ve=null,Ge=0,Ze=0,sn=null,ja=!1,Ii=!1,yc=!1,ia=0,yt=0,Sa=0,ai=0,vc=0,ln=0,Hi=0,Hr=null,Wt=null,bc=!1,el=0,hf=0,tl=1/0,nl=null,wa=null,At=0,Ea=null,Vi=null,ra=0,_c=0,xc=null,ff=null,Vr=0,jc=null;function on(){return(Fe&2)!==0&&Ge!==0?Ge&-Ge:C.T!==null?Ac():Bn()}function gf(){if(ln===0)if((Ge&536870912)===0||Ye){var e=dn;dn<<=1,(dn&3932160)===0&&(dn=262144),ln=e}else ln=536870912;return e=an.current,e!==null&&(e.flags|=32),ln}function en(e,t,n){(e===it&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)&&($i(e,0),Ca(e,Ge,ln,!1)),En(e,n),((Fe&2)===0||e!==it)&&(e===it&&((Fe&2)===0&&(ai|=n),yt===4&&Ca(e,Ge,ln,!1)),Hn(e))}function pf(e,t,n){if((Fe&6)!==0)throw Error(l(327));var i=!n&&(t&127)===0&&(t&e.expiredLanes)===0||La(e,t),c=i?vy(e,t):wc(e,t,!0),h=i;do{if(c===0){Ii&&!i&&Ca(e,t,0,!1);break}else{if(n=e.current.alternate,h&&!my(n)){c=wc(e,t,!1),h=!1;continue}if(c===2){if(h=t,e.errorRecoveryDisabledLanes&h)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var _=e;c=Hr;var R=_.current.memoizedState.isDehydrated;if(R&&($i(_,y).flags|=256),y=wc(_,y,!1),y!==2){if(yc&&!R){_.errorRecoveryDisabledLanes|=h,ai|=h,c=4;break e}h=Wt,Wt=c,h!==null&&(Wt===null?Wt=h:Wt.push.apply(Wt,h))}c=y}if(h=!1,c!==2)continue}}if(c===1){$i(e,0),Ca(e,t,0,!0);break}e:{switch(i=e,h=c,h){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Ca(i,t,ln,!ja);break e;case 2:Wt=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=el+300-Rt(),10<c)){if(Ca(i,t,ln,!ja),pi(i,0,!0)!==0)break e;ra=t,i.timeoutHandle=Kf(mf.bind(null,i,n,Wt,nl,bc,t,ln,ai,Hi,ja,h,"Throttled",-0,0),c);break e}mf(i,n,Wt,nl,bc,t,ln,ai,Hi,ja,h,null,-0,0)}}break}while(!0);Hn(e)}function mf(e,t,n,i,c,h,y,_,R,P,ee,se,Y,X){if(e.timeoutHandle=-1,se=t.subtreeFlags,se&8192||(se&16785408)===16785408){se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pn},of(t,h,se);var je=(h&62914560)===h?el-Rt():(h&4194048)===h?hf-Rt():0;if(je=ev(se,je),je!==null){ra=h,e.cancelPendingCommit=je(wf.bind(null,e,t,h,n,i,c,y,_,R,ee,se,null,Y,X)),Ca(e,h,y,!P);return}}wf(e,t,h,n,i,c,y,_,R)}function my(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var c=n[i],h=c.getSnapshot;c=c.value;try{if(!tn(h(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ca(e,t,n,i){t&=~vc,t&=~ai,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var h=31-Pt(c),y=1<<h;i[h]=-1,c&=~y}n!==0&&fs(e,n,t)}function al(){return(Fe&6)===0?($r(0),!1):!0}function Sc(){if(Ve!==null){if(Ze===0)var e=Ve.return;else e=Ve,Jn=Ja=null,Lo(e),Ui=null,Er=0,e=Ve;for(;e!==null;)Kh(e.alternate,e),e=e.return;Ve=null}}function $i(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,By(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),ra=0,Sc(),it=e,Ve=n=Kn(e.current,null),Ge=t,Ze=0,sn=null,ja=!1,Ii=La(e,t),yc=!1,Hi=ln=vc=ai=Sa=yt=0,Wt=Hr=null,bc=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-Pt(i),h=1<<c;t|=e[c],i&=~h}return ia=t,ws(),n}function yf(e,t){Me=null,C.H=Ur,t===ki||t===ks?(t=kd(),Ze=3):t===To?(t=kd(),Ze=4):Ze=t===tc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,sn=t,Ve===null&&(yt=1,Ks(e,pn(t,e.current)))}function vf(){var e=an.current;return e===null?!0:(Ge&4194048)===Ge?bn===null:(Ge&62914560)===Ge||(Ge&536870912)!==0?e===bn:!1}function bf(){var e=C.H;return C.H=Ur,e===null?Ur:e}function _f(){var e=C.A;return C.A=gy,e}function il(){yt=4,ja||(Ge&4194048)!==Ge&&an.current!==null||(Ii=!0),(Sa&134217727)===0&&(ai&134217727)===0||it===null||Ca(it,Ge,ln,!1)}function wc(e,t,n){var i=Fe;Fe|=2;var c=bf(),h=_f();(it!==e||Ge!==t)&&(nl=null,$i(e,t)),t=!1;var y=yt;e:do try{if(Ze!==0&&Ve!==null){var _=Ve,R=sn;switch(Ze){case 8:Sc(),y=6;break e;case 3:case 2:case 9:case 6:an.current===null&&(t=!0);var P=Ze;if(Ze=0,sn=null,Pi(e,_,R,P),n&&Ii){y=0;break e}break;default:P=Ze,Ze=0,sn=null,Pi(e,_,R,P)}}yy(),y=yt;break}catch(ee){yf(e,ee)}while(!0);return t&&e.shellSuspendCounter++,Jn=Ja=null,Fe=i,C.H=c,C.A=h,Ve===null&&(it=null,Ge=0,ws()),y}function yy(){for(;Ve!==null;)xf(Ve)}function vy(e,t){var n=Fe;Fe|=2;var i=bf(),c=_f();it!==e||Ge!==t?(nl=null,tl=Rt()+500,$i(e,t)):Ii=La(e,t);e:do try{if(Ze!==0&&Ve!==null){t=Ve;var h=sn;t:switch(Ze){case 1:Ze=0,sn=null,Pi(e,t,h,1);break;case 2:case 9:if(Nd(h)){Ze=0,sn=null,jf(t);break}t=function(){Ze!==2&&Ze!==9||it!==e||(Ze=7),Hn(e)},h.then(t,t);break e;case 3:Ze=7;break e;case 4:Ze=5;break e;case 7:Nd(h)?(Ze=0,sn=null,jf(t)):(Ze=0,sn=null,Pi(e,t,h,7));break;case 5:var y=null;switch(Ve.tag){case 26:y=Ve.memoizedState;case 5:case 27:var _=Ve;if(y?lg(y):_.stateNode.complete){Ze=0,sn=null;var R=_.sibling;if(R!==null)Ve=R;else{var P=_.return;P!==null?(Ve=P,rl(P)):Ve=null}break t}}Ze=0,sn=null,Pi(e,t,h,5);break;case 6:Ze=0,sn=null,Pi(e,t,h,6);break;case 8:Sc(),yt=6;break e;default:throw Error(l(462))}}by();break}catch(ee){yf(e,ee)}while(!0);return Jn=Ja=null,C.H=i,C.A=c,Fe=n,Ve!==null?0:(it=null,Ge=0,ws(),yt)}function by(){for(;Ve!==null&&!Un();)xf(Ve)}function xf(e){var t=Ph(e.alternate,e,ia);e.memoizedProps=e.pendingProps,t===null?rl(e):Ve=t}function jf(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=qh(n,t,t.pendingProps,t.type,void 0,Ge);break;case 11:t=qh(n,t,t.pendingProps,t.type.render,t.ref,Ge);break;case 5:Lo(t);default:Kh(n,t),t=Ve=bd(t,ia),t=Ph(n,t,ia)}e.memoizedProps=e.pendingProps,t===null?rl(e):Ve=t}function Pi(e,t,n,i){Jn=Ja=null,Lo(t),Ui=null,Er=0;var c=t.return;try{if(ly(e,c,t,n,Ge)){yt=1,Ks(e,pn(n,e.current)),Ve=null;return}}catch(h){if(c!==null)throw Ve=c,h;yt=1,Ks(e,pn(n,e.current)),Ve=null;return}t.flags&32768?(Ye||i===1?e=!0:Ii||(Ge&536870912)!==0?e=!1:(ja=e=!0,(i===2||i===9||i===3||i===6)&&(i=an.current,i!==null&&i.tag===13&&(i.flags|=16384))),Sf(t,e)):rl(t)}function rl(e){var t=e;do{if((t.flags&32768)!==0){Sf(t,ja);return}e=t.return;var n=uy(t.alternate,t,ia);if(n!==null){Ve=n;return}if(t=t.sibling,t!==null){Ve=t;return}Ve=t=e}while(t!==null);yt===0&&(yt=5)}function Sf(e,t){do{var n=dy(e.alternate,e);if(n!==null){n.flags&=32767,Ve=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ve=e;return}Ve=e=n}while(e!==null);yt=6,Ve=null}function wf(e,t,n,i,c,h,y,_,R){e.cancelPendingCommit=null;do sl();while(At!==0);if((Fe&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(h=t.lanes|t.childLanes,h|=ho,Kl(e,n,h,y,_,R),e===it&&(Ve=it=null,Ge=0),Vi=t,Ea=e,ra=n,_c=h,xc=c,ff=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Sy(Ma,function(){return Of(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=C.T,C.T=null,c=U.p,U.p=2,y=Fe,Fe|=4;try{hy(e,t,n)}finally{Fe=y,U.p=c,C.T=i}}At=1,Ef(),Cf(),Tf()}}function Ef(){if(At===1){At=0;var e=Ea,t=Vi,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=C.T,C.T=null;var i=U.p;U.p=2;var c=Fe;Fe|=4;try{rf(t,e);var h=Bc,y=ud(e.containerInfo),_=h.focusedElem,R=h.selectionRange;if(y!==_&&_&&_.ownerDocument&&cd(_.ownerDocument.documentElement,_)){if(R!==null&&so(_)){var P=R.start,ee=R.end;if(ee===void 0&&(ee=P),"selectionStart"in _)_.selectionStart=P,_.selectionEnd=Math.min(ee,_.value.length);else{var se=_.ownerDocument||document,Y=se&&se.defaultView||window;if(Y.getSelection){var X=Y.getSelection(),je=_.textContent.length,Ae=Math.min(R.start,je),nt=R.end===void 0?Ae:Math.min(R.end,je);!X.extend&&Ae>nt&&(y=nt,nt=Ae,Ae=y);var I=od(_,Ae),k=od(_,nt);if(I&&k&&(X.rangeCount!==1||X.anchorNode!==I.node||X.anchorOffset!==I.offset||X.focusNode!==k.node||X.focusOffset!==k.offset)){var $=se.createRange();$.setStart(I.node,I.offset),X.removeAllRanges(),Ae>nt?(X.addRange($),X.extend(k.node,k.offset)):($.setEnd(k.node,k.offset),X.addRange($))}}}}for(se=[],X=_;X=X.parentNode;)X.nodeType===1&&se.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<se.length;_++){var ne=se[_];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}vl=!!Dc,Bc=Dc=null}finally{Fe=c,U.p=i,C.T=n}}e.current=t,At=2}}function Cf(){if(At===2){At=0;var e=Ea,t=Vi,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=C.T,C.T=null;var i=U.p;U.p=2;var c=Fe;Fe|=4;try{Wh(e,t.alternate,t)}finally{Fe=c,U.p=i,C.T=n}}At=3}}function Tf(){if(At===4||At===3){At=0,Hl();var e=Ea,t=Vi,n=ra,i=ff;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?At=5:(At=0,Vi=Ea=null,Af(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(wa=null),Ha(n),t=t.stateNode,$t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(qa,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=C.T,c=U.p,U.p=2,C.T=null;try{for(var h=e.onRecoverableError,y=0;y<i.length;y++){var _=i[y];h(_.value,{componentStack:_.stack})}}finally{C.T=t,U.p=c}}(ra&3)!==0&&sl(),Hn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===jc?Vr++:(Vr=0,jc=e):Vr=0,$r(0)}}function Af(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Sr(t)))}function sl(){return Ef(),Cf(),Tf(),Of()}function Of(){if(At!==5)return!1;var e=Ea,t=_c;_c=0;var n=Ha(ra),i=C.T,c=U.p;try{U.p=32>n?32:n,C.T=null,n=xc,xc=null;var h=Ea,y=ra;if(At=0,Vi=Ea=null,ra=0,(Fe&6)!==0)throw Error(l(331));var _=Fe;if(Fe|=4,uf(h.current),lf(h,h.current,y,n),Fe=_,$r(0,!1),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(qa,h)}catch{}return!0}finally{U.p=c,C.T=i,Af(e,t)}}function Nf(e,t,n){t=pn(n,t),t=ec(e.stateNode,t,2),e=va(e,t,2),e!==null&&(En(e,2),Hn(e))}function We(e,t,n){if(e.tag===3)Nf(e,e,n);else for(;t!==null;){if(t.tag===3){Nf(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(wa===null||!wa.has(i))){e=pn(n,e),n=Nh(2),i=va(t,n,2),i!==null&&(Rh(n,i,t,e),En(i,2),Hn(i));break}}t=t.return}}function Ec(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new py;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(n)||(yc=!0,c.add(n),e=_y.bind(null,e,t,n),t.then(e,e))}function _y(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,it===e&&(Ge&n)===n&&(yt===4||yt===3&&(Ge&62914560)===Ge&&300>Rt()-el?(Fe&2)===0&&$i(e,0):vc|=n,Hi===Ge&&(Hi=0)),Hn(e)}function Rf(e,t){t===0&&(t=hs()),e=Ga(e,t),e!==null&&(En(e,t),Hn(e))}function xy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Rf(e,n)}function jy(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(t),Rf(e,n)}function Sy(e,t){return st(e,t)}var ll=null,Gi=null,Cc=!1,ol=!1,Tc=!1,Ta=0;function Hn(e){e!==Gi&&e.next===null&&(Gi===null?ll=Gi=e:Gi=Gi.next=e),ol=!0,Cc||(Cc=!0,Ey())}function $r(e,t){if(!Tc&&ol){Tc=!0;do for(var n=!1,i=ll;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var h=0;else{var y=i.suspendedLanes,_=i.pingedLanes;h=(1<<31-Pt(42|e)+1)-1,h&=c&~(y&~_),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(n=!0,Df(i,h))}else h=Ge,h=pi(i,i===it?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(h&3)===0||La(i,h)||(n=!0,Df(i,h));i=i.next}while(n);Tc=!1}}function wy(){kf()}function kf(){ol=Cc=!1;var e=0;Ta!==0&&Dy()&&(e=Ta);for(var t=Rt(),n=null,i=ll;i!==null;){var c=i.next,h=Uf(i,t);h===0?(i.next=null,n===null?ll=c:n.next=c,c===null&&(Gi=n)):(n=i,(e!==0||(h&3)!==0)&&(ol=!0)),i=c}At!==0&&At!==5||$r(e),Ta!==0&&(Ta=0)}function Uf(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var y=31-Pt(h),_=1<<y,R=c[y];R===-1?((_&n)===0||(_&i)!==0)&&(c[y]=lr(_,t)):R<=t&&(e.expiredLanes|=_),h&=~_}if(t=it,n=Ge,n=pi(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,n===0||e===t&&(Ze===2||Ze===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&ht(i),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||La(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&ht(i),Ha(n)){case 2:case 8:n=os;break;case 32:n=Ma;break;case 268435456:n=cs;break;default:n=Ma}return i=zf.bind(null,e),n=st(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&ht(i),e.callbackPriority=2,e.callbackNode=null,2}function zf(e,t){if(At!==0&&At!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(sl()&&e.callbackNode!==n)return null;var i=Ge;return i=pi(e,e===it?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(pf(e,i,t),Uf(e,Rt()),e.callbackNode!=null&&e.callbackNode===n?zf.bind(null,e):null)}function Df(e,t){if(sl())return null;pf(e,t,!0)}function Ey(){My(function(){(Fe&6)!==0?st(hi,wy):kf()})}function Ac(){if(Ta===0){var e=Ni;e===0&&(e=gi,gi<<=1,(gi&261888)===0&&(gi=256)),Ta=e}return Ta}function Bf(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ms(""+e)}function Mf(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Cy(e,t,n,i,c){if(t==="submit"&&n&&n.stateNode===c){var h=Bf((c[Lt]||null).action),y=i.submitter;y&&(t=(t=y[Lt]||null)?Bf(t.formAction):y.getAttribute("formAction"),t!==null&&(h=t,y=null));var _=new _s("action","action",null,i,c);e.push({event:_,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(Ta!==0){var R=y?Mf(c,y):new FormData(c);Jo(n,{pending:!0,data:R,method:c.method,action:h},null,R)}}else typeof h=="function"&&(_.preventDefault(),R=y?Mf(c,y):new FormData(c),Jo(n,{pending:!0,data:R,method:c.method,action:h},h,R))},currentTarget:c}]})}}for(var Oc=0;Oc<uo.length;Oc++){var Nc=uo[Oc],Ty=Nc.toLowerCase(),Ay=Nc[0].toUpperCase()+Nc.slice(1);Tn(Ty,"on"+Ay)}Tn(fd,"onAnimationEnd"),Tn(gd,"onAnimationIteration"),Tn(pd,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(Pm,"onTransitionRun"),Tn(Gm,"onTransitionStart"),Tn(Km,"onTransitionCancel"),Tn(md,"onTransitionEnd"),Gt("onMouseEnter",["mouseout","mouseover"]),Gt("onMouseLeave",["mouseout","mouseover"]),Gt("onPointerEnter",["pointerout","pointerover"]),Gt("onPointerLeave",["pointerout","pointerover"]),Ie("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ie("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ie("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ie("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ie("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ie("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pr));function qf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],c=i.event;i=i.listeners;e:{var h=void 0;if(t)for(var y=i.length-1;0<=y;y--){var _=i[y],R=_.instance,P=_.currentTarget;if(_=_.listener,R!==h&&c.isPropagationStopped())break e;h=_,c.currentTarget=P;try{h(c)}catch(ee){Ss(ee)}c.currentTarget=null,h=R}else for(y=0;y<i.length;y++){if(_=i[y],R=_.instance,P=_.currentTarget,_=_.listener,R!==h&&c.isPropagationStopped())break e;h=_,c.currentTarget=P;try{h(c)}catch(ee){Ss(ee)}c.currentTarget=null,h=R}}}}function $e(e,t){var n=t[ur];n===void 0&&(n=t[ur]=new Set);var i=e+"__bubble";n.has(i)||(Lf(t,e,2,!1),n.add(i))}function Rc(e,t,n){var i=0;t&&(i|=4),Lf(n,e,i,t)}var cl="_reactListening"+Math.random().toString(36).slice(2);function kc(e){if(!e[cl]){e[cl]=!0,Re.forEach(function(n){n!=="selectionchange"&&(Oy.has(n)||Rc(n,!1,e),Rc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[cl]||(t[cl]=!0,Rc("selectionchange",!1,t))}}function Lf(e,t,n,i){switch(gg(t)){case 2:var c=av;break;case 8:c=iv;break;default:c=Yc}n=c.bind(null,t,n,e),c=void 0,!Fl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Uc(e,t,n,i,c){var h=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var _=i.stateNode.containerInfo;if(_===c)break;if(y===4)for(y=i.return;y!==null;){var R=y.tag;if((R===3||R===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;_!==null;){if(y=be(_),y===null)return;if(R=y.tag,R===5||R===6||R===26||R===27){i=h=y;continue e}_=_.parentNode}}i=i.return}$u(function(){var P=h,ee=Ql(n),se=[];e:{var Y=yd.get(e);if(Y!==void 0){var X=_s,je=e;switch(e){case"keypress":if(vs(n)===0)break e;case"keydown":case"keyup":X=jm;break;case"focusin":je="focus",X=to;break;case"focusout":je="blur",X=to;break;case"beforeblur":case"afterblur":X=to;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=um;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=Em;break;case fd:case gd:case pd:X=fm;break;case md:X=Tm;break;case"scroll":case"scrollend":X=om;break;case"wheel":X=Om;break;case"copy":case"cut":case"paste":X=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Ju;break;case"toggle":case"beforetoggle":X=Rm}var Ae=(t&4)!==0,nt=!Ae&&(e==="scroll"||e==="scrollend"),I=Ae?Y!==null?Y+"Capture":null:Y;Ae=[];for(var k=P,$;k!==null;){var ne=k;if($=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||$===null||I===null||(ne=hr(k,I),ne!=null&&Ae.push(Gr(k,ne,$))),nt)break;k=k.return}0<Ae.length&&(Y=new X(Y,je,null,n,ee),se.push({event:Y,listeners:Ae}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",X=e==="mouseout"||e==="pointerout",Y&&n!==Jl&&(je=n.relatedTarget||n.fromElement)&&(be(je)||je[oa]))break e;if((X||Y)&&(Y=ee.window===ee?ee:(Y=ee.ownerDocument)?Y.defaultView||Y.parentWindow:window,X?(je=n.relatedTarget||n.toElement,X=P,je=je?be(je):null,je!==null&&(nt=d(je),Ae=je.tag,je!==nt||Ae!==5&&Ae!==27&&Ae!==6)&&(je=null)):(X=null,je=P),X!==je)){if(Ae=Ku,ne="onMouseLeave",I="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(Ae=Ju,ne="onPointerLeave",I="onPointerEnter",k="pointer"),nt=X==null?Y:Te(X),$=je==null?Y:Te(je),Y=new Ae(ne,k+"leave",X,n,ee),Y.target=nt,Y.relatedTarget=$,ne=null,be(ee)===P&&(Ae=new Ae(I,k+"enter",je,n,ee),Ae.target=$,Ae.relatedTarget=nt,ne=Ae),nt=ne,X&&je)t:{for(Ae=Ny,I=X,k=je,$=0,ne=I;ne;ne=Ae(ne))$++;ne=0;for(var Ce=k;Ce;Ce=Ae(Ce))ne++;for(;0<$-ne;)I=Ae(I),$--;for(;0<ne-$;)k=Ae(k),ne--;for(;$--;){if(I===k||k!==null&&I===k.alternate){Ae=I;break t}I=Ae(I),k=Ae(k)}Ae=null}else Ae=null;X!==null&&If(se,Y,X,Ae,!1),je!==null&&nt!==null&&If(se,nt,je,Ae,!0)}}e:{if(Y=P?Te(P):window,X=Y.nodeName&&Y.nodeName.toLowerCase(),X==="select"||X==="input"&&Y.type==="file")var Je=nd;else if(ed(Y))if(ad)Je=Hm;else{Je=Lm;var Se=qm}else X=Y.nodeName,!X||X.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?P&&Yl(P.elementType)&&(Je=nd):Je=Im;if(Je&&(Je=Je(e,P))){td(se,Je,n,ee);break e}Se&&Se(e,Y,P),e==="focusout"&&P&&Y.type==="number"&&P.memoizedProps.value!=null&&mi(Y,"number",Y.value)}switch(Se=P?Te(P):window,e){case"focusin":(ed(Se)||Se.contentEditable==="true")&&(ji=Se,lo=P,_r=null);break;case"focusout":_r=lo=ji=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,dd(se,n,ee);break;case"selectionchange":if($m)break;case"keydown":case"keyup":dd(se,n,ee)}var Le;if(ao)e:{switch(e){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else xi?Zu(e,n)&&(Ke="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Ke="onCompositionStart");Ke&&(Qu&&n.locale!=="ko"&&(xi||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&xi&&(Le=Pu()):(da=ee,Zl="value"in da?da.value:da.textContent,xi=!0)),Se=ul(P,Ke),0<Se.length&&(Ke=new Yu(Ke,e,null,n,ee),se.push({event:Ke,listeners:Se}),Le?Ke.data=Le:(Le=Wu(n),Le!==null&&(Ke.data=Le)))),(Le=Um?zm(e,n):Dm(e,n))&&(Ke=ul(P,"onBeforeInput"),0<Ke.length&&(Se=new Yu("onBeforeInput","beforeinput",null,n,ee),se.push({event:Se,listeners:Ke}),Se.data=Le)),Cy(se,e,P,n,ee)}qf(se,t)})}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ul(e,t){for(var n=t+"Capture",i=[];e!==null;){var c=e,h=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||h===null||(c=hr(e,n),c!=null&&i.unshift(Gr(e,c,h)),c=hr(e,t),c!=null&&i.push(Gr(e,c,h))),e.tag===3)return i;e=e.return}return[]}function Ny(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function If(e,t,n,i,c){for(var h=t._reactName,y=[];n!==null&&n!==i;){var _=n,R=_.alternate,P=_.stateNode;if(_=_.tag,R!==null&&R===i)break;_!==5&&_!==26&&_!==27||P===null||(R=P,c?(P=hr(n,h),P!=null&&y.unshift(Gr(n,P,R))):c||(P=hr(n,h),P!=null&&y.push(Gr(n,P,R)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var Ry=/\r\n?/g,ky=/\u0000|\uFFFD/g;function Hf(e){return(typeof e=="string"?e:""+e).replace(Ry,`
`).replace(ky,"")}function Vf(e,t){return t=Hf(t),Hf(e)===t}function tt(e,t,n,i,c,h){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||vi(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&vi(e,""+i);break;case"className":ca(e,"class",i);break;case"tabIndex":ca(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":ca(e,n,i);break;case"style":Hu(e,i,h);break;case"data":if(t!=="object"){ca(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(n==="formAction"?(t!=="input"&&tt(e,t,"name",c.name,c,null),tt(e,t,"formEncType",c.formEncType,c,null),tt(e,t,"formMethod",c.formMethod,c,null),tt(e,t,"formTarget",c.formTarget,c,null)):(tt(e,t,"encType",c.encType,c,null),tt(e,t,"method",c.method,c,null),tt(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=ms(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=Pn);break;case"onScroll":i!=null&&$e("scroll",e);break;case"onScrollEnd":i!=null&&$e("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=ms(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":$e("beforetoggle",e),$e("toggle",e),Jt(e,"popover",i);break;case"xlinkActuate":fn(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":fn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":fn(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":fn(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":fn(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":fn(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":fn(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":fn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":fn(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Jt(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=sm.get(n)||n,Jt(e,n,i))}}function zc(e,t,n,i,c,h){switch(n){case"style":Hu(e,i,h);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof i=="string"?vi(e,i):(typeof i=="number"||typeof i=="bigint")&&vi(e,""+i);break;case"onScroll":i!=null&&$e("scroll",e);break;case"onScrollEnd":i!=null&&$e("scrollend",e);break;case"onClick":i!=null&&(e.onclick=Pn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Be.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),h=e[Lt]||null,h=h!=null?h[n]:null,typeof h=="function"&&e.removeEventListener(t,h,c),typeof i=="function")){typeof h!="function"&&h!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,c);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):Jt(e,n,i)}}}function Bt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",e),$e("load",e);var i=!1,c=!1,h;for(h in n)if(n.hasOwnProperty(h)){var y=n[h];if(y!=null)switch(h){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:tt(e,t,h,y,n,null)}}c&&tt(e,t,"srcSet",n.srcSet,n,null),i&&tt(e,t,"src",n.src,n,null);return;case"input":$e("invalid",e);var _=h=y=c=null,R=null,P=null;for(i in n)if(n.hasOwnProperty(i)){var ee=n[i];if(ee!=null)switch(i){case"name":c=ee;break;case"type":y=ee;break;case"checked":R=ee;break;case"defaultChecked":P=ee;break;case"value":h=ee;break;case"defaultValue":_=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(l(137,t));break;default:tt(e,t,i,ee,n,null)}}dr(e,h,_,R,P,y,c,!1);return;case"select":$e("invalid",e),i=y=h=null;for(c in n)if(n.hasOwnProperty(c)&&(_=n[c],_!=null))switch(c){case"value":h=_;break;case"defaultValue":y=_;break;case"multiple":i=_;default:tt(e,t,c,_,n,null)}t=h,n=y,e.multiple=!!i,t!=null?yi(e,!!i,t,!1):n!=null&&yi(e,!!i,n,!0);return;case"textarea":$e("invalid",e),h=c=i=null;for(y in n)if(n.hasOwnProperty(y)&&(_=n[y],_!=null))switch(y){case"value":i=_;break;case"defaultValue":c=_;break;case"children":h=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(l(91));break;default:tt(e,t,y,_,n,null)}Lu(e,i,c,h);return;case"option":for(R in n)if(n.hasOwnProperty(R)&&(i=n[R],i!=null))switch(R){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:tt(e,t,R,i,n,null)}return;case"dialog":$e("beforetoggle",e),$e("toggle",e),$e("cancel",e),$e("close",e);break;case"iframe":case"object":$e("load",e);break;case"video":case"audio":for(i=0;i<Pr.length;i++)$e(Pr[i],e);break;case"image":$e("error",e),$e("load",e);break;case"details":$e("toggle",e);break;case"embed":case"source":case"link":$e("error",e),$e("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(P in n)if(n.hasOwnProperty(P)&&(i=n[P],i!=null))switch(P){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:tt(e,t,P,i,n,null)}return;default:if(Yl(t)){for(ee in n)n.hasOwnProperty(ee)&&(i=n[ee],i!==void 0&&zc(e,t,ee,i,n,void 0));return}}for(_ in n)n.hasOwnProperty(_)&&(i=n[_],i!=null&&tt(e,t,_,i,n,null))}function Uy(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,h=null,y=null,_=null,R=null,P=null,ee=null;for(X in n){var se=n[X];if(n.hasOwnProperty(X)&&se!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":R=se;default:i.hasOwnProperty(X)||tt(e,t,X,null,i,se)}}for(var Y in i){var X=i[Y];if(se=n[Y],i.hasOwnProperty(Y)&&(X!=null||se!=null))switch(Y){case"type":h=X;break;case"name":c=X;break;case"checked":P=X;break;case"defaultChecked":ee=X;break;case"value":y=X;break;case"defaultValue":_=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(l(137,t));break;default:X!==se&&tt(e,t,Y,X,i,se)}}kt(e,y,_,R,P,ee,h,c);return;case"select":X=y=_=Y=null;for(h in n)if(R=n[h],n.hasOwnProperty(h)&&R!=null)switch(h){case"value":break;case"multiple":X=R;default:i.hasOwnProperty(h)||tt(e,t,h,null,i,R)}for(c in i)if(h=i[c],R=n[c],i.hasOwnProperty(c)&&(h!=null||R!=null))switch(c){case"value":Y=h;break;case"defaultValue":_=h;break;case"multiple":y=h;default:h!==R&&tt(e,t,c,h,i,R)}t=_,n=y,i=X,Y!=null?yi(e,!!n,Y,!1):!!i!=!!n&&(t!=null?yi(e,!!n,t,!0):yi(e,!!n,n?[]:"",!1));return;case"textarea":X=Y=null;for(_ in n)if(c=n[_],n.hasOwnProperty(_)&&c!=null&&!i.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:tt(e,t,_,null,i,c)}for(y in i)if(c=i[y],h=n[y],i.hasOwnProperty(y)&&(c!=null||h!=null))switch(y){case"value":Y=c;break;case"defaultValue":X=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==h&&tt(e,t,y,c,i,h)}qu(e,Y,X);return;case"option":for(var je in n)if(Y=n[je],n.hasOwnProperty(je)&&Y!=null&&!i.hasOwnProperty(je))switch(je){case"selected":e.selected=!1;break;default:tt(e,t,je,null,i,Y)}for(R in i)if(Y=i[R],X=n[R],i.hasOwnProperty(R)&&Y!==X&&(Y!=null||X!=null))switch(R){case"selected":e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:tt(e,t,R,Y,i,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in n)Y=n[Ae],n.hasOwnProperty(Ae)&&Y!=null&&!i.hasOwnProperty(Ae)&&tt(e,t,Ae,null,i,Y);for(P in i)if(Y=i[P],X=n[P],i.hasOwnProperty(P)&&Y!==X&&(Y!=null||X!=null))switch(P){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(l(137,t));break;default:tt(e,t,P,Y,i,X)}return;default:if(Yl(t)){for(var nt in n)Y=n[nt],n.hasOwnProperty(nt)&&Y!==void 0&&!i.hasOwnProperty(nt)&&zc(e,t,nt,void 0,i,Y);for(ee in i)Y=i[ee],X=n[ee],!i.hasOwnProperty(ee)||Y===X||Y===void 0&&X===void 0||zc(e,t,ee,Y,i,X);return}}for(var I in n)Y=n[I],n.hasOwnProperty(I)&&Y!=null&&!i.hasOwnProperty(I)&&tt(e,t,I,null,i,Y);for(se in i)Y=i[se],X=n[se],!i.hasOwnProperty(se)||Y===X||Y==null&&X==null||tt(e,t,se,Y,i,X)}function $f(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var c=n[i],h=c.transferSize,y=c.initiatorType,_=c.duration;if(h&&_&&$f(y)){for(y=0,_=c.responseEnd,i+=1;i<n.length;i++){var R=n[i],P=R.startTime;if(P>_)break;var ee=R.transferSize,se=R.initiatorType;ee&&$f(se)&&(R=R.responseEnd,y+=ee*(R<_?1:(_-P)/(R-P)))}if(--i,t+=8*(h+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Dc=null,Bc=null;function dl(e){return e.nodeType===9?e:e.ownerDocument}function Pf(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gf(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Mc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qc=null;function Dy(){var e=window.event;return e&&e.type==="popstate"?e===qc?!1:(qc=e,!0):(qc=null,!1)}var Kf=typeof setTimeout=="function"?setTimeout:void 0,By=typeof clearTimeout=="function"?clearTimeout:void 0,Yf=typeof Promise=="function"?Promise:void 0,My=typeof queueMicrotask=="function"?queueMicrotask:typeof Yf<"u"?function(e){return Yf.resolve(null).then(e).catch(qy)}:Kf;function qy(e){setTimeout(function(){throw e})}function Aa(e){return e==="head"}function Jf(e,t){var n=t,i=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(i===0){e.removeChild(c),Qi(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")Kr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Kr(n);for(var h=n.firstChild;h;){var y=h.nextSibling,_=h.nodeName;h[oe]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&h.rel.toLowerCase()==="stylesheet"||n.removeChild(h),h=y}}else n==="body"&&Kr(e.ownerDocument.body);n=c}while(n);Qi(t)}function Qf(e,t){var n=e;e=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=i}while(n)}function Lc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Lc(n),ve(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Ly(e,t,n,i){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[oe])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=_n(e.nextSibling),e===null)break}return null}function Iy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=_n(e.nextSibling),e===null))return null;return e}function Xf(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=_n(e.nextSibling),e===null))return null;return e}function Ic(e){return e.data==="$?"||e.data==="$~"}function Hc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Hy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function _n(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Vc=null;function Ff(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return _n(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function Zf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Wf(e,t,n){switch(t=dl(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Kr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);ve(e)}var xn=new Map,eg=new Set;function hl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var sa=U.d;U.d={f:Vy,r:$y,D:Py,C:Gy,L:Ky,m:Yy,X:Qy,S:Jy,M:Xy};function Vy(){var e=sa.f(),t=al();return e||t}function $y(e){var t=pe(e);t!==null&&t.tag===5&&t.type==="form"?mh(t):sa.r(e)}var Ki=typeof document>"u"?null:document;function tg(e,t,n){var i=Ki;if(i&&typeof t=="string"&&t){var c=He(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),eg.has(c)||(eg.add(c),e={rel:e,crossOrigin:n,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),Bt(t,"link",e),le(t),i.head.appendChild(t)))}}function Py(e){sa.D(e),tg("dns-prefetch",e,null)}function Gy(e,t){sa.C(e,t),tg("preconnect",e,t)}function Ky(e,t,n){sa.L(e,t,n);var i=Ki;if(i&&e&&t){var c='link[rel="preload"][as="'+He(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+He(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+He(n.imageSizes)+'"]')):c+='[href="'+He(e)+'"]';var h=c;switch(t){case"style":h=Yi(e);break;case"script":h=Ji(e)}xn.has(h)||(e=x({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),xn.set(h,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(Yr(h))||t==="script"&&i.querySelector(Jr(h))||(t=i.createElement("link"),Bt(t,"link",e),le(t),i.head.appendChild(t)))}}function Yy(e,t){sa.m(e,t);var n=Ki;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+He(i)+'"][href="'+He(e)+'"]',h=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Ji(e)}if(!xn.has(h)&&(e=x({rel:"modulepreload",href:e},t),xn.set(h,e),n.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Jr(h)))return}i=n.createElement("link"),Bt(i,"link",e),le(i),n.head.appendChild(i)}}}function Jy(e,t,n){sa.S(e,t,n);var i=Ki;if(i&&e){var c=ue(i).hoistableStyles,h=Yi(e);t=t||"default";var y=c.get(h);if(!y){var _={loading:0,preload:null};if(y=i.querySelector(Yr(h)))_.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},n),(n=xn.get(h))&&$c(e,n);var R=y=i.createElement("link");le(R),Bt(R,"link",e),R._p=new Promise(function(P,ee){R.onload=P,R.onerror=ee}),R.addEventListener("load",function(){_.loading|=1}),R.addEventListener("error",function(){_.loading|=2}),_.loading|=4,fl(y,t,i)}y={type:"stylesheet",instance:y,count:1,state:_},c.set(h,y)}}}function Qy(e,t){sa.X(e,t);var n=Ki;if(n&&e){var i=ue(n).hoistableScripts,c=Ji(e),h=i.get(c);h||(h=n.querySelector(Jr(c)),h||(e=x({src:e,async:!0},t),(t=xn.get(c))&&Pc(e,t),h=n.createElement("script"),le(h),Bt(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function Xy(e,t){sa.M(e,t);var n=Ki;if(n&&e){var i=ue(n).hoistableScripts,c=Ji(e),h=i.get(c);h||(h=n.querySelector(Jr(c)),h||(e=x({src:e,async:!0,type:"module"},t),(t=xn.get(c))&&Pc(e,t),h=n.createElement("script"),le(h),Bt(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function ng(e,t,n,i){var c=(c=ae.current)?hl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Yi(n.href),n=ue(c).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Yi(n.href);var h=ue(c).hoistableStyles,y=h.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,y),(h=c.querySelector(Yr(e)))&&!h._p&&(y.instance=h,y.state.loading=5),xn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},xn.set(e,n),h||Fy(c,e,n,y.state))),t&&i===null)throw Error(l(528,""));return y}if(t&&i!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Ji(n),n=ue(c).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Yi(e){return'href="'+He(e)+'"'}function Yr(e){return'link[rel="stylesheet"]['+e+"]"}function ag(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function Fy(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Bt(t,"link",n),le(t),e.head.appendChild(t))}function Ji(e){return'[src="'+He(e)+'"]'}function Jr(e){return"script[async]"+e}function ig(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+He(n.href)+'"]');if(i)return t.instance=i,le(i),i;var c=x({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),le(i),Bt(i,"style",c),fl(i,n.precedence,e),t.instance=i;case"stylesheet":c=Yi(n.href);var h=e.querySelector(Yr(c));if(h)return t.state.loading|=4,t.instance=h,le(h),h;i=ag(n),(c=xn.get(c))&&$c(i,c),h=(e.ownerDocument||e).createElement("link"),le(h);var y=h;return y._p=new Promise(function(_,R){y.onload=_,y.onerror=R}),Bt(h,"link",i),t.state.loading|=4,fl(h,n.precedence,e),t.instance=h;case"script":return h=Ji(n.src),(c=e.querySelector(Jr(h)))?(t.instance=c,le(c),c):(i=n,(c=xn.get(h))&&(i=x({},n),Pc(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),le(c),Bt(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,fl(i,n.precedence,e));return t.instance}function fl(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,h=c,y=0;y<i.length;y++){var _=i[y];if(_.dataset.precedence===t)h=_;else if(h!==c)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function $c(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Pc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var gl=null;function rg(e,t,n){if(gl===null){var i=new Map,c=gl=new Map;c.set(n,i)}else c=gl,i=c.get(n),i||(i=new Map,c.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var h=n[c];if(!(h[oe]||h[xt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var y=h.getAttribute(t)||"";y=e+y;var _=i.get(y);_?_.push(h):i.set(y,[h])}}return i}function sg(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Zy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function lg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Wy(e,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=Yi(i.href),h=t.querySelector(Yr(c));if(h){t=h._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=pl.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=h,le(h);return}h=t.ownerDocument||t,i=ag(i),(c=xn.get(c))&&$c(i,c),h=h.createElement("link"),le(h);var y=h;y._p=new Promise(function(_,R){y.onload=_,y.onerror=R}),Bt(h,"link",i),n.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=pl.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Gc=0;function ev(e,t){return e.stylesheets&&e.count===0&&yl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+t);0<e.imgBytes&&Gc===0&&(Gc=62500*zy());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&yl(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>Gc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function pl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)yl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var ml=null;function yl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,ml=new Map,t.forEach(tv,e),ml=null,pl.call(e))}function tv(e,t){if(!(t.state.loading&4)){var n=ml.get(e);if(n)var i=n.get(null);else{n=new Map,ml.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<c.length;h++){var y=c[h];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),i=y)}i&&n.set(null,i)}c=t.instance,y=c.getAttribute("data-precedence"),h=n.get(y)||i,h===i&&n.set(null,c),n.set(y,c),this.count++,i=pl.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),h?h.parentNode.insertBefore(c,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Qr={$$typeof:B,Provider:null,Consumer:null,_currentValue:F,_currentValue2:F,_threadCount:0};function nv(e,t,n,i,c,h,y,_,R){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ia(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ia(0),this.hiddenUpdates=Ia(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=h,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=R,this.incompleteTransitions=new Map}function og(e,t,n,i,c,h,y,_,R,P,ee,se){return e=new nv(e,t,n,y,R,P,ee,se,_),t=1,h===!0&&(t|=24),h=nn(3,null,null,t),e.current=h,h.stateNode=e,t=wo(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:i,isDehydrated:n,cache:t},Ao(h),e}function cg(e){return e?(e=Ei,e):Ei}function ug(e,t,n,i,c,h){c=cg(c),i.context===null?i.context=c:i.pendingContext=c,i=ya(t),i.payload={element:n},h=h===void 0?null:h,h!==null&&(i.callback=h),n=va(e,i,t),n!==null&&(en(n,e,t),Tr(n,e,t))}function dg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Kc(e,t){dg(e,t),(e=e.alternate)&&dg(e,t)}function hg(e){if(e.tag===13||e.tag===31){var t=Ga(e,67108864);t!==null&&en(t,e,67108864),Kc(e,67108864)}}function fg(e){if(e.tag===13||e.tag===31){var t=on();t=cr(t);var n=Ga(e,t);n!==null&&en(n,e,t),Kc(e,t)}}var vl=!0;function av(e,t,n,i){var c=C.T;C.T=null;var h=U.p;try{U.p=2,Yc(e,t,n,i)}finally{U.p=h,C.T=c}}function iv(e,t,n,i){var c=C.T;C.T=null;var h=U.p;try{U.p=8,Yc(e,t,n,i)}finally{U.p=h,C.T=c}}function Yc(e,t,n,i){if(vl){var c=Jc(i);if(c===null)Uc(e,t,i,bl,n),pg(e,i);else if(sv(c,e,t,n,i))i.stopPropagation();else if(pg(e,i),t&4&&-1<rv.indexOf(e)){for(;c!==null;){var h=pe(c);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var y=Dn(h.pendingLanes);if(y!==0){var _=h;for(_.pendingLanes|=2,_.entangledLanes|=2;y;){var R=1<<31-Pt(y);_.entanglements[1]|=R,y&=~R}Hn(h),(Fe&6)===0&&(tl=Rt()+500,$r(0))}}break;case 31:case 13:_=Ga(h,2),_!==null&&en(_,h,2),al(),Kc(h,2)}if(h=Jc(i),h===null&&Uc(e,t,i,bl,n),h===c)break;c=h}c!==null&&i.stopPropagation()}else Uc(e,t,i,null,n)}}function Jc(e){return e=Ql(e),Qc(e)}var bl=null;function Qc(e){if(bl=null,e=be(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=f(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return bl=e,null}function gg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vl()){case hi:return 2;case os:return 8;case Ma:case $l:return 32;case cs:return 268435456;default:return 32}default:return 32}}var Xc=!1,Oa=null,Na=null,Ra=null,Xr=new Map,Fr=new Map,ka=[],rv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function pg(e,t){switch(e){case"focusin":case"focusout":Oa=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":Ra=null;break;case"pointerover":case"pointerout":Xr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fr.delete(t.pointerId)}}function Zr(e,t,n,i,c,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:h,targetContainers:[c]},t!==null&&(t=pe(t),t!==null&&hg(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function sv(e,t,n,i,c){switch(t){case"focusin":return Oa=Zr(Oa,e,t,n,i,c),!0;case"dragenter":return Na=Zr(Na,e,t,n,i,c),!0;case"mouseover":return Ra=Zr(Ra,e,t,n,i,c),!0;case"pointerover":var h=c.pointerId;return Xr.set(h,Zr(Xr.get(h)||null,e,t,n,i,c)),!0;case"gotpointercapture":return h=c.pointerId,Fr.set(h,Zr(Fr.get(h)||null,e,t,n,i,c)),!0}return!1}function mg(e){var t=be(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=f(n),t!==null){e.blockedOn=t,ps(e.priority,function(){fg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,ps(e.priority,function(){fg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _l(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jc(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Jl=i,n.target.dispatchEvent(i),Jl=null}else return t=pe(n),t!==null&&hg(t),e.blockedOn=n,!1;t.shift()}return!0}function yg(e,t,n){_l(e)&&n.delete(t)}function lv(){Xc=!1,Oa!==null&&_l(Oa)&&(Oa=null),Na!==null&&_l(Na)&&(Na=null),Ra!==null&&_l(Ra)&&(Ra=null),Xr.forEach(yg),Fr.forEach(yg)}function xl(e,t){e.blockedOn===t&&(e.blockedOn=null,Xc||(Xc=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,lv)))}var jl=null;function vg(e){jl!==e&&(jl=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){jl===e&&(jl=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(Qc(i||n)===null)continue;break}var h=pe(n);h!==null&&(e.splice(t,3),t-=3,Jo(h,{pending:!0,data:c,method:n.method,action:i},i,c))}}))}function Qi(e){function t(R){return xl(R,e)}Oa!==null&&xl(Oa,e),Na!==null&&xl(Na,e),Ra!==null&&xl(Ra,e),Xr.forEach(t),Fr.forEach(t);for(var n=0;n<ka.length;n++){var i=ka[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<ka.length&&(n=ka[0],n.blockedOn===null);)mg(n),n.blockedOn===null&&ka.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var c=n[i],h=n[i+1],y=c[Lt]||null;if(typeof h=="function")y||vg(n);else if(y){var _=null;if(h&&h.hasAttribute("formAction")){if(c=h,y=h[Lt]||null)_=y.formAction;else if(Qc(c)!==null)continue}else _=y.action;typeof _=="function"?n[i+1]=_:(n.splice(i,3),i-=3),vg(n)}}}function bg(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function Fc(e){this._internalRoot=e}Sl.prototype.render=Fc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,i=on();ug(n,i,e,t,null,null)},Sl.prototype.unmount=Fc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ug(e.current,2,null,e,null,null),al(),t[oa]=null}};function Sl(e){this._internalRoot=e}Sl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Bn();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ka.length&&t!==0&&t<ka[n].priority;n++);ka.splice(n,0,e),n===0&&mg(e)}};var _g=a.version;if(_g!=="19.2.0")throw Error(l(527,_g,"19.2.0"));U.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var ov={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:C,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{qa=wl.inject(ov),$t=wl}catch{}}return es.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,i="",c=Ch,h=Th,y=Ah;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=og(e,1,!1,null,null,n,i,null,c,h,y,bg),e[oa]=t.current,kc(e),new Fc(t)},es.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var i=!1,c="",h=Ch,y=Th,_=Ah,R=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(h=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(_=n.onRecoverableError),n.formState!==void 0&&(R=n.formState)),t=og(e,1,!0,t,n??null,i,c,R,h,y,_,bg),t.context=cg(null),n=t.current,i=on(),i=cr(i),c=ya(i),c.callback=null,va(n,c,i),n=i,t.current.lanes=n,En(t,n),Hn(t),e[oa]=t.current,kc(e),new Sl(t)},es.version="19.2.0",es}var Ng;function bv(){if(Ng)return Wc.exports;Ng=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),Wc.exports=vv(),Wc.exports}var _v=bv(),j=Cu();const Tu=op(j);var fu=function(o,a){return fu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},fu(o,a)};function up(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");fu(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var zl=function(){return zl=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},zl.apply(this,arguments)};function rr(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function dp(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(f=o[g])&&(d=(u<3?f(d):u>3?f(a,s,d):f(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function hp(o,a){return function(s,l){a(s,l,o)}}function fp(o,a,s,l,u,d){function f(T){if(T!==void 0&&typeof T!="function")throw new TypeError("Function expected");return T}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),x,S=!1,b=s.length-1;b>=0;b--){var w={};for(var A in l)w[A]=A==="access"?{}:l[A];for(var A in l.access)w.access[A]=l.access[A];w.addInitializer=function(T){if(S)throw new TypeError("Cannot add initializers after decoration has completed");d.push(f(T||null))};var N=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(N===void 0)continue;if(N===null||typeof N!="object")throw new TypeError("Object expected");(x=f(N.get))&&(v.get=x),(x=f(N.set))&&(v.set=x),(x=f(N.init))&&u.unshift(x)}else(x=f(N))&&(g==="field"?u.unshift(x):v[p]=x)}m&&Object.defineProperty(m,l.name,v),S=!0}function gp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function pp(o){return typeof o=="symbol"?o:"".concat(o)}function mp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function yp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function we(o,a,s,l){function u(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function g(v){try{m(l.next(v))}catch(x){f(x)}}function p(v){try{m(l.throw(v))}catch(x){f(x)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function vp(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=g(0),f.throw=g(1),f.return=g(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Ll=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function bp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&Ll(a,o,s)}function Dl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Au(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],f;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){f={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(f)throw f.error}}return d}function _p(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(Au(arguments[a]));return o}function xp(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],f=0,g=d.length;f<g;f++,u++)l[u]=d[f];return l}function jp(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function ir(o){return this instanceof ir?(this.v=o,this):new ir(o)}function Sp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",f),u[Symbol.asyncIterator]=function(){return this},u;function f(b){return function(w){return Promise.resolve(w).then(b,x)}}function g(b,w){l[b]&&(u[b]=function(A){return new Promise(function(N,T){d.push([b,A,N,T])>1||p(b,A)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(A){S(d[0][3],A)}}function m(b){b.value instanceof ir?Promise.resolve(b.value.v).then(v,x):S(d[0][2],b)}function v(b){p("next",b)}function x(b){p("throw",b)}function S(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function wp(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(f){return(s=!s)?{value:ir(o[u](f)),done:!1}:d?d(f):f}:d}}function Ep(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Dl=="function"?Dl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(f){return new Promise(function(g,p){f=o[d](f),u(g,p,f.done,f.value)})}}function u(d,f,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},f)}}function Cp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var xv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},gu=function(o){return gu=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},gu(o)};function Tp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=gu(o),l=0;l<s.length;l++)s[l]!=="default"&&Ll(a,o,s[l]);return xv(a,o),a}function Ap(o){return o&&o.__esModule?o:{default:o}}function Op(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function Np(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Rp(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function kp(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var jv=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Up(o){function a(d){o.error=o.hasError?new jv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(f){return a(f),u()})}else l|=1}catch(f){a(f)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function zp(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,f){return l?a?".jsx":".js":u&&(!d||!f)?s:u+d+"."+f.toLowerCase()+"js"}):o}const Sv={__extends:up,__assign:zl,__rest:rr,__decorate:dp,__param:hp,__esDecorate:fp,__runInitializers:gp,__propKey:pp,__setFunctionName:mp,__metadata:yp,__awaiter:we,__generator:vp,__createBinding:Ll,__exportStar:bp,__values:Dl,__read:Au,__spread:_p,__spreadArrays:xp,__spreadArray:jp,__await:ir,__asyncGenerator:Sp,__asyncDelegator:wp,__asyncValues:Ep,__makeTemplateObject:Cp,__importStar:Tp,__importDefault:Ap,__classPrivateFieldGet:Op,__classPrivateFieldSet:Np,__classPrivateFieldIn:Rp,__addDisposableResource:kp,__disposeResources:Up,__rewriteRelativeImportExtension:zp},wv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:kp,get __assign(){return zl},__asyncDelegator:wp,__asyncGenerator:Sp,__asyncValues:Ep,__await:ir,__awaiter:we,__classPrivateFieldGet:Op,__classPrivateFieldIn:Rp,__classPrivateFieldSet:Np,__createBinding:Ll,__decorate:dp,__disposeResources:Up,__esDecorate:fp,__exportStar:bp,__extends:up,__generator:vp,__importDefault:Ap,__importStar:Tp,__makeTemplateObject:Cp,__metadata:yp,__param:hp,__propKey:pp,__read:Au,__rest:rr,__rewriteRelativeImportExtension:zp,__runInitializers:gp,__setFunctionName:mp,__spread:_p,__spreadArray:jp,__spreadArrays:xp,__values:Dl,default:Sv},Symbol.toStringTag,{value:"Module"})),Ev=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Ou extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Cv extends Ou{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Rg extends Ou{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class kg extends Ou{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var pu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(pu||(pu={}));class Tv{constructor(a,{headers:s={},customFetch:l,region:u=pu.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Ev(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return we(this,arguments,void 0,function*(s,l={}){var u;let d,f;try{const{headers:g,method:p,body:m,signal:v,timeout:x}=l;let S={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${s}`);b&&b!=="any"&&(S["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let A;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(S["Content-Type"]="application/octet-stream",A=m):typeof m=="string"?(S["Content-Type"]="text/plain",A=m):typeof FormData<"u"&&m instanceof FormData?A=m:(S["Content-Type"]="application/json",A=JSON.stringify(m)):A=m;let N=v;x&&(f=new AbortController,d=setTimeout(()=>f.abort(),x),v?(N=f.signal,v.addEventListener("abort",()=>f.abort())):N=f.signal);const T=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},S),this.headers),g),body:A,signal:N}).catch(E=>{throw new Cv(E)}),M=T.headers.get("x-relay-error");if(M&&M==="true")throw new Rg(T);if(!T.ok)throw new kg(T);let B=((u=T.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),G;return B==="application/json"?G=yield T.json():B==="application/octet-stream"||B==="application/pdf"?G=yield T.blob():B==="text/event-stream"?G=T:B==="multipart/form-data"?G=yield T.formData():G=yield T.text(),{data:G,error:null,response:T}}catch(g){return{data:null,error:g,response:g instanceof kg||g instanceof Rg?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Vt={};const sr=dv(wv);var El={},Cl={},Tl={},Al={},Ol={},Nl={},Ug;function Dp(){if(Ug)return Nl;Ug=1,Object.defineProperty(Nl,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Nl.default=o,Nl}var zg;function Bp(){if(zg)return Ol;zg=1,Object.defineProperty(Ol,"__esModule",{value:!0});const a=sr.__importDefault(Dp());class s{constructor(u){var d,f;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(f=u.isMaybeSingle)!==null&&f!==void 0?f:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let g=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,x,S;let b=null,w=null,A=null,N=p.status,T=p.statusText;if(p.ok){if(this.method!=="HEAD"){const E=await p.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=E:w=JSON.parse(E))}const B=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),G=(x=p.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");B&&G&&G.length>1&&(A=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,A=null,N=406,T="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const B=await p.text();try{b=JSON.parse(B),Array.isArray(b)&&p.status===404&&(w=[],b=null,N=200,T="OK")}catch{p.status===404&&B===""?(N=204,T="No Content"):b={message:B}}if(b&&this.isMaybeSingle&&(!((S=b?.details)===null||S===void 0)&&S.includes("0 rows"))&&(b=null,N=200,T="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:A,status:N,statusText:T}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,x;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(x=p?.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Ol.default=s,Ol}var Dg;function Mp(){if(Dg)return Al;Dg=1,Object.defineProperty(Al,"__esModule",{value:!0});const a=sr.__importDefault(Bp());class s extends a.default{select(u){let d=!1;const f=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:f,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:f=d}={}){const g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:f,referencedTable:g=f}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:f=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const x=[u?"analyze":null,d?"verbose":null,f?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),S=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${S}"; options=${x};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return Al.default=s,Al}var Bg;function Nu(){if(Bg)return Tl;Bg=1,Object.defineProperty(Tl,"__esModule",{value:!0});const a=sr.__importDefault(Mp()),s=new RegExp("[,()]");class l extends a.default{eq(d,f){return this.url.searchParams.append(d,`eq.${f}`),this}neq(d,f){return this.url.searchParams.append(d,`neq.${f}`),this}gt(d,f){return this.url.searchParams.append(d,`gt.${f}`),this}gte(d,f){return this.url.searchParams.append(d,`gte.${f}`),this}lt(d,f){return this.url.searchParams.append(d,`lt.${f}`),this}lte(d,f){return this.url.searchParams.append(d,`lte.${f}`),this}like(d,f){return this.url.searchParams.append(d,`like.${f}`),this}likeAllOf(d,f){return this.url.searchParams.append(d,`like(all).{${f.join(",")}}`),this}likeAnyOf(d,f){return this.url.searchParams.append(d,`like(any).{${f.join(",")}}`),this}ilike(d,f){return this.url.searchParams.append(d,`ilike.${f}`),this}ilikeAllOf(d,f){return this.url.searchParams.append(d,`ilike(all).{${f.join(",")}}`),this}ilikeAnyOf(d,f){return this.url.searchParams.append(d,`ilike(any).{${f.join(",")}}`),this}is(d,f){return this.url.searchParams.append(d,`is.${f}`),this}in(d,f){const g=Array.from(new Set(f)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cs.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cs.{${f.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(f)}`),this}containedBy(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cd.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cd.{${f.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(f)}`),this}rangeGt(d,f){return this.url.searchParams.append(d,`sr.${f}`),this}rangeGte(d,f){return this.url.searchParams.append(d,`nxl.${f}`),this}rangeLt(d,f){return this.url.searchParams.append(d,`sl.${f}`),this}rangeLte(d,f){return this.url.searchParams.append(d,`nxr.${f}`),this}rangeAdjacent(d,f){return this.url.searchParams.append(d,`adj.${f}`),this}overlaps(d,f){return typeof f=="string"?this.url.searchParams.append(d,`ov.${f}`):this.url.searchParams.append(d,`ov.{${f.join(",")}}`),this}textSearch(d,f,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${f}`),this}match(d){return Object.entries(d).forEach(([f,g])=>{this.url.searchParams.append(f,`eq.${g}`)}),this}not(d,f,g){return this.url.searchParams.append(d,`not.${f}.${g}`),this}or(d,{foreignTable:f,referencedTable:g=f}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,f,g){return this.url.searchParams.append(d,`${f}.${g}`),this}}return Tl.default=l,Tl}var Mg;function qp(){if(Mg)return Cl;Mg=1,Object.defineProperty(Cl,"__esModule",{value:!0});const a=sr.__importDefault(Nu());class s{constructor(u,{headers:d={},schema:f,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=f,this.fetch=g}select(u,d){const{head:f=!1,count:g}=d??{},p=f?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:f=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(m.length>0){const v=[...new Set(m)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:f=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const x=u.reduce((S,b)=>S.concat(Object.keys(b)),[]);if(x.length>0){const S=[...new Set(x)].map(b=>`"${b}"`);this.url.searchParams.set("columns",S.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var f;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:u}={}){var d;const f="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Cl.default=s,Cl}var qg;function Av(){if(qg)return El;qg=1,Object.defineProperty(El,"__esModule",{value:!0});const o=sr,a=o.__importDefault(qp()),s=o.__importDefault(Nu());class l{constructor(d,{headers:f={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(f),this.schemaName=g,this.fetch=p}from(d){const f=new URL(`${this.url}/${d}`);return new a.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,f={},{head:g=!1,get:p=!1,count:m}={}){var v;let x;const S=new URL(`${this.url}/rpc/${d}`);let b;g||p?(x=g?"HEAD":"GET",Object.entries(f).filter(([A,N])=>N!==void 0).map(([A,N])=>[A,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([A,N])=>{S.searchParams.append(A,N)})):(x="POST",b=f);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new s.default({method:x,url:S,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return El.default=l,El}var Lg;function Ov(){if(Lg)return Vt;Lg=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.PostgrestError=Vt.PostgrestBuilder=Vt.PostgrestTransformBuilder=Vt.PostgrestFilterBuilder=Vt.PostgrestQueryBuilder=Vt.PostgrestClient=void 0;const o=sr,a=o.__importDefault(Av());Vt.PostgrestClient=a.default;const s=o.__importDefault(qp());Vt.PostgrestQueryBuilder=s.default;const l=o.__importDefault(Nu());Vt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Mp());Vt.PostgrestTransformBuilder=u.default;const d=o.__importDefault(Bp());Vt.PostgrestBuilder=d.default;const f=o.__importDefault(Dp());return Vt.PostgrestError=f.default,Vt.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:f.default},Vt}var Lp=Ov();const Ip=op(Lp),Nv=uv({__proto__:null,default:Ip},[Lp]),{PostgrestClient:Rv,PostgrestQueryBuilder:cx,PostgrestFilterBuilder:ux,PostgrestTransformBuilder:dx,PostgrestBuilder:hx,PostgrestError:fx}=Ip||Nv;class kv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const Uv="2.81.1",zv=`realtime-js/${Uv}`,Hp="1.0.0",Dv="2.0.0",Ig=Hp,mu=1e4,Bv=1e3,Mv=100;var oi;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(oi||(oi={}));var Ot;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Ot||(Ot={}));var jn;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(jn||(jn={}));var yu;(function(o){o.websocket="websocket"})(yu||(yu={}));var ci;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(ci||(ci={}));class qv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:f}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,S=>m.setUint8(v++,S.charCodeAt(0))),Array.from(l,S=>m.setUint8(v++,S.charCodeAt(0))),Array.from(d,S=>m.setUint8(v++,S.charCodeAt(0))),Array.from(u,S=>m.setUint8(v++,S.charCodeAt(0)));var x=new Uint8Array(p.byteLength+f.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(f),p.byteLength),x.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(v),S=0;x.setUint8(S++,this.KINDS.userBroadcastPush),x.setUint8(S++,u.length),x.setUint8(S++,d.length),x.setUint8(S++,f.length),x.setUint8(S++,g.length),x.setUint8(S++,this.BINARY_ENCODING),Array.from(u,w=>x.setUint8(S++,w.charCodeAt(0))),Array.from(d,w=>x.setUint8(S++,w.charCodeAt(0))),Array.from(f,w=>x.setUint8(S++,w.charCodeAt(0))),Array.from(g,w=>x.setUint8(S++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,x=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,S=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(S),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,f.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,N=>b.setUint8(w++,N.charCodeAt(0))),Array.from(d,N=>b.setUint8(w++,N.charCodeAt(0))),Array.from(f,N=>b.setUint8(w++,N.charCodeAt(0))),Array.from(g,N=>b.setUint8(w++,N.charCodeAt(0)));var A=new Uint8Array(S.byteLength+v.byteLength);return A.set(new Uint8Array(S),0),A.set(new Uint8Array(v),S.byteLength),A.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,f,g,p]=l;return s({join_ref:u,ref:d,topic:f,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+f));g=g+f;const x=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:x}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+f));p=p+f;const S=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:S,response:b};return{join_ref:m,ref:v,topic:x,event:jn.reply,payload:w}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let f=this.HEADER_LENGTH+2;const g=l.decode(a.slice(f,f+u));f=f+u;const p=l.decode(a.slice(f,f+d));f=f+d;const m=JSON.parse(l.decode(a.slice(f,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+f));p=p+f;const S=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(S)):S,w={type:this.BROADCAST,event:v,payload:b};return f>0&&(w.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Vp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(rt||(rt={}));const Hg=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,f)=>(d[f]=Lv(f,o,a,u),d),{}):{}},Lv=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,f=s[o];return d&&!l.includes(d)?$p(d,f):vu(f)},$p=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return $v(a,s)}switch(o){case rt.bool:return Iv(a);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return Hv(a);case rt.json:case rt.jsonb:return Vv(a);case rt.timestamp:return Pv(a);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return vu(a);default:return vu(a)}},vu=o=>o,Iv=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Hv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Vv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},$v=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const f=o.slice(1,s);try{d=JSON.parse("["+f+"]")}catch{d=f?f.split(","):[]}return d.map(g=>$p(a,g))}return o},Pv=o=>typeof o=="string"?o.replace(" ","T"):o,Pp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class iu{constructor(a,s,l={},u=mu){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Vg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Vg||(Vg={}));class ns{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ns.syncState(this.state,u,d,f),this.pendingDiffs.forEach(p=>{this.state=ns.syncDiff(this.state,p,d,f)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=ns.syncDiff(this.state,u,d,f),g())}),this.onJoin((u,d,f)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:f})}),this.onLeave((u,d,f)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),f=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{f[m]||(p[m]=v)}),this.map(f,(m,v)=>{const x=d[m];if(x){const S=v.map(N=>N.presence_ref),b=x.map(N=>N.presence_ref),w=v.filter(N=>b.indexOf(N.presence_ref)<0),A=x.filter(N=>S.indexOf(N.presence_ref)<0);w.length>0&&(g[m]=w),A.length>0&&(p[m]=A)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:f}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const x=a[g].map(b=>b.presence_ref),S=v.filter(b=>x.indexOf(b.presence_ref)<0);a[g].unshift(...S)}l(g,v,p)}),this.map(f,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(x=>x.presence_ref);m=m.filter(x=>v.indexOf(x.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $g;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})($g||($g={}));var as;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(as||(as={}));var la;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(la||(la={}));class Ru{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=Ot.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new iu(this,jn.join,this.params,this.timeout),this.rejoinTimer=new Vp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ot.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ot.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Ot.errored,this.rejoinTimer.scheduleTimeout())}),this._on(jn.reply,{},(f,g)=>{this._trigger(this._replyEventName(g),f)}),this.presence=new ns(this),this.broadcastEndpointURL=Pp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Ot.closed){const{config:{broadcast:f,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[as.PRESENCE]&&this.bindings[as.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,x={},S={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(la.CHANNEL_ERROR,b)),this._onClose(()=>a?.(la.CLOSED)),this.updateJoinPayload(Object.assign({config:S},x)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(la.SUBSCRIBED);return}else{const A=this.bindings.postgres_changes,N=(w=A?.length)!==null&&w!==void 0?w:0,T=[];for(let M=0;M<N;M++){const B=A[M],{filter:{event:G,schema:E,table:L,filter:D}}=B,V=b&&b[M];if(V&&V.event===G&&V.schema===E&&V.table===L&&V.filter===D)T.push(Object.assign(Object.assign({},B),{id:V.id}));else{this.unsubscribe(),this.state=Ot.errored,a?.(la.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,a&&a(la.SUBSCRIBED);return}}).receive("error",b=>{this.state=Ot.errored,a?.(la.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(la.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===Ot.joined&&a===as.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:f}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var f,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(f=this.params)===null||f===void 0?void 0:f.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=Ot.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(jn.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new iu(this,jn.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ot.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),f=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),f}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new iu(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Mv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const f=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=jn;if(l&&[g,p,m,v].indexOf(f)>=0&&l!==this._joinRef())return;let S=this._onMessage(f,s,l);if(s&&!S)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,A,N;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((N=(A=b.filter)===null||A===void 0?void 0:A.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===f}).map(b=>b.callback(S,l)):(d=this.bindings[f])===null||d===void 0||d.filter(b=>{var w,A,N,T,M,B;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in b){const G=b.id,E=(w=b.filter)===null||w===void 0?void 0:w.event;return G&&((A=s.ids)===null||A===void 0?void 0:A.includes(G))&&(E==="*"||E?.toLocaleLowerCase()===((N=s.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const G=(M=(T=b?.filter)===null||T===void 0?void 0:T.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return G==="*"||G===((B=s?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===f}).map(b=>{if(typeof S=="object"&&"ids"in S){const w=S.data,{schema:A,table:N,commit_timestamp:T,type:M,errors:B}=w;S=Object.assign(Object.assign({},{schema:A,table:N,commit_timestamp:T,eventType:M,new:{},old:{},errors:B}),this._getPayloadRecords(w))}b.callback(S,l)})}_isClosed(){return this.state===Ot.closed}_isJoined(){return this.state===Ot.joined}_isJoining(){return this.state===Ot.joining}_isLeaving(){return this.state===Ot.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Ru.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(jn.close,{},a)}_onError(a){this._on(jn.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ot.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Hg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Hg(a.columns,a.old_record)),s}}const ru=()=>{},Rl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Gv=[1e3,2e3,5e3,1e4],Kv=1e4,Yv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mu,this.transport=null,this.heartbeatIntervalMs=Rl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ru,this.ref=0,this.reconnectTimer=null,this.vsn=Ig,this.logger=ru,this.conn=null,this.sendBuffer=[],this.serializer=new qv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${yu.websocket}`,this.httpEndpoint=Pp(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=kv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case oi.connecting:return ci.Connecting;case oi.open:return ci.Open;case oi.closing:return ci.Closing;default:return ci.Closed}}isConnected(){return this.connectionState()===ci.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Ru(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,f=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Bv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Rl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:f}=s,g=f?`(${f})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,f)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===oi.open||this.conn.readyState===oi.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(jn.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Yv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:zv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(jn.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Vp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Rl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,f,g,p,m,v,x,S,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:mu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Rl.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(f=a?.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:ru,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Ig,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Gv[w-1]||Kv),this.vsn){case Hp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,A)=>A(JSON.stringify(w))),this.decode=(x=a?.decode)!==null&&x!==void 0?x:((w,A)=>A(JSON.parse(w)));break;case Dv:this.encode=(S=a?.encode)!==null&&S!==void 0?S:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class ku extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function pt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Qv extends ku{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class bu extends ku{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const Uu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Xv=()=>Response,_u=o=>{if(Array.isArray(o))return o.map(s=>_u(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=_u(l)}),a},Fv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},su=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},Zv=(o,a,s)=>we(void 0,void 0,void 0,function*(){const l=yield Xv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,f=u?.statusCode||d+"";a(new Qv(su(u),d,f))}).catch(u=>{a(new bu(su(u),u))}):a(new bu(su(o),o))}),Wv=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Fv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function ls(o,a,s,l,u,d){return we(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,Wv(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>f(p)).catch(p=>Zv(p,g,l))})})}function is(o,a,s,l){return we(this,void 0,void 0,function*(){return ls(o,"GET",a,s,l)})}function kn(o,a,s,l,u){return we(this,void 0,void 0,function*(){return ls(o,"POST",a,l,u,s)})}function xu(o,a,s,l,u){return we(this,void 0,void 0,function*(){return ls(o,"PUT",a,l,u,s)})}function eb(o,a,s,l){return we(this,void 0,void 0,function*(){return ls(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function zu(o,a,s,l,u){return we(this,void 0,void 0,function*(){return ls(o,"DELETE",a,l,u,s)})}class tb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return we(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(pt(a))return{data:null,error:a};throw a}})}}var Gp;class nb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Gp]="BlobDownloadBuilder",this.promise=null}asStream(){return new tb(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return we(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(pt(a))return{data:null,error:a};throw a}})}}Gp=Symbol.toStringTag;const ab={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ib{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=Uu(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return we(this,void 0,void 0,function*(){try{let d;const f=Object.assign(Object.assign({},Pg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(f.upsert)});const p=f.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",f.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!f.duplex&&(f.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),x=yield(a=="PUT"?xu:kn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},f?.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:x.Id,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(pt(d))return{data:null,error:d};throw d}})}upload(a,s,l){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return we(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),f=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:Pg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const x=yield xu(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:x.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(pt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return we(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield kn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),f=new URL(this.url+d.url),g=f.searchParams.get("token");if(!g)throw new ku("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}update(a,s,l){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return we(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}copy(a,s,l){return we(this,void 0,void 0,function*(){try{return{data:{path:(yield kn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return we(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield kn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const f=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${f}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return we(this,void 0,void 0,function*(){try{const u=yield kn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),f=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>is(this.fetch,`${this.url}/${u}/${g}${f}`,{headers:this.headers,noResolveJson:!0});return new nb(p,this.shouldThrowOnError)}info(a){return we(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield is(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:_u(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}exists(a){return we(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield eb(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l)&&l instanceof bu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return we(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}list(a,s,l){return we(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},ab),s),{prefix:a||""});return{data:yield kn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}listV2(a,s){return we(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield kn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const Kp="2.81.1",Yp={"X-Client-Info":`storage-js/${Kp}`};class rb{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=Uu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return we(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield is(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}getBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}createBucket(a){return we(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(pt(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return we(this,void 0,void 0,function*(){try{return{data:yield xu(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class sb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=Uu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}listBuckets(a){return we(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield is(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pt(s))return{data:null,error:s};throw s}})}}const Du={"X-Client-Info":`storage-js/${Kp}`,"Content-Type":"application/json"};class Jp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function cn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class lu extends Jp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lb extends Jp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Gg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Gg||(Gg={}));const Bu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ob=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Kg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),cb=(o,a,s)=>we(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(f=>{const g=f?.statusCode||f?.code||u+"";a(new lu(Kg(f),u,g))}).catch(()=>{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new lu(g,u,f))});else{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new lu(g,u,f))}}else a(new lb(Kg(o),o))}),ub=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(ob(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function db(o,a,s,l,u,d){return we(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,ub(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>f(p)).catch(p=>cb(p,g,l))})})}function un(o,a,s,l,u){return we(this,void 0,void 0,function*(){return db(o,"POST",a,l,u,s)})}class hb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}getIndex(a,s){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(cn(l))return{data:null,error:l};throw l}})}listIndexes(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(cn(l))return{data:null,error:l};throw l}})}}class fb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return we(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield un(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}getVectors(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}listVectors(a){return we(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield un(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}queryVectors(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}deleteVectors(a){return we(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield un(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}}class gb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Du),s),this.fetch=Bu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}getBucket(a){return we(this,void 0,void 0,function*(){try{return{data:yield un(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}listBuckets(){return we(this,arguments,void 0,function*(a={}){try{return{data:yield un(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}deleteBucket(a){return we(this,void 0,void 0,function*(){try{return{data:(yield un(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}}class pb extends gb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new mb(this.url,this.headers,a,this.fetch)}}class mb extends hb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return we(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return we(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return we(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return we(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new yb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class yb extends fb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return we(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return we(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return we(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return we(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return we(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vb extends rb{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new ib(this.url,this.headers,a,this.fetch)}get vectors(){return new pb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new sb(this.url+"/iceberg",this.headers,this.fetch)}}const bb="2.81.1";let ts="";typeof Deno<"u"?ts="deno":typeof document<"u"?ts="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ts="react-native":ts="node";const _b={"X-Client-Info":`supabase-js-${ts}/${bb}`},xb={headers:_b},jb={schema:"public"},Sb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wb={},Eb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Cb=()=>Headers,Tb=(o,a,s)=>{const l=Eb(s),u=Cb();return async(d,f)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(f?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},f),{headers:m}))}};function Ab(o){return o.endsWith("/")?o:o+"/"}function Ob(o,a){var s,l;const{db:u,auth:d,realtime:f,global:g}=o,{db:p,auth:m,realtime:v,global:x}=a,S={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),f),storage:{},global:Object.assign(Object.assign(Object.assign({},x),g),{headers:Object.assign(Object.assign({},(s=x?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?S.accessToken=o.accessToken:delete S.accessToken,S}function Nb(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ab(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Qp="2.81.1",tr=30*1e3,ju=3,ou=ju*tr,Rb="http://localhost:9999",kb="supabase.auth.token",Ub={"X-Client-Info":`gotrue-js/${Qp}`},Su="X-Supabase-Api-Version",Xp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},zb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Db=600*1e3;class rs extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function Ee(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Bb extends rs{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function Mb(o){return Ee(o)&&o.name==="AuthApiError"}class ui extends rs{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class Ba extends rs{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class Nn extends Ba{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function qb(o){return Ee(o)&&o.name==="AuthSessionMissingError"}class Xi extends Ba{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class kl extends Ba{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Ul extends Ba{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Lb(o){return Ee(o)&&o.name==="AuthImplicitGrantRedirectError"}class Yg extends Ba{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wu extends Ba{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function cu(o){return Ee(o)&&o.name==="AuthRetryableFetchError"}class Jg extends Ba{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class Eu extends Ba{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qg=` 	
\r=`.split(""),Ib=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Qg.length;a+=1)o[Qg[a].charCodeAt(0)]=-2;for(let a=0;a<Bl.length;a+=1)o[Bl[a].charCodeAt(0)]=a;return o})();function Xg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Bl[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(Bl[l]),a.queuedBits-=6}}function Fp(o,a,s){const l=Ib[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Fg(o){const a=[],s=f=>{a.push(String.fromCodePoint(f))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=f=>{$b(f,l,s)};for(let f=0;f<o.length;f+=1)Fp(o.charCodeAt(f),u,d);return a.join("")}function Hb(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Vb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Hb(l,a)}}function $b(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function ar(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)Fp(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Pb(o){const a=[];return Vb(o,s=>a.push(s)),new Uint8Array(a)}function di(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Xg(u,s,l)),Xg(null,s,l),a.join("")}function Gb(o){return Math.round(Date.now()/1e3)+o}function Kb(){return Symbol("auth-callback")}const Mt=()=>typeof window<"u"&&typeof document<"u",ii={tested:!1,writable:!1},Zp=()=>{if(!Mt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ii.tested)return ii.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ii.tested=!0,ii.writable=!0}catch{ii.tested=!0,ii.writable=!1}return ii.writable};function Yb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const Wp=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Jb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",nr=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},ri=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},za=async(o,a)=>{await o.removeItem(a)};class Il{constructor(){this.promise=new Il.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Il.promiseConstructor=Promise;function uu(o){const a=o.split(".");if(a.length!==3)throw new Eu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!zb.test(a[l]))throw new Eu("JWT not in base64url format");return{header:JSON.parse(Fg(a[0])),payload:JSON.parse(Fg(a[1])),signature:ar(a[2]),raw:{header:a[0],payload:a[1]}}}async function Qb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Xb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const f=await o(d);if(!a(d,null,f)){l(f);return}}catch(f){if(!a(d,f)){u(f);return}}})()})}function Fb(o){return("0"+o.toString(16)).substr(-2)}function Zb(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Fb).join("")}async function Wb(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function e0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await Wb(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fi(o,a,s=!1){const l=Zb();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await nr(o,`${a}-code-verifier`,u);const d=await e0(l);return[d,l===d?"plain":"s256"]}const t0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function n0(o){const a=o.headers.get(Su);if(!a||!a.match(t0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function a0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function i0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const r0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zi(o){if(!r0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function du(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function Zg(o){return JSON.parse(JSON.stringify(o))}const li=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),l0=[502,503,504];async function Wg(o){var a;if(!Jb(o))throw new wu(li(o),0);if(l0.includes(o.status))throw new wu(li(o),o.status);let s;try{s=await o.json()}catch(d){throw new ui(li(d),d)}let l;const u=n0(o);if(u&&u.getTime()>=Xp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Jg(li(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new Nn}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,f)=>d&&typeof f=="string",!0))throw new Jg(li(s),o.status,s.weak_password.reasons);throw new Bb(li(s),o.status||500,l)}const o0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Oe(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[Su]||(d[Su]=Xp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const f=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(f.redirect_to=l.redirectTo);const g=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",p=await c0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function c0(o,a,s,l,u,d){const f=o0(a,l,u,d);let g;try{g=await o(s,Object.assign({},f))}catch(p){throw console.error(p),new wu(li(p),0)}if(g.ok||await Wg(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await Wg(p)}}function Rn(o){var a;let s=null;h0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Gb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function ep(o){const a=Rn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Da(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function u0(o){return{data:o,error:null}}function d0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,f=rr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},f);return{data:{properties:g,user:p},error:null}}function tp(o){return o}function h0(o){return o.access_token&&o.refresh_token&&o.expires_in}const hu=["global","local","others"];class f0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=Wp(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=hu[0]){if(hu.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hu.join(", ")}`);try{return await Oe(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Ee(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Oe(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Da})}catch(l){if(Ee(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=rr(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Oe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:d0,redirectTo:s?.redirectTo})}catch(s){if(Ee(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Oe(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Da})}catch(s){if(Ee(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Oe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const x=await v.json(),S=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const A=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(w.split(";")[1].split("=")[1]);m[`${N}Page`]=A}),m.total=parseInt(S)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(Ee(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){Zi(a);try{return await Oe(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Da})}catch(s){if(Ee(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){Zi(a);try{return await Oe(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:Da})}catch(l){if(Ee(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){Zi(a);try{return await Oe(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:Da})}catch(l){if(Ee(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){Zi(a.userId);try{const{data:s,error:l}=await Oe(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _deleteFactor(a){Zi(a.userId),Zi(a.id);try{return{data:await Oe(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Oe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:tp});if(v.error)throw v.error;const x=await v.json(),S=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const A=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(w.split(";")[1].split("=")[1]);m[`${N}Page`]=A}),m.total=parseInt(S)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(Ee(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Oe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Oe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Oe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Ee(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Oe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Oe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}}function np(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const Wi={debug:!!(globalThis&&Zp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class em extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class g0 extends em{}async function p0(o,a,s){Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new g0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Wi.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function m0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tm(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function y0(o){return parseInt(o,16)}function v0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function b0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:f,notBefore:g,requestId:p,resources:m,scheme:v,uri:x,version:S}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(S!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${S}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=tm(o.address),w=v?`${v}://${l}`:l,A=o.statement?`${o.statement}
`:"",N=`${w} wants you to sign in with your Ethereum account:
${b}

${A}`;let T=`URI: ${x}
Version: ${S}
Chain ID: ${s}${f?`
Nonce: ${f}`:""}
Issued At: ${d.toISOString()}`;if(u&&(T+=`
Expiration Time: ${u.toISOString()}`),g&&(T+=`
Not Before: ${g.toISOString()}`),p&&(T+=`
Request ID: ${p}`),m){let M=`
Resources:`;for(const B of m){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);M+=`
- ${B}`}T+=M}return`${N}
${T}`}class Ct extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Ml extends Ct{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function _0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Ct({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Ct({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Ct({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new Ct({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Ct({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Ct({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Ct({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Ct({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const f=window.location.hostname;if(nm(f)){if(d.rp.id!==f)return new Ct({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ct({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Ct({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Ct({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ct({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function x0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Ct({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Ct({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(nm(l)){if(s.rpId!==l)return new Ct({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Ct({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Ct({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Ct({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class j0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const S0=new j0;function w0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=rr(o,["challenge","user","excludeCredentials"]),d=ar(a).buffer,f=Object.assign(Object.assign({},s),{id:ar(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:f});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:ar(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function E0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=rr(o,["challenge","allowCredentials"]),u=ar(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let f=0;f<s.length;f++){const g=s[f];d.allowCredentials[f]=Object.assign(Object.assign({},g),{id:ar(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function C0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:di(new Uint8Array(o.response.attestationObject)),clientDataJSON:di(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function T0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:di(new Uint8Array(u.authenticatorData)),clientDataJSON:di(new Uint8Array(u.clientDataJSON)),signature:di(new Uint8Array(u.signature)),userHandle:u.userHandle?di(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function nm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function ap(){var o,a;return!!(Mt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function A0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ml("Browser returned unexpected credential type",a)}:{data:null,error:new Ml("Empty credential response",a)}}catch(a){return{data:null,error:_0({error:a,options:o})}}}async function O0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ml("Browser returned unexpected credential type",a)}:{data:null,error:new Ml("Empty credential response",a)}}catch(a){return{data:null,error:x0({error:a,options:o})}}}const N0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},R0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ql(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const f=u[d];if(f!==void 0)if(Array.isArray(f))l[d]=f;else if(s(f))l[d]=f;else if(a(f)){const g=l[d];a(g)?l[d]=ql(g,f):l[d]=ql(f)}else l[d]=f}return l}function k0(o,a){return ql(N0,o,a||{})}function U0(o,a){return ql(R0,o,a||{})}class z0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:f,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!f)return{data:null,error:g};const p=u??S0.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=k0(f.webauthn.credential_options.publicKey,d?.create),{data:v,error:x}=await A0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}case"request":{const m=U0(f.webauthn.credential_options.publicKey,d?.request),{data:v,error:x}=await O0(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}}}catch(f){return Ee(f)?{data:null,error:f}:{data:null,error:new ui("Unexpected error in challenge",f)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new rs("rpId is required for WebAuthn authentication")};try{if(!ap())return{data:null,error:new ui("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!f)return{data:null,error:g};const{webauthn:p}=f;return this._verify({factorId:a,challengeId:f.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(f){return Ee(f)?{data:null,error:f}:{data:null,error:new ui("Unexpected error in authenticate",f)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new rs("rpId is required for WebAuthn registration")};try{if(!ap())return{data:null,error:new ui("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this._enroll({friendlyName:a});if(!f)return await this.client.mfa.listFactors().then(v=>{var x;return(x=v.data)===null||x===void 0?void 0:x.all.find(S=>S.factor_type==="webauthn"&&S.friendly_name===a&&S.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:f.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(f){return Ee(f)?{data:null,error:f}:{data:null,error:new ui("Unexpected error in register",f)}}}}m0();const D0={url:Rb,storageKey:kb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ub,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ip(o,a,s){return await s()}const er={};class ss{get jwks(){var a,s;return(s=(a=er[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){er[this.storageKey]=Object.assign(Object.assign({},er[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=er[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){er[this.storageKey]=Object.assign(Object.assign({},er[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},D0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=ss.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,ss.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&Mt()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new f0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Wp(d.fetch),this.lock=d.lock||ip,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:Mt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=p0:this.lock=ip,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new z0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:Zp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=np(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=np(this.memoryStorage)),Mt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Qp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(Mt()&&(s=Yb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),Mt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Lb(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:f,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",f,"redirect type",g),await this._saveSession(f),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return Ee(s)?this._returnResult({error:s}):this._returnResult({error:new ui("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:Rn}),{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ee(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:x,options:S}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await Fi(this.storage,this.storageKey)),d=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:S?.emailRedirectTo,body:{email:v,password:x,data:(s=S?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:S?.captchaToken},code_challenge:b,code_challenge_method:w},xform:Rn})}else if("phone"in a){const{phone:v,password:x,options:S}=a;d=await Oe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(l=S?.data)!==null&&l!==void 0?l:{},channel:(u=S?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:S?.captchaToken}},xform:Rn})}else throw new kl("You must provide either an email or phone number and a password");const{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ee(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:f,options:g}=a;s=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else if("phone"in a){const{phone:d,password:f,options:g}=a;s=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:ep})}else throw new kl("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Xi;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,f,g,p,m,v,x,S;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:A,wallet:N,statement:T,options:M}=a;let B;if(Mt())if(typeof N=="object")B=N;else{const ge=window;if("ethereum"in ge&&typeof ge.ethereum=="object"&&"request"in ge.ethereum&&typeof ge.ethereum.request=="function")B=ge.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=N}const G=new URL((s=M?.url)!==null&&s!==void 0?s:window.location.href),E=await B.request({method:"eth_requestAccounts"}).then(ge=>ge).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=tm(E[0]);let D=(l=M?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!D){const ge=await B.request({method:"eth_chainId"});D=y0(ge)}const V={domain:G.host,address:L,statement:T,uri:G.href,version:"1",chainId:D,nonce:(u=M?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(f=(d=M?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(g=M?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=M?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=M?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=M?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=b0(V),w=await B.request({method:"personal_sign",params:[v0(b),L]})}try{const{data:A,error:N}=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(S=a.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:Rn});if(N)throw N;if(!A||!A.session||!A.user){const T=new Xi;return this._returnResult({data:{user:null,session:null},error:T})}return A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),this._returnResult({data:Object.assign({},A),error:N})}catch(A){if(Ee(A))return this._returnResult({data:{user:null,session:null},error:A});throw A}}async signInWithSolana(a){var s,l,u,d,f,g,p,m,v,x,S,b;let w,A;if("message"in a)w=a.message,A=a.signature;else{const{chain:N,wallet:T,statement:M,options:B}=a;let G;if(Mt())if(typeof T=="object")G=T;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))G=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=T}const E=new URL((s=B?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in G&&G.signIn){const L=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),M?{statement:M}:null));let D;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")D=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)D=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)w=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),A=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(u=(l=B?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=B?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((f=B?.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((g=B?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((p=B?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((m=B?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((x=(v=B?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",...B.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const L=await G.signMessage(new TextEncoder().encode(w),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");A=L}}try{const{data:N,error:T}=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:di(A)},!((S=a.options)===null||S===void 0)&&S.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Rn});if(T)throw T;if(!N||!N.session||!N.user){const M=new Xi;return this._returnResult({data:{user:null,session:null},error:M})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:T})}catch(N){if(Ee(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(a){const s=await ri(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:f}=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:Rn});if(await za(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!d||!d.session||!d.user){const g=new Xi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:f})}catch(d){if(Ee(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:f}=a,g=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:f,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Rn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new Xi;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,f;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Fi(this.storage,this.storageKey));const{error:x}=await Oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Oe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(f=p?.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new kl("You must provide either an email or phone number.")}catch(g){if(Ee(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:f,error:g}=await Oe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:Rn});if(g)throw g;if(!f)throw new Error("An error occurred on token verification.");const p=f.session,m=f.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(Ee(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,f;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Fi(this.storage,this.storageKey));const m=await Oe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:u0});return!((d=m.data)===null||d===void 0)&&d.url&&Mt()&&!(!((f=a.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(Ee(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new Nn;const{error:u}=await Oe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(Ee(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:f}=await Oe(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:f,error:g}=await Oe(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:g})}throw new kl("You must provide either an email or phone number and a type")}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await ri(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<ou:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const f=await ri(this.userStorage,this.storageKey+"-user");f?.user?a.user=f.user:a.user=du()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};a.user=s0(a.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Da}):await this._useSession(async s=>{var l,u,d;const{data:f,error:g}=s;if(g)throw g;return!(!((l=f.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Nn}:await Oe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Da})})}catch(s){if(Ee(s))return qb(s)&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new Nn;const f=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await Fi(this.storage,this.storageKey));const{data:m,error:v}=await Oe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:f.access_token,xform:Da});if(v)throw v;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(l){if(Ee(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new Nn;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:f}=uu(a.access_token);if(f.exp&&(l=f.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(Ee(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:f,error:g}=s;if(g)throw g;a=(l=f.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new Nn;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(Ee(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!Mt())throw new Ul("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Ul(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Yg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ul("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Yg("No code detected.");const{data:M,error:B}=await this._exchangeCodeForSession(a.code);if(B)throw B;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:f,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!f||!m)throw new Ul("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(g);let S=v+x;p&&(S=parseInt(p));const b=S-v;b*1e3<=tr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const w=S-x;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,S,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,S,v);const{data:A,error:N}=await this._getUser(d);if(N)throw N;const T={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:x,expires_at:S,refresh_token:f,token_type:m,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:T,redirectType:a.type},error:null})}catch(l){if(Ee(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await ri(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const f=(l=u.session)===null||l===void 0?void 0:l.access_token;if(f){const{error:g}=await this.admin.signOut(f,a);if(g&&!(Mb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Kb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:f}=s;if(f)throw f;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Fi(this.storage,this.storageKey,!0));try{return await Oe(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(Ee(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var f,g,p,m,v;const{data:x,error:S}=d;if(S)throw S;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(f=a.options)===null||f===void 0?void 0:f.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Oe(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=x.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return Mt()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(Ee(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:f,provider:g,token:p,access_token:m,nonce:v}=a,x=await Oe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Rn}),{data:S,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!S||!S.session||!S.user?this._returnResult({data:{user:null,session:null},error:new Xi}):(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("USER_UPDATED",S.session)),this._returnResult({data:S,error:b}))}catch(u){if(Ee(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)throw f;return await Oe(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Xb(async u=>(u>0&&await Qb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Oe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Rn})),(u,d)=>{const f=200*Math.pow(2,u);return d&&cu(d)&&Date.now()+f-l<tr})}catch(l){if(this._debug(s,"error",l),Ee(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),Mt()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await ri(this.storage,this.storageKey);if(u&&this.userStorage){let f=await ri(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:u.user},await nr(this.userStorage,this.storageKey+"-user",f)),u.user=(a=f?.user)!==null&&a!==void 0?a:du()}else if(u&&!u.user&&!u.user){const f=await ri(this.storage,this.storageKey+"-user");f&&f?.user?(u.user=f.user,await za(this.storage,this.storageKey+"-user"),await nr(this.storage,this.storageKey,u)):u.user=du()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<ou;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${ou}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:f}=await this._callRefreshToken(u.refresh_token);f&&(console.error(f),cu(f)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:g}=await this._getUser(u.access_token);!g&&f?.user?(u.user=f.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(l,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new Nn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Il;const{data:d,error:f}=await this._refreshAccessToken(a);if(f)throw f;if(!d.session)throw new Nn;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),Ee(d)){const f={data:null,error:d};return cu(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(f),f}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],f=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(f),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await nr(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=Zg(u);await nr(this.storage,this.storageKey,d)}else{const u=Zg(s);await nr(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await za(this.storage,this.storageKey),await za(this.storage,this.storageKey+"-code-verifier"),await za(this.storage,this.storageKey+"-user"),this.userStorage&&await za(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&Mt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),tr);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/tr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${tr}ms, refresh threshold is ${ju} ticks`),u<=ju&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof em)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Mt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,f]=await Fi(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(f)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Oe(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)return this._returnResult({data:null,error:f});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Oe(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?C0(a.webauthn.credential_response):T0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Oe(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:f,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=await Oe(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(f.error)return f;const{data:g}=f;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:w0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:E0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=uu(l.access_token);let f=null;d.aal&&(f=d.aal);let g=f;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Oe(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new Nn})})}catch(s){if(Ee(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new Nn});const f=await Oe(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Mt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(Ee(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new Nn});const f=await Oe(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&Mt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(Ee(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Db>u)return l;const{data:d,error:f}=await Oe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:f,raw:{header:g,payload:p}}=uu(l);s?.allowExpired||a0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:f},error:null}}const v=i0(u.alg),x=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,f,Pb(`${g}.${p}`)))throw new Eu("Invalid JWT signature");return{data:{claims:d,header:u,signature:f},error:null}}catch(l){if(Ee(l))return this._returnResult({data:null,error:l});throw l}}}ss.nextInstanceID={};const B0=ss;class M0 extends B0{constructor(a){super(a)}}class q0{constructor(a,s,l){var u,d,f;this.supabaseUrl=a,this.supabaseKey=s;const g=Nb(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:jb,realtime:wb,auth:Object.assign(Object.assign({},Sb),{storageKey:p}),global:xb},v=Ob(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(x,S)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(S)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=v.auth)!==null&&f!==void 0?f:{},this.headers,v.global.fetch),this.fetch=Tb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new Rv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new vb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Tv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:f,flowType:g,lock:p,debug:m,throwOnError:v},x,S){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),x),storageKey:f,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:S,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Jv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const L0=(o,a,s)=>new q0(o,a,s);function I0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}I0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const H0="https://sqwqlvsjtimallidxrsz.supabase.co",V0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",Z=L0(H0,V0,{auth:{persistSession:!1}}),Sn=Object.freeze(Object.defineProperty({__proto__:null,default:Z,supabase:Z},Symbol.toStringTag,{value:"Module"}));function $0({onLogin:o}){const[a,s]=j.useState(""),[l,u]=j.useState(""),[d,f]=j.useState(null);async function g(p){p.preventDefault(),f(null);try{const{data:m,error:v}=await Z.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){f("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){f("Credenciales invlidas");return}const x=m;if(x.password===l){const S={id:x.id,username:x.username,role:x.role};localStorage.setItem("user",JSON.stringify(S));try{console.debug("Login: stored localStorage.user =",S)}catch{}try{if(x.role==="cajero"){const{data:b,error:w}=await Z.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",x.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}f("Inicio de sesin correcto"),typeof o=="function"&&o()}else f("Credenciales invlidas")}catch(m){f(m.message||"Error al consultar la base de datos")}}return r.jsx("div",{className:"login-root",children:r.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[r.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),r.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),r.jsxs("div",{className:"login-inner",children:[r.jsxs("form",{onSubmit:g,children:[r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"username",children:"Usuario"}),r.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"password",children:"Contrasea"}),r.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),r.jsx("div",{children:r.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&r.jsx("p",{style:{marginTop:12},children:d}),r.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",r.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function P0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),r.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function G0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!0),[d,f]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,S]=j.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=j.useState(()=>{try{const T=localStorage.getItem("user");if(T)return JSON.parse(T).username||"usuario"}catch{}return"usuario"});j.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(T=>T.json()).then(T=>{const M=T&&Array.isArray(T.ingresos)?T.ingresos:[],B=localStorage.getItem("ingresosEfectivo");let G=[];try{B&&(G=JSON.parse(B))}catch{}const E=[...M,...G];s(E)}).catch(()=>{const T=localStorage.getItem("ingresosEfectivo");try{T&&s(JSON.parse(T))}catch{s([])}}).finally(()=>u(!1))},[]);function A(T){localStorage.setItem("ingresosEfectivo",JSON.stringify(T))}function N(T){if(T.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const M=a.length?Math.max(...a.map(E=>E.id))+1:1,B={id:M,factura:d||`F-${M}`,motivo:g,monto:Number(m),fechaHora:new Date(x).toISOString(),usuario:b},G=[...a,B];s(G),A(G),f(""),p(""),v(""),S(new Date().toISOString().slice(0,16))}return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?r.jsx("p",{children:"Cargando..."}):r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),r.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),r.jsx("tbody",{children:a.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(T=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:{padding:8},children:T.factura}),r.jsx("td",{style:{padding:8},children:T.motivo}),r.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",T.monto.toFixed(2)]}),r.jsx("td",{style:{padding:8},children:new Date(T.fechaHora).toLocaleString()}),r.jsx("td",{style:{padding:8},children:T.usuario})]},T.id))})]})})]}),r.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),r.jsxs("form",{onSubmit:N,style:{display:"grid",gap:8},children:[r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",r.jsx("input",{value:d,onChange:T=>f(T.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",r.jsx("input",{value:g,onChange:T=>p(T.target.value),className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",r.jsx("input",{value:m,onChange:T=>v(T.target.value===""?"":Number(T.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",r.jsx("input",{value:x,onChange:T=>S(T.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",r.jsx("input",{value:b,onChange:T=>w(T.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[r.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),r.jsx("button",{type:"button",onClick:()=>{f(""),p(""),v(""),S(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function K0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!1),[d,f]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(!1),[x,S]=j.useState(!1),[b,w]=j.useState(null),A=async()=>{u(!0);try{const{data:Q,error:de}=await Z.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(de)throw de;const me=Array.isArray(Q)?Q:[],q=Array.from(new Set(me.map(C=>C.cliente_id).filter(Boolean)));let W={};if(q.length>0)try{const{data:C}=await Z.from("clientes").select("id,nombre").in("id",q);if(Array.isArray(C))for(const U of C)W[String(U.id)]=U.nombre||""}catch(C){console.warn("Error cargando nombres de clientes:",C)}const ie=me.map(C=>({...C,cliente_nombre:W[String(C.cliente_id)]||null}));s(ie)}catch(Q){console.warn("Error cargando cotizaciones:",Q),s([])}u(!1)};j.useEffect(()=>{A()},[]);const[N,T]=j.useState(null),[M,B]=j.useState(null),[G,E]=j.useState(""),L=async Q=>{f(Q);try{const{data:de,error:me}=await Z.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",Q).maybeSingle();if(me&&console.warn("Error cargando cabecera de cotizacion",me),T(de||null),de&&de.cliente_id)try{const{data:ie}=await Z.from("clientes").select("id,nombre").eq("id",de.cliente_id).maybeSingle();B(ie?.nombre||null)}catch{B(null)}else B(null);const{data:q,error:W}=await Z.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Q);if(W)throw W;p(Array.isArray(q)?q:[]),v(!0)}catch(de){console.warn("Error cargando detalles de cotizacion",de),p([])}},D=async Q=>{try{const{data:de,error:me}=await Z.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Q.id),q=Array.isArray(de)?de:[],W={header:Q,detalles:q};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(W))}catch(ie){console.warn("No se pudo escribir localStorage",ie)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:W}))}catch{}o()}catch(de){console.warn("Error cargando detalles para editar",de)}},V=async Q=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:de}=await Z.from("cotizaciones_detalle").delete().eq("cotizacion_id",Q);de&&console.warn("Error eliminando detalles:",de);const{error:me}=await Z.from("cotizaciones").delete().eq("id",Q);if(me)throw me;A()}catch(de){console.warn("Error eliminando cotizacion:",de)}},ge=async()=>{if(b)try{const Q={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:de}=await Z.from("cotizaciones").update(Q).eq("id",b.id);if(de&&console.warn("Error actualizando cotizacion:",de),b.id){const{error:me}=await Z.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);me&&console.warn("Error borrando detalles antiguos:",me);const q=g.map(ie=>({...ie,cotizacion_id:b.id})),{error:W}=await Z.from("cotizaciones_detalle").insert(q);W&&console.warn("Error insertando detalles actualizados:",W)}S(!1),A()}catch(Q){console.warn("Error guardando cotizacion editada:",Q)}};return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),r.jsxs("div",{children:[r.jsx("button",{onClick:A,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),r.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),r.jsx("input",{placeholder:"Nmero o cliente",value:G,onChange:Q=>E(Q.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),r.jsx("button",{onClick:()=>E(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?r.jsx("div",{children:"Cargando..."}):a.length===0?r.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Nmero"}),r.jsx("th",{style:{padding:8},children:"Fecha"}),r.jsx("th",{style:{padding:8},children:"Usuario"}),r.jsx("th",{style:{padding:8},children:"Cliente ID"}),r.jsx("th",{style:{padding:8},children:"Total"}),r.jsx("th",{style:{padding:8},children:"Estado"}),r.jsx("th",{style:{padding:8},children:"Acciones"})]})}),r.jsx("tbody",{children:a.filter(Q=>{if(!G)return!0;const de=G.toLowerCase(),me=(Q.numero_cotizacion||"").toLowerCase(),q=(Q.cliente_nombre||"")?.toLowerCase(),W=(Q.usuario||"").toLowerCase();return me.includes(de)||q.includes(de)||W.includes(de)}).map(Q=>r.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[r.jsx("td",{style:{padding:8},children:Q.numero_cotizacion||""}),r.jsx("td",{style:{padding:8},children:Q.fecha_cotizacion?new Date(Q.fecha_cotizacion).toLocaleString():""}),r.jsx("td",{style:{padding:8},children:Q.usuario||""}),r.jsx("td",{style:{padding:8},children:Q.cliente_nombre||(Q.cliente_id?String(Q.cliente_id):"")}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.total||0).toFixed(2)]}),r.jsx("td",{style:{padding:8},children:Q.estado||""}),r.jsxs("td",{style:{padding:8},children:[r.jsx("button",{onClick:()=>L(Q.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(Q.estado||"").toLowerCase()==="aceptada"?r.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):r.jsx("button",{onClick:()=>D(Q),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),r.jsx("button",{onClick:()=>V(Q.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},Q.id))})]})]}),m&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),r.jsx("button",{onClick:()=>{v(!1),p([]),f(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[N&&r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Nmero:"})," ",N.numero_cotizacion]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Fecha:"})," ",N.fecha_cotizacion?new Date(N.fecha_cotizacion).toLocaleString():""]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Usuario:"})," ",N.usuario]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Cliente:"})," ",M??(N.cliente_id?String(N.cliente_id):"C/F")]})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Subtotal:"})," L ",Number(N.subtotal||0).toFixed(2)]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Impuesto:"})," L ",Number(N.impuesto||0).toFixed(2)]}),r.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[r.jsx("strong",{children:"Total:"})," L ",Number(N.total||0).toFixed(2)]})]})]}),r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Descripcin"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio U."}),r.jsx("th",{style:{padding:8},children:"Subtotal"}),r.jsx("th",{style:{padding:8},children:"Descuento"}),r.jsx("th",{style:{padding:8},children:"Total"})]})}),r.jsx("tbody",{children:g.map((Q,de)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:Q.descripcion}),r.jsx("td",{style:{padding:8},children:Q.cantidad}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.precio_unitario||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.subtotal||(Q.precio_unitario||0)*(Q.cantidad||0)).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.descuento||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(Q.total||(Q.subtotal||0)-(Q.descuento||0)).toFixed(2)]})]},de))})]})]})]})}),x&&b&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),r.jsx("button",{onClick:()=>{S(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Cliente"}),r.jsx("input",{value:b.cliente||"",onChange:Q=>w({...b,cliente:Q.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"RTN"}),r.jsx("input",{value:b.rtn||"",onChange:Q=>w({...b,rtn:Q.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"SKU"}),r.jsx("th",{style:{padding:8},children:"Nombre"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio"}),r.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),r.jsx("tbody",{children:g.map((Q,de)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:Q.sku}),r.jsx("td",{style:{padding:8},children:Q.nombre}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:Q.cantidad||0,onChange:me=>{const q=Number(me.target.value||0),W=[...g];W[de]={...W[de],cantidad:q},p(W)},style:{width:80,padding:6}})}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:Q.precio_unitario||0,onChange:me=>{const q=Number(me.target.value||0),W=[...g];W[de]={...W[de],precio_unitario:q},p(W)},style:{width:120,padding:6}})}),r.jsxs("td",{style:{padding:8},children:["L ",Number((Q.precio_unitario||0)*(Q.cantidad||0)).toFixed(2)]})]},de))})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:()=>{S(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:ge,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function Y0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),r.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function J0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function Q0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function X0({open:o,onClose:a,onSelect:s}){const[l,u]=j.useState(""),[d,f]=j.useState(!1),[g,p]=j.useState([]);return j.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{f(!0);try{const{data:v,error:x}=await Z.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(x)throw x;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&f(!1)}})(),()=>{m=!1}},[o]),j.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{f(!0);try{const v=String(l||"").trim();let x;if(v===""?x=await Z.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):x=await Z.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),x.error)throw x.error;p(Array.isArray(x.data)?x.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{f(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:r.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),r.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),r.jsx("th",{style:{padding:8}})]})}),r.jsxs("tbody",{children:[g.map(m=>r.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[r.jsx("td",{style:{padding:8},children:m.rtn}),r.jsx("td",{style:{padding:8},children:m.nombre}),r.jsx("td",{style:{padding:8},children:m.telefono}),r.jsx("td",{style:{padding:8},children:m.correo_electronico}),r.jsx("td",{style:{padding:8},children:r.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function F0({open:o,onClose:a,totalDue:s,onConfirm:l}){const[u,d]=j.useState(0),[f,g]=j.useState(0),[p,m]=j.useState(0);j.useEffect(()=>{o||(d(0),g(0),m(0))},[o]);const v=Number((Number(u)+Number(f)+Number(p)).toFixed(2)),x=Number((s-v).toFixed(2)),S=v>=s&&v>0,b=()=>{const w=[];u>0&&w.push(`efectivo:(${u.toFixed(2)})`),f>0&&w.push(`tarjeta:(${f.toFixed(2)})`),p>0&&w.push(`transferencia:(${p.toFixed(2)})`);const A=w.join(",");l({efectivo:u,tarjeta:f,transferencia:p,totalPaid:v,tipoPagoString:A}),a()};return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",r.jsxs("strong",{children:["L ",s.toFixed(2)]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Efectivo"}),r.jsx("input",{type:"number",value:u,onChange:w=>d(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Tarjeta"}),r.jsx("input",{type:"number",value:f,onChange:w=>g(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Transferencia"}),r.jsx("input",{type:"number",value:p,onChange:w=>m(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:r.jsxs("div",{children:[r.jsx("label",{children:"Total ingresado"}),r.jsxs("div",{style:{padding:8,borderRadius:6,border:"1px solid #e6edf3"},children:["L ",v.toFixed(2)]})]})})]}),r.jsx("div",{style:{marginTop:12},children:x>0?r.jsxs("div",{style:{color:"#ef4444"},children:["Falta: L ",x.toFixed(2)]}):r.jsxs("div",{style:{color:"#16a34a"},children:["Pago completo. Cambio/Exceso: L ",Math.abs(x).toFixed(2)]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:b,className:"btn-opaque",disabled:!S,style:{background:S?"#16a34a":"gray",color:"white"},children:"Confirmar pago"})]})]})]})}):null}function Z0({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:f}){return r.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:u}),r.jsx("th",{style:u,children:"Imagen"}),r.jsx("th",{style:u,children:"SKU"}),r.jsx("th",{style:u,children:"Nombre"}),r.jsx("th",{style:u,children:"Categora"}),r.jsx("th",{style:u,children:"Precio"}),r.jsx("th",{style:u,children:"Stock"}),r.jsx("th",{style:u,children:"Accin"})]})}),r.jsx("tbody",{children:o.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:d,children:r.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),r.jsx("td",{style:d,children:a[String(g.id)]?r.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?r.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),r.jsx("td",{style:d,children:r.jsx("code",{style:f,children:g.sku})}),r.jsx("td",{style:d,children:r.jsx("strong",{children:g.nombre})}),r.jsx("td",{style:d,children:r.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),r.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return r.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,x=v?p<1?"Agotado":"Sin precio":"Agregar";return r.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:x})})()})]},g.id))})]})})}function W0({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:f,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:x}){return r.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&r.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&r.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[r.jsx("span",{children:"Subtotal:"}),r.jsxs("span",{children:["L",u.toFixed(2)]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",color:"#16a34a",fontWeight:500},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsxs("div",{children:["ISV (",(f*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((S,b)=>S+(b.isv||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto 18%: ",r.jsxs("strong",{children:["L",Number(d.reduce((S,b)=>S+(b.imp18||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto turstico (",(p*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((S,b)=>S+(b.tur||0),0)).toFixed(2)]})]})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[r.jsx("span",{children:"TOTAL:"}),r.jsxs("span",{children:["L",m.toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:[r.jsxs("div",{children:["Tax rates: ISV ",(f*100).toFixed(2),"%, 18% ",(g*100).toFixed(2),"%, Tur ",(p*100).toFixed(2),"%"]}),r.jsxs("details",{style:{marginTop:6},children:[r.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),r.jsx("div",{style:{marginTop:8},children:d.map(S=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[r.jsxs("div",{style:{color:"#0f172a"},children:[S.nombre,"  L",S.price.toFixed(2)]}),r.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",S.isv.toFixed(2),"  18%: L",S.imp18.toFixed(2),"  Tur: L",S.tur.toFixed(2)]})]},String(S.id)))})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[r.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),r.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?r.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):r.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(S=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",S.producto.sku,"] ",S.producto.nombre]}),r.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(S.producto.precio||0).toFixed(2)," c/u"]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("button",{onClick:()=>a(S.producto.id,-1),style:x,children:""}),r.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:S.cantidad}),r.jsx("button",{onClick:()=>a(S.producto.id,1),style:x,children:"+"}),r.jsx("button",{onClick:()=>s(S.producto.id),style:{...x,background:"#ef4444"},children:""})]})]},S.producto.id))})]})}function e_({userName:o,userRole:a,userId:s,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:f}){const[g,p]=j.useState(!1),m=j.useRef(null);return j.useEffect(()=>{function v(x){m.current&&!m.current.contains(x.target)&&p(!1)}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]),r.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[r.jsx("h1",{style:{margin:0,fontSize:"1.4rem",fontWeight:600},children:"Solutecc  -  Caja"}),r.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[r.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),r.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""}),s!=null&&r.jsxs("div",{style:{fontSize:"0.75rem",color:"#cbd5e1",marginTop:2},children:["ID: ",String(s)]})]}),r.jsxs("div",{style:{position:"relative"},ref:m,children:[r.jsx("button",{onClick:()=>p(v=>!v),"aria-expanded":g,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),g&&r.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[r.jsx("button",{onClick:()=>{p(!1),d()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),r.jsx("button",{onClick:()=>{p(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),r.jsx("button",{onClick:()=>{p(!1),f("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),r.jsx("button",{onClick:()=>{p(!1),f("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),r.jsx("button",{onClick:()=>{p(!1),f("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),r.jsx("button",{onClick:()=>{p(!1),f("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),r.jsx("button",{onClick:()=>{p(!1),f("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),r.jsx("button",{onClick:()=>{p(!1),f("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function t_({open:o,onClose:a,width:s=520,children:l,zIndex:u=9999}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:r.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:s,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})}):null}function n_({open:o,onClose:a,caiInfo:s,onRefresh:l}){const[u,d]=Tu.useState(!1);return r.jsx(t_,{open:o,onClose:a,width:520,children:r.jsxs("div",{children:[r.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),r.jsxs("div",{style:{color:"#475569",marginTop:8},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"CAI:"})," ",s?.cai??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Identificador:"})," ",s?.identificador??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango desde:"})," ",s?.rango_de??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango hasta:"})," ",s?.rango_hasta??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Fecha lmite emisin:"})," ",s?.fecha_vencimiento??s?.fecha_limite_emision??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Secuencia actual:"})," ",s?.secuencia_actual??"-"]})]}),r.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),r.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(f){console.debug("Error calling onRefresh from DatosFacturaModal:",f)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function a_({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),r.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?r.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):r.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),r.jsxs("div",{style:{flex:1},children:[r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"SKU:"})," ",a.sku]}),r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),r.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),r.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:r.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):r.jsx("div",{children:r.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function i_({open:o,onClose:a,onCancel:s,onSave:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),r.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function r_({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:f,taxRate:g,taxableSubtotal:p}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:"Elige si la factura ser para Cliente Final o para un Cliente registrado. Cliente Final genera una factura inmediata lista para imprimir. Cliente Normal permite ingresar datos del cliente."}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[r.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Factura para consumidor final. No requiere RTN."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar nombre y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar razn social y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]})]})]}),r.jsxs("div",{style:{width:220,borderLeft:"1px dashed #e6edf3",paddingLeft:16,display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontWeight:700},children:"Resumen"}),r.jsxs("div",{style:{color:"#475569"},children:["Items: ",r.jsx("strong",{children:d})]}),r.jsxs("div",{style:{color:"#475569"},children:["SubTotal: ",r.jsxs("strong",{children:["L ",f.toFixed(2)]})]}),r.jsxs("div",{style:{color:"#475569"},children:["ISV (",(g*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L ",(p*g).toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:18,fontWeight:800},children:["Total: L ",(f+p*g).toFixed(2)]}),r.jsx("div",{style:{marginTop:12,fontSize:12,color:"#94a3b8"},children:"Seleccione una opcin para continuar."})]})]})}):null}function s_({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:f,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:x,onTelefonoChange:S,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:A,onCancel:N,onOpenCreateCliente:T,onOpenPayment:M,paymentDone:B,submitClienteNormal:G}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{value:l,onChange:E=>v(E.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&r.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),r.jsx("input",{value:u,onChange:E=>x(E.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx(X0,{open:p,onClose:()=>m(!1),onSelect:E=>{}}),r.jsx("button",{onClick:N,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:T,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),B?r.jsx("button",{onClick:G,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):r.jsx("button",{onClick:M,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function l_({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:f,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:x,onCreate:S}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",r.jsx("strong",{children:"juridico"}),"."]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),r.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),r.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),r.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),r.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{id:"exon",type:"checkbox",checked:f,onChange:b=>x(b.target.checked)}),r.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:async()=>{await S()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})}):null}function rp(o={},a="factura",s={}){const l=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),u=o.rtn||"C/F",d=o.factura||String(Math.floor(Math.random()*9e5)+1e5),f=new Date().toLocaleString(),g=Array.isArray(s.carrito)?s.carrito:[],p=typeof s.subtotal=="number"?s.subtotal:g.reduce((M,B)=>M+Number(B.producto&&B.producto.precio||B.precio||0)*(B.cantidad||1),0),m=typeof s.isvTotal=="number"?s.isvTotal:0,v=typeof s.imp18Total=="number"?s.imp18Total:0,x=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,S=p+m+v+x,w=g.map(M=>{const B=String(M.producto&&(M.producto.nombre||M.producto.descripcion)||M.descripcion||M.nombre||""),G=Number(M.cantidad||0),E=Number((M.producto&&(M.producto.precio??M.producto.precio_unitario))??M.precio_unitario??M.precio??0),L=E.toFixed(2),D=(G*E).toFixed(2);return`<tr><td>${M.producto&&M.producto.sku||M.sku||""} ${B}</td><td style="text-align:center">${G}</td><td style="text-align:right">L ${L}</td><td style="text-align:right">L ${D}</td></tr>`}).join(`
`),A=a==="factura"?"FACTURA":"COTIZACIN",N=a==="factura"?"":'<div style="margin-top:12px;text-align:center;color:#475569">Vlida por 24 horas desde la fecha de emisin.</div>';return`<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>${A}</title><style>
    body{font-family:Arial,Helvetica,sans-serif;font-size:12px;color:#000;margin:20px}
    .factura{max-width:800px;margin:0 auto}
    .header{display:flex;justify-content:space-between;align-items:center}
    .header img{width:180px;height:auto}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border:1px solid #000;padding:6px;text-align:left}
    th{background:#eee}
    .right{text-align:right}
    </style></head><body><div class="factura"><div class="header"><div>
    <h2>Solutecc - Punto de Ventas</h2>
    <div>RTN: 00000000000000</div>
    </div><div><h3>${A}</h3><div>No: ${d}</div><div>Fecha: ${f}</div></div></div>
    <hr/>
    <div><strong>Cliente:</strong> ${l}</div>
    <div><strong>RTN:</strong> ${u}</div>
    <table><thead><tr><th>Descripcin</th><th>Cant</th><th>Precio</th><th>Total</th></tr></thead><tbody>
    ${w}
    </tbody></table>
    <div style="margin-top:8px;text-align:right"><div>SubTotal: L ${p.toFixed(2)}</div><div>ISV: L ${m.toFixed(2)}</div><div>Impuesto 18%: L ${v.toFixed(2)}</div><div>Impuesto turstico: L ${x.toFixed(2)}</div><h3>Total: L ${S.toFixed(2)}</h3></div>
    ${N}
    <div style="margin-top:20px;text-align:center"><small>Gracias por su preferencia</small></div>
    </div></body></html>`}function o_({onLogout:o}){j.useEffect(()=>{const H=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=H||""}},[]);const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,f]=j.useState(""),[g,p]=j.useState("Todas"),[m,v]=j.useState(.15),[x,S]=j.useState(0),[b,w]=j.useState(0),A=["Todas",...Array.from(new Set(a.map(H=>H.categoria)))],N=a.filter(H=>(String(H.nombre||"").toLowerCase().includes(d.toLowerCase())||String(H.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||H.categoria===g)),T=l.reduce((H,te)=>H+Number(te.producto.precio||0)*te.cantidad,0);let M=0,B=0,G=0;for(const H of l){const te=Number(H.producto.precio||0)*H.cantidad,ye=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,ve=!!H.producto.aplica_impuesto_turistico;if(!ye){if(oe){const be=te*(x||0);B+=be}else{const be=te*(m||0);M+=be}ve&&(G+=te*(b||0))}}const E=T+M+B+G,L=l.map(H=>{const te=Number(H.producto.precio||0)*H.cantidad,ye=!!H.producto.exento,oe=!!H.producto.aplica_impuesto_18,ve=!!H.producto.aplica_impuesto_turistico;if(ye)return{id:H.producto.id,nombre:H.producto.nombre,price:te,isv:0,imp18:0,tur:0,totalTax:0};const be=oe?0:te*(m||0),pe=oe?te*(x||0):0,Te=ve?te*(b||0):0;return{id:H.producto.id,nombre:H.producto.nombre,price:te,isv:be,imp18:pe,tur:Te,totalTax:be+pe+Te}}),D=H=>{const te=Number(H.stock??0),ye=Number(H.precio??0);te<1||ye<=0||u(oe=>oe.find(be=>be.producto.id===H.id)?oe.map(be=>be.producto.id===H.id?{...be,cantidad:be.cantidad+1}:be):[...oe,{producto:H,cantidad:1}])},V=(H,te)=>{u(ye=>ye.map(oe=>{if(String(oe.producto.id)===String(H)){const ve=oe.cantidad+te;return ve>0?{...oe,cantidad:ve}:oe}return oe}).filter(oe=>oe.cantidad>0))},ge=H=>{u(te=>te.filter(ye=>String(ye.producto.id)!==String(H)))},Q=()=>u([]),[de,me]=j.useState(!1),[q,W]=j.useState("factura"),[ie,C]=j.useState(!1),[U,F]=j.useState(null),[ce,_e]=j.useState(null),[O,z]=j.useState(!1),[K,J]=j.useState(!1),[re,ae]=j.useState(""),[fe,he]=j.useState(""),xe=j.useRef(null),Ue=j.useRef(null),[Pe,ze]=j.useState("final"),[De,Xe]=j.useState(""),[gt,qt]=j.useState(""),[Tt,Yt]=j.useState(!1),[Vn,st]=j.useState(!1),[ht,Un]=j.useState(!1),[Hl,Rt]=j.useState(!1),[Vl,hi]=j.useState(null),[os,Ma]=j.useState(!1),$l=async H=>{if(he(H),!H||String(H).trim()===""){ae("");return}try{if(Pe==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",H);const{data:ve,error:be}=await Z.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",H).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:ve,error:be}),!be&&ve&&ve.nombre){ae(ve.nombre||""),Xe(ve.telefono||""),qt(ve.correo_electronico||""),Yt(!!ve.exonerado),setTimeout(()=>{try{Ue.current?.focus()}catch{}},50);return}else{ae(""),Xe(""),qt(""),Yt(!1);return}}const te="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",H);const{data:ye,error:oe}=await Z.from(te).select("nombre").eq("rtn",H).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:ye,error:oe}),!oe&&ye&&ye.nombre?(ae(ye.nombre||""),setTimeout(()=>{try{Ue.current?.focus()}catch{}},50)):ae("")}catch(te){console.warn("Error buscando cliente por RTN:",te)}},cs=H=>{if(H==="cotizacion"){W("cotizacion"),me(!0);return}W(H),me(!0)},Pl=async(H={})=>{try{if(!l||l.length===0)return null;const te=fi(),ye=M,oe=B,ve=G,be=Number(ye||0)+Number(oe||0)+Number(ve||0),pe=te+be;let Te=H.cliente_id??null;if(!Te&&H.rtn)try{const{data:lt,error:ot}=await Z.from("clientes").select("id").eq("rtn",H.rtn).maybeSingle();!ot&&lt&&lt.id&&(Te=lt.id)}catch{}const ue=En||"system",le=String(Math.floor(Math.random()*9e5)+1e5),Re={cliente_id:Te,usuario:ue,numero_cotizacion:le,validez_dias:30,subtotal:te,impuesto:be,total:pe,estado:"pendiente"};let Be=H.cotizacion_id??ce;if(Be){const lt={cliente_id:Re.cliente_id||null,usuario:Re.usuario,validez_dias:Re.validez_dias,subtotal:Re.subtotal,impuesto:Re.impuesto,total:Re.total,estado:Re.estado},{error:ot}=await Z.from("cotizaciones").update(lt).eq("id",Be);if(ot)return console.warn("Error actualizando cotizacion:",ot),null}else{const{data:lt,error:ot}=await Z.from("cotizaciones").insert([Re]).select("id").maybeSingle();if(ot)return console.warn("Error insertando cotizacion:",ot),null;if(Be=lt?.id||null,!Be)return null}const Ie=l.map(lt=>{const ot=Number(lt.producto.precio||0),ct=Number(lt.cantidad||0),$n=!!lt.producto.exento,Jt=!!lt.producto.aplica_impuesto_18,ca=!!lt.producto.aplica_impuesto_turistico,fn=$n||Jt?0:ot*(m||0)*ct,It=$n?0:Jt?ot*(x||0)*ct:0,ua=$n?0:ca?ot*(b||0)*ct:0,Mn=ot*ct,Ne=Mn+fn+It+ua;return{cotizacion_id:Be,producto_id:lt.producto.id||null,descripcion:lt.producto.nombre||"",cantidad:ct,precio_unitario:ot,subtotal:Mn,descuento:0,total:Ne}});try{await Z.from("cotizaciones_detalle").delete().eq("cotizacion_id",Be)}catch{}const{error:Gt}=await Z.from("cotizaciones_detalle").insert(Ie);return Gt?console.warn("Error insertando cotizaciones_detalle:",Gt):console.debug("Cotizacion guardada id=",Be),Be}catch(te){return console.warn("Error guardando cotizacion:",te),null}},fi=()=>l.reduce((H,te)=>H+Number(te.producto.precio||0)*te.cantidad,0),qa=()=>l.reduce((H,te)=>H+(te.producto.exento?0:Number(te.producto.precio||0)*te.cantidad),0),$t=async()=>{ze("final"),ae("Consumidor Final"),he("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),Ma(!0),Un(!0),me(!1)},zn=()=>{ze("normal"),ae(""),he(""),Rt(!1),hi(null),z(!0),me(!1)},Pt=()=>{ze("juridico"),ae(""),he(""),Rt(!1),hi(null),z(!0),me(!1)},Gl=async(H,te,ye)=>{const oe=rp({cliente:H,rtn:te},q,{carrito:l,subtotal:fi(),isvTotal:M,imp18Total:B,impTouristTotal:G});if(q==="factura"&&ce)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",ce);const{error:be}=await Z.from("cotizaciones").update({estado:"aceptada"}).eq("id",ce);if(be)console.warn("Error marcando cotizacion (pre-print):",be);else try{_e(null)}catch{}}catch(be){console.warn("Error marcacion pre-print:",be)}if(q==="factura")try{let be=null,pe=null;try{const Te=localStorage.getItem("user"),ue=Te?JSON.parse(Te):null;pe=ue&&(ue.id||ue.user?.id||ue.sub||ue.user_id)?ue.id||ue.user?.id||ue.sub||ue.user_id:null;const le=ue&&(ue.username||ue.user?.username||ue.name||ue.user?.name)?ue.username||ue.user?.username||ue.name||ue.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",Te),console.debug("PV: CAI lookup - parsed user object:",ue),console.debug("PV: CAI lookup - extracted userId:",pe,"typeof",typeof pe),console.debug("PV: CAI lookup - extracted userNameFromStorage:",le),pe){const Re=typeof pe=="string"&&/^\d+$/.test(pe)?Number(pe):pe;try{const{data:Be,error:Ie}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Re).order("id",{ascending:!1}).limit(1);!Ie&&Array.isArray(Be)&&Be.length>0&&(be=Be[0])}catch(Be){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Be)}}if(!be&&le)try{const{data:Re,error:Be}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",le).order("id",{ascending:!1}).limit(1);!Be&&Array.isArray(Re)&&Re.length>0&&(be=Re[0])}catch(Re){console.debug("PV: CAI lookup by cajero failed:",Re)}}catch(Te){console.debug("No se pudo cargar CAI desde frontend:",Te)}await us({clienteName:H,rtn:te,paymentPayload:ye,caiData:be,usuarioId:pe})}catch(be){console.warn("Error preparando venta antes de imprimir:",be),alert("Error preparando venta antes de imprimir: "+String(be))}const ve=window.open("","_blank");if(ve){ve.document.open(),ve.document.write(oe),ve.document.close();try{ve.focus(),ve.print()}catch(be){console.warn("Error during print (finalize):",be)}setTimeout(()=>{try{ve.close()}catch{}},800)}q==="factura"&&(Q(),await ds()),q==="cotizacion"&&(F({cliente:H,rtn:te}),C(!0))},us=async({clienteName:H,rtn:te,paymentPayload:ye,caiData:oe,usuarioId:ve})=>{if(!l||l.length===0)return null;const be=ye&&ye.tipoPagoString?String(ye.tipoPagoString):"",pe=ye&&ye.totalPaid?Number(ye.totalPaid||0):0,Te=pe>Number(E||0)?pe-Number(E||0):0;let ue=String(Math.floor(Math.random()*9e5)+1e5);const le=Ha||oe||null;let Re=null,Be=0,Ie=null,Gt=null;if(le&&(le.rango_de!==void 0||le.secuencia_actual!==void 0))try{const Ne=le.rango_de!=null?String(le.rango_de):"",at=le.rango_hasta!=null?String(le.rango_hasta):"",vt=le.secuencia_actual!=null?String(le.secuencia_actual):"",qe=Number(String(Ne).replace(/[^0-9]/g,""))||0,He=Number(String(at).replace(/[^0-9]/g,""))||0,kt=Number(String(vt).replace(/[^0-9]/g,""))||qe||0;Be=Math.max((at||Ne||"").length,String(kt).length,1),Gt=String(kt).padStart(Be,"0"),ue=(le.identificador?String(le.identificador):"")+Gt;const mi=kt+1;Re=mi,Ie=String(mi).padStart(Be,"0")}catch(Ne){console.debug("Error computing factura from caiInfoState, falling back to random:",Ne)}const lt={rtn:te||null,nombre_cliente:H||null,usuario:En||"system",factura:ue,tipo_pago:be,subtotal:Number(T||0),impuesto:Number(M+B+G||0),total:Number(E||0),estado:"pagada",cambio:String(Number(Te).toFixed(2)),cai:le?.cai??null,rango_desde:(le&&le.identificador?String(le.identificador):"")+(le?.rango_de!=null?String(le.rango_de):"")||null,rango_hasta:(le&&le.identificador?String(le.identificador):"")+(le?.rango_hasta!=null?String(le.rango_hasta):"")||null,fecha_limite_emision:le?.fecha_vencimiento??le?.fecha_limite_emision??null};let ot=null,ct=null;try{const Ne=await Z.from("ventas").insert([lt]).select("id, factura");ot=Ne.data??Ne,ct=Ne.error??null}catch(Ne){ct=Ne}if(console.debug("Insert venta response:",{ventaInsRaw:ot,ventaErr:ct}),ct){const Ne=String(ct&&(ct.message||ct.msg||ct.details)||""),at=ct&&ct.code?String(ct.code):"";if(at==="PGRST204"||Ne.includes("Could not find the")||/column .* of 'ventas'/.test(Ne)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:Ne,code:at});const qe={...lt};delete qe.cai,delete qe.rango_desde,delete qe.rango_hasta,delete qe.fecha_limite_emision;try{const He=await Z.from("ventas").insert([qe]).select("id, factura");if(ot=He.data??He,ct=He.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:ot,ventaErr:ct}),ct)throw ct}catch(He){throw console.error("Fallback insert also failed:",He),He}}else throw ct}const $n=Array.isArray(ot)?ot[0]:ot;let Jt=$n?$n.id||$n.id:null;if(!Jt)try{const{data:Ne,error:at}=await Z.from("ventas").select("id").eq("factura",ue).maybeSingle();at&&console.debug("Error buscando venta por factura (fallback):",at),Ne&&Ne.id&&(Jt=Ne.id)}catch(Ne){console.debug("fallback lookup error",Ne)}if(!Jt)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",ot),null;const ca=l.map(Ne=>{const at=Number(Ne.producto.precio||0),vt=Number(Ne.cantidad||0),qe=at*vt,He=0,kt=qe-He;return{venta_id:Jt,factura:ue,producto_id:Ne.producto.id,cantidad:vt,precio_unitario:at,subtotal:qe,descuento:He,total:kt}});if(oe&&ve&&(Ne=>typeof Ne=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Ne))(ve))try{const Ne=l.map(qe=>({producto_id:String(qe.producto.id),cantidad:Number(qe.cantidad||0),precio_unitario:Number(qe.producto.precio||0),subtotal:Number((Number(qe.producto.precio||0)*qe.cantidad).toFixed(6)),descuento:0,total:Number((Number(qe.producto.precio||0)*qe.cantidad).toFixed(6))})),{data:at,error:vt}=await Z.rpc("create_venta_with_detalle",{p_usuario_id:ve,p_usuario:En||ve,p_rtn:te||null,p_nombre_cliente:H||null,p_tipo_pago:be,p_subtotal:Number(T||0),p_impuesto:Number(M+B+G||0),p_total:Number(E||0),p_cambio:String(Number(Te).toFixed(2)),p_detalles:Ne});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:at,rpcErr:vt}),vt)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",vt);else if(at&&Array.isArray(at)&&at.length>0){const qe=at[0];try{if(le&&le.id!=null)try{const{data:He,error:kt}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",le.id).maybeSingle();if(!kt&&He){Bn(He);try{localStorage.setItem("caiInfo",JSON.stringify(He))}catch{}}}catch(He){console.debug("Error refreshing cai after RPC:",He)}}catch(He){console.debug("Error during post-RPC cai refresh:",He)}return qe.venta_id||qe.venta_id===0?qe.venta_id:Jt}else if(at&&at.venta_id){try{if(le&&le.id!=null)try{const{data:qe,error:He}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",le.id).maybeSingle();if(!He&&qe){Bn(qe);try{localStorage.setItem("caiInfo",JSON.stringify(qe))}catch{}}}catch(qe){console.debug("Error refreshing cai after RPC (scalar):",qe)}}catch(qe){console.debug("Error during post-RPC cai refresh (scalar):",qe)}return at.venta_id}}catch(Ne){console.warn("Error calling RPC create_venta_with_detalle:",Ne)}else oe&&ve&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",ve);const{data:It,error:ua}=await Z.from("ventas_detalle").insert(ca).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:It,detErr:ua}),ua)throw ua;const Mn=le&&(le.id||le.id===0)?le.id:null;if(Mn!=null&&Re!=null)try{const Ne=Ie??String(Re);try{const at=le?.rango_hasta!=null?String(le.rango_hasta):"",vt=Number(at.replace(/[^0-9]/g,""))||null,qe=Number(String(Ne).replace(/[^0-9]/g,""))||null;if(vt!=null&&qe!=null&&qe>vt)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:qe,rangoHastaNum:vt});else{const{error:He}=await Z.from("cai").update({secuencia_actual:Ne}).eq("id",Mn);if(He)console.debug("Error updating cai.secuencia_actual (manual path):",He);else{console.debug("Updated cai.secuencia_actual to",Ne,"for cai id",Mn);try{const kt={...le||{},secuencia_actual:Ne};Bn(kt);try{localStorage.setItem("caiInfo",JSON.stringify(kt))}catch{}}catch(kt){console.debug("Error updating local caiInfoState/localStorage:",kt)}}}}catch(at){console.debug("Validation error while checking rango_hasta:",at);const{error:vt}=await Z.from("cai").update({secuencia_actual:Ne}).eq("id",Mn);if(vt)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",vt);else{console.debug("Updated cai.secuencia_actual to",Ne,"for cai id",Mn);try{const qe={...le||{},secuencia_actual:Ne};Bn(qe);try{localStorage.setItem("caiInfo",JSON.stringify(qe))}catch{}}catch(qe){console.debug("Error updating local caiInfoState/localStorage (after validation):",qe)}}}}catch(Ne){console.debug("Exception updating cai.secuencia_actual:",Ne)}return Jt},ds=async()=>{if(q==="factura"&&ce)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",ce);const{error:H}=await Z.from("cotizaciones").update({estado:"aceptada"}).eq("id",ce);H?console.warn("Error marcando cotizacion como facturado:",H):console.debug("Cotizacion marcada como facturado:",ce)}catch(H){console.warn("Error procesando cotizacion tras facturar",H)}};j.useEffect(()=>{O&&setTimeout(()=>{try{xe.current?.focus()}catch{}},80)},[O]);const gi=async()=>{try{if(fe&&re){const oe={rtn:fe,nombre:re},{error:ve}=await Z.from("clientenatural").upsert(oe,{onConflict:"rtn"});ve&&console.warn("Error guardando clientenatural:",ve)}}catch(oe){console.warn("Error upsert clientenatural:",oe)}try{if(fe&&re)if(Pe==="juridico"){const{data:oe,error:ve}=await Z.from("clientes").select("id").eq("rtn",fe).eq("tipo_cliente","juridico").maybeSingle();if(ve&&console.warn("Error buscando cliente juridico:",ve),oe&&oe.id){const{error:be}=await Z.from("clientes").update({nombre:re,telefono:De||null,correo_electronico:gt||null,exonerado:Tt}).eq("id",oe.id);be&&console.warn("Error actualizando cliente juridico:",be)}else{const{error:be}=await Z.from("clientes").insert([{nombre:re,rtn:fe,telefono:De||null,correo_electronico:gt||null,tipo_cliente:"juridico",exonerado:Tt}]);be&&console.warn("Error insertando cliente juridico:",be)}}else{const oe={rtn:fe,nombre:re},{error:ve}=await Z.from("clientenatural").upsert(oe,{onConflict:"rtn"});ve&&console.warn("Error guardando clientenatural:",ve)}}catch(oe){console.warn("Error upsert cliente:",oe)}const H=rp({cliente:re||"Cliente",rtn:fe||""},q,{carrito:l,subtotal:fi(),isvTotal:M,imp18Total:B,impTouristTotal:G});if(q==="factura"&&ce)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",ce);const{error:oe}=await Z.from("cotizaciones").update({estado:"aceptada"}).eq("id",ce);if(oe)console.warn("Error marcando cotizacion como facturado (pre-print):",oe);else{console.debug("Cotizacion marcada como facturado (pre-print):",ce);try{_e(null)}catch{}}}catch(oe){console.warn("Error marcacion pre-print:",oe)}if(q==="factura")try{let oe=null,ve=null;try{const be=localStorage.getItem("user"),pe=be?JSON.parse(be):null;ve=pe&&(pe.id||pe.user?.id||pe.sub||pe.user_id)?pe.id||pe.user?.id||pe.sub||pe.user_id:null;const Te=pe&&(pe.username||pe.user?.username||pe.name||pe.user?.name)?pe.username||pe.user?.username||pe.name||pe.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",be),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",pe),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",ve,"typeof",typeof ve),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",Te),ve){const ue=typeof ve=="string"&&/^\d+$/.test(ve)?Number(ve):ve;try{const{data:le,error:Re}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",ue).order("id",{ascending:!1}).limit(1);!Re&&Array.isArray(le)&&le.length>0&&(oe=le[0])}catch(le){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",le)}}if(!oe&&Te)try{const{data:ue,error:le}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",Te).order("id",{ascending:!1}).limit(1);!le&&Array.isArray(ue)&&ue.length>0&&(oe=ue[0])}catch(ue){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",ue)}}catch(be){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",be)}await us({clienteName:re||"Cliente",rtn:fe||null,paymentPayload:Vl,caiData:oe,usuarioId:ve})}catch(oe){console.warn("Error insertando venta en flujo cliente normal:",oe)}const te=window.open("","_blank");if(te){te.document.open(),te.document.write(H),te.document.close();try{te.focus(),te.print()}catch(oe){console.warn("Error during print (cliente normal):",oe)}setTimeout(()=>{try{te.close()}catch{}},800)}await(async()=>{q==="factura"&&(Q(),await ds()),q==="cotizacion"&&(F({cliente:re||"Cliente",rtn:fe||null}),C(!0))})(),z(!1)},[dn,hn]=j.useState(null),[Dn,pi]=j.useState([]),[La,lr]=j.useState(!1),[hs,Ia]=j.useState(null);j.useEffect(()=>{fetch("/data-base/inventario.json").then(async H=>{if(!H.ok)return console.warn("inventario.json no disponible, status",H.status),null;const te=H.headers.get("content-type")||"";if(!te.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",te),null;try{return await H.json()}catch(ye){return console.warn("Error parseando inventario.json:",ye),null}}).then(H=>{H&&Array.isArray(H.items)&&pi(H.items),console.log("inventario cargado:",H&&H.items?H.items.length:0)}).catch(H=>{console.warn("Error cargando inventario:",H)})},[]),j.useEffect(()=>{let H=!0;return(async()=>{try{const{data:te,error:ye}=await Z.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(ye)throw ye;const oe=Array.isArray(te)?te:[],ve=oe.map(ue=>String(ue.id));if(ve.length===0){H&&s([]);return}const be={};try{const{data:ue,error:le}=await Z.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(le)throw le;if(console.debug("PV: precios total rows",Array.isArray(ue)?ue.length:0),Array.isArray(ue))for(const Re of ue){const Be=String(Re.producto_id);be[Be]||(be[Be]=Number(Re.precio||0))}}catch(ue){console.warn("Error cargando precios en PV:",ue)}let pe={};try{const{data:ue,error:le}=await Z.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",ve);if(le)throw le;const Re=Array.isArray(ue)?ue:[];pe={},ve.forEach(Be=>pe[Be]=0);for(const Be of Re){const Ie=String(Be.producto_id),Gt=Number(Be.cantidad)||0,lt=String(Be.tipo_de_movimiento||"").toUpperCase();lt==="ENTRADA"?pe[Ie]=(pe[Ie]||0)+Gt:lt==="SALIDA"&&(pe[Ie]=(pe[Ie]||0)-Gt)}}catch(ue){console.warn("Error cargando registro_de_inventario en PV:",ue),pe={},ve.forEach(le=>pe[le]=0)}console.debug("PV: priceMap sample",Object.keys(be).slice(0,5).map(ue=>[ue,be[ue]]));const Te=oe.map(ue=>({id:String(ue.id),sku:ue.sku,nombre:ue.nombre,categoria:ue.categoria,imagen:ue.imagen,precio:be[String(ue.id)]!==void 0?be[String(ue.id)]:ue.precio!==void 0?Number(ue.precio):0,exento:ue.exento===!0||String(ue.exento)==="true"||Number(ue.exento)===1||!1,aplica_impuesto_18:ue.aplica_impuesto_18===!0||String(ue.aplica_impuesto_18)==="true"||Number(ue.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:ue.aplica_impuesto_turistico===!0||String(ue.aplica_impuesto_turistico)==="true"||Number(ue.aplica_impuesto_turistico)===1||!1,stock:Number((pe[String(ue.id)]||0).toFixed(2))}));H&&s(Te)}catch(te){console.warn("Error cargando productos desde inventario:",te),H&&s([])}})(),()=>{H=!1}},[]),j.useEffect(()=>{const H=ye=>{try{const oe=ye||(()=>{const pe=localStorage.getItem("cotizacion_to_load");return pe?JSON.parse(pe):null})();if(!oe)return;try{_e(oe.header&&oe.header.id?String(oe.header.id):null)}catch{}const be=(Array.isArray(oe.detalles)?oe.detalles:[]).map(pe=>{const Te=a.find(le=>String(le.id)===String(pe.producto_id));return{producto:Te?{...Te}:{id:String(pe.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:pe.sku??void 0,nombre:pe.descripcion||pe.nombre||"Artculo",precio:Number(pe.precio_unitario||pe.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(pe.cantidad||1)}});be.length>0&&u(be);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};H();const te=ye=>{try{H(ye.detail)}catch{}};return window.addEventListener("cotizacion:load",te),()=>{window.removeEventListener("cotizacion:load",te)}},[a]);const[En,Kl]=j.useState(null),[fs,gs]=j.useState(null),[or,cr]=j.useState(null),[Ha,Bn]=j.useState(null),[ps,Cn]=j.useState(!1),[xt,Lt]=j.useState({}),oa=async()=>{try{let H=null;try{const te=localStorage.getItem("user"),ye=te?JSON.parse(te):null;let oe=or??(ye&&(ye.id||ye.user?.id||ye.sub||ye.user_id)?ye.id||ye.user?.id||ye.sub||ye.user_id:null);const ve=En??(ye&&(ye.username||ye.user?.username||ye.name||ye.user?.name)?ye.username||ye.user?.username||ye.name||ye.user?.name:null),be=oe!=null&&typeof oe=="string"&&/^\d+$/.test(oe)?Number(oe):oe;if(be!=null)try{const{data:pe,error:Te}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",be).order("id",{ascending:!1}).limit(1);!Te&&Array.isArray(pe)&&pe.length>0&&(H=pe[0])}catch(pe){console.debug("refreshCaiInfo: lookup by usuario_id failed:",pe)}if(!H&&ve)try{const{data:pe,error:Te}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",ve).order("id",{ascending:!1}).limit(1);!Te&&Array.isArray(pe)&&pe.length>0&&(H=pe[0])}catch(pe){console.debug("refreshCaiInfo: lookup by cajero failed:",pe)}}catch(te){console.debug("refreshCaiInfo: error building lookup params",te)}if(H){Bn(H);try{localStorage.setItem("caiInfo",JSON.stringify(H))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",H)}}catch(H){console.debug("refreshCaiInfo: unexpected error",H)}};j.useEffect(()=>{try{const H=localStorage.getItem("user");if(H){const te=JSON.parse(H);Kl(te.username||te.name||null),gs(te.role||null);let ye=null;try{ye=te&&(te.id||te.user?.id||te.sub||te.user_id)?te.id||te.user?.id||te.sub||te.user_id:null,cr(ye??null),console.debug("PV: localStorage.user parsed:",te),console.debug("PV: extracted userId for CAI/RPC usage:",ye)}catch(oe){console.debug("PV: error parsing localStorage.user for debug:",oe)}try{const oe=localStorage.getItem("caiInfo");if(oe){const ve=JSON.parse(oe);Bn(ve),console.debug("PV: loaded caiInfo from localStorage:",ve),(async()=>{try{if(!(ve&&ve.rango_de!==void 0&&ve.rango_hasta!==void 0&&ve.fecha_vencimiento!==void 0&&ve.secuencia_actual!==void 0)){const pe=te&&(te.username||te.user?.username||te.name||te.user?.name)?te.username||te.user?.username||te.name||te.user?.name:null,Te=ye&&typeof ye=="string"&&/^\d+$/.test(ye)?Number(ye):ye;let ue=null;try{if(Te!=null){const{data:le,error:Re}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Te).order("id",{ascending:!1}).limit(1);!Re&&Array.isArray(le)&&le.length>0&&(ue=le[0])}}catch(le){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",le)}if(!ue&&pe)try{const{data:le,error:Re}=await Z.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",pe).order("id",{ascending:!1}).limit(1);!Re&&Array.isArray(le)&&le.length>0&&(ue=le[0])}catch(le){console.debug("PV: refetch CAI by cajero failed:",le)}if(ue){Bn(ue);try{localStorage.setItem("caiInfo",JSON.stringify(ue))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",ue)}}}catch(be){console.debug("PV: error trying to refresh caiInfo:",be)}})()}}catch(oe){console.debug("PV: error parsing localStorage.caiInfo:",oe)}}}catch{}},[]),j.useEffect(()=>{let H=!0;return(async()=>{try{const{data:te,error:ye}=await Z.from("impuesto").select("id, impuesto_venta");if(ye)throw ye;if(!te||!Array.isArray(te))return;const oe=Te=>{const ue=te.find(Be=>Number(Be.id)===Te);if(!ue)return null;const le=ue.impuesto_venta;if(le==null)return null;const Re=Number(le);return Number.isNaN(Re)?null:Re>1?Re/100:Re},ve=oe(1),be=oe(2),pe=oe(3);if(H){let Te=ve,ue=be,le=pe;try{if((Te===null||Te===0)&&H){const Be=(await Z.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Ie=Be==null?null:Number(Be);Ie!=null&&!Number.isNaN(Ie)&&(Te=Ie>1?Ie/100:Ie)}if((ue===null||ue===0)&&H){const Be=(await Z.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Ie=Be==null?null:Number(Be);Ie!=null&&!Number.isNaN(Ie)&&(ue=Ie>1?Ie/100:Ie)}if((le===null||le===0)&&H){const Be=(await Z.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Ie=Be==null?null:Number(Be);Ie!=null&&!Number.isNaN(Ie)&&(le=Ie>1?Ie/100:Ie)}}catch(Re){console.warn("PV: fallback single-id impuesto fetch failed",Re)}(Te===null||Te===0)&&(Te=.15),(ue===null||ue===0)&&(ue=.18),(le===null||le===0)&&(le=.04),v(Te),S(ue),w(le),console.debug("PV: impuestos raw rows",te),console.debug("PV: resolved tax rates",{taxRate:Te,tax18Rate:ue,taxTouristRate:le})}}catch(te){console.warn("Error cargando impuesto en PV:",te)}})(),()=>{H=!1}},[]);const ur=H=>{console.log("openUbicacion",H,"entradasCount",Dn.length);let te=null;try{te=a.find(oe=>String(oe.sku||"")===String(H)||String(oe.id)===String(H))||null}catch{te=null}if(te){const oe=Number(te.stock??0),ve={id:te.id,producto:te.nombre||"",sku:te.sku||"",imagen:te.imagen||null,descripcion:te.descripcion||"",ubicacion:te.ubicacion||null,cantidad:oe};Ia(ve),lr(!0);return}const ye=Dn.find(oe=>oe.sku===H)||null;console.log("entrada encontrada",ye),Ia(ye),lr(!0)};if(j.useEffect(()=>{let H=!0;return(async()=>{try{const te="inventario",ye={};await Promise.all((a||[]).map(async oe=>{const ve=oe.imagen;if(!ve){ye[String(oe.id)]=null;return}const be=String(ve);if(be.startsWith("http")){ye[String(oe.id)]=be;return}let pe=be;const Te=String(be).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);Te&&(pe=decodeURIComponent(Te[2]));try{const ue=await Z.storage.from(te).getPublicUrl(pe),le=ue?.data?.publicUrl||ue?.data?.publicURL||null;if(le){ye[String(oe.id)]=le;return}}catch{}try{const le=(await Z.storage.from(te).createSignedUrl(pe,604800))?.data?.signedUrl??null;ye[String(oe.id)]=le}catch{ye[String(oe.id)]=null}})),H&&Lt(ye)}catch(te){console.warn("Error resolviendo imgenes en PV",te)}})(),()=>{H=!1}},[a]),dn){if(dn==="DevolucionCaja")return r.jsx(P0,{onBack:()=>hn(null)});if(dn==="IngresoEfectivo")return r.jsx(G0,{onBack:()=>hn(null)});if(dn==="CotizacionesGuardadas")return r.jsx(K0,{onBack:()=>hn(null)});if(dn==="PedidosEnLinea")return r.jsx(Y0,{onBack:()=>hn(null)});if(dn==="CorteCajaParcial")return r.jsx(J0,{onBack:()=>hn(null)});if(dn==="CorteCajaTotal")return r.jsx(Q0,{onBack:()=>hn(null)})}return r.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[r.jsx(e_,{userName:En,userRole:fs,userId:or,caiInfo:Ha,onLogout:o,onNavigate:H=>hn(H),onOpenDatosFactura:()=>Cn(!0)}),r.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[r.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:H=>f(H.target.value),onKeyDown:H=>{if(H.key==="Enter"){const te=String(d||"").trim().toLowerCase();if(!te)return;const oe=N.find(ve=>String(ve.sku||"").toLowerCase()===te)||N[0];if(oe){const ve=Number(oe.stock??0),be=Number(oe.precio??0);ve>=1&&be>0?D(oe):console.debug("No se puede agregar por stock/precio",{id:oe.id,stockNum:ve,precioNum:be})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),r.jsx("select",{value:g,onChange:H=>p(H.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:A.map(H=>r.jsx("option",{value:H,children:H},H))})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:r.jsx(Z0,{productos:N,imageUrls:xt,agregarAlCarrito:D,openUbicacion:ur,thStyle:c_,tdStyle:u_,skuStyle:d_})}),r.jsx(W0,{carrito:l,actualizarCantidad:V,eliminarDelCarrito:ge,vaciarCarrito:Q,subtotal:T,perItemTaxes:L,taxRate:m,tax18Rate:x,taxTouristRate:b,total:E,openSelector:cs,btnStyle:h_})]})]}),r.jsx(a_,{open:La,selectedEntrada:hs,onClose:()=>{lr(!1),Ia(null)},imageUrls:xt}),r.jsx(F0,{open:ht,totalDue:E,onClose:()=>Un(!1),onConfirm:async H=>{if(hi(H),Rt(!0),os)try{Ma(!1),await Gl("Consumidor Final","C/F",H)}catch(te){console.warn("Error facturando despus del pago:",te)}Un(!1)}}),r.jsx(i_,{open:ie,onClose:()=>C(!1),onCancel:()=>{C(!1),F(null)},onSave:async()=>{C(!1);try{const H=await Pl(U||{});H&&_e(String(H))}catch(H){console.warn("Error guardando cotizacion desde confirm modal",H)}F(null)}}),r.jsx(r_,{open:de,onClose:()=>me(!1),doFacturaClienteFinal:$t,doFacturaClienteNormal:zn,doFacturaClienteJuridico:Pt,carritoLength:l.length,subtotal:fi(),taxRate:m,taxableSubtotal:qa()}),r.jsx(s_,{open:O,onClose:()=>z(!1),clienteTipo:Pe,clienteRTN:fe,clienteNombre:re,clienteTelefono:De,clienteCorreo:gt,clienteExonerado:Tt,clienteSearchOpen:K,setClienteSearchOpen:H=>J(H),onRTNChange:H=>$l(H),onNombreChange:H=>ae(H),onTelefonoChange:H=>Xe(H),onCorreoChange:H=>qt(H),onExoneradoChange:H=>Yt(H),onCreateCliente:()=>st(!0),onCancel:()=>z(!1),onOpenCreateCliente:()=>st(!0),onOpenPayment:()=>Un(!0),paymentDone:Hl,submitClienteNormal:gi}),r.jsx(l_,{open:Vn,onClose:()=>st(!1),clienteRTN:fe,clienteNombre:re,clienteTelefono:De,clienteCorreo:gt,clienteExonerado:Tt,onChangeRTN:H=>he(H),onChangeNombre:H=>ae(H),onChangeTelefono:H=>Xe(H),onChangeCorreo:H=>qt(H),onChangeExonerado:H=>Yt(H),onCreate:async()=>{try{if(!re||!fe)return;const{data:H,error:te}=await Z.from("clientes").select("id").eq("rtn",fe).maybeSingle();if(te&&console.warn("Error buscando cliente al crear:",te),H&&H.id){const{error:ye}=await Z.from("clientes").update({nombre:re,telefono:De||null,correo_electronica:gt||null,tipo_cliente:"juridico",exonerado:Tt}).eq("id",H.id);ye&&console.warn("Error actualizando cliente al crear:",ye)}else{const{error:ye}=await Z.from("clientes").insert([{nombre:re,rtn:fe,telefono:De||null,correo_electronica:gt||null,tipo_cliente:"juridico",exonerado:Tt}]);ye&&console.warn("Error insertando cliente al crear:",ye)}}catch(H){console.warn("Error creando cliente juridico:",H)}st(!1)}}),r.jsx(n_,{open:ps,onClose:()=>Cn(!1),caiInfo:Ha,onRefresh:oa})]})}const c_={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},u_={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},d_={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},h_={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},sp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function f_({title:o,children:a}){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:o}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function g_(){const[o,a]=j.useState(null);return j.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Ventas (ltimos das)"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Flujo de caja"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Inventario por categora"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Promedios"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):r.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const p_="modulepreload",m_=function(o){return"/"+o},lp={},wn=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};var f=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=m_(v),v in lp)return;lp[v]=!0;const x=v.endsWith(".css"),S=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${S}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":p_,x||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),x)return new Promise((w,A)=>{b.addEventListener("load",w),b.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function am({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:f="Cancelar"}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),r.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:f}),r.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function y_(){const[o,a]=j.useState(null),[s,l]=j.useState(!1),[u,d]=j.useState(!1),[f,g]=j.useState({}),[p,m]=j.useState(null),[v,x]=j.useState(!1),[S,b]=j.useState(null),[w,A]=j.useState(!1),[N,T]=j.useState(null),[M,B]=j.useState(null),[G,E]=j.useState(!1),[L,D]=j.useState(""),[V,ge]=j.useState(""),[Q,de]=j.useState(null),[me,q]=j.useState(null);j.useEffect(()=>{let z=!0;return(async()=>{l(!0);try{const K=(await wn(async()=>{const{default:ae}=await Promise.resolve().then(()=>Sn);return{default:ae}},void 0)).default,{data:J,error:re}=await K.from("empresa").select("*").limit(1).single();if(!z)return;if(re)throw re;if(J){a(J),g(J);try{localStorage.setItem("companyData",JSON.stringify(J))}catch{}l(!1);return}}catch(K){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",K)}try{const K=localStorage.getItem("companyData");if(K){a(JSON.parse(K)),g(JSON.parse(K)),l(!1);return}}catch{}try{const K=await fetch("/data-base/company.json");if(!K.ok)throw new Error("no json");const J=await K.json();if(!z)return;a(J),g(J)}catch{z&&a(null)}finally{z&&l(!1)}})(),()=>{z=!1}},[]),j.useEffect(()=>{o&&g(o)},[o]),j.useEffect(()=>{try{const z=localStorage.getItem("pendingCompanySave");if(z){const K=JSON.parse(z);x(!0),b(K.payload??null),A(!!K.needsLogo)}}catch{}},[]),j.useEffect(()=>{let z=!0;return(async()=>{try{if(!o||!o.logo){z&&de(null);return}const K=String(o.logo);if(K.startsWith("http")){z&&de(K);return}const J=(await wn(async()=>{const{default:Ue}=await Promise.resolve().then(()=>Sn);return{default:Ue}},void 0)).default,re="logo",fe=(await J.storage.from(re).getPublicUrl(K))?.data?.publicUrl??null;if(fe){z&&de(fe);return}const xe=(await J.storage.from(re).createSignedUrl(K,3600))?.data?.signedUrl??null;if(xe){z&&de(xe);return}z&&de(null)}catch(K){console.warn("Error resolving company logo URL",K),z&&de(null)}})(),()=>{z=!1}},[o?.logo]),j.useEffect(()=>{let z=!0;return(async()=>{try{if(p){z&&q(p);return}const K=f?.logo;if(!K){z&&q(null);return}const J=String(K);if(J.startsWith("http")){z&&q(J);return}const re=(await wn(async()=>{const{default:Pe}=await Promise.resolve().then(()=>Sn);return{default:Pe}},void 0)).default,ae="logo",he=(await re.storage.from(ae).getPublicUrl(J))?.data?.publicUrl??null;if(he){z&&q(he);return}const Ue=(await re.storage.from(ae).createSignedUrl(J,3600))?.data?.signedUrl??null;if(Ue){z&&q(Ue);return}z&&q(null)}catch(K){console.warn("Error resolving edit logo URL",K),z&&q(null)}})(),()=>{z=!1}},[f?.logo,p]);function W(){d(!0),g(o||{})}function ie(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function C(z){const{name:K,value:J}=z.target;g(re=>({...re,[K]:J}))}function U(z){const K=z.target.files?.[0]??null;if(g(J=>({...J,logoFile:K})),K)try{const J=URL.createObjectURL(K);m(J)}catch{m(null)}else m(null)}function F(z=!1){const K="logo",J="https://sqwqlvsjtimallidxrsz.supabase.co";if(z){if(p)return p;const fe=f?.logo;if(!fe)return"/logo192.png";if(String(fe).startsWith("http"))return String(fe);let he=String(fe);return he.startsWith(`${K}/`)&&(he=he.slice(K.length+1)),`${J}/storage/v1/object/public/${K}/${encodeURIComponent(he)}`}if(!o)return"/logo192.png";const re=o.logo;if(!re)return"/logo192.png";if(String(re).startsWith("http"))return String(re);let ae=String(re);return ae.startsWith(`${K}/`)&&(ae=ae.slice(K.length+1)),`${J}/storage/v1/object/public/${K}/${encodeURIComponent(ae)}`}async function ce(){try{const z=(await wn(async()=>{const{default:he}=await Promise.resolve().then(()=>Sn);return{default:he}},void 0)).default,K={...f||{}};let J=null;const re=he=>{if(!he)return null;if(!he.startsWith("http"))return he;const xe=he.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return xe?decodeURIComponent(xe[2]):null},ae=o?.logo??null;try{const he=f&&f.logoFile instanceof File?f.logoFile:null,xe="logo";if(he){const Pe=`logo/${K.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${he.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,ze=await z.storage.from(xe).upload(Pe,he,{upsert:!0});if(ze.error)throw ze.error;const De=ze.data?.path??Pe;J=De,K.logo=De}}catch(he){console.warn("Logo upload error",he)}try{K.logoFile&&delete K.logoFile}catch{}let fe=null;try{if(o&&o.id){const{data:he,error:xe}=await z.from("empresa").update(K).eq("id",o.id).select("*");if(xe)throw xe;fe=Array.isArray(he)?he[0]??null:he}else{const{data:he,error:xe}=await z.from("empresa").insert(K).select("*");if(xe)throw xe;fe=Array.isArray(he)?he[0]??null:he}try{if(J){const he=re(ae);if(he&&he!==J){const Ue=await z.storage.from("logo").remove([he]);Ue.error&&console.warn("Failed to remove old company logo after DB update",Ue.error)}}}catch(he){console.warn("Error removing old logo after DB success",he)}}catch(he){try{if(J){const Ue=await z.storage.from("logo").remove([J]);Ue.error&&console.warn("Failed to remove uploaded logo after DB error",Ue.error)}}catch(xe){console.warn("Error cleaning uploaded logo after DB failure",xe)}throw he}a(fe),g(fe);try{console.debug("Empresa guardada, logo field:",fe?.logo)}catch{}try{B(fe?.logo??null)}catch{}try{D("Datos guardados"),ge("Los datos de la empresa se guardaron correctamente."),E(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(fe))}catch{}d(!1)}catch(z){console.error("Error guardando empresa en Supabase",z);try{T(z?.message||String(z))}catch{}try{const K={...f||{}};K.logoFile&&delete K.logoFile;const J=!!(f&&f.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:K,needsLogo:J,ts:Date.now()})),x(!0),b(K),A(J),a(f);try{localStorage.setItem("companyData",JSON.stringify(f))}catch{}d(!1),D("Guardado localmente"),ge("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),E(!0)}catch(K){console.error("Error saving locally",K)}}}async function _e(){const z=S;if(!z){D("Sin pendientes"),ge("No hay datos pendientes para enviar"),E(!0);return}try{const K=(await wn(async()=>{const{default:re}=await Promise.resolve().then(()=>Sn);return{default:re}},void 0)).default;let J=null;if(z.id){const{data:re,error:ae}=await K.from("empresa").update(z).eq("id",z.id).select("*");if(ae)throw ae;J=Array.isArray(re)?re[0]??null:re}else{const{data:re,error:ae}=await K.from("empresa").insert(z).select("*");if(ae)throw ae;J=Array.isArray(re)?re[0]??null:re}localStorage.removeItem("pendingCompanySave"),x(!1),b(null),A(!1),a(J),g(J),D("Sincronizado"),ge("Los datos pendientes se sincronizaron con Supabase correctamente."),E(!0)}catch(K){console.error("Error reenviando datos pendientes",K),D("Error al reenviar"),ge("No se pudo reenviar los datos a Supabase: "+(K?.message||String(K))),E(!0)}}function O(){try{localStorage.removeItem("pendingCompanySave"),x(!1),b(null),A(!1),D("Pendiente descartado"),ge("El guardado pendiente fue descartado."),E(!0)}catch{}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?r.jsx("div",{children:"Cargando datos de la empresa..."}):o?r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?r.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",N?r.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(N)]}):null,w?r.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn-primary",onClick:_e,children:"Reintentar guardar en Supabase"}),r.jsx("button",{className:"btn-opaque",onClick:O,children:"Descartar pendiente"})]})]})}):null,M?r.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[r.jsx("strong",{children:"Logo guardado:"}),r.jsxs("div",{style:{marginTop:6},children:[r.jsx("a",{href:F(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),r.jsx("div",{style:{color:"#374151",fontSize:12},children:String(M)})]})]}):null,r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:r.jsx("img",{src:u?me??F(!0):Q??F(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),r.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"RTN:"})," ",u?r.jsx("input",{name:"rtn",value:f.rtn||"",onChange:C,className:"input"}):o.rtn]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Telfono:"})," ",u?r.jsx("input",{name:"telefono",value:f.telefono||"",onChange:C,className:"input"}):o.telefono]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Correo:"})," ",u?r.jsx("input",{name:"email",value:f.email||"",onChange:C,className:"input"}):o.email]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Direccin:"})," ",u?r.jsx("textarea",{name:"direccion",value:f.direccion||"",onChange:C,className:"input",style:{minHeight:64}}):o.direccion]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Logo (archivo o URL):"}),u?r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[r.jsx("input",{type:"file",accept:"image/*",onChange:U}),r.jsx("input",{name:"logo",value:f.logo||"",onChange:C,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):r.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?r.jsxs("div",{style:{marginTop:8},children:[r.jsx("small",{children:"Preview:"}),r.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:ce,className:"btn-primary",children:"Guardar"}),r.jsx("button",{type:"button",onClick:ie,className:"btn-opaque",children:"Cancelar"})]}):r.jsx(r.Fragment,{children:r.jsx("button",{type:"button",onClick:W,className:"btn-primary",children:"Actualizar datos"})})})]}),r.jsx("div",{style:{flex:1,minWidth:320},children:r.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:r.jsx("img",{src:u?me??F(!0):Q??F(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),r.jsxs("p",{style:{margin:0},children:["RTN: ",r.jsx("strong",{children:o.rtn})]}),r.jsxs("p",{style:{margin:0},children:["Telfono: ",r.jsx("strong",{children:o.telefono})]}),r.jsxs("p",{style:{marginTop:8},children:["Correo: ",r.jsx("strong",{children:o.email})]}),r.jsxs("p",{style:{marginTop:8},children:["Direccin: ",r.jsx("strong",{children:o.direccion})]})]})})]}):r.jsx("div",{children:"No se encontraron datos de la empresa."}),r.jsx(am,{open:G,title:L,message:V,onClose:()=>E(!1)})]})}function v_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function b_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[f,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[S,b]=j.useState(""),[w,A]=j.useState(null),[N,T]=j.useState(""),[M,B]=j.useState(""),[G,E]=j.useState("");async function L(){l(!0),d(null);try{const{data:q,error:W}=await Z.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(W)throw W;a(Array.isArray(q)?q:[])}catch(q){d(q?.message||String(q)),a([])}finally{l(!1)}}async function D(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const q={username:p,password:v,role:"cajero"};S&&(q.nombre_usuario=S);const{error:W}=await Z.from("users").insert(q);if(W)throw W;m(""),x(""),b(""),await L()}catch(q){d(q?.message||String(q))}finally{l(!1)}}function V(q){A(q.id),T(q.username||""),E(q.nombre_usuario||""),B(""),d(null)}function ge(){A(null),T(""),B(""),E(""),d(null)}async function Q(){if(w!=null){if(!N)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const q={username:N};M&&(q.password=M),q.nombre_usuario=G||null;const{error:W}=await Z.from("users").update(q).eq("id",w);if(W)throw W;ge(),await L()}catch(q){d(q?.message||String(q))}finally{l(!1)}}}async function de(q,W){if(W!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:ie}=await Z.from("users").delete().eq("id",q);if(ie)throw ie;await L()}catch(ie){d(ie?.message||String(ie))}finally{l(!1)}}}j.useEffect(()=>{let q=!0;return(async()=>q&&await L())(),()=>{q=!1}},[]);const me=o.filter(q=>{if(!f)return!0;const W=f.toLowerCase();return(q.username||"").toLowerCase().includes(W)||(String(q.id)||"").includes(W)||(q.role||"").toLowerCase().includes(W)||(q.nombre_usuario||"").toLowerCase().includes(W)});return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[r.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:f,onChange:q=>g(q.target.value),style:{minWidth:220}}),r.jsx("button",{onClick:()=>L(),className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${me.length} usuarios`}),r.jsx("div",{style:{width:"100%",height:8}}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:q=>m(q.target.value)}),r.jsx("input",{placeholder:"Nombre",className:"input",value:S,onChange:q=>b(q.target.value)}),r.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:q=>x(q.target.value)}),r.jsx("button",{onClick:()=>D(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?r.jsx("div",{style:{color:"red",marginBottom:12},children:u}):r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"})]})}),r.jsx("tbody",{children:me.map(q=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:q.id}),r.jsx("td",{style:{minWidth:180},children:w===q.id?r.jsx("input",{className:"input",value:N,onChange:W=>T(W.target.value)}):q.username||"-"}),r.jsx("td",{style:{minWidth:180},children:w===q.id?r.jsx("input",{className:"input",value:G,onChange:W=>E(W.target.value)}):q.nombre_usuario||"-"}),r.jsx("td",{style:{width:220},children:w===q.id?r.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:M,onChange:W=>B(W.target.value)}):q.role||"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:w===q.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>Q(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),r.jsx("button",{onClick:()=>ge(),className:"btn-opaque",children:"Cancelar"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>V(q),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),q.role==="cajero"?r.jsx("button",{onClick:()=>de(q.id,q.role),className:"btn-danger",children:"Eliminar"}):r.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},q.id))})]}),me.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function __({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:f}){const[g,p]=j.useState(null),[m,v]=j.useState(null),[x,S]=j.useState(!1),[b,w]=j.useState(null),[A,N]=j.useState(""),[T,M]=j.useState(""),[B,G]=j.useState(""),[E,L]=j.useState(""),[D,V]=j.useState(null),[ge,Q]=j.useState(""),[de,me]=j.useState(!1),[q,W]=j.useState(null);if(j.useEffect(()=>{if(!o||!s)return;w(s.caja??null),N(s.cai??""),Q(s.identificador??""),M(s.rango_de??""),G(s.rango_hasta??""),L(s.fecha_vencimiento??""),V(s.secuencia_actual??null);const C=s.cajero??null;if(C){const U=l.find(F=>F.username===C||F.nombre_usuario===C);U?(p(U.id),v(null),S(!1)):(p(null),v(C),S(!0))}else p(null),v(null),S(!1);W(null)},[o,s,l]),!o||!s)return null;async function ie(){if(!s){W("Registro invlido");return}if(b!=null&&(b<1||b>5)){W("La caja debe estar entre 1 y 5");return}me(!0),W(null);try{const C={cai:A??null,identificador:ge??null,rango_de:T??null,rango_hasta:B??null,fecha_vencimiento:E??null,secuencia_actual:D??null,caja:b??null};if(g!=null){const U=l.find(F=>F.id===g);C.cajero=U?U.username:null,C.usuario_id=U?U.id:null}else C.cajero=m??null,C.usuario_id=null;await f(s.id,C),a()}catch(C){W(C?.message||String(C))}finally{me(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:A,onChange:C=>N(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),r.jsx("input",{className:"input",value:ge,onChange:C=>Q(C.target.value),placeholder:"Identificador (opcional)"}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:T,onChange:C=>M(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:B,onChange:C=>G(C.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:E,onChange:C=>L(C.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),r.jsx("input",{className:"input",value:D??"",onChange:C=>V(C.target.value===""?null:C.target.value),placeholder:"0"}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):x?"__custom__":"",onChange:C=>{const U=C.target.value;U===""?(p(null),v(null),S(!1)):U==="__custom__"?(p(null),S(!0)):/^\d+$/.test(U)&&(p(Number(U)),v(null),S(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(C=>r.jsxs("option",{value:String(C.id),children:[C.username,C.nombre_usuario?`  ${C.nombre_usuario}`:""]},C.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),x&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:C=>{v(C.target.value),p(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:C=>w(C.target.value===""?null:Number(C.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(C=>r.jsx("option",{value:C,children:C},C))]})]})]})]})]}),q&&r.jsx("div",{style:{color:"red",marginTop:12},children:q}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:de,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ie,disabled:de,style:{width:"auto",padding:"8px 14px"},children:de?"Guardando...":"Guardar"})]})]})})}function x_({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[f,g]=j.useState(null),[p,m]=j.useState(null),[v,x]=j.useState(!1),[S,b]=j.useState(null),[w,A]=j.useState(""),[N,T]=j.useState(""),[M,B]=j.useState(""),[G,E]=j.useState(""),[L,D]=j.useState(null),[V,ge]=j.useState(""),[Q,de]=j.useState(!1),[me,q]=j.useState(null);if(!o)return null;async function W(){const ie=[];if(w||ie.push("CAI"),N||ie.push("Rango Desde"),M||ie.push("Rango Hasta"),G||ie.push("Fecha de Vencimiento"),S==null&&ie.push("Caja"),f==null&&!p&&ie.push("Cajero"),ie.length>0){q(`Campos obligatorios faltantes: ${ie.join(", ")}`);return}if(S!=null&&(S<1||S>5)){q("La caja debe estar entre 1 y 5");return}de(!0),q(null);try{const C={cai:w??null,identificador:V??null,rango_de:N??null,rango_hasta:M??null,fecha_vencimiento:G??null,secuencia_actual:L??null,caja:S??null};if(f!=null){const U=s.find(F=>F.id===f);C.cajero=U?U.username:null,C.usuario_id=U?U.id:null}else C.cajero=p??null,C.usuario_id=null;await d(C),a()}catch(C){q(C?.message||String(C))}finally{de(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:w,onChange:ie=>A(ie.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),r.jsx("input",{className:"input",value:V,onChange:ie=>ge(ie.target.value),placeholder:"Identificador (opcional)"}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:N,onChange:ie=>T(ie.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:M,onChange:ie=>B(ie.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:G,onChange:ie=>E(ie.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),r.jsx("input",{className:"input",value:L??"",onChange:ie=>D(ie.target.value===""?null:ie.target.value),placeholder:"0"}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:f!=null?String(f):v?"__custom__":"",onChange:ie=>{const C=ie.target.value;C===""?(g(null),m(null),x(!1)):C==="__custom__"?(g(null),x(!0)):/^\d+$/.test(C)&&(g(Number(C)),m(null),x(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(ie=>r.jsxs("option",{value:String(ie.id),children:[ie.username,ie.nombre_usuario?`  ${ie.nombre_usuario}`:""]},ie.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:ie=>{m(ie.target.value),g(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:S??"",onChange:ie=>b(ie.target.value===""?null:Number(ie.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(ie=>r.jsx("option",{value:ie,children:ie},ie))]})]})]})]})]}),me&&r.jsx("div",{style:{color:"red",marginTop:12},children:me}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:Q,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:W,disabled:Q,style:{width:"auto",padding:"8px 14px"},children:Q?"Creando...":"Crear"})]})]})})}function j_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[f,g]=j.useState([]),[p,m]=j.useState(null),[v,x]=j.useState(!1),[S,b]=j.useState(!1);async function w(){l(!0),d(null);try{const{data:E,error:L}=await Z.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(E)?E:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}async function A(){try{const{data:E}=await Z.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(E)?E:[])}catch{}}j.useEffect(()=>{w(),A()},[]);const N=new Set(o.filter(E=>E.cajero).map(E=>String(E.cajero))),T=new Set(o.filter(E=>E.caja!=null).map(E=>Number(E.caja)));function M(E){m(E),x(!0),d(null)}function B(){x(!1),m(null)}async function G(E,L){l(!0),d(null);try{const{error:D}=await Z.from("cai").update(L).eq("id",E);if(D)throw D;await w()}catch(D){throw d(D?.message||String(D)),D}finally{l(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"CAI"}),r.jsx("th",{children:"Identificador"}),r.jsx("th",{children:"Rango Desde"}),r.jsx("th",{children:"Rango Hasta"}),r.jsx("th",{children:"Vencimiento"}),r.jsx("th",{children:"Secuencia actual"}),r.jsx("th",{children:"Cajero"}),r.jsx("th",{children:"Usuario ID"}),r.jsx("th",{children:"Caja"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:200},children:E.cai}),r.jsx("td",{style:{minWidth:160},children:E.identificador??"-"}),r.jsx("td",{children:E.rango_de}),r.jsx("td",{children:E.rango_hasta}),r.jsx("td",{children:E.fecha_vencimiento}),r.jsx("td",{children:E.secuencia_actual??"-"}),r.jsx("td",{style:{minWidth:180},children:E.cajero||"-"}),r.jsx("td",{style:{minWidth:160},children:E.usuario_id??"-"}),r.jsx("td",{style:{width:120},children:E.caja??"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>M(E),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},E.id))})]}),o.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),r.jsx(__,{open:v,onClose:B,row:p,cajeros:f,availableCajeros:p?f.filter(E=>!N.has(E.username)||E.username===p.cajero):f.filter(E=>!N.has(E.username)),availableCajas:p?[1,2,3,4,5].filter(E=>!T.has(E)||E===p.caja):[1,2,3,4,5].filter(E=>!T.has(E)),onSave:G}),r.jsx(x_,{open:S,onClose:()=>b(!1),cajeros:f,availableCajeros:f.filter(E=>!N.has(E.username)),availableCajas:[1,2,3,4,5].filter(E=>!T.has(E)),onCreate:async E=>{l(!0),d(null);try{const{error:L}=await Z.from("cai").insert(E);if(L)throw L;await w(),b(!1)}catch(L){throw d(L?.message||String(L)),L}finally{l(!1)}}})]})}function S_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function w_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),r.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Mu=cp();function E_({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,f]=Tu.useState(!1);if(!o)return null;const g=async()=>{try{f(!0),await u()}finally{f(!1)}};return Mu.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("p",{children:s}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),r.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function C_({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[f,g]=j.useState({}),[p,m]=j.useState(!1),[v,x]=j.useState(null);if(j.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?x(l.imagen):x(null)},[l,o]),!o)return null;const S=(N,T)=>{g(M=>({...M,[N]:T}))},b=async N=>{N.preventDefault();try{m(!0),await d(f)}finally{m(!1)}},w=N=>N==="creado_en"?null:N==="id"?r.jsx("input",{className:"input",value:f[N]??"",readOnly:!0}):N.includes("publicacion")||N.includes("exento")||N.includes("aplica_impuesto")||N==="publicacion_web"?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("label",{className:"switch",children:[r.jsx("input",{type:"checkbox",checked:!!f[N],onChange:T=>S(N,T.target.checked)}),r.jsx("span",{className:"slider"})]}),r.jsx("span",{style:{fontSize:13},children:f[N]?"S":"No"})]}):N.includes("categoria")||N.includes("marca")?r.jsx("input",{type:"text",className:"input",value:f[N]??"",onChange:T=>S(N,T.target.value===""?null:T.target.value)}):N==="imagen"?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?r.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,r.jsx("input",{type:"file",accept:"image/*",onChange:T=>{const M=T.target.files&&T.target.files[0];if(S(N,M??null),M)try{const B=URL.createObjectURL(M);x(B)}catch{x(null)}else x(null)}}),v?r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{S(N,null),x(null)},children:"Eliminar imagen"}):null]}):r.jsx("input",{className:"input",value:f[N]??"",onChange:T=>S(N,T.target.value)}),A=r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsxs("form",{onSubmit:b,children:[r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(N=>r.jsxs("label",{style:{display:"block"},children:[r.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(N).replace(/_/g," ").toUpperCase()}),w(N)]},N))}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Mu.createPortal(A,typeof document<"u"&&document.body||document.createElement("div"))}function T_({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const f=a||{},[g,p]=j.useState(null),[m,v]=j.useState(null),[x,S]=j.useState(null),[b,w]=j.useState(null);return j.useEffect(()=>{let A=!0;return(async()=>{const T=typeof f.imagen=="string"?f.imagen:null;if(!T){A&&p(null);return}if(T.startsWith("http")){A&&(p(T),S(T));return}let M=T;const B=String(T).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);B&&(M=decodeURIComponent(B[2]));const G="inventario";try{const E=(await wn(async()=>{const{default:Q}=await Promise.resolve().then(()=>Sn);return{default:Q}},void 0)).default,L=await E.storage.from(G).getPublicUrl(M),D=L?.data?.publicUrl||L?.data?.publicURL||null;if(D){A&&(p(D),S(D));return}const V=await E.storage.from(G).createSignedUrl(M,3600*24*7);if(V.error){console.warn("ProductDetailModal createSignedUrl error",V.error),A&&p(null);return}const ge=V.data?.signedUrl??null;A&&(p(ge),S(ge))}catch(E){console.error("ProductDetailModal resolve error",E),A&&p(null)}})(),()=>{A=!1}},[f]),j.useEffect(()=>{let A=!0;return(async()=>{if(w(null),!!x)try{const T=await fetch(x,{method:"HEAD"});if(!A)return;w(`HEAD ${T.status} ${T.statusText} - content-type: ${T.headers.get("content-type")}`)}catch(T){if(!A)return;w(`FETCH_ERROR: ${String(T)}`)}})(),()=>{A=!1}},[x]),Mu.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:s}),r.jsxs("div",{style:{display:"flex",gap:18},children:[r.jsx("div",{style:{flex:1},children:r.jsx("table",{style:{width:"100%"},children:r.jsx("tbody",{children:Object.keys(f).map(A=>{const N=f[A];return A==="imagen"&&typeof N=="string"?null:r.jsxs("tr",{children:[r.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(A).replace(/_/g," ").toUpperCase()}),r.jsx("td",{style:{padding:6},children:String(N??"-")})]},A)})})})}),r.jsx("div",{style:{width:280,textAlign:"center"},children:g?r.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:A=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?r.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),r.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):r.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(f),children:"Editar"}),r.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(f.id),children:"Eliminar"}),r.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function A_({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:f,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:x=[]}){const[S,b]=j.useState(null),[w,A]=j.useState(!1),[N,T]=j.useState(null),[M,B]=j.useState(""),[G,E]=j.useState(!1),[L,D]=j.useState("add"),[V,ge]=j.useState({}),[Q,de]=j.useState(!1),[me,q]=j.useState(null),[W,ie]=j.useState(!1),[C,U]=j.useState(null),F=j.useRef(!0),ce=async()=>{A(!0),T(null);try{const ae=(await wn(async()=>{const{default:Ue}=await Promise.resolve().then(()=>Sn);return{default:Ue}},void 0)).default,fe=a||"*";let he=ae.from(o).select(fe).limit(l);f&&(Array.isArray(f)?f:String(f).split(",").map(Pe=>Pe.trim()).filter(Boolean)).forEach(Pe=>{const ze=Pe.split(" ").map(gt=>gt.trim()).filter(Boolean),De=ze[0],Xe=ze[1]?ze[1].toLowerCase():"asc";he=he.order(De,{ascending:Xe!=="desc"})}),g&&Object.entries(g).forEach(([Ue,Pe])=>{Pe==null||Pe===""||(he=he.eq(Ue,Pe))});const xe=await he;if(console.debug("SupabaseTable fetch result for",o,xe),!F.current)return;if(xe.error)throw xe.error;b(Array.isArray(xe.data)?xe.data:[])}catch(ae){console.error("SupabaseTable error",ae),T(ae?.message||String(ae)),b([])}finally{F.current&&A(!1)}};j.useEffect(()=>(F.current=!0,ce(),()=>{F.current=!1}),[o,a,l]);const _e=j.useMemo(()=>u&&u.length>0?u:!S||S.length===0?[]:Object.keys(S[0]),[u,S]),O=j.useMemo(()=>{if(!S)return null;const ae=(M||"").toString().trim().toLowerCase();if(!ae)return S;const fe=d&&d.length>0?d:_e;return S.filter(he=>fe.some(xe=>{const Ue=he?.[xe];return Ue==null?!1:String(Ue).toLowerCase().includes(ae)}))},[S,M,d,_e]),z=()=>{p&&(D("add"),ge({}),E(!0))},K=ae=>{m&&(D("edit"),ge(ae),E(!0))},J=async ae=>{const fe=(await wn(async()=>{const{default:he}=await Promise.resolve().then(()=>Sn);return{default:he}},void 0)).default;try{const he="inventario",xe={...ae},Ue=L==="edit"?V?.imagen??null:null,Pe=ze=>{if(!ze)return null;if(!ze.startsWith("http"))return ze;const De=ze.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return De?decodeURIComponent(De[2]):null};if(xe.imagen&&xe.imagen instanceof File){const ze=xe.imagen,De=xe.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Xe=`${o}/${De}/${Date.now()}_${ze.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,gt=await fe.storage.from(he).upload(Xe,ze,{upsert:!0});if(gt.error)throw gt.error;const qt=gt.data?.path??Xe;xe.imagen=qt;try{const Tt=Pe(Ue);if(Tt&&Tt!==qt){const Yt=await fe.storage.from(he).remove([Tt]);Yt.error&&console.warn("Failed to remove old image",Yt.error)}}catch(Tt){console.warn("Error removing old image",Tt)}}if(L==="edit"&&(xe.imagen==null||xe.imagen===""))try{const ze=Pe(V?.imagen??null);if(ze){const De=await fe.storage.from(he).remove([ze]);De.error&&console.warn("Failed to remove old image on clear",De.error)}}catch(ze){console.warn("Error removing old image on clear",ze)}if(L==="add"){const{error:ze}=await fe.from(o).insert([xe]);if(ze)throw ze}else{const ze=xe.id,De={...xe};delete De.id;const{error:Xe}=await fe.from(o).update(De).eq("id",ze);if(Xe)throw Xe}E(!1),await ce()}catch(he){console.error("Error saving",he),T(he?.message||String(he))}},re=async()=>{if(me==null)return;const ae=(await wn(async()=>{const{default:fe}=await Promise.resolve().then(()=>Sn);return{default:fe}},void 0)).default;try{if(!v)return;try{const he="inventario",xe=S?.find(De=>De.id===me),Ue=De=>{if(!De)return null;if(!De.startsWith("http"))return De;const Xe=De.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Xe?decodeURIComponent(Xe[2]):null},Pe=xe?.imagen??null,ze=Ue(Pe);if(ze){const De=await ae.storage.from(he).remove([ze]);De.error&&console.warn("Failed to remove image on delete",De.error)}}catch(he){console.warn("Error removing image before delete",he)}const{error:fe}=await ae.from(o).delete().eq("id",me);if(fe)throw fe;de(!1),q(null),await ce()}catch(fe){console.error("Error deleting",fe),T(fe?.message||String(fe))}};return r.jsxs("div",{style:{padding:18},children:[s?r.jsx("h2",{style:{marginTop:0},children:s}):null,r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("input",{placeholder:"Buscar...",value:M,onChange:ae=>B(ae.target.value),className:"input",style:{minWidth:240}}),r.jsx("button",{onClick:()=>{T(null),B(""),ce()},className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto"},children:r.jsx("button",{onClick:z,className:"btn-primary",children:"Agregar"})})]}),w&&r.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),N&&r.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",N]}),!w&&S&&S.length===0&&r.jsxs("div",{children:["No hay registros en la tabla ",r.jsx("strong",{children:o}),"."]}),!w&&O&&O.length>0&&r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[_e.map(ae=>r.jsx("th",{children:String(ae).replace(/_/g," ").toUpperCase()},ae)),r.jsx("th",{style:{width:140},children:"Acciones"})]})}),r.jsx("tbody",{children:O.map((ae,fe)=>r.jsxs("tr",{children:[_e.map(he=>{if(he==="imagen"){const xe=ae?.imagen??null;return xe||console.debug("SupabaseTable: row has no imagen for id",ae?.id,ae),r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:xe?r.jsx(im,{src:String(xe)}):r.jsx("span",{style:{color:"#6b7280"},children:"-"})},he)}return r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:O_(ae[he])},he)}),r.jsx("td",{className:"admin-actions",children:r.jsx("button",{className:"btn-opaque",onClick:()=>{U(ae),ie(!0)},children:"Ver"})})]},ae.id??fe))})]})}),r.jsx(C_,{open:G,title:L==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:_e.filter(ae=>!x.includes(ae)),initialData:V,onClose:()=>E(!1),onSave:J}),r.jsx(T_,{open:W,data:C,title:`Detalle de ${o}`,onClose:()=>ie(!1),onEdit:ae=>{ie(!1),K(ae)},onDeleteClick:ae=>{ie(!1),q(ae),de(!0)}}),r.jsx(E_,{open:Q,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>de(!1),onConfirm:re})]})}function O_(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return r.jsx(im,{src:o})}return String(o)}function im({src:o}){const[a,s]=j.useState(null),[l,u]=j.useState(null);return j.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await wn(async()=>{const{default:A}=await Promise.resolve().then(()=>Sn);return{default:A}},void 0)).default,v="inventario",x=await m.storage.from(v).getPublicUrl(g),S=x?.data?.publicUrl||x?.data?.publicURL||null;if(S){d&&s(S);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const w=b.data?.signedUrl??null;d&&s(w)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?r.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:r.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function N_(){const[o,a]=j.useState(null),[s,l]=j.useState(""),[u,d]=j.useState(""),[f,g]=j.useState([]),[p,m]=j.useState([]);return j.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await wn(async()=>{const{default:D}=await Promise.resolve().then(()=>Sn);return{default:D}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],A=new Set(w.map(D=>D.categoria??"").filter(Boolean)),N=new Set(w.map(D=>D.marca??"").filter(Boolean)),T=w.length,M=w.filter(D=>!!D.publicacion_web).length,B=D=>{if(D==null)return!1;if(typeof D=="boolean")return D===!0;if(typeof D=="number")return D===1;const V=String(D).toLowerCase().trim();return V==="1"||V==="true"||V==="t"||V==="si"||V==="s"||V==="yes"},G=w.filter(D=>B(D.exento)).length,E=w.filter(D=>B(D.aplica_impuesto_18)).length,L=w.filter(D=>B(D.aplica_impuesto_turistico)).length;a({categorias:A.size,marcas:N.size,items:T,publicadas:M,exentos:G,aplica_impuesto_18:E,aplica_impuesto_turistico:L}),g(Array.from(A).sort()),m(Array.from(N).sort())}catch(S){console.error("Error loading inventario summary",S)}})(),()=>{v=!1}},[]),r.jsxs("div",{children:[r.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[r.jsx(si,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),r.jsx(si,{label:"Marcas",value:o?String(o.marcas):"..."}),r.jsx(si,{label:"Items",value:o?String(o.items):"..."}),r.jsx(si,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),r.jsx(si,{label:"Exentos",value:o?String(o.exentos):"..."}),r.jsx(si,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),r.jsx(si,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),r.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),f.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),r.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),p.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),r.jsx(A_,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function si({label:o,value:a}){return r.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),r.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function R_({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,f]=j.useState(null),[g,p]=j.useState(""),[m,v]=j.useState(!1),[x,S]=j.useState(null),[b,w]=j.useState(null),[A,N]=j.useState(null),[T,M]=j.useState(null),[B,G]=j.useState(null),[E,L]=j.useState(null),[D,V]=j.useState(null),[ge,Q]=j.useState(null),[de,me]=j.useState(null),[q,W]=j.useState(!1);j.useEffect(()=>{o&&(f(null),p(""),w(null),N(null),M(null),Q(null),me(null),S(null))},[o]);async function ie(){const U=[];if(d||U.push("Producto"),g||U.push("Precio"),U.length>0){S(`Faltan campos: ${U.join(", ")}`);return}const F=Number(g);if(isNaN(F)||F<0){S("Precio invlido");return}v(!0),S(null);try{await u({producto_id:d,precio:g});try{const ce={};if(B!==null&&(ce.exento=B),E!==null&&(ce.aplica_impuesto_18=E),D!==null&&(ce.aplica_impuesto_turistico=D),Object.keys(ce).length>0){const{error:_e}=await Z.from("inventario").update(ce).eq("id",d);_e&&console.warn("Error actualizando inventario flags:",_e)}}catch(ce){console.warn("Error al persistir flags en inventario:",ce)}a()}catch(ce){S(ce?.message||String(ce))}finally{v(!1)}}function C(U){return U?Number(U.replace(",",".")):NaN}return j.useEffect(()=>{let U=!0;async function F(){if(w(null),N(null),M(null),Q(null),me(null),!d)return;const ce=C(g);if(!isNaN(ce)){W(!0);try{const{data:_e,error:O}=await Z.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(O)throw O;const z=Array.isArray(_e)?_e.map(st=>Number(st.costo_unitario)).filter(st=>!isNaN(st)):[],K=z.length>0?z.reduce((st,ht)=>st+ht,0)/z.length:0;if(!U)return;w(K);let J=!1,re=!1,ae=!1;try{const{data:st,error:ht}=await Z.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!ht&&st&&(J=!!st.exento,re=!!st.aplica_impuesto_18,ae=!!st.aplica_impuesto_turistico,B===null&&G(J),E===null&&L(re),D===null&&V(ae))}catch{}const{data:fe}=await Z.from("impuesto").select("id, impuesto_venta"),he={};Array.isArray(fe)&&fe.forEach(st=>{he[String(st.id)]=Number(st.impuesto_venta)});const xe=B!==null?B:J,Ue=E!==null?E:re,Pe=D!==null?D:ae;let ze=0;xe?ze=0:Ue?ze=he[2]??he[1]??0:ze=he[1]??0;let De=0;Pe&&(De=he[3]??0);const Xe=(ze||0)+(De||0),gt=Xe>1?Xe/100:Xe,qt=ce*gt;N(Xe),M(qt);const Tt=ce-K,Yt=K>0?Tt/K*100:null;Q(Yt);const Vn=ce>0?(ce-K-qt)/ce*100:null;me(Vn)}catch{}finally{U&&W(!1)}}}return F(),()=>{U=!1}},[d,g,B,E,D]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:d??"",onChange:U=>f(U.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(U=>r.jsx("option",{value:U.id,children:U.nombre},U.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!B,onChange:U=>G(U.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!E,onChange:U=>L(U.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!D,onChange:U=>V(U.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:g,onChange:U=>p(U.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:T==null?"":T.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:ge==null?"":ge.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:de==null?"":de.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&r.jsx("div",{style:{color:"red",marginTop:12},children:x}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ie,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function k_({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[f,g]=j.useState(null),[p,m]=j.useState(""),[v,x]=j.useState(!1),[S,b]=j.useState(null),[w,A]=j.useState(null),[N,T]=j.useState(null),[M,B]=j.useState(null),[G,E]=j.useState(null),[L,D]=j.useState(null),[V,ge]=j.useState(null),[Q,de]=j.useState(null),[me,q]=j.useState(null),[W,ie]=j.useState(!1);j.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const F=Number(s.precio);m(isNaN(F)?String(s.precio):F.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function C(F){return F?Number(F.replace(",",".")):NaN}if(j.useEffect(()=>{let F=!0;async function ce(){if(A(null),T(null),B(null),de(null),q(null),!o||!s||!f)return;const _e=C(p);if(!isNaN(_e)){ie(!0);try{const{data:O,error:z}=await Z.from("compras_detalle").select("costo_unitario").eq("producto_id",f);if(z)throw z;const K=Array.isArray(O)?O.map(ht=>Number(ht.costo_unitario)).filter(ht=>!isNaN(ht)):[],J=K.length>0?K.reduce((ht,Un)=>ht+Un,0)/K.length:0;if(!F)return;A(J);let re=!1,ae=!1,fe=!1;try{const{data:ht,error:Un}=await Z.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",f).single();!Un&&ht&&(re=!!ht.exento,ae=!!ht.aplica_impuesto_18,fe=!!ht.aplica_impuesto_turistico,G===null&&E(re),L===null&&D(ae),V===null&&ge(fe))}catch{}const{data:he}=await Z.from("impuesto").select("id, impuesto_venta"),xe={};Array.isArray(he)&&he.forEach(ht=>xe[String(ht.id)]=Number(ht.impuesto_venta));const Ue=G!==null?G:re,Pe=L!==null?L:ae,ze=V!==null?V:fe;let De=0;Ue?De=0:Pe?De=xe[2]??xe[1]??0:De=xe[1]??0;let Xe=0;ze&&(Xe=xe[3]??0);const gt=(De||0)+(Xe||0),qt=gt>1?gt/100:gt,Tt=_e*qt;T(gt),B(Tt);const Yt=_e-J,Vn=J>0?Yt/J*100:null;de(Vn);const st=_e>0?(_e-J-Tt)/_e*100:null;q(st)}catch{}finally{F&&ie(!1)}}}return ce(),()=>{F=!1}},[o,s,f,p,G,L,V]),!o||!s)return null;async function U(){const F=[];if(f||F.push("Producto"),p||F.push("Precio"),F.length>0){b(`Faltan campos: ${F.join(", ")}`);return}const ce=Number(p);if(isNaN(ce)||ce<0){b("Precio invlido");return}x(!0),b(null);try{const _e=s.id;await d(_e,{producto_id:f,precio:p});try{const O={};if(G!==null&&(O.exento=G),L!==null&&(O.aplica_impuesto_18=L),V!==null&&(O.aplica_impuesto_turistico=V),Object.keys(O).length>0&&f){const{error:z}=await Z.from("inventario").update(O).eq("id",f);z&&console.warn("Error actualizando inventario flags:",z)}}catch(O){console.warn("Error al persistir flags en inventario:",O)}a()}catch(_e){b(_e?.message||String(_e))}finally{x(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:f??"",onChange:F=>g(F.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(F=>r.jsx("option",{value:F.id,children:F.nombre},F.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!G,onChange:F=>E(F.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!L,onChange:F=>D(F.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!V,onChange:F=>ge(F.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:p,onChange:F=>m(F.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:M==null?"":M.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:Q==null?"":Q.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:me==null?"":me.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),S&&r.jsx("div",{style:{color:"red",marginTop:12},children:S}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:U,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function U_(){const[o,a]=j.useState([]),[s,l]=j.useState([]),[u,d]=j.useState(!1),[f,g]=j.useState(null),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[S,b]=j.useState(null);async function w(){d(!0),g(null);try{const{data:E,error:L}=await Z.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(E)?E:[])}catch(E){g(E?.message||String(E)),a([])}finally{d(!1)}}async function A(){try{const{data:E}=await Z.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(E)?E:[])}catch{}}j.useEffect(()=>{w(),A()},[]);const N=new Set(o.map(E=>String(E.producto_id))),T=s.filter(E=>!N.has(E.id));function M(E){b(E),x(!0),g(null)}async function B(E){d(!0),g(null);try{const{error:L}=await Z.from("precios").insert(E);if(L)throw L;try{const D={producto_id:E.producto_id,precio:E.precio},{error:V}=await Z.from("precios_historico").insert(D);V&&console.warn("No se pudo insertar en precios_historico",V)}catch(D){console.warn("Error registrando precios_historico",D)}await w()}catch(L){throw g(L?.message||String(L)),L}finally{d(!1)}}async function G(E,L){d(!0),g(null);try{const{error:D}=await Z.from("precios").update(L).eq("id",E);if(D)throw D;let V=L.producto_id,ge=L.precio;if(!V||ge===void 0)try{const{data:Q}=await Z.from("precios").select("producto_id, precio").eq("id",E).limit(1).single();Q&&(V=V||Q.producto_id,ge=ge===void 0?Q.precio:ge)}catch{}try{if(V&&ge!==void 0){const Q={producto_id:V,precio:ge},{error:de}=await Z.from("precios_historico").insert(Q);de&&console.warn("No se pudo insertar en precios_historico",de)}}catch(Q){console.warn("Error registrando precios_historico",Q)}await w()}catch(D){throw g(D?.message||String(D)),D}finally{d(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{w(),A()},children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),f&&r.jsx("div",{style:{color:"red",marginBottom:12},children:f}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:220},children:s.find(L=>L.id===E.producto_id)?.nombre||E.producto_id}),r.jsx("td",{children:E.precio}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>M(E),children:"Editar"})})]},E.id))})]})}),r.jsx(R_,{open:p,onClose:()=>m(!1),products:T,onCreate:async E=>{await B(E),m(!1)}}),r.jsx(k_,{open:v,onClose:()=>{x(!1),b(null)},row:S,products:s,availableProducts:[...s.filter(E=>!N.has(E.id)),...S?s.filter(E=>E.id===S.producto_id):[]],onSave:async(E,L)=>{await G(E,L),x(!1),b(null)}})]})}function z_(){const[o,a]=j.useState(""),[s,l]=j.useState([]),[u,d]=j.useState(null),[f,g]=j.useState([]),[p,m]=j.useState(!1),[v,x]=j.useState(null);async function S(){if(x(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:A}=await Z.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(A)throw A;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const N=w[0].id;d(N),await b(N)}}catch(w){x(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),x(null);try{const{data:A,error:N}=await Z.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(N)throw N;g(Array.isArray(A)?A:[])}catch(A){x(A?.message||String(A)),g([])}finally{m(!1)}}return j.useEffect(()=>{u&&b(u)},[u]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>S(),children:"Buscar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${f.length} registros`})]}),v&&r.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),r.jsx("ul",{children:s.map(w=>r.jsxs("li",{style:{marginBottom:6},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),r.jsx("strong",{children:w.nombre})," ",r.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Actualizacion"})]})}),r.jsx("tbody",{children:f.map(w=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(w.id)}),r.jsx("td",{style:{minWidth:220},children:s.find(A=>A.id===w.producto_id)?.nombre||w.producto_id}),r.jsx("td",{children:Number(w.precio).toFixed(2)}),r.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function D_(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[f,g]=j.useState([]),[p,m]=j.useState({}),[v,x]=j.useState({}),[S,b]=j.useState(!1),[w,A]=j.useState(null);async function N(){b(!0),A(null);try{let T=Z.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(T=T.ilike("sku",`%${o}%`)),s&&(T=T.ilike("marca",`%${s}%`)),u&&(T=T.ilike("modelo",`%${u}%`));const{data:M,error:B}=await T.order("nombre",{ascending:!0});if(B)throw B;const G=Array.isArray(M)?M:[];g(G);const E=G.map(Q=>Q.id);if(E.length===0){m({});return}const{data:L,error:D}=await Z.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",E);if(D)throw D;const V=Array.isArray(L)?L:[],ge={};for(const Q of G)ge[String(Q.id)]=0;for(const Q of V){const de=String(Q.producto_id),me=Number(Q.cantidad)||0,q=String(Q.tipo_de_movimiento||"").toUpperCase();ge.hasOwnProperty(de)||(ge[de]=0),q==="ENTRADA"?ge[de]=(ge[de]||0)+me:q==="SALIDA"&&(ge[de]=(ge[de]||0)-me)}for(const Q of Object.keys(ge))ge[Q]=Number((ge[Q]||0).toFixed(2));m(ge);try{const Q=(await wn(async()=>{const{default:q}=await Promise.resolve().then(()=>Sn);return{default:q}},void 0)).default,de="inventario",me={};await Promise.all(G.map(async q=>{const W=q.imagen;if(!W){me[String(q.id)]=null;return}const ie=String(W);if(ie.startsWith("http")){me[String(q.id)]=ie;return}let C=ie;const U=String(ie).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);U&&(C=decodeURIComponent(U[2]));try{const F=await Q.storage.from(de).getPublicUrl(C),ce=F?.data?.publicUrl||F?.data?.publicURL||null;if(ce){me[String(q.id)]=ce;return}}catch{}try{const ce=(await Q.storage.from(de).createSignedUrl(C,604800))?.data?.signedUrl??null;me[String(q.id)]=ce}catch{me[String(q.id)]=null}})),x(me)}catch{}}catch(T){A(T?.message||String(T)),g([]),m({})}finally{b(!1)}}return j.useEffect(()=>{N()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Stock"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:T=>a(T.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:T=>l(T.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:T=>d(T.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>N(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),N()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:S?"Cargando...":`${f.length} productos`})]}),w&&r.jsx("div",{style:{color:"red",marginBottom:12},children:w}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Imagen"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Marca"}),r.jsx("th",{children:"Modelo"}),r.jsx("th",{children:"Descripcin"}),r.jsx("th",{children:"Stock"})]})}),r.jsx("tbody",{children:f.map(T=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:v[String(T.id)]?r.jsx("img",{src:encodeURI(v[String(T.id)]),alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:M=>{M.currentTarget.src=""}}):T.imagen?r.jsx("img",{src:T.imagen,alt:T.nombre,style:{width:48,height:48,objectFit:"cover"},onError:M=>{M.currentTarget.src=""}}):""}),r.jsx("td",{children:T.sku||""}),r.jsx("td",{children:T.marca||""}),r.jsx("td",{children:T.modelo||""}),r.jsx("td",{style:{maxWidth:320},children:T.descripcion||""}),r.jsx("td",{style:{textAlign:"right"},children:p[String(T.id)]!=null?String(p[String(T.id)]):"0"})]},T.id))})]})]})]})}function B_(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[f,g]=j.useState([]),[p,m]=j.useState([]),[v,x]=j.useState(!1),[S,b]=j.useState([]),[w,A]=j.useState({}),[N,T]=j.useState(!1),[M,B]=j.useState(null);async function G(){T(!0),B(null),b([]);try{let V=null;if(o||s||u){let W=Z.from("inventario").select("id").order("nombre",{ascending:!0});o&&(W=W.ilike("sku",`%${o}%`)),s&&(W=W.ilike("marca",`%${s}%`)),u&&(W=W.ilike("categoria",`%${u}%`));const{data:ie,error:C}=await W;if(C)throw C;if(V=Array.isArray(ie)?ie.map(U=>String(U.id)):[],V.length===0){b([]),A({}),T(!1);return}}let ge=Z.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(V&&(ge=ge.in("producto_id",V)),v){const W=new Date(Date.now()-864e5).toISOString();ge=ge.gte("fecha_salida",W)}ge=ge.order("fecha_salida",{ascending:!1});const{data:Q,error:de}=await ge;if(de)throw de;const me=Array.isArray(Q)?Q.map(W=>({id:W.id,producto_id:String(W.producto_id),cantidad:Number(W.cantidad),tipo_de_movimiento:W.tipo_de_movimiento,referencia:W.referencia,usuario:W.usuario,fecha_salida:W.fecha_salida})):[];b(me);const q=Array.from(new Set(me.map(W=>W.producto_id))).filter(Boolean);if(q.length>0){const{data:W}=await Z.from("inventario").select("id, nombre, sku, marca, categoria").in("id",q),ie={};Array.isArray(W)&&W.forEach(C=>{ie[String(C.id)]={id:C.id,nombre:C.nombre,sku:C.sku,marca:C.marca,categoria:C.categoria}}),A(ie)}else A({})}catch(V){B(V?.message||String(V)),b([])}finally{T(!1)}}async function E(){try{const{data:V,error:ge}=await Z.from("inventario").select("marca, categoria");if(ge)throw ge;const Q=new Set,de=new Set;Array.isArray(V)&&V.forEach(me=>{me.marca&&Q.add(String(me.marca)),me.categoria&&de.add(String(me.categoria))}),g(Array.from(Q).sort()),m(Array.from(de).sort())}catch(V){console.warn("Error loading filter options",V)}}j.useEffect(()=>{G(),E()},[]);const L=S.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="ENTRADA"),D=S.filter(V=>String(V.tipo_de_movimiento).toUpperCase()==="SALIDA");return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:V=>a(V.target.value)}),r.jsxs("select",{className:"input",value:s,onChange:V=>l(V.target.value),children:[r.jsx("option",{value:"",children:"-- Marca (todas) --"}),f.map(V=>r.jsx("option",{value:V,children:V},V))]}),r.jsxs("select",{className:"input",value:u,onChange:V=>d(V.target.value),children:[r.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(V=>r.jsx("option",{value:V,children:V},V))]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:v,onChange:V=>x(V.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),x(!1),G()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:N?"Cargando...":`${S.length} registros`})]}),M&&r.jsx("div",{style:{color:"red",marginBottom:12},children:M}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Entradas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:L.map(V=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(V.id)}),r.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),r.jsx("td",{children:w[V.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),r.jsx("td",{children:V.referencia||""}),r.jsx("td",{children:V.usuario||""}),r.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]}),r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Salidas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:D.map(V=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(V.id)}),r.jsx("td",{style:{minWidth:120},children:w[V.producto_id]?.sku||V.producto_id}),r.jsx("td",{children:w[V.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(V.cantidad).toFixed(2)}),r.jsx("td",{children:V.referencia||""}),r.jsx("td",{children:V.usuario||""}),r.jsx("td",{children:V.fecha_salida||""})]},String(V.id)))})]})]})]})]})}function M_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),r.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function q_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),r.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function L_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function I_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function H_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function V_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function $_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function P_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),r.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function G_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),r.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function K_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),r.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function Y_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),r.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function J_({open:o,onClose:a,onCreate:s}){const[l,u]=j.useState(""),[d,f]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,S]=j.useState(""),[b,w]=j.useState(""),[A,N]=j.useState(!0),[T,M]=j.useState(!1),[B,G]=j.useState(null);if(!o)return null;async function E(){const L=[];if(l.trim()||L.push("Nombre"),L.length){G(`Faltan campos: ${L.join(", ")}`);return}M(!0),G(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:b||void 0,activo:A}),u(""),f(""),p(""),v(""),S(""),w(""),N(!0),a()}catch(D){G(D?.message||String(D))}finally{M(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:l,onChange:L=>u(L.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:d,onChange:L=>f(L.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:g,onChange:L=>p(L.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:m,onChange:L=>v(L.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:x,onChange:L=>S(L.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:b,onChange:L=>w(L.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:A,onChange:L=>N(L.target.checked)})," ","Activo"]})]}),B&&r.jsx("div",{style:{color:"red",marginTop:12},children:B}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:T,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:E,disabled:T,style:{width:"auto",padding:"8px 14px"},children:T?"Creando...":"Crear"})]})]})})}function Q_({open:o,onClose:a,row:s,onSave:l}){const[u,d]=j.useState(""),[f,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[S,b]=j.useState(""),[w,A]=j.useState(""),[N,T]=j.useState(!0),[M,B]=j.useState(!1),[G,E]=j.useState(null);if(j.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),x(s.correo||""),b(s.direccion||""),A(s.tipo_proveedor||""),T(s.activo??!0),E(null))},[o,s]),!o||!s)return null;async function L(){if(!s){E("No hay fila seleccionada");return}const D=[];if(u.trim()||D.push("Nombre"),D.length){E(`Faltan campos: ${D.join(", ")}`);return}B(!0),E(null);try{await l(s.id,{nombre:u.trim(),rtn:f.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:S.trim()||void 0,tipo_proveedor:w||void 0,activo:N}),a()}catch(V){E(V?.message||String(V))}finally{B(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:u,onChange:D=>d(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:f,onChange:D=>g(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:p,onChange:D=>m(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:v,onChange:D=>x(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:S,onChange:D=>b(D.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:w,onChange:D=>A(D.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:N,onChange:D=>T(D.target.checked)})," ","Activo"]})]}),G&&r.jsx("div",{style:{color:"red",marginTop:12},children:G}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:M,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:L,disabled:M,style:{width:"auto",padding:"8px 14px"},children:M?"Guardando...":"Guardar"})]})]})})}function X_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[f,g]=j.useState(""),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[S,b]=j.useState(null),[w,A]=j.useState(!1),[N,T]=j.useState(null);async function M(L){l(!0),d(null);try{let D=null,V=null;if(L&&L.trim()){const Q=`%${L.trim()}%`,de=await Z.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${Q},rtn.ilike.${Q}`).order("id",{ascending:!0});D=de.data,V=de.error}else{const ge=await Z.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});D=ge.data,V=ge.error}if(V)throw V;a(Array.isArray(D)?D:[])}catch(D){d(D?.message||String(D)),a([])}finally{l(!1)}}j.useEffect(()=>{M()},[]),j.useEffect(()=>{const L=setTimeout(()=>{M(f)},350);return()=>clearTimeout(L)},[f]);async function B(L){l(!0),d(null);try{const D={...L};if(delete D.id,D.rtn){const{data:ge,error:Q}=await Z.from("proveedores").select("id, nombre").eq("rtn",D.rtn).limit(1);if(Q)throw Q;if(Array.isArray(ge)&&ge.length>0)throw new Error(`Ya existe un proveedor con RTN ${D.rtn}`)}const{error:V}=await Z.from("proveedores").insert(D);if(V)throw V;await M()}catch(D){throw String(D).includes("Ya existe un proveedor")?d(String(D)):D?.code==="23505"||String(D).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(D?.message||String(D)),D}finally{l(!1)}}async function G(L,D){l(!0),d(null);try{const{error:V}=await Z.from("proveedores").update(D).eq("id",L);if(V)throw V;await M()}catch(V){throw d(V?.message||String(V)),V}finally{l(!1)}}async function E(){if(N){l(!0),d(null);try{const{error:L}=await Z.from("proveedores").delete().eq("id",N.id);if(L)throw L;A(!1),T(null),await M()}catch(L){d(L?.message||String(L))}finally{l(!1)}}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>M(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),r.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:f,onChange:L=>g(L.target.value),style:{width:260}}),r.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),M()},children:"Limpiar"})]}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"RTN"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Telfono"}),r.jsx("th",{children:"Correo"}),r.jsx("th",{children:"Direccin"}),r.jsx("th",{children:"Tipo"}),r.jsx("th",{children:"Activo"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(L=>r.jsxs("tr",{children:[r.jsx("td",{children:L.rtn||""}),r.jsx("td",{style:{minWidth:180},children:L.nombre}),r.jsx("td",{children:L.telefono||""}),r.jsx("td",{children:L.correo||""}),r.jsx("td",{children:L.direccion||""}),r.jsx("td",{children:L.tipo_proveedor||""}),r.jsx("td",{children:L.activo?"S":"No"}),r.jsxs("td",{style:{whiteSpace:"nowrap"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{b(L),x(!0)},children:"Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>{T(L),A(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},L.id))})]})}),r.jsx(J_,{open:p,onClose:()=>m(!1),onCreate:async L=>{await B(L),m(!1)}}),r.jsx(Q_,{open:v,onClose:()=>{x(!1),b(null)},row:S,onSave:async(L,D)=>{await G(L,D),x(!1),b(null)}}),r.jsx(am,{open:w,title:N?`Eliminar proveedor ${N.nombre}`:"Eliminar proveedor",message:N?`Confirma eliminar al proveedor ${N.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await E()},onCancel:()=>{A(!1),T(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function F_({open:o,onClose:a,onCreated:s}){const[l,u]=j.useState([]),[d,f]=j.useState([]),[g,p]=j.useState(0),[m,v]=j.useState(null),[x,S]=j.useState(""),[b,w]=j.useState("factura"),[A,N]=j.useState([]),[T,M]=j.useState(null),[B,G]=j.useState(1),[E,L]=j.useState(null),[D,V]=j.useState(!1),[ge,Q]=j.useState(null);if(j.useEffect(()=>{o&&(async()=>{try{const U=await Z.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await Z.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});f(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await Z.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),F=Array.isArray(U.data)&&U.data.length>0?U.data[0]:null,ce=F?Number(F.impuesto_venta):0;p(ce)}catch{}})()},[o]),!o)return null;function de(){v(null),S(""),w("factura"),N([]),M(null),G(1),L(null),Q(null)}function me(){if(!T){Q("Selecciona un producto");return}if(!E||E<=0){Q("Costo unitario invlido");return}if(!B||B<=0){Q("Cantidad invlida");return}const U=l.find(ce=>ce.id===T),F=ce=>{if(ce==null)return!1;if(typeof ce=="boolean")return ce===!0;if(typeof ce=="number")return ce===1;const _e=String(ce).toLowerCase().trim();return _e==="1"||_e==="true"||_e==="t"||_e==="si"||_e==="s"||_e==="yes"};N(ce=>[...ce,{producto_id:T,nombre:U?.nombre||"",cantidad:B,costo_unitario:E,exento:F(U?.exento)}]),M(null),G(1),L(null),Q(null)}function q(U){N(F=>F.filter((ce,_e)=>_e!==U))}function W(){const U=g,F=U>1?U/100:U;let ce=0,_e=0,O=0;for(const z of A){const K=z.cantidad*z.costo_unitario;let J=0,re=K;z.exento||(J=K*F,re=K-J),ce+=re,_e+=J,O+=K}return{subtotal:ce,impuesto:_e,total:O}}async function ie(){if(Q(null),!m){Q("Selecciona un proveedor");return}if(A.length===0){Q("Agrega al menos un producto");return}V(!0);try{const{subtotal:U,impuesto:F,total:ce}=W(),_e={proveedor_id:m,numero_documento:x||null,tipo_documento:b||null,subtotal:U,impuesto:F,total:ce,usuario:null},O=await Z.from("compras").insert(_e).select("id").single();if(O.error)throw O.error;const z=O.data.id,K=A.map(re=>({compra_id:z,producto_id:re.producto_id,cantidad:re.cantidad,costo_unitario:re.costo_unitario})),J=await Z.from("compras_detalle").insert(K);if(J.error)throw await Z.from("compras").delete().eq("id",z),J.error;try{const re=x?`Compra - ${x}`:`Compra ${z}`;let ae="sistema";try{const Ue=localStorage.getItem("user");if(Ue){const Pe=JSON.parse(Ue);ae=Pe.username?`${Pe.username}${Pe.role?` (${Pe.role})`:""}`:String(Pe)}}catch{}const fe=new Date().toISOString(),he=A.map(Ue=>({producto_id:Ue.producto_id,cantidad:Ue.cantidad,tipo_de_movimiento:"ENTRADA",referencia:re,usuario:ae,fecha_salida:fe})),xe=await Z.from("registro_de_inventario").insert(he);xe.error&&(console.warn("Error registrando en registro_de_inventario",xe.error),Q("Compra guardada, pero fall el registro en inventario: "+xe.error.message))}catch(re){console.warn("Registro inventario fallo",re)}de(),a(),s&&s()}catch(U){Q(U?.message||String(U))}finally{V(!1)}}const C=W();return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),r.jsxs("select",{className:"input",value:m??"",onChange:U=>v(U.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(U=>r.jsx("option",{value:U.id,children:U.nombre},String(U.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),r.jsx("input",{className:"input",value:x,onChange:U=>S(U.target.value)}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),r.jsx("input",{className:"input",value:b,onChange:U=>w(U.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:T??"",onChange:U=>M(U.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(U=>r.jsx("option",{value:U.id,children:U.nombre},U.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:U=>G(Number(U.target.value))}),r.jsx("input",{className:"input",type:"number",style:{width:120},value:E??"",onChange:U=>L(Number(U.target.value)),placeholder:"Costo unitario"}),r.jsx("button",{className:"btn-primary",onClick:me,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:A.map((U,F)=>{const ce=U.cantidad*U.costo_unitario,_e=g>1?g/100:g,O=U.exento?0:ce*_e,z=U.exento?ce:ce-O;return r.jsxs("tr",{children:[r.jsx("td",{children:U.nombre}),r.jsx("td",{children:U.cantidad}),r.jsx("td",{children:U.costo_unitario.toFixed(2)}),r.jsx("td",{children:O.toFixed(2)}),r.jsx("td",{children:z.toFixed(2)}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>q(F),children:"Quitar"})})]},`${U.producto_id}-${F}`)})})]})})]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:["Subtotal: ",r.jsx("strong",{children:C.subtotal.toFixed(2)})]}),r.jsxs("div",{children:["Impuesto: ",r.jsx("strong",{children:C.impuesto.toFixed(2)})]}),r.jsxs("div",{children:["Total: ",r.jsx("strong",{children:C.total.toFixed(2)})]})]})}),ge&&r.jsx("div",{style:{color:"red",marginTop:12},children:ge}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{de(),a()},disabled:D,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:ie,disabled:D,children:D?"Guardando...":"Confirmar compra"})]})]})})}function Z_({open:o,compraId:a,onClose:s}){const[l,u]=j.useState([]),[d,f]=j.useState({}),[g,p]=j.useState({}),[m,v]=j.useState(0),[x,S]=j.useState(!1);return j.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{S(!0);try{const{data:w,error:A}=await Z.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(A)throw A;const N=Array.isArray(w)?w:[];if(!b)return;u(N);const T=Array.from(new Set(N.map(M=>M.producto_id))).filter(Boolean);if(T.length>0){const{data:M}=await Z.from("inventario").select("id, nombre, exento").in("id",T),B={},G={};Array.isArray(M)&&M.forEach(E=>{B[String(E.id)]={id:E.id,nombre:E.nombre},G[String(E.id)]=E.exento===!0||E.exento===1||String(E.exento).toLowerCase()==="true"}),b&&(f(B),p(G))}else f({});try{const{data:M}=await Z.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),B=Array.isArray(M)&&M.length>0?M[0]:null,G=B?Number(B.impuesto_venta):0;b&&v(G)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&S(!1)}})(),()=>{b=!1}},[o,a]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),r.jsx("div",{style:{marginTop:8},children:x?r.jsx("div",{children:"Cargando..."}):r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),A=Number(b.costo_unitario),N=w*A,T=m>1?m/100:m,M=g[String(b.producto_id)]===!0,B=M?0:N*T,G=M?N:N-B;return r.jsxs("tr",{children:[r.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),r.jsx("td",{children:w.toFixed(2)}),r.jsx("td",{children:A.toFixed(2)}),r.jsx("td",{children:B.toFixed(2)}),r.jsx("td",{children:G.toFixed(2)}),r.jsx("td",{children:N.toFixed(2)})]},String(b.id))})}),r.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,A)=>{const N=Number(A.cantidad),T=Number(A.costo_unitario),M=N*T,B=m>1?m/100:m,G=g[String(A.producto_id)]===!0,E=G?0:M*B,L=G?M:M-E;return w.subtotal+=L,w.impuesto+=E,w.total+=M,w},{subtotal:0,impuesto:0,total:0});return r.jsxs("tr",{children:[r.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),r.jsx("td",{children:b.impuesto.toFixed(2)}),r.jsx("td",{children:b.subtotal.toFixed(2)}),r.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function W_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[f,g]=j.useState(!1),[p,m]=j.useState(!1),[v,x]=j.useState(null),[S,b]=j.useState([]),[w,A]=j.useState(""),[N,T]=j.useState(""),[M,B]=j.useState(!1);async function G(){l(!0),d(null);try{let E=Z.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const V=Number(w);isNaN(V)?E=E.eq("proveedor_id",w):E=E.eq("proveedor_id",V)}if(N&&(E=E.ilike("numero_documento",`%${N}%`)),M){const V=new Date(Date.now()-864e5).toISOString();E=E.gte("fecha_compra",V)}const{data:L,error:D}=await E.order("id",{ascending:!1});if(D)throw D;a(Array.isArray(L)?L:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}return j.useEffect(()=>{G()},[]),j.useEffect(()=>{let E=!0;return(async()=>{try{const{data:L}=await Z.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!E)return;b(Array.isArray(L)?L:[])}catch{}})(),()=>{E=!1}},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:w,onChange:E=>A(E.target.value),children:[r.jsx("option",{value:"",children:"-- proveedor (todos) --"}),S.map(E=>r.jsx("option",{value:String(E.id),children:E.nombre},String(E.id)))]}),r.jsx("input",{className:"input",placeholder:"Nmero documento",value:N,onChange:E=>T(E.target.value)}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:M,onChange:E=>B(E.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{A(""),T(""),B(!1),G()},children:"Limpiar"})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),r.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(E.id)}),r.jsx("td",{children:String(E.proveedor_id)}),r.jsx("td",{children:E.numero_documento||""}),r.jsx("td",{children:E.fecha_compra||""}),r.jsx("td",{children:E.subtotal||""}),r.jsx("td",{children:E.impuesto||""}),r.jsx("td",{children:E.total||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{x(E.id),m(!0)},children:"Detalle"})})]},String(E.id)))})]})}),r.jsx(F_,{open:f,onClose:()=>g(!1),onCreated:()=>{g(!1),G()}}),r.jsx(Z_,{open:p,compraId:v,onClose:()=>{m(!1),x(null)}})]})}function ex(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[f,g]=j.useState(!1),[p,m]=j.useState(null);async function v(){l(!0),d(null);try{const{data:x,error:S}=await Z.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(S)throw S;a(Array.isArray(x)?x.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(x){d(x?.message||String(x)),a([])}finally{l(!1)}}return j.useEffect(()=>{v()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),r.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(x=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(x.id)}),r.jsx("td",{children:String(x.proveedor_id||"")}),r.jsx("td",{children:x.numero_documento||""}),r.jsx("td",{children:x.usuario||""}),r.jsx("td",{children:x.fecha||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>m(x.id),children:"Detalle"})})]},String(x.id)))})]})}),f&&r.jsx(tx,{onClose:()=>{g(!1),v()}}),p&&r.jsx(nx,{id:p,onClose:()=>{m(null),v()}})]})}function tx({onClose:o}){const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,f]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(null),[x,S]=j.useState(null),[b,w]=j.useState(""),[A,N]=j.useState([]),[T,M]=j.useState(null),[B,G]=j.useState(1),[E,L]=j.useState(!1),[D,V]=j.useState(null);j.useEffect(()=>{(async()=>{try{const q=await Z.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(q.data)?q.data:[])}catch{}try{const q=await Z.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(q.data)?q.data:[])}catch{}})()},[]);async function ge(){if(b){V(null);try{const{data:q,error:W}=await Z.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(W)throw W;if(!q){V("No se encontr compra con ese nmero de documento");return}f(q.id),v(q.proveedor_id);try{const{data:J}=await Z.from("proveedores").select("id, nombre").eq("id",q.proveedor_id).limit(1).single();J&&J.nombre&&S(J.nombre)}catch{}const{data:ie}=await Z.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",q.id),C=Array.isArray(ie)?ie:[],{data:U}=await Z.from("devoluciones_proveedores").select("id").eq("numero_documento",b),F=Array.isArray(U)?U.map(J=>J.id):[];let ce={};if(F.length>0){const{data:J}=await Z.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",F);Array.isArray(J)&&J.forEach(re=>{const ae=String(re.producto_id);ce[ae]=(ce[ae]||0)+Number(re.cantidad)})}const _e=C.map(J=>J.producto_id),{data:O}=await Z.from("inventario").select("id, nombre, sku").in("id",_e),z={};Array.isArray(O)&&O.forEach(J=>{z[String(J.id)]=J});const K=C.map(J=>{const re=String(J.producto_id),ae=Number(J.cantidad),fe=ce[re]||0,he=Math.max(0,ae-fe);return{producto_id:re,nombre:z[re]?.nombre||re,sku:z[re]?.sku,purchased:ae,returned:fe,available:he,costo_unitario:Number(J.costo_unitario||0)}});p(K),u(K.map(J=>({id:J.producto_id,nombre:J.nombre,sku:J.sku})))}catch(q){V(q?.message||String(q))}}}function Q(){if(!T){V("Selecciona un producto");return}if(!B||B<=0){V("Cantidad invlida");return}const q=l.find(ie=>ie.id===T),W=g.find(ie=>ie.producto_id===T);if(W&&B>W.available){V(`Cantidad excede disponible para devolucin (${W.available})`);return}N(ie=>[...ie,{producto_id:T,nombre:q?.nombre,cantidad:B}]),M(null),G(1),V(null),W&&(p(ie=>ie.map(C=>C.producto_id===W.producto_id?{...C,available:Math.max(0,C.available-B)}:C)),u(ie=>ie.map(C=>(C.id===W.producto_id,C))))}function de(q){N(W=>W.filter((ie,C)=>C!==q))}async function me(){if(V(null),!m){V("Selecciona un proveedor");return}if(A.length===0){V("Agrega al menos un producto");return}L(!0);try{const q={proveedor_id:m,numero_documento:b||null,usuario:null},W=await Z.from("devoluciones_proveedores").insert(q).select("id").single();if(W.error)throw W.error;const ie=W.data.id;try{const C=A.map(F=>({devolucion_id:ie,producto_id:F.producto_id,cantidad:F.cantidad})),U=await Z.from("devoluciones_proveedores_detalle").insert(C);U.error&&console.warn("No se pudo insertar detalles de devolucin",U.error)}catch(C){console.warn("Detalles tabla puede no existir",C)}try{const C=b?`Devolucin - ${b}`:`Devolucin ${ie}`;let U="sistema";try{const O=localStorage.getItem("user");if(O){const z=JSON.parse(O);U=z.username?`${z.username}${z.role?` (${z.role})`:""}`:String(z)}}catch{}const F=new Date().toISOString(),ce=A.map(O=>({producto_id:O.producto_id,cantidad:O.cantidad,tipo_de_movimiento:"SALIDA",referencia:C,usuario:U,fecha_salida:F})),_e=await Z.from("registro_de_inventario").insert(ce);_e.error&&(console.warn("Error registrando en registro_de_inventario",_e.error),V("Devolucin guardada, pero fall el registro en inventario: "+_e.error.message))}catch(C){console.warn("Registro inventario fallo",C)}o()}catch(q){V(q?.message||String(q))}finally{L(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?r.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:x||String(m||"")}):r.jsxs("select",{className:"input",value:m??"",onChange:q=>v(q.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(q=>r.jsx("option",{value:q.id,children:q.nombre},String(q.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{className:"input",value:b,onChange:q=>w(q.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>ge(),children:"Buscar compra"})]}),d&&r.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&r.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[r.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[r.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Comprado"}),r.jsx("th",{children:"Devuelto"}),r.jsx("th",{children:"Disponible"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:g.map(q=>r.jsxs("tr",{children:[r.jsx("td",{children:q.nombre}),r.jsx("td",{style:{textAlign:"right"},children:Number(q.purchased).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(q.returned).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(q.available).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>{M(q.producto_id),G(q.available||1)},children:"Usar"})})]},q.producto_id))})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:T??"",onChange:q=>M(q.target.value||null),disabled:!!d,children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(q=>r.jsx("option",{value:q.id,children:q.nombre},q.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:q=>{const W=Number(q.target.value),ie=g.find(C=>C.producto_id===T);if(ie){const C=Number(ie.available||0);return isNaN(W)||W<1?G(1):W>C?G(C):G(W)}G(W)},min:1,max:T?g.find(q=>q.producto_id===T)?.available??void 0:void 0,disabled:(()=>{const q=g.find(W=>W.producto_id===T);return!!q&&Number(q.available||0)<=1})()}),r.jsx("button",{className:"btn-primary",onClick:Q,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:A.map((q,W)=>r.jsxs("tr",{children:[r.jsx("td",{children:q.nombre}),r.jsx("td",{style:{textAlign:"right"},children:q.cantidad}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>de(W),children:"Quitar"})})]},`${q.producto_id}-${W}`))})]})})]})]}),D&&r.jsx("div",{style:{color:"red",marginTop:12},children:D}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:o,disabled:E,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:me,disabled:E,children:E?"Guardando...":"Registrar devolucin"})]})]})})}function nx({id:o,onClose:a}){const[s,l]=j.useState([]),[u,d]=j.useState(!1),[f,g]=j.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await Z.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const x=Array.isArray(m)?m:[];if(x.length>0){const S=x.map(A=>A.producto_id),{data:b}=await Z.from("inventario").select("id, nombre, sku").in("id",S),w={};Array.isArray(b)&&b.forEach(A=>{w[String(A.id)]=A}),l(x.map(A=>({producto:w[String(A.producto_id)]?.nombre||String(A.producto_id),cantidad:A.cantidad})))}else{const{data:S}=await Z.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(S)?S:[],w=b.map(T=>T.producto_id),{data:A}=await Z.from("inventario").select("id, nombre, sku").in("id",w),N={};Array.isArray(A)&&A.forEach(T=>{N[String(T.id)]=T}),l(b.map(T=>({producto:N[String(T.producto_id)]?.nombre||String(T.producto_id),cantidad:T.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return j.useEffect(()=>{p()},[o]),r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&r.jsx("div",{children:"Cargando..."}),f&&r.jsx("div",{style:{color:"red"},children:f}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"})]})}),r.jsx("tbody",{children:s.map((m,v)=>r.jsxs("tr",{children:[r.jsx("td",{children:m.producto}),r.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const ax={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function ix(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[f,g]=j.useState(null),[p,m]=j.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await Z.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};j.useEffect(()=>{v()},[]);const x=(b,w)=>{a(A=>A.map(N=>N.id===b?{...N,impuesto_venta:w}:N))},S=async b=>{const w=o.find(A=>A.id===b);if(w){d(b),m(null);try{const A={impuesto_venta:w.impuesto_venta??null},{error:N}=await Z.from("impuesto").update(A).eq("id",b);if(N)throw N;await v()}catch(A){console.warn("Error guardando impuesto:",A),m(String(A.message||A))}finally{d(null)}}};return r.jsxs("div",{children:[r.jsx("h2",{children:"Impuestos"}),r.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?r.jsx("div",{children:"Cargando..."}):r.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>r.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8},children:ax[b.id]??`Impuesto #${b.id}`}),r.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),r.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>x(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:f!==b.id}),r.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:f===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[r.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),r.jsx("div",{style:{display:"flex",gap:8},children:f===b.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:()=>S(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):r.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&r.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&r.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const rx={dashboard:g_,datos:y_,usuarios_internal:b_,usuarios_web:v_,cai:j_,facturas:S_,historial_facturas:w_,inventario_productos:N_,precios_productos:U_,precios_historico:z_,stock:D_,inventario_salidas:B_,inventario_categorias:M_,proveedores:X_,caja_sesiones:q_,caja_movimientos:L_,rep_ventas:I_,rep_devoluciones:H_,rep_ingresos_egresos:V_,rep_compras:$_,compras_main:W_,devoluciones_proveedores:ex,rep_export:P_,cuentas_contables:G_,libro_diario:K_,auditoria:Y_,impuestos:ix};function sx({onLogout:o}){const[a,s]=j.useState("dashboard"),[l,u]=j.useState(null),[d,f]=j.useState({}),g=l||a,p=rx[g],v=(S=>{for(const b of sp){if(b.id===S)return b.label;if(b.children){const w=b.children.find(A=>A.id===S);if(w)return w.label}}return"Panel de Administracin"})(g),x=S=>{if(S.id==="salir")return o();S.children&&S.children.length>0?(f(b=>({...b,[S.id]:!b[S.id]})),(S.id!==a||!l)&&(s(S.id),u(S.children[0].id))):(s(S.id),u(null))};return r.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[r.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[r.jsx("strong",{children:"Panel Admin"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),r.jsx("nav",{children:sp.map(S=>r.jsxs("div",{style:{marginBottom:6},children:[r.jsxs("div",{onClick:()=>x(S),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===S.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[r.jsx("span",{children:S.label}),Array.isArray(S.children)&&S.children.length>0?r.jsx("span",{style:{marginLeft:8},children:d[S.id]?"":""}):null]}),Array.isArray(S.children)&&S.children.length>0&&d[S.id]&&r.jsx("div",{style:{marginLeft:12,marginTop:6},children:S.children.map(b=>r.jsx("div",{onClick:()=>{s(S.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},S.id))})]}),r.jsx("main",{style:{flex:1,padding:24},children:p?r.jsx(p,{}):r.jsx(f_,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function lx(){const[o,a]=j.useState(null);j.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return r.jsxs("div",{children:[!o&&r.jsx($0,{onLogin:s}),o&&o.role==="cajero"&&r.jsx(o_,{onLogout:l}),o&&o.role==="admin"&&r.jsx(sx,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&r.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[r.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),r.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',r.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),r.jsx("div",{style:{marginTop:18},children:r.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class ox extends Tu.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[r.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}_v.createRoot(document.getElementById("root")).render(r.jsx(ox,{children:r.jsx(lx,{})}));
