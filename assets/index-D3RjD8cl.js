function fv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function dp(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function hv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var au={exports:{}},ss={};var Sg;function gv(){if(Sg)return ss;Sg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var h=null;if(d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:h,ref:u!==void 0?u:null,props:d}}return ss.Fragment=a,ss.jsx=s,ss.jsxs=s,ss}var wg;function pv(){return wg||(wg=1,au.exports=gv()),au.exports}var i=pv(),iu={exports:{}},ls={},ru={exports:{}},su={};var Eg;function mv(){return Eg||(Eg=1,(function(o){function a(C,U){var W=C.length;C.push(U);e:for(;0<W;){var ue=W-1>>>1,_e=C[ue];if(0<u(_e,U))C[ue]=U,C[W]=_e,W=ue;else break e}}function s(C){return C.length===0?null:C[0]}function l(C){if(C.length===0)return null;var U=C[0],W=C.pop();if(W!==U){C[0]=W;e:for(var ue=0,_e=C.length,w=_e>>>1;ue<w;){var O=2*(ue+1)-1,V=C[O],J=O+1,he=C[J];if(0>u(V,W))J<_e&&0>u(he,V)?(C[ue]=he,C[J]=W,ue=J):(C[ue]=V,C[O]=W,ue=O);else if(J<_e&&0>u(he,W))C[ue]=he,C[J]=W,ue=J;else break e}}return U}function u(C,U){var W=C.sortIndex-U.sortIndex;return W!==0?W:C.id-U.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();o.unstable_now=function(){return h.now()-g}}var p=[],m=[],v=1,x=null,_=3,b=!1,E=!1,R=!1,N=!1,A=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function G(C){for(var U=s(m);U!==null;){if(U.callback===null)l(m);else if(U.startTime<=C)l(m),U.sortIndex=U.expirationTime,a(p,U);else break;U=s(m)}}function T(C){if(R=!1,G(C),!E)if(s(p)!==null)E=!0,L||(L=!0,je());else{var U=s(m);U!==null&&X(T,U.startTime-C)}}var L=!1,D=-1,H=5,ve=-1;function Y(){return N?!0:!(o.unstable_now()-ve<H)}function oe(){if(N=!1,L){var C=o.unstable_now();ve=C;var U=!0;try{e:{E=!1,R&&(R=!1,I(D),D=-1),b=!0;var W=_;try{t:{for(G(C),x=s(p);x!==null&&!(x.expirationTime>C&&Y());){var ue=x.callback;if(typeof ue=="function"){x.callback=null,_=x.priorityLevel;var _e=ue(x.expirationTime<=C);if(C=o.unstable_now(),typeof _e=="function"){x.callback=_e,G(C),U=!0;break t}x===s(p)&&l(p),G(C)}else l(p);x=s(p)}if(x!==null)U=!0;else{var w=s(m);w!==null&&X(T,w.startTime-C),U=!1}}break e}finally{x=null,_=W,b=!1}U=void 0}}finally{U?je():L=!1}}}var je;if(typeof M=="function")je=function(){M(oe)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,te=q.port2;q.port1.onmessage=oe,je=function(){te.postMessage(null)}}else je=function(){A(oe,0)};function X(C,U){D=A(function(){C(o.unstable_now())},U)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(C){C.callback=null},o.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<C?Math.floor(1e3/C):5},o.unstable_getCurrentPriorityLevel=function(){return _},o.unstable_next=function(C){switch(_){case 1:case 2:case 3:var U=3;break;default:U=_}var W=_;_=U;try{return C()}finally{_=W}},o.unstable_requestPaint=function(){N=!0},o.unstable_runWithPriority=function(C,U){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var W=_;_=C;try{return U()}finally{_=W}},o.unstable_scheduleCallback=function(C,U,W){var ue=o.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ue+W:ue):W=ue,C){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=W+_e,C={id:v++,callback:U,priorityLevel:C,startTime:W,expirationTime:_e,sortIndex:-1},W>ue?(C.sortIndex=W,a(m,C),s(p)===null&&C===s(m)&&(R?(I(D),D=-1):R=!0,X(T,W-ue))):(C.sortIndex=_e,a(p,C),E||b||(E=!0,L||(L=!0,je()))),C},o.unstable_shouldYield=Y,o.unstable_wrapCallback=function(C){var U=_;return function(){var W=_;_=U;try{return C.apply(this,arguments)}finally{_=W}}}})(su)),su}var Cg;function yv(){return Cg||(Cg=1,ru.exports=mv()),ru.exports}var lu={exports:{}},Me={};var Tg;function vv(){if(Tg)return Me;Tg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),h=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),_=Symbol.iterator;function b(w){return w===null||typeof w!="object"?null:(w=_&&w[_]||w["@@iterator"],typeof w=="function"?w:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,N={};function A(w,O,V){this.props=w,this.context=O,this.refs=N,this.updater=V||E}A.prototype.isReactComponent={},A.prototype.setState=function(w,O){if(typeof w!="object"&&typeof w!="function"&&w!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,w,O,"setState")},A.prototype.forceUpdate=function(w){this.updater.enqueueForceUpdate(this,w,"forceUpdate")};function I(){}I.prototype=A.prototype;function M(w,O,V){this.props=w,this.context=O,this.refs=N,this.updater=V||E}var G=M.prototype=new I;G.constructor=M,R(G,A.prototype),G.isPureReactComponent=!0;var T=Array.isArray;function L(){}var D={H:null,A:null,T:null,S:null},H=Object.prototype.hasOwnProperty;function ve(w,O,V){var J=V.ref;return{$$typeof:o,type:w,key:O,ref:J!==void 0?J:null,props:V}}function Y(w,O){return ve(w.type,O,w.props)}function oe(w){return typeof w=="object"&&w!==null&&w.$$typeof===o}function je(w){var O={"=":"=0",":":"=2"};return"$"+w.replace(/[=:]/g,function(V){return O[V]})}var q=/\/+/g;function te(w,O){return typeof w=="object"&&w!==null&&w.key!=null?je(""+w.key):O.toString(36)}function X(w){switch(w.status){case"fulfilled":return w.value;case"rejected":throw w.reason;default:switch(typeof w.status=="string"?w.then(L,L):(w.status="pending",w.then(function(O){w.status==="pending"&&(w.status="fulfilled",w.value=O)},function(O){w.status==="pending"&&(w.status="rejected",w.reason=O)})),w.status){case"fulfilled":return w.value;case"rejected":throw w.reason}}throw w}function C(w,O,V,J,he){var de=typeof w;(de==="undefined"||de==="boolean")&&(w=null);var k=!1;if(w===null)k=!0;else switch(de){case"bigint":case"string":case"number":k=!0;break;case"object":switch(w.$$typeof){case o:case a:k=!0;break;case v:return k=w._init,C(k(w._payload),O,V,J,he)}}if(k)return he=he(w),k=J===""?"."+te(w,0):J,T(he)?(V="",k!=null&&(V=k.replace(q,"$&/")+"/"),C(he,O,V,"",function(Se){return Se})):he!=null&&(oe(he)&&(he=Y(he,V+(he.key==null||w&&w.key===he.key?"":(""+he.key).replace(q,"$&/")+"/")+k)),O.push(he)),1;k=0;var ne=J===""?".":J+":";if(T(w))for(var me=0;me<w.length;me++)J=w[me],de=ne+te(J,me),k+=C(J,O,V,de,he);else if(me=b(w),typeof me=="function")for(w=me.call(w),me=0;!(J=w.next()).done;)J=J.value,de=ne+te(J,me++),k+=C(J,O,V,de,he);else if(de==="object"){if(typeof w.then=="function")return C(X(w),O,V,J,he);throw O=String(w),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return k}function U(w,O,V){if(w==null)return w;var J=[],he=0;return C(w,J,"","",function(de){return O.call(V,de,he++)}),J}function W(w){if(w._status===-1){var O=w._result;O=O(),O.then(function(V){(w._status===0||w._status===-1)&&(w._status=1,w._result=V)},function(V){(w._status===0||w._status===-1)&&(w._status=2,w._result=V)}),w._status===-1&&(w._status=0,w._result=O)}if(w._status===1)return w._result.default;throw w._result}var ue=typeof reportError=="function"?reportError:function(w){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof w=="object"&&w!==null&&typeof w.message=="string"?String(w.message):String(w),error:w});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",w);return}console.error(w)},_e={map:U,forEach:function(w,O,V){U(w,function(){O.apply(this,arguments)},V)},count:function(w){var O=0;return U(w,function(){O++}),O},toArray:function(w){return U(w,function(O){return O})||[]},only:function(w){if(!oe(w))throw Error("React.Children.only expected to receive a single React element child.");return w}};return Me.Activity=x,Me.Children=_e,Me.Component=A,Me.Fragment=s,Me.Profiler=u,Me.PureComponent=M,Me.StrictMode=l,Me.Suspense=p,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Me.__COMPILER_RUNTIME={__proto__:null,c:function(w){return D.H.useMemoCache(w)}},Me.cache=function(w){return function(){return w.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(w,O,V){if(w==null)throw Error("The argument must be a React element, but you passed "+w+".");var J=R({},w.props),he=w.key;if(O!=null)for(de in O.key!==void 0&&(he=""+O.key),O)!H.call(O,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&O.ref===void 0||(J[de]=O[de]);var de=arguments.length-2;if(de===1)J.children=V;else if(1<de){for(var k=Array(de),ne=0;ne<de;ne++)k[ne]=arguments[ne+2];J.children=k}return ve(w.type,he,J)},Me.createContext=function(w){return w={$$typeof:h,_currentValue:w,_currentValue2:w,_threadCount:0,Provider:null,Consumer:null},w.Provider=w,w.Consumer={$$typeof:d,_context:w},w},Me.createElement=function(w,O,V){var J,he={},de=null;if(O!=null)for(J in O.key!==void 0&&(de=""+O.key),O)H.call(O,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(he[J]=O[J]);var k=arguments.length-2;if(k===1)he.children=V;else if(1<k){for(var ne=Array(k),me=0;me<k;me++)ne[me]=arguments[me+2];he.children=ne}if(w&&w.defaultProps)for(J in k=w.defaultProps,k)he[J]===void 0&&(he[J]=k[J]);return ve(w,de,he)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(w){return{$$typeof:g,render:w}},Me.isValidElement=oe,Me.lazy=function(w){return{$$typeof:v,_payload:{_status:-1,_result:w},_init:W}},Me.memo=function(w,O){return{$$typeof:m,type:w,compare:O===void 0?null:O}},Me.startTransition=function(w){var O=D.T,V={};D.T=V;try{var J=w(),he=D.S;he!==null&&he(V,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(L,ue)}catch(de){ue(de)}finally{O!==null&&V.types!==null&&(O.types=V.types),D.T=O}},Me.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Me.use=function(w){return D.H.use(w)},Me.useActionState=function(w,O,V){return D.H.useActionState(w,O,V)},Me.useCallback=function(w,O){return D.H.useCallback(w,O)},Me.useContext=function(w){return D.H.useContext(w)},Me.useDebugValue=function(){},Me.useDeferredValue=function(w,O){return D.H.useDeferredValue(w,O)},Me.useEffect=function(w,O){return D.H.useEffect(w,O)},Me.useEffectEvent=function(w){return D.H.useEffectEvent(w)},Me.useId=function(){return D.H.useId()},Me.useImperativeHandle=function(w,O,V){return D.H.useImperativeHandle(w,O,V)},Me.useInsertionEffect=function(w,O){return D.H.useInsertionEffect(w,O)},Me.useLayoutEffect=function(w,O){return D.H.useLayoutEffect(w,O)},Me.useMemo=function(w,O){return D.H.useMemo(w,O)},Me.useOptimistic=function(w,O){return D.H.useOptimistic(w,O)},Me.useReducer=function(w,O,V){return D.H.useReducer(w,O,V)},Me.useRef=function(w){return D.H.useRef(w)},Me.useState=function(w){return D.H.useState(w)},Me.useSyncExternalStore=function(w,O,V){return D.H.useSyncExternalStore(w,O,V)},Me.useTransition=function(){return D.H.useTransition()},Me.version="19.2.0",Me}var Ag;function Ou(){return Ag||(Ag=1,lu.exports=vv()),lu.exports}var ou={exports:{}},Pt={};var Ng;function bv(){if(Ng)return Pt;Ng=1;var o=Ou();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:x==null?null:""+x,children:p,containerInfo:m,implementation:v}}var h=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Pt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Pt.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},Pt.flushSync=function(p){var m=h.T,v=l.p;try{if(h.T=null,l.p=2,p)return p()}finally{h.T=m,l.p=v,l.d.f()}},Pt.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},Pt.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Pt.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:_,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:x,integrity:_,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Pt.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},Pt.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Pt.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},Pt.requestFormReset=function(p){l.d.r(p)},Pt.unstable_batchedUpdates=function(p,m){return p(m)},Pt.useFormState=function(p,m,v){return h.H.useFormState(p,m,v)},Pt.useFormStatus=function(){return h.H.useHostTransitionStatus()},Pt.version="19.2.0",Pt}var Rg;function fp(){if(Rg)return ou.exports;Rg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),ou.exports=bv(),ou.exports}var Og;function xv(){if(Og)return ls;Og=1;var o=yv(),a=Ou(),s=fp();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,r=t;;){var c=n.return;if(c===null)break;var f=c.alternate;if(f===null){if(r=c.return,r!==null){n=r;continue}break}if(c.child===f.child){for(f=c.child;f;){if(f===n)return p(c),e;if(f===r)return p(c),t;f=f.sibling}throw Error(l(188))}if(n.return!==r.return)n=c,r=f;else{for(var y=!1,S=c.child;S;){if(S===n){y=!0,n=c,r=f;break}if(S===r){y=!0,r=c,n=f;break}S=S.sibling}if(!y){for(S=f.child;S;){if(S===n){y=!0,n=f,r=c;break}if(S===r){y=!0,r=f,n=c;break}S=S.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==r)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,_=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),M=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),ve=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),oe=Symbol.iterator;function je(e){return e===null||typeof e!="object"?null:(e=oe&&e[oe]||e["@@iterator"],typeof e=="function"?e:null)}var q=Symbol.for("react.client.reference");function te(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===q?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case R:return"Fragment";case A:return"Profiler";case N:return"StrictMode";case T:return"Suspense";case L:return"SuspenseList";case ve:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case E:return"Portal";case M:return e.displayName||"Context";case I:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case D:return t=e.displayName||null,t!==null?t:te(e.type)||"Memo";case H:t=e._payload,e=e._init;try{return te(e(t))}catch{}}return null}var X=Array.isArray,C=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},ue=[],_e=-1;function w(e){return{current:e}}function O(e){0>_e||(e.current=ue[_e],ue[_e]=null,_e--)}function V(e,t){_e++,ue[_e]=e.current,e.current=t}var J=w(null),he=w(null),de=w(null),k=w(null);function ne(e,t){switch(V(de,t),V(he,e),V(J,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Kh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Kh(t),e=Fh(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}O(J),V(J,e)}function me(){O(J),O(he),O(de)}function Se(e){e.memoizedState!==null&&V(k,e);var t=J.current,n=Fh(t,e.type);t!==n&&(V(he,e),V(J,n))}function Ae(e){he.current===e&&(O(J),O(he)),k.current===e&&(O(k),ns._currentValue=W)}var De,qe;function Ze(e){if(De===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);De=t&&t[1]||"",qe=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+De+e+qe}var mt=!1;function yt(e,t){if(!e||mt)return"";mt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(ee){var Q=ee}Reflect.construct(e,[],le)}else{try{le.call()}catch(ee){Q=ee}e.call(le.prototype)}}else{try{throw Error()}catch(ee){Q=ee}(le=e())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(ee){if(ee&&Q&&typeof ee.stack=="string")return[ee.stack,Q.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var f=r.DetermineComponentFrameRoot(),y=f[0],S=f[1];if(y&&S){var z=y.split(`
`),F=S.split(`
`);for(c=r=0;r<z.length&&!z[r].includes("DetermineComponentFrameRoot");)r++;for(;c<F.length&&!F[c].includes("DetermineComponentFrameRoot");)c++;if(r===z.length||c===F.length)for(r=z.length-1,c=F.length-1;1<=r&&0<=c&&z[r]!==F[c];)c--;for(;1<=r&&0<=c;r--,c--)if(z[r]!==F[c]){if(r!==1||c!==1)do if(r--,c--,0>c||z[r]!==F[c]){var ie=`
`+z[r].replace(" at new "," at ");return e.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",e.displayName)),ie}while(1<=r&&0<=c);break}}}finally{mt=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Ze(n):""}function ft(e,t){switch(e.tag){case 26:case 27:case 5:return Ze(e.type);case 16:return Ze("Lazy");case 13:return e.child!==t&&t!==null?Ze("Suspense Fallback"):Ze("Suspense");case 19:return Ze("SuspenseList");case 0:case 15:return yt(e.type,!1);case 11:return yt(e.type.render,!1);case 1:return yt(e.type,!0);case 31:return Ze("Activity");default:return""}}function wt(e){try{var t="",n=null;do t+=ft(e,n),n=e,e=e.return;while(e);return t}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}var Ht=Object.prototype.hasOwnProperty,tt=o.unstable_scheduleCallback,it=o.unstable_cancelCallback,Ba=o.unstable_shouldYield,pi=o.unstable_requestPaint,Gt=o.unstable_now,mi=o.unstable_getCurrentPriorityLevel,ps=o.unstable_ImmediatePriority,yi=o.unstable_UserBlockingPriority,La=o.unstable_NormalPriority,gr=o.unstable_LowPriority,ms=o.unstable_IdlePriority,ys=o.log,pr=o.unstable_setDisableYieldValue,Ma=null,Kt=null;function On(e){if(typeof ys=="function"&&pr(e),Kt&&typeof Kt.setStrictMode=="function")try{Kt.setStrictMode(Ma,e)}catch{}}var Ft=Math.clz32?Math.clz32:Jl,vi=Math.log,Yl=Math.LN2;function Jl(e){return e>>>=0,e===0?32:31-(vi(e)/Yl|0)|0}var bi=256,xi=262144,_i=4194304;function kn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function qa(e,t,n){var r=e.pendingLanes;if(r===0)return 0;var c=0,f=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var S=r&134217727;return S!==0?(r=S&~f,r!==0?c=kn(r):(y&=S,y!==0?c=kn(y):n||(n=S&~e,n!==0&&(c=kn(n))))):(S=r&~f,S!==0?c=kn(S):y!==0?c=kn(y):n||(n=r&~e,n!==0&&(c=kn(n)))),c===0?0:t!==0&&t!==c&&(t&f)===0&&(f=c&-c,n=t&-t,f>=n||f===32&&(n&4194048)!==0)?t:c}function Ia(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Hn(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zn(){var e=_i;return _i<<=1,(_i&62914560)===0&&(_i=4194304),e}function ji(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ha(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ql(e,t,n,r,c,f){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var S=e.entanglements,z=e.expirationTimes,F=e.hiddenUpdates;for(n=y&~n;0<n;){var ie=31-Ft(n),le=1<<ie;S[ie]=0,z[ie]=-1;var Q=F[ie];if(Q!==null)for(F[ie]=null,ie=0;ie<Q.length;ie++){var ee=Q[ie];ee!==null&&(ee.lane&=-536870913)}n&=~le}r!==0&&Si(e,r,0),f!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=f&~(y&~t))}function Si(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Ft(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|n&261930}function vs(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ft(n),c=1<<r;c&t|e[r]&t&&(e[r]|=t),n&=~c}}function wi(e,t){var n=t&-t;return n=(n&42)!==0?1:Ei(n),(n&(e.suspendedLanes|t))!==0?0:n}function Ei(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Un(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function bs(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:mg(e.type))}function xs(e,t){var n=U.p;try{return U.p=e,t()}finally{U.p=n}}var Dn=Math.random().toString(36).slice(2),Et="__reactFiber$"+Dn,$t="__reactProps$"+Dn,Bn="__reactContainer$"+Dn,wn="__reactEvents$"+Dn,Xl="__reactListeners$"+Dn,_s="__reactHandles$"+Dn,mr="__reactResources$"+Dn,$a="__reactMarker$"+Dn;function yr(e){delete e[Et],delete e[$t],delete e[wn],delete e[Xl],delete e[_s]}function la(e){var t=e[Et];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Bn]||n[Et]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=eg(e);e!==null;){if(n=e[Et])return n;e=eg(e)}return t}e=n,n=e.parentNode}return null}function $(e){if(e=e[Et]||e[Bn]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function re(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function xe(e){var t=e[mr];return t||(t=e[mr]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Z(e){e[$a]=!0}var ye=new Set,fe={};function ge(e,t){pe(e,t),pe(e+"Capture",t)}function pe(e,t){for(fe[e]=t,e=0;e<t.length;e++)ye.add(t[e])}var be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ce={},we={};function Oe(e){return Ht.call(we,e)?!0:Ht.call(ce,e)?!1:be.test(e)?we[e]=!0:(ce[e]=!0,!1)}function He(e,t,n){if(Oe(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var r=t.toLowerCase().slice(0,5);if(r!=="data-"&&r!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Dt(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function at(e,t,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+r)}}function Qe(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $n(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var c=r.get,f=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,f.call(this,y)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Jt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=$n(e,t,""+e[t])}}function oa(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ht(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Pa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var vr=/[\n"\\]/g;function zt(e){return e.replace(vr,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function fn(e,t,n,r,c,f,y,S){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Qe(t)):e.value!==""+Qe(t)&&(e.value=""+Qe(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?Le(e,y,Qe(t)):n!=null?Le(e,y,Qe(n)):r!=null&&e.removeAttribute("value"),c==null&&f!=null&&(e.defaultChecked=!!f),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?e.name=""+Qe(S):e.removeAttribute("name")}function Ce(e,t,n,r,c,f,y,S){if(f!=null&&typeof f!="function"&&typeof f!="symbol"&&typeof f!="boolean"&&(e.type=f),t!=null||n!=null){if(!(f!=="submit"&&f!=="reset"||t!=null)){Jt(e);return}n=n!=null?""+Qe(n):"",t=t!=null?""+Qe(t):n,S||t===e.value||(e.value=t),e.defaultValue=t}r=r??c,r=typeof r!="function"&&typeof r!="symbol"&&!!r,e.checked=S?e.checked:!!r,e.defaultChecked=!!r,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Jt(e)}function Le(e,t,n){t==="number"&&Pa(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ve(e,t,n,r){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Qe(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,r&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Ne(e,t,n){if(t!=null&&(t=""+Qe(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Qe(n):""}function Pe(e,t,n,r){if(t==null){if(r!=null){if(n!=null)throw Error(l(92));if(X(r)){if(1<r.length)throw Error(l(93));r=r[0]}n=r}n==null&&(n=""),t=n}n=Qe(t),e.defaultValue=n,r=e.textContent,r===n&&r!==""&&r!==null&&(e.value=r),Jt(e)}function Ge(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Va=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ca(e,t,n){var r=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?r?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":r?e.setProperty(t,n):typeof n!="number"||n===0||Va.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Pu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var r in n)!n.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf("--")===0?e.setProperty(r,""):r==="float"?e.cssFloat="":e[r]="");for(var c in t)r=t[c],t.hasOwnProperty(c)&&n[c]!==r&&ca(e,c,r)}else for(var f in t)t.hasOwnProperty(f)&&ca(e,f,t[f])}function Zl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var om=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function js(e){return cm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pn(){}var Wl=null;function eo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ci=null,Ti=null;function Vu(e){var t=$(e);if(t&&(e=t.stateNode)){var n=e[$t]||null;e:switch(e=t.stateNode,t.type){case"input":if(fn(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+zt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var c=r[$t]||null;if(!c)throw Error(l(90));fn(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)r=n[t],r.form===e.form&&oa(r)}break e;case"textarea":Ne(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Ve(e,!!n.multiple,t,!1)}}}var to=!1;function Gu(e,t,n){if(to)return e(t,n);to=!0;try{var r=e(t);return r}finally{if(to=!1,(Ci!==null||Ti!==null)&&(cl(),Ci&&(t=Ci,e=Ti,Ti=Ci=null,Vu(t),e)))for(t=0;t<e.length;t++)Vu(e[t])}}function br(e,t){var n=e.stateNode;if(n===null)return null;var r=n[$t]||null;if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),no=!1;if(Vn)try{var xr={};Object.defineProperty(xr,"passive",{get:function(){no=!0}}),window.addEventListener("test",xr,xr),window.removeEventListener("test",xr,xr)}catch{no=!1}var ua=null,ao=null,Ss=null;function Ku(){if(Ss)return Ss;var e,t=ao,n=t.length,r,c="value"in ua?ua.value:ua.textContent,f=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(r=1;r<=y&&t[n-r]===c[f-r];r++);return Ss=c.slice(e,1<r?1-r:void 0)}function ws(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Es(){return!0}function Fu(){return!1}function Qt(e){function t(n,r,c,f,y){this._reactName=n,this._targetInst=c,this.type=r,this.nativeEvent=f,this.target=y,this.currentTarget=null;for(var S in e)e.hasOwnProperty(S)&&(n=e[S],this[S]=n?n(f):f[S]);return this.isDefaultPrevented=(f.defaultPrevented!=null?f.defaultPrevented:f.returnValue===!1)?Es:Fu,this.isPropagationStopped=Fu,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Es)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Es)},persist:function(){},isPersistent:Es}),t}var Ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cs=Qt(Ga),_r=x({},Ga,{view:0,detail:0}),um=Qt(_r),io,ro,jr,Ts=x({},_r,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lo,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jr&&(jr&&e.type==="mousemove"?(io=e.screenX-jr.screenX,ro=e.screenY-jr.screenY):ro=io=0,jr=e),io)},movementY:function(e){return"movementY"in e?e.movementY:ro}}),Yu=Qt(Ts),dm=x({},Ts,{dataTransfer:0}),fm=Qt(dm),hm=x({},_r,{relatedTarget:0}),so=Qt(hm),gm=x({},Ga,{animationName:0,elapsedTime:0,pseudoElement:0}),pm=Qt(gm),mm=x({},Ga,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ym=Qt(mm),vm=x({},Ga,{data:0}),Ju=Qt(vm),bm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_m={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jm(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_m[e])?!!t[e]:!1}function lo(){return jm}var Sm=x({},_r,{key:function(e){if(e.key){var t=bm[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ws(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lo,charCode:function(e){return e.type==="keypress"?ws(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ws(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wm=Qt(Sm),Em=x({},Ts,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qu=Qt(Em),Cm=x({},_r,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lo}),Tm=Qt(Cm),Am=x({},Ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nm=Qt(Am),Rm=x({},Ts,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Om=Qt(Rm),km=x({},Ga,{newState:0,oldState:0}),zm=Qt(km),Um=[9,13,27,32],oo=Vn&&"CompositionEvent"in window,Sr=null;Vn&&"documentMode"in document&&(Sr=document.documentMode);var Dm=Vn&&"TextEvent"in window&&!Sr,Xu=Vn&&(!oo||Sr&&8<Sr&&11>=Sr),Zu=" ",Wu=!1;function ed(e,t){switch(e){case"keyup":return Um.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function td(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ai=!1;function Bm(e,t){switch(e){case"compositionend":return td(t);case"keypress":return t.which!==32?null:(Wu=!0,Zu);case"textInput":return e=t.data,e===Zu&&Wu?null:e;default:return null}}function Lm(e,t){if(Ai)return e==="compositionend"||!oo&&ed(e,t)?(e=Ku(),Ss=ao=ua=null,Ai=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xu&&t.locale!=="ko"?null:t.data;default:return null}}var Mm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Mm[e.type]:t==="textarea"}function ad(e,t,n,r){Ci?Ti?Ti.push(r):Ti=[r]:Ci=r,t=ml(t,"onChange"),0<t.length&&(n=new Cs("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var wr=null,Er=null;function qm(e){Ih(e,0)}function As(e){var t=re(e);if(oa(t))return e}function id(e,t){if(e==="change")return t}var rd=!1;if(Vn){var co;if(Vn){var uo="oninput"in document;if(!uo){var sd=document.createElement("div");sd.setAttribute("oninput","return;"),uo=typeof sd.oninput=="function"}co=uo}else co=!1;rd=co&&(!document.documentMode||9<document.documentMode)}function ld(){wr&&(wr.detachEvent("onpropertychange",od),Er=wr=null)}function od(e){if(e.propertyName==="value"&&As(Er)){var t=[];ad(t,Er,e,eo(e)),Gu(qm,t)}}function Im(e,t,n){e==="focusin"?(ld(),wr=t,Er=n,wr.attachEvent("onpropertychange",od)):e==="focusout"&&ld()}function Hm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return As(Er)}function $m(e,t){if(e==="click")return As(t)}function Pm(e,t){if(e==="input"||e==="change")return As(t)}function Vm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nn=typeof Object.is=="function"?Object.is:Vm;function Cr(e,t){if(nn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var c=n[r];if(!Ht.call(t,c)||!nn(e[c],t[c]))return!1}return!0}function cd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ud(e,t){var n=cd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cd(n)}}function dd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?dd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function fd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Pa(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Pa(e.document)}return t}function fo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Gm=Vn&&"documentMode"in document&&11>=document.documentMode,Ni=null,ho=null,Tr=null,go=!1;function hd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;go||Ni==null||Ni!==Pa(r)||(r=Ni,"selectionStart"in r&&fo(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Tr&&Cr(Tr,r)||(Tr=r,r=ml(ho,"onSelect"),0<r.length&&(t=new Cs("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ni)))}function Ka(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ri={animationend:Ka("Animation","AnimationEnd"),animationiteration:Ka("Animation","AnimationIteration"),animationstart:Ka("Animation","AnimationStart"),transitionrun:Ka("Transition","TransitionRun"),transitionstart:Ka("Transition","TransitionStart"),transitioncancel:Ka("Transition","TransitionCancel"),transitionend:Ka("Transition","TransitionEnd")},po={},gd={};Vn&&(gd=document.createElement("div").style,"AnimationEvent"in window||(delete Ri.animationend.animation,delete Ri.animationiteration.animation,delete Ri.animationstart.animation),"TransitionEvent"in window||delete Ri.transitionend.transition);function Fa(e){if(po[e])return po[e];if(!Ri[e])return e;var t=Ri[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in gd)return po[e]=t[n];return e}var pd=Fa("animationend"),md=Fa("animationiteration"),yd=Fa("animationstart"),Km=Fa("transitionrun"),Fm=Fa("transitionstart"),Ym=Fa("transitioncancel"),vd=Fa("transitionend"),bd=new Map,mo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mo.push("scrollEnd");function En(e,t){bd.set(e,t),ge(t,[e])}var Ns=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},hn=[],Oi=0,yo=0;function Rs(){for(var e=Oi,t=yo=Oi=0;t<e;){var n=hn[t];hn[t++]=null;var r=hn[t];hn[t++]=null;var c=hn[t];hn[t++]=null;var f=hn[t];if(hn[t++]=null,r!==null&&c!==null){var y=r.pending;y===null?c.next=c:(c.next=y.next,y.next=c),r.pending=c}f!==0&&xd(n,c,f)}}function Os(e,t,n,r){hn[Oi++]=e,hn[Oi++]=t,hn[Oi++]=n,hn[Oi++]=r,yo|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function vo(e,t,n,r){return Os(e,t,n,r),ks(e)}function Ya(e,t){return Os(e,null,null,t),ks(e)}function xd(e,t,n){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n);for(var c=!1,f=e.return;f!==null;)f.childLanes|=n,r=f.alternate,r!==null&&(r.childLanes|=n),f.tag===22&&(e=f.stateNode,e===null||e._visibility&1||(c=!0)),e=f,f=f.return;return e.tag===3?(f=e.stateNode,c&&t!==null&&(c=31-Ft(n),e=f.hiddenUpdates,r=e[c],r===null?e[c]=[t]:r.push(t),t.lane=n|536870912),f):null}function ks(e){if(50<Jr)throw Jr=0,Tc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var ki={};function Jm(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,n,r){return new Jm(e,t,n,r)}function bo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Gn(e,t){var n=e.alternate;return n===null?(n=an(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function _d(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function zs(e,t,n,r,c,f){var y=0;if(r=e,typeof e=="function")bo(e)&&(y=1);else if(typeof e=="string")y=ev(e,n,J.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case ve:return e=an(31,n,t,c),e.elementType=ve,e.lanes=f,e;case R:return Ja(n.children,c,f,t);case N:y=8,c|=24;break;case A:return e=an(12,n,t,c|2),e.elementType=A,e.lanes=f,e;case T:return e=an(13,n,t,c),e.elementType=T,e.lanes=f,e;case L:return e=an(19,n,t,c),e.elementType=L,e.lanes=f,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case M:y=10;break e;case I:y=9;break e;case G:y=11;break e;case D:y=14;break e;case H:y=16,r=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),r=null}return t=an(y,n,t,c),t.elementType=e,t.type=r,t.lanes=f,t}function Ja(e,t,n,r){return e=an(7,e,r,t),e.lanes=n,e}function xo(e,t,n){return e=an(6,e,null,t),e.lanes=n,e}function jd(e){var t=an(18,null,null,0);return t.stateNode=e,t}function _o(e,t,n){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Sd=new WeakMap;function gn(e,t){if(typeof e=="object"&&e!==null){var n=Sd.get(e);return n!==void 0?n:(t={value:e,source:t,stack:wt(t)},Sd.set(e,t),t)}return{value:e,source:t,stack:wt(t)}}var zi=[],Ui=0,Us=null,Ar=0,pn=[],mn=0,da=null,Ln=1,Mn="";function Kn(e,t){zi[Ui++]=Ar,zi[Ui++]=Us,Us=e,Ar=t}function wd(e,t,n){pn[mn++]=Ln,pn[mn++]=Mn,pn[mn++]=da,da=e;var r=Ln;e=Mn;var c=32-Ft(r)-1;r&=~(1<<c),n+=1;var f=32-Ft(t)+c;if(30<f){var y=c-c%5;f=(r&(1<<y)-1).toString(32),r>>=y,c-=y,Ln=1<<32-Ft(t)+c|n<<c|r,Mn=f+e}else Ln=1<<f|n<<c|r,Mn=e}function jo(e){e.return!==null&&(Kn(e,1),wd(e,1,0))}function So(e){for(;e===Us;)Us=zi[--Ui],zi[Ui]=null,Ar=zi[--Ui],zi[Ui]=null;for(;e===da;)da=pn[--mn],pn[mn]=null,Mn=pn[--mn],pn[mn]=null,Ln=pn[--mn],pn[mn]=null}function Ed(e,t){pn[mn++]=Ln,pn[mn++]=Mn,pn[mn++]=da,Ln=t.id,Mn=t.overflow,da=e}var Bt=null,gt=null,Xe=!1,fa=null,yn=!1,wo=Error(l(519));function ha(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nr(gn(t,e)),wo}function Cd(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Et]=e,t[$t]=r,n){case"dialog":Fe("cancel",t),Fe("close",t);break;case"iframe":case"object":case"embed":Fe("load",t);break;case"video":case"audio":for(n=0;n<Xr.length;n++)Fe(Xr[n],t);break;case"source":Fe("error",t);break;case"img":case"image":case"link":Fe("error",t),Fe("load",t);break;case"details":Fe("toggle",t);break;case"input":Fe("invalid",t),Ce(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Fe("invalid",t);break;case"textarea":Fe("invalid",t),Pe(t,r.value,r.defaultValue,r.children)}n=r.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||r.suppressHydrationWarning===!0||Vh(t.textContent,n)?(r.popover!=null&&(Fe("beforetoggle",t),Fe("toggle",t)),r.onScroll!=null&&Fe("scroll",t),r.onScrollEnd!=null&&Fe("scrollend",t),r.onClick!=null&&(t.onclick=Pn),t=!0):t=!1,t||ha(e,!0)}function Td(e){for(Bt=e.return;Bt;)switch(Bt.tag){case 5:case 31:case 13:yn=!1;return;case 27:case 3:yn=!0;return;default:Bt=Bt.return}}function Di(e){if(e!==Bt)return!1;if(!Xe)return Td(e),Xe=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||$c(e.type,e.memoizedProps)),n=!n),n&&gt&&ha(e),Td(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));gt=Wh(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));gt=Wh(e)}else t===27?(t=gt,Ta(e.type)?(e=Fc,Fc=null,gt=e):gt=t):gt=Bt?bn(e.stateNode.nextSibling):null;return!0}function Qa(){gt=Bt=null,Xe=!1}function Eo(){var e=fa;return e!==null&&(en===null?en=e:en.push.apply(en,e),fa=null),e}function Nr(e){fa===null?fa=[e]:fa.push(e)}var Co=w(null),Xa=null,Fn=null;function ga(e,t,n){V(Co,t._currentValue),t._currentValue=n}function Yn(e){e._currentValue=Co.current,O(Co)}function To(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ao(e,t,n,r){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){var y=c.child;f=f.firstContext;e:for(;f!==null;){var S=f;f=c;for(var z=0;z<t.length;z++)if(S.context===t[z]){f.lanes|=n,S=f.alternate,S!==null&&(S.lanes|=n),To(f.return,n,e),r||(y=null);break e}f=S.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,f=y.alternate,f!==null&&(f.lanes|=n),To(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function Bi(e,t,n,r){e=null;for(var c=t,f=!1;c!==null;){if(!f){if((c.flags&524288)!==0)f=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var S=c.type;nn(c.pendingProps.value,y.value)||(e!==null?e.push(S):e=[S])}}else if(c===k.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(ns):e=[ns])}c=c.return}e!==null&&Ao(t,e,n,r),t.flags|=262144}function Ds(e){for(e=e.firstContext;e!==null;){if(!nn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Za(e){Xa=e,Fn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Lt(e){return Ad(Xa,e)}function Bs(e,t){return Xa===null&&Za(e),Ad(e,t)}function Ad(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Fn===null){if(e===null)throw Error(l(308));Fn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Fn=Fn.next=t;return n}var Qm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,r){e.push(r)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Xm=o.unstable_scheduleCallback,Zm=o.unstable_NormalPriority,Ct={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function No(){return{controller:new Qm,data:new Map,refCount:0}}function Rr(e){e.refCount--,e.refCount===0&&Xm(Zm,function(){e.controller.abort()})}var Or=null,Ro=0,Li=0,Mi=null;function Wm(e,t){if(Or===null){var n=Or=[];Ro=0,Li=zc(),Mi={status:"pending",value:void 0,then:function(r){n.push(r)}}}return Ro++,t.then(Nd,Nd),t}function Nd(){if(--Ro===0&&Or!==null){Mi!==null&&(Mi.status="fulfilled");var e=Or;Or=null,Li=0,Mi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function ey(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(r.status="rejected",r.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),r}var Rd=C.S;C.S=function(e,t){gh=Gt(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Wm(e,t),Rd!==null&&Rd(e,t)};var Wa=w(null);function Oo(){var e=Wa.current;return e!==null?e:ut.pooledCache}function Ls(e,t){t===null?V(Wa,Wa.current):V(Wa,t.pool)}function Od(){var e=Oo();return e===null?null:{parent:Ct._currentValue,pool:e}}var qi=Error(l(460)),ko=Error(l(474)),Ms=Error(l(542)),qs={then:function(){}};function kd(e){return e=e.status,e==="fulfilled"||e==="rejected"}function zd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Pn,Pn),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dd(e),e;default:if(typeof t.status=="string")t.then(Pn,Pn);else{if(e=ut,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(r){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=r}},function(r){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=r}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Dd(e),e}throw ti=t,qi}}function ei(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(ti=n,qi):n}}var ti=null;function Ud(){if(ti===null)throw Error(l(459));var e=ti;return ti=null,e}function Dd(e){if(e===qi||e===Ms)throw Error(l(483))}var Ii=null,kr=0;function Is(e){var t=kr;return kr+=1,Ii===null&&(Ii=[]),zd(Ii,e,t)}function zr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Hs(e,t){throw t.$$typeof===_?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Bd(e){function t(P,B){if(e){var K=P.deletions;K===null?(P.deletions=[B],P.flags|=16):K.push(B)}}function n(P,B){if(!e)return null;for(;B!==null;)t(P,B),B=B.sibling;return null}function r(P){for(var B=new Map;P!==null;)P.key!==null?B.set(P.key,P):B.set(P.index,P),P=P.sibling;return B}function c(P,B){return P=Gn(P,B),P.index=0,P.sibling=null,P}function f(P,B,K){return P.index=K,e?(K=P.alternate,K!==null?(K=K.index,K<B?(P.flags|=67108866,B):K):(P.flags|=67108866,B)):(P.flags|=1048576,B)}function y(P){return e&&P.alternate===null&&(P.flags|=67108866),P}function S(P,B,K,se){return B===null||B.tag!==6?(B=xo(K,P.mode,se),B.return=P,B):(B=c(B,K),B.return=P,B)}function z(P,B,K,se){var ze=K.type;return ze===R?ie(P,B,K.props.children,se,K.key):B!==null&&(B.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===H&&ei(ze)===B.type)?(B=c(B,K.props),zr(B,K),B.return=P,B):(B=zs(K.type,K.key,K.props,null,P.mode,se),zr(B,K),B.return=P,B)}function F(P,B,K,se){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=_o(K,P.mode,se),B.return=P,B):(B=c(B,K.children||[]),B.return=P,B)}function ie(P,B,K,se,ze){return B===null||B.tag!==7?(B=Ja(K,P.mode,se,ze),B.return=P,B):(B=c(B,K),B.return=P,B)}function le(P,B,K){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=xo(""+B,P.mode,K),B.return=P,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case b:return K=zs(B.type,B.key,B.props,null,P.mode,K),zr(K,B),K.return=P,K;case E:return B=_o(B,P.mode,K),B.return=P,B;case H:return B=ei(B),le(P,B,K)}if(X(B)||je(B))return B=Ja(B,P.mode,K,null),B.return=P,B;if(typeof B.then=="function")return le(P,Is(B),K);if(B.$$typeof===M)return le(P,Bs(P,B),K);Hs(P,B)}return null}function Q(P,B,K,se){var ze=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return ze!==null?null:S(P,B,""+K,se);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case b:return K.key===ze?z(P,B,K,se):null;case E:return K.key===ze?F(P,B,K,se):null;case H:return K=ei(K),Q(P,B,K,se)}if(X(K)||je(K))return ze!==null?null:ie(P,B,K,se,null);if(typeof K.then=="function")return Q(P,B,Is(K),se);if(K.$$typeof===M)return Q(P,B,Bs(P,K),se);Hs(P,K)}return null}function ee(P,B,K,se,ze){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return P=P.get(K)||null,S(B,P,""+se,ze);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case b:return P=P.get(se.key===null?K:se.key)||null,z(B,P,se,ze);case E:return P=P.get(se.key===null?K:se.key)||null,F(B,P,se,ze);case H:return se=ei(se),ee(P,B,K,se,ze)}if(X(se)||je(se))return P=P.get(K)||null,ie(B,P,se,ze,null);if(typeof se.then=="function")return ee(P,B,K,Is(se),ze);if(se.$$typeof===M)return ee(P,B,K,Bs(B,se),ze);Hs(B,se)}return null}function Ee(P,B,K,se){for(var ze=null,We=null,Te=B,$e=B=0,Je=null;Te!==null&&$e<K.length;$e++){Te.index>$e?(Je=Te,Te=null):Je=Te.sibling;var et=Q(P,Te,K[$e],se);if(et===null){Te===null&&(Te=Je);break}e&&Te&&et.alternate===null&&t(P,Te),B=f(et,B,$e),We===null?ze=et:We.sibling=et,We=et,Te=Je}if($e===K.length)return n(P,Te),Xe&&Kn(P,$e),ze;if(Te===null){for(;$e<K.length;$e++)Te=le(P,K[$e],se),Te!==null&&(B=f(Te,B,$e),We===null?ze=Te:We.sibling=Te,We=Te);return Xe&&Kn(P,$e),ze}for(Te=r(Te);$e<K.length;$e++)Je=ee(Te,P,$e,K[$e],se),Je!==null&&(e&&Je.alternate!==null&&Te.delete(Je.key===null?$e:Je.key),B=f(Je,B,$e),We===null?ze=Je:We.sibling=Je,We=Je);return e&&Te.forEach(function(ka){return t(P,ka)}),Xe&&Kn(P,$e),ze}function Ue(P,B,K,se){if(K==null)throw Error(l(151));for(var ze=null,We=null,Te=B,$e=B=0,Je=null,et=K.next();Te!==null&&!et.done;$e++,et=K.next()){Te.index>$e?(Je=Te,Te=null):Je=Te.sibling;var ka=Q(P,Te,et.value,se);if(ka===null){Te===null&&(Te=Je);break}e&&Te&&ka.alternate===null&&t(P,Te),B=f(ka,B,$e),We===null?ze=ka:We.sibling=ka,We=ka,Te=Je}if(et.done)return n(P,Te),Xe&&Kn(P,$e),ze;if(Te===null){for(;!et.done;$e++,et=K.next())et=le(P,et.value,se),et!==null&&(B=f(et,B,$e),We===null?ze=et:We.sibling=et,We=et);return Xe&&Kn(P,$e),ze}for(Te=r(Te);!et.done;$e++,et=K.next())et=ee(Te,P,$e,et.value,se),et!==null&&(e&&et.alternate!==null&&Te.delete(et.key===null?$e:et.key),B=f(et,B,$e),We===null?ze=et:We.sibling=et,We=et);return e&&Te.forEach(function(dv){return t(P,dv)}),Xe&&Kn(P,$e),ze}function ct(P,B,K,se){if(typeof K=="object"&&K!==null&&K.type===R&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case b:e:{for(var ze=K.key;B!==null;){if(B.key===ze){if(ze=K.type,ze===R){if(B.tag===7){n(P,B.sibling),se=c(B,K.props.children),se.return=P,P=se;break e}}else if(B.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===H&&ei(ze)===B.type){n(P,B.sibling),se=c(B,K.props),zr(se,K),se.return=P,P=se;break e}n(P,B);break}else t(P,B);B=B.sibling}K.type===R?(se=Ja(K.props.children,P.mode,se,K.key),se.return=P,P=se):(se=zs(K.type,K.key,K.props,null,P.mode,se),zr(se,K),se.return=P,P=se)}return y(P);case E:e:{for(ze=K.key;B!==null;){if(B.key===ze)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){n(P,B.sibling),se=c(B,K.children||[]),se.return=P,P=se;break e}else{n(P,B);break}else t(P,B);B=B.sibling}se=_o(K,P.mode,se),se.return=P,P=se}return y(P);case H:return K=ei(K),ct(P,B,K,se)}if(X(K))return Ee(P,B,K,se);if(je(K)){if(ze=je(K),typeof ze!="function")throw Error(l(150));return K=ze.call(K),Ue(P,B,K,se)}if(typeof K.then=="function")return ct(P,B,Is(K),se);if(K.$$typeof===M)return ct(P,B,Bs(P,K),se);Hs(P,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,B!==null&&B.tag===6?(n(P,B.sibling),se=c(B,K),se.return=P,P=se):(n(P,B),se=xo(K,P.mode,se),se.return=P,P=se),y(P)):n(P,B)}return function(P,B,K,se){try{kr=0;var ze=ct(P,B,K,se);return Ii=null,ze}catch(Te){if(Te===qi||Te===Ms)throw Te;var We=an(29,Te,null,P.mode);return We.lanes=se,We.return=P,We}finally{}}}var ni=Bd(!0),Ld=Bd(!1),pa=!1;function zo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Uo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ma(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ya(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,(nt&2)!==0){var c=r.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),r.pending=t,t=ks(e),xd(e,null,n),t}return Os(e,r,t,n),ks(e)}function Ur(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,vs(e,n)}}function Do(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var c=null,f=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};f===null?c=f=y:f=f.next=y,n=n.next}while(n!==null);f===null?c=f=t:f=f.next=t}else c=f=t;n={baseState:r.baseState,firstBaseUpdate:c,lastBaseUpdate:f,shared:r.shared,callbacks:r.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Bo=!1;function Dr(){if(Bo){var e=Mi;if(e!==null)throw e}}function Br(e,t,n,r){Bo=!1;var c=e.updateQueue;pa=!1;var f=c.firstBaseUpdate,y=c.lastBaseUpdate,S=c.shared.pending;if(S!==null){c.shared.pending=null;var z=S,F=z.next;z.next=null,y===null?f=F:y.next=F,y=z;var ie=e.alternate;ie!==null&&(ie=ie.updateQueue,S=ie.lastBaseUpdate,S!==y&&(S===null?ie.firstBaseUpdate=F:S.next=F,ie.lastBaseUpdate=z))}if(f!==null){var le=c.baseState;y=0,ie=F=z=null,S=f;do{var Q=S.lane&-536870913,ee=Q!==S.lane;if(ee?(Ye&Q)===Q:(r&Q)===Q){Q!==0&&Q===Li&&(Bo=!0),ie!==null&&(ie=ie.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var Ee=e,Ue=S;Q=t;var ct=n;switch(Ue.tag){case 1:if(Ee=Ue.payload,typeof Ee=="function"){le=Ee.call(ct,le,Q);break e}le=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=Ue.payload,Q=typeof Ee=="function"?Ee.call(ct,le,Q):Ee,Q==null)break e;le=x({},le,Q);break e;case 2:pa=!0}}Q=S.callback,Q!==null&&(e.flags|=64,ee&&(e.flags|=8192),ee=c.callbacks,ee===null?c.callbacks=[Q]:ee.push(Q))}else ee={lane:Q,tag:S.tag,payload:S.payload,callback:S.callback,next:null},ie===null?(F=ie=ee,z=le):ie=ie.next=ee,y|=Q;if(S=S.next,S===null){if(S=c.shared.pending,S===null)break;ee=S,S=ee.next,ee.next=null,c.lastBaseUpdate=ee,c.shared.pending=null}}while(!0);ie===null&&(z=le),c.baseState=z,c.firstBaseUpdate=F,c.lastBaseUpdate=ie,f===null&&(c.shared.lanes=0),ja|=y,e.lanes=y,e.memoizedState=le}}function Md(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function qd(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Md(n[e],t)}var Hi=w(null),$s=w(0);function Id(e,t){e=aa,V($s,e),V(Hi,t),aa=e|t.baseLanes}function Lo(){V($s,aa),V(Hi,Hi.current)}function Mo(){aa=$s.current,O(Hi),O($s)}var rn=w(null),vn=null;function va(e){var t=e.alternate;V(jt,jt.current&1),V(rn,e),vn===null&&(t===null||Hi.current!==null||t.memoizedState!==null)&&(vn=e)}function qo(e){V(jt,jt.current),V(rn,e),vn===null&&(vn=e)}function Hd(e){e.tag===22?(V(jt,jt.current),V(rn,e),vn===null&&(vn=e)):ba()}function ba(){V(jt,jt.current),V(rn,rn.current)}function sn(e){O(rn),vn===e&&(vn=null),O(jt)}var jt=w(0);function Ps(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Gc(n)||Kc(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jn=0,Ie=null,lt=null,Tt=null,Vs=!1,$i=!1,ai=!1,Gs=0,Lr=0,Pi=null,ty=0;function xt(){throw Error(l(321))}function Io(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!nn(e[n],t[n]))return!1;return!0}function Ho(e,t,n,r,c,f){return Jn=f,Ie=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,C.H=e===null||e.memoizedState===null?Ef:nc,ai=!1,f=n(r,c),ai=!1,$i&&(f=Pd(t,n,r,c)),$d(e),f}function $d(e){C.H=Ir;var t=lt!==null&&lt.next!==null;if(Jn=0,Tt=lt=Ie=null,Vs=!1,Lr=0,Pi=null,t)throw Error(l(300));e===null||At||(e=e.dependencies,e!==null&&Ds(e)&&(At=!0))}function Pd(e,t,n,r){Ie=e;var c=0;do{if($i&&(Pi=null),Lr=0,$i=!1,25<=c)throw Error(l(301));if(c+=1,Tt=lt=null,e.updateQueue!=null){var f=e.updateQueue;f.lastEffect=null,f.events=null,f.stores=null,f.memoCache!=null&&(f.memoCache.index=0)}C.H=Cf,f=t(n,r)}while($i);return f}function ny(){var e=C.H,t=e.useState()[0];return t=typeof t.then=="function"?Mr(t):t,e=e.useState()[0],(lt!==null?lt.memoizedState:null)!==e&&(Ie.flags|=1024),t}function $o(){var e=Gs!==0;return Gs=0,e}function Po(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Vo(e){if(Vs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Vs=!1}Jn=0,Tt=lt=Ie=null,$i=!1,Lr=Gs=0,Pi=null}function Yt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?Ie.memoizedState=Tt=e:Tt=Tt.next=e,Tt}function St(){if(lt===null){var e=Ie.alternate;e=e!==null?e.memoizedState:null}else e=lt.next;var t=Tt===null?Ie.memoizedState:Tt.next;if(t!==null)Tt=t,lt=e;else{if(e===null)throw Ie.alternate===null?Error(l(467)):Error(l(310));lt=e,e={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Tt===null?Ie.memoizedState=Tt=e:Tt=Tt.next=e}return Tt}function Ks(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mr(e){var t=Lr;return Lr+=1,Pi===null&&(Pi=[]),e=zd(Pi,e,t),t=Ie,(Tt===null?t.memoizedState:Tt.next)===null&&(t=t.alternate,C.H=t===null||t.memoizedState===null?Ef:nc),e}function Fs(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Mr(e);if(e.$$typeof===M)return Lt(e)}throw Error(l(438,String(e)))}function Go(e){var t=null,n=Ie.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var r=Ie.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Ks(),Ie.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=Y;return t.index++,n}function Qn(e,t){return typeof t=="function"?t(e):t}function Ys(e){var t=St();return Ko(t,lt,e)}function Ko(e,t,n){var r=e.queue;if(r===null)throw Error(l(311));r.lastRenderedReducer=n;var c=e.baseQueue,f=r.pending;if(f!==null){if(c!==null){var y=c.next;c.next=f.next,f.next=y}t.baseQueue=c=f,r.pending=null}if(f=e.baseState,c===null)e.memoizedState=f;else{t=c.next;var S=y=null,z=null,F=t,ie=!1;do{var le=F.lane&-536870913;if(le!==F.lane?(Ye&le)===le:(Jn&le)===le){var Q=F.revertLane;if(Q===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),le===Li&&(ie=!0);else if((Jn&Q)===Q){F=F.next,Q===Li&&(ie=!0);continue}else le={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},z===null?(S=z=le,y=f):z=z.next=le,Ie.lanes|=Q,ja|=Q;le=F.action,ai&&n(f,le),f=F.hasEagerState?F.eagerState:n(f,le)}else Q={lane:le,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},z===null?(S=z=Q,y=f):z=z.next=Q,Ie.lanes|=le,ja|=le;F=F.next}while(F!==null&&F!==t);if(z===null?y=f:z.next=S,!nn(f,e.memoizedState)&&(At=!0,ie&&(n=Mi,n!==null)))throw n;e.memoizedState=f,e.baseState=y,e.baseQueue=z,r.lastRenderedState=f}return c===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Fo(e){var t=St(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var r=n.dispatch,c=n.pending,f=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do f=e(f,y.action),y=y.next;while(y!==c);nn(f,t.memoizedState)||(At=!0),t.memoizedState=f,t.baseQueue===null&&(t.baseState=f),n.lastRenderedState=f}return[f,r]}function Vd(e,t,n){var r=Ie,c=St(),f=Xe;if(f){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!nn((lt||c).memoizedState,n);if(y&&(c.memoizedState=n,At=!0),c=c.queue,Qo(Fd.bind(null,r,c,e),[e]),c.getSnapshot!==t||y||Tt!==null&&Tt.memoizedState.tag&1){if(r.flags|=2048,Vi(9,{destroy:void 0},Kd.bind(null,r,c,n,t),null),ut===null)throw Error(l(349));f||(Jn&127)!==0||Gd(r,t,n)}return n}function Gd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ie.updateQueue,t===null?(t=Ks(),Ie.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Kd(e,t,n,r){t.value=n,t.getSnapshot=r,Yd(t)&&Jd(e)}function Fd(e,t,n){return n(function(){Yd(t)&&Jd(e)})}function Yd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!nn(e,n)}catch{return!0}}function Jd(e){var t=Ya(e,2);t!==null&&tn(t,e,2)}function Yo(e){var t=Yt();if(typeof e=="function"){var n=e;if(e=n(),ai){On(!0);try{n()}finally{On(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qn,lastRenderedState:e},t}function Qd(e,t,n,r){return e.baseState=n,Ko(e,lt,typeof r=="function"?r:Qn)}function ay(e,t,n,r,c){if(Xs(e))throw Error(l(485));if(e=t.action,e!==null){var f={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){f.listeners.push(y)}};C.T!==null?n(!0):f.isTransition=!1,r(f),n=t.pending,n===null?(f.next=t.pending=f,Xd(t,f)):(f.next=n.next,t.pending=n.next=f)}}function Xd(e,t){var n=t.action,r=t.payload,c=e.state;if(t.isTransition){var f=C.T,y={};C.T=y;try{var S=n(c,r),z=C.S;z!==null&&z(y,S),Zd(e,t,S)}catch(F){Jo(e,t,F)}finally{f!==null&&y.types!==null&&(f.types=y.types),C.T=f}}else try{f=n(c,r),Zd(e,t,f)}catch(F){Jo(e,t,F)}}function Zd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(r){Wd(e,t,r)},function(r){return Jo(e,t,r)}):Wd(e,t,n)}function Wd(e,t,n){t.status="fulfilled",t.value=n,ef(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Xd(e,n)))}function Jo(e,t,n){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status="rejected",t.reason=n,ef(t),t=t.next;while(t!==r)}e.action=null}function ef(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function tf(e,t){return t}function nf(e,t){if(Xe){var n=ut.formState;if(n!==null){e:{var r=Ie;if(Xe){if(gt){t:{for(var c=gt,f=yn;c.nodeType!==8;){if(!f){c=null;break t}if(c=bn(c.nextSibling),c===null){c=null;break t}}f=c.data,c=f==="F!"||f==="F"?c:null}if(c){gt=bn(c.nextSibling),r=c.data==="F!";break e}}ha(r)}r=!1}r&&(t=n[0])}}return n=Yt(),n.memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tf,lastRenderedState:t},n.queue=r,n=jf.bind(null,Ie,r),r.dispatch=n,r=Yo(!1),f=tc.bind(null,Ie,!1,r.queue),r=Yt(),c={state:t,dispatch:null,action:e,pending:null},r.queue=c,n=ay.bind(null,Ie,c,f,n),c.dispatch=n,r.memoizedState=e,[t,n,!1]}function af(e){var t=St();return rf(t,lt,e)}function rf(e,t,n){if(t=Ko(e,t,tf)[0],e=Ys(Qn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var r=Mr(t)}catch(y){throw y===qi?Ms:y}else r=t;t=St();var c=t.queue,f=c.dispatch;return n!==t.memoizedState&&(Ie.flags|=2048,Vi(9,{destroy:void 0},iy.bind(null,c,n),null)),[r,f,e]}function iy(e,t){e.action=t}function sf(e){var t=St(),n=lt;if(n!==null)return rf(t,n,e);St(),t=t.memoizedState,n=St();var r=n.queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Vi(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},t=Ie.updateQueue,t===null&&(t=Ks(),Ie.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function lf(){return St().memoizedState}function Js(e,t,n,r){var c=Yt();Ie.flags|=e,c.memoizedState=Vi(1|t,{destroy:void 0},n,r===void 0?null:r)}function Qs(e,t,n,r){var c=St();r=r===void 0?null:r;var f=c.memoizedState.inst;lt!==null&&r!==null&&Io(r,lt.memoizedState.deps)?c.memoizedState=Vi(t,f,n,r):(Ie.flags|=e,c.memoizedState=Vi(1|t,f,n,r))}function of(e,t){Js(8390656,8,e,t)}function Qo(e,t){Qs(2048,8,e,t)}function ry(e){Ie.flags|=4;var t=Ie.updateQueue;if(t===null)t=Ks(),Ie.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function cf(e){var t=St().memoizedState;return ry({ref:t,nextImpl:e}),function(){if((nt&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function uf(e,t){return Qs(4,2,e,t)}function df(e,t){return Qs(4,4,e,t)}function ff(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hf(e,t,n){n=n!=null?n.concat([e]):null,Qs(4,4,ff.bind(null,t,e),n)}function Xo(){}function gf(e,t){var n=St();t=t===void 0?null:t;var r=n.memoizedState;return t!==null&&Io(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function pf(e,t){var n=St();t=t===void 0?null:t;var r=n.memoizedState;if(t!==null&&Io(t,r[1]))return r[0];if(r=e(),ai){On(!0);try{e()}finally{On(!1)}}return n.memoizedState=[r,t],r}function Zo(e,t,n){return n===void 0||(Jn&1073741824)!==0&&(Ye&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=mh(),Ie.lanes|=e,ja|=e,n)}function mf(e,t,n,r){return nn(n,t)?n:Hi.current!==null?(e=Zo(e,n,r),nn(e,t)||(At=!0),e):(Jn&42)===0||(Jn&1073741824)!==0&&(Ye&261930)===0?(At=!0,e.memoizedState=n):(e=mh(),Ie.lanes|=e,ja|=e,t)}function yf(e,t,n,r,c){var f=U.p;U.p=f!==0&&8>f?f:8;var y=C.T,S={};C.T=S,tc(e,!1,t,n);try{var z=c(),F=C.S;if(F!==null&&F(S,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var ie=ey(z,r);qr(e,t,ie,cn(e))}else qr(e,t,r,cn(e))}catch(le){qr(e,t,{then:function(){},status:"rejected",reason:le},cn())}finally{U.p=f,y!==null&&S.types!==null&&(y.types=S.types),C.T=y}}function sy(){}function Wo(e,t,n,r){if(e.tag!==5)throw Error(l(476));var c=vf(e).queue;yf(e,c,t,W,n===null?sy:function(){return bf(e),n(r)})}function vf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qn,lastRenderedState:W},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function bf(e){var t=vf(e);t.next===null&&(t=e.alternate.memoizedState),qr(e,t.next.queue,{},cn())}function ec(){return Lt(ns)}function xf(){return St().memoizedState}function _f(){return St().memoizedState}function ly(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=cn();e=ma(n);var r=ya(t,e,n);r!==null&&(tn(r,t,n),Ur(r,t,n)),t={cache:No()},e.payload=t;return}t=t.return}}function oy(e,t,n){var r=cn();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Xs(e)?Sf(t,n):(n=vo(e,t,n,r),n!==null&&(tn(n,e,r),wf(n,t,r)))}function jf(e,t,n){var r=cn();qr(e,t,n,r)}function qr(e,t,n,r){var c={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xs(e))Sf(t,c);else{var f=e.alternate;if(e.lanes===0&&(f===null||f.lanes===0)&&(f=t.lastRenderedReducer,f!==null))try{var y=t.lastRenderedState,S=f(y,n);if(c.hasEagerState=!0,c.eagerState=S,nn(S,y))return Os(e,t,c,0),ut===null&&Rs(),!1}catch{}finally{}if(n=vo(e,t,c,r),n!==null)return tn(n,e,r),wf(n,t,r),!0}return!1}function tc(e,t,n,r){if(r={lane:2,revertLane:zc(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Xs(e)){if(t)throw Error(l(479))}else t=vo(e,n,r,2),t!==null&&tn(t,e,2)}function Xs(e){var t=e.alternate;return e===Ie||t!==null&&t===Ie}function Sf(e,t){$i=Vs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function wf(e,t,n){if((n&4194048)!==0){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,vs(e,n)}}var Ir={readContext:Lt,use:Fs,useCallback:xt,useContext:xt,useEffect:xt,useImperativeHandle:xt,useLayoutEffect:xt,useInsertionEffect:xt,useMemo:xt,useReducer:xt,useRef:xt,useState:xt,useDebugValue:xt,useDeferredValue:xt,useTransition:xt,useSyncExternalStore:xt,useId:xt,useHostTransitionStatus:xt,useFormState:xt,useActionState:xt,useOptimistic:xt,useMemoCache:xt,useCacheRefresh:xt};Ir.useEffectEvent=xt;var Ef={readContext:Lt,use:Fs,useCallback:function(e,t){return Yt().memoizedState=[e,t===void 0?null:t],e},useContext:Lt,useEffect:of,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Js(4194308,4,ff.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Js(4194308,4,e,t)},useInsertionEffect:function(e,t){Js(4,2,e,t)},useMemo:function(e,t){var n=Yt();t=t===void 0?null:t;var r=e();if(ai){On(!0);try{e()}finally{On(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Yt();if(n!==void 0){var c=n(t);if(ai){On(!0);try{n(t)}finally{On(!1)}}}else c=t;return r.memoizedState=r.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},r.queue=e,e=e.dispatch=oy.bind(null,Ie,e),[r.memoizedState,e]},useRef:function(e){var t=Yt();return e={current:e},t.memoizedState=e},useState:function(e){e=Yo(e);var t=e.queue,n=jf.bind(null,Ie,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Xo,useDeferredValue:function(e,t){var n=Yt();return Zo(n,e,t)},useTransition:function(){var e=Yo(!1);return e=yf.bind(null,Ie,e.queue,!0,!1),Yt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ie,c=Yt();if(Xe){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),ut===null)throw Error(l(349));(Ye&127)!==0||Gd(r,t,n)}c.memoizedState=n;var f={value:n,getSnapshot:t};return c.queue=f,of(Fd.bind(null,r,f,e),[e]),r.flags|=2048,Vi(9,{destroy:void 0},Kd.bind(null,r,f,n,t),null),n},useId:function(){var e=Yt(),t=ut.identifierPrefix;if(Xe){var n=Mn,r=Ln;n=(r&~(1<<32-Ft(r)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Gs++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=ty++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:ec,useFormState:nf,useActionState:nf,useOptimistic:function(e){var t=Yt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=tc.bind(null,Ie,!0,n),n.dispatch=t,[e,t]},useMemoCache:Go,useCacheRefresh:function(){return Yt().memoizedState=ly.bind(null,Ie)},useEffectEvent:function(e){var t=Yt(),n={impl:e};return t.memoizedState=n,function(){if((nt&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},nc={readContext:Lt,use:Fs,useCallback:gf,useContext:Lt,useEffect:Qo,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:df,useMemo:pf,useReducer:Ys,useRef:lf,useState:function(){return Ys(Qn)},useDebugValue:Xo,useDeferredValue:function(e,t){var n=St();return mf(n,lt.memoizedState,e,t)},useTransition:function(){var e=Ys(Qn)[0],t=St().memoizedState;return[typeof e=="boolean"?e:Mr(e),t]},useSyncExternalStore:Vd,useId:xf,useHostTransitionStatus:ec,useFormState:af,useActionState:af,useOptimistic:function(e,t){var n=St();return Qd(n,lt,e,t)},useMemoCache:Go,useCacheRefresh:_f};nc.useEffectEvent=cf;var Cf={readContext:Lt,use:Fs,useCallback:gf,useContext:Lt,useEffect:Qo,useImperativeHandle:hf,useInsertionEffect:uf,useLayoutEffect:df,useMemo:pf,useReducer:Fo,useRef:lf,useState:function(){return Fo(Qn)},useDebugValue:Xo,useDeferredValue:function(e,t){var n=St();return lt===null?Zo(n,e,t):mf(n,lt.memoizedState,e,t)},useTransition:function(){var e=Fo(Qn)[0],t=St().memoizedState;return[typeof e=="boolean"?e:Mr(e),t]},useSyncExternalStore:Vd,useId:xf,useHostTransitionStatus:ec,useFormState:sf,useActionState:sf,useOptimistic:function(e,t){var n=St();return lt!==null?Qd(n,lt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Go,useCacheRefresh:_f};Cf.useEffectEvent=cf;function ac(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:x({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ic={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cn(),c=ma(r);c.payload=t,n!=null&&(c.callback=n),t=ya(e,c,r),t!==null&&(tn(t,e,r),Ur(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cn(),c=ma(r);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=ya(e,c,r),t!==null&&(tn(t,e,r),Ur(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cn(),r=ma(n);r.tag=2,t!=null&&(r.callback=t),t=ya(e,r,n),t!==null&&(tn(t,e,n),Ur(t,e,n))}};function Tf(e,t,n,r,c,f,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,f,y):t.prototype&&t.prototype.isPureReactComponent?!Cr(n,r)||!Cr(c,f):!0}function Af(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ic.enqueueReplaceState(t,t.state,null)}function ii(e,t){var n=t;if("ref"in t){n={};for(var r in t)r!=="ref"&&(n[r]=t[r])}if(e=e.defaultProps){n===t&&(n=x({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Nf(e){Ns(e)}function Rf(e){console.error(e)}function Of(e){Ns(e)}function Zs(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(r){setTimeout(function(){throw r})}}function kf(e,t,n){try{var r=e.onCaughtError;r(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function rc(e,t,n){return n=ma(n),n.tag=3,n.payload={element:null},n.callback=function(){Zs(e,t)},n}function zf(e){return e=ma(e),e.tag=3,e}function Uf(e,t,n,r){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var f=r.value;e.payload=function(){return c(f)},e.callback=function(){kf(t,n,r)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){kf(t,n,r),typeof c!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})})}function cy(e,t,n,r,c){if(n.flags|=32768,r!==null&&typeof r=="object"&&typeof r.then=="function"){if(t=n.alternate,t!==null&&Bi(t,n,c,!0),n=rn.current,n!==null){switch(n.tag){case 31:case 13:return vn===null?ul():n.alternate===null&&_t===0&&(_t=3),n.flags&=-257,n.flags|=65536,n.lanes=c,r===qs?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([r]):t.add(r),Rc(e,r,c)),!1;case 22:return n.flags|=65536,r===qs?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([r]):n.add(r)),Rc(e,r,c)),!1}throw Error(l(435,n.tag))}return Rc(e,r,c),ul(),!1}if(Xe)return t=rn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,r!==wo&&(e=Error(l(422),{cause:r}),Nr(gn(e,n)))):(r!==wo&&(t=Error(l(423),{cause:r}),Nr(gn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,r=gn(r,n),c=rc(e.stateNode,r,c),Do(e,c),_t!==4&&(_t=2)),!1;var f=Error(l(520),{cause:r});if(f=gn(f,n),Yr===null?Yr=[f]:Yr.push(f),_t!==4&&(_t=2),t===null)return!0;r=gn(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=rc(n.stateNode,r,e),Do(n,e),!1;case 1:if(t=n.type,f=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Sa===null||!Sa.has(f))))return n.flags|=65536,c&=-c,n.lanes|=c,c=zf(c),Uf(c,e,n,r),Do(n,c),!1}n=n.return}while(n!==null);return!1}var sc=Error(l(461)),At=!1;function Mt(e,t,n,r){t.child=e===null?Ld(t,null,n,r):ni(t,e.child,n,r)}function Df(e,t,n,r,c){n=n.render;var f=t.ref;if("ref"in r){var y={};for(var S in r)S!=="ref"&&(y[S]=r[S])}else y=r;return Za(t),r=Ho(e,t,n,y,f,c),S=$o(),e!==null&&!At?(Po(e,t,c),Xn(e,t,c)):(Xe&&S&&jo(t),t.flags|=1,Mt(e,t,r,c),t.child)}function Bf(e,t,n,r,c){if(e===null){var f=n.type;return typeof f=="function"&&!bo(f)&&f.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=f,Lf(e,t,f,r,c)):(e=zs(n.type,null,r,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(f=e.child,!gc(e,c)){var y=f.memoizedProps;if(n=n.compare,n=n!==null?n:Cr,n(y,r)&&e.ref===t.ref)return Xn(e,t,c)}return t.flags|=1,e=Gn(f,r),e.ref=t.ref,e.return=t,t.child=e}function Lf(e,t,n,r,c){if(e!==null){var f=e.memoizedProps;if(Cr(f,r)&&e.ref===t.ref)if(At=!1,t.pendingProps=r=f,gc(e,c))(e.flags&131072)!==0&&(At=!0);else return t.lanes=e.lanes,Xn(e,t,c)}return lc(e,t,n,r,c)}function Mf(e,t,n,r){var c=r.children,f=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode==="hidden"){if((t.flags&128)!==0){if(f=f!==null?f.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;r=c&~f}else r=0,t.child=null;return qf(e,t,f,n,r)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ls(t,f!==null?f.cachePool:null),f!==null?Id(t,f):Lo(),Hd(t);else return r=t.lanes=536870912,qf(e,t,f!==null?f.baseLanes|n:n,n,r)}else f!==null?(Ls(t,f.cachePool),Id(t,f),ba(),t.memoizedState=null):(e!==null&&Ls(t,null),Lo(),ba());return Mt(e,t,c,n),t.child}function Hr(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function qf(e,t,n,r,c){var f=Oo();return f=f===null?null:{parent:Ct._currentValue,pool:f},t.memoizedState={baseLanes:n,cachePool:f},e!==null&&Ls(t,null),Lo(),Hd(t),e!==null&&Bi(e,t,r,!0),t.childLanes=c,null}function Ws(e,t){return t=tl({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function If(e,t,n){return ni(t,e.child,null,n),e=Ws(t,t.pendingProps),e.flags|=2,sn(t),t.memoizedState=null,e}function uy(e,t,n){var r=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Xe){if(r.mode==="hidden")return e=Ws(t,r),t.lanes=536870912,Hr(null,e);if(qo(t),(e=gt)?(e=Zh(e,yn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:da!==null?{id:Ln,overflow:Mn}:null,retryLane:536870912,hydrationErrors:null},n=jd(e),n.return=t,t.child=n,Bt=t,gt=null)):e=null,e===null)throw ha(t);return t.lanes=536870912,null}return Ws(t,r)}var f=e.memoizedState;if(f!==null){var y=f.dehydrated;if(qo(t),c)if(t.flags&256)t.flags&=-257,t=If(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(At||Bi(e,t,n,!1),c=(n&e.childLanes)!==0,At||c){if(r=ut,r!==null&&(y=wi(r,n),y!==0&&y!==f.retryLane))throw f.retryLane=y,Ya(e,y),tn(r,e,y),sc;ul(),t=If(e,t,n)}else e=f.treeContext,gt=bn(y.nextSibling),Bt=t,Xe=!0,fa=null,yn=!1,e!==null&&Ed(t,e),t=Ws(t,r),t.flags|=4096;return t}return e=Gn(e.child,{mode:r.mode,children:r.children}),e.ref=t.ref,t.child=e,e.return=t,e}function el(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function lc(e,t,n,r,c){return Za(t),n=Ho(e,t,n,r,void 0,c),r=$o(),e!==null&&!At?(Po(e,t,c),Xn(e,t,c)):(Xe&&r&&jo(t),t.flags|=1,Mt(e,t,n,c),t.child)}function Hf(e,t,n,r,c,f){return Za(t),t.updateQueue=null,n=Pd(t,r,n,c),$d(e),r=$o(),e!==null&&!At?(Po(e,t,f),Xn(e,t,f)):(Xe&&r&&jo(t),t.flags|=1,Mt(e,t,n,f),t.child)}function $f(e,t,n,r,c){if(Za(t),t.stateNode===null){var f=ki,y=n.contextType;typeof y=="object"&&y!==null&&(f=Lt(y)),f=new n(r,f),t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,f.updater=ic,t.stateNode=f,f._reactInternals=t,f=t.stateNode,f.props=r,f.state=t.memoizedState,f.refs={},zo(t),y=n.contextType,f.context=typeof y=="object"&&y!==null?Lt(y):ki,f.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(ac(t,n,y,r),f.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(y=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),y!==f.state&&ic.enqueueReplaceState(f,f.state,null),Br(t,r,f,c),Dr(),f.state=t.memoizedState),typeof f.componentDidMount=="function"&&(t.flags|=4194308),r=!0}else if(e===null){f=t.stateNode;var S=t.memoizedProps,z=ii(n,S);f.props=z;var F=f.context,ie=n.contextType;y=ki,typeof ie=="object"&&ie!==null&&(y=Lt(ie));var le=n.getDerivedStateFromProps;ie=typeof le=="function"||typeof f.getSnapshotBeforeUpdate=="function",S=t.pendingProps!==S,ie||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(S||F!==y)&&Af(t,f,r,y),pa=!1;var Q=t.memoizedState;f.state=Q,Br(t,r,f,c),Dr(),F=t.memoizedState,S||Q!==F||pa?(typeof le=="function"&&(ac(t,n,le,r),F=t.memoizedState),(z=pa||Tf(t,n,z,r,Q,F,y))?(ie||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(t.flags|=4194308)):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=F),f.props=r,f.state=F,f.context=y,r=z):(typeof f.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{f=t.stateNode,Uo(e,t),y=t.memoizedProps,ie=ii(n,y),f.props=ie,le=t.pendingProps,Q=f.context,F=n.contextType,z=ki,typeof F=="object"&&F!==null&&(z=Lt(F)),S=n.getDerivedStateFromProps,(F=typeof S=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==le||Q!==z)&&Af(t,f,r,z),pa=!1,Q=t.memoizedState,f.state=Q,Br(t,r,f,c),Dr();var ee=t.memoizedState;y!==le||Q!==ee||pa||e!==null&&e.dependencies!==null&&Ds(e.dependencies)?(typeof S=="function"&&(ac(t,n,S,r),ee=t.memoizedState),(ie=pa||Tf(t,n,ie,r,Q,ee,z)||e!==null&&e.dependencies!==null&&Ds(e.dependencies))?(F||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(r,ee,z),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(r,ee,z)),typeof f.componentDidUpdate=="function"&&(t.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=ee),f.props=r,f.state=ee,f.context=z,r=ie):(typeof f.componentDidUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Q===e.memoizedState||(t.flags|=1024),r=!1)}return f=r,el(e,t),r=(t.flags&128)!==0,f||r?(f=t.stateNode,n=r&&typeof n.getDerivedStateFromError!="function"?null:f.render(),t.flags|=1,e!==null&&r?(t.child=ni(t,e.child,null,c),t.child=ni(t,null,n,c)):Mt(e,t,n,c),t.memoizedState=f.state,e=t.child):e=Xn(e,t,c),e}function Pf(e,t,n,r){return Qa(),t.flags|=256,Mt(e,t,n,r),t.child}var oc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cc(e){return{baseLanes:e,cachePool:Od()}}function uc(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=on),e}function Vf(e,t,n){var r=t.pendingProps,c=!1,f=(t.flags&128)!==0,y;if((y=f)||(y=e!==null&&e.memoizedState===null?!1:(jt.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Xe){if(c?va(t):ba(),(e=gt)?(e=Zh(e,yn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:da!==null?{id:Ln,overflow:Mn}:null,retryLane:536870912,hydrationErrors:null},n=jd(e),n.return=t,t.child=n,Bt=t,gt=null)):e=null,e===null)throw ha(t);return Kc(e)?t.lanes=32:t.lanes=536870912,null}var S=r.children;return r=r.fallback,c?(ba(),c=t.mode,S=tl({mode:"hidden",children:S},c),r=Ja(r,c,n,null),S.return=t,r.return=t,S.sibling=r,t.child=S,r=t.child,r.memoizedState=cc(n),r.childLanes=uc(e,y,n),t.memoizedState=oc,Hr(null,r)):(va(t),dc(t,S))}var z=e.memoizedState;if(z!==null&&(S=z.dehydrated,S!==null)){if(f)t.flags&256?(va(t),t.flags&=-257,t=fc(e,t,n)):t.memoizedState!==null?(ba(),t.child=e.child,t.flags|=128,t=null):(ba(),S=r.fallback,c=t.mode,r=tl({mode:"visible",children:r.children},c),S=Ja(S,c,n,null),S.flags|=2,r.return=t,S.return=t,r.sibling=S,t.child=r,ni(t,e.child,null,n),r=t.child,r.memoizedState=cc(n),r.childLanes=uc(e,y,n),t.memoizedState=oc,t=Hr(null,r));else if(va(t),Kc(S)){if(y=S.nextSibling&&S.nextSibling.dataset,y)var F=y.dgst;y=F,r=Error(l(419)),r.stack="",r.digest=y,Nr({value:r,source:null,stack:null}),t=fc(e,t,n)}else if(At||Bi(e,t,n,!1),y=(n&e.childLanes)!==0,At||y){if(y=ut,y!==null&&(r=wi(y,n),r!==0&&r!==z.retryLane))throw z.retryLane=r,Ya(e,r),tn(y,e,r),sc;Gc(S)||ul(),t=fc(e,t,n)}else Gc(S)?(t.flags|=192,t.child=e.child,t=null):(e=z.treeContext,gt=bn(S.nextSibling),Bt=t,Xe=!0,fa=null,yn=!1,e!==null&&Ed(t,e),t=dc(t,r.children),t.flags|=4096);return t}return c?(ba(),S=r.fallback,c=t.mode,z=e.child,F=z.sibling,r=Gn(z,{mode:"hidden",children:r.children}),r.subtreeFlags=z.subtreeFlags&65011712,F!==null?S=Gn(F,S):(S=Ja(S,c,n,null),S.flags|=2),S.return=t,r.return=t,r.sibling=S,t.child=r,Hr(null,r),r=t.child,S=e.child.memoizedState,S===null?S=cc(n):(c=S.cachePool,c!==null?(z=Ct._currentValue,c=c.parent!==z?{parent:z,pool:z}:c):c=Od(),S={baseLanes:S.baseLanes|n,cachePool:c}),r.memoizedState=S,r.childLanes=uc(e,y,n),t.memoizedState=oc,Hr(e.child,r)):(va(t),n=e.child,e=n.sibling,n=Gn(n,{mode:"visible",children:r.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function dc(e,t){return t=tl({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function tl(e,t){return e=an(22,e,null,t),e.lanes=0,e}function fc(e,t,n){return ni(t,e.child,null,n),e=dc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Gf(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),To(e.return,t,n)}function hc(e,t,n,r,c,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:c,treeForkCount:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=r,y.tail=n,y.tailMode=c,y.treeForkCount=f)}function Kf(e,t,n){var r=t.pendingProps,c=r.revealOrder,f=r.tail;r=r.children;var y=jt.current,S=(y&2)!==0;if(S?(y=y&1|2,t.flags|=128):y&=1,V(jt,y),Mt(e,t,r,n),r=Xe?Ar:0,!S&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Gf(e,n,t);else if(e.tag===19)Gf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Ps(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),hc(t,!1,c,n,f,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Ps(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}hc(t,!0,n,null,f,r);break;case"together":hc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function Xn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ja|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Bi(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Gn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Gn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function gc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Ds(e)))}function dy(e,t,n){switch(t.tag){case 3:ne(t,t.stateNode.containerInfo),ga(t,Ct,e.memoizedState.cache),Qa();break;case 27:case 5:Se(t);break;case 4:ne(t,t.stateNode.containerInfo);break;case 10:ga(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,qo(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated!==null?(va(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Vf(e,t,n):(va(t),e=Xn(e,t,n),e!==null?e.sibling:null);va(t);break;case 19:var c=(e.flags&128)!==0;if(r=(n&t.childLanes)!==0,r||(Bi(e,t,n,!1),r=(n&t.childLanes)!==0),c){if(r)return Kf(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),V(jt,jt.current),r)break;return null;case 22:return t.lanes=0,Mf(e,t,n,t.pendingProps);case 24:ga(t,Ct,e.memoizedState.cache)}return Xn(e,t,n)}function Ff(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)At=!0;else{if(!gc(e,n)&&(t.flags&128)===0)return At=!1,dy(e,t,n);At=(e.flags&131072)!==0}else At=!1,Xe&&(t.flags&1048576)!==0&&wd(t,Ar,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ei(t.elementType),t.type=e,typeof e=="function")bo(e)?(r=ii(e,r),t.tag=1,t=$f(null,t,e,r,n)):(t.tag=0,t=lc(null,t,e,r,n));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=Df(null,t,e,r,n);break e}else if(c===D){t.tag=14,t=Bf(null,t,e,r,n);break e}}throw t=te(e)||e,Error(l(306,t,""))}}return t;case 0:return lc(e,t,t.type,t.pendingProps,n);case 1:return r=t.type,c=ii(r,t.pendingProps),$f(e,t,r,c,n);case 3:e:{if(ne(t,t.stateNode.containerInfo),e===null)throw Error(l(387));r=t.pendingProps;var f=t.memoizedState;c=f.element,Uo(e,t),Br(t,r,null,n);var y=t.memoizedState;if(r=y.cache,ga(t,Ct,r),r!==f.cache&&Ao(t,[Ct],n,!0),Dr(),r=y.element,f.isDehydrated)if(f={element:r,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=f,t.memoizedState=f,t.flags&256){t=Pf(e,t,r,n);break e}else if(r!==c){c=gn(Error(l(424)),t),Nr(c),t=Pf(e,t,r,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(gt=bn(e.firstChild),Bt=t,Xe=!0,fa=null,yn=!0,n=Ld(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Qa(),r===c){t=Xn(e,t,n);break e}Mt(e,t,r,n)}t=t.child}return t;case 26:return el(e,t),e===null?(n=ig(t.type,null,t.pendingProps,null))?t.memoizedState=n:Xe||(n=t.type,e=t.pendingProps,r=yl(de.current).createElement(n),r[Et]=t,r[$t]=e,qt(r,n,e),Z(r),t.stateNode=r):t.memoizedState=ig(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Se(t),e===null&&Xe&&(r=t.stateNode=tg(t.type,t.pendingProps,de.current),Bt=t,yn=!0,c=gt,Ta(t.type)?(Fc=c,gt=bn(r.firstChild)):gt=c),Mt(e,t,t.pendingProps.children,n),el(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Xe&&((c=r=gt)&&(r=Hy(r,t.type,t.pendingProps,yn),r!==null?(t.stateNode=r,Bt=t,gt=bn(r.firstChild),yn=!1,c=!0):c=!1),c||ha(t)),Se(t),c=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,r=f.children,$c(c,f)?r=null:y!==null&&$c(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Ho(e,t,ny,null,null,n),ns._currentValue=c),el(e,t),Mt(e,t,r,n),t.child;case 6:return e===null&&Xe&&((e=n=gt)&&(n=$y(n,t.pendingProps,yn),n!==null?(t.stateNode=n,Bt=t,gt=null,e=!0):e=!1),e||ha(t)),null;case 13:return Vf(e,t,n);case 4:return ne(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ni(t,null,r,n):Mt(e,t,r,n),t.child;case 11:return Df(e,t,t.type,t.pendingProps,n);case 7:return Mt(e,t,t.pendingProps,n),t.child;case 8:return Mt(e,t,t.pendingProps.children,n),t.child;case 12:return Mt(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,ga(t,t.type,r.value),Mt(e,t,r.children,n),t.child;case 9:return c=t.type._context,r=t.pendingProps.children,Za(t),c=Lt(c),r=r(c),t.flags|=1,Mt(e,t,r,n),t.child;case 14:return Bf(e,t,t.type,t.pendingProps,n);case 15:return Lf(e,t,t.type,t.pendingProps,n);case 19:return Kf(e,t,n);case 31:return uy(e,t,n);case 22:return Mf(e,t,n,t.pendingProps);case 24:return Za(t),r=Lt(Ct),e===null?(c=Oo(),c===null&&(c=ut,f=No(),c.pooledCache=f,f.refCount++,f!==null&&(c.pooledCacheLanes|=n),c=f),t.memoizedState={parent:r,cache:c},zo(t),ga(t,Ct,c)):((e.lanes&n)!==0&&(Uo(e,t),Br(t,null,null,n),Dr()),c=e.memoizedState,f=t.memoizedState,c.parent!==r?(c={parent:r,cache:r},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),ga(t,Ct,r)):(r=f.cache,ga(t,Ct,r),r!==c.cache&&Ao(t,[Ct],n,!0))),Mt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Zn(e){e.flags|=4}function pc(e,t,n,r,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(xh())e.flags|=8192;else throw ti=qs,ko}else e.flags&=-16777217}function Yf(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!cg(t))if(xh())e.flags|=8192;else throw ti=qs,ko}function nl(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?zn():536870912,e.lanes|=t,Yi|=t)}function $r(e,t){if(!Xe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function pt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags&65011712,r|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,r|=c.subtreeFlags,r|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function fy(e,t,n){var r=t.pendingProps;switch(So(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(t),null;case 1:return pt(t),null;case 3:return n=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Yn(Ct),me(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Di(t)?Zn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Eo())),pt(t),null;case 26:var c=t.type,f=t.memoizedState;return e===null?(Zn(t),f!==null?(pt(t),Yf(t,f)):(pt(t),pc(t,c,null,r,n))):f?f!==e.memoizedState?(Zn(t),pt(t),Yf(t,f)):(pt(t),t.flags&=-16777217):(e=e.memoizedProps,e!==r&&Zn(t),pt(t),pc(t,c,e,r,n)),null;case 27:if(Ae(t),n=de.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Zn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return pt(t),null}e=J.current,Di(t)?Cd(t):(e=tg(c,r,n),t.stateNode=e,Zn(t))}return pt(t),null;case 5:if(Ae(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Zn(t);else{if(!r){if(t.stateNode===null)throw Error(l(166));return pt(t),null}if(f=J.current,Di(t))Cd(t);else{var y=yl(de.current);switch(f){case 1:f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":f=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":f=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":f=y.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof r.is=="string"?y.createElement("select",{is:r.is}):y.createElement("select"),r.multiple?f.multiple=!0:r.size&&(f.size=r.size);break;default:f=typeof r.is=="string"?y.createElement(c,{is:r.is}):y.createElement(c)}}f[Et]=t,f[$t]=r;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)f.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=f;e:switch(qt(f,c,r),c){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Zn(t)}}return pt(t),pc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&Zn(t);else{if(typeof r!="string"&&t.stateNode===null)throw Error(l(166));if(e=de.current,Di(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,c=Bt,c!==null)switch(c.tag){case 27:case 5:r=c.memoizedProps}e[Et]=t,e=!!(e.nodeValue===n||r!==null&&r.suppressHydrationWarning===!0||Vh(e.nodeValue,n)),e||ha(t,!0)}else e=yl(e).createTextNode(r),e[Et]=t,t.stateNode=e}return pt(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(r=Di(t),n!==null){if(e===null){if(!r)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[Et]=t}else Qa(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;pt(t),e=!1}else n=Eo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(sn(t),t):(sn(t),null);if((t.flags&128)!==0)throw Error(l(558))}return pt(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Di(t),r!==null&&r.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[Et]=t}else Qa(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;pt(t),c=!1}else c=Eo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(sn(t),t):(sn(t),null)}return sn(t),(t.flags&128)!==0?(t.lanes=n,t):(n=r!==null,e=e!==null&&e.memoizedState!==null,n&&(r=t.child,c=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(c=r.alternate.memoizedState.cachePool.pool),f=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),f!==c&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),nl(t,t.updateQueue),pt(t),null);case 4:return me(),e===null&&Lc(t.stateNode.containerInfo),pt(t),null;case 10:return Yn(t.type),pt(t),null;case 19:if(O(jt),r=t.memoizedState,r===null)return pt(t),null;if(c=(t.flags&128)!==0,f=r.rendering,f===null)if(c)$r(r,!1);else{if(_t!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(f=Ps(e),f!==null){for(t.flags|=128,$r(r,!1),e=f.updateQueue,t.updateQueue=e,nl(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)_d(n,e),n=n.sibling;return V(jt,jt.current&1|2),Xe&&Kn(t,r.treeForkCount),t.child}e=e.sibling}r.tail!==null&&Gt()>ll&&(t.flags|=128,c=!0,$r(r,!1),t.lanes=4194304)}else{if(!c)if(e=Ps(f),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,nl(t,e),$r(r,!0),r.tail===null&&r.tailMode==="hidden"&&!f.alternate&&!Xe)return pt(t),null}else 2*Gt()-r.renderingStartTime>ll&&n!==536870912&&(t.flags|=128,c=!0,$r(r,!1),t.lanes=4194304);r.isBackwards?(f.sibling=t.child,t.child=f):(e=r.last,e!==null?e.sibling=f:t.child=f,r.last=f)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Gt(),e.sibling=null,n=jt.current,V(jt,c?n&1|2:n&1),Xe&&Kn(t,r.treeForkCount),e):(pt(t),null);case 22:case 23:return sn(t),Mo(),r=t.memoizedState!==null,e!==null?e.memoizedState!==null!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?(n&536870912)!==0&&(t.flags&128)===0&&(pt(t),t.subtreeFlags&6&&(t.flags|=8192)):pt(t),n=t.updateQueue,n!==null&&nl(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),e!==null&&O(Wa),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Yn(Ct),pt(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function hy(e,t){switch(So(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Yn(Ct),me(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ae(t),null;case 31:if(t.memoizedState!==null){if(sn(t),t.alternate===null)throw Error(l(340));Qa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(sn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));Qa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return O(jt),null;case 4:return me(),null;case 10:return Yn(t.type),null;case 22:case 23:return sn(t),Mo(),e!==null&&O(Wa),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Yn(Ct),null;case 25:return null;default:return null}}function Jf(e,t){switch(So(t),t.tag){case 3:Yn(Ct),me();break;case 26:case 27:case 5:Ae(t);break;case 4:me();break;case 31:t.memoizedState!==null&&sn(t);break;case 13:sn(t);break;case 19:O(jt);break;case 10:Yn(t.type);break;case 22:case 23:sn(t),Mo(),e!==null&&O(Wa);break;case 24:Yn(Ct)}}function Pr(e,t){try{var n=t.updateQueue,r=n!==null?n.lastEffect:null;if(r!==null){var c=r.next;n=c;do{if((n.tag&e)===e){r=void 0;var f=n.create,y=n.inst;r=f(),y.destroy=r}n=n.next}while(n!==c)}}catch(S){st(t,t.return,S)}}function xa(e,t,n){try{var r=t.updateQueue,c=r!==null?r.lastEffect:null;if(c!==null){var f=c.next;r=f;do{if((r.tag&e)===e){var y=r.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,c=t;var z=n,F=S;try{F()}catch(ie){st(c,z,ie)}}}r=r.next}while(r!==f)}}catch(ie){st(t,t.return,ie)}}function Qf(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{qd(t,n)}catch(r){st(e,e.return,r)}}}function Xf(e,t,n){n.props=ii(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){st(e,t,r)}}function Vr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof n=="function"?e.refCleanup=n(r):n.current=r}}catch(c){st(e,t,c)}}function qn(e,t){var n=e.ref,r=e.refCleanup;if(n!==null)if(typeof r=="function")try{r()}catch(c){st(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){st(e,t,c)}else n.current=null}function Zf(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(c){st(e,e.return,c)}}function mc(e,t,n){try{var r=e.stateNode;Dy(r,e.type,n,t),r[$t]=t}catch(c){st(e,e.return,c)}}function Wf(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Ta(e.type)||e.tag===4}function yc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Wf(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Ta(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function vc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Pn));else if(r!==4&&(r===27&&Ta(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(vc(e,t,n),e=e.sibling;e!==null;)vc(e,t,n),e=e.sibling}function al(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(r===27&&Ta(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(al(e,t,n),e=e.sibling;e!==null;)al(e,t,n),e=e.sibling}function eh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);qt(t,r,n),t[Et]=e,t[$t]=n}catch(f){st(e,e.return,f)}}var Wn=!1,Nt=!1,bc=!1,th=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function gy(e,t){if(e=e.containerInfo,Ic=wl,e=fd(e),fo(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var c=r.anchorOffset,f=r.focusNode;r=r.focusOffset;try{n.nodeType,f.nodeType}catch{n=null;break e}var y=0,S=-1,z=-1,F=0,ie=0,le=e,Q=null;t:for(;;){for(var ee;le!==n||c!==0&&le.nodeType!==3||(S=y+c),le!==f||r!==0&&le.nodeType!==3||(z=y+r),le.nodeType===3&&(y+=le.nodeValue.length),(ee=le.firstChild)!==null;)Q=le,le=ee;for(;;){if(le===e)break t;if(Q===n&&++F===c&&(S=y),Q===f&&++ie===r&&(z=y),(ee=le.nextSibling)!==null)break;le=Q,Q=le.parentNode}le=ee}n=S===-1||z===-1?null:{start:S,end:z}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hc={focusedElem:e,selectionRange:n},wl=!1,Ut=t;Ut!==null;)if(t=Ut,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ut=e;else for(;Ut!==null;){switch(t=Ut,f=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&f!==null){e=void 0,n=t,c=f.memoizedProps,f=f.memoizedState,r=n.stateNode;try{var Ee=ii(n.type,c);e=r.getSnapshotBeforeUpdate(Ee,f),r.__reactInternalSnapshotBeforeUpdate=e}catch(Ue){st(n,n.return,Ue)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Vc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Vc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Ut=e;break}Ut=t.return}}function nh(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:ta(e,n),r&4&&Pr(5,n);break;case 1:if(ta(e,n),r&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){st(n,n.return,y)}else{var c=ii(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){st(n,n.return,y)}}r&64&&Qf(n),r&512&&Vr(n,n.return);break;case 3:if(ta(e,n),r&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{qd(e,t)}catch(y){st(n,n.return,y)}}break;case 27:t===null&&r&4&&eh(n);case 26:case 5:ta(e,n),t===null&&r&4&&Zf(n),r&512&&Vr(n,n.return);break;case 12:ta(e,n);break;case 31:ta(e,n),r&4&&rh(e,n);break;case 13:ta(e,n),r&4&&sh(e,n),r&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=Sy.bind(null,n),Py(e,n))));break;case 22:if(r=n.memoizedState!==null||Wn,!r){t=t!==null&&t.memoizedState!==null||Nt,c=Wn;var f=Nt;Wn=r,(Nt=t)&&!f?na(e,n,(n.subtreeFlags&8772)!==0):ta(e,n),Wn=c,Nt=f}break;case 30:break;default:ta(e,n)}}function ah(e){var t=e.alternate;t!==null&&(e.alternate=null,ah(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&yr(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var vt=null,Xt=!1;function ea(e,t,n){for(n=n.child;n!==null;)ih(e,t,n),n=n.sibling}function ih(e,t,n){if(Kt&&typeof Kt.onCommitFiberUnmount=="function")try{Kt.onCommitFiberUnmount(Ma,n)}catch{}switch(n.tag){case 26:Nt||qn(n,t),ea(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Nt||qn(n,t);var r=vt,c=Xt;Ta(n.type)&&(vt=n.stateNode,Xt=!1),ea(e,t,n),Wr(n.stateNode),vt=r,Xt=c;break;case 5:Nt||qn(n,t);case 6:if(r=vt,c=Xt,vt=null,ea(e,t,n),vt=r,Xt=c,vt!==null)if(Xt)try{(vt.nodeType===9?vt.body:vt.nodeName==="HTML"?vt.ownerDocument.body:vt).removeChild(n.stateNode)}catch(f){st(n,t,f)}else try{vt.removeChild(n.stateNode)}catch(f){st(n,t,f)}break;case 18:vt!==null&&(Xt?(e=vt,Qh(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),nr(e)):Qh(vt,n.stateNode));break;case 4:r=vt,c=Xt,vt=n.stateNode.containerInfo,Xt=!0,ea(e,t,n),vt=r,Xt=c;break;case 0:case 11:case 14:case 15:xa(2,n,t),Nt||xa(4,n,t),ea(e,t,n);break;case 1:Nt||(qn(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"&&Xf(n,t,r)),ea(e,t,n);break;case 21:ea(e,t,n);break;case 22:Nt=(r=Nt)||n.memoizedState!==null,ea(e,t,n),Nt=r;break;default:ea(e,t,n)}}function rh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{nr(e)}catch(n){st(t,t.return,n)}}}function sh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{nr(e)}catch(n){st(t,t.return,n)}}function py(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new th),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new th),t;default:throw Error(l(435,e.tag))}}function il(e,t){var n=py(e);t.forEach(function(r){if(!n.has(r)){n.add(r);var c=wy.bind(null,e,r);r.then(c,c)}})}function Zt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var c=n[r],f=e,y=t,S=y;e:for(;S!==null;){switch(S.tag){case 27:if(Ta(S.type)){vt=S.stateNode,Xt=!1;break e}break;case 5:vt=S.stateNode,Xt=!1;break e;case 3:case 4:vt=S.stateNode.containerInfo,Xt=!0;break e}S=S.return}if(vt===null)throw Error(l(160));ih(f,y,c),vt=null,Xt=!1,f=c.alternate,f!==null&&(f.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)lh(t,e),t=t.sibling}var Cn=null;function lh(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Zt(t,e),Wt(e),r&4&&(xa(3,e,e.return),Pr(3,e),xa(5,e,e.return));break;case 1:Zt(t,e),Wt(e),r&512&&(Nt||n===null||qn(n,n.return)),r&64&&Wn&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?r:n.concat(r))));break;case 26:var c=Cn;if(Zt(t,e),Wt(e),r&512&&(Nt||n===null||qn(n,n.return)),r&4){var f=n!==null?n.memoizedState:null;if(r=e.memoizedState,n===null)if(r===null)if(e.stateNode===null){e:{r=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(r){case"title":f=c.getElementsByTagName("title")[0],(!f||f[$a]||f[Et]||f.namespaceURI==="http://www.w3.org/2000/svg"||f.hasAttribute("itemprop"))&&(f=c.createElement(r),c.head.insertBefore(f,c.querySelector("head > title"))),qt(f,r,n),f[Et]=e,Z(f),r=f;break e;case"link":var y=lg("link","href",c).get(r+(n.href||""));if(y){for(var S=0;S<y.length;S++)if(f=y[S],f.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&f.getAttribute("rel")===(n.rel==null?null:n.rel)&&f.getAttribute("title")===(n.title==null?null:n.title)&&f.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(S,1);break t}}f=c.createElement(r),qt(f,r,n),c.head.appendChild(f);break;case"meta":if(y=lg("meta","content",c).get(r+(n.content||""))){for(S=0;S<y.length;S++)if(f=y[S],f.getAttribute("content")===(n.content==null?null:""+n.content)&&f.getAttribute("name")===(n.name==null?null:n.name)&&f.getAttribute("property")===(n.property==null?null:n.property)&&f.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&f.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(S,1);break t}}f=c.createElement(r),qt(f,r,n),c.head.appendChild(f);break;default:throw Error(l(468,r))}f[Et]=e,Z(f),r=f}e.stateNode=r}else og(c,e.type,e.stateNode);else e.stateNode=sg(c,r,e.memoizedProps);else f!==r?(f===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):f.count--,r===null?og(c,e.type,e.stateNode):sg(c,r,e.memoizedProps)):r===null&&e.stateNode!==null&&mc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Zt(t,e),Wt(e),r&512&&(Nt||n===null||qn(n,n.return)),n!==null&&r&4&&mc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Zt(t,e),Wt(e),r&512&&(Nt||n===null||qn(n,n.return)),e.flags&32){c=e.stateNode;try{Ge(c,"")}catch(Ee){st(e,e.return,Ee)}}r&4&&e.stateNode!=null&&(c=e.memoizedProps,mc(e,c,n!==null?n.memoizedProps:c)),r&1024&&(bc=!0);break;case 6:if(Zt(t,e),Wt(e),r&4){if(e.stateNode===null)throw Error(l(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(Ee){st(e,e.return,Ee)}}break;case 3:if(xl=null,c=Cn,Cn=vl(t.containerInfo),Zt(t,e),Cn=c,Wt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{nr(t.containerInfo)}catch(Ee){st(e,e.return,Ee)}bc&&(bc=!1,oh(e));break;case 4:r=Cn,Cn=vl(e.stateNode.containerInfo),Zt(t,e),Wt(e),Cn=r;break;case 12:Zt(t,e),Wt(e);break;case 31:Zt(t,e),Wt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,il(e,r)));break;case 13:Zt(t,e),Wt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(sl=Gt()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,il(e,r)));break;case 22:c=e.memoizedState!==null;var z=n!==null&&n.memoizedState!==null,F=Wn,ie=Nt;if(Wn=F||c,Nt=ie||z,Zt(t,e),Nt=ie,Wn=F,Wt(e),r&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||z||Wn||Nt||ri(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){z=n=t;try{if(f=z.stateNode,c)y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{S=z.stateNode;var le=z.memoizedProps.style,Q=le!=null&&le.hasOwnProperty("display")?le.display:null;S.style.display=Q==null||typeof Q=="boolean"?"":(""+Q).trim()}}catch(Ee){st(z,z.return,Ee)}}}else if(t.tag===6){if(n===null){z=t;try{z.stateNode.nodeValue=c?"":z.memoizedProps}catch(Ee){st(z,z.return,Ee)}}}else if(t.tag===18){if(n===null){z=t;try{var ee=z.stateNode;c?Xh(ee,!0):Xh(z.stateNode,!1)}catch(Ee){st(z,z.return,Ee)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(n=r.retryQueue,n!==null&&(r.retryQueue=null,il(e,n))));break;case 19:Zt(t,e),Wt(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,il(e,r)));break;case 30:break;case 21:break;default:Zt(t,e),Wt(e)}}function Wt(e){var t=e.flags;if(t&2){try{for(var n,r=e.return;r!==null;){if(Wf(r)){n=r;break}r=r.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,f=yc(e);al(e,f,c);break;case 5:var y=n.stateNode;n.flags&32&&(Ge(y,""),n.flags&=-33);var S=yc(e);al(e,S,y);break;case 3:case 4:var z=n.stateNode.containerInfo,F=yc(e);vc(e,F,z);break;default:throw Error(l(161))}}catch(ie){st(e,e.return,ie)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function oh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;oh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ta(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)nh(e,t.alternate,t),t=t.sibling}function ri(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:xa(4,t,t.return),ri(t);break;case 1:qn(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Xf(t,t.return,n),ri(t);break;case 27:Wr(t.stateNode);case 26:case 5:qn(t,t.return),ri(t);break;case 22:t.memoizedState===null&&ri(t);break;case 30:ri(t);break;default:ri(t)}e=e.sibling}}function na(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var r=t.alternate,c=e,f=t,y=f.flags;switch(f.tag){case 0:case 11:case 15:na(c,f,n),Pr(4,f);break;case 1:if(na(c,f,n),r=f,c=r.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(F){st(r,r.return,F)}if(r=f,c=r.updateQueue,c!==null){var S=r.stateNode;try{var z=c.shared.hiddenCallbacks;if(z!==null)for(c.shared.hiddenCallbacks=null,c=0;c<z.length;c++)Md(z[c],S)}catch(F){st(r,r.return,F)}}n&&y&64&&Qf(f),Vr(f,f.return);break;case 27:eh(f);case 26:case 5:na(c,f,n),n&&r===null&&y&4&&Zf(f),Vr(f,f.return);break;case 12:na(c,f,n);break;case 31:na(c,f,n),n&&y&4&&rh(c,f);break;case 13:na(c,f,n),n&&y&4&&sh(c,f);break;case 22:f.memoizedState===null&&na(c,f,n),Vr(f,f.return);break;case 30:break;default:na(c,f,n)}t=t.sibling}}function xc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Rr(n))}function _c(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Rr(e))}function Tn(e,t,n,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ch(e,t,n,r),t=t.sibling}function ch(e,t,n,r){var c=t.flags;switch(t.tag){case 0:case 11:case 15:Tn(e,t,n,r),c&2048&&Pr(9,t);break;case 1:Tn(e,t,n,r);break;case 3:Tn(e,t,n,r),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Rr(e)));break;case 12:if(c&2048){Tn(e,t,n,r),e=t.stateNode;try{var f=t.memoizedProps,y=f.id,S=f.onPostCommit;typeof S=="function"&&S(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(z){st(t,t.return,z)}}else Tn(e,t,n,r);break;case 31:Tn(e,t,n,r);break;case 13:Tn(e,t,n,r);break;case 23:break;case 22:f=t.stateNode,y=t.alternate,t.memoizedState!==null?f._visibility&2?Tn(e,t,n,r):Gr(e,t):f._visibility&2?Tn(e,t,n,r):(f._visibility|=2,Gi(e,t,n,r,(t.subtreeFlags&10256)!==0||!1)),c&2048&&xc(y,t);break;case 24:Tn(e,t,n,r),c&2048&&_c(t.alternate,t);break;default:Tn(e,t,n,r)}}function Gi(e,t,n,r,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var f=e,y=t,S=n,z=r,F=y.flags;switch(y.tag){case 0:case 11:case 15:Gi(f,y,S,z,c),Pr(8,y);break;case 23:break;case 22:var ie=y.stateNode;y.memoizedState!==null?ie._visibility&2?Gi(f,y,S,z,c):Gr(f,y):(ie._visibility|=2,Gi(f,y,S,z,c)),c&&F&2048&&xc(y.alternate,y);break;case 24:Gi(f,y,S,z,c),c&&F&2048&&_c(y.alternate,y);break;default:Gi(f,y,S,z,c)}t=t.sibling}}function Gr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,r=t,c=r.flags;switch(r.tag){case 22:Gr(n,r),c&2048&&xc(r.alternate,r);break;case 24:Gr(n,r),c&2048&&_c(r.alternate,r);break;default:Gr(n,r)}t=t.sibling}}var Kr=8192;function Ki(e,t,n){if(e.subtreeFlags&Kr)for(e=e.child;e!==null;)uh(e,t,n),e=e.sibling}function uh(e,t,n){switch(e.tag){case 26:Ki(e,t,n),e.flags&Kr&&e.memoizedState!==null&&tv(n,Cn,e.memoizedState,e.memoizedProps);break;case 5:Ki(e,t,n);break;case 3:case 4:var r=Cn;Cn=vl(e.stateNode.containerInfo),Ki(e,t,n),Cn=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=Kr,Kr=16777216,Ki(e,t,n),Kr=r):Ki(e,t,n));break;default:Ki(e,t,n)}}function dh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Fr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];Ut=r,hh(r,e)}dh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)fh(e),e=e.sibling}function fh(e){switch(e.tag){case 0:case 11:case 15:Fr(e),e.flags&2048&&xa(9,e,e.return);break;case 3:Fr(e);break;case 12:Fr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,rl(e)):Fr(e);break;default:Fr(e)}}function rl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];Ut=r,hh(r,e)}dh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:xa(8,t,t.return),rl(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,rl(t));break;default:rl(t)}e=e.sibling}}function hh(e,t){for(;Ut!==null;){var n=Ut;switch(n.tag){case 0:case 11:case 15:xa(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var r=n.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:Rr(n.memoizedState.cache)}if(r=n.child,r!==null)r.return=n,Ut=r;else e:for(n=e;Ut!==null;){r=Ut;var c=r.sibling,f=r.return;if(ah(r),r===n){Ut=null;break e}if(c!==null){c.return=f,Ut=c;break e}Ut=f}}}var my={getCacheForType:function(e){var t=Lt(Ct),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Lt(Ct).controller.signal}},yy=typeof WeakMap=="function"?WeakMap:Map,nt=0,ut=null,Ke=null,Ye=0,rt=0,ln=null,_a=!1,Fi=!1,jc=!1,aa=0,_t=0,ja=0,si=0,Sc=0,on=0,Yi=0,Yr=null,en=null,wc=!1,sl=0,gh=0,ll=1/0,ol=null,Sa=null,Ot=0,wa=null,Ji=null,ia=0,Ec=0,Cc=null,ph=null,Jr=0,Tc=null;function cn(){return(nt&2)!==0&&Ye!==0?Ye&-Ye:C.T!==null?zc():bs()}function mh(){if(on===0)if((Ye&536870912)===0||Xe){var e=xi;xi<<=1,(xi&3932160)===0&&(xi=262144),on=e}else on=536870912;return e=rn.current,e!==null&&(e.flags|=32),on}function tn(e,t,n){(e===ut&&(rt===2||rt===9)||e.cancelPendingCommit!==null)&&(Qi(e,0),Ea(e,Ye,on,!1)),Ha(e,n),((nt&2)===0||e!==ut)&&(e===ut&&((nt&2)===0&&(si|=n),_t===4&&Ea(e,Ye,on,!1)),In(e))}function yh(e,t,n){if((nt&6)!==0)throw Error(l(327));var r=!n&&(t&127)===0&&(t&e.expiredLanes)===0||Ia(e,t),c=r?xy(e,t):Nc(e,t,!0),f=r;do{if(c===0){Fi&&!r&&Ea(e,t,0,!1);break}else{if(n=e.current.alternate,f&&!vy(n)){c=Nc(e,t,!1),f=!1;continue}if(c===2){if(f=t,e.errorRecoveryDisabledLanes&f)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var S=e;c=Yr;var z=S.current.memoizedState.isDehydrated;if(z&&(Qi(S,y).flags|=256),y=Nc(S,y,!1),y!==2){if(jc&&!z){S.errorRecoveryDisabledLanes|=f,si|=f,c=4;break e}f=en,en=c,f!==null&&(en===null?en=f:en.push.apply(en,f))}c=y}if(f=!1,c!==2)continue}}if(c===1){Qi(e,0),Ea(e,t,0,!0);break}e:{switch(r=e,f=c,f){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Ea(r,t,on,!_a);break e;case 2:en=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=sl+300-Gt(),10<c)){if(Ea(r,t,on,!_a),qa(r,0,!0)!==0)break e;ia=t,r.timeoutHandle=Yh(vh.bind(null,r,n,en,ol,wc,t,on,si,Yi,_a,f,"Throttled",-0,0),c);break e}vh(r,n,en,ol,wc,t,on,si,Yi,_a,f,null,-0,0)}}break}while(!0);In(e)}function vh(e,t,n,r,c,f,y,S,z,F,ie,le,Q,ee){if(e.timeoutHandle=-1,le=t.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pn},uh(t,f,le);var Ee=(f&62914560)===f?sl-Gt():(f&4194048)===f?gh-Gt():0;if(Ee=nv(le,Ee),Ee!==null){ia=f,e.cancelPendingCommit=Ee(Ch.bind(null,e,t,f,n,r,c,y,S,z,ie,le,null,Q,ee)),Ea(e,f,y,!F);return}}Ch(e,t,f,n,r,c,y,S,z)}function vy(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var r=0;r<n.length;r++){var c=n[r],f=c.getSnapshot;c=c.value;try{if(!nn(f(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ea(e,t,n,r){t&=~Sc,t&=~si,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var c=t;0<c;){var f=31-Ft(c),y=1<<f;r[f]=-1,c&=~y}n!==0&&Si(e,n,t)}function cl(){return(nt&6)===0?(Qr(0),!1):!0}function Ac(){if(Ke!==null){if(rt===0)var e=Ke.return;else e=Ke,Fn=Xa=null,Vo(e),Ii=null,kr=0,e=Ke;for(;e!==null;)Jf(e.alternate,e),e=e.return;Ke=null}}function Qi(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,My(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),ia=0,Ac(),ut=e,Ke=n=Gn(e.current,null),Ye=t,rt=0,ln=null,_a=!1,Fi=Ia(e,t),jc=!1,Yi=on=Sc=si=ja=_t=0,en=Yr=null,wc=!1,(t&8)!==0&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var c=31-Ft(r),f=1<<c;t|=e[c],r&=~f}return aa=t,Rs(),n}function bh(e,t){Ie=null,C.H=Ir,t===qi||t===Ms?(t=Ud(),rt=3):t===ko?(t=Ud(),rt=4):rt=t===sc?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,ln=t,Ke===null&&(_t=1,Zs(e,gn(t,e.current)))}function xh(){var e=rn.current;return e===null?!0:(Ye&4194048)===Ye?vn===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?e===vn:!1}function _h(){var e=C.H;return C.H=Ir,e===null?Ir:e}function jh(){var e=C.A;return C.A=my,e}function ul(){_t=4,_a||(Ye&4194048)!==Ye&&rn.current!==null||(Fi=!0),(ja&134217727)===0&&(si&134217727)===0||ut===null||Ea(ut,Ye,on,!1)}function Nc(e,t,n){var r=nt;nt|=2;var c=_h(),f=jh();(ut!==e||Ye!==t)&&(ol=null,Qi(e,t)),t=!1;var y=_t;e:do try{if(rt!==0&&Ke!==null){var S=Ke,z=ln;switch(rt){case 8:Ac(),y=6;break e;case 3:case 2:case 9:case 6:rn.current===null&&(t=!0);var F=rt;if(rt=0,ln=null,Xi(e,S,z,F),n&&Fi){y=0;break e}break;default:F=rt,rt=0,ln=null,Xi(e,S,z,F)}}by(),y=_t;break}catch(ie){bh(e,ie)}while(!0);return t&&e.shellSuspendCounter++,Fn=Xa=null,nt=r,C.H=c,C.A=f,Ke===null&&(ut=null,Ye=0,Rs()),y}function by(){for(;Ke!==null;)Sh(Ke)}function xy(e,t){var n=nt;nt|=2;var r=_h(),c=jh();ut!==e||Ye!==t?(ol=null,ll=Gt()+500,Qi(e,t)):Fi=Ia(e,t);e:do try{if(rt!==0&&Ke!==null){t=Ke;var f=ln;t:switch(rt){case 1:rt=0,ln=null,Xi(e,t,f,1);break;case 2:case 9:if(kd(f)){rt=0,ln=null,wh(t);break}t=function(){rt!==2&&rt!==9||ut!==e||(rt=7),In(e)},f.then(t,t);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:kd(f)?(rt=0,ln=null,wh(t)):(rt=0,ln=null,Xi(e,t,f,7));break;case 5:var y=null;switch(Ke.tag){case 26:y=Ke.memoizedState;case 5:case 27:var S=Ke;if(y?cg(y):S.stateNode.complete){rt=0,ln=null;var z=S.sibling;if(z!==null)Ke=z;else{var F=S.return;F!==null?(Ke=F,dl(F)):Ke=null}break t}}rt=0,ln=null,Xi(e,t,f,5);break;case 6:rt=0,ln=null,Xi(e,t,f,6);break;case 8:Ac(),_t=6;break e;default:throw Error(l(462))}}_y();break}catch(ie){bh(e,ie)}while(!0);return Fn=Xa=null,C.H=r,C.A=c,nt=n,Ke!==null?0:(ut=null,Ye=0,Rs(),_t)}function _y(){for(;Ke!==null&&!Ba();)Sh(Ke)}function Sh(e){var t=Ff(e.alternate,e,aa);e.memoizedProps=e.pendingProps,t===null?dl(e):Ke=t}function wh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Hf(n,t,t.pendingProps,t.type,void 0,Ye);break;case 11:t=Hf(n,t,t.pendingProps,t.type.render,t.ref,Ye);break;case 5:Vo(t);default:Jf(n,t),t=Ke=_d(t,aa),t=Ff(n,t,aa)}e.memoizedProps=e.pendingProps,t===null?dl(e):Ke=t}function Xi(e,t,n,r){Fn=Xa=null,Vo(t),Ii=null,kr=0;var c=t.return;try{if(cy(e,c,t,n,Ye)){_t=1,Zs(e,gn(n,e.current)),Ke=null;return}}catch(f){if(c!==null)throw Ke=c,f;_t=1,Zs(e,gn(n,e.current)),Ke=null;return}t.flags&32768?(Xe||r===1?e=!0:Fi||(Ye&536870912)!==0?e=!1:(_a=e=!0,(r===2||r===9||r===3||r===6)&&(r=rn.current,r!==null&&r.tag===13&&(r.flags|=16384))),Eh(t,e)):dl(t)}function dl(e){var t=e;do{if((t.flags&32768)!==0){Eh(t,_a);return}e=t.return;var n=fy(t.alternate,t,aa);if(n!==null){Ke=n;return}if(t=t.sibling,t!==null){Ke=t;return}Ke=t=e}while(t!==null);_t===0&&(_t=5)}function Eh(e,t){do{var n=hy(e.alternate,e);if(n!==null){n.flags&=32767,Ke=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ke=e;return}Ke=e=n}while(e!==null);_t=6,Ke=null}function Ch(e,t,n,r,c,f,y,S,z){e.cancelPendingCommit=null;do fl();while(Ot!==0);if((nt&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(f=t.lanes|t.childLanes,f|=yo,Ql(e,n,f,y,S,z),e===ut&&(Ke=ut=null,Ye=0),Ji=t,wa=e,ia=n,Ec=f,Cc=c,ph=r,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Ey(La,function(){return Oh(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||r){r=C.T,C.T=null,c=U.p,U.p=2,y=nt,nt|=4;try{gy(e,t,n)}finally{nt=y,U.p=c,C.T=r}}Ot=1,Th(),Ah(),Nh()}}function Th(){if(Ot===1){Ot=0;var e=wa,t=Ji,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=C.T,C.T=null;var r=U.p;U.p=2;var c=nt;nt|=4;try{lh(t,e);var f=Hc,y=fd(e.containerInfo),S=f.focusedElem,z=f.selectionRange;if(y!==S&&S&&S.ownerDocument&&dd(S.ownerDocument.documentElement,S)){if(z!==null&&fo(S)){var F=z.start,ie=z.end;if(ie===void 0&&(ie=F),"selectionStart"in S)S.selectionStart=F,S.selectionEnd=Math.min(ie,S.value.length);else{var le=S.ownerDocument||document,Q=le&&le.defaultView||window;if(Q.getSelection){var ee=Q.getSelection(),Ee=S.textContent.length,Ue=Math.min(z.start,Ee),ct=z.end===void 0?Ue:Math.min(z.end,Ee);!ee.extend&&Ue>ct&&(y=ct,ct=Ue,Ue=y);var P=ud(S,Ue),B=ud(S,ct);if(P&&B&&(ee.rangeCount!==1||ee.anchorNode!==P.node||ee.anchorOffset!==P.offset||ee.focusNode!==B.node||ee.focusOffset!==B.offset)){var K=le.createRange();K.setStart(P.node,P.offset),ee.removeAllRanges(),Ue>ct?(ee.addRange(K),ee.extend(B.node,B.offset)):(K.setEnd(B.node,B.offset),ee.addRange(K))}}}}for(le=[],ee=S;ee=ee.parentNode;)ee.nodeType===1&&le.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<le.length;S++){var se=le[S];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}wl=!!Ic,Hc=Ic=null}finally{nt=c,U.p=r,C.T=n}}e.current=t,Ot=2}}function Ah(){if(Ot===2){Ot=0;var e=wa,t=Ji,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=C.T,C.T=null;var r=U.p;U.p=2;var c=nt;nt|=4;try{nh(e,t.alternate,t)}finally{nt=c,U.p=r,C.T=n}}Ot=3}}function Nh(){if(Ot===4||Ot===3){Ot=0,pi();var e=wa,t=Ji,n=ia,r=ph;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ot=5:(Ot=0,Ji=wa=null,Rh(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(Sa=null),Un(n),t=t.stateNode,Kt&&typeof Kt.onCommitFiberRoot=="function")try{Kt.onCommitFiberRoot(Ma,t,void 0,(t.current.flags&128)===128)}catch{}if(r!==null){t=C.T,c=U.p,U.p=2,C.T=null;try{for(var f=e.onRecoverableError,y=0;y<r.length;y++){var S=r[y];f(S.value,{componentStack:S.stack})}}finally{C.T=t,U.p=c}}(ia&3)!==0&&fl(),In(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===Tc?Jr++:(Jr=0,Tc=e):Jr=0,Qr(0)}}function Rh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Rr(t)))}function fl(){return Th(),Ah(),Nh(),Oh()}function Oh(){if(Ot!==5)return!1;var e=wa,t=Ec;Ec=0;var n=Un(ia),r=C.T,c=U.p;try{U.p=32>n?32:n,C.T=null,n=Cc,Cc=null;var f=wa,y=ia;if(Ot=0,Ji=wa=null,ia=0,(nt&6)!==0)throw Error(l(331));var S=nt;if(nt|=4,fh(f.current),ch(f,f.current,y,n),nt=S,Qr(0,!1),Kt&&typeof Kt.onPostCommitFiberRoot=="function")try{Kt.onPostCommitFiberRoot(Ma,f)}catch{}return!0}finally{U.p=c,C.T=r,Rh(e,t)}}function kh(e,t,n){t=gn(n,t),t=rc(e.stateNode,t,2),e=ya(e,t,2),e!==null&&(Ha(e,2),In(e))}function st(e,t,n){if(e.tag===3)kh(e,e,n);else for(;t!==null;){if(t.tag===3){kh(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Sa===null||!Sa.has(r))){e=gn(n,e),n=zf(2),r=ya(t,n,2),r!==null&&(Uf(n,r,t,e),Ha(r,2),In(r));break}}t=t.return}}function Rc(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new yy;var c=new Set;r.set(t,c)}else c=r.get(t),c===void 0&&(c=new Set,r.set(t,c));c.has(n)||(jc=!0,c.add(n),e=jy.bind(null,e,t,n),t.then(e,e))}function jy(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ut===e&&(Ye&n)===n&&(_t===4||_t===3&&(Ye&62914560)===Ye&&300>Gt()-sl?(nt&2)===0&&Qi(e,0):Sc|=n,Yi===Ye&&(Yi=0)),In(e)}function zh(e,t){t===0&&(t=zn()),e=Ya(e,t),e!==null&&(Ha(e,t),In(e))}function Sy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),zh(e,n)}function wy(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(l(314))}r!==null&&r.delete(t),zh(e,n)}function Ey(e,t){return tt(e,t)}var hl=null,Zi=null,Oc=!1,gl=!1,kc=!1,Ca=0;function In(e){e!==Zi&&e.next===null&&(Zi===null?hl=Zi=e:Zi=Zi.next=e),gl=!0,Oc||(Oc=!0,Ty())}function Qr(e,t){if(!kc&&gl){kc=!0;do for(var n=!1,r=hl;r!==null;){if(e!==0){var c=r.pendingLanes;if(c===0)var f=0;else{var y=r.suspendedLanes,S=r.pingedLanes;f=(1<<31-Ft(42|e)+1)-1,f&=c&~(y&~S),f=f&201326741?f&201326741|1:f?f|2:0}f!==0&&(n=!0,Lh(r,f))}else f=Ye,f=qa(r,r===ut?f:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),(f&3)===0||Ia(r,f)||(n=!0,Lh(r,f));r=r.next}while(n);kc=!1}}function Cy(){Uh()}function Uh(){gl=Oc=!1;var e=0;Ca!==0&&Ly()&&(e=Ca);for(var t=Gt(),n=null,r=hl;r!==null;){var c=r.next,f=Dh(r,t);f===0?(r.next=null,n===null?hl=c:n.next=c,c===null&&(Zi=n)):(n=r,(e!==0||(f&3)!==0)&&(gl=!0)),r=c}Ot!==0&&Ot!==5||Qr(e),Ca!==0&&(Ca=0)}function Dh(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,c=e.expirationTimes,f=e.pendingLanes&-62914561;0<f;){var y=31-Ft(f),S=1<<y,z=c[y];z===-1?((S&n)===0||(S&r)!==0)&&(c[y]=Hn(S,t)):z<=t&&(e.expiredLanes|=S),f&=~S}if(t=ut,n=Ye,n=qa(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,n===0||e===t&&(rt===2||rt===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&it(r),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Ia(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(r!==null&&it(r),Un(n)){case 2:case 8:n=yi;break;case 32:n=La;break;case 268435456:n=ms;break;default:n=La}return r=Bh.bind(null,e),n=tt(n,r),e.callbackPriority=t,e.callbackNode=n,t}return r!==null&&r!==null&&it(r),e.callbackPriority=2,e.callbackNode=null,2}function Bh(e,t){if(Ot!==0&&Ot!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(fl()&&e.callbackNode!==n)return null;var r=Ye;return r=qa(e,e===ut?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(yh(e,r,t),Dh(e,Gt()),e.callbackNode!=null&&e.callbackNode===n?Bh.bind(null,e):null)}function Lh(e,t){if(fl())return null;yh(e,t,!0)}function Ty(){qy(function(){(nt&6)!==0?tt(ps,Cy):Uh()})}function zc(){if(Ca===0){var e=Li;e===0&&(e=bi,bi<<=1,(bi&261888)===0&&(bi=256)),Ca=e}return Ca}function Mh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:js(""+e)}function qh(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ay(e,t,n,r,c){if(t==="submit"&&n&&n.stateNode===c){var f=Mh((c[$t]||null).action),y=r.submitter;y&&(t=(t=y[$t]||null)?Mh(t.formAction):y.getAttribute("formAction"),t!==null&&(f=t,y=null));var S=new Cs("action","action",null,r,c);e.push({event:S,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(Ca!==0){var z=y?qh(c,y):new FormData(c);Wo(n,{pending:!0,data:z,method:c.method,action:f},null,z)}}else typeof f=="function"&&(S.preventDefault(),z=y?qh(c,y):new FormData(c),Wo(n,{pending:!0,data:z,method:c.method,action:f},f,z))},currentTarget:c}]})}}for(var Uc=0;Uc<mo.length;Uc++){var Dc=mo[Uc],Ny=Dc.toLowerCase(),Ry=Dc[0].toUpperCase()+Dc.slice(1);En(Ny,"on"+Ry)}En(pd,"onAnimationEnd"),En(md,"onAnimationIteration"),En(yd,"onAnimationStart"),En("dblclick","onDoubleClick"),En("focusin","onFocus"),En("focusout","onBlur"),En(Km,"onTransitionRun"),En(Fm,"onTransitionStart"),En(Ym,"onTransitionCancel"),En(vd,"onTransitionEnd"),pe("onMouseEnter",["mouseout","mouseover"]),pe("onMouseLeave",["mouseout","mouseover"]),pe("onPointerEnter",["pointerout","pointerover"]),pe("onPointerLeave",["pointerout","pointerover"]),ge("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ge("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ge("onBeforeInput",["compositionend","keypress","textInput","paste"]),ge("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ge("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ge("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xr));function Ih(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],c=r.event;r=r.listeners;e:{var f=void 0;if(t)for(var y=r.length-1;0<=y;y--){var S=r[y],z=S.instance,F=S.currentTarget;if(S=S.listener,z!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=F;try{f(c)}catch(ie){Ns(ie)}c.currentTarget=null,f=z}else for(y=0;y<r.length;y++){if(S=r[y],z=S.instance,F=S.currentTarget,S=S.listener,z!==f&&c.isPropagationStopped())break e;f=S,c.currentTarget=F;try{f(c)}catch(ie){Ns(ie)}c.currentTarget=null,f=z}}}}function Fe(e,t){var n=t[wn];n===void 0&&(n=t[wn]=new Set);var r=e+"__bubble";n.has(r)||(Hh(t,e,2,!1),n.add(r))}function Bc(e,t,n){var r=0;t&&(r|=4),Hh(n,e,r,t)}var pl="_reactListening"+Math.random().toString(36).slice(2);function Lc(e){if(!e[pl]){e[pl]=!0,ye.forEach(function(n){n!=="selectionchange"&&(Oy.has(n)||Bc(n,!1,e),Bc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[pl]||(t[pl]=!0,Bc("selectionchange",!1,t))}}function Hh(e,t,n,r){switch(mg(t)){case 2:var c=rv;break;case 8:c=sv;break;default:c=Zc}n=c.bind(null,t,n,e),c=void 0,!no||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),r?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function Mc(e,t,n,r,c){var f=r;if((t&1)===0&&(t&2)===0&&r!==null)e:for(;;){if(r===null)return;var y=r.tag;if(y===3||y===4){var S=r.stateNode.containerInfo;if(S===c)break;if(y===4)for(y=r.return;y!==null;){var z=y.tag;if((z===3||z===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;S!==null;){if(y=la(S),y===null)return;if(z=y.tag,z===5||z===6||z===26||z===27){r=f=y;continue e}S=S.parentNode}}r=r.return}Gu(function(){var F=f,ie=eo(n),le=[];e:{var Q=bd.get(e);if(Q!==void 0){var ee=Cs,Ee=e;switch(e){case"keypress":if(ws(n)===0)break e;case"keydown":case"keyup":ee=wm;break;case"focusin":Ee="focus",ee=so;break;case"focusout":Ee="blur",ee=so;break;case"beforeblur":case"afterblur":ee=so;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=Yu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=fm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=Tm;break;case pd:case md:case yd:ee=pm;break;case vd:ee=Nm;break;case"scroll":case"scrollend":ee=um;break;case"wheel":ee=Om;break;case"copy":case"cut":case"paste":ee=ym;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=Qu;break;case"toggle":case"beforetoggle":ee=zm}var Ue=(t&4)!==0,ct=!Ue&&(e==="scroll"||e==="scrollend"),P=Ue?Q!==null?Q+"Capture":null:Q;Ue=[];for(var B=F,K;B!==null;){var se=B;if(K=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||K===null||P===null||(se=br(B,P),se!=null&&Ue.push(Zr(B,se,K))),ct)break;B=B.return}0<Ue.length&&(Q=new ee(Q,Ee,null,n,ie),le.push({event:Q,listeners:Ue}))}}if((t&7)===0){e:{if(Q=e==="mouseover"||e==="pointerover",ee=e==="mouseout"||e==="pointerout",Q&&n!==Wl&&(Ee=n.relatedTarget||n.fromElement)&&(la(Ee)||Ee[Bn]))break e;if((ee||Q)&&(Q=ie.window===ie?ie:(Q=ie.ownerDocument)?Q.defaultView||Q.parentWindow:window,ee?(Ee=n.relatedTarget||n.toElement,ee=F,Ee=Ee?la(Ee):null,Ee!==null&&(ct=d(Ee),Ue=Ee.tag,Ee!==ct||Ue!==5&&Ue!==27&&Ue!==6)&&(Ee=null)):(ee=null,Ee=F),ee!==Ee)){if(Ue=Yu,se="onMouseLeave",P="onMouseEnter",B="mouse",(e==="pointerout"||e==="pointerover")&&(Ue=Qu,se="onPointerLeave",P="onPointerEnter",B="pointer"),ct=ee==null?Q:re(ee),K=Ee==null?Q:re(Ee),Q=new Ue(se,B+"leave",ee,n,ie),Q.target=ct,Q.relatedTarget=K,se=null,la(ie)===F&&(Ue=new Ue(P,B+"enter",Ee,n,ie),Ue.target=K,Ue.relatedTarget=ct,se=Ue),ct=se,ee&&Ee)t:{for(Ue=ky,P=ee,B=Ee,K=0,se=P;se;se=Ue(se))K++;se=0;for(var ze=B;ze;ze=Ue(ze))se++;for(;0<K-se;)P=Ue(P),K--;for(;0<se-K;)B=Ue(B),se--;for(;K--;){if(P===B||B!==null&&P===B.alternate){Ue=P;break t}P=Ue(P),B=Ue(B)}Ue=null}else Ue=null;ee!==null&&$h(le,Q,ee,Ue,!1),Ee!==null&&ct!==null&&$h(le,ct,Ee,Ue,!0)}}e:{if(Q=F?re(F):window,ee=Q.nodeName&&Q.nodeName.toLowerCase(),ee==="select"||ee==="input"&&Q.type==="file")var We=id;else if(nd(Q))if(rd)We=Pm;else{We=Hm;var Te=Im}else ee=Q.nodeName,!ee||ee.toLowerCase()!=="input"||Q.type!=="checkbox"&&Q.type!=="radio"?F&&Zl(F.elementType)&&(We=id):We=$m;if(We&&(We=We(e,F))){ad(le,We,n,ie);break e}Te&&Te(e,Q,F),e==="focusout"&&F&&Q.type==="number"&&F.memoizedProps.value!=null&&Le(Q,"number",Q.value)}switch(Te=F?re(F):window,e){case"focusin":(nd(Te)||Te.contentEditable==="true")&&(Ni=Te,ho=F,Tr=null);break;case"focusout":Tr=ho=Ni=null;break;case"mousedown":go=!0;break;case"contextmenu":case"mouseup":case"dragend":go=!1,hd(le,n,ie);break;case"selectionchange":if(Gm)break;case"keydown":case"keyup":hd(le,n,ie)}var $e;if(oo)e:{switch(e){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else Ai?ed(e,n)&&(Je="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Je="onCompositionStart");Je&&(Xu&&n.locale!=="ko"&&(Ai||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&Ai&&($e=Ku()):(ua=ie,ao="value"in ua?ua.value:ua.textContent,Ai=!0)),Te=ml(F,Je),0<Te.length&&(Je=new Ju(Je,e,null,n,ie),le.push({event:Je,listeners:Te}),$e?Je.data=$e:($e=td(n),$e!==null&&(Je.data=$e)))),($e=Dm?Bm(e,n):Lm(e,n))&&(Je=ml(F,"onBeforeInput"),0<Je.length&&(Te=new Ju("onBeforeInput","beforeinput",null,n,ie),le.push({event:Te,listeners:Je}),Te.data=$e)),Ay(le,e,F,n,ie)}Ih(le,t)})}function Zr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ml(e,t){for(var n=t+"Capture",r=[];e!==null;){var c=e,f=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||f===null||(c=br(e,n),c!=null&&r.unshift(Zr(e,c,f)),c=br(e,t),c!=null&&r.push(Zr(e,c,f))),e.tag===3)return r;e=e.return}return[]}function ky(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function $h(e,t,n,r,c){for(var f=t._reactName,y=[];n!==null&&n!==r;){var S=n,z=S.alternate,F=S.stateNode;if(S=S.tag,z!==null&&z===r)break;S!==5&&S!==26&&S!==27||F===null||(z=F,c?(F=br(n,f),F!=null&&y.unshift(Zr(n,F,z))):c||(F=br(n,f),F!=null&&y.push(Zr(n,F,z)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var zy=/\r\n?/g,Uy=/\u0000|\uFFFD/g;function Ph(e){return(typeof e=="string"?e:""+e).replace(zy,`
`).replace(Uy,"")}function Vh(e,t){return t=Ph(t),Ph(e)===t}function ot(e,t,n,r,c,f){switch(n){case"children":typeof r=="string"?t==="body"||t==="textarea"&&r===""||Ge(e,r):(typeof r=="number"||typeof r=="bigint")&&t!=="body"&&Ge(e,""+r);break;case"className":Dt(e,"class",r);break;case"tabIndex":Dt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":Dt(e,n,r);break;case"style":Pu(e,r,f);break;case"data":if(t!=="object"){Dt(e,"data",r);break}case"src":case"href":if(r===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(r==null||typeof r=="function"||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=js(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if(typeof r=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof f=="function"&&(n==="formAction"?(t!=="input"&&ot(e,t,"name",c.name,c,null),ot(e,t,"formEncType",c.formEncType,c,null),ot(e,t,"formMethod",c.formMethod,c,null),ot(e,t,"formTarget",c.formTarget,c,null)):(ot(e,t,"encType",c.encType,c,null),ot(e,t,"method",c.method,c,null),ot(e,t,"target",c.target,c,null)));if(r==null||typeof r=="symbol"||typeof r=="boolean"){e.removeAttribute(n);break}r=js(""+r),e.setAttribute(n,r);break;case"onClick":r!=null&&(e.onclick=Pn);break;case"onScroll":r!=null&&Fe("scroll",e);break;case"onScrollEnd":r!=null&&Fe("scrollend",e);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(n=r.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&typeof r!="function"&&typeof r!="symbol";break;case"muted":e.muted=r&&typeof r!="function"&&typeof r!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(r==null||typeof r=="function"||typeof r=="boolean"||typeof r=="symbol"){e.removeAttribute("xlink:href");break}n=js(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":r===!0?e.setAttribute(n,""):r!==!1&&r!=null&&typeof r!="function"&&typeof r!="symbol"?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":r!=null&&typeof r!="function"&&typeof r!="symbol"&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":r==null||typeof r=="function"||typeof r=="symbol"||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Fe("beforetoggle",e),Fe("toggle",e),He(e,"popover",r);break;case"xlinkActuate":at(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":at(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":at(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":at(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":at(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":at(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":at(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":at(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":at(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":He(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=om.get(n)||n,He(e,n,r))}}function qc(e,t,n,r,c,f){switch(n){case"style":Pu(e,r,f);break;case"dangerouslySetInnerHTML":if(r!=null){if(typeof r!="object"||!("__html"in r))throw Error(l(61));if(n=r.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof r=="string"?Ge(e,r):(typeof r=="number"||typeof r=="bigint")&&Ge(e,""+r);break;case"onScroll":r!=null&&Fe("scroll",e);break;case"onScrollEnd":r!=null&&Fe("scrollend",e);break;case"onClick":r!=null&&(e.onclick=Pn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fe.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),f=e[$t]||null,f=f!=null?f[n]:null,typeof f=="function"&&e.removeEventListener(t,f,c),typeof r=="function")){typeof f!="function"&&f!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,c);break e}n in e?e[n]=r:r===!0?e.setAttribute(n,""):He(e,n,r)}}}function qt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",e),Fe("load",e);var r=!1,c=!1,f;for(f in n)if(n.hasOwnProperty(f)){var y=n[f];if(y!=null)switch(f){case"src":r=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:ot(e,t,f,y,n,null)}}c&&ot(e,t,"srcSet",n.srcSet,n,null),r&&ot(e,t,"src",n.src,n,null);return;case"input":Fe("invalid",e);var S=f=y=c=null,z=null,F=null;for(r in n)if(n.hasOwnProperty(r)){var ie=n[r];if(ie!=null)switch(r){case"name":c=ie;break;case"type":y=ie;break;case"checked":z=ie;break;case"defaultChecked":F=ie;break;case"value":f=ie;break;case"defaultValue":S=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(l(137,t));break;default:ot(e,t,r,ie,n,null)}}Ce(e,f,S,z,F,y,c,!1);return;case"select":Fe("invalid",e),r=y=f=null;for(c in n)if(n.hasOwnProperty(c)&&(S=n[c],S!=null))switch(c){case"value":f=S;break;case"defaultValue":y=S;break;case"multiple":r=S;default:ot(e,t,c,S,n,null)}t=f,n=y,e.multiple=!!r,t!=null?Ve(e,!!r,t,!1):n!=null&&Ve(e,!!r,n,!0);return;case"textarea":Fe("invalid",e),f=c=r=null;for(y in n)if(n.hasOwnProperty(y)&&(S=n[y],S!=null))switch(y){case"value":r=S;break;case"defaultValue":c=S;break;case"children":f=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(l(91));break;default:ot(e,t,y,S,n,null)}Pe(e,r,c,f);return;case"option":for(z in n)if(n.hasOwnProperty(z)&&(r=n[z],r!=null))switch(z){case"selected":e.selected=r&&typeof r!="function"&&typeof r!="symbol";break;default:ot(e,t,z,r,n,null)}return;case"dialog":Fe("beforetoggle",e),Fe("toggle",e),Fe("cancel",e),Fe("close",e);break;case"iframe":case"object":Fe("load",e);break;case"video":case"audio":for(r=0;r<Xr.length;r++)Fe(Xr[r],e);break;case"image":Fe("error",e),Fe("load",e);break;case"details":Fe("toggle",e);break;case"embed":case"source":case"link":Fe("error",e),Fe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in n)if(n.hasOwnProperty(F)&&(r=n[F],r!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:ot(e,t,F,r,n,null)}return;default:if(Zl(t)){for(ie in n)n.hasOwnProperty(ie)&&(r=n[ie],r!==void 0&&qc(e,t,ie,r,n,void 0));return}}for(S in n)n.hasOwnProperty(S)&&(r=n[S],r!=null&&ot(e,t,S,r,n,null))}function Dy(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,f=null,y=null,S=null,z=null,F=null,ie=null;for(ee in n){var le=n[ee];if(n.hasOwnProperty(ee)&&le!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":z=le;default:r.hasOwnProperty(ee)||ot(e,t,ee,null,r,le)}}for(var Q in r){var ee=r[Q];if(le=n[Q],r.hasOwnProperty(Q)&&(ee!=null||le!=null))switch(Q){case"type":f=ee;break;case"name":c=ee;break;case"checked":F=ee;break;case"defaultChecked":ie=ee;break;case"value":y=ee;break;case"defaultValue":S=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(l(137,t));break;default:ee!==le&&ot(e,t,Q,ee,r,le)}}fn(e,y,S,z,F,ie,f,c);return;case"select":ee=y=S=Q=null;for(f in n)if(z=n[f],n.hasOwnProperty(f)&&z!=null)switch(f){case"value":break;case"multiple":ee=z;default:r.hasOwnProperty(f)||ot(e,t,f,null,r,z)}for(c in r)if(f=r[c],z=n[c],r.hasOwnProperty(c)&&(f!=null||z!=null))switch(c){case"value":Q=f;break;case"defaultValue":S=f;break;case"multiple":y=f;default:f!==z&&ot(e,t,c,f,r,z)}t=S,n=y,r=ee,Q!=null?Ve(e,!!n,Q,!1):!!r!=!!n&&(t!=null?Ve(e,!!n,t,!0):Ve(e,!!n,n?[]:"",!1));return;case"textarea":ee=Q=null;for(S in n)if(c=n[S],n.hasOwnProperty(S)&&c!=null&&!r.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:ot(e,t,S,null,r,c)}for(y in r)if(c=r[y],f=n[y],r.hasOwnProperty(y)&&(c!=null||f!=null))switch(y){case"value":Q=c;break;case"defaultValue":ee=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==f&&ot(e,t,y,c,r,f)}Ne(e,Q,ee);return;case"option":for(var Ee in n)if(Q=n[Ee],n.hasOwnProperty(Ee)&&Q!=null&&!r.hasOwnProperty(Ee))switch(Ee){case"selected":e.selected=!1;break;default:ot(e,t,Ee,null,r,Q)}for(z in r)if(Q=r[z],ee=n[z],r.hasOwnProperty(z)&&Q!==ee&&(Q!=null||ee!=null))switch(z){case"selected":e.selected=Q&&typeof Q!="function"&&typeof Q!="symbol";break;default:ot(e,t,z,Q,r,ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in n)Q=n[Ue],n.hasOwnProperty(Ue)&&Q!=null&&!r.hasOwnProperty(Ue)&&ot(e,t,Ue,null,r,Q);for(F in r)if(Q=r[F],ee=n[F],r.hasOwnProperty(F)&&Q!==ee&&(Q!=null||ee!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(l(137,t));break;default:ot(e,t,F,Q,r,ee)}return;default:if(Zl(t)){for(var ct in n)Q=n[ct],n.hasOwnProperty(ct)&&Q!==void 0&&!r.hasOwnProperty(ct)&&qc(e,t,ct,void 0,r,Q);for(ie in r)Q=r[ie],ee=n[ie],!r.hasOwnProperty(ie)||Q===ee||Q===void 0&&ee===void 0||qc(e,t,ie,Q,r,ee);return}}for(var P in n)Q=n[P],n.hasOwnProperty(P)&&Q!=null&&!r.hasOwnProperty(P)&&ot(e,t,P,null,r,Q);for(le in r)Q=r[le],ee=n[le],!r.hasOwnProperty(le)||Q===ee||Q==null&&ee==null||ot(e,t,le,Q,r,ee)}function Gh(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function By(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var c=n[r],f=c.transferSize,y=c.initiatorType,S=c.duration;if(f&&S&&Gh(y)){for(y=0,S=c.responseEnd,r+=1;r<n.length;r++){var z=n[r],F=z.startTime;if(F>S)break;var ie=z.transferSize,le=z.initiatorType;ie&&Gh(le)&&(z=z.responseEnd,y+=ie*(z<S?1:(S-F)/(z-F)))}if(--r,t+=8*(f+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Ic=null,Hc=null;function yl(e){return e.nodeType===9?e:e.ownerDocument}function Kh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Fh(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function $c(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Pc=null;function Ly(){var e=window.event;return e&&e.type==="popstate"?e===Pc?!1:(Pc=e,!0):(Pc=null,!1)}var Yh=typeof setTimeout=="function"?setTimeout:void 0,My=typeof clearTimeout=="function"?clearTimeout:void 0,Jh=typeof Promise=="function"?Promise:void 0,qy=typeof queueMicrotask=="function"?queueMicrotask:typeof Jh<"u"?function(e){return Jh.resolve(null).then(e).catch(Iy)}:Yh;function Iy(e){setTimeout(function(){throw e})}function Ta(e){return e==="head"}function Qh(e,t){var n=t,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(r===0){e.removeChild(c),nr(t);return}r--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")r++;else if(n==="html")Wr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Wr(n);for(var f=n.firstChild;f;){var y=f.nextSibling,S=f.nodeName;f[$a]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&f.rel.toLowerCase()==="stylesheet"||n.removeChild(f),f=y}}else n==="body"&&Wr(e.ownerDocument.body);n=c}while(n);nr(t)}function Xh(e,t){var n=e;e=0;do{var r=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=r}while(n)}function Vc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Vc(n),yr(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Hy(e,t,n,r){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(r){if(!e[$a])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(f=e.getAttribute("rel"),f==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(f!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(f=e.getAttribute("src"),(f!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&f&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var f=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===f)return e}else return e;if(e=bn(e.nextSibling),e===null)break}return null}function $y(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=bn(e.nextSibling),e===null))return null;return e}function Zh(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=bn(e.nextSibling),e===null))return null;return e}function Gc(e){return e.data==="$?"||e.data==="$~"}function Kc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Py(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}function bn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Fc=null;function Wh(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return bn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function eg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function tg(e,t,n){switch(t=yl(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Wr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);yr(e)}var xn=new Map,ng=new Set;function vl(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var ra=U.d;U.d={f:Vy,r:Gy,D:Ky,C:Fy,L:Yy,m:Jy,X:Xy,S:Qy,M:Zy};function Vy(){var e=ra.f(),t=cl();return e||t}function Gy(e){var t=$(e);t!==null&&t.tag===5&&t.type==="form"?bf(t):ra.r(e)}var Wi=typeof document>"u"?null:document;function ag(e,t,n){var r=Wi;if(r&&typeof t=="string"&&t){var c=zt(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),ng.has(c)||(ng.add(c),e={rel:e,crossOrigin:n,href:t},r.querySelector(c)===null&&(t=r.createElement("link"),qt(t,"link",e),Z(t),r.head.appendChild(t)))}}function Ky(e){ra.D(e),ag("dns-prefetch",e,null)}function Fy(e,t){ra.C(e,t),ag("preconnect",e,t)}function Yy(e,t,n){ra.L(e,t,n);var r=Wi;if(r&&e&&t){var c='link[rel="preload"][as="'+zt(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+zt(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+zt(n.imageSizes)+'"]')):c+='[href="'+zt(e)+'"]';var f=c;switch(t){case"style":f=er(e);break;case"script":f=tr(e)}xn.has(f)||(e=x({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),xn.set(f,e),r.querySelector(c)!==null||t==="style"&&r.querySelector(es(f))||t==="script"&&r.querySelector(ts(f))||(t=r.createElement("link"),qt(t,"link",e),Z(t),r.head.appendChild(t)))}}function Jy(e,t){ra.m(e,t);var n=Wi;if(n&&e){var r=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+zt(r)+'"][href="'+zt(e)+'"]',f=c;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":f=tr(e)}if(!xn.has(f)&&(e=x({rel:"modulepreload",href:e},t),xn.set(f,e),n.querySelector(c)===null)){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(ts(f)))return}r=n.createElement("link"),qt(r,"link",e),Z(r),n.head.appendChild(r)}}}function Qy(e,t,n){ra.S(e,t,n);var r=Wi;if(r&&e){var c=xe(r).hoistableStyles,f=er(e);t=t||"default";var y=c.get(f);if(!y){var S={loading:0,preload:null};if(y=r.querySelector(es(f)))S.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},n),(n=xn.get(f))&&Yc(e,n);var z=y=r.createElement("link");Z(z),qt(z,"link",e),z._p=new Promise(function(F,ie){z.onload=F,z.onerror=ie}),z.addEventListener("load",function(){S.loading|=1}),z.addEventListener("error",function(){S.loading|=2}),S.loading|=4,bl(y,t,r)}y={type:"stylesheet",instance:y,count:1,state:S},c.set(f,y)}}}function Xy(e,t){ra.X(e,t);var n=Wi;if(n&&e){var r=xe(n).hoistableScripts,c=tr(e),f=r.get(c);f||(f=n.querySelector(ts(c)),f||(e=x({src:e,async:!0},t),(t=xn.get(c))&&Jc(e,t),f=n.createElement("script"),Z(f),qt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},r.set(c,f))}}function Zy(e,t){ra.M(e,t);var n=Wi;if(n&&e){var r=xe(n).hoistableScripts,c=tr(e),f=r.get(c);f||(f=n.querySelector(ts(c)),f||(e=x({src:e,async:!0,type:"module"},t),(t=xn.get(c))&&Jc(e,t),f=n.createElement("script"),Z(f),qt(f,"link",e),n.head.appendChild(f)),f={type:"script",instance:f,count:1,state:null},r.set(c,f))}}function ig(e,t,n,r){var c=(c=de.current)?vl(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=er(n.href),n=xe(c).hoistableStyles,r=n.get(t),r||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=er(n.href);var f=xe(c).hoistableStyles,y=f.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},f.set(e,y),(f=c.querySelector(es(e)))&&!f._p&&(y.instance=f,y.state.loading=5),xn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},xn.set(e,n),f||Wy(c,e,n,y.state))),t&&r===null)throw Error(l(528,""));return y}if(t&&r!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=tr(n),n=xe(c).hoistableScripts,r=n.get(t),r||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function er(e){return'href="'+zt(e)+'"'}function es(e){return'link[rel="stylesheet"]['+e+"]"}function rg(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function Wy(e,t,n,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),qt(t,"link",n),Z(t),e.head.appendChild(t))}function tr(e){return'[src="'+zt(e)+'"]'}function ts(e){return"script[async]"+e}function sg(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+zt(n.href)+'"]');if(r)return t.instance=r,Z(r),r;var c=x({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement("style"),Z(r),qt(r,"style",c),bl(r,n.precedence,e),t.instance=r;case"stylesheet":c=er(n.href);var f=e.querySelector(es(c));if(f)return t.state.loading|=4,t.instance=f,Z(f),f;r=rg(n),(c=xn.get(c))&&Yc(r,c),f=(e.ownerDocument||e).createElement("link"),Z(f);var y=f;return y._p=new Promise(function(S,z){y.onload=S,y.onerror=z}),qt(f,"link",r),t.state.loading|=4,bl(f,n.precedence,e),t.instance=f;case"script":return f=tr(n.src),(c=e.querySelector(ts(f)))?(t.instance=c,Z(c),c):(r=n,(c=xn.get(f))&&(r=x({},n),Jc(r,c)),e=e.ownerDocument||e,c=e.createElement("script"),Z(c),qt(c,"link",r),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(r=t.instance,t.state.loading|=4,bl(r,n.precedence,e));return t.instance}function bl(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=r.length?r[r.length-1]:null,f=c,y=0;y<r.length;y++){var S=r[y];if(S.dataset.precedence===t)f=S;else if(f!==c)break}f?f.parentNode.insertBefore(e,f.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Yc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Jc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var xl=null;function lg(e,t,n){if(xl===null){var r=new Map,c=xl=new Map;c.set(n,r)}else c=xl,r=c.get(n),r||(r=new Map,c.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var f=n[c];if(!(f[$a]||f[Et]||e==="link"&&f.getAttribute("rel")==="stylesheet")&&f.namespaceURI!=="http://www.w3.org/2000/svg"){var y=f.getAttribute(t)||"";y=e+y;var S=r.get(y);S?S.push(f):r.set(y,[f])}}return r}function og(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function ev(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function cg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function tv(e,t,n,r){if(n.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=er(r.href),f=t.querySelector(es(c));if(f){t=f._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=_l.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=f,Z(f);return}f=t.ownerDocument||t,r=rg(r),(c=xn.get(c))&&Yc(r,c),f=f.createElement("link"),Z(f);var y=f;y._p=new Promise(function(S,z){y.onload=S,y.onerror=z}),qt(f,"link",r),n.instance=f}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=_l.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Qc=0;function nv(e,t){return e.stylesheets&&e.count===0&&Sl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&Sl(e,e.stylesheets),e.unsuspend){var f=e.unsuspend;e.unsuspend=null,f()}},6e4+t);0<e.imgBytes&&Qc===0&&(Qc=62500*By());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Sl(e,e.stylesheets),e.unsuspend)){var f=e.unsuspend;e.unsuspend=null,f()}},(e.imgBytes>Qc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(c)}}:null}function _l(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Sl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var jl=null;function Sl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,jl=new Map,t.forEach(av,e),jl=null,_l.call(e))}function av(e,t){if(!(t.state.loading&4)){var n=jl.get(e);if(n)var r=n.get(null);else{n=new Map,jl.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),f=0;f<c.length;f++){var y=c[f];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),r=y)}r&&n.set(null,r)}c=t.instance,y=c.getAttribute("data-precedence"),f=n.get(y)||r,f===r&&n.set(null,c),n.set(y,c),this.count++,r=_l.bind(this),c.addEventListener("load",r),c.addEventListener("error",r),f?f.parentNode.insertBefore(c,f.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var ns={$$typeof:M,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function iv(e,t,n,r,c,f,y,S,z){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ji(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ji(0),this.hiddenUpdates=ji(null),this.identifierPrefix=r,this.onUncaughtError=c,this.onCaughtError=f,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function ug(e,t,n,r,c,f,y,S,z,F,ie,le){return e=new iv(e,t,n,y,z,F,ie,le,S),t=1,f===!0&&(t|=24),f=an(3,null,null,t),e.current=f,f.stateNode=e,t=No(),t.refCount++,e.pooledCache=t,t.refCount++,f.memoizedState={element:r,isDehydrated:n,cache:t},zo(f),e}function dg(e){return e?(e=ki,e):ki}function fg(e,t,n,r,c,f){c=dg(c),r.context===null?r.context=c:r.pendingContext=c,r=ma(t),r.payload={element:n},f=f===void 0?null:f,f!==null&&(r.callback=f),n=ya(e,r,t),n!==null&&(tn(n,e,t),Ur(n,e,t))}function hg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Xc(e,t){hg(e,t),(e=e.alternate)&&hg(e,t)}function gg(e){if(e.tag===13||e.tag===31){var t=Ya(e,67108864);t!==null&&tn(t,e,67108864),Xc(e,67108864)}}function pg(e){if(e.tag===13||e.tag===31){var t=cn();t=Ei(t);var n=Ya(e,t);n!==null&&tn(n,e,t),Xc(e,t)}}var wl=!0;function rv(e,t,n,r){var c=C.T;C.T=null;var f=U.p;try{U.p=2,Zc(e,t,n,r)}finally{U.p=f,C.T=c}}function sv(e,t,n,r){var c=C.T;C.T=null;var f=U.p;try{U.p=8,Zc(e,t,n,r)}finally{U.p=f,C.T=c}}function Zc(e,t,n,r){if(wl){var c=Wc(r);if(c===null)Mc(e,t,r,El,n),yg(e,r);else if(ov(c,e,t,n,r))r.stopPropagation();else if(yg(e,r),t&4&&-1<lv.indexOf(e)){for(;c!==null;){var f=$(c);if(f!==null)switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var y=kn(f.pendingLanes);if(y!==0){var S=f;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var z=1<<31-Ft(y);S.entanglements[1]|=z,y&=~z}In(f),(nt&6)===0&&(ll=Gt()+500,Qr(0))}}break;case 31:case 13:S=Ya(f,2),S!==null&&tn(S,f,2),cl(),Xc(f,2)}if(f=Wc(r),f===null&&Mc(e,t,r,El,n),f===c)break;c=f}c!==null&&r.stopPropagation()}else Mc(e,t,r,null,n)}}function Wc(e){return e=eo(e),eu(e)}var El=null;function eu(e){if(El=null,e=la(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=h(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return El=e,null}function mg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(mi()){case ps:return 2;case yi:return 8;case La:case gr:return 32;case ms:return 268435456;default:return 32}default:return 32}}var tu=!1,Aa=null,Na=null,Ra=null,as=new Map,is=new Map,Oa=[],lv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yg(e,t){switch(e){case"focusin":case"focusout":Aa=null;break;case"dragenter":case"dragleave":Na=null;break;case"mouseover":case"mouseout":Ra=null;break;case"pointerover":case"pointerout":as.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":is.delete(t.pointerId)}}function rs(e,t,n,r,c,f){return e===null||e.nativeEvent!==f?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:f,targetContainers:[c]},t!==null&&(t=$(t),t!==null&&gg(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function ov(e,t,n,r,c){switch(t){case"focusin":return Aa=rs(Aa,e,t,n,r,c),!0;case"dragenter":return Na=rs(Na,e,t,n,r,c),!0;case"mouseover":return Ra=rs(Ra,e,t,n,r,c),!0;case"pointerover":var f=c.pointerId;return as.set(f,rs(as.get(f)||null,e,t,n,r,c)),!0;case"gotpointercapture":return f=c.pointerId,is.set(f,rs(is.get(f)||null,e,t,n,r,c)),!0}return!1}function vg(e){var t=la(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=h(n),t!==null){e.blockedOn=t,xs(e.priority,function(){pg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,xs(e.priority,function(){pg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Cl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Wc(e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Wl=r,n.target.dispatchEvent(r),Wl=null}else return t=$(n),t!==null&&gg(t),e.blockedOn=n,!1;t.shift()}return!0}function bg(e,t,n){Cl(e)&&n.delete(t)}function cv(){tu=!1,Aa!==null&&Cl(Aa)&&(Aa=null),Na!==null&&Cl(Na)&&(Na=null),Ra!==null&&Cl(Ra)&&(Ra=null),as.forEach(bg),is.forEach(bg)}function Tl(e,t){e.blockedOn===t&&(e.blockedOn=null,tu||(tu=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,cv)))}var Al=null;function xg(e){Al!==e&&(Al=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){Al===e&&(Al=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],c=e[t+2];if(typeof r!="function"){if(eu(r||n)===null)continue;break}var f=$(n);f!==null&&(e.splice(t,3),t-=3,Wo(f,{pending:!0,data:c,method:n.method,action:r},r,c))}}))}function nr(e){function t(z){return Tl(z,e)}Aa!==null&&Tl(Aa,e),Na!==null&&Tl(Na,e),Ra!==null&&Tl(Ra,e),as.forEach(t),is.forEach(t);for(var n=0;n<Oa.length;n++){var r=Oa[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Oa.length&&(n=Oa[0],n.blockedOn===null);)vg(n),n.blockedOn===null&&Oa.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(r=0;r<n.length;r+=3){var c=n[r],f=n[r+1],y=c[$t]||null;if(typeof f=="function")y||xg(n);else if(y){var S=null;if(f&&f.hasAttribute("formAction")){if(c=f,y=f[$t]||null)S=y.formAction;else if(eu(c)!==null)continue}else S=y.action;typeof S=="function"?n[r+1]=S:(n.splice(r,3),r-=3),xg(n)}}}function _g(){function e(f){f.canIntercept&&f.info==="react-transition"&&f.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var f=navigation.currentEntry;f&&f.url!=null&&navigation.navigate(f.url,{state:f.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var r=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function nu(e){this._internalRoot=e}Nl.prototype.render=nu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,r=cn();fg(n,r,e,t,null,null)},Nl.prototype.unmount=nu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fg(e.current,2,null,e,null,null),cl(),t[Bn]=null}};function Nl(e){this._internalRoot=e}Nl.prototype.unstable_scheduleHydration=function(e){if(e){var t=bs();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Oa.length&&t!==0&&t<Oa[n].priority;n++);Oa.splice(n,0,e),n===0&&vg(e)}};var jg=a.version;if(jg!=="19.2.0")throw Error(l(527,jg,"19.2.0"));U.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var uv={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:C,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rl.isDisabled&&Rl.supportsFiber)try{Ma=Rl.inject(uv),Kt=Rl}catch{}}return ls.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,r="",c=Nf,f=Rf,y=Of;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(f=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=ug(e,1,!1,null,null,n,r,null,c,f,y,_g),e[Bn]=t.current,Lc(e),new nu(t)},ls.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var r=!1,c="",f=Nf,y=Rf,S=Of,z=null;return n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(f=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(S=n.onRecoverableError),n.formState!==void 0&&(z=n.formState)),t=ug(e,1,!0,t,n??null,r,c,z,f,y,S,_g),t.context=dg(null),n=t.current,r=cn(),r=Ei(r),c=ma(r),c.callback=null,ya(n,c,r),n=r,t.current.lanes=n,Ha(t,n),In(t),e[Bn]=t.current,Lc(e),new Nl(t)},ls.version="19.2.0",ls}var kg;function _v(){if(kg)return iu.exports;kg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),iu.exports=xv(),iu.exports}var jv=_v(),j=Ou();const ku=dp(j);var vu=function(o,a){return vu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},vu(o,a)};function hp(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");vu(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var Il=function(){return Il=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},Il.apply(this,arguments)};function fr(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function gp(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(h=o[g])&&(d=(u<3?h(d):u>3?h(a,s,d):h(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function pp(o,a){return function(s,l){a(s,l,o)}}function mp(o,a,s,l,u,d){function h(A){if(A!==void 0&&typeof A!="function")throw new TypeError("Function expected");return A}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),x,_=!1,b=s.length-1;b>=0;b--){var E={};for(var R in l)E[R]=R==="access"?{}:l[R];for(var R in l.access)E.access[R]=l.access[R];E.addInitializer=function(A){if(_)throw new TypeError("Cannot add initializers after decoration has completed");d.push(h(A||null))};var N=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],E);if(g==="accessor"){if(N===void 0)continue;if(N===null||typeof N!="object")throw new TypeError("Object expected");(x=h(N.get))&&(v.get=x),(x=h(N.set))&&(v.set=x),(x=h(N.init))&&u.unshift(x)}else(x=h(N))&&(g==="field"?u.unshift(x):v[p]=x)}m&&Object.defineProperty(m,l.name,v),_=!0}function yp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function vp(o){return typeof o=="symbol"?o:"".concat(o)}function bp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function xp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function Re(o,a,s,l){function u(d){return d instanceof s?d:new s(function(h){h(d)})}return new(s||(s=Promise))(function(d,h){function g(v){try{m(l.next(v))}catch(x){h(x)}}function p(v){try{m(l.throw(v))}catch(x){h(x)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function _p(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,h=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return h.next=g(0),h.throw=g(1),h.return=g(2),typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;h&&(h=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Gl=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function jp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&Gl(a,o,s)}function Hl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function zu(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],h;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){h={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(h)throw h.error}}return d}function Sp(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(zu(arguments[a]));return o}function wp(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],h=0,g=d.length;h<g;h++,u++)l[u]=d[h];return l}function Ep(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function dr(o){return this instanceof dr?(this.v=o,this):new dr(o)}function Cp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",h),u[Symbol.asyncIterator]=function(){return this},u;function h(b){return function(E){return Promise.resolve(E).then(b,x)}}function g(b,E){l[b]&&(u[b]=function(R){return new Promise(function(N,A){d.push([b,R,N,A])>1||p(b,R)})},E&&(u[b]=E(u[b])))}function p(b,E){try{m(l[b](E))}catch(R){_(d[0][3],R)}}function m(b){b.value instanceof dr?Promise.resolve(b.value.v).then(v,x):_(d[0][2],b)}function v(b){p("next",b)}function x(b){p("throw",b)}function _(b,E){b(E),d.shift(),d.length&&p(d[0][0],d[0][1])}}function Tp(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(h){return(s=!s)?{value:dr(o[u](h)),done:!1}:d?d(h):h}:d}}function Ap(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Hl=="function"?Hl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(h){return new Promise(function(g,p){h=o[d](h),u(g,p,h.done,h.value)})}}function u(d,h,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},h)}}function Np(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var Sv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},bu=function(o){return bu=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},bu(o)};function Rp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=bu(o),l=0;l<s.length;l++)s[l]!=="default"&&Gl(a,o,s[l]);return Sv(a,o),a}function Op(o){return o&&o.__esModule?o:{default:o}}function kp(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function zp(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Up(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function Dp(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var wv=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Bp(o){function a(d){o.error=o.hasError?new wv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(h){return a(h),u()})}else l|=1}catch(h){a(h)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function Lp(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,h){return l?a?".jsx":".js":u&&(!d||!h)?s:u+d+"."+h.toLowerCase()+"js"}):o}const Ev={__extends:hp,__assign:Il,__rest:fr,__decorate:gp,__param:pp,__esDecorate:mp,__runInitializers:yp,__propKey:vp,__setFunctionName:bp,__metadata:xp,__awaiter:Re,__generator:_p,__createBinding:Gl,__exportStar:jp,__values:Hl,__read:zu,__spread:Sp,__spreadArrays:wp,__spreadArray:Ep,__await:dr,__asyncGenerator:Cp,__asyncDelegator:Tp,__asyncValues:Ap,__makeTemplateObject:Np,__importStar:Rp,__importDefault:Op,__classPrivateFieldGet:kp,__classPrivateFieldSet:zp,__classPrivateFieldIn:Up,__addDisposableResource:Dp,__disposeResources:Bp,__rewriteRelativeImportExtension:Lp},Cv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Dp,get __assign(){return Il},__asyncDelegator:Tp,__asyncGenerator:Cp,__asyncValues:Ap,__await:dr,__awaiter:Re,__classPrivateFieldGet:kp,__classPrivateFieldIn:Up,__classPrivateFieldSet:zp,__createBinding:Gl,__decorate:gp,__disposeResources:Bp,__esDecorate:mp,__exportStar:jp,__extends:hp,__generator:_p,__importDefault:Op,__importStar:Rp,__makeTemplateObject:Np,__metadata:xp,__param:pp,__propKey:vp,__read:zu,__rest:fr,__rewriteRelativeImportExtension:Lp,__runInitializers:yp,__setFunctionName:bp,__spread:Sp,__spreadArray:Ep,__spreadArrays:wp,__values:Hl,default:Ev},Symbol.toStringTag,{value:"Module"})),Tv=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Uu extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Av extends Uu{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class zg extends Uu{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Ug extends Uu{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var xu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(xu||(xu={}));class Nv{constructor(a,{headers:s={},customFetch:l,region:u=xu.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Tv(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return Re(this,arguments,void 0,function*(s,l={}){var u;let d,h;try{const{headers:g,method:p,body:m,signal:v,timeout:x}=l;let _={},{region:b}=l;b||(b=this.region);const E=new URL(`${this.url}/${s}`);b&&b!=="any"&&(_["x-region"]=b,E.searchParams.set("forceFunctionRegion",b));let R;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(_["Content-Type"]="application/octet-stream",R=m):typeof m=="string"?(_["Content-Type"]="text/plain",R=m):typeof FormData<"u"&&m instanceof FormData?R=m:(_["Content-Type"]="application/json",R=JSON.stringify(m)):R=m;let N=v;x&&(h=new AbortController,d=setTimeout(()=>h.abort(),x),v?(N=h.signal,v.addEventListener("abort",()=>h.abort())):N=h.signal);const A=yield this.fetch(E.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},_),this.headers),g),body:R,signal:N}).catch(T=>{throw new Av(T)}),I=A.headers.get("x-relay-error");if(I&&I==="true")throw new zg(A);if(!A.ok)throw new Ug(A);let M=((u=A.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),G;return M==="application/json"?G=yield A.json():M==="application/octet-stream"||M==="application/pdf"?G=yield A.blob():M==="text/event-stream"?G=A:M==="multipart/form-data"?G=yield A.formData():G=yield A.text(),{data:G,error:null,response:A}}catch(g){return{data:null,error:g,response:g instanceof Ug||g instanceof zg?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var Vt={};const hr=hv(Cv);var Ol={},kl={},zl={},Ul={},Dl={},Bl={},Dg;function Mp(){if(Dg)return Bl;Dg=1,Object.defineProperty(Bl,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Bl.default=o,Bl}var Bg;function qp(){if(Bg)return Dl;Bg=1,Object.defineProperty(Dl,"__esModule",{value:!0});const a=hr.__importDefault(Mp());class s{constructor(u){var d,h;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(h=u.isMaybeSingle)!==null&&h!==void 0?h:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let g=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,x,_;let b=null,E=null,R=null,N=p.status,A=p.statusText;if(p.ok){if(this.method!=="HEAD"){const T=await p.text();T===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?E=T:E=JSON.parse(T))}const M=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),G=(x=p.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");M&&G&&G.length>1&&(R=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(b={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,R=null,N=406,A="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const M=await p.text();try{b=JSON.parse(M),Array.isArray(b)&&p.status===404&&(E=[],b=null,N=200,A="OK")}catch{p.status===404&&M===""?(N=204,A="No Content"):b={message:M}}if(b&&this.isMaybeSingle&&(!((_=b?.details)===null||_===void 0)&&_.includes("0 rows"))&&(b=null,N=200,A="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:E,count:R,status:N,statusText:A}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,x;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(x=p?.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return Dl.default=s,Dl}var Lg;function Ip(){if(Lg)return Ul;Lg=1,Object.defineProperty(Ul,"__esModule",{value:!0});const a=hr.__importDefault(qp());class s extends a.default{select(u){let d=!1;const h=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",h),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:h,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${h===void 0?"":h?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:h=d}={}){const g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:h,referencedTable:g=h}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:h=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const x=[u?"analyze":null,d?"verbose":null,h?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),_=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${_}"; options=${x};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return Ul.default=s,Ul}var Mg;function Du(){if(Mg)return zl;Mg=1,Object.defineProperty(zl,"__esModule",{value:!0});const a=hr.__importDefault(Ip()),s=new RegExp("[,()]");class l extends a.default{eq(d,h){return this.url.searchParams.append(d,`eq.${h}`),this}neq(d,h){return this.url.searchParams.append(d,`neq.${h}`),this}gt(d,h){return this.url.searchParams.append(d,`gt.${h}`),this}gte(d,h){return this.url.searchParams.append(d,`gte.${h}`),this}lt(d,h){return this.url.searchParams.append(d,`lt.${h}`),this}lte(d,h){return this.url.searchParams.append(d,`lte.${h}`),this}like(d,h){return this.url.searchParams.append(d,`like.${h}`),this}likeAllOf(d,h){return this.url.searchParams.append(d,`like(all).{${h.join(",")}}`),this}likeAnyOf(d,h){return this.url.searchParams.append(d,`like(any).{${h.join(",")}}`),this}ilike(d,h){return this.url.searchParams.append(d,`ilike.${h}`),this}ilikeAllOf(d,h){return this.url.searchParams.append(d,`ilike(all).{${h.join(",")}}`),this}ilikeAnyOf(d,h){return this.url.searchParams.append(d,`ilike(any).{${h.join(",")}}`),this}is(d,h){return this.url.searchParams.append(d,`is.${h}`),this}in(d,h){const g=Array.from(new Set(h)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cs.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cs.{${h.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(h)}`),this}containedBy(d,h){return typeof h=="string"?this.url.searchParams.append(d,`cd.${h}`):Array.isArray(h)?this.url.searchParams.append(d,`cd.{${h.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(h)}`),this}rangeGt(d,h){return this.url.searchParams.append(d,`sr.${h}`),this}rangeGte(d,h){return this.url.searchParams.append(d,`nxl.${h}`),this}rangeLt(d,h){return this.url.searchParams.append(d,`sl.${h}`),this}rangeLte(d,h){return this.url.searchParams.append(d,`nxr.${h}`),this}rangeAdjacent(d,h){return this.url.searchParams.append(d,`adj.${h}`),this}overlaps(d,h){return typeof h=="string"?this.url.searchParams.append(d,`ov.${h}`):this.url.searchParams.append(d,`ov.{${h.join(",")}}`),this}textSearch(d,h,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${h}`),this}match(d){return Object.entries(d).forEach(([h,g])=>{this.url.searchParams.append(h,`eq.${g}`)}),this}not(d,h,g){return this.url.searchParams.append(d,`not.${h}.${g}`),this}or(d,{foreignTable:h,referencedTable:g=h}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,h,g){return this.url.searchParams.append(d,`${h}.${g}`),this}}return zl.default=l,zl}var qg;function Hp(){if(qg)return kl;qg=1,Object.defineProperty(kl,"__esModule",{value:!0});const a=hr.__importDefault(Du());class s{constructor(u,{headers:d={},schema:h,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=h,this.fetch=g}select(u,d){const{head:h=!1,count:g}=d??{},p=h?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:h=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(m.length>0){const v=[...new Set(m)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:h=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${h?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const x=u.reduce((_,b)=>_.concat(Object.keys(b)),[]);if(x.length>0){const _=[...new Set(x)].map(b=>`"${b}"`);this.url.searchParams.set("columns",_.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var h;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}delete({count:u}={}){var d;const h="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return kl.default=s,kl}var Ig;function Rv(){if(Ig)return Ol;Ig=1,Object.defineProperty(Ol,"__esModule",{value:!0});const o=hr,a=o.__importDefault(Hp()),s=o.__importDefault(Du());class l{constructor(d,{headers:h={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(h),this.schemaName=g,this.fetch=p}from(d){const h=new URL(`${this.url}/${d}`);return new a.default(h,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,h={},{head:g=!1,get:p=!1,count:m}={}){var v;let x;const _=new URL(`${this.url}/rpc/${d}`);let b;g||p?(x=g?"HEAD":"GET",Object.entries(h).filter(([R,N])=>N!==void 0).map(([R,N])=>[R,Array.isArray(N)?`{${N.join(",")}}`:`${N}`]).forEach(([R,N])=>{_.searchParams.append(R,N)})):(x="POST",b=h);const E=new Headers(this.headers);return m&&E.set("Prefer",`count=${m}`),new s.default({method:x,url:_,headers:E,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return Ol.default=l,Ol}var Hg;function Ov(){if(Hg)return Vt;Hg=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.PostgrestError=Vt.PostgrestBuilder=Vt.PostgrestTransformBuilder=Vt.PostgrestFilterBuilder=Vt.PostgrestQueryBuilder=Vt.PostgrestClient=void 0;const o=hr,a=o.__importDefault(Rv());Vt.PostgrestClient=a.default;const s=o.__importDefault(Hp());Vt.PostgrestQueryBuilder=s.default;const l=o.__importDefault(Du());Vt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Ip());Vt.PostgrestTransformBuilder=u.default;const d=o.__importDefault(qp());Vt.PostgrestBuilder=d.default;const h=o.__importDefault(Mp());return Vt.PostgrestError=h.default,Vt.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:h.default},Vt}var $p=Ov();const Pp=dp($p),kv=fv({__proto__:null,default:Pp},[$p]),{PostgrestClient:zv,PostgrestQueryBuilder:h_,PostgrestFilterBuilder:g_,PostgrestTransformBuilder:p_,PostgrestBuilder:m_,PostgrestError:y_}=Pp||kv;class Uv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const Dv="2.81.1",Bv=`realtime-js/${Dv}`,Vp="1.0.0",Lv="2.0.0",$g=Vp,_u=1e4,Mv=1e3,qv=100;var di;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(di||(di={}));var kt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(kt||(kt={}));var _n;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(_n||(_n={}));var ju;(function(o){o.websocket="websocket"})(ju||(ju={}));var fi;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(fi||(fi={}));class Iv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:h}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(l,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(d,_=>m.setUint8(v++,_.charCodeAt(0))),Array.from(u,_=>m.setUint8(v++,_.charCodeAt(0)));var x=new Uint8Array(p.byteLength+h.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(h),p.byteLength),x.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(v),_=0;x.setUint8(_++,this.KINDS.userBroadcastPush),x.setUint8(_++,u.length),x.setUint8(_++,d.length),x.setUint8(_++,h.length),x.setUint8(_++,g.length),x.setUint8(_++,this.BINARY_ENCODING),Array.from(u,E=>x.setUint8(_++,E.charCodeAt(0))),Array.from(d,E=>x.setUint8(_++,E.charCodeAt(0))),Array.from(h,E=>x.setUint8(_++,E.charCodeAt(0))),Array.from(g,E=>x.setUint8(_++,E.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:h}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,x=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+h.length+g.length,_=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(_),E=0;b.setUint8(E++,this.KINDS.userBroadcastPush),b.setUint8(E++,u.length),b.setUint8(E++,d.length),b.setUint8(E++,h.length),b.setUint8(E++,g.length),b.setUint8(E++,this.JSON_ENCODING),Array.from(u,N=>b.setUint8(E++,N.charCodeAt(0))),Array.from(d,N=>b.setUint8(E++,N.charCodeAt(0))),Array.from(h,N=>b.setUint8(E++,N.charCodeAt(0))),Array.from(g,N=>b.setUint8(E++,N.charCodeAt(0)));var R=new Uint8Array(_.byteLength+v.byteLength);return R.set(new Uint8Array(_),0),R.set(new Uint8Array(v),_.byteLength),R.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,h,g,p]=l;return s({join_ref:u,ref:d,topic:h,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+h));g=g+h;const x=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:x}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),E={status:_,response:b};return{join_ref:m,ref:v,topic:x,event:_n.reply,payload:E}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let h=this.HEADER_LENGTH+2;const g=l.decode(a.slice(h,h+u));h=h+u;const p=l.decode(a.slice(h,h+d));h=h+d;const m=JSON.parse(l.decode(a.slice(h,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),h=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+h));p=p+h;const _=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(_)):_,E={type:this.BROADCAST,event:v,payload:b};return h>0&&(E.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:E}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Gp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var dt;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(dt||(dt={}));const Pg=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,h)=>(d[h]=Hv(h,o,a,u),d),{}):{}},Hv=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,h=s[o];return d&&!l.includes(d)?Kp(d,h):Su(h)},Kp=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return Gv(a,s)}switch(o){case dt.bool:return $v(a);case dt.float4:case dt.float8:case dt.int2:case dt.int4:case dt.int8:case dt.numeric:case dt.oid:return Pv(a);case dt.json:case dt.jsonb:return Vv(a);case dt.timestamp:return Kv(a);case dt.abstime:case dt.date:case dt.daterange:case dt.int4range:case dt.int8range:case dt.money:case dt.reltime:case dt.text:case dt.time:case dt.timestamptz:case dt.timetz:case dt.tsrange:case dt.tstzrange:return Su(a);default:return Su(a)}},Su=o=>o,$v=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Pv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Vv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},Gv=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const h=o.slice(1,s);try{d=JSON.parse("["+h+"]")}catch{d=h?h.split(","):[]}return d.map(g=>Kp(a,g))}return o},Kv=o=>typeof o=="string"?o.replace(" ","T"):o,Fp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class cu{constructor(a,s,l={},u=_u){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Vg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Vg||(Vg={}));class cs{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=cs.syncState(this.state,u,d,h),this.pendingDiffs.forEach(p=>{this.state=cs.syncDiff(this.state,p,d,h)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:h,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=cs.syncDiff(this.state,u,d,h),g())}),this.onJoin((u,d,h)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:h})}),this.onLeave((u,d,h)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:h})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),h=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{h[m]||(p[m]=v)}),this.map(h,(m,v)=>{const x=d[m];if(x){const _=v.map(N=>N.presence_ref),b=x.map(N=>N.presence_ref),E=v.filter(N=>b.indexOf(N.presence_ref)<0),R=x.filter(N=>_.indexOf(N.presence_ref)<0);E.length>0&&(g[m]=E),R.length>0&&(p[m]=R)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:h}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const x=a[g].map(b=>b.presence_ref),_=v.filter(b=>x.indexOf(b.presence_ref)<0);a[g].unshift(..._)}l(g,v,p)}),this.map(h,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(x=>x.presence_ref);m=m.filter(x=>v.indexOf(x.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gg;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Gg||(Gg={}));var us;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(us||(us={}));var sa;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(sa||(sa={}));class Bu{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new cu(this,_n.join,this.params,this.timeout),this.rejoinTimer=new Gp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(h=>h.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=kt.closed,this.socket._remove(this)}),this._onError(h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",h=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,h),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_n.reply,{},(h,g)=>{this._trigger(this._replyEventName(g),h)}),this.presence=new cs(this),this.broadcastEndpointURL=Fp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==kt.closed){const{config:{broadcast:h,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[us.PRESENCE]&&this.bindings[us.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,x={},_={broadcast:h,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(sa.CHANNEL_ERROR,b)),this._onClose(()=>a?.(sa.CLOSED)),this.updateJoinPayload(Object.assign({config:_},x)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var E;if(this.socket.setAuth(),b===void 0){a?.(sa.SUBSCRIBED);return}else{const R=this.bindings.postgres_changes,N=(E=R?.length)!==null&&E!==void 0?E:0,A=[];for(let I=0;I<N;I++){const M=R[I],{filter:{event:G,schema:T,table:L,filter:D}}=M,H=b&&b[I];if(H&&H.event===G&&H.schema===T&&H.table===L&&H.filter===D)A.push(Object.assign(Object.assign({},M),{id:H.id}));else{this.unsubscribe(),this.state=kt.errored,a?.(sa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,a&&a(sa.SUBSCRIBED);return}}).receive("error",b=>{this.state=kt.errored,a?.(sa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(sa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===kt.joined&&a===us.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const h={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:h}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:h,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var h,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(h=this.params)===null||h===void 0?void 0:h.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=kt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_n.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new cu(this,_n.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=kt.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),h=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),h}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new cu(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>qv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const h=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=_n;if(l&&[g,p,m,v].indexOf(h)>=0&&l!==this._joinRef())return;let _=this._onMessage(h,s,l);if(s&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(h)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var E,R,N;return((E=b.filter)===null||E===void 0?void 0:E.event)==="*"||((N=(R=b.filter)===null||R===void 0?void 0:R.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===h}).map(b=>b.callback(_,l)):(d=this.bindings[h])===null||d===void 0||d.filter(b=>{var E,R,N,A,I,M;if(["broadcast","presence","postgres_changes"].includes(h))if("id"in b){const G=b.id,T=(E=b.filter)===null||E===void 0?void 0:E.event;return G&&((R=s.ids)===null||R===void 0?void 0:R.includes(G))&&(T==="*"||T?.toLocaleLowerCase()===((N=s.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const G=(I=(A=b?.filter)===null||A===void 0?void 0:A.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return G==="*"||G===((M=s?.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===h}).map(b=>{if(typeof _=="object"&&"ids"in _){const E=_.data,{schema:R,table:N,commit_timestamp:A,type:I,errors:M}=E;_=Object.assign(Object.assign({},{schema:R,table:N,commit_timestamp:A,eventType:I,new:{},old:{},errors:M}),this._getPayloadRecords(E))}b.callback(_,l)})}_isClosed(){return this.state===kt.closed}_isJoined(){return this.state===kt.joined}_isJoining(){return this.state===kt.joining}_isLeaving(){return this.state===kt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Bu.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(_n.close,{},a)}_onError(a){this._on(_n.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=kt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Pg(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Pg(a.columns,a.old_record)),s}}const uu=()=>{},Ll={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Fv=[1e3,2e3,5e3,1e4],Yv=1e4,Jv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Qv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=_u,this.transport=null,this.heartbeatIntervalMs=Ll.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=uu,this.ref=0,this.reconnectTimer=null,this.vsn=$g,this.logger=uu,this.conn=null,this.sendBuffer=[],this.serializer=new Iv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${ju.websocket}`,this.httpEndpoint=Fp(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Uv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case di.connecting:return fi.Connecting;case di.open:return fi.Open;case di.closing:return fi.Closing;default:return fi.Closed}}isConnected(){return this.connectionState()===fi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Bu(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,h=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?h():this.sendBuffer.push(h)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Mv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Ll.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:h}=s,g=h?`(${h})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,h)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===di.open||this.conn.readyState===di.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(_n.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Jv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:Bv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(_n.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Gp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ll.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,h,g,p,m,v,x,_,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:_u,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Ll.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(h=a?.accessToken)!==null&&h!==void 0?h:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:uu,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:$g,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(E=>Fv[E-1]||Yv),this.vsn){case Vp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((E,R)=>R(JSON.stringify(E))),this.decode=(x=a?.decode)!==null&&x!==void 0?x:((E,R)=>R(JSON.parse(E)));break;case Lv:this.encode=(_=a?.encode)!==null&&_!==void 0?_:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class Lu extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function bt(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Xv extends Lu{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class wu extends Lu{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const Mu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Zv=()=>Response,Eu=o=>{if(Array.isArray(o))return o.map(s=>Eu(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=Eu(l)}),a},Wv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},du=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},eb=(o,a,s)=>Re(void 0,void 0,void 0,function*(){const l=yield Zv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,h=u?.statusCode||d+"";a(new Xv(du(u),d,h))}).catch(u=>{a(new wu(du(u),u))}):a(new wu(du(o),o))}),tb=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Wv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function gs(o,a,s,l,u,d){return Re(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,tb(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>h(p)).catch(p=>eb(p,g,l))})})}function ds(o,a,s,l){return Re(this,void 0,void 0,function*(){return gs(o,"GET",a,s,l)})}function Rn(o,a,s,l,u){return Re(this,void 0,void 0,function*(){return gs(o,"POST",a,l,u,s)})}function Cu(o,a,s,l,u){return Re(this,void 0,void 0,function*(){return gs(o,"PUT",a,l,u,s)})}function nb(o,a,s,l){return Re(this,void 0,void 0,function*(){return gs(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function qu(o,a,s,l,u){return Re(this,void 0,void 0,function*(){return gs(o,"DELETE",a,l,u,s)})}class ab{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return Re(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bt(a))return{data:null,error:a};throw a}})}}var Yp;class ib{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Yp]="BlobDownloadBuilder",this.promise=null}asStream(){return new ab(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Re(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bt(a))return{data:null,error:a};throw a}})}}Yp=Symbol.toStringTag;const rb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class sb{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=Mu(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return Re(this,void 0,void 0,function*(){try{let d;const h=Object.assign(Object.assign({},Kg),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(h.upsert)});const p=h.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",h.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${h.cacheControl}`,g["content-type"]=h.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!h.duplex&&(h.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),x=yield(a=="PUT"?Cu:Rn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},h?.duplex?{duplex:h.duplex}:{}));return{data:{path:m,id:x.Id,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(bt(d))return{data:null,error:d};throw d}})}upload(a,s,l){return Re(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return Re(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),h=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${h}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:Kg.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const x=yield Cu(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:x.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(bt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return Re(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield Rn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),h=new URL(this.url+d.url),g=h.searchParams.get("token");if(!g)throw new Lu("No token returned by API");return{data:{signedUrl:h.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(bt(l))return{data:null,error:l};throw l}})}update(a,s,l){return Re(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return Re(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(bt(u))return{data:null,error:u};throw u}})}copy(a,s,l){return Re(this,void 0,void 0,function*(){try{return{data:{path:(yield Rn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(bt(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return Re(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield Rn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const h=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${h}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(bt(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return Re(this,void 0,void 0,function*(){try{const u=yield Rn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(h=>Object.assign(Object.assign({},h),{signedUrl:h.signedURL?encodeURI(`${this.url}${h.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(bt(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),h=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>ds(this.fetch,`${this.url}/${u}/${g}${h}`,{headers:this.headers,noResolveJson:!0});return new ib(p,this.shouldThrowOnError)}info(a){return Re(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield ds(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:Eu(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(bt(l))return{data:null,error:l};throw l}})}exists(a){return Re(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield nb(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(bt(l)&&l instanceof wu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return Re(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}list(a,s,l){return Re(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},rb),s),{prefix:a||""});return{data:yield Rn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(bt(u))return{data:null,error:u};throw u}})}listV2(a,s){return Re(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield Rn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(bt(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const Jp="2.81.1",Qp={"X-Client-Info":`storage-js/${Jp}`};class lb{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qp),s),this.fetch=Mu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return Re(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield ds(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}getBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:yield ds(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}createBucket(a){return Re(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield Rn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(bt(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return Re(this,void 0,void 0,function*(){try{return{data:yield Cu(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(bt(l))return{data:null,error:l};throw l}})}emptyBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class ob{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qp),s),this.fetch=Mu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:yield Rn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}listBuckets(a){return Re(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield ds(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(bt(s))return{data:null,error:s};throw s}})}}const Iu={"X-Client-Info":`storage-js/${Jp}`,"Content-Type":"application/json"};class Xp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function un(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class fu extends Xp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class cb extends Xp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Fg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Fg||(Fg={}));const Hu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ub=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Yg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),db=(o,a,s)=>Re(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(h=>{const g=h?.statusCode||h?.code||u+"";a(new fu(Yg(h),u,g))}).catch(()=>{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new fu(g,u,h))});else{const h=u+"",g=d.statusText||`HTTP ${u} error`;a(new fu(g,u,h))}}else a(new cb(Yg(o),o))}),fb=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(ub(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function hb(o,a,s,l,u,d){return Re(this,void 0,void 0,function*(){return new Promise((h,g)=>{o(s,fb(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>h(p)).catch(p=>db(p,g,l))})})}function dn(o,a,s,l,u){return Re(this,void 0,void 0,function*(){return hb(o,"POST",a,l,u,s)})}class gb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Iu),s),this.fetch=Hu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return Re(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}getIndex(a,s){return Re(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(un(l))return{data:null,error:l};throw l}})}listIndexes(a){return Re(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return Re(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(un(l))return{data:null,error:l};throw l}})}}class pb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Iu),s),this.fetch=Hu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return Re(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield dn(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}getVectors(a){return Re(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}listVectors(a){return Re(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield dn(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}queryVectors(a){return Re(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}deleteVectors(a){return Re(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield dn(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}}class mb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Iu),s),this.fetch=Hu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}getBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:yield dn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}listBuckets(){return Re(this,arguments,void 0,function*(a={}){try{return{data:yield dn(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Re(this,void 0,void 0,function*(){try{return{data:(yield dn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(un(s))return{data:null,error:s};throw s}})}}class yb extends mb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new vb(this.url,this.headers,a,this.fetch)}}class vb extends gb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Re(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Re(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Re(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Re(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new bb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class bb extends pb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Re(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Re(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Re(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Re(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Re(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class xb extends lb{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new sb(this.url,this.headers,a,this.fetch)}get vectors(){return new yb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new ob(this.url+"/iceberg",this.headers,this.fetch)}}const _b="2.81.1";let os="";typeof Deno<"u"?os="deno":typeof document<"u"?os="web":typeof navigator<"u"&&navigator.product==="ReactNative"?os="react-native":os="node";const jb={"X-Client-Info":`supabase-js-${os}/${_b}`},Sb={headers:jb},wb={schema:"public"},Eb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Cb={},Tb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Ab=()=>Headers,Nb=(o,a,s)=>{const l=Tb(s),u=Ab();return async(d,h)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(h?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},h),{headers:m}))}};function Rb(o){return o.endsWith("/")?o:o+"/"}function Ob(o,a){var s,l;const{db:u,auth:d,realtime:h,global:g}=o,{db:p,auth:m,realtime:v,global:x}=a,_={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),h),storage:{},global:Object.assign(Object.assign(Object.assign({},x),g),{headers:Object.assign(Object.assign({},(s=x?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?_.accessToken=o.accessToken:delete _.accessToken,_}function kb(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Rb(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Zp="2.81.1",or=30*1e3,Tu=3,hu=Tu*or,zb="http://localhost:9999",Ub="supabase.auth.token",Db={"X-Client-Info":`gotrue-js/${Zp}`},Au="X-Supabase-Api-Version",Wp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Bb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Lb=600*1e3;class fs extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function ke(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Mb extends fs{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function qb(o){return ke(o)&&o.name==="AuthApiError"}class hi extends fs{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class Da extends fs{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class An extends Da{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ib(o){return ke(o)&&o.name==="AuthSessionMissingError"}class ar extends Da{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ml extends Da{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class ql extends Da{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Hb(o){return ke(o)&&o.name==="AuthImplicitGrantRedirectError"}class Jg extends Da{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nu extends Da{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function gu(o){return ke(o)&&o.name==="AuthRetryableFetchError"}class Qg extends Da{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class Ru extends Da{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const $l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xg=` 	
\r=`.split(""),$b=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Xg.length;a+=1)o[Xg[a].charCodeAt(0)]=-2;for(let a=0;a<$l.length;a+=1)o[$l[a].charCodeAt(0)]=a;return o})();function Zg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s($l[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s($l[l]),a.queuedBits-=6}}function em(o,a,s){const l=$b[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Wg(o){const a=[],s=h=>{a.push(String.fromCodePoint(h))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=h=>{Gb(h,l,s)};for(let h=0;h<o.length;h+=1)em(o.charCodeAt(h),u,d);return a.join("")}function Pb(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Vb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Pb(l,a)}}function Gb(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function ur(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)em(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Kb(o){const a=[];return Vb(o,s=>a.push(s)),new Uint8Array(a)}function gi(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Zg(u,s,l)),Zg(null,s,l),a.join("")}function Fb(o){return Math.round(Date.now()/1e3)+o}function Yb(){return Symbol("auth-callback")}const It=()=>typeof window<"u"&&typeof document<"u",li={tested:!1,writable:!1},tm=()=>{if(!It())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(li.tested)return li.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),li.tested=!0,li.writable=!0}catch{li.tested=!0,li.writable=!1}return li.writable};function Jb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const nm=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Qb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",cr=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},oi=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},za=async(o,a)=>{await o.removeItem(a)};class Kl{constructor(){this.promise=new Kl.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Kl.promiseConstructor=Promise;function pu(o){const a=o.split(".");if(a.length!==3)throw new Ru("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!Bb.test(a[l]))throw new Ru("JWT not in base64url format");return{header:JSON.parse(Wg(a[0])),payload:JSON.parse(Wg(a[1])),signature:ur(a[2]),raw:{header:a[0],payload:a[1]}}}async function Xb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Zb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const h=await o(d);if(!a(d,null,h)){l(h);return}}catch(h){if(!a(d,h)){u(h);return}}})()})}function Wb(o){return("0"+o.toString(16)).substr(-2)}function e0(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Wb).join("")}async function t0(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function n0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await t0(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ir(o,a,s=!1){const l=e0();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await cr(o,`${a}-code-verifier`,u);const d=await n0(l);return[d,l===d?"plain":"s256"]}const a0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function i0(o){const a=o.headers.get(Au);if(!a||!a.match(a0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function r0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function s0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const l0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function rr(o){if(!l0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function mu(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function o0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function ep(o){return JSON.parse(JSON.stringify(o))}const ui=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),c0=[502,503,504];async function tp(o){var a;if(!Qb(o))throw new Nu(ui(o),0);if(c0.includes(o.status))throw new Nu(ui(o),o.status);let s;try{s=await o.json()}catch(d){throw new hi(ui(d),d)}let l;const u=i0(o);if(u&&u.getTime()>=Wp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Qg(ui(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new An}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,h)=>d&&typeof h=="string",!0))throw new Qg(ui(s),o.status,s.weak_password.reasons);throw new Mb(ui(s),o.status||500,l)}const u0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Be(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[Au]||(d[Au]=Wp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const h=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(h.redirect_to=l.redirectTo);const g=Object.keys(h).length?"?"+new URLSearchParams(h).toString():"",p=await d0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function d0(o,a,s,l,u,d){const h=u0(a,l,u,d);let g;try{g=await o(s,Object.assign({},h))}catch(p){throw console.error(p),new Nu(ui(p),0)}if(g.ok||await tp(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await tp(p)}}function Nn(o){var a;let s=null;g0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Fb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function np(o){const a=Nn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Ua(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function f0(o){return{data:o,error:null}}function h0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,h=fr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},h);return{data:{properties:g,user:p},error:null}}function ap(o){return o}function g0(o){return o.access_token&&o.refresh_token&&o.expires_in}const yu=["global","local","others"];class p0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=nm(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=yu[0]){if(yu.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yu.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(ke(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Ua})}catch(l){if(ke(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=fr(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:h0,redirectTo:s?.redirectTo})}catch(s){if(ke(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Ua})}catch(s){if(ke(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ap});if(v.error)throw v.error;const x=await v.json(),_=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(E=>{const R=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(E.split(";")[1].split("=")[1]);m[`${N}Page`]=R}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(ke(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){rr(a);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Ua})}catch(s){if(ke(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){rr(a);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:Ua})}catch(l){if(ke(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){rr(a);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:Ua})}catch(l){if(ke(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){rr(a.userId);try{const{data:s,error:l}=await Be(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _deleteFactor(a){rr(a.userId),rr(a.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,h,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ap});if(v.error)throw v.error;const x=await v.json(),_=(h=v.headers.get("x-total-count"))!==null&&h!==void 0?h:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(E=>{const R=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(E.split(";")[1].split("=")[1]);m[`${N}Page`]=R}),m.total=parseInt(_)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(ke(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(ke(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(ke(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(ke(s))return{data:null,error:s};throw s}}}function ip(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const sr={debug:!!(globalThis&&tm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class am extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class m0 extends am{}async function y0(o,a,s){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),sr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw sr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new m0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(sr.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function v0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function im(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function b0(o){return parseInt(o,16)}function x0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function _0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:h,notBefore:g,requestId:p,resources:m,scheme:v,uri:x,version:_}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(h&&h.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${h}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(_!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${_}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=im(o.address),E=v?`${v}://${l}`:l,R=o.statement?`${o.statement}
`:"",N=`${E} wants you to sign in with your Ethereum account:
${b}

${R}`;let A=`URI: ${x}
Version: ${_}
Chain ID: ${s}${h?`
Nonce: ${h}`:""}
Issued At: ${d.toISOString()}`;if(u&&(A+=`
Expiration Time: ${u.toISOString()}`),g&&(A+=`
Not Before: ${g.toISOString()}`),p&&(A+=`
Request ID: ${p}`),m){let I=`
Resources:`;for(const M of m){if(!M||typeof M!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${M}`);I+=`
- ${M}`}A+=I}return`${N}
${A}`}class Rt extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Pl extends Rt{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function j0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Rt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new Rt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new Rt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new Rt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new Rt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new Rt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new Rt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new Rt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const h=window.location.hostname;if(rm(h)){if(d.rp.id!==h)return new Rt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Rt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new Rt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new Rt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Rt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function S0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new Rt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new Rt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(rm(l)){if(s.rpId!==l)return new Rt({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new Rt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new Rt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new Rt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class w0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const E0=new w0;function C0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=fr(o,["challenge","user","excludeCredentials"]),d=ur(a).buffer,h=Object.assign(Object.assign({},s),{id:ur(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:h});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:ur(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function T0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=fr(o,["challenge","allowCredentials"]),u=ur(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let h=0;h<s.length;h++){const g=s[h];d.allowCredentials[h]=Object.assign(Object.assign({},g),{id:ur(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function A0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:gi(new Uint8Array(o.response.attestationObject)),clientDataJSON:gi(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function N0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:gi(new Uint8Array(u.authenticatorData)),clientDataJSON:gi(new Uint8Array(u.clientDataJSON)),signature:gi(new Uint8Array(u.signature)),userHandle:u.userHandle?gi(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function rm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function rp(){var o,a;return!!(It()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function R0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Pl("Browser returned unexpected credential type",a)}:{data:null,error:new Pl("Empty credential response",a)}}catch(a){return{data:null,error:j0({error:a,options:o})}}}async function O0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Pl("Browser returned unexpected credential type",a)}:{data:null,error:new Pl("Empty credential response",a)}}catch(a){return{data:null,error:S0({error:a,options:o})}}}const k0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},z0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Vl(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const h=u[d];if(h!==void 0)if(Array.isArray(h))l[d]=h;else if(s(h))l[d]=h;else if(a(h)){const g=l[d];a(g)?l[d]=Vl(g,h):l[d]=Vl(h)}else l[d]=h}return l}function U0(o,a){return Vl(k0,o,a||{})}function D0(o,a){return Vl(z0,o,a||{})}class B0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:h,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!h)return{data:null,error:g};const p=u??E0.createNewAbortSignal();if(h.webauthn.type==="create"){const{user:m}=h.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(h.webauthn.type){case"create":{const m=U0(h.webauthn.credential_options.publicKey,d?.create),{data:v,error:x}=await R0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}case"request":{const m=D0(h.webauthn.credential_options.publicKey,d?.request),{data:v,error:x}=await O0(Object.assign(Object.assign({},h.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:h.id,webauthn:{type:h.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}}}catch(h){return ke(h)?{data:null,error:h}:{data:null,error:new hi("Unexpected error in challenge",h)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new fs("rpId is required for WebAuthn authentication")};try{if(!rp())return{data:null,error:new hi("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!h)return{data:null,error:g};const{webauthn:p}=h;return this._verify({factorId:a,challengeId:h.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(h){return ke(h)?{data:null,error:h}:{data:null,error:new hi("Unexpected error in authenticate",h)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new fs("rpId is required for WebAuthn registration")};try{if(!rp())return{data:null,error:new hi("Browser does not support WebAuthn",null)};const{data:h,error:g}=await this._enroll({friendlyName:a});if(!h)return await this.client.mfa.listFactors().then(v=>{var x;return(x=v.data)===null||x===void 0?void 0:x.all.find(_=>_.factor_type==="webauthn"&&_.friendly_name===a&&_.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:h.id,friendlyName:h.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:h.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(h){return ke(h)?{data:null,error:h}:{data:null,error:new hi("Unexpected error in register",h)}}}}v0();const L0={url:zb,storageKey:Ub,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Db,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function sp(o,a,s){return await s()}const lr={};class hs{get jwks(){var a,s;return(s=(a=lr[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){lr[this.storageKey]=Object.assign(Object.assign({},lr[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=lr[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){lr[this.storageKey]=Object.assign(Object.assign({},lr[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},L0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=hs.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,hs.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&It()){const h=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(h),this.logDebugMessages&&console.trace(h)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new p0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=nm(d.fetch),this.lock=d.lock||sp,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:It()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=y0:this.lock=sp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new B0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:tm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ip(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=ip(this.memoryStorage)),It()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(h){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",h)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async h=>{this._debug("received broadcast notification from other tab or client",h),await this._notifyAllSubscribers(h.data.event,h.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Zp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(It()&&(s=Jb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),It()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Hb(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:h,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",h,"redirect type",g),await this._saveSession(h),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",h):await this._notifyAllSubscribers("SIGNED_IN",h)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return ke(s)?this._returnResult({error:s}):this._returnResult({error:new hi("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:Nn}),{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(ke(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:x,options:_}=a;let b=null,E=null;this.flowType==="pkce"&&([b,E]=await ir(this.storage,this.storageKey)),d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_?.emailRedirectTo,body:{email:v,password:x,data:(s=_?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:_?.captchaToken},code_challenge:b,code_challenge_method:E},xform:Nn})}else if("phone"in a){const{phone:v,password:x,options:_}=a;d=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(l=_?.data)!==null&&l!==void 0?l:{},channel:(u=_?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:_?.captchaToken}},xform:Nn})}else throw new Ml("You must provide either an email or phone number and a password");const{data:h,error:g}=d;if(g||!h)return this._returnResult({data:{user:null,session:null},error:g});const p=h.session,m=h.user;return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(ke(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:h,options:g}=a;s=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:np})}else if("phone"in a){const{phone:d,password:h,options:g}=a;s=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:h,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:np})}else throw new Ml("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new ar;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,h,g,p,m,v,x,_;let b,E;if("message"in a)b=a.message,E=a.signature;else{const{chain:R,wallet:N,statement:A,options:I}=a;let M;if(It())if(typeof N=="object")M=N;else{const ve=window;if("ethereum"in ve&&typeof ve.ethereum=="object"&&"request"in ve.ethereum&&typeof ve.ethereum.request=="function")M=ve.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=N}const G=new URL((s=I?.url)!==null&&s!==void 0?s:window.location.href),T=await M.request({method:"eth_requestAccounts"}).then(ve=>ve).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=im(T[0]);let D=(l=I?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!D){const ve=await M.request({method:"eth_chainId"});D=b0(ve)}const H={domain:G.host,address:L,statement:A,uri:G.href,version:"1",chainId:D,nonce:(u=I?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(h=(d=I?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&h!==void 0?h:new Date,expirationTime:(g=I?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=I?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=I?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=I?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=_0(H),E=await M.request({method:"personal_sign",params:[x0(b),L]})}try{const{data:R,error:N}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:E},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(_=a.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Nn});if(N)throw N;if(!R||!R.session||!R.user){const A=new ar;return this._returnResult({data:{user:null,session:null},error:A})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:N})}catch(R){if(ke(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async signInWithSolana(a){var s,l,u,d,h,g,p,m,v,x,_,b;let E,R;if("message"in a)E=a.message,R=a.signature;else{const{chain:N,wallet:A,statement:I,options:M}=a;let G;if(It())if(typeof A=="object")G=A;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))G=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=A}const T=new URL((s=M?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in G&&G.signIn){const L=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M?.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),I?{statement:I}:null));let D;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")D=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)D=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)E=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),R=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${T.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(u=(l=M?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=M?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((h=M?.signInWithSolana)===null||h===void 0)&&h.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((g=M?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((p=M?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((m=M?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((x=(v=M?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",...M.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const L=await G.signMessage(new TextEncoder().encode(E),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");R=L}}try{const{data:N,error:A}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:gi(R)},!((_=a.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Nn});if(A)throw A;if(!N||!N.session||!N.user){const I=new ar;return this._returnResult({data:{user:null,session:null},error:I})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:A})}catch(N){if(ke(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(a){const s=await oi(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:h}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:Nn});if(await za(this.storage,`${this.storageKey}-code-verifier`),h)throw h;if(!d||!d.session||!d.user){const g=new ar;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:h})}catch(d){if(ke(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:h}=a,g=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:h,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Nn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new ar;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,h;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await ir(this.storage,this.storageKey));const{error:x}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(h=p?.channel)!==null&&h!==void 0?h:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new Ml("You must provide either an email or phone number.")}catch(g){if(ke(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:h,error:g}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:Nn});if(g)throw g;if(!h)throw new Error("An error occurred on token verification.");const p=h.session,m=h.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(ke(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,h;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await ir(this.storage,this.storageKey));const m=await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:f0});return!((d=m.data)===null||d===void 0)&&d.url&&It()&&!(!((h=a.options)===null||h===void 0)&&h.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(ke(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new An;const{error:u}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(ke(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:h}=await Be(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:h,error:g}=await Be(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:h?.message_id},error:g})}throw new Ml("You must provide either an email or phone number and a type")}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await oi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<hu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const h=await oi(this.userStorage,this.storageKey+"-user");h?.user?a.user=h.user:a.user=mu()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const h={value:this.suppressGetSessionWarning};a.user=o0(a.user,h),h.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Ua}):await this._useSession(async s=>{var l,u,d;const{data:h,error:g}=s;if(g)throw g;return!(!((l=h.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new An}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Ua})})}catch(s){if(ke(s))return Ib(s)&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new An;const h=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await ir(this.storage,this.storageKey));const{data:m,error:v}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:h.access_token,xform:Ua});if(v)throw v;return h.user=m.user,await this._saveSession(h),await this._notifyAllSubscribers("USER_UPDATED",h),this._returnResult({data:{user:h.user},error:null})})}catch(l){if(ke(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new An;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:h}=pu(a.access_token);if(h.exp&&(l=h.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(ke(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:h,error:g}=s;if(g)throw g;a=(l=h.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new An;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(ke(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!It())throw new ql("No browser detected.");if(a.error||a.error_description||a.error_code)throw new ql(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Jg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ql("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Jg("No code detected.");const{data:I,error:M}=await this._exchangeCodeForSession(a.code);if(M)throw M;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:h,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!h||!m)throw new ql("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(g);let _=v+x;p&&(_=parseInt(p));const b=_-v;b*1e3<=or&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const E=_-x;v-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,_,v):v-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,_,v);const{data:R,error:N}=await this._getUser(d);if(N)throw N;const A={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:x,expires_at:_,refresh_token:h,token_type:m,user:R.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:a.type},error:null})}catch(l){if(ke(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await oi(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const h=(l=u.session)===null||l===void 0?void 0:l.access_token;if(h){const{error:g}=await this.admin.signOut(h,a);if(g&&!(qb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await za(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Yb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:h}=s;if(h)throw h;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await ir(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(ke(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var h,g,p,m,v;const{data:x,error:_}=d;if(_)throw _;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(h=a.options)===null||h===void 0?void 0:h.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=x.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return It()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(ke(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:h,provider:g,token:p,access_token:m,nonce:v}=a,x=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Nn}),{data:_,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!_||!_.session||!_.user?this._returnResult({data:{user:null,session:null},error:new ar}):(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("USER_UPDATED",_.session)),this._returnResult({data:_,error:b}))}catch(u){if(ke(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)throw h;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Zb(async u=>(u>0&&await Xb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Nn})),(u,d)=>{const h=200*Math.pow(2,u);return d&&gu(d)&&Date.now()+h-l<or})}catch(l){if(this._debug(s,"error",l),ke(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),It()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await oi(this.storage,this.storageKey);if(u&&this.userStorage){let h=await oi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!h&&(h={user:u.user},await cr(this.userStorage,this.storageKey+"-user",h)),u.user=(a=h?.user)!==null&&a!==void 0?a:mu()}else if(u&&!u.user&&!u.user){const h=await oi(this.storage,this.storageKey+"-user");h&&h?.user?(u.user=h.user,await za(this.storage,this.storageKey+"-user"),await cr(this.storage,this.storageKey,u)):u.user=mu()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<hu;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${hu}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:h}=await this._callRefreshToken(u.refresh_token);h&&(console.error(h),gu(h)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",h),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:h,error:g}=await this._getUser(u.access_token);!g&&h?.user?(u.user=h.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(h){console.error("Error getting user data:",h),this._debug(l,"error getting user data, skipping SIGNED_IN notification",h)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new An;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Kl;const{data:d,error:h}=await this._refreshAccessToken(a);if(h)throw h;if(!d.session)throw new An;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),ke(d)){const h={data:null,error:d};return gu(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(h),h}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],h=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(h),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await cr(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=ep(u);await cr(this.storage,this.storageKey,d)}else{const u=ep(s);await cr(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await za(this.storage,this.storageKey),await za(this.storage,this.storageKey+"-code-verifier"),await za(this.storage,this.storageKey+"-user"),this.userStorage&&await za(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&It()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),or);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/or);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${or}ms, refresh threshold is ${Tu} ticks`),u<=Tu&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof am)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!It()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,h]=await ir(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(h)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Be(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:h}=s;if(h)return this._returnResult({data:null,error:h});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?A0(a.webauthn.credential_response):N0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Be(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const h=await Be(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(h.error)return h;const{data:g}=h;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:C0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:T0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=pu(l.access_token);let h=null;d.aal&&(h=d.aal);let g=h;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:h,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Be(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new An})})}catch(s){if(ke(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new An});const h=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&It()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(ke(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new An});const h=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return h.data&&h.data.redirect_url&&It()&&!s?.skipBrowserRedirect&&window.location.assign(h.data.redirect_url),h})}catch(l){if(ke(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Lb>u)return l;const{data:d,error:h}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(h)throw h;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:E}=await this.getSession();if(E||!b.session)return this._returnResult({data:null,error:E});l=b.session.access_token}const{header:u,payload:d,signature:h,raw:{header:g,payload:p}}=pu(l);s?.allowExpired||r0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:h},error:null}}const v=s0(u.alg),x=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,h,Kb(`${g}.${p}`)))throw new Ru("Invalid JWT signature");return{data:{claims:d,header:u,signature:h},error:null}}catch(l){if(ke(l))return this._returnResult({data:null,error:l});throw l}}}hs.nextInstanceID={};const M0=hs;class q0 extends M0{constructor(a){super(a)}}class I0{constructor(a,s,l){var u,d,h;this.supabaseUrl=a,this.supabaseKey=s;const g=kb(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:wb,realtime:Cb,auth:Object.assign(Object.assign({},Eb),{storageKey:p}),global:Sb},v=Ob(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(x,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((h=v.auth)!==null&&h!==void 0?h:{},this.headers,v.global.fetch),this.fetch=Nb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new zv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new xb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Nv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:h,flowType:g,lock:p,debug:m,throwOnError:v},x,_){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new q0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),x),storageKey:h,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(E=>E.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Qv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const H0=(o,a,s)=>new I0(o,a,s);function $0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}$0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const P0="https://sqwqlvsjtimallidxrsz.supabase.co",V0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",ae=H0(P0,V0,{auth:{persistSession:!1}}),jn=Object.freeze(Object.defineProperty({__proto__:null,default:ae,supabase:ae},Symbol.toStringTag,{value:"Module"}));async function Fl(){try{const{data:o,error:a}=await ae.from("empresa").select("*").limit(1).maybeSingle();if(a)throw a;const s=o||null;if(!s)return null;try{const l=s.logo;if(!l)s.logoUrl=null;else if(String(l).startsWith("http"))s.logoUrl=String(l);else{const u="logo";try{const h=(await ae.storage.from(u).getPublicUrl(String(l)))?.data?.publicUrl??null;if(h)s.logoUrl=h;else{const g=await ae.storage.from(u).createSignedUrl(String(l),3600);s.logoUrl=g?.data?.signedUrl??null}}catch{const h="https://sqwqlvsjtimallidxrsz.supabase.co";let g=String(l);g.startsWith(`${u}/`)&&(g=g.slice(u.length+1)),s.logoUrl=`${h}/storage/v1/object/public/${u}/${encodeURIComponent(g)}`}}}catch{s.logoUrl=null}return s}catch(o){return console.warn("getCompanyData error",o),null}}function G0({onLogin:o}){const[a,s]=j.useState(""),[l,u]=j.useState(""),[d,h]=j.useState(null);async function g(p){p.preventDefault(),h(null);try{const{data:m,error:v}=await ae.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){h("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){h("Credenciales invlidas");return}const x=m;if(x.password===l){const _={id:x.id,username:x.username,role:x.role};localStorage.setItem("user",JSON.stringify(_));try{console.debug("Login: stored localStorage.user =",_)}catch{}try{if(x.role==="cajero"){const{data:b,error:E}=await ae.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",x.username).order("id",{ascending:!1}).limit(1);if(!E&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}h("Inicio de sesin correcto"),typeof o=="function"&&o()}else h("Credenciales invlidas")}catch(m){h(m.message||"Error al consultar la base de datos")}}return i.jsx("div",{className:"login-root",children:i.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[i.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),i.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),i.jsxs("div",{className:"login-inner",children:[i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"username",children:"Usuario"}),i.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),i.jsxs("div",{className:"form-field",children:[i.jsx("label",{htmlFor:"password",children:"Contrasea"}),i.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),i.jsx("div",{children:i.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&i.jsx("p",{style:{marginTop:12},children:d}),i.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",i.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function K0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),i.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function F0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!0),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,_]=j.useState(()=>new Date().toISOString().slice(0,16)),[b,E]=j.useState(()=>{try{const A=localStorage.getItem("user");if(A)return JSON.parse(A).username||"usuario"}catch{}return"usuario"});j.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(A=>A.json()).then(A=>{const I=A&&Array.isArray(A.ingresos)?A.ingresos:[],M=localStorage.getItem("ingresosEfectivo");let G=[];try{M&&(G=JSON.parse(M))}catch{}const T=[...I,...G];s(T)}).catch(()=>{const A=localStorage.getItem("ingresosEfectivo");try{A&&s(JSON.parse(A))}catch{s([])}}).finally(()=>u(!1))},[]);function R(A){localStorage.setItem("ingresosEfectivo",JSON.stringify(A))}function N(A){if(A.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const I=a.length?Math.max(...a.map(T=>T.id))+1:1,M={id:I,factura:d||`F-${I}`,motivo:g,monto:Number(m),fechaHora:new Date(x).toISOString(),usuario:b},G=[...a,M];s(G),R(G),h(""),p(""),v(""),_(new Date().toISOString().slice(0,16))}return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?i.jsx("p",{children:"Cargando..."}):i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),i.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),i.jsx("tbody",{children:a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(A=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:{padding:8},children:A.factura}),i.jsx("td",{style:{padding:8},children:A.motivo}),i.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",A.monto.toFixed(2)]}),i.jsx("td",{style:{padding:8},children:new Date(A.fechaHora).toLocaleString()}),i.jsx("td",{style:{padding:8},children:A.usuario})]},A.id))})]})})]}),i.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),i.jsxs("form",{onSubmit:N,style:{display:"grid",gap:8},children:[i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",i.jsx("input",{value:d,onChange:A=>h(A.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",i.jsx("input",{value:g,onChange:A=>p(A.target.value),className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",i.jsx("input",{value:m,onChange:A=>v(A.target.value===""?"":Number(A.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",i.jsx("input",{value:x,onChange:A=>_(A.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",i.jsx("input",{value:b,onChange:A=>E(A.target.value),className:"input",style:{marginTop:6}})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[i.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),i.jsx("button",{type:"button",onClick:()=>{h(""),p(""),v(""),_(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function Y0({onBack:o}){const[a,s]=j.useState([]),[l,u]=j.useState(!1),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(!1),[x,_]=j.useState(!1),[b,E]=j.useState(null),R=async()=>{u(!0);try{const{data:Y,error:oe}=await ae.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(oe)throw oe;const je=Array.isArray(Y)?Y:[],q=Array.from(new Set(je.map(C=>C.cliente_id).filter(Boolean)));let te={};if(q.length>0)try{const{data:C}=await ae.from("clientes").select("id,nombre").in("id",q);if(Array.isArray(C))for(const U of C)te[String(U.id)]=U.nombre||""}catch(C){console.warn("Error cargando nombres de clientes:",C)}const X=je.map(C=>({...C,cliente_nombre:te[String(C.cliente_id)]||null}));s(X)}catch(Y){console.warn("Error cargando cotizaciones:",Y),s([])}u(!1)};j.useEffect(()=>{R()},[]);const[N,A]=j.useState(null),[I,M]=j.useState(null),[G,T]=j.useState(""),L=async Y=>{h(Y);try{const{data:oe,error:je}=await ae.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",Y).maybeSingle();if(je&&console.warn("Error cargando cabecera de cotizacion",je),A(oe||null),oe&&oe.cliente_id)try{const{data:X}=await ae.from("clientes").select("id,nombre").eq("id",oe.cliente_id).maybeSingle();M(X?.nombre||null)}catch{M(null)}else M(null);const{data:q,error:te}=await ae.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Y);if(te)throw te;p(Array.isArray(q)?q:[]),v(!0)}catch(oe){console.warn("Error cargando detalles de cotizacion",oe),p([])}},D=async Y=>{try{const{data:oe,error:je}=await ae.from("cotizaciones_detalle").select("*").eq("cotizacion_id",Y.id),q=Array.isArray(oe)?oe:[],te={header:Y,detalles:q};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(te))}catch(X){console.warn("No se pudo escribir localStorage",X)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:te}))}catch{}o()}catch(oe){console.warn("Error cargando detalles para editar",oe)}},H=async Y=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:oe}=await ae.from("cotizaciones_detalle").delete().eq("cotizacion_id",Y);oe&&console.warn("Error eliminando detalles:",oe);const{error:je}=await ae.from("cotizaciones").delete().eq("id",Y);if(je)throw je;R()}catch(oe){console.warn("Error eliminando cotizacion:",oe)}},ve=async()=>{if(b)try{const Y={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:oe}=await ae.from("cotizaciones").update(Y).eq("id",b.id);if(oe&&console.warn("Error actualizando cotizacion:",oe),b.id){const{error:je}=await ae.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);je&&console.warn("Error borrando detalles antiguos:",je);const q=g.map(X=>({...X,cotizacion_id:b.id})),{error:te}=await ae.from("cotizaciones_detalle").insert(q);te&&console.warn("Error insertando detalles actualizados:",te)}_(!1),R()}catch(Y){console.warn("Error guardando cotizacion editada:",Y)}};return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),i.jsxs("div",{children:[i.jsx("button",{onClick:R,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),i.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),i.jsx("input",{placeholder:"Nmero o cliente",value:G,onChange:Y=>T(Y.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),i.jsx("button",{onClick:()=>T(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?i.jsx("div",{children:"Cargando..."}):a.length===0?i.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Nmero"}),i.jsx("th",{style:{padding:8},children:"Fecha"}),i.jsx("th",{style:{padding:8},children:"Usuario"}),i.jsx("th",{style:{padding:8},children:"Cliente ID"}),i.jsx("th",{style:{padding:8},children:"Total"}),i.jsx("th",{style:{padding:8},children:"Estado"}),i.jsx("th",{style:{padding:8},children:"Acciones"})]})}),i.jsx("tbody",{children:a.filter(Y=>{if(!G)return!0;const oe=G.toLowerCase(),je=(Y.numero_cotizacion||"").toLowerCase(),q=(Y.cliente_nombre||"")?.toLowerCase(),te=(Y.usuario||"").toLowerCase();return je.includes(oe)||q.includes(oe)||te.includes(oe)}).map(Y=>i.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[i.jsx("td",{style:{padding:8},children:Y.numero_cotizacion||""}),i.jsx("td",{style:{padding:8},children:Y.fecha_cotizacion?new Date(Y.fecha_cotizacion).toLocaleString():""}),i.jsx("td",{style:{padding:8},children:Y.usuario||""}),i.jsx("td",{style:{padding:8},children:Y.cliente_nombre||(Y.cliente_id?String(Y.cliente_id):"")}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Y.total||0).toFixed(2)]}),i.jsx("td",{style:{padding:8},children:Y.estado||""}),i.jsxs("td",{style:{padding:8},children:[i.jsx("button",{onClick:()=>L(Y.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(Y.estado||"").toLowerCase()==="aceptada"?i.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):i.jsx("button",{onClick:()=>D(Y),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),i.jsx("button",{onClick:()=>H(Y.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},Y.id))})]})]}),m&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),i.jsx("button",{onClick:()=>{v(!1),p([]),h(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[N&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[i.jsxs("div",{children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Nmero:"})," ",N.numero_cotizacion]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Fecha:"})," ",N.fecha_cotizacion?new Date(N.fecha_cotizacion).toLocaleString():""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Usuario:"})," ",N.usuario]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Cliente:"})," ",I??(N.cliente_id?String(N.cliente_id):"C/F")]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Subtotal:"})," L ",Number(N.subtotal||0).toFixed(2)]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Impuesto:"})," L ",Number(N.impuesto||0).toFixed(2)]}),i.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[i.jsx("strong",{children:"Total:"})," L ",Number(N.total||0).toFixed(2)]})]})]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"Descripcin"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio U."}),i.jsx("th",{style:{padding:8},children:"Subtotal"}),i.jsx("th",{style:{padding:8},children:"Descuento"}),i.jsx("th",{style:{padding:8},children:"Total"})]})}),i.jsx("tbody",{children:g.map((Y,oe)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:Y.descripcion}),i.jsx("td",{style:{padding:8},children:Y.cantidad}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Y.precio_unitario||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Y.subtotal||(Y.precio_unitario||0)*(Y.cantidad||0)).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Y.descuento||0).toFixed(2)]}),i.jsxs("td",{style:{padding:8},children:["L ",Number(Y.total||(Y.subtotal||0)-(Y.descuento||0)).toFixed(2)]})]},oe))})]})]})]})}),x&&b&&i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),i.jsx("button",{onClick:()=>{_(!1),p([]),E(null)},className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{children:"Cliente"}),i.jsx("input",{value:b.cliente||"",onChange:Y=>E({...b,cliente:Y.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),i.jsxs("div",{children:[i.jsx("label",{children:"RTN"}),i.jsx("input",{value:b.rtn||"",onChange:Y=>E({...b,rtn:Y.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[i.jsx("th",{style:{padding:8},children:"SKU"}),i.jsx("th",{style:{padding:8},children:"Nombre"}),i.jsx("th",{style:{padding:8},children:"Cantidad"}),i.jsx("th",{style:{padding:8},children:"Precio"}),i.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),i.jsx("tbody",{children:g.map((Y,oe)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[i.jsx("td",{style:{padding:8},children:Y.sku}),i.jsx("td",{style:{padding:8},children:Y.nombre}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:Y.cantidad||0,onChange:je=>{const q=Number(je.target.value||0),te=[...g];te[oe]={...te[oe],cantidad:q},p(te)},style:{width:80,padding:6}})}),i.jsx("td",{style:{padding:8},children:i.jsx("input",{type:"number",value:Y.precio_unitario||0,onChange:je=>{const q=Number(je.target.value||0),te=[...g];te[oe]={...te[oe],precio_unitario:q},p(te)},style:{width:120,padding:6}})}),i.jsxs("td",{style:{padding:8},children:["L ",Number((Y.precio_unitario||0)*(Y.cantidad||0)).toFixed(2)]})]},oe))})]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:()=>{_(!1),p([]),E(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:ve,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function J0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),i.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function Q0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function X0({onBack:o}){return i.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[i.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),i.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[i.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),i.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function Z0({open:o,onClose:a,onSelect:s}){const[l,u]=j.useState(""),[d,h]=j.useState(!1),[g,p]=j.useState([]);return j.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{h(!0);try{const{data:v,error:x}=await ae.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(x)throw x;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&h(!1)}})(),()=>{m=!1}},[o]),j.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{h(!0);try{const v=String(l||"").trim();let x;if(v===""?x=await ae.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):x=await ae.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),x.error)throw x.error;p(Array.isArray(x.data)?x.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{h(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:i.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),i.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),i.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),i.jsx("th",{style:{padding:8}})]})}),i.jsxs("tbody",{children:[g.map(m=>i.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[i.jsx("td",{style:{padding:8},children:m.rtn}),i.jsx("td",{style:{padding:8},children:m.nombre}),i.jsx("td",{style:{padding:8},children:m.telefono}),i.jsx("td",{style:{padding:8},children:m.correo_electronico}),i.jsx("td",{style:{padding:8},children:i.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&i.jsx("tr",{children:i.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function W0({open:o,onClose:a,totalDue:s,onConfirm:l,exchangeRate:u}){const[d,h]=j.useState([]),[g,p]=j.useState("efectivo"),[m,v]=j.useState(0),[x,_]=j.useState(""),[b,E]=j.useState(""),[R,N]=j.useState(""),[A,I]=j.useState(""),[M,G]=j.useState(""),[T,L]=j.useState(0),[D,H]=j.useState(null);j.useEffect(()=>{o||(h([]),p("efectivo"),v(0),_(""),E(""),N(""),I(""),G(""),H(null))},[o]);const ve=w=>{const O=Number(w);return Number.isFinite(O)?Number(O.toFixed(2)):0},Y=()=>{const w=ve(m);if(w<=0)return;const O={id:String(Date.now())+Math.random().toString(36).slice(2,7),tipo:g,monto:w,usd_monto:g==="dolares"?Number((T||0).toFixed(2)):void 0,banco:x||void 0,tarjeta:b||void 0,factura:R||void 0,autorizador:A||void 0,referencia:M||void 0};h(V=>[...V,O]),v(0),_(""),E(""),N(""),I(""),G("")},oe=w=>{h(O=>O.filter(V=>V.id!==w))},je=d.filter(w=>w.tipo==="efectivo").reduce((w,O)=>w+O.monto,0),q=d.filter(w=>w.tipo==="tarjeta").reduce((w,O)=>w+O.monto,0),te=d.filter(w=>w.tipo==="transferencia").reduce((w,O)=>w+O.monto,0),X=d.filter(w=>w.tipo==="dolares").reduce((w,O)=>w+O.monto,0),C=Number((je+q+te+X).toFixed(2)),U=Number((s-C).toFixed(2)),W=C>=s&&C>0,ue=w=>new Intl.NumberFormat("es-HN",{style:"currency",currency:"HNL"}).format(w).replace("HNL","L"),_e=()=>{const w=[];je>0&&w.push(`efectivo:(${je.toFixed(2)})`),q>0&&w.push(`tarjeta:(${q.toFixed(2)})`),te>0&&w.push(`transferencia:(${te.toFixed(2)})`);const O=w.join(",");l({efectivo:je,tarjeta:q,transferencia:te,totalPaid:C,tipoPagoString:O,pagos:d}),a()};return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:i.jsxs("div",{style:{width:1100,maxWidth:"99%",background:"white",borderRadius:10,padding:16,maxHeight:"94vh",overflow:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),i.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),i.jsxs("div",{style:{marginTop:10,display:"grid",gridTemplateColumns:"1fr 420px",gap:14,fontSize:13},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",i.jsx("strong",{children:ue(s)})]}),i.jsx("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:6,marginBottom:12,fontSize:13},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #efefef"},children:[i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Monto"}),i.jsx("th",{children:"Detalles"}),i.jsx("th",{})]})}),i.jsxs("tbody",{children:[d.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,style:{padding:12,color:"#666"},children:"No hay pagos registrados"})}),d.map(w=>i.jsxs("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[i.jsx("td",{style:{padding:"6px 4px"},children:w.tipo}),i.jsx("td",{style:{padding:"6px 4px"},children:ue(w.monto)}),i.jsxs("td",{style:{padding:"6px 4px",fontSize:12},children:[w.tipo==="efectivo"&&i.jsx("span",{children:""}),w.tipo==="tarjeta"&&i.jsxs("span",{children:[w.banco||"-"," / ",w.tarjeta||"-"," / ",w.factura||"-"]}),w.tipo==="transferencia"&&i.jsxs("span",{children:[w.banco||"-"," / ",w.referencia||"-"]})]}),i.jsx("td",{style:{padding:"8px 4px",textAlign:"right"},children:i.jsx("button",{onClick:()=>H(w.id),className:"btn-opaque","aria-label":"Eliminar pago",title:"Eliminar pago",style:{background:"transparent",border:"none",padding:6,cursor:"pointer",color:"#ef4444"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",focusable:"false",children:[i.jsx("polyline",{points:"3 6 5 6 21 6"}),i.jsx("path",{d:"M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"}),i.jsx("path",{d:"M10 11v6"}),i.jsx("path",{d:"M14 11v6"}),i.jsx("path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"})]})})})]},w.id))]})]})}),i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:8,fontSize:13},children:[i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Efectivo"}),i.jsx("div",{style:{fontWeight:600},children:ue(je)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Tarjeta"}),i.jsx("div",{style:{fontWeight:600},children:ue(q)})]}),i.jsxs("div",{style:{padding:6,borderRadius:6,border:"1px solid #e6edf3",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Transferencia"}),i.jsx("div",{style:{fontWeight:600},children:ue(te)})]}),i.jsxs("div",{style:{marginLeft:"auto",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:12,color:"#666"},children:"Total ingresado"}),i.jsx("div",{style:{fontWeight:700},children:ue(C)}),i.jsx("div",{style:{marginTop:6,color:U>0?"#ef4444":"#16a34a"},children:U>0?`Falta ${ue(U)}`:`Cambio ${ue(Math.abs(U))}`})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e6edf3",borderRadius:8,padding:10,fontSize:13},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de pago"}),i.jsxs("select",{value:g,onChange:w=>{p(w.target.value),v(0),L(0),_(""),E(""),N(""),I(""),G("")},style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"efectivo",children:"Efectivo"}),i.jsx("option",{value:"tarjeta",children:"Tarjeta"}),i.jsx("option",{value:"transferencia",children:"Transferencia"}),i.jsx("option",{value:"dolares",children:"Dlares"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Monto"}),g==="dolares"?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"$"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:T,onChange:w=>{const O=ve(w.target.value);L(O);const V=Number((O*u).toFixed(2));v(V)},style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"L (convertido)"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:m,readOnly:!0,style:{width:"100%",padding:6,borderRadius:6,fontSize:13,background:"#f9fafb"}})]})]}):i.jsx("input",{type:"number",min:0,step:"0.01",value:m,onChange:w=>v(ve(w.target.value)),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),g==="dolares"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tipo de cambio (Lps por $)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("div",{style:{fontSize:14,fontWeight:600},children:[u.toFixed(2)," L"]}),i.jsx("div",{style:{fontSize:13,color:"#666"},children:"(Editable en el encabezado de Punto de Ventas)"})]})]}),g==="efectivo"&&i.jsx("div",{style:{fontSize:13,color:"#444",marginBottom:8},children:'Pago en efectivo: solo indique el monto y presione "Agregar".'}),g==="tarjeta"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:w=>_(w.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras "}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente "}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas "}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda "}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores "}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Tarjeta (ltimos 4)"}),i.jsx("input",{value:b,onChange:w=>E(w.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Factura"}),i.jsx("input",{value:R,onChange:w=>N(w.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Autorizador"}),i.jsx("input",{value:A,onChange:w=>I(w.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]})]}),g==="transferencia"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Banco"}),i.jsxs("select",{value:x,onChange:w=>_(w.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13},children:[i.jsx("option",{value:"",children:"-- Seleccionar banco --"}),i.jsx("option",{value:"BAC Honduras",children:"BAC Honduras  (Banco de Amrica Central Honduras)"}),i.jsx("option",{value:"Banco Atlntida",children:"Banco Atlntida"}),i.jsx("option",{value:"Banco de Occidente",children:"Banco de Occidente  Banocc"}),i.jsx("option",{value:"Banco Ficohsa",children:"Banco Ficohsa"}),i.jsx("option",{value:"Banco Banpas",children:"Banco Banpas  (Banco del Pas)"}),i.jsx("option",{value:"Banco Davivienda",children:"Banco Davivienda  Davi"}),i.jsx("option",{value:"Banco Promrica",children:"Banco Promrica"}),i.jsx("option",{value:"Banco Lafise",children:"Banco Lafise"}),i.jsx("option",{value:"Banco Ficensa",children:"Banco Ficensa"}),i.jsx("option",{value:"Banco de los Trabajadores",children:"Banco de los Trabajadores  BanTrab"}),i.jsx("option",{value:"Banco Azteca",children:"Banco Azteca"}),i.jsx("option",{value:"Banrural Honduras",children:"Banrural Honduras"}),i.jsx("option",{value:"Banco Hondureo del Caf",children:"Banco Hondureo del Caf"})]})]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Referencia"}),i.jsx("input",{value:M,onChange:w=>G(w.target.value),style:{width:"100%",padding:6,borderRadius:6,fontSize:13}})]})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:10},children:[i.jsx("button",{onClick:Y,className:"btn-opaque",style:{background:"#0ea5a4",color:"white",padding:"6px 10px",borderRadius:6,fontSize:13},children:"Agregar"}),i.jsx("button",{onClick:()=>{v(s-C)},className:"btn-opaque",style:{background:"transparent",fontSize:13},children:"Exacto"})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",fontSize:13,padding:"6px 10px"},children:"Cancelar"}),i.jsx("button",{onClick:_e,className:"btn-opaque",disabled:!W,style:{background:W?"#16a34a":"gray",color:"white",fontSize:13,padding:"6px 12px"},children:"Registrar y guardar venta"})]}),D&&i.jsx("div",{role:"dialog","aria-modal":"true",onClick:()=>H(null),style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:12e3},children:i.jsxs("div",{onClick:w=>w.stopPropagation(),style:{width:360,background:"white",borderRadius:8,padding:14,boxShadow:"0 10px 30px rgba(0,0,0,0.15)",position:"relative"},children:[i.jsx("button",{"aria-label":"Cerrar",title:"Cerrar",onClick:()=>H(null),style:{position:"absolute",right:8,top:8,background:"transparent",border:"none",padding:6,cursor:"pointer",color:"#666"},children:i.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[i.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),i.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),i.jsx("div",{style:{fontWeight:700,marginBottom:6},children:"Confirmar eliminacin"}),i.jsx("div",{style:{marginBottom:12},children:"Eliminar este pago? Esta accin no se puede deshacer."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{onClick:()=>H(null),className:"btn-opaque",style:{background:"transparent",padding:"6px 10px"},children:"Cancelar"}),i.jsx("button",{onClick:()=>{D&&(oe(D),H(null))},className:"btn-opaque",style:{background:"#ef4444",color:"white",padding:"6px 10px"},children:"Eliminar"})]})]})})]})}):null}function ex({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:h}){return i.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:i.jsxs("tr",{children:[i.jsx("th",{style:u}),i.jsx("th",{style:u,children:"Imagen"}),i.jsx("th",{style:u,children:"SKU"}),i.jsx("th",{style:u,children:"Nombre"}),i.jsx("th",{style:u,children:"Categora"}),i.jsx("th",{style:u,children:"Precio"}),i.jsx("th",{style:u,children:"Stock"}),i.jsx("th",{style:u,children:"Accin"})]})}),i.jsx("tbody",{children:o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>i.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[i.jsx("td",{style:d,children:i.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),i.jsx("td",{style:d,children:a[String(g.id)]?i.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?i.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),i.jsx("td",{style:d,children:i.jsx("code",{style:h,children:g.sku})}),i.jsx("td",{style:d,children:i.jsx("strong",{children:g.nombre})}),i.jsx("td",{style:d,children:i.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),i.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return i.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),i.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,x=v?p<1?"Agotado":"Sin precio":"Agregar";return i.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:x})})()})]},g.id))})]})})}function tx({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:h,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:x}){return i.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&i.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&i.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[i.jsx("span",{children:"TOTAL:"}),i.jsxs("span",{children:["L",m.toFixed(2)]})]})," ",i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[i.jsx("span",{children:"Subtotal:"}),i.jsxs("span",{children:["L",u.toFixed(2)]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[i.jsxs("div",{children:["ISV (",h*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.isv||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto 18%: ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.imp18||0),0)).toFixed(2)]})]}),i.jsxs("div",{children:["Impuesto turstico (",p*100,"%): ",i.jsxs("strong",{children:["L",Number(d.reduce((_,b)=>_+(b.tur||0),0)).toFixed(2)]})]})]})}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:i.jsxs("details",{style:{marginTop:6},children:[i.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),i.jsx("div",{style:{marginTop:8},children:d.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[i.jsxs("div",{style:{color:"#0f172a"},children:[_.nombre,"  L",_.price.toFixed(2)]}),i.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",_.isv.toFixed(2),"  18%: L",_.imp18.toFixed(2),"  Tur: L",_.tur.toFixed(2)]})]},String(_.id)))})]})}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[i.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),i.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?i.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):i.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(_=>i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",_.producto.sku,"] ",_.producto.nombre]}),i.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(_.producto.precio||0).toFixed(2)," c/u"]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("button",{onClick:()=>a(_.producto.id,-1),style:x,children:""}),i.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:_.cantidad}),i.jsx("button",{onClick:()=>a(_.producto.id,1),style:x,children:"+"}),i.jsx("button",{onClick:()=>s(_.producto.id),style:{...x,background:"#ef4444"},children:""})]})]},_.producto.id))})]})}function nx({userName:o,userRole:a,userId:s,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:h,onPrintFormatChange:g,printFormat:p}){const[m,v]=j.useState(!1),x=j.useRef(null),[_,b]=j.useState(null),[E,R]=j.useState(null);return j.useEffect(()=>{function N(A){x.current&&!x.current.contains(A.target)&&v(!1)}return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),j.useEffect(()=>{let N=!0;return(async()=>{try{const A=await Fl();if(!N||!A)return;const I=A.nombre||A.comercio||A.name||null,M=A.logoUrl||A.logo||null;I&&b(String(I)),M&&R(String(M))}catch{}})(),()=>{N=!1}},[]),i.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[E?i.jsx("img",{src:E,alt:"logo",style:{width:40,height:40,objectFit:"contain",borderRadius:6}}):null,i.jsx("div",{style:{margin:0,fontSize:"1.05rem",fontWeight:700},children:_||"Punto de Ventas"})]}),i.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[i.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),i.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""}),s!=null&&i.jsxs("div",{style:{fontSize:"0.75rem",color:"#cbd5e1",marginTop:2},children:["ID: ",String(s)]})]}),i.jsxs("div",{style:{position:"relative"},ref:x,children:[i.jsxs("div",{style:{position:"absolute",right:120,top:10,display:"flex",alignItems:"center",gap:8},children:[i.jsx("label",{style:{color:"#e2e8f0",fontSize:12},children:"Impresin"}),i.jsxs("div",{style:{display:"flex",background:"#0b1724",padding:4,borderRadius:20},children:[i.jsx("button",{onClick:()=>{g&&g("carta")},className:"btn-opaque",style:{padding:"6px 8px",background:p==="carta"?"#0ea5e9":"transparent",color:"#e2e8f0",borderRadius:12},children:"Carta"}),i.jsx("button",{onClick:()=>{g&&g("cinta")},className:"btn-opaque",style:{padding:"6px 8px",background:p==="cinta"?"#0ea5e9":"transparent",color:"#e2e8f0",borderRadius:12},children:"Cinta"})]})]}),i.jsx("button",{onClick:()=>v(N=>!N),"aria-expanded":m,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),m&&i.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[i.jsx("button",{onClick:()=>{v(!1),d()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),i.jsx("button",{onClick:()=>{v(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),i.jsx("button",{onClick:()=>{v(!1),h("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),i.jsx("button",{onClick:()=>{v(!1),h("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),i.jsx("button",{onClick:()=>{v(!1),h("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),i.jsx("button",{onClick:()=>{v(!1),h("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),i.jsx("button",{onClick:()=>{v(!1),h("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),i.jsx("button",{onClick:()=>{v(!1),h("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function ax({open:o,onClose:a,width:s=520,children:l,zIndex:u=9999}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:i.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:s,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})}):null}function ix({open:o,onClose:a,caiInfo:s,onRefresh:l}){const[u,d]=ku.useState(!1);return i.jsx(ax,{open:o,onClose:a,width:520,children:i.jsxs("div",{children:[i.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),i.jsxs("div",{style:{color:"#475569",marginTop:8},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"CAI:"})," ",s?.cai??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Identificador:"})," ",s?.identificador??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango desde:"})," ",s?.rango_de??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Rango hasta:"})," ",s?.rango_hasta??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Fecha lmite emisin:"})," ",s?.fecha_vencimiento??s?.fecha_limite_emision??"-"]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Secuencia actual:"})," ",s?.secuencia_actual??"-"]})]}),i.jsxs("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"}),i.jsx("button",{className:"btn-opaque",style:{padding:"8px 12px"},disabled:u,onClick:async()=>{if(l)try{d(!0),await l()}catch(h){console.debug("Error calling onRefresh from DatosFacturaModal:",h)}finally{d(!1)}},children:u?"Actualizando...":"Actualizar"})]})]})})}function rx({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),i.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?i.jsx("div",{children:i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?i.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):i.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),i.jsxs("div",{style:{flex:1},children:[i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"SKU:"})," ",a.sku]}),i.jsxs("p",{style:{margin:"6px 0"},children:[i.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),i.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),i.jsxs("p",{style:{margin:0},children:[i.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),i.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:i.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):i.jsx("div",{children:i.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function sx({open:o,onClose:a,onCancel:s,onSave:l}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[i.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),i.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function lx({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:h,taxRate:g,taxableSubtotal:p}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsx("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[i.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Consumidor final"})]}),i.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar datos del cliente"})]}),i.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontSize:28},children:""}),i.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),i.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Razn social / RTN"})]})]})]})})}):null}function ox({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:h,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:x,onTelefonoChange:_,onCorreoChange:b,onExoneradoChange:E,onCreateCliente:R,onCancel:N,onOpenCreateCliente:A,onOpenPayment:I,paymentDone:M,submitClienteNormal:G}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{value:l,onChange:T=>v(T.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&i.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),i.jsx("input",{value:u,onChange:T=>x(T.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx(Z0,{open:p,onClose:()=>m(!1),onSelect:T=>{try{if(T&&typeof T=="object"){const L=T.rtn||"",D=T.nombre||"",H=T.telefono||"",ve=T.correo_electronico||"",Y=!!T.exonerado;try{v(String(L||""))}catch{}try{x(String(D||""))}catch{}try{_(String(H||""))}catch{}try{b(String(ve||""))}catch{}try{E(!!Y)}catch{}}}catch{}m(!1)}}),i.jsx("button",{onClick:N,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:A,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),M?i.jsx("button",{onClick:G,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):i.jsx("button",{onClick:I,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function cx({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:h,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:x,onCreate:_}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),i.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),i.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",i.jsx("strong",{children:"juridico"}),"."]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),i.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),i.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),i.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[i.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),i.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{id:"exon",type:"checkbox",checked:h,onChange:b=>x(b.target.checked)}),i.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),i.jsx("button",{onClick:async()=>{await _()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})}):null}async function lp(o={},a="factura",s={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const k=await Fl();k&&(l=l||k.nombre||k.comercio||l,u=u||k.rtn||u,d=d||k.direccion||k.direccion_fiscal||d,h=h||k.telefono||k.telefono_fijo||h,g=g||k.email||k.correo||g,p=p||k.logoUrl||k.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const k=await fetch(String(p),{mode:"cors"});if(k.ok){const ne=await k.blob(),me=await new Promise(Se=>{const Ae=new FileReader;Ae.onloadend=()=>{Se(typeof Ae.result=="string"?Ae.result:null)},Ae.onerror=()=>{Se(null)},Ae.readAsDataURL(ne)});me&&(p=me)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",E=o.identificador||o.identificadorCAI||"";try{let k=o.caiInfo||null;if(!k&&typeof window<"u"){const ne=window.localStorage.getItem("caiInfo");if(ne)try{k=JSON.parse(ne)}catch{k=null}}if(k&&(v=v||k.cai||k.CAI||"",x=x||k.fecha_vencimiento||k.fecha_limite_emision||"",_=_||k.rango_de||k.rangoDesde||"",b=b||k.rango_hasta||k.rangoHasta||"",E=E||k.identificador||"",!m))try{const ne=k.identificador?String(k.identificador):"",me=k.secuencia_actual!=null?String(k.secuencia_actual):k.rango_de!=null?String(k.rango_de):"",Se=String(me).replace(/[^0-9]/g,"")||"";let Ae=0;(k.rango_hasta||k.rango_de)&&(Ae=Math.max(String(k.rango_hasta||k.rango_de).length,Se.length));const De=Se?String(Se).padStart(Ae||Se.length||1,"0"):"";m=(ne||"")+(De||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const R=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),N=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||s.identidad||"C/F",A=new Date().toLocaleString(),I=Array.isArray(s.carrito)?s.carrito:[],M=typeof s.subtotal=="number"?s.subtotal:I.reduce((k,ne)=>k+Number(ne.producto&&ne.producto.precio||ne.precio||0)*(ne.cantidad||1),0),G=typeof s.descuento=="number"?s.descuento:0,T=typeof s.exonerado=="number"?s.exonerado:0,L=typeof s.gravado=="number"?s.gravado:M,D=typeof s.exento=="number"?s.exento:0,H=typeof s.isvTotal=="number"?s.isvTotal:0,ve=typeof s.imp18Total=="number"?s.imp18Total:0,Y=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,oe=typeof s.total=="number"?s.total:null,je=M+(H||0)+(ve||0)+(Y||0),q=oe??je,te=q,X=s.pagos||{},C=typeof X.efectivo=="number"?X.efectivo:typeof s.Efectivo=="number"?s.Efectivo:0,U=typeof X.tarjeta=="number"?X.tarjeta:typeof s.Tarjeta=="number"?s.Tarjeta:0,W=typeof X.transferencia=="number"?X.transferencia:typeof s.Transferencia=="number"?s.Transferencia:0,ue=typeof X.totalPaid=="number"?X.totalPaid:C+U+W;let _e;if(typeof X.cambio=="number")_e=X.cambio;else if(typeof s.cambio=="number")_e=s.cambio;else{const k=Number(ue)-Number(te||0);_e=isNaN(k)?0:k>0?k:0}const O=I.map(k=>{const ne=String(k.producto&&(k.producto.nombre||k.producto.descripcion)||k.descripcion||k.nombre||""),me=Number(k.cantidad||0),Se=Number((k.producto&&(k.producto.precio??k.producto.precio_unitario))??k.precio_unitario??k.precio??0),Ae=!!(k.producto&&k.producto.exento)||!!k.exento,De=!!(k.producto&&k.producto.aplica_impuesto_18)||!!k.aplica_impuesto_18,qe=!!(k.producto&&k.producto.aplica_impuesto_turistico)||!!k.aplica_impuesto_turistico,Ze=De?s.tax18Rate??s.tax18??0:s.taxRate??s.tax??0,mt=qe?s.taxTouristRate??s.taxTourist??0:0,yt=(Number(Ze)||0)+(Number(mt)||0);let ft=Se;!Ae&&yt>0&&(ft=Se/(1+yt));const wt=Number(ft||0).toFixed(2),Ht=ft*me,tt=Number(Ht||0).toFixed(2);return`<tr><td>${k.producto&&k.producto.sku||k.sku||""} ${ne}</td><td style="text-align:center">${me}</td><td style="text-align:right">L ${wt}</td><td style="text-align:right">L ${tt}</td></tr>`}).join(`
`),V=(Number(C)||0)+(Number(W)||0)+(Number(U)||0)-(Number(_e)||0),J=isNaN(V)?0:V,he=ux(J);return`
<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Factura Detallada</title>
	<style>
		/* === 1. Estilos Base y Reset de Impresin === */
		@page {
			size: letter;
			margin: 0.5in; /* Reducido a 0.5in para mejor uso del espacio */
		}

		* {
			/* Mantener la configuracin de negrita y espaciado ajustado para factura */
			font-weight: bold !important;
			letter-spacing: 0 !important;
			word-spacing: 0 !important;
			margin: 0;
			padding: 0;
			line-height: 1.2 !important; /* Ligeramente aumentado para legibilidad */
			box-sizing: border-box;
		}

		body {
			font-family: 'Arial', sans-serif;
			font-size: 10px;
			color: #000;
			margin: 0;
			padding: 0;
		}

		/* === 2. Estructura Principal === */
		.factura-container {
			width: 100%;
			max-width: 8.5in;
			margin: 0 auto;
			padding: 0.25in; /* Espaciado interno general */
		}

		.divider {
			border: none;
			border-top: 1px solid #000;
			margin: 5px 0;
		}

		/* === 3. Encabezado de Factura === */
		.header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			margin-bottom: 10px;
		}

		.header img {
			width: 200px; /* Tamao ajustado para armona */
			height: auto;
			object-fit: contain;
			margin-right: 20px;
		}

		.header-title {
			font-size: 35px; /* Reducido ligeramente para balance */
			color: #0066CC;
			text-align: right;
			flex-grow: 1;
		}

		/* === 4. Secciones de Informacin === */
		.info-section h3, .info-section p {
			font-size: 11px;
			margin-bottom: 2px;
		}

		.info-dates {
			text-align: right;
			margin-bottom: 5px;
		}
		
		.info-dates p {
			font-size: 10px;
			margin: 1px 0;
		}

		/* === 5. Tabla de Productos === */
		.tabla {
			width: 100%;
			border-collapse: collapse;
			margin-top: 8px;
			font-size: 10px;
		}

		.tabla th, .tabla td {
			border: 1px solid #000;
			padding: 4px 6px; /* Aumentado para mejor legibilidad */
			text-align: left;
		}

		.tabla th {
			background-color: #555; /* Oscurecido a un gris ms formal */
			color: white;
			text-transform: uppercase;
		}

		.tabla td:nth-child(2), .tabla td:nth-child(3), .tabla td:nth-child(4) {
			text-align: right; /* Alineacin de nmeros */
		}

		/* === 6. Totales y Pagos === */
		.totals-section {
			margin-top: 5px;
			display: grid;
			grid-template-columns: 1fr 1fr; /* Para asegurar alineacin de etiquetas y valores */
			gap: 2px 0;
		}

		.totals-section p {
			display: contents; /* Permite que el span .right se alinee al final de la columna */
		}

		.totals-section span.label {
			text-align: left;
			padding-left: 2px;
		}

		.totals-section span.value {
			text-align: right;
			padding-right: 2px;
		}
		
		.total-final {
			font-size: 11px;
			margin-top: 5px;
			border-top: 1px solid #000;
			padding-top: 3px;
		}

		/* === 7. Pie de Factura === */
		.footer-info {
			text-align: center;
			margin-top: 10px;
			font-size: 10px;
		}
		
		.letras {
			font-size: 11px;
			margin: 5px 0;
			text-align: center;
		}

		.firma-section {
			margin-top: 15px;
			display: flex;
			justify-content: space-around;
			text-align: center;
		}

		.copias-info {
			text-align: center;
			margin-top: 8px;
		}

		.final-message {
			font-size: 10px;
			text-align: center;
			margin-top: 10px;
		}
		
		/* === 8. Media Print Overrides (Mejorado) === */
		@media print {
			.tabla th {
				/* Asegurar colores de encabezado de tabla en la impresin */
				background-color: #555 !important;
				color: white !important;
				-webkit-print-color-adjust: exact;
				print-color-adjust: exact;
			}
			.factura-container {
				box-shadow: none;
				border-radius: 0;
			}
			/* Se puede aadir ms ajustes si la impresin recorta elementos */
		}

			/* Forzar que navegadores impriman colores de fondo y estilos exactos */
			html, body, .factura-container, .header, .header-title, .header-title-container, .tabla, .tabla th, .totals-section, .total-final, .footer-info {
				-webkit-print-color-adjust: exact !important;
				print-color-adjust: exact !important;
				color-adjust: exact !important;
			}

			/* Reforzar en la regla de impresin para asegurar compatibilidad */
			@media print {
				.header-title { color: #0066CC !important; }
				.tabla th { background-color: #555 !important; color: #fff !important; }
				.totals-section, .total-final { background-color: transparent !important; }
			}
			.header-title-container {
    text-align: right;
}

.numero-factura {
    font-size: 24px;   /* Tamao grande */
    color: #000;       /* Negro */
    margin-top: -5px;  /* Ajuste opcional para acercarlo al ttulo */
}

	</style>
</head>
<body>
	<main class="factura-container">

		<header class="header">
    <img src="${p}" alt="Logo del Comercio" />
    <div class="header-title-container">
        <h1 class="header-title">FACTURA</h1>
        <h2 class="numero-factura">No. ${m}</h2>
    </div>
</header>

		<hr class="divider" />

		<section class="info-section">
			<h3>${l}</h3>
			<p>RTN: ${u}</p>
			<p>Direccin: ${d}</p>
			<p>Telfono: ${h}</p>
			<p>Email: ${g}</p>
		</section>
		<hr class="divider" />

		<section class="info-dates">
			<p>Fecha y hora: ${A}</p>
			<p>Factura No: ${m}</p>
			<p>CAI: ${v}</p>
			<p>Fecha lmite de emisin: ${x}</p>
			<p>Rango autorizado: ${E?E+" "+_+" al "+E+" "+b:_+" al "+b}</p>
		</section>
		<hr class="divider" />

		<section class="info-section">
			<p>Cliente: ${R}</p>
			<p>RTN Cliente: ${N}</p>
		</section>
		<hr class="divider" />

		<section class="details-section">
			<table class="tabla">
				<thead>
					<tr>
						<th>Descripcin</th>
						<th style="width: 10%;">Cant</th>
							<th style="width: 15%;">Precio unitario</th>
							<th style="width: 15%;">Total</th>
					</tr>
				</thead>
				<tbody>
					${O} </tbody>
			</table>
		</section>
		<hr class="divider" />

	<section class="totals-section">
    <span class="label">Descuento:</span> <span class="value">L ${G.toFixed(2)}</span>
    <span class="label">Sub Total Exonerado:</span> <span class="value">L ${Number(T).toFixed(2)}</span>
    <span class="label">Sub Total Gravado:</span> <span class="value">L ${Number(L).toFixed(2)}</span>
    <span class="label">Sub Total Exento:</span> <span class="value">L ${Number(D).toFixed(2)}</span>
    <span class="label">Tasa Turstica 4%:</span> <span class="value">L ${Number(Y).toFixed(2)}</span>
    <span class="label">ISV 15%:</span> <span class="value">L ${Number(H).toFixed(2)}</span>
    <span class="label">ISV 18%:</span> <span class="value">L ${Number(ve).toFixed(2)}</span>
</section>

<section class="transaccion-section"><hr class="divider" />
    <span class="label">TOTAL TRANSACCIN:</span>
    <span class="value">L ${Number(q).toFixed(2)}</span>
</section>

<hr class="divider" />


		<section class="totals-section total-final">
			<span class="label">**TOTAL FACTURA:**</span> <span class="value">**L ${te.toFixed(2)}**</span>
			<span class="label">Efectivo:</span> <span class="value">L ${Number(C).toFixed(2)}</span>
			<span class="label">Tarjeta:</span> <span class="value">L ${Number(U).toFixed(2)}</span>
			<span class="label">Transferencia:</span> <span class="value">L ${Number(W).toFixed(2)}</span>
			<span class="label">Cambio:</span> <span class="value">L ${Number(_e).toFixed(2)}</span>
		</section>
		<hr class="divider" />

		<footer class="footer-info">
			<div class="letras">
				<p>Total Pagado: L ${J.toFixed(2)}</p>
				<p>*** ${he} Lempiras ***</p>
			</div>
			<hr class="divider" />
			
			<div class="firma-section">
				<p>Firma del Cliente: ______________________</p>
				<p>Firma del Emisor: ______________________</p>
			</div>
			
			<div class="copias-info">
				<p>Original: Cliente | Copia: Obligado tributario emisor</p>
			</div>
			
			<div class="final-message">
				<h5>Para cualquier reclamo debe presentar su factura</h5>
				<h5>Gracias por su compra!</h5>
				<h5>LA FACTURA ES BENEFICIO DE TODOS EXJALA!</h5>
			</div>
		</footer>

	</main>
</body>
</html>`}function ux(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const x=Math.floor(v/10),_=v%10;return s[x]+(_?" y "+a[_]:"")}if(v<1e3){const x=Math.floor(v/100),_=v%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let x=u(v);m===2&&v===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}async function op(o={},a="factura",s={}){let l=o.comercio||"",u=o.companyRTN||o.rtnEmpresa||o.RTN||"",d=o.direccion||"",h=o.telefono||"",g=o.email||o.EM||"",p=o.logo||o.logoUrl||o.logo_src||null;if(!l||!u||!d||!h||!g||!p)try{const k=await Fl();k&&(l=l||k.nombre||k.comercio||l,u=u||k.rtn||u,d=d||k.direccion||k.direccion_fiscal||d,h=h||k.telefono||k.telefono_fijo||h,g=g||k.email||k.correo||g,p=p||k.logoUrl||k.logo||p)}catch{}if(p&&typeof window<"u"&&o.inlineLogo!==!1)try{if(!String(p).startsWith("data:")){const k=await fetch(String(p),{mode:"cors"});if(k.ok){const ne=await k.blob(),me=await new Promise(Se=>{const Ae=new FileReader;Ae.onloadend=()=>{Se(typeof Ae.result=="string"?Ae.result:null)},Ae.onerror=()=>{Se(null)},Ae.readAsDataURL(ne)});me&&(p=me)}}}catch{}let m=o.factura||"",v=o.CAI||o.cai||"",x=o.fechaLimiteEmision||o.fecha_limite_emision||o.fecha_vencimiento||"",_=o.rangoAutorizadoDe||o.rango_desde||"",b=o.rangoAutorizadoHasta||o.rango_hasta||"",E=o.identificador||o.identificadorCAI||"";try{let k=o.caiInfo||null;if(!k&&typeof window<"u"){const ne=window.localStorage.getItem("caiInfo");if(ne)try{k=JSON.parse(ne)}catch{k=null}}if(k&&(v=v||k.cai||k.CAI||"",x=x||k.fecha_vencimiento||k.fecha_limite_emision||"",_=_||k.rango_de||k.rangoDesde||"",b=b||k.rango_hasta||k.rangoHasta||"",E=E||k.identificador||"",!m))try{const ne=k.identificador?String(k.identificador):"",me=k.secuencia_actual!=null?String(k.secuencia_actual):k.rango_de!=null?String(k.rango_de):"",Se=String(me).replace(/[^0-9]/g,"")||"";let Ae=0;(k.rango_hasta||k.rango_de)&&(Ae=Math.max(String(k.rango_hasta||k.rango_de).length,Se.length));const De=Se?String(Se).padStart(Ae||Se.length||1,"0"):"";m=(ne||"")+(De||String(Math.floor(Math.random()*9e5)+1e5))}catch{m=String(Math.floor(Math.random()*9e5)+1e5)}}catch{}m||(m=String(Math.floor(Math.random()*9e5)+1e5));const R=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),N=o.identidad||o.rtnCliente||o.clientRTN||o.rtn||s.identidad||"C/F",A=new Date().toLocaleString(),I=Array.isArray(s.carrito)?s.carrito:[],M=typeof s.subtotal=="number"?s.subtotal:I.reduce((k,ne)=>k+Number(ne.producto&&ne.producto.precio||ne.precio||0)*(ne.cantidad||1),0),G=typeof s.descuento=="number"?s.descuento:0,T=typeof s.exonerado=="number"?s.exonerado:0,L=typeof s.gravado=="number"?s.gravado:M,D=typeof s.exento=="number"?s.exento:0,H=typeof s.isvTotal=="number"?s.isvTotal:0,ve=typeof s.imp18Total=="number"?s.imp18Total:0,Y=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,oe=typeof s.total=="number"?s.total:null,je=M+(H||0)+(ve||0)+(Y||0),q=oe??je,te=q,X=s.pagos||{},C=typeof X.efectivo=="number"?X.efectivo:typeof s.Efectivo=="number"?s.Efectivo:0,U=typeof X.tarjeta=="number"?X.tarjeta:typeof s.Tarjeta=="number"?s.Tarjeta:0,W=typeof X.transferencia=="number"?X.transferencia:typeof s.Transferencia=="number"?s.Transferencia:0,ue=typeof X.totalPaid=="number"?X.totalPaid:C+U+W;let _e;if(typeof X.cambio=="number")_e=X.cambio;else if(typeof s.cambio=="number")_e=s.cambio;else{const k=Number(ue)-Number(te||0);_e=isNaN(k)?0:k>0?k:0}const O=I.map(k=>{const ne=String(k.producto&&(k.producto.nombre||k.producto.descripcion)||k.descripcion||k.nombre||""),me=Number(k.cantidad||0),Se=Number((k.producto&&(k.producto.precio??k.producto.precio_unitario))??k.precio_unitario??k.precio??0),Ae=!!(k.producto&&k.producto.exento)||!!k.exento,De=!!(k.producto&&k.producto.aplica_impuesto_18)||!!k.aplica_impuesto_18,qe=!!(k.producto&&k.producto.aplica_impuesto_turistico)||!!k.aplica_impuesto_turistico,Ze=De?s.tax18Rate??s.tax18??0:s.taxRate??s.tax??0,mt=qe?s.taxTouristRate??s.taxTourist??0:0,yt=(Number(Ze)||0)+(Number(mt)||0);let ft=Se;!Ae&&yt>0&&(ft=Se/(1+yt));const wt=Number(ft||0).toFixed(2),Ht=ft*me,tt=Number(Ht||0).toFixed(2);return`<tr><td>${k.producto&&k.producto.sku||k.sku||""} ${ne}</td><td style="text-align:center">${me}</td><td style="text-align:right">L ${wt}</td><td style="text-align:right">L ${tt}</td></tr>`}).join(`
`),V=(Number(C)||0)+(Number(W)||0)+(Number(U)||0)-(Number(_e)||0),J=isNaN(V)?0:V,he=dx(J);return`<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Factura Cinta</title>

<style>
    body {
        font-family: monospace;
        font-size: 12px;
        width: 260px; /* tamao para impresora trmica 58mm */
        margin: 0 auto;
        padding: 0;
    }

    .center { text-align: center; }
    .line { border-top: 1px dashed #000; margin: 5px 0; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 2px 0; }
    th { border-bottom: 1px solid #000; }
    .right { text-align: right; }
    .left { text-align: left; }
    .bold { font-weight: bold; }
</style>
</head>

<body>

<div class="center">
    <img src="${p}" alt="logo" style="width:120px; height:auto;" />
</div>

<div class="center bold">FACTURA</div>
<div class="center">No. ${m}</div>

<div class="line"></div>

<div class="center bold">${l}</div>
<p>RTN: ${u}</p>
<p>Direccin: ${d}</p>
<p>Tel: ${h}</p>
<p>Email: ${g}</p>

<div class="line"></div>

<p>Fecha/Hora: ${A}</p>
<p>CAI: ${v}</p>
<p>F. Lmite: ${x}</p>
<p>Rango:  
${E?E+" "+_+" al "+E+" "+b:_+" al "+b}</p>

<div class="line"></div>

<p>Cliente: ${R}</p>
<p>RTN Cliente: ${N}</p>

<div class="line"></div>

<table>
    <thead>
        <tr>
            <th class="left">Descripcin</th>
            <th class="right">Cant</th>
            <th class="right">P.U</th>
            <th class="right">Total</th>
        </tr>
    </thead>
    <tbody>
        ${O}
    </tbody>
</table>

<div class="line"></div>

<p>Descuento: <span class="right">L ${G.toFixed(2)}</span></p>
<p>SubT Exonerado: <span class="right">L ${Number(T).toFixed(2)}</span></p>
<p>SubT Gravado: <span class="right">L ${Number(L).toFixed(2)}</span></p>
<p>SubT Exento: <span class="right">L ${Number(D).toFixed(2)}</span></p>
<p>Tasa Turstica 4%: <span class="right">L ${Number(Y).toFixed(2)}</span></p>
<p>ISV 15%: <span class="right">L ${Number(H).toFixed(2)}</span></p>
<p>ISV 18%: <span class="right">L ${Number(ve).toFixed(2)}</span></p>

<div class="line"></div>

<p class="bold">TOTAL TRANSACCIN:
   <span class="right bold">L ${Number(q).toFixed(2)}</span>
</p>

<div class="line"></div>

<p class="bold">TOTAL FACTURA :
   <span class="right bold">L ${te.toFixed(2)}</span>
</p>

<p>Efectivo: <span class="right">L ${Number(C).toFixed(2)}</span></p>
<p>Tarjeta: <span class="right">L ${Number(U).toFixed(2)}</span></p>
<p>Transferencia: <span class="right">L ${Number(W).toFixed(2)}</span></p>
<p>Cambio: <span class="right">L ${Number(_e).toFixed(2)}</span></p>

<div class="line"></div>

<div class="center">
    <p>Total Pagado: L ${J.toFixed(2)}</p>
    <p>*** ${he} Lempiras ***</p>
</div>

<div class="line"></div>

<p>Firma Cliente: ____________________</p>
<p>Firma Emisor: _____________________</p>

<div class="center">
    <p>Original: Cliente</p>
    <p>Copia: Obligado tributario emisor</p>
</div>

<div class="center">
    <p>Para cualquier reclamo debe<br/>presentar su factura</p>
    <p>Gracias por su compra!</p>
    <p>LA FACTURA ES BENEFICIO DE TODOS,<br/>EXJALA!</p>
</div>

</body>
</html>
`}function dx(o){if(!isFinite(o))return"";const a=["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciseis","diecisiete","dieciocho","diecinueve","veinte"],s=["","","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],l=["","cien","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"];function u(v){if(v===0)return"";if(v<21)return a[v];if(v<100){const x=Math.floor(v/10),_=v%10;return s[x]+(_?" y "+a[_]:"")}if(v<1e3){const x=Math.floor(v/100),_=v%100;return(x===1&&_===0?"cien":l[x]||"")+(_?" "+u(_):"")}return""}const d=Math.floor(Math.abs(o));if(d===0)return"cero";const h=[];let g=d;const p=["","mil","milln","mil millones"];let m=0;for(;g>0;){const v=g%1e3;if(v){let x=u(v);m===2&&v===1&&(x="un"),h.unshift(x+(p[m]?" "+p[m]:""))}g=Math.floor(g/1e3),m++}return h.join(" ").trim()}function fx({onLogout:o}){j.useEffect(()=>{const $=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=$||""}},[]);const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(""),[g,p]=j.useState("Todas"),[m,v]=j.useState(.15),[x,_]=j.useState(0),[b,E]=j.useState(0),[R,N]=j.useState(26.27),A=["Todas",...Array.from(new Set(a.map($=>$.categoria)))],I=a.filter($=>(String($.nombre||"").toLowerCase().includes(d.toLowerCase())||String($.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||$.categoria===g)),M=l.reduce(($,re)=>$+Number(re.producto.precio||0)*re.cantidad,0);let G=0,T=0,L=0;for(const $ of l){const re=Number($.producto.precio||0)*$.cantidad,xe=!!$.producto.exento,Z=!!$.producto.aplica_impuesto_18,ye=!!$.producto.aplica_impuesto_turistico;if(xe)continue;const fe=Z?x||0:m||0,ge=ye&&b||0,pe=(Number(fe)||0)+(Number(ge)||0);if(pe<=0)continue;const be=re-re/(1+pe);Z?T+=be*(fe/pe):G+=be*(fe/pe),ye&&(L+=be*(ge/pe))}const D=M,H=Math.max(0,M-(G+T+L)),ve=l.map($=>{const re=Number($.producto.precio||0)*$.cantidad,xe=!!$.producto.exento,Z=!!$.producto.aplica_impuesto_18,ye=!!$.producto.aplica_impuesto_turistico;if(xe)return{id:$.producto.id,nombre:$.producto.nombre,price:re,isv:0,imp18:0,tur:0,totalTax:0};const fe=Z?x||0:m||0,ge=ye&&b||0,pe=(Number(fe)||0)+(Number(ge)||0);if(pe<=0)return{id:$.producto.id,nombre:$.producto.nombre,price:re,isv:0,imp18:0,tur:0,totalTax:0};const be=re-re/(1+pe),ce=Z?0:be*(fe/pe),we=Z?be*(fe/pe):0,Oe=ye?be*(ge/pe):0;return{id:$.producto.id,nombre:$.producto.nombre,price:re,isv:ce,imp18:we,tur:Oe,totalTax:ce+we+Oe}}),Y=$=>{const re=Number($.stock??0),xe=Number($.precio??0);re<1||xe<=0||u(Z=>Z.find(fe=>fe.producto.id===$.id)?Z.map(fe=>fe.producto.id===$.id?{...fe,cantidad:fe.cantidad+1}:fe):[...Z,{producto:$,cantidad:1}])},oe=($,re)=>{u(xe=>xe.map(Z=>{if(String(Z.producto.id)===String($)){const ye=Z.cantidad+re;return ye>0?{...Z,cantidad:ye}:Z}return Z}).filter(Z=>Z.cantidad>0))},je=$=>{u(re=>re.filter(xe=>String(xe.producto.id)!==String($)))},q=()=>u([]),[te,X]=j.useState(!1),[C,U]=j.useState("factura"),[W,ue]=j.useState(!1),[_e,w]=j.useState(null),[O,V]=j.useState(null),[J,he]=j.useState(!1),[de,k]=j.useState(!1),[ne,me]=j.useState(""),[Se,Ae]=j.useState(""),De=j.useRef(null),qe=j.useRef(null),[Ze,mt]=j.useState("final"),[yt,ft]=j.useState(""),[wt,Ht]=j.useState(""),[tt,it]=j.useState(!1),[Ba,pi]=j.useState(!1),[Gt,mi]=j.useState(!1),[ps,yi]=j.useState(!1),[La,gr]=j.useState(null),[ms,ys]=j.useState(!1),[pr,Ma]=j.useState("carta"),Kt=async $=>{if(Ae($),!$||String($).trim()===""){me("");return}try{if(Ze==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",$);const{data:ye,error:fe}=await ae.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",$).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:ye,error:fe}),!fe&&ye&&ye.nombre){me(ye.nombre||""),ft(ye.telefono||""),Ht(ye.correo_electronico||""),it(!!ye.exonerado),setTimeout(()=>{try{qe.current?.focus()}catch{}},50);return}else{me(""),ft(""),Ht(""),it(!1);return}}const re="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",$);const{data:xe,error:Z}=await ae.from(re).select("nombre").eq("rtn",$).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:xe,error:Z}),!Z&&xe&&xe.nombre?(me(xe.nombre||""),setTimeout(()=>{try{qe.current?.focus()}catch{}},50)):me("")}catch(re){console.warn("Error buscando cliente por RTN:",re)}},On=$=>{if($==="cotizacion"){U("cotizacion"),X(!0);return}U($),X(!0)},Ft=async($={})=>{try{if(!l||l.length===0)return null;const re=vi(),xe=G,Z=T,ye=L,fe=Number(xe||0)+Number(Z||0)+Number(ye||0),ge=re+fe;let pe=$.cliente_id??null;if(!pe&&$.rtn)try{const{data:at,error:Qe}=await ae.from("clientes").select("id").eq("rtn",$.rtn).maybeSingle();!Qe&&at&&at.id&&(pe=at.id)}catch{}const be=Un||"system",ce=String(Math.floor(Math.random()*9e5)+1e5),we={cliente_id:pe,usuario:be,numero_cotizacion:ce,validez_dias:30,subtotal:re,impuesto:fe,total:ge,estado:"pendiente"};let Oe=$.cotizacion_id??O;if(Oe){const at={cliente_id:we.cliente_id||null,usuario:we.usuario,validez_dias:we.validez_dias,subtotal:we.subtotal,impuesto:we.impuesto,total:we.total,estado:we.estado},{error:Qe}=await ae.from("cotizaciones").update(at).eq("id",Oe);if(Qe)return console.warn("Error actualizando cotizacion:",Qe),null}else{const{data:at,error:Qe}=await ae.from("cotizaciones").insert([we]).select("id").maybeSingle();if(Qe)return console.warn("Error insertando cotizacion:",Qe),null;if(Oe=at?.id||null,!Oe)return null}const He=l.map(at=>{const Qe=Number(at.producto.precio||0),ht=Number(at.cantidad||0),$n=!!at.producto.exento,Jt=!!at.producto.aplica_impuesto_18,oa=!!at.producto.aplica_impuesto_turistico,Pa=$n||Jt?0:Qe*(m||0)*ht,vr=$n?0:Jt?Qe*(x||0)*ht:0,zt=$n?0:oa?Qe*(b||0)*ht:0,fn=Qe*ht,Ce=fn+Pa+vr+zt;return{cotizacion_id:Oe,producto_id:at.producto.id||null,descripcion:at.producto.nombre||"",cantidad:ht,precio_unitario:Qe,subtotal:fn,descuento:0,total:Ce}});try{await ae.from("cotizaciones_detalle").delete().eq("cotizacion_id",Oe)}catch{}const{error:Dt}=await ae.from("cotizaciones_detalle").insert(He);return Dt?console.warn("Error insertando cotizaciones_detalle:",Dt):console.debug("Cotizacion guardada id=",Oe),Oe}catch(re){return console.warn("Error guardando cotizacion:",re),null}},vi=()=>{const $=l.reduce((ye,fe)=>ye+Number(fe.producto.precio||0)*fe.cantidad,0);let re=0,xe=0,Z=0;for(const ye of l){const fe=Number(ye.producto.precio||0)*ye.cantidad,ge=!!ye.producto.exento,pe=!!ye.producto.aplica_impuesto_18,be=!!ye.producto.aplica_impuesto_turistico;if(ge)continue;const ce=pe?x||0:m||0,we=be&&b||0,Oe=(Number(ce)||0)+(Number(we)||0);if(Oe<=0)continue;const He=fe-fe/(1+Oe);pe?xe+=He*(ce/Oe):re+=He*(ce/Oe),be&&(Z+=He*(we/Oe))}return Math.max(0,$-(re+xe+Z))},Yl=()=>l.reduce(($,re)=>$+(re.producto.exento?0:Number(re.producto.precio||0)*re.cantidad),0),Jl=async()=>{mt("final"),me("Consumidor Final"),Ae("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),ys(!0),mi(!0),X(!1)},bi=()=>{mt("normal"),me(""),Ae(""),yi(!1),gr(null),he(!0),X(!1)},xi=()=>{mt("juridico"),me(""),Ae(""),yi(!1),gr(null),he(!0),X(!1)},_i=async($,re,xe)=>{const ye=await(pr==="cinta"?op:lp)({cliente:$,rtn:re},C,{carrito:l,subtotal:vi(),isvTotal:G,imp18Total:T,impTouristTotal:L,taxRate:m,tax18Rate:x,taxTouristRate:b,total:D,pagos:xe});if(C==="factura"&&O)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",O);const{error:fe}=await ae.from("cotizaciones").update({estado:"aceptada"}).eq("id",O);if(fe)console.warn("Error marcando cotizacion (pre-print):",fe);else try{V(null)}catch{}}catch(fe){console.warn("Error marcacion pre-print:",fe)}if(C==="factura")try{let fe=null,ge=null;try{const pe=localStorage.getItem("user"),be=pe?JSON.parse(pe):null;ge=be&&(be.id||be.user?.id||be.sub||be.user_id)?be.id||be.user?.id||be.sub||be.user_id:null;const ce=be&&(be.username||be.user?.username||be.name||be.user?.name)?be.username||be.user?.username||be.name||be.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",pe),console.debug("PV: CAI lookup - parsed user object:",be),console.debug("PV: CAI lookup - extracted userId:",ge,"typeof",typeof ge),console.debug("PV: CAI lookup - extracted userNameFromStorage:",ce),ge){const we=typeof ge=="string"&&/^\d+$/.test(ge)?Number(ge):ge;try{const{data:Oe,error:He}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",we).order("id",{ascending:!1}).limit(1);!He&&Array.isArray(Oe)&&Oe.length>0&&(fe=Oe[0])}catch(Oe){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Oe)}}if(!fe&&ce)try{const{data:we,error:Oe}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",ce).order("id",{ascending:!1}).limit(1);!Oe&&Array.isArray(we)&&we.length>0&&(fe=we[0])}catch(we){console.debug("PV: CAI lookup by cajero failed:",we)}}catch(pe){console.debug("No se pudo cargar CAI desde frontend:",pe)}await kn({clienteName:$,rtn:re,paymentPayload:xe,caiData:fe,usuarioId:ge})}catch(fe){console.warn("Error preparando venta antes de imprimir:",fe),alert("Error preparando venta antes de imprimir: "+String(fe))}try{const fe=document.createElement("iframe");fe.style.position="fixed",fe.style.right="0",fe.style.bottom="0",fe.style.width="0",fe.style.height="0",fe.style.border="0",fe.style.overflow="hidden",fe.setAttribute("aria-hidden","true"),document.body.appendChild(fe);const ge=fe.contentWindow,pe=fe.contentDocument||fe.contentWindow?.document;if(!pe||!ge)try{document.body.removeChild(fe)}catch{}else{pe.open(),pe.write(ye),pe.close();const be=()=>{try{ge.focus(),ge.print()}catch(we){console.warn("Error during iframe print (finalize):",we)}setTimeout(()=>{try{document.body.removeChild(fe)}catch{}},800)},ce=()=>{try{const we=pe.images;if(we&&we.length>0){let Oe=0;for(let He=0;He<we.length;He++){const Dt=we[He];Dt.complete?Oe++:(Dt.addEventListener("load",()=>{Oe++,Oe===we.length&&be()}),Dt.addEventListener("error",()=>{Oe++,Oe===we.length&&be()}))}Oe===we.length&&be()}else be()}catch{try{ge.addEventListener("load",be)}catch{}setTimeout(be,1e3)}};try{pe.readyState==="complete"?ce():(ge.addEventListener("load",ce),setTimeout(ce,1500))}catch{setTimeout(ce,800)}}}catch(fe){console.warn("Direct print failed, falling back to opening new window",fe);const ge=window.open("","_blank");ge&&(ge.document.open(),ge.document.write(ye),ge.document.close(),setTimeout(()=>{try{ge.print(),ge.close()}catch{}},800))}C==="factura"&&(q(),await qa()),C==="cotizacion"&&(w({cliente:$,rtn:re}),ue(!0))},kn=async({clienteName:$,rtn:re,paymentPayload:xe,caiData:Z,usuarioId:ye})=>{if(!l||l.length===0)return null;const fe=xe&&xe.tipoPagoString?String(xe.tipoPagoString):"",ge=xe&&xe.totalPaid?Number(xe.totalPaid||0):0,pe=ge>Number(D||0)?ge-Number(D||0):0;let be=String(Math.floor(Math.random()*9e5)+1e5);const ce=Bn||Z||null;let we=null,Oe=0,He=null,Dt=null;if(ce&&(ce.rango_de!==void 0||ce.secuencia_actual!==void 0))try{const Ce=ce.rango_de!=null?String(ce.rango_de):"",Le=ce.rango_hasta!=null?String(ce.rango_hasta):"",Ve=ce.secuencia_actual!=null?String(ce.secuencia_actual):"",Ne=Number(String(Ce).replace(/[^0-9]/g,""))||0,Pe=Number(String(Le).replace(/[^0-9]/g,""))||0,Ge=Number(String(Ve).replace(/[^0-9]/g,""))||Ne||0;Oe=Math.max((Le||Ce||"").length,String(Ge).length,1),Dt=String(Ge).padStart(Oe,"0"),be=(ce.identificador?String(ce.identificador):"")+Dt;const ca=Ge+1;we=ca,He=String(ca).padStart(Oe,"0")}catch(Ce){console.debug("Error computing factura from caiInfoState, falling back to random:",Ce)}const at={rtn:re||null,nombre_cliente:$||null,usuario:Un||"system",factura:be,tipo_pago:fe,subtotal:Number(H||0),impuesto:Number(G+T+L||0),total:Number(D||0),estado:"pagada",cambio:String(Number(pe).toFixed(2)),cai:ce?.cai??null,rango_desde:(ce&&ce.identificador?String(ce.identificador):"")+(ce?.rango_de!=null?String(ce.rango_de):"")||null,rango_hasta:(ce&&ce.identificador?String(ce.identificador):"")+(ce?.rango_hasta!=null?String(ce.rango_hasta):"")||null,fecha_limite_emision:ce?.fecha_vencimiento??ce?.fecha_limite_emision??null};let Qe=null,ht=null;try{const Ce=await ae.from("ventas").insert([at]).select("id, factura");Qe=Ce.data??Ce,ht=Ce.error??null}catch(Ce){ht=Ce}if(console.debug("Insert venta response:",{ventaInsRaw:Qe,ventaErr:ht}),ht){const Ce=String(ht&&(ht.message||ht.msg||ht.details)||""),Le=ht&&ht.code?String(ht.code):"";if(Le==="PGRST204"||Ce.includes("Could not find the")||/column .* of 'ventas'/.test(Ce)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:Ce,code:Le});const Ne={...at};delete Ne.cai,delete Ne.rango_desde,delete Ne.rango_hasta,delete Ne.fecha_limite_emision;try{const Pe=await ae.from("ventas").insert([Ne]).select("id, factura");if(Qe=Pe.data??Pe,ht=Pe.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:Qe,ventaErr:ht}),ht)throw ht}catch(Pe){throw console.error("Fallback insert also failed:",Pe),Pe}}else throw ht}const $n=Array.isArray(Qe)?Qe[0]:Qe;let Jt=$n?$n.id||$n.id:null;if(!Jt)try{const{data:Ce,error:Le}=await ae.from("ventas").select("id").eq("factura",be).maybeSingle();Le&&console.debug("Error buscando venta por factura (fallback):",Le),Ce&&Ce.id&&(Jt=Ce.id)}catch(Ce){console.debug("fallback lookup error",Ce)}if(!Jt)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",Qe),null;const oa=l.map(Ce=>{const Le=Number(Ce.producto.precio||0),Ve=Number(Ce.cantidad||0),Ne=Le*Ve,Pe=0,Ge=Ne-Pe;return{venta_id:Jt,factura:be,producto_id:Ce.producto.id,cantidad:Ve,precio_unitario:Le,subtotal:Ne,descuento:Pe,total:Ge}});if(Z&&ye&&(Ce=>typeof Ce=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Ce))(ye))try{const Ce=l.map(Ne=>({producto_id:String(Ne.producto.id),cantidad:Number(Ne.cantidad||0),precio_unitario:Number(Ne.producto.precio||0),subtotal:Number((Number(Ne.producto.precio||0)*Ne.cantidad).toFixed(6)),descuento:0,total:Number((Number(Ne.producto.precio||0)*Ne.cantidad).toFixed(6))})),{data:Le,error:Ve}=await ae.rpc("create_venta_with_detalle",{p_usuario_id:ye,p_usuario:Un||ye,p_rtn:re||null,p_nombre_cliente:$||null,p_tipo_pago:fe,p_subtotal:Number(H||0),p_impuesto:Number(G+T+L||0),p_total:Number(D||0),p_cambio:String(Number(pe).toFixed(2)),p_detalles:Ce});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:Le,rpcErr:Ve}),Ve)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",Ve);else if(Le&&Array.isArray(Le)&&Le.length>0){const Ne=Le[0];try{if(ce&&ce.id!=null)try{const{data:Pe,error:Ge}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",ce.id).maybeSingle();if(!Ge&&Pe){wn(Pe);try{localStorage.setItem("caiInfo",JSON.stringify(Pe))}catch{}}}catch(Pe){console.debug("Error refreshing cai after RPC:",Pe)}}catch(Pe){console.debug("Error during post-RPC cai refresh:",Pe)}return Ne.venta_id||Ne.venta_id===0?Ne.venta_id:Jt}else if(Le&&Le.venta_id){try{if(ce&&ce.id!=null)try{const{data:Ne,error:Pe}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("id",ce.id).maybeSingle();if(!Pe&&Ne){wn(Ne);try{localStorage.setItem("caiInfo",JSON.stringify(Ne))}catch{}}}catch(Ne){console.debug("Error refreshing cai after RPC (scalar):",Ne)}}catch(Ne){console.debug("Error during post-RPC cai refresh (scalar):",Ne)}return Le.venta_id}}catch(Ce){console.warn("Error calling RPC create_venta_with_detalle:",Ce)}else Z&&ye&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",ye);const{data:vr,error:zt}=await ae.from("ventas_detalle").insert(oa).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:vr,detErr:zt}),zt)throw zt;try{const Ce=`venta: ${be}`;let Le=Un||"sistema";try{const Pe=localStorage.getItem("user");if(Pe){const Ge=JSON.parse(Pe);Le=Ge&&(Ge.username||Ge.user?.username||Ge.name||Ge.user?.name)?Ge.username||Ge.user?.username||Ge.name||Ge.user?.name:String(Ge)}}catch{}const Ve=new Date().toISOString(),Ne=oa.map(Pe=>({producto_id:Pe.producto_id,cantidad:Pe.cantidad,tipo_de_movimiento:"SALIDA",referencia:Ce,usuario:Le,fecha_salida:Ve}));if(Ne.length>0){const{data:Pe,error:Ge}=await ae.from("registro_de_inventario").insert(Ne).select("id");Ge?console.warn("Error registrando salida en registro_de_inventario:",Ge):console.debug("Registro_de_inventario inserciones (salida):",Pe)}}catch(Ce){console.warn("Excepcin registrando salidas en registro_de_inventario:",Ce)}try{const Ce={};for(const Le of oa){const Ve=String(Le.producto_id),Ne=Number(Le.cantidad||0);Ce[Ve]||(Ce[Ve]=0),Ce[Ve]+=Ne}for(const Le of Object.keys(Ce))try{const Ve=Number(Ce[Le]||0);if(Ve<=0)continue;const{data:Ne,error:Pe}=await ae.from("inventario").select("stock").eq("id",Le).maybeSingle();if(Pe){console.warn("Error leyendo stock de inventario para producto",Le,Pe);continue}const Ge=Ne&&Ne.stock!=null?Number(Ne.stock):0,Va=Math.max(0,Ge-Ve),{error:ca}=await ae.from("inventario").update({stock:Va}).eq("id",Le);ca?console.warn("Error actualizando stock para producto",Le,ca):console.debug("Stock actualizado para producto",Le,"de",Ge,"a",Va)}catch(Ve){console.warn("Excepcin actualizando stock para producto",Le,Ve)}}catch(Ce){console.warn("Excepcin agregada en proceso de actualizacin de stock:",Ce)}try{if(xe&&Array.isArray(xe.pagos)&&xe.pagos.length>0){const Ce=xe.pagos.map(Ne=>({venta_id:Jt,tipo:Ne.tipo,monto:Number(Ne.monto||0),banco:Ne.banco||null,tarjeta:Ne.tarjeta||null,factura:be||Ne.factura||null,autorizador:Ne.autorizador||null,referencia:Ne.referencia||null,meta:Ne.meta||null,created_by:typeof ye=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(ye)?ye:null})),{data:Le,error:Ve}=await ae.from("pagos").insert(Ce).select("id");Ve?console.warn("Error insertando pagos en tabla pagos:",Ve):console.debug("Pagos insertados:",Le)}}catch(Ce){console.warn("Excepcin insertando pagos:",Ce)}const fn=ce&&(ce.id||ce.id===0)?ce.id:null;if(fn!=null&&we!=null)try{const Ce=He??String(we);try{const Le=ce?.rango_hasta!=null?String(ce.rango_hasta):"",Ve=Number(Le.replace(/[^0-9]/g,""))||null,Ne=Number(String(Ce).replace(/[^0-9]/g,""))||null;if(Ve!=null&&Ne!=null&&Ne>Ve)console.warn("No se actualizar cai.secuencia_actual porque excede rango_hasta",{toStoreNum:Ne,rangoHastaNum:Ve});else{const{error:Pe}=await ae.from("cai").update({secuencia_actual:Ce}).eq("id",fn);if(Pe)console.debug("Error updating cai.secuencia_actual (manual path):",Pe);else{console.debug("Updated cai.secuencia_actual to",Ce,"for cai id",fn);try{const Ge={...ce||{},secuencia_actual:Ce};wn(Ge);try{localStorage.setItem("caiInfo",JSON.stringify(Ge))}catch{}}catch(Ge){console.debug("Error updating local caiInfoState/localStorage:",Ge)}}}}catch(Le){console.debug("Validation error while checking rango_hasta:",Le);const{error:Ve}=await ae.from("cai").update({secuencia_actual:Ce}).eq("id",fn);if(Ve)console.debug("Error updating cai.secuencia_actual (manual path, after validation fail):",Ve);else{console.debug("Updated cai.secuencia_actual to",Ce,"for cai id",fn);try{const Ne={...ce||{},secuencia_actual:Ce};wn(Ne);try{localStorage.setItem("caiInfo",JSON.stringify(Ne))}catch{}}catch(Ne){console.debug("Error updating local caiInfoState/localStorage (after validation):",Ne)}}}}catch(Ce){console.debug("Exception updating cai.secuencia_actual:",Ce)}try{await Ei()}catch(Ce){console.debug("refreshProducts after insertVenta failed",Ce)}return Jt},qa=async()=>{if(C==="factura"&&O)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",O);const{error:$}=await ae.from("cotizaciones").update({estado:"aceptada"}).eq("id",O);$?console.warn("Error marcando cotizacion como facturado:",$):console.debug("Cotizacion marcada como facturado:",O)}catch($){console.warn("Error procesando cotizacion tras facturar",$)}};j.useEffect(()=>{J&&setTimeout(()=>{try{De.current?.focus()}catch{}},80)},[J]);const Ia=async()=>{try{if(Se&&ne){const Z={rtn:Se,nombre:ne},{error:ye}=await ae.from("clientenatural").upsert(Z,{onConflict:"rtn"});ye&&console.warn("Error guardando clientenatural:",ye)}}catch(Z){console.warn("Error upsert clientenatural:",Z)}try{if(Se&&ne)if(Ze==="juridico"){const{data:Z,error:ye}=await ae.from("clientes").select("id").eq("rtn",Se).eq("tipo_cliente","juridico").maybeSingle();if(ye&&console.warn("Error buscando cliente juridico:",ye),Z&&Z.id){const{error:fe}=await ae.from("clientes").update({nombre:ne,telefono:yt||null,correo_electronico:wt||null,exonerado:tt}).eq("id",Z.id);fe&&console.warn("Error actualizando cliente juridico:",fe)}else{const{error:fe}=await ae.from("clientes").insert([{nombre:ne,rtn:Se,telefono:yt||null,correo_electronico:wt||null,tipo_cliente:"juridico",exonerado:tt}]);fe&&console.warn("Error insertando cliente juridico:",fe)}}else{const Z={rtn:Se,nombre:ne},{error:ye}=await ae.from("clientenatural").upsert(Z,{onConflict:"rtn"});ye&&console.warn("Error guardando clientenatural:",ye)}}catch(Z){console.warn("Error upsert cliente:",Z)}const re=await(pr==="cinta"?op:lp)({cliente:ne||"Cliente",rtn:Se||""},C,{carrito:l,subtotal:vi(),isvTotal:G,imp18Total:T,impTouristTotal:L,taxRate:m,tax18Rate:x,taxTouristRate:b,total:D,pagos:La});if(C==="factura"&&O)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",O);const{error:Z}=await ae.from("cotizaciones").update({estado:"aceptada"}).eq("id",O);if(Z)console.warn("Error marcando cotizacion como facturado (pre-print):",Z);else{console.debug("Cotizacion marcada como facturado (pre-print):",O);try{V(null)}catch{}}}catch(Z){console.warn("Error marcacion pre-print:",Z)}if(C==="factura")try{let Z=null,ye=null;try{const fe=localStorage.getItem("user"),ge=fe?JSON.parse(fe):null;ye=ge&&(ge.id||ge.user?.id||ge.sub||ge.user_id)?ge.id||ge.user?.id||ge.sub||ge.user_id:null;const pe=ge&&(ge.username||ge.user?.username||ge.name||ge.user?.name)?ge.username||ge.user?.username||ge.name||ge.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",fe),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",ge),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",ye,"typeof",typeof ye),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",pe),ye){const be=typeof ye=="string"&&/^\d+$/.test(ye)?Number(ye):ye;try{const{data:ce,error:we}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",be).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(ce)&&ce.length>0&&(Z=ce[0])}catch(ce){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",ce)}}if(!Z&&pe)try{const{data:be,error:ce}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",pe).order("id",{ascending:!1}).limit(1);!ce&&Array.isArray(be)&&be.length>0&&(Z=be[0])}catch(be){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",be)}}catch(fe){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",fe)}await kn({clienteName:ne||"Cliente",rtn:Se||null,paymentPayload:La,caiData:Z,usuarioId:ye})}catch(Z){console.warn("Error insertando venta en flujo cliente normal:",Z)}try{const Z=document.createElement("iframe");Z.style.position="fixed",Z.style.right="0",Z.style.bottom="0",Z.style.width="0",Z.style.height="0",Z.style.border="0",Z.style.overflow="hidden",Z.setAttribute("aria-hidden","true"),document.body.appendChild(Z);const ye=Z.contentWindow,fe=Z.contentDocument||Z.contentWindow?.document;if(!fe||!ye)try{document.body.removeChild(Z)}catch{}else{fe.open(),fe.write(re),fe.close();const ge=()=>{try{ye.focus(),ye.print()}catch(be){console.warn("Error during iframe print (cliente normal):",be)}setTimeout(()=>{try{document.body.removeChild(Z)}catch{}},800)},pe=()=>{try{const be=fe.images;if(be&&be.length>0){let ce=0;for(let we=0;we<be.length;we++){const Oe=be[we];Oe.complete?ce++:(Oe.addEventListener("load",()=>{ce++,ce===be.length&&ge()}),Oe.addEventListener("error",()=>{ce++,ce===be.length&&ge()}))}ce===be.length&&ge()}else ge()}catch{try{ye.addEventListener("load",ge)}catch{}setTimeout(ge,1e3)}};try{fe.readyState==="complete"?pe():(ye.addEventListener("load",pe),setTimeout(pe,1500))}catch{setTimeout(pe,800)}}}catch(Z){console.warn("Direct print (cliente normal) failed, falling back to new window",Z);const ye=window.open("","_blank");ye&&(ye.document.open(),ye.document.write(re),ye.document.close(),setTimeout(()=>{try{ye.print(),ye.close()}catch{}},800))}await(async()=>{C==="factura"&&(q(),await qa()),C==="cotizacion"&&(w({cliente:ne||"Cliente",rtn:Se||null}),ue(!0))})(),he(!1)},[Hn,zn]=j.useState(null),[ji,Ha]=j.useState([]),[Ql,Si]=j.useState(!1),[vs,wi]=j.useState(null);j.useEffect(()=>{fetch("/data-base/inventario.json").then(async $=>{if(!$.ok)return console.warn("inventario.json no disponible, status",$.status),null;const re=$.headers.get("content-type")||"";if(!re.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",re),null;try{return await $.json()}catch(xe){return console.warn("Error parseando inventario.json:",xe),null}}).then($=>{$&&Array.isArray($.items)&&Ha($.items),console.log("inventario cargado:",$&&$.items?$.items.length:0)}).catch($=>{console.warn("Error cargando inventario:",$)})},[]);const Ei=async()=>{try{const{data:$,error:re}=await ae.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(re)throw re;const xe=Array.isArray($)?$:[],Z=xe.map(pe=>String(pe.id));if(Z.length===0){s([]);return}const ye={};try{const{data:pe,error:be}=await ae.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(be)throw be;if(Array.isArray(pe))for(const ce of pe){const we=String(ce.producto_id);ye[we]||(ye[we]=Number(ce.precio||0))}}catch(pe){console.warn("Error cargando precios en PV:",pe)}let fe={};try{const{data:pe,error:be}=await ae.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",Z);if(be)throw be;const ce=Array.isArray(pe)?pe:[];fe={},Z.forEach(we=>fe[we]=0);for(const we of ce){const Oe=String(we.producto_id),He=Number(we.cantidad)||0,Dt=String(we.tipo_de_movimiento||"").toUpperCase();Dt==="ENTRADA"?fe[Oe]=(fe[Oe]||0)+He:Dt==="SALIDA"&&(fe[Oe]=(fe[Oe]||0)-He)}}catch(pe){console.warn("Error cargando registro_de_inventario en PV:",pe),fe={},Z.forEach(be=>fe[be]=0)}const ge=xe.map(pe=>({id:String(pe.id),sku:pe.sku,nombre:pe.nombre,categoria:pe.categoria,imagen:pe.imagen,precio:ye[String(pe.id)]!==void 0?ye[String(pe.id)]:pe.precio!==void 0?Number(pe.precio):0,exento:pe.exento===!0||String(pe.exento)==="true"||Number(pe.exento)===1||!1,aplica_impuesto_18:pe.aplica_impuesto_18===!0||String(pe.aplica_impuesto_18)==="true"||Number(pe.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:pe.aplica_impuesto_turistico===!0||String(pe.aplica_impuesto_turistico)==="true"||Number(pe.aplica_impuesto_turistico)===1||!1,stock:Number((fe[String(pe.id)]||0).toFixed(2))}));s(ge)}catch($){console.warn("Error cargando productos desde inventario:",$),s([])}};j.useEffect(()=>{let $=!0;return Ei().catch(re=>{$&&console.warn("refreshProducts error",re)}),()=>{$=!1}},[]),j.useEffect(()=>{const $=xe=>{try{const Z=xe||(()=>{const ge=localStorage.getItem("cotizacion_to_load");return ge?JSON.parse(ge):null})();if(!Z)return;try{V(Z.header&&Z.header.id?String(Z.header.id):null)}catch{}const fe=(Array.isArray(Z.detalles)?Z.detalles:[]).map(ge=>{const pe=a.find(ce=>String(ce.id)===String(ge.producto_id));return{producto:pe?{...pe}:{id:String(ge.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:ge.sku??void 0,nombre:ge.descripcion||ge.nombre||"Artculo",precio:Number(ge.precio_unitario||ge.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(ge.cantidad||1)}});fe.length>0&&u(fe);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};$();const re=xe=>{try{$(xe.detail)}catch{}};return window.addEventListener("cotizacion:load",re),()=>{window.removeEventListener("cotizacion:load",re)}},[a]);const[Un,bs]=j.useState(null),[xs,Dn]=j.useState(null),[Et,$t]=j.useState(null),[Bn,wn]=j.useState(null),[Xl,_s]=j.useState(!1),[mr,$a]=j.useState({}),yr=async()=>{try{let $=null;try{const re=localStorage.getItem("user"),xe=re?JSON.parse(re):null;let Z=Et??(xe&&(xe.id||xe.user?.id||xe.sub||xe.user_id)?xe.id||xe.user?.id||xe.sub||xe.user_id:null);const ye=Un??(xe&&(xe.username||xe.user?.username||xe.name||xe.user?.name)?xe.username||xe.user?.username||xe.name||xe.user?.name:null),fe=Z!=null&&typeof Z=="string"&&/^\d+$/.test(Z)?Number(Z):Z;if(fe!=null)try{const{data:ge,error:pe}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",fe).order("id",{ascending:!1}).limit(1);!pe&&Array.isArray(ge)&&ge.length>0&&($=ge[0])}catch(ge){console.debug("refreshCaiInfo: lookup by usuario_id failed:",ge)}if(!$&&ye)try{const{data:ge,error:pe}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",ye).order("id",{ascending:!1}).limit(1);!pe&&Array.isArray(ge)&&ge.length>0&&($=ge[0])}catch(ge){console.debug("refreshCaiInfo: lookup by cajero failed:",ge)}}catch(re){console.debug("refreshCaiInfo: error building lookup params",re)}if($){wn($);try{localStorage.setItem("caiInfo",JSON.stringify($))}catch{}console.debug("refreshCaiInfo: updated caiInfoState",$)}}catch($){console.debug("refreshCaiInfo: unexpected error",$)}};j.useEffect(()=>{try{const $=localStorage.getItem("user");if($){const re=JSON.parse($);bs(re.username||re.name||null),Dn(re.role||null);let xe=null;try{xe=re&&(re.id||re.user?.id||re.sub||re.user_id)?re.id||re.user?.id||re.sub||re.user_id:null,$t(xe??null),console.debug("PV: localStorage.user parsed:",re),console.debug("PV: extracted userId for CAI/RPC usage:",xe)}catch(Z){console.debug("PV: error parsing localStorage.user for debug:",Z)}try{const Z=localStorage.getItem("caiInfo");if(Z){const ye=JSON.parse(Z);wn(ye),console.debug("PV: loaded caiInfo from localStorage:",ye),(async()=>{try{if(!(ye&&ye.rango_de!==void 0&&ye.rango_hasta!==void 0&&ye.fecha_vencimiento!==void 0&&ye.secuencia_actual!==void 0)){const ge=re&&(re.username||re.user?.username||re.name||re.user?.name)?re.username||re.user?.username||re.name||re.user?.name:null,pe=xe&&typeof xe=="string"&&/^\d+$/.test(xe)?Number(xe):xe;let be=null;try{if(pe!=null){const{data:ce,error:we}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",pe).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(ce)&&ce.length>0&&(be=ce[0])}}catch(ce){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",ce)}if(!be&&ge)try{const{data:ce,error:we}=await ae.from("cai").select("id,cai,identificador,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",ge).order("id",{ascending:!1}).limit(1);!we&&Array.isArray(ce)&&ce.length>0&&(be=ce[0])}catch(ce){console.debug("PV: refetch CAI by cajero failed:",ce)}if(be){wn(be);try{localStorage.setItem("caiInfo",JSON.stringify(be))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",be)}}}catch(fe){console.debug("PV: error trying to refresh caiInfo:",fe)}})()}}catch(Z){console.debug("PV: error parsing localStorage.caiInfo:",Z)}}}catch{}},[]),j.useEffect(()=>{let $=!0;return(async()=>{try{const{data:re,error:xe}=await ae.from("impuesto").select("id, impuesto_venta");if(xe)throw xe;if(!re||!Array.isArray(re))return;const Z=pe=>{const be=re.find(Oe=>Number(Oe.id)===pe);if(!be)return null;const ce=be.impuesto_venta;if(ce==null)return null;const we=Number(ce);return Number.isNaN(we)?null:we>1?we/100:we},ye=Z(1),fe=Z(2),ge=Z(3);if($){let pe=ye,be=fe,ce=ge;try{if((pe===null||pe===0)&&$){const Oe=(await ae.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,He=Oe==null?null:Number(Oe);He!=null&&!Number.isNaN(He)&&(pe=He>1?He/100:He)}if((be===null||be===0)&&$){const Oe=(await ae.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,He=Oe==null?null:Number(Oe);He!=null&&!Number.isNaN(He)&&(be=He>1?He/100:He)}if((ce===null||ce===0)&&$){const Oe=(await ae.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,He=Oe==null?null:Number(Oe);He!=null&&!Number.isNaN(He)&&(ce=He>1?He/100:He)}}catch(we){console.warn("PV: fallback single-id impuesto fetch failed",we)}(pe===null||pe===0)&&(pe=.15),(be===null||be===0)&&(be=.18),(ce===null||ce===0)&&(ce=.04),v(pe),_(be),E(ce),console.debug("PV: impuestos raw rows",re),console.debug("PV: resolved tax rates",{taxRate:pe,tax18Rate:be,taxTouristRate:ce})}}catch(re){console.warn("Error cargando impuesto en PV:",re)}})(),()=>{$=!1}},[]);const la=$=>{console.log("openUbicacion",$,"entradasCount",ji.length);let re=null;try{re=a.find(Z=>String(Z.sku||"")===String($)||String(Z.id)===String($))||null}catch{re=null}if(re){const Z=Number(re.stock??0),ye={id:re.id,producto:re.nombre||"",sku:re.sku||"",imagen:re.imagen||null,descripcion:re.descripcion||"",ubicacion:re.ubicacion||null,cantidad:Z};wi(ye),Si(!0);return}const xe=ji.find(Z=>Z.sku===$)||null;console.log("entrada encontrada",xe),wi(xe),Si(!0)};if(j.useEffect(()=>{let $=!0;return(async()=>{try{const re="inventario",xe={};await Promise.all((a||[]).map(async Z=>{const ye=Z.imagen;if(!ye){xe[String(Z.id)]=null;return}const fe=String(ye);if(fe.startsWith("http")){xe[String(Z.id)]=fe;return}let ge=fe;const pe=String(fe).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);pe&&(ge=decodeURIComponent(pe[2]));try{const be=await ae.storage.from(re).getPublicUrl(ge),ce=be?.data?.publicUrl||be?.data?.publicURL||null;if(ce){xe[String(Z.id)]=ce;return}}catch{}try{const ce=(await ae.storage.from(re).createSignedUrl(ge,604800))?.data?.signedUrl??null;xe[String(Z.id)]=ce}catch{xe[String(Z.id)]=null}})),$&&$a(xe)}catch(re){console.warn("Error resolviendo imgenes en PV",re)}})(),()=>{$=!1}},[a]),Hn){if(Hn==="DevolucionCaja")return i.jsx(K0,{onBack:()=>zn(null)});if(Hn==="IngresoEfectivo")return i.jsx(F0,{onBack:()=>zn(null)});if(Hn==="CotizacionesGuardadas")return i.jsx(Y0,{onBack:()=>zn(null)});if(Hn==="PedidosEnLinea")return i.jsx(J0,{onBack:()=>zn(null)});if(Hn==="CorteCajaParcial")return i.jsx(Q0,{onBack:()=>zn(null)});if(Hn==="CorteCajaTotal")return i.jsx(X0,{onBack:()=>zn(null)})}return i.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[i.jsx(nx,{userName:Un,userRole:xs,userId:Et,caiInfo:Bn,onLogout:o,onNavigate:$=>zn($),onOpenDatosFactura:()=>_s(!0),onPrintFormatChange:$=>Ma($),printFormat:pr}),i.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[i.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:$=>h($.target.value),onKeyDown:$=>{if($.key==="Enter"){const re=String(d||"").trim().toLowerCase();if(!re)return;const Z=I.find(ye=>String(ye.sku||"").toLowerCase()===re)||I[0];if(Z){const ye=Number(Z.stock??0),fe=Number(Z.precio??0);ye>=1&&fe>0?Y(Z):console.debug("No se puede agregar por stock/precio",{id:Z.id,stockNum:ye,precioNum:fe})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),i.jsx("select",{value:g,onChange:$=>p($.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:A.map($=>i.jsx("option",{value:$,children:$},$))}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("label",{style:{fontSize:13,color:"#333"},children:"Tipo de cambio Lps/$"}),i.jsx("input",{type:"number",min:0,step:"0.01",value:R,onChange:$=>{const re=Number($.target.value||0);N(Number(re.toFixed?Number(re.toFixed(2)):re))},style:{width:120,padding:"8px 10px",borderRadius:8,border:"1px solid #cbd5e1"}})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[i.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:i.jsx(ex,{productos:I,imageUrls:mr,agregarAlCarrito:Y,openUbicacion:la,thStyle:hx,tdStyle:gx,skuStyle:px})}),i.jsx(tx,{carrito:l,actualizarCantidad:oe,eliminarDelCarrito:je,vaciarCarrito:q,subtotal:H,perItemTaxes:ve,taxRate:m,tax18Rate:x,taxTouristRate:b,total:D,openSelector:On,btnStyle:mx})]})]}),i.jsx(rx,{open:Ql,selectedEntrada:vs,onClose:()=>{Si(!1),wi(null)},imageUrls:mr}),i.jsx(W0,{open:Gt,totalDue:D,exchangeRate:R,onClose:()=>mi(!1),onConfirm:async $=>{if(gr($),yi(!0),ms)try{ys(!1),await _i("Consumidor Final","C/F",$)}catch(re){console.warn("Error facturando despus del pago:",re)}mi(!1)}}),i.jsx(sx,{open:W,onClose:()=>ue(!1),onCancel:()=>{ue(!1),w(null)},onSave:async()=>{ue(!1);try{const $=await Ft(_e||{});$&&V(String($))}catch($){console.warn("Error guardando cotizacion desde confirm modal",$)}w(null)}}),i.jsx(lx,{open:te,onClose:()=>X(!1),doFacturaClienteFinal:Jl,doFacturaClienteNormal:bi,doFacturaClienteJuridico:xi,carritoLength:l.length,subtotal:vi(),taxRate:m,taxableSubtotal:Yl()}),i.jsx(ox,{open:J,onClose:()=>he(!1),clienteTipo:Ze,clienteRTN:Se,clienteNombre:ne,clienteTelefono:yt,clienteCorreo:wt,clienteExonerado:tt,clienteSearchOpen:de,setClienteSearchOpen:$=>k($),onRTNChange:$=>Kt($),onNombreChange:$=>me($),onTelefonoChange:$=>ft($),onCorreoChange:$=>Ht($),onExoneradoChange:$=>it($),onCreateCliente:()=>pi(!0),onCancel:()=>he(!1),onOpenCreateCliente:()=>pi(!0),onOpenPayment:()=>mi(!0),paymentDone:ps,submitClienteNormal:Ia}),i.jsx(cx,{open:Ba,onClose:()=>pi(!1),clienteRTN:Se,clienteNombre:ne,clienteTelefono:yt,clienteCorreo:wt,clienteExonerado:tt,onChangeRTN:$=>Ae($),onChangeNombre:$=>me($),onChangeTelefono:$=>ft($),onChangeCorreo:$=>Ht($),onChangeExonerado:$=>it($),onCreate:async()=>{try{if(!ne||!Se)return;const{data:$,error:re}=await ae.from("clientes").select("id").eq("rtn",Se).maybeSingle();if(re&&console.warn("Error buscando cliente al crear:",re),$&&$.id){const{error:xe}=await ae.from("clientes").update({nombre:ne,telefono:yt||null,correo_electronica:wt||null,tipo_cliente:"juridico",exonerado:tt}).eq("id",$.id);xe&&console.warn("Error actualizando cliente al crear:",xe)}else{const{error:xe}=await ae.from("clientes").insert([{nombre:ne,rtn:Se,telefono:yt||null,correo_electronica:wt||null,tipo_cliente:"juridico",exonerado:tt}]);xe&&console.warn("Error insertando cliente al crear:",xe)}}catch($){console.warn("Error creando cliente juridico:",$)}pi(!1)}}),i.jsx(ix,{open:Xl,onClose:()=>_s(!1),caiInfo:Bn,onRefresh:yr})]})}const hx={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},gx={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},px={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},mx={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},cp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function yx({title:o,children:a}){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:o}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function vx(){const[o,a]=j.useState(null);return j.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Ventas (ltimos das)"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Flujo de caja"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Inventario por categora"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),i.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[i.jsx("h3",{children:"Promedios"}),i.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):i.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const bx="modulepreload",xx=function(o){return"/"+o},up={},Sn=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var h=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=xx(v),v in up)return;up[v]=!0;const x=v.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${_}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":bx,x||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),x)return new Promise((E,R)=>{b.addEventListener("load",E),b.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function sm({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:h="Cancelar"}){return o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),i.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:h}),i.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function _x(){const[o,a]=j.useState(null),[s,l]=j.useState(!1),[u,d]=j.useState(!1),[h,g]=j.useState({}),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(null),[E,R]=j.useState(!1),[N,A]=j.useState(null),[I,M]=j.useState(null),[G,T]=j.useState(!1),[L,D]=j.useState(""),[H,ve]=j.useState(""),[Y,oe]=j.useState(null),[je,q]=j.useState(null);j.useEffect(()=>{let O=!0;return(async()=>{l(!0);try{const V=(await Sn(async()=>{const{default:de}=await Promise.resolve().then(()=>jn);return{default:de}},void 0)).default,{data:J,error:he}=await V.from("empresa").select("*").limit(1).single();if(!O)return;if(he)throw he;if(J){a(J),g(J);try{localStorage.setItem("companyData",JSON.stringify(J))}catch{}l(!1);return}}catch(V){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",V)}try{const V=localStorage.getItem("companyData");if(V){a(JSON.parse(V)),g(JSON.parse(V)),l(!1);return}}catch{}try{const V=await fetch("/data-base/company.json");if(!V.ok)throw new Error("no json");const J=await V.json();if(!O)return;a(J),g(J)}catch{O&&a(null)}finally{O&&l(!1)}})(),()=>{O=!1}},[]),j.useEffect(()=>{o&&g(o)},[o]),j.useEffect(()=>{try{const O=localStorage.getItem("pendingCompanySave");if(O){const V=JSON.parse(O);x(!0),b(V.payload??null),R(!!V.needsLogo)}}catch{}},[]),j.useEffect(()=>{let O=!0;return(async()=>{try{if(!o||!o.logo){O&&oe(null);return}const V=String(o.logo);if(V.startsWith("http")){O&&oe(V);return}const J=(await Sn(async()=>{const{default:Se}=await Promise.resolve().then(()=>jn);return{default:Se}},void 0)).default,he="logo",k=(await J.storage.from(he).getPublicUrl(V))?.data?.publicUrl??null;if(k){O&&oe(k);return}const me=(await J.storage.from(he).createSignedUrl(V,3600))?.data?.signedUrl??null;if(me){O&&oe(me);return}O&&oe(null)}catch(V){console.warn("Error resolving company logo URL",V),O&&oe(null)}})(),()=>{O=!1}},[o?.logo]),j.useEffect(()=>{let O=!0;return(async()=>{try{if(p){O&&q(p);return}const V=h?.logo;if(!V){O&&q(null);return}const J=String(V);if(J.startsWith("http")){O&&q(J);return}const he=(await Sn(async()=>{const{default:Ae}=await Promise.resolve().then(()=>jn);return{default:Ae}},void 0)).default,de="logo",ne=(await he.storage.from(de).getPublicUrl(J))?.data?.publicUrl??null;if(ne){O&&q(ne);return}const Se=(await he.storage.from(de).createSignedUrl(J,3600))?.data?.signedUrl??null;if(Se){O&&q(Se);return}O&&q(null)}catch(V){console.warn("Error resolving edit logo URL",V),O&&q(null)}})(),()=>{O=!1}},[h?.logo,p]);function te(){d(!0),g(o||{})}function X(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function C(O){const{name:V,value:J}=O.target;g(he=>({...he,[V]:J}))}function U(O){const V=O.target.files?.[0]??null;if(g(J=>({...J,logoFile:V})),V)try{const J=URL.createObjectURL(V);m(J)}catch{m(null)}else m(null)}function W(O=!1){const V="logo",J="https://sqwqlvsjtimallidxrsz.supabase.co";if(O){if(p)return p;const k=h?.logo;if(!k)return"/logo192.png";if(String(k).startsWith("http"))return String(k);let ne=String(k);return ne.startsWith(`${V}/`)&&(ne=ne.slice(V.length+1)),`${J}/storage/v1/object/public/${V}/${encodeURIComponent(ne)}`}if(!o)return"/logo192.png";const he=o.logo;if(!he)return"/logo192.png";if(String(he).startsWith("http"))return String(he);let de=String(he);return de.startsWith(`${V}/`)&&(de=de.slice(V.length+1)),`${J}/storage/v1/object/public/${V}/${encodeURIComponent(de)}`}async function ue(){try{const O=(await Sn(async()=>{const{default:ne}=await Promise.resolve().then(()=>jn);return{default:ne}},void 0)).default,V={...h||{}};let J=null;const he=ne=>{if(!ne)return null;if(!ne.startsWith("http"))return ne;const me=ne.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return me?decodeURIComponent(me[2]):null},de=o?.logo??null;try{const ne=h&&h.logoFile instanceof File?h.logoFile:null,me="logo";if(ne){const Ae=`logo/${V.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${ne.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,De=await O.storage.from(me).upload(Ae,ne,{upsert:!0});if(De.error)throw De.error;const qe=De.data?.path??Ae;J=qe,V.logo=qe}}catch(ne){console.warn("Logo upload error",ne)}try{V.logoFile&&delete V.logoFile}catch{}let k=null;try{if(o&&o.id){const{data:ne,error:me}=await O.from("empresa").update(V).eq("id",o.id).select("*");if(me)throw me;k=Array.isArray(ne)?ne[0]??null:ne}else{const{data:ne,error:me}=await O.from("empresa").insert(V).select("*");if(me)throw me;k=Array.isArray(ne)?ne[0]??null:ne}try{if(J){const ne=he(de);if(ne&&ne!==J){const Se=await O.storage.from("logo").remove([ne]);Se.error&&console.warn("Failed to remove old company logo after DB update",Se.error)}}}catch(ne){console.warn("Error removing old logo after DB success",ne)}}catch(ne){try{if(J){const Se=await O.storage.from("logo").remove([J]);Se.error&&console.warn("Failed to remove uploaded logo after DB error",Se.error)}}catch(me){console.warn("Error cleaning uploaded logo after DB failure",me)}throw ne}a(k),g(k);try{console.debug("Empresa guardada, logo field:",k?.logo)}catch{}try{M(k?.logo??null)}catch{}try{D("Datos guardados"),ve("Los datos de la empresa se guardaron correctamente."),T(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(k))}catch{}d(!1)}catch(O){console.error("Error guardando empresa en Supabase",O);try{A(O?.message||String(O))}catch{}try{const V={...h||{}};V.logoFile&&delete V.logoFile;const J=!!(h&&h.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:V,needsLogo:J,ts:Date.now()})),x(!0),b(V),R(J),a(h);try{localStorage.setItem("companyData",JSON.stringify(h))}catch{}d(!1),D("Guardado localmente"),ve("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),T(!0)}catch(V){console.error("Error saving locally",V)}}}async function _e(){const O=_;if(!O){D("Sin pendientes"),ve("No hay datos pendientes para enviar"),T(!0);return}try{const V=(await Sn(async()=>{const{default:he}=await Promise.resolve().then(()=>jn);return{default:he}},void 0)).default;let J=null;if(O.id){const{data:he,error:de}=await V.from("empresa").update(O).eq("id",O.id).select("*");if(de)throw de;J=Array.isArray(he)?he[0]??null:he}else{const{data:he,error:de}=await V.from("empresa").insert(O).select("*");if(de)throw de;J=Array.isArray(he)?he[0]??null:he}localStorage.removeItem("pendingCompanySave"),x(!1),b(null),R(!1),a(J),g(J),D("Sincronizado"),ve("Los datos pendientes se sincronizaron con Supabase correctamente."),T(!0)}catch(V){console.error("Error reenviando datos pendientes",V),D("Error al reenviar"),ve("No se pudo reenviar los datos a Supabase: "+(V?.message||String(V))),T(!0)}}function w(){try{localStorage.removeItem("pendingCompanySave"),x(!1),b(null),R(!1),D("Pendiente descartado"),ve("El guardado pendiente fue descartado."),T(!0)}catch{}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?i.jsx("div",{children:"Cargando datos de la empresa..."}):o?i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?i.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",N?i.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(N)]}):null,E?i.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("button",{className:"btn-primary",onClick:_e,children:"Reintentar guardar en Supabase"}),i.jsx("button",{className:"btn-opaque",onClick:w,children:"Descartar pendiente"})]})]})}):null,I?i.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[i.jsx("strong",{children:"Logo guardado:"}),i.jsxs("div",{style:{marginTop:6},children:[i.jsx("a",{href:W(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),i.jsx("div",{style:{color:"#374151",fontSize:12},children:String(I)})]})]}):null,i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:i.jsx("img",{src:u?je??W(!0):Y??W(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),i.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"RTN:"})," ",u?i.jsx("input",{name:"rtn",value:h.rtn||"",onChange:C,className:"input"}):o.rtn]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Telfono:"})," ",u?i.jsx("input",{name:"telefono",value:h.telefono||"",onChange:C,className:"input"}):o.telefono]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Correo:"})," ",u?i.jsx("input",{name:"email",value:h.email||"",onChange:C,className:"input"}):o.email]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Direccin:"})," ",u?i.jsx("textarea",{name:"direccion",value:h.direccion||"",onChange:C,className:"input",style:{minHeight:64}}):o.direccion]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("strong",{children:"Logo (archivo o URL):"}),u?i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[i.jsx("input",{type:"file",accept:"image/*",onChange:U}),i.jsx("input",{name:"logo",value:h.logo||"",onChange:C,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):i.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?i.jsxs("div",{style:{marginTop:8},children:[i.jsx("small",{children:"Preview:"}),i.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",onClick:ue,className:"btn-primary",children:"Guardar"}),i.jsx("button",{type:"button",onClick:X,className:"btn-opaque",children:"Cancelar"})]}):i.jsx(i.Fragment,{children:i.jsx("button",{type:"button",onClick:te,className:"btn-primary",children:"Actualizar datos"})})})]}),i.jsx("div",{style:{flex:1,minWidth:320},children:i.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:i.jsx("img",{src:u?je??W(!0):Y??W(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),i.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),i.jsxs("p",{style:{margin:0},children:["RTN: ",i.jsx("strong",{children:o.rtn})]}),i.jsxs("p",{style:{margin:0},children:["Telfono: ",i.jsx("strong",{children:o.telefono})]}),i.jsxs("p",{style:{marginTop:8},children:["Correo: ",i.jsx("strong",{children:o.email})]}),i.jsxs("p",{style:{marginTop:8},children:["Direccin: ",i.jsx("strong",{children:o.direccion})]})]})})]}):i.jsx("div",{children:"No se encontraron datos de la empresa."}),i.jsx(sm,{open:G,title:L,message:H,onClose:()=>T(!1)})]})}function jx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),i.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function Sx(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[_,b]=j.useState(""),[E,R]=j.useState(null),[N,A]=j.useState(""),[I,M]=j.useState(""),[G,T]=j.useState("");async function L(){l(!0),d(null);try{const{data:q,error:te}=await ae.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(te)throw te;a(Array.isArray(q)?q:[])}catch(q){d(q?.message||String(q)),a([])}finally{l(!1)}}async function D(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const q={username:p,password:v,role:"cajero"};_&&(q.nombre_usuario=_);const{error:te}=await ae.from("users").insert(q);if(te)throw te;m(""),x(""),b(""),await L()}catch(q){d(q?.message||String(q))}finally{l(!1)}}function H(q){R(q.id),A(q.username||""),T(q.nombre_usuario||""),M(""),d(null)}function ve(){R(null),A(""),M(""),T(""),d(null)}async function Y(){if(E!=null){if(!N)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const q={username:N};I&&(q.password=I),q.nombre_usuario=G||null;const{error:te}=await ae.from("users").update(q).eq("id",E);if(te)throw te;ve(),await L()}catch(q){d(q?.message||String(q))}finally{l(!1)}}}async function oe(q,te){if(te!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:X}=await ae.from("users").delete().eq("id",q);if(X)throw X;await L()}catch(X){d(X?.message||String(X))}finally{l(!1)}}}j.useEffect(()=>{let q=!0;return(async()=>q&&await L())(),()=>{q=!1}},[]);const je=o.filter(q=>{if(!h)return!0;const te=h.toLowerCase();return(q.username||"").toLowerCase().includes(te)||(String(q.id)||"").includes(te)||(q.role||"").toLowerCase().includes(te)||(q.nombre_usuario||"").toLowerCase().includes(te)});return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[i.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:h,onChange:q=>g(q.target.value),style:{minWidth:220}}),i.jsx("button",{onClick:()=>L(),className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${je.length} usuarios`}),i.jsx("div",{style:{width:"100%",height:8}}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:q=>m(q.target.value)}),i.jsx("input",{placeholder:"Nombre",className:"input",value:_,onChange:q=>b(q.target.value)}),i.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:q=>x(q.target.value)}),i.jsx("button",{onClick:()=>D(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?i.jsx("div",{style:{color:"red",marginBottom:12},children:u}):i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Rol"})]})}),i.jsx("tbody",{children:je.map(q=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:q.id}),i.jsx("td",{style:{minWidth:180},children:E===q.id?i.jsx("input",{className:"input",value:N,onChange:te=>A(te.target.value)}):q.username||"-"}),i.jsx("td",{style:{minWidth:180},children:E===q.id?i.jsx("input",{className:"input",value:G,onChange:te=>T(te.target.value)}):q.nombre_usuario||"-"}),i.jsx("td",{style:{width:220},children:E===q.id?i.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:I,onChange:te=>M(te.target.value)}):q.role||"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:E===q.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Y(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),i.jsx("button",{onClick:()=>ve(),className:"btn-opaque",children:"Cancelar"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>H(q),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),q.role==="cajero"?i.jsx("button",{onClick:()=>oe(q.id,q.role),className:"btn-danger",children:"Eliminar"}):i.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},q.id))})]}),je.length===0&&!s&&i.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function wx({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:h}){const[g,p]=j.useState(null),[m,v]=j.useState(null),[x,_]=j.useState(!1),[b,E]=j.useState(null),[R,N]=j.useState(""),[A,I]=j.useState(""),[M,G]=j.useState(""),[T,L]=j.useState(""),[D,H]=j.useState(null),[ve,Y]=j.useState(""),[oe,je]=j.useState(!1),[q,te]=j.useState(null);if(j.useEffect(()=>{if(!o||!s)return;E(s.caja??null),N(s.cai??""),Y(s.identificador??""),I(s.rango_de??""),G(s.rango_hasta??""),L(s.fecha_vencimiento??""),H(s.secuencia_actual??null);const C=s.cajero??null;if(C){const U=l.find(W=>W.username===C||W.nombre_usuario===C);U?(p(U.id),v(null),_(!1)):(p(null),v(C),_(!0))}else p(null),v(null),_(!1);te(null)},[o,s,l]),!o||!s)return null;async function X(){if(!s){te("Registro invlido");return}if(b!=null&&(b<1||b>5)){te("La caja debe estar entre 1 y 5");return}je(!0),te(null);try{const C={cai:R??null,identificador:ve??null,rango_de:A??null,rango_hasta:M??null,fecha_vencimiento:T??null,secuencia_actual:D??null,caja:b??null};if(g!=null){const U=l.find(W=>W.id===g);C.cajero=U?U.username:null,C.usuario_id=U?U.id:null}else C.cajero=m??null,C.usuario_id=null;await h(s.id,C),a()}catch(C){te(C?.message||String(C))}finally{je(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:R,onChange:C=>N(C.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:ve,onChange:C=>Y(C.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:A,onChange:C=>I(C.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:M,onChange:C=>G(C.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:T,onChange:C=>L(C.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:D??"",onChange:C=>H(C.target.value===""?null:C.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):x?"__custom__":"",onChange:C=>{const U=C.target.value;U===""?(p(null),v(null),_(!1)):U==="__custom__"?(p(null),_(!0)):/^\d+$/.test(U)&&(p(Number(U)),v(null),_(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(C=>i.jsxs("option",{value:String(C.id),children:[C.username,C.nombre_usuario?`  ${C.nombre_usuario}`:""]},C.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),x&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:C=>{v(C.target.value),p(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:C=>E(C.target.value===""?null:Number(C.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(C=>i.jsx("option",{value:C,children:C},C))]})]})]})]})]}),q&&i.jsx("div",{style:{color:"red",marginTop:12},children:q}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:oe,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:X,disabled:oe,style:{width:"auto",padding:"8px 14px"},children:oe?"Guardando...":"Guardar"})]})]})})}function Ex({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[h,g]=j.useState(null),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(null),[E,R]=j.useState(""),[N,A]=j.useState(""),[I,M]=j.useState(""),[G,T]=j.useState(""),[L,D]=j.useState(null),[H,ve]=j.useState(""),[Y,oe]=j.useState(!1),[je,q]=j.useState(null);if(!o)return null;async function te(){const X=[];if(E||X.push("CAI"),N||X.push("Rango Desde"),I||X.push("Rango Hasta"),G||X.push("Fecha de Vencimiento"),_==null&&X.push("Caja"),h==null&&!p&&X.push("Cajero"),X.length>0){q(`Campos obligatorios faltantes: ${X.join(", ")}`);return}if(_!=null&&(_<1||_>5)){q("La caja debe estar entre 1 y 5");return}oe(!0),q(null);try{const C={cai:E??null,identificador:H??null,rango_de:N??null,rango_hasta:I??null,fecha_vencimiento:G??null,secuencia_actual:L??null,caja:_??null};if(h!=null){const U=s.find(W=>W.id===h);C.cajero=U?U.username:null,C.usuario_id=U?U.id:null}else C.cajero=p??null,C.usuario_id=null;await d(C),a()}catch(C){q(C?.message||String(C))}finally{oe(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),i.jsx("input",{className:"input",value:E,onChange:X=>R(X.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Identificador"}),i.jsx("input",{className:"input",value:H,onChange:X=>ve(X.target.value),placeholder:"Identificador (opcional)"}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),i.jsx("input",{className:"input",value:N,onChange:X=>A(X.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),i.jsx("input",{className:"input",value:I,onChange:X=>M(X.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),i.jsx("input",{className:"input",type:"date",value:G,onChange:X=>T(X.target.value)}),i.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Secuencia actual"}),i.jsx("input",{className:"input",value:L??"",onChange:X=>D(X.target.value===""?null:X.target.value),placeholder:"0"}),i.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:h!=null?String(h):v?"__custom__":"",onChange:X=>{const C=X.target.value;C===""?(g(null),m(null),x(!1)):C==="__custom__"?(g(null),x(!0)):/^\d+$/.test(C)&&(g(Number(C)),m(null),x(!1))},children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(X=>i.jsxs("option",{value:String(X.id),children:[X.username,X.nombre_usuario?`  ${X.nombre_usuario}`:""]},X.id)),i.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&i.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:X=>{m(X.target.value),g(null)},style:{minHeight:36}}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),i.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:_??"",onChange:X=>b(X.target.value===""?null:Number(X.target.value)),children:[i.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(X=>i.jsx("option",{value:X,children:X},X))]})]})]})]})]}),je&&i.jsx("div",{style:{color:"red",marginTop:12},children:je}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:Y,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:te,disabled:Y,style:{width:"auto",padding:"8px 14px"},children:Y?"Creando...":"Crear"})]})]})})}function Cx(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(null),[v,x]=j.useState(!1),[_,b]=j.useState(!1);async function E(){l(!0),d(null);try{const{data:T,error:L}=await ae.from("cai").select("id, cai, identificador, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual, caja, cajero, usuario_id").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(T)?T:[])}catch(T){d(T?.message||String(T)),a([])}finally{l(!1)}}async function R(){try{const{data:T}=await ae.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(T)?T:[])}catch{}}j.useEffect(()=>{E(),R()},[]);const N=new Set(o.filter(T=>T.cajero).map(T=>String(T.cajero))),A=new Set(o.filter(T=>T.caja!=null).map(T=>Number(T.caja)));function I(T){m(T),x(!0),d(null)}function M(){x(!1),m(null)}async function G(T,L){l(!0),d(null);try{const{error:D}=await ae.from("cai").update(L).eq("id",T);if(D)throw D;await E()}catch(D){throw d(D?.message||String(D)),D}finally{l(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>E(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"CAI"}),i.jsx("th",{children:"Identificador"}),i.jsx("th",{children:"Rango Desde"}),i.jsx("th",{children:"Rango Hasta"}),i.jsx("th",{children:"Vencimiento"}),i.jsx("th",{children:"Secuencia actual"}),i.jsx("th",{children:"Cajero"}),i.jsx("th",{children:"Usuario ID"}),i.jsx("th",{children:"Caja"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(T=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:T.id}),i.jsx("td",{style:{minWidth:200},children:T.cai}),i.jsx("td",{style:{minWidth:160},children:T.identificador??"-"}),i.jsx("td",{children:T.rango_de}),i.jsx("td",{children:T.rango_hasta}),i.jsx("td",{children:T.fecha_vencimiento}),i.jsx("td",{children:T.secuencia_actual??"-"}),i.jsx("td",{style:{minWidth:180},children:T.cajero||"-"}),i.jsx("td",{style:{minWidth:160},children:T.usuario_id??"-"}),i.jsx("td",{style:{width:120},children:T.caja??"-"}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx(i.Fragment,{children:i.jsx("button",{onClick:()=>I(T),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},T.id))})]}),o.length===0&&!s&&i.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),i.jsx(wx,{open:v,onClose:M,row:p,cajeros:h,availableCajeros:p?h.filter(T=>!N.has(T.username)||T.username===p.cajero):h.filter(T=>!N.has(T.username)),availableCajas:p?[1,2,3,4,5].filter(T=>!A.has(T)||T===p.caja):[1,2,3,4,5].filter(T=>!A.has(T)),onSave:G}),i.jsx(Ex,{open:_,onClose:()=>b(!1),cajeros:h,availableCajeros:h.filter(T=>!N.has(T.username)),availableCajas:[1,2,3,4,5].filter(T=>!A.has(T)),onCreate:async T=>{l(!0),d(null);try{const{error:L}=await ae.from("cai").insert(T);if(L)throw L;await E(),b(!1)}catch(L){throw d(L?.message||String(L)),L}finally{l(!1)}}})]})}function Tx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function Ax(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),i.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var $u=fp();function Nx({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,h]=ku.useState(!1);if(!o)return null;const g=async()=>{try{h(!0),await u()}finally{h(!1)}};return $u.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsx("p",{children:s}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),i.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function Rx({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[h,g]=j.useState({}),[p,m]=j.useState(!1),[v,x]=j.useState(null);if(j.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?x(l.imagen):x(null)},[l,o]),!o)return null;const _=(N,A)=>{g(I=>({...I,[N]:A}))},b=async N=>{N.preventDefault();try{m(!0),await d(h)}finally{m(!1)}},E=N=>N==="creado_en"?null:N==="id"?i.jsx("input",{className:"input",value:h[N]??"",readOnly:!0}):N.includes("publicacion")||N.includes("exento")||N.includes("aplica_impuesto")||N==="publicacion_web"?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("label",{className:"switch",children:[i.jsx("input",{type:"checkbox",checked:!!h[N],onChange:A=>_(N,A.target.checked)}),i.jsx("span",{className:"slider"})]}),i.jsx("span",{style:{fontSize:13},children:h[N]?"S":"No"})]}):N.includes("categoria")||N.includes("marca")?i.jsx("input",{type:"text",className:"input",value:h[N]??"",onChange:A=>_(N,A.target.value===""?null:A.target.value)}):N==="imagen"?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?i.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,i.jsx("input",{type:"file",accept:"image/*",onChange:A=>{const I=A.target.files&&A.target.files[0];if(_(N,I??null),I)try{const M=URL.createObjectURL(I);x(M)}catch{x(null)}else x(null)}}),v?i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{_(N,null),x(null)},children:"Eliminar imagen"}):null]}):i.jsx("input",{className:"input",value:h[N]??"",onChange:A=>_(N,A.target.value)}),R=i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:a}),i.jsxs("form",{onSubmit:b,children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(N=>i.jsxs("label",{style:{display:"block"},children:[i.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(N).replace(/_/g," ").toUpperCase()}),E(N)]},N))}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),i.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return $u.createPortal(R,typeof document<"u"&&document.body||document.createElement("div"))}function Ox({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const h=a||{},[g,p]=j.useState(null),[m,v]=j.useState(null),[x,_]=j.useState(null),[b,E]=j.useState(null);return j.useEffect(()=>{let R=!0;return(async()=>{const A=typeof h.imagen=="string"?h.imagen:null;if(!A){R&&p(null);return}if(A.startsWith("http")){R&&(p(A),_(A));return}let I=A;const M=String(A).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);M&&(I=decodeURIComponent(M[2]));const G="inventario";try{const T=(await Sn(async()=>{const{default:Y}=await Promise.resolve().then(()=>jn);return{default:Y}},void 0)).default,L=await T.storage.from(G).getPublicUrl(I),D=L?.data?.publicUrl||L?.data?.publicURL||null;if(D){R&&(p(D),_(D));return}const H=await T.storage.from(G).createSignedUrl(I,3600*24*7);if(H.error){console.warn("ProductDetailModal createSignedUrl error",H.error),R&&p(null);return}const ve=H.data?.signedUrl??null;R&&(p(ve),_(ve))}catch(T){console.error("ProductDetailModal resolve error",T),R&&p(null)}})(),()=>{R=!1}},[h]),j.useEffect(()=>{let R=!0;return(async()=>{if(E(null),!!x)try{const A=await fetch(x,{method:"HEAD"});if(!R)return;E(`HEAD ${A.status} ${A.statusText} - content-type: ${A.headers.get("content-type")}`)}catch(A){if(!R)return;E(`FETCH_ERROR: ${String(A)}`)}})(),()=>{R=!1}},[x]),$u.createPortal(i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:s}),i.jsxs("div",{style:{display:"flex",gap:18},children:[i.jsx("div",{style:{flex:1},children:i.jsx("table",{style:{width:"100%"},children:i.jsx("tbody",{children:Object.keys(h).map(R=>{const N=h[R];return R==="imagen"&&typeof N=="string"?null:i.jsxs("tr",{children:[i.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(R).replace(/_/g," ").toUpperCase()}),i.jsx("td",{style:{padding:6},children:String(N??"-")})]},R)})})})}),i.jsx("div",{style:{width:280,textAlign:"center"},children:g?i.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:R=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?i.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[i.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),i.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):i.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(h),children:"Editar"}),i.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(h.id),children:"Eliminar"}),i.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function kx({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:h,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:x=[]}){const[_,b]=j.useState(null),[E,R]=j.useState(!1),[N,A]=j.useState(null),[I,M]=j.useState(""),[G,T]=j.useState(!1),[L,D]=j.useState("add"),[H,ve]=j.useState({}),[Y,oe]=j.useState(!1),[je,q]=j.useState(null),[te,X]=j.useState(!1),[C,U]=j.useState(null),W=j.useRef(!0),ue=async()=>{R(!0),A(null);try{const de=(await Sn(async()=>{const{default:Se}=await Promise.resolve().then(()=>jn);return{default:Se}},void 0)).default,k=a||"*";let ne=de.from(o).select(k).limit(l);h&&(Array.isArray(h)?h:String(h).split(",").map(Ae=>Ae.trim()).filter(Boolean)).forEach(Ae=>{const De=Ae.split(" ").map(mt=>mt.trim()).filter(Boolean),qe=De[0],Ze=De[1]?De[1].toLowerCase():"asc";ne=ne.order(qe,{ascending:Ze!=="desc"})}),g&&Object.entries(g).forEach(([Se,Ae])=>{Ae==null||Ae===""||(ne=ne.eq(Se,Ae))});const me=await ne;if(console.debug("SupabaseTable fetch result for",o,me),!W.current)return;if(me.error)throw me.error;b(Array.isArray(me.data)?me.data:[])}catch(de){console.error("SupabaseTable error",de),A(de?.message||String(de)),b([])}finally{W.current&&R(!1)}};j.useEffect(()=>(W.current=!0,ue(),()=>{W.current=!1}),[o,a,l]);const _e=j.useMemo(()=>u&&u.length>0?u:!_||_.length===0?[]:Object.keys(_[0]),[u,_]),w=j.useMemo(()=>{if(!_)return null;const de=(I||"").toString().trim().toLowerCase();if(!de)return _;const k=d&&d.length>0?d:_e;return _.filter(ne=>k.some(me=>{const Se=ne?.[me];return Se==null?!1:String(Se).toLowerCase().includes(de)}))},[_,I,d,_e]),O=()=>{p&&(D("add"),ve({}),T(!0))},V=de=>{m&&(D("edit"),ve(de),T(!0))},J=async de=>{const k=(await Sn(async()=>{const{default:ne}=await Promise.resolve().then(()=>jn);return{default:ne}},void 0)).default;try{const ne="inventario",me={...de},Se=L==="edit"?H?.imagen??null:null,Ae=De=>{if(!De)return null;if(!De.startsWith("http"))return De;const qe=De.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return qe?decodeURIComponent(qe[2]):null};if(me.imagen&&me.imagen instanceof File){const De=me.imagen,qe=me.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Ze=`${o}/${qe}/${Date.now()}_${De.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,mt=await k.storage.from(ne).upload(Ze,De,{upsert:!0});if(mt.error)throw mt.error;const yt=mt.data?.path??Ze;me.imagen=yt;try{const ft=Ae(Se);if(ft&&ft!==yt){const wt=await k.storage.from(ne).remove([ft]);wt.error&&console.warn("Failed to remove old image",wt.error)}}catch(ft){console.warn("Error removing old image",ft)}}if(L==="edit"&&(me.imagen==null||me.imagen===""))try{const De=Ae(H?.imagen??null);if(De){const qe=await k.storage.from(ne).remove([De]);qe.error&&console.warn("Failed to remove old image on clear",qe.error)}}catch(De){console.warn("Error removing old image on clear",De)}if(L==="add"){const{error:De}=await k.from(o).insert([me]);if(De)throw De}else{const De=me.id,qe={...me};delete qe.id;const{error:Ze}=await k.from(o).update(qe).eq("id",De);if(Ze)throw Ze}T(!1),await ue()}catch(ne){console.error("Error saving",ne),A(ne?.message||String(ne))}},he=async()=>{if(je==null)return;const de=(await Sn(async()=>{const{default:k}=await Promise.resolve().then(()=>jn);return{default:k}},void 0)).default;try{if(!v)return;try{const ne="inventario",me=_?.find(qe=>qe.id===je),Se=qe=>{if(!qe)return null;if(!qe.startsWith("http"))return qe;const Ze=qe.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Ze?decodeURIComponent(Ze[2]):null},Ae=me?.imagen??null,De=Se(Ae);if(De){const qe=await de.storage.from(ne).remove([De]);qe.error&&console.warn("Failed to remove image on delete",qe.error)}}catch(ne){console.warn("Error removing image before delete",ne)}const{error:k}=await de.from(o).delete().eq("id",je);if(k)throw k;oe(!1),q(null),await ue()}catch(k){console.error("Error deleting",k),A(k?.message||String(k))}};return i.jsxs("div",{style:{padding:18},children:[s?i.jsx("h2",{style:{marginTop:0},children:s}):null,i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("input",{placeholder:"Buscar...",value:I,onChange:de=>M(de.target.value),className:"input",style:{minWidth:240}}),i.jsx("button",{onClick:()=>{A(null),M(""),ue()},className:"btn-opaque",children:"Recargar"}),i.jsx("div",{style:{marginLeft:"auto"},children:i.jsx("button",{onClick:O,className:"btn-primary",children:"Agregar"})})]}),E&&i.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),N&&i.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",N]}),!E&&_&&_.length===0&&i.jsxs("div",{children:["No hay registros en la tabla ",i.jsx("strong",{children:o}),"."]}),!E&&w&&w.length>0&&i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[_e.map(de=>i.jsx("th",{children:String(de).replace(/_/g," ").toUpperCase()},de)),i.jsx("th",{style:{width:140},children:"Acciones"})]})}),i.jsx("tbody",{children:w.map((de,k)=>i.jsxs("tr",{children:[_e.map(ne=>{if(ne==="imagen"){const me=de?.imagen??null;return me||console.debug("SupabaseTable: row has no imagen for id",de?.id,de),i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:me?i.jsx(lm,{src:String(me)}):i.jsx("span",{style:{color:"#6b7280"},children:"-"})},ne)}return i.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:zx(de[ne])},ne)}),i.jsx("td",{className:"admin-actions",children:i.jsx("button",{className:"btn-opaque",onClick:()=>{U(de),X(!0)},children:"Ver"})})]},de.id??k))})]})}),i.jsx(Rx,{open:G,title:L==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:_e.filter(de=>!x.includes(de)),initialData:H,onClose:()=>T(!1),onSave:J}),i.jsx(Ox,{open:te,data:C,title:`Detalle de ${o}`,onClose:()=>X(!1),onEdit:de=>{X(!1),V(de)},onDeleteClick:de=>{X(!1),q(de),oe(!0)}}),i.jsx(Nx,{open:Y,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>oe(!1),onConfirm:he})]})}function zx(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return i.jsx(lm,{src:o})}return String(o)}function lm({src:o}){const[a,s]=j.useState(null),[l,u]=j.useState(null);return j.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await Sn(async()=>{const{default:R}=await Promise.resolve().then(()=>jn);return{default:R}},void 0)).default,v="inventario",x=await m.storage.from(v).getPublicUrl(g),_=x?.data?.publicUrl||x?.data?.publicURL||null;if(_){d&&s(_);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const E=b.data?.signedUrl??null;d&&s(E)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?i.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):i.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:i.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function Ux(){const[o,a]=j.useState(null),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]);return j.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await Sn(async()=>{const{default:D}=await Promise.resolve().then(()=>jn);return{default:D}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const E=Array.isArray(b.data)?b.data:[],R=new Set(E.map(D=>D.categoria??"").filter(Boolean)),N=new Set(E.map(D=>D.marca??"").filter(Boolean)),A=E.length,I=E.filter(D=>!!D.publicacion_web).length,M=D=>{if(D==null)return!1;if(typeof D=="boolean")return D===!0;if(typeof D=="number")return D===1;const H=String(D).toLowerCase().trim();return H==="1"||H==="true"||H==="t"||H==="si"||H==="s"||H==="yes"},G=E.filter(D=>M(D.exento)).length,T=E.filter(D=>M(D.aplica_impuesto_18)).length,L=E.filter(D=>M(D.aplica_impuesto_turistico)).length;a({categorias:R.size,marcas:N.size,items:A,publicadas:I,exentos:G,aplica_impuesto_18:T,aplica_impuesto_turistico:L}),g(Array.from(R).sort()),m(Array.from(N).sort())}catch(_){console.error("Error loading inventario summary",_)}})(),()=>{v=!1}},[]),i.jsxs("div",{children:[i.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[i.jsx(ci,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),i.jsx(ci,{label:"Marcas",value:o?String(o.marcas):"..."}),i.jsx(ci,{label:"Items",value:o?String(o.items):"..."}),i.jsx(ci,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),i.jsx(ci,{label:"Exentos",value:o?String(o.exentos):"..."}),i.jsx(ci,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),i.jsx(ci,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),i.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),h.map(v=>i.jsx("option",{value:v,children:v},v))]})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),i.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[i.jsx("option",{value:"",children:"Todas"}),p.map(v=>i.jsx("option",{value:v,children:v},v))]})]}),i.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),i.jsx(kx,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function ci({label:o,value:a}){return i.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),i.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function Dx({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,h]=j.useState(null),[g,p]=j.useState(""),[m,v]=j.useState(!1),[x,_]=j.useState(null),[b,E]=j.useState(null),[R,N]=j.useState(null),[A,I]=j.useState(null),[M,G]=j.useState(null),[T,L]=j.useState(null),[D,H]=j.useState(null),[ve,Y]=j.useState(null),[oe,je]=j.useState(null),[q,te]=j.useState(!1);j.useEffect(()=>{o&&(h(null),p(""),E(null),N(null),I(null),Y(null),je(null),_(null))},[o]);async function X(){const U=[];if(d||U.push("Producto"),g||U.push("Precio"),U.length>0){_(`Faltan campos: ${U.join(", ")}`);return}const W=Number(g);if(isNaN(W)||W<0){_("Precio invlido");return}v(!0),_(null);try{await u({producto_id:d,precio:g});try{const ue={};if(M!==null&&(ue.exento=M),T!==null&&(ue.aplica_impuesto_18=T),D!==null&&(ue.aplica_impuesto_turistico=D),Object.keys(ue).length>0){const{error:_e}=await ae.from("inventario").update(ue).eq("id",d);_e&&console.warn("Error actualizando inventario flags:",_e)}}catch(ue){console.warn("Error al persistir flags en inventario:",ue)}a()}catch(ue){_(ue?.message||String(ue))}finally{v(!1)}}function C(U){return U?Number(U.replace(",",".")):NaN}return j.useEffect(()=>{let U=!0;async function W(){if(E(null),N(null),I(null),Y(null),je(null),!d)return;const ue=C(g);if(!isNaN(ue)){te(!0);try{const{data:_e,error:w}=await ae.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(w)throw w;const O=Array.isArray(_e)?_e.map(tt=>Number(tt.costo_unitario)).filter(tt=>!isNaN(tt)):[],V=O.length>0?O.reduce((tt,it)=>tt+it,0)/O.length:0;if(!U)return;E(V);let J=!1,he=!1,de=!1;try{const{data:tt,error:it}=await ae.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!it&&tt&&(J=!!tt.exento,he=!!tt.aplica_impuesto_18,de=!!tt.aplica_impuesto_turistico,M===null&&G(J),T===null&&L(he),D===null&&H(de))}catch{}const{data:k}=await ae.from("impuesto").select("id, impuesto_venta"),ne={};Array.isArray(k)&&k.forEach(tt=>{ne[String(tt.id)]=Number(tt.impuesto_venta)});const me=M!==null?M:J,Se=T!==null?T:he,Ae=D!==null?D:de;let De=0;me?De=0:Se?De=ne[2]??ne[1]??0:De=ne[1]??0;let qe=0;Ae&&(qe=ne[3]??0);const Ze=(De||0)+(qe||0),mt=Ze>1?Ze/100:Ze,yt=ue*mt;N(Ze),I(yt);const ft=ue-V,wt=V>0?ft/V*100:null;Y(wt);const Ht=ue>0?(ue-V-yt)/ue*100:null;je(Ht)}catch{}finally{U&&te(!1)}}}return W(),()=>{U=!1}},[d,g,M,T,D]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:d??"",onChange:U=>h(U.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(U=>i.jsx("option",{value:U.id,children:U.nombre},U.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!M,onChange:U=>G(U.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!T,onChange:U=>L(U.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!D,onChange:U=>H(U.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:g,onChange:U=>p(U.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:A==null?"":A.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:ve==null?"":ve.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:oe==null?"":oe.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&i.jsx("div",{style:{color:"red",marginTop:12},children:x}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:X,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function Bx({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[h,g]=j.useState(null),[p,m]=j.useState(""),[v,x]=j.useState(!1),[_,b]=j.useState(null),[E,R]=j.useState(null),[N,A]=j.useState(null),[I,M]=j.useState(null),[G,T]=j.useState(null),[L,D]=j.useState(null),[H,ve]=j.useState(null),[Y,oe]=j.useState(null),[je,q]=j.useState(null),[te,X]=j.useState(!1);j.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const W=Number(s.precio);m(isNaN(W)?String(s.precio):W.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function C(W){return W?Number(W.replace(",",".")):NaN}if(j.useEffect(()=>{let W=!0;async function ue(){if(R(null),A(null),M(null),oe(null),q(null),!o||!s||!h)return;const _e=C(p);if(!isNaN(_e)){X(!0);try{const{data:w,error:O}=await ae.from("compras_detalle").select("costo_unitario").eq("producto_id",h);if(O)throw O;const V=Array.isArray(w)?w.map(it=>Number(it.costo_unitario)).filter(it=>!isNaN(it)):[],J=V.length>0?V.reduce((it,Ba)=>it+Ba,0)/V.length:0;if(!W)return;R(J);let he=!1,de=!1,k=!1;try{const{data:it,error:Ba}=await ae.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",h).single();!Ba&&it&&(he=!!it.exento,de=!!it.aplica_impuesto_18,k=!!it.aplica_impuesto_turistico,G===null&&T(he),L===null&&D(de),H===null&&ve(k))}catch{}const{data:ne}=await ae.from("impuesto").select("id, impuesto_venta"),me={};Array.isArray(ne)&&ne.forEach(it=>me[String(it.id)]=Number(it.impuesto_venta));const Se=G!==null?G:he,Ae=L!==null?L:de,De=H!==null?H:k;let qe=0;Se?qe=0:Ae?qe=me[2]??me[1]??0:qe=me[1]??0;let Ze=0;De&&(Ze=me[3]??0);const mt=(qe||0)+(Ze||0),yt=mt>1?mt/100:mt,ft=_e*yt;A(mt),M(ft);const wt=_e-J,Ht=J>0?wt/J*100:null;oe(Ht);const tt=_e>0?(_e-J-ft)/_e*100:null;q(tt)}catch{}finally{W&&X(!1)}}}return ue(),()=>{W=!1}},[o,s,h,p,G,L,H]),!o||!s)return null;async function U(){const W=[];if(h||W.push("Producto"),p||W.push("Precio"),W.length>0){b(`Faltan campos: ${W.join(", ")}`);return}const ue=Number(p);if(isNaN(ue)||ue<0){b("Precio invlido");return}x(!0),b(null);try{const _e=s.id;await d(_e,{producto_id:h,precio:p});try{const w={};if(G!==null&&(w.exento=G),L!==null&&(w.aplica_impuesto_18=L),H!==null&&(w.aplica_impuesto_turistico=H),Object.keys(w).length>0&&h){const{error:O}=await ae.from("inventario").update(w).eq("id",h);O&&console.warn("Error actualizando inventario flags:",O)}}catch(w){console.warn("Error al persistir flags en inventario:",w)}a()}catch(_e){b(_e?.message||String(_e))}finally{x(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Producto"}),i.jsxs("select",{className:"input",value:h??"",onChange:W=>g(W.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(W=>i.jsx("option",{value:W.id,children:W.nombre},W.id))]}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!G,onChange:W=>T(W.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!L,onChange:W=>D(W.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{type:"checkbox",checked:!!H,onChange:W=>ve(W.target.checked)}),i.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),i.jsx("label",{style:{fontSize:13},children:"Precio"}),i.jsx("input",{className:"input",value:p,onChange:W=>m(W.target.value),placeholder:"0.00"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),i.jsx("input",{className:"input",value:E==null?"":E.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),i.jsx("input",{className:"input",value:I==null?"":I.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),i.jsx("input",{className:"input",value:Y==null?"":Y.toFixed(2),readOnly:!0,placeholder:"--"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),i.jsx("input",{className:"input",value:je==null?"":je.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),_&&i.jsx("div",{style:{color:"red",marginTop:12},children:_}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:U,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function Lx(){const[o,a]=j.useState([]),[s,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[_,b]=j.useState(null);async function E(){d(!0),g(null);try{const{data:T,error:L}=await ae.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(L)throw L;a(Array.isArray(T)?T:[])}catch(T){g(T?.message||String(T)),a([])}finally{d(!1)}}async function R(){try{const{data:T}=await ae.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(T)?T:[])}catch{}}j.useEffect(()=>{E(),R()},[]);const N=new Set(o.map(T=>String(T.producto_id))),A=s.filter(T=>!N.has(T.id));function I(T){b(T),x(!0),g(null)}async function M(T){d(!0),g(null);try{const{error:L}=await ae.from("precios").insert(T);if(L)throw L;try{const D={producto_id:T.producto_id,precio:T.precio},{error:H}=await ae.from("precios_historico").insert(D);H&&console.warn("No se pudo insertar en precios_historico",H)}catch(D){console.warn("Error registrando precios_historico",D)}await E()}catch(L){throw g(L?.message||String(L)),L}finally{d(!1)}}async function G(T,L){d(!0),g(null);try{const{error:D}=await ae.from("precios").update(L).eq("id",T);if(D)throw D;let H=L.producto_id,ve=L.precio;if(!H||ve===void 0)try{const{data:Y}=await ae.from("precios").select("producto_id, precio").eq("id",T).limit(1).single();Y&&(H=H||Y.producto_id,ve=ve===void 0?Y.precio:ve)}catch{}try{if(H&&ve!==void 0){const Y={producto_id:H,precio:ve},{error:oe}=await ae.from("precios_historico").insert(Y);oe&&console.warn("No se pudo insertar en precios_historico",oe)}}catch(Y){console.warn("Error registrando precios_historico",Y)}await E()}catch(D){throw g(D?.message||String(D)),D}finally{d(!1)}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{E(),R()},children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),h&&i.jsx("div",{style:{color:"red",marginBottom:12},children:h}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(T=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:T.id}),i.jsx("td",{style:{minWidth:220},children:s.find(L=>L.id===T.producto_id)?.nombre||T.producto_id}),i.jsx("td",{children:T.precio}),i.jsx("td",{style:{whiteSpace:"nowrap"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>I(T),children:"Editar"})})]},T.id))})]})}),i.jsx(Dx,{open:p,onClose:()=>m(!1),products:A,onCreate:async T=>{await M(T),m(!1)}}),i.jsx(Bx,{open:v,onClose:()=>{x(!1),b(null)},row:_,products:s,availableProducts:[...s.filter(T=>!N.has(T.id)),..._?s.filter(T=>T.id===_.producto_id):[]],onSave:async(T,L)=>{await G(T,L),x(!1),b(null)}})]})}function Mx(){const[o,a]=j.useState(""),[s,l]=j.useState([]),[u,d]=j.useState(null),[h,g]=j.useState([]),[p,m]=j.useState(!1),[v,x]=j.useState(null);async function _(){if(x(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:E,error:R}=await ae.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(R)throw R;if(l(Array.isArray(E)?E:[]),Array.isArray(E)&&E.length===1){const N=E[0].id;d(N),await b(N)}}catch(E){x(E?.message||String(E))}finally{m(!1)}}}async function b(E){m(!0),x(null);try{const{data:R,error:N}=await ae.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",E).order("cambiado_en",{ascending:!1});if(N)throw N;g(Array.isArray(R)?R:[])}catch(R){x(R?.message||String(R)),g([])}finally{m(!1)}}return j.useEffect(()=>{u&&b(u)},[u]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:E=>a(E.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>_(),children:"Buscar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${h.length} registros`})]}),v&&i.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),i.jsx("ul",{children:s.map(E=>i.jsxs("li",{style:{marginBottom:6},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>d(E.id),style:{marginRight:8},children:E.sku}),i.jsx("strong",{children:E.nombre})," ",i.jsxs("span",{style:{color:"#6b7280"},children:["(",E.id,")"]})]},E.id))})]}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Precio"}),i.jsx("th",{children:"Actualizacion"})]})}),i.jsx("tbody",{children:h.map(E=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(E.id)}),i.jsx("td",{style:{minWidth:220},children:s.find(R=>R.id===E.producto_id)?.nombre||E.producto_id}),i.jsx("td",{children:Number(E.precio).toFixed(2)}),i.jsx("td",{children:E.cambiado_en})]},String(E.id)))})]})]})]})}function qx(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState({}),[v,x]=j.useState({}),[_,b]=j.useState(!1),[E,R]=j.useState(null);async function N(){b(!0),R(null);try{let A=ae.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(A=A.ilike("sku",`%${o}%`)),s&&(A=A.ilike("marca",`%${s}%`)),u&&(A=A.ilike("modelo",`%${u}%`));const{data:I,error:M}=await A.order("nombre",{ascending:!0});if(M)throw M;const G=Array.isArray(I)?I:[];g(G);const T=G.map(Y=>Y.id);if(T.length===0){m({});return}const{data:L,error:D}=await ae.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",T);if(D)throw D;const H=Array.isArray(L)?L:[],ve={};for(const Y of G)ve[String(Y.id)]=0;for(const Y of H){const oe=String(Y.producto_id),je=Number(Y.cantidad)||0,q=String(Y.tipo_de_movimiento||"").toUpperCase();ve.hasOwnProperty(oe)||(ve[oe]=0),q==="ENTRADA"?ve[oe]=(ve[oe]||0)+je:q==="SALIDA"&&(ve[oe]=(ve[oe]||0)-je)}for(const Y of Object.keys(ve))ve[Y]=Number((ve[Y]||0).toFixed(2));m(ve);try{const Y=(await Sn(async()=>{const{default:q}=await Promise.resolve().then(()=>jn);return{default:q}},void 0)).default,oe="inventario",je={};await Promise.all(G.map(async q=>{const te=q.imagen;if(!te){je[String(q.id)]=null;return}const X=String(te);if(X.startsWith("http")){je[String(q.id)]=X;return}let C=X;const U=String(X).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);U&&(C=decodeURIComponent(U[2]));try{const W=await Y.storage.from(oe).getPublicUrl(C),ue=W?.data?.publicUrl||W?.data?.publicURL||null;if(ue){je[String(q.id)]=ue;return}}catch{}try{const ue=(await Y.storage.from(oe).createSignedUrl(C,604800))?.data?.signedUrl??null;je[String(q.id)]=ue}catch{je[String(q.id)]=null}})),x(je)}catch{}}catch(A){R(A?.message||String(A)),g([]),m({})}finally{b(!1)}}return j.useEffect(()=>{N()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Stock"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:A=>a(A.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:A=>l(A.target.value)}),i.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:A=>d(A.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>N(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),N()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:_?"Cargando...":`${h.length} productos`})]}),E&&i.jsx("div",{style:{color:"red",marginBottom:12},children:E}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Imagen"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Marca"}),i.jsx("th",{children:"Modelo"}),i.jsx("th",{children:"Descripcin"}),i.jsx("th",{children:"Stock"})]})}),i.jsx("tbody",{children:h.map(A=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:v[String(A.id)]?i.jsx("img",{src:encodeURI(v[String(A.id)]),alt:A.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):A.imagen?i.jsx("img",{src:A.imagen,alt:A.nombre,style:{width:48,height:48,objectFit:"cover"},onError:I=>{I.currentTarget.src=""}}):""}),i.jsx("td",{children:A.sku||""}),i.jsx("td",{children:A.marca||""}),i.jsx("td",{children:A.modelo||""}),i.jsx("td",{style:{maxWidth:320},children:A.descripcion||""}),i.jsx("td",{style:{textAlign:"right"},children:p[String(A.id)]!=null?String(p[String(A.id)]):"0"})]},A.id))})]})]})]})}function Ix(){const[o,a]=j.useState(""),[s,l]=j.useState(""),[u,d]=j.useState(""),[h,g]=j.useState([]),[p,m]=j.useState([]),[v,x]=j.useState(!1),[_,b]=j.useState([]),[E,R]=j.useState({}),[N,A]=j.useState(!1),[I,M]=j.useState(null);async function G(){A(!0),M(null),b([]);try{let H=null;if(o||s||u){let te=ae.from("inventario").select("id").order("nombre",{ascending:!0});o&&(te=te.ilike("sku",`%${o}%`)),s&&(te=te.ilike("marca",`%${s}%`)),u&&(te=te.ilike("categoria",`%${u}%`));const{data:X,error:C}=await te;if(C)throw C;if(H=Array.isArray(X)?X.map(U=>String(U.id)):[],H.length===0){b([]),R({}),A(!1);return}}let ve=ae.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(H&&(ve=ve.in("producto_id",H)),v){const te=new Date(Date.now()-864e5).toISOString();ve=ve.gte("fecha_salida",te)}ve=ve.order("fecha_salida",{ascending:!1});const{data:Y,error:oe}=await ve;if(oe)throw oe;const je=Array.isArray(Y)?Y.map(te=>({id:te.id,producto_id:String(te.producto_id),cantidad:Number(te.cantidad),tipo_de_movimiento:te.tipo_de_movimiento,referencia:te.referencia,usuario:te.usuario,fecha_salida:te.fecha_salida})):[];b(je);const q=Array.from(new Set(je.map(te=>te.producto_id))).filter(Boolean);if(q.length>0){const{data:te}=await ae.from("inventario").select("id, nombre, sku, marca, categoria").in("id",q),X={};Array.isArray(te)&&te.forEach(C=>{X[String(C.id)]={id:C.id,nombre:C.nombre,sku:C.sku,marca:C.marca,categoria:C.categoria}}),R(X)}else R({})}catch(H){M(H?.message||String(H)),b([])}finally{A(!1)}}async function T(){try{const{data:H,error:ve}=await ae.from("inventario").select("marca, categoria");if(ve)throw ve;const Y=new Set,oe=new Set;Array.isArray(H)&&H.forEach(je=>{je.marca&&Y.add(String(je.marca)),je.categoria&&oe.add(String(je.categoria))}),g(Array.from(Y).sort()),m(Array.from(oe).sort())}catch(H){console.warn("Error loading filter options",H)}}j.useEffect(()=>{G(),T()},[]);const L=_.filter(H=>String(H.tipo_de_movimiento).toUpperCase()==="ENTRADA"),D=_.filter(H=>String(H.tipo_de_movimiento).toUpperCase()==="SALIDA");return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:H=>a(H.target.value)}),i.jsxs("select",{className:"input",value:s,onChange:H=>l(H.target.value),children:[i.jsx("option",{value:"",children:"-- Marca (todas) --"}),h.map(H=>i.jsx("option",{value:H,children:H},H))]}),i.jsxs("select",{className:"input",value:u,onChange:H=>d(H.target.value),children:[i.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(H=>i.jsx("option",{value:H,children:H},H))]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:v,onChange:H=>x(H.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),x(!1),G()},children:"Limpiar"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:N?"Cargando...":`${_.length} registros`})]}),I&&i.jsx("div",{style:{color:"red",marginBottom:12},children:I}),i.jsxs("div",{style:{display:"flex",gap:12},children:[i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Entradas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:L.map(H=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String(H.id)}),i.jsx("td",{style:{minWidth:120},children:E[H.producto_id]?.sku||H.producto_id}),i.jsx("td",{children:E[H.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number(H.cantidad).toFixed(2)}),i.jsx("td",{children:H.referencia||""}),i.jsx("td",{children:H.usuario||""}),i.jsx("td",{children:H.fecha_salida||""})]},String(H.id)))})]})]}),i.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("strong",{children:"Salidas"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"SKU"}),i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Referencia"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"})]})}),i.jsx("tbody",{children:D.map(H=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:70},children:String(H.id)}),i.jsx("td",{style:{minWidth:120},children:E[H.producto_id]?.sku||H.producto_id}),i.jsx("td",{children:E[H.producto_id]?.nombre||""}),i.jsx("td",{style:{textAlign:"right"},children:Number(H.cantidad).toFixed(2)}),i.jsx("td",{children:H.referencia||""}),i.jsx("td",{children:H.usuario||""}),i.jsx("td",{children:H.fecha_salida||""})]},String(H.id)))})]})]})]})]})}function Hx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),i.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function $x(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),i.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function Px(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),i.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function Vx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function Gx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function Kx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function Fx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),i.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function Yx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),i.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function Jx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),i.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function Qx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),i.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function Xx(){return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),i.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function Zx({open:o,onClose:a,onCreate:s}){const[l,u]=j.useState(""),[d,h]=j.useState(""),[g,p]=j.useState(""),[m,v]=j.useState(""),[x,_]=j.useState(""),[b,E]=j.useState(""),[R,N]=j.useState(!0),[A,I]=j.useState(!1),[M,G]=j.useState(null);if(!o)return null;async function T(){const L=[];if(l.trim()||L.push("Nombre"),L.length){G(`Faltan campos: ${L.join(", ")}`);return}I(!0),G(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:b||void 0,activo:R}),u(""),h(""),p(""),v(""),_(""),E(""),N(!0),a()}catch(D){G(D?.message||String(D))}finally{I(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:l,onChange:L=>u(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:d,onChange:L=>h(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:g,onChange:L=>p(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:m,onChange:L=>v(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:x,onChange:L=>_(L.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:b,onChange:L=>E(L.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:R,onChange:L=>N(L.target.checked)})," ","Activo"]})]}),M&&i.jsx("div",{style:{color:"red",marginTop:12},children:M}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:A,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:T,disabled:A,style:{width:"auto",padding:"8px 14px"},children:A?"Creando...":"Crear"})]})]})})}function Wx({open:o,onClose:a,row:s,onSave:l}){const[u,d]=j.useState(""),[h,g]=j.useState(""),[p,m]=j.useState(""),[v,x]=j.useState(""),[_,b]=j.useState(""),[E,R]=j.useState(""),[N,A]=j.useState(!0),[I,M]=j.useState(!1),[G,T]=j.useState(null);if(j.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),x(s.correo||""),b(s.direccion||""),R(s.tipo_proveedor||""),A(s.activo??!0),T(null))},[o,s]),!o||!s)return null;async function L(){if(!s){T("No hay fila seleccionada");return}const D=[];if(u.trim()||D.push("Nombre"),D.length){T(`Faltan campos: ${D.join(", ")}`);return}M(!0),T(null);try{await l(s.id,{nombre:u.trim(),rtn:h.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:_.trim()||void 0,tipo_proveedor:E||void 0,activo:N}),a()}catch(H){T(H?.message||String(H))}finally{M(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[i.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),i.jsxs("div",{style:{display:"grid",gap:8},children:[i.jsx("label",{style:{fontSize:13},children:"Nombre"}),i.jsx("input",{className:"input",value:u,onChange:D=>d(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"RTN"}),i.jsx("input",{className:"input",value:h,onChange:D=>g(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Telfono"}),i.jsx("input",{className:"input",value:p,onChange:D=>m(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Correo"}),i.jsx("input",{className:"input",value:v,onChange:D=>x(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Direccin"}),i.jsx("input",{className:"input",value:_,onChange:D=>b(D.target.value)}),i.jsx("label",{style:{fontSize:13},children:"Tipo"}),i.jsx("input",{className:"input",value:E,onChange:D=>R(D.target.value),placeholder:"local / internacional"}),i.jsxs("label",{style:{fontSize:13},children:[i.jsx("input",{type:"checkbox",checked:N,onChange:D=>A(D.target.checked)})," ","Activo"]})]}),G&&i.jsx("div",{style:{color:"red",marginTop:12},children:G}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:a,disabled:I,style:{width:"auto"},children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:L,disabled:I,style:{width:"auto",padding:"8px 14px"},children:I?"Guardando...":"Guardar"})]})]})})}function e_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(""),[p,m]=j.useState(!1),[v,x]=j.useState(!1),[_,b]=j.useState(null),[E,R]=j.useState(!1),[N,A]=j.useState(null);async function I(L){l(!0),d(null);try{let D=null,H=null;if(L&&L.trim()){const Y=`%${L.trim()}%`,oe=await ae.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${Y},rtn.ilike.${Y}`).order("id",{ascending:!0});D=oe.data,H=oe.error}else{const ve=await ae.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});D=ve.data,H=ve.error}if(H)throw H;a(Array.isArray(D)?D:[])}catch(D){d(D?.message||String(D)),a([])}finally{l(!1)}}j.useEffect(()=>{I()},[]),j.useEffect(()=>{const L=setTimeout(()=>{I(h)},350);return()=>clearTimeout(L)},[h]);async function M(L){l(!0),d(null);try{const D={...L};if(delete D.id,D.rtn){const{data:ve,error:Y}=await ae.from("proveedores").select("id, nombre").eq("rtn",D.rtn).limit(1);if(Y)throw Y;if(Array.isArray(ve)&&ve.length>0)throw new Error(`Ya existe un proveedor con RTN ${D.rtn}`)}const{error:H}=await ae.from("proveedores").insert(D);if(H)throw H;await I()}catch(D){throw String(D).includes("Ya existe un proveedor")?d(String(D)):D?.code==="23505"||String(D).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(D?.message||String(D)),D}finally{l(!1)}}async function G(L,D){l(!0),d(null);try{const{error:H}=await ae.from("proveedores").update(D).eq("id",L);if(H)throw H;await I()}catch(H){throw d(H?.message||String(H)),H}finally{l(!1)}}async function T(){if(N){l(!0),d(null);try{const{error:L}=await ae.from("proveedores").delete().eq("id",N.id);if(L)throw L;R(!1),A(null),await I()}catch(L){d(L?.message||String(L))}finally{l(!1)}}}return i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>I(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),i.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[i.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:h,onChange:L=>g(L.target.value),style:{width:260}}),i.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),I()},children:"Limpiar"})]}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"RTN"}),i.jsx("th",{children:"Nombre"}),i.jsx("th",{children:"Telfono"}),i.jsx("th",{children:"Correo"}),i.jsx("th",{children:"Direccin"}),i.jsx("th",{children:"Tipo"}),i.jsx("th",{children:"Activo"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(L=>i.jsxs("tr",{children:[i.jsx("td",{children:L.rtn||""}),i.jsx("td",{style:{minWidth:180},children:L.nombre}),i.jsx("td",{children:L.telefono||""}),i.jsx("td",{children:L.correo||""}),i.jsx("td",{children:L.direccion||""}),i.jsx("td",{children:L.tipo_proveedor||""}),i.jsx("td",{children:L.activo?"S":"No"}),i.jsxs("td",{style:{whiteSpace:"nowrap"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{b(L),x(!0)},children:"Editar"}),i.jsx("button",{className:"btn-danger",onClick:()=>{A(L),R(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},L.id))})]})}),i.jsx(Zx,{open:p,onClose:()=>m(!1),onCreate:async L=>{await M(L),m(!1)}}),i.jsx(Wx,{open:v,onClose:()=>{x(!1),b(null)},row:_,onSave:async(L,D)=>{await G(L,D),x(!1),b(null)}}),i.jsx(sm,{open:E,title:N?`Eliminar proveedor ${N.nombre}`:"Eliminar proveedor",message:N?`Confirma eliminar al proveedor ${N.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await T()},onCancel:()=>{R(!1),A(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function t_({open:o,onClose:a,onCreated:s}){const[l,u]=j.useState([]),[d,h]=j.useState([]),[g,p]=j.useState(0),[m,v]=j.useState(null),[x,_]=j.useState(""),[b,E]=j.useState("factura"),[R,N]=j.useState([]),[A,I]=j.useState(null),[M,G]=j.useState(1),[T,L]=j.useState(null),[D,H]=j.useState(!1),[ve,Y]=j.useState(null);if(j.useEffect(()=>{o&&(async()=>{try{const U=await ae.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await ae.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});h(Array.isArray(U.data)?U.data:[])}catch{}try{const U=await ae.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),W=Array.isArray(U.data)&&U.data.length>0?U.data[0]:null,ue=W?Number(W.impuesto_venta):0;p(ue)}catch{}})()},[o]),!o)return null;function oe(){v(null),_(""),E("factura"),N([]),I(null),G(1),L(null),Y(null)}function je(){if(!A){Y("Selecciona un producto");return}if(!T||T<=0){Y("Costo unitario invlido");return}if(!M||M<=0){Y("Cantidad invlida");return}const U=l.find(ue=>ue.id===A),W=ue=>{if(ue==null)return!1;if(typeof ue=="boolean")return ue===!0;if(typeof ue=="number")return ue===1;const _e=String(ue).toLowerCase().trim();return _e==="1"||_e==="true"||_e==="t"||_e==="si"||_e==="s"||_e==="yes"};N(ue=>[...ue,{producto_id:A,nombre:U?.nombre||"",cantidad:M,costo_unitario:T,exento:W(U?.exento)}]),I(null),G(1),L(null),Y(null)}function q(U){N(W=>W.filter((ue,_e)=>_e!==U))}function te(){const U=g,W=U>1?U/100:U;let ue=0,_e=0,w=0;for(const O of R){const V=O.cantidad*O.costo_unitario;let J=0,he=V;O.exento||(J=V*W,he=V-J),ue+=he,_e+=J,w+=V}return{subtotal:ue,impuesto:_e,total:w}}async function X(){if(Y(null),!m){Y("Selecciona un proveedor");return}if(R.length===0){Y("Agrega al menos un producto");return}H(!0);try{const{subtotal:U,impuesto:W,total:ue}=te(),_e={proveedor_id:m,numero_documento:x||null,tipo_documento:b||null,subtotal:U,impuesto:W,total:ue,usuario:null},w=await ae.from("compras").insert(_e).select("id").single();if(w.error)throw w.error;const O=w.data.id,V=R.map(he=>({compra_id:O,producto_id:he.producto_id,cantidad:he.cantidad,costo_unitario:he.costo_unitario})),J=await ae.from("compras_detalle").insert(V);if(J.error)throw await ae.from("compras").delete().eq("id",O),J.error;try{const he=x?`Compra - ${x}`:`Compra ${O}`;let de="sistema";try{const Se=localStorage.getItem("user");if(Se){const Ae=JSON.parse(Se);de=Ae.username?`${Ae.username}${Ae.role?` (${Ae.role})`:""}`:String(Ae)}}catch{}const k=new Date().toISOString(),ne=R.map(Se=>({producto_id:Se.producto_id,cantidad:Se.cantidad,tipo_de_movimiento:"ENTRADA",referencia:he,usuario:de,fecha_salida:k})),me=await ae.from("registro_de_inventario").insert(ne);me.error&&(console.warn("Error registrando en registro_de_inventario",me.error),Y("Compra guardada, pero fall el registro en inventario: "+me.error.message))}catch(he){console.warn("Registro inventario fallo",he)}oe(),a(),s&&s()}catch(U){Y(U?.message||String(U))}finally{H(!1)}}const C=te();return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),i.jsxs("select",{className:"input",value:m??"",onChange:U=>v(U.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(U=>i.jsx("option",{value:U.id,children:U.nombre},String(U.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),i.jsx("input",{className:"input",value:x,onChange:U=>_(U.target.value)}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),i.jsx("input",{className:"input",value:b,onChange:U=>E(U.target.value)})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:A??"",onChange:U=>I(U.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(U=>i.jsx("option",{value:U.id,children:U.nombre},U.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:U=>G(Number(U.target.value))}),i.jsx("input",{className:"input",type:"number",style:{width:120},value:T??"",onChange:U=>L(Number(U.target.value)),placeholder:"Costo unitario"}),i.jsx("button",{className:"btn-primary",onClick:je,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:R.map((U,W)=>{const ue=U.cantidad*U.costo_unitario,_e=g>1?g/100:g,w=U.exento?0:ue*_e,O=U.exento?ue:ue-w;return i.jsxs("tr",{children:[i.jsx("td",{children:U.nombre}),i.jsx("td",{children:U.cantidad}),i.jsx("td",{children:U.costo_unitario.toFixed(2)}),i.jsx("td",{children:w.toFixed(2)}),i.jsx("td",{children:O.toFixed(2)}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>q(W),children:"Quitar"})})]},`${U.producto_id}-${W}`)})})]})})]})]}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("div",{children:["Subtotal: ",i.jsx("strong",{children:C.subtotal.toFixed(2)})]}),i.jsxs("div",{children:["Impuesto: ",i.jsx("strong",{children:C.impuesto.toFixed(2)})]}),i.jsxs("div",{children:["Total: ",i.jsx("strong",{children:C.total.toFixed(2)})]})]})}),ve&&i.jsx("div",{style:{color:"red",marginTop:12},children:ve}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>{oe(),a()},disabled:D,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:X,disabled:D,children:D?"Guardando...":"Confirmar compra"})]})]})})}function n_({open:o,compraId:a,onClose:s}){const[l,u]=j.useState([]),[d,h]=j.useState({}),[g,p]=j.useState({}),[m,v]=j.useState(0),[x,_]=j.useState(!1);return j.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{_(!0);try{const{data:E,error:R}=await ae.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(R)throw R;const N=Array.isArray(E)?E:[];if(!b)return;u(N);const A=Array.from(new Set(N.map(I=>I.producto_id))).filter(Boolean);if(A.length>0){const{data:I}=await ae.from("inventario").select("id, nombre, exento").in("id",A),M={},G={};Array.isArray(I)&&I.forEach(T=>{M[String(T.id)]={id:T.id,nombre:T.nombre},G[String(T.id)]=T.exento===!0||T.exento===1||String(T.exento).toLowerCase()==="true"}),b&&(h(M),p(G))}else h({});try{const{data:I}=await ae.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),M=Array.isArray(I)&&I.length>0?I[0]:null,G=M?Number(M.impuesto_venta):0;b&&v(G)}catch{}}catch(E){console.error("Error cargando detalle de compra",E)}finally{b&&_(!1)}})(),()=>{b=!1}},[o,a]),o?i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),i.jsx("div",{style:{marginTop:8},children:x?i.jsx("div",{children:"Cargando..."}):i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Costo unit."}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:l.map(b=>{const E=Number(b.cantidad),R=Number(b.costo_unitario),N=E*R,A=m>1?m/100:m,I=g[String(b.producto_id)]===!0,M=I?0:N*A,G=I?N:N-M;return i.jsxs("tr",{children:[i.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),i.jsx("td",{children:E.toFixed(2)}),i.jsx("td",{children:R.toFixed(2)}),i.jsx("td",{children:M.toFixed(2)}),i.jsx("td",{children:G.toFixed(2)}),i.jsx("td",{children:N.toFixed(2)})]},String(b.id))})}),i.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((E,R)=>{const N=Number(R.cantidad),A=Number(R.costo_unitario),I=N*A,M=m>1?m/100:m,G=g[String(R.producto_id)]===!0,T=G?0:I*M,L=G?I:I-T;return E.subtotal+=L,E.impuesto+=T,E.total+=I,E},{subtotal:0,impuesto:0,total:0});return i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),i.jsx("td",{children:b.impuesto.toFixed(2)}),i.jsx("td",{children:b.subtotal.toFixed(2)}),i.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function a_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(!1),[v,x]=j.useState(null),[_,b]=j.useState([]),[E,R]=j.useState(""),[N,A]=j.useState(""),[I,M]=j.useState(!1);async function G(){l(!0),d(null);try{let T=ae.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(E){const H=Number(E);isNaN(H)?T=T.eq("proveedor_id",E):T=T.eq("proveedor_id",H)}if(N&&(T=T.ilike("numero_documento",`%${N}%`)),I){const H=new Date(Date.now()-864e5).toISOString();T=T.gte("fecha_compra",H)}const{data:L,error:D}=await T.order("id",{ascending:!1});if(D)throw D;a(Array.isArray(L)?L:[])}catch(T){d(T?.message||String(T)),a([])}finally{l(!1)}}return j.useEffect(()=>{G()},[]),j.useEffect(()=>{let T=!0;return(async()=>{try{const{data:L}=await ae.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!T)return;b(Array.isArray(L)?L:[])}catch{}})(),()=>{T=!1}},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:E,onChange:T=>R(T.target.value),children:[i.jsx("option",{value:"",children:"-- proveedor (todos) --"}),_.map(T=>i.jsx("option",{value:String(T.id),children:T.nombre},String(T.id)))]}),i.jsx("input",{className:"input",placeholder:"Nmero documento",value:N,onChange:T=>A(T.target.value)}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:I,onChange:T=>M(T.target.checked)})," ltimas 24h"]}),i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),i.jsx("button",{className:"btn-opaque",onClick:()=>{R(""),A(""),M(!1),G()},children:"Limpiar"})]}),i.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[i.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Recargar"}),i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),i.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Subtotal"}),i.jsx("th",{children:"Impuesto"}),i.jsx("th",{children:"Total"})]})}),i.jsx("tbody",{children:o.map(T=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(T.id)}),i.jsx("td",{children:String(T.proveedor_id)}),i.jsx("td",{children:T.numero_documento||""}),i.jsx("td",{children:T.fecha_compra||""}),i.jsx("td",{children:T.subtotal||""}),i.jsx("td",{children:T.impuesto||""}),i.jsx("td",{children:T.total||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>{x(T.id),m(!0)},children:"Detalle"})})]},String(T.id)))})]})}),i.jsx(t_,{open:h,onClose:()=>g(!1),onCreated:()=>{g(!1),G()}}),i.jsx(n_,{open:p,compraId:v,onClose:()=>{m(!1),x(null)}})]})}function i_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(!1),[p,m]=j.useState(null);async function v(){l(!0),d(null);try{const{data:x,error:_}=await ae.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(_)throw _;a(Array.isArray(x)?x.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(x){d(x?.message||String(x)),a([])}finally{l(!1)}}return j.useEffect(()=>{v()},[]),i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),i.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[i.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),i.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&i.jsx("div",{style:{color:"red",marginBottom:12},children:u}),i.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"ID"}),i.jsx("th",{children:"Proveedor"}),i.jsx("th",{children:"Documento"}),i.jsx("th",{children:"Usuario"}),i.jsx("th",{children:"Fecha"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:o.map(x=>i.jsxs("tr",{children:[i.jsx("td",{style:{width:80},children:String(x.id)}),i.jsx("td",{children:String(x.proveedor_id||"")}),i.jsx("td",{children:x.numero_documento||""}),i.jsx("td",{children:x.usuario||""}),i.jsx("td",{children:x.fecha||""}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>m(x.id),children:"Detalle"})})]},String(x.id)))})]})}),h&&i.jsx(r_,{onClose:()=>{g(!1),v()}}),p&&i.jsx(s_,{id:p,onClose:()=>{m(null),v()}})]})}function r_({onClose:o}){const[a,s]=j.useState([]),[l,u]=j.useState([]),[d,h]=j.useState(null),[g,p]=j.useState([]),[m,v]=j.useState(null),[x,_]=j.useState(null),[b,E]=j.useState(""),[R,N]=j.useState([]),[A,I]=j.useState(null),[M,G]=j.useState(1),[T,L]=j.useState(!1),[D,H]=j.useState(null);j.useEffect(()=>{(async()=>{try{const q=await ae.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(q.data)?q.data:[])}catch{}try{const q=await ae.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(q.data)?q.data:[])}catch{}})()},[]);async function ve(){if(b){H(null);try{const{data:q,error:te}=await ae.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(te)throw te;if(!q){H("No se encontr compra con ese nmero de documento");return}h(q.id),v(q.proveedor_id);try{const{data:J}=await ae.from("proveedores").select("id, nombre").eq("id",q.proveedor_id).limit(1).single();J&&J.nombre&&_(J.nombre)}catch{}const{data:X}=await ae.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",q.id),C=Array.isArray(X)?X:[],{data:U}=await ae.from("devoluciones_proveedores").select("id").eq("numero_documento",b),W=Array.isArray(U)?U.map(J=>J.id):[];let ue={};if(W.length>0){const{data:J}=await ae.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",W);Array.isArray(J)&&J.forEach(he=>{const de=String(he.producto_id);ue[de]=(ue[de]||0)+Number(he.cantidad)})}const _e=C.map(J=>J.producto_id),{data:w}=await ae.from("inventario").select("id, nombre, sku").in("id",_e),O={};Array.isArray(w)&&w.forEach(J=>{O[String(J.id)]=J});const V=C.map(J=>{const he=String(J.producto_id),de=Number(J.cantidad),k=ue[he]||0,ne=Math.max(0,de-k);return{producto_id:he,nombre:O[he]?.nombre||he,sku:O[he]?.sku,purchased:de,returned:k,available:ne,costo_unitario:Number(J.costo_unitario||0)}});p(V),u(V.map(J=>({id:J.producto_id,nombre:J.nombre,sku:J.sku})))}catch(q){H(q?.message||String(q))}}}function Y(){if(!A){H("Selecciona un producto");return}if(!M||M<=0){H("Cantidad invlida");return}const q=l.find(X=>X.id===A),te=g.find(X=>X.producto_id===A);if(te&&M>te.available){H(`Cantidad excede disponible para devolucin (${te.available})`);return}N(X=>[...X,{producto_id:A,nombre:q?.nombre,cantidad:M}]),I(null),G(1),H(null),te&&(p(X=>X.map(C=>C.producto_id===te.producto_id?{...C,available:Math.max(0,C.available-M)}:C)),u(X=>X.map(C=>(C.id===te.producto_id,C))))}function oe(q){N(te=>te.filter((X,C)=>C!==q))}async function je(){if(H(null),!m){H("Selecciona un proveedor");return}if(R.length===0){H("Agrega al menos un producto");return}L(!0);try{const q={proveedor_id:m,numero_documento:b||null,usuario:null},te=await ae.from("devoluciones_proveedores").insert(q).select("id").single();if(te.error)throw te.error;const X=te.data.id;try{const C=R.map(W=>({devolucion_id:X,producto_id:W.producto_id,cantidad:W.cantidad})),U=await ae.from("devoluciones_proveedores_detalle").insert(C);U.error&&console.warn("No se pudo insertar detalles de devolucin",U.error)}catch(C){console.warn("Detalles tabla puede no existir",C)}try{const C=b?`Devolucin - ${b}`:`Devolucin ${X}`;let U="sistema";try{const w=localStorage.getItem("user");if(w){const O=JSON.parse(w);U=O.username?`${O.username}${O.role?` (${O.role})`:""}`:String(O)}}catch{}const W=new Date().toISOString(),ue=R.map(w=>({producto_id:w.producto_id,cantidad:w.cantidad,tipo_de_movimiento:"SALIDA",referencia:C,usuario:U,fecha_salida:W})),_e=await ae.from("registro_de_inventario").insert(ue);_e.error&&(console.warn("Error registrando en registro_de_inventario",_e.error),H("Devolucin guardada, pero fall el registro en inventario: "+_e.error.message))}catch(C){console.warn("Registro inventario fallo",C)}o()}catch(q){H(q?.message||String(q))}finally{L(!1)}}return i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?i.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:x||String(m||"")}):i.jsxs("select",{className:"input",value:m??"",onChange:q=>v(q.target.value||null),children:[i.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(q=>i.jsx("option",{value:q.id,children:q.nombre},String(q.id)))]}),i.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{className:"input",value:b,onChange:q=>E(q.target.value)}),i.jsx("button",{className:"btn-opaque",onClick:()=>ve(),children:"Buscar compra"})]}),d&&i.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&i.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[i.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[i.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),i.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Comprado"}),i.jsx("th",{children:"Devuelto"}),i.jsx("th",{children:"Disponible"}),i.jsx("th",{})]})}),i.jsx("tbody",{children:g.map(q=>i.jsxs("tr",{children:[i.jsx("td",{children:q.nombre}),i.jsx("td",{style:{textAlign:"right"},children:Number(q.purchased).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(q.returned).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:Number(q.available).toFixed(2)}),i.jsx("td",{style:{textAlign:"right"},children:i.jsx("button",{className:"btn-opaque",onClick:()=>{I(q.producto_id),G(q.available||1)},children:"Usar"})})]},q.producto_id))})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("select",{className:"input",value:A??"",onChange:q=>I(q.target.value||null),disabled:!!d,children:[i.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(q=>i.jsx("option",{value:q.id,children:q.nombre},q.id))]}),i.jsx("input",{className:"input",type:"number",style:{width:90},value:M,onChange:q=>{const te=Number(q.target.value),X=g.find(C=>C.producto_id===A);if(X){const C=Number(X.available||0);return isNaN(te)||te<1?G(1):te>C?G(C):G(te)}G(te)},min:1,max:A?g.find(q=>q.producto_id===A)?.available??void 0:void 0,disabled:(()=>{const q=g.find(te=>te.producto_id===A);return!!q&&Number(q.available||0)<=1})()}),i.jsx("button",{className:"btn-primary",onClick:Y,children:"Agregar"})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("table",{className:"admin-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"}),i.jsx("th",{children:"Acciones"})]})}),i.jsx("tbody",{children:R.map((q,te)=>i.jsxs("tr",{children:[i.jsx("td",{children:q.nombre}),i.jsx("td",{style:{textAlign:"right"},children:q.cantidad}),i.jsx("td",{children:i.jsx("button",{className:"btn-opaque",onClick:()=>oe(te),children:"Quitar"})})]},`${q.producto_id}-${te}`))})]})})]})]}),D&&i.jsx("div",{style:{color:"red",marginTop:12},children:D}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[i.jsx("button",{className:"btn-opaque",onClick:o,disabled:T,children:"Cancelar"}),i.jsx("button",{className:"btn-primary",onClick:je,disabled:T,children:T?"Guardando...":"Registrar devolucin"})]})]})})}function s_({id:o,onClose:a}){const[s,l]=j.useState([]),[u,d]=j.useState(!1),[h,g]=j.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await ae.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const x=Array.isArray(m)?m:[];if(x.length>0){const _=x.map(R=>R.producto_id),{data:b}=await ae.from("inventario").select("id, nombre, sku").in("id",_),E={};Array.isArray(b)&&b.forEach(R=>{E[String(R.id)]=R}),l(x.map(R=>({producto:E[String(R.producto_id)]?.nombre||String(R.producto_id),cantidad:R.cantidad})))}else{const{data:_}=await ae.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(_)?_:[],E=b.map(A=>A.producto_id),{data:R}=await ae.from("inventario").select("id, nombre, sku").in("id",E),N={};Array.isArray(R)&&R.forEach(A=>{N[String(A.id)]=A}),l(b.map(A=>({producto:N[String(A.producto_id)]?.nombre||String(A.producto_id),cantidad:A.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return j.useEffect(()=>{p()},[o]),i.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[i.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&i.jsx("div",{children:"Cargando..."}),h&&i.jsx("div",{style:{color:"red"},children:h}),i.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:"Producto"}),i.jsx("th",{children:"Cantidad"})]})}),i.jsx("tbody",{children:s.map((m,v)=>i.jsxs("tr",{children:[i.jsx("td",{children:m.producto}),i.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const l_={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function o_(){const[o,a]=j.useState([]),[s,l]=j.useState(!1),[u,d]=j.useState(null),[h,g]=j.useState(null),[p,m]=j.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:E}=await ae.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(E)throw E;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};j.useEffect(()=>{v()},[]);const x=(b,E)=>{a(R=>R.map(N=>N.id===b?{...N,impuesto_venta:E}:N))},_=async b=>{const E=o.find(R=>R.id===b);if(E){d(b),m(null);try{const R={impuesto_venta:E.impuesto_venta??null},{error:N}=await ae.from("impuesto").update(R).eq("id",b);if(N)throw N;await v()}catch(R){console.warn("Error guardando impuesto:",R),m(String(R.message||R))}finally{d(null)}}};return i.jsxs("div",{children:[i.jsx("h2",{children:"Impuestos"}),i.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?i.jsx("div",{children:"Cargando..."}):i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>i.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:l_[b.id]??`Impuesto #${b.id}`}),i.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),i.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:E=>x(b.id,E.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:h!==b.id}),i.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:h===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[i.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),i.jsx("div",{style:{display:"flex",gap:8},children:h===b.id?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),i.jsx("button",{onClick:()=>_(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):i.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&i.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&i.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const c_={dashboard:vx,datos:_x,usuarios_internal:Sx,usuarios_web:jx,cai:Cx,facturas:Tx,historial_facturas:Ax,inventario_productos:Ux,precios_productos:Lx,precios_historico:Mx,stock:qx,inventario_salidas:Ix,inventario_categorias:Hx,proveedores:e_,caja_sesiones:$x,caja_movimientos:Px,rep_ventas:Vx,rep_devoluciones:Gx,rep_ingresos_egresos:Kx,rep_compras:Fx,compras_main:a_,devoluciones_proveedores:i_,rep_export:Yx,cuentas_contables:Jx,libro_diario:Qx,auditoria:Xx,impuestos:o_};function u_({onLogout:o}){const[a,s]=j.useState("dashboard"),[l,u]=j.useState(null),[d,h]=j.useState({}),g=l||a,p=c_[g],v=(_=>{for(const b of cp){if(b.id===_)return b.label;if(b.children){const E=b.children.find(R=>R.id===_);if(E)return E.label}}return"Panel de Administracin"})(g),x=_=>{if(_.id==="salir")return o();_.children&&_.children.length>0?(h(b=>({...b,[_.id]:!b[_.id]})),(_.id!==a||!l)&&(s(_.id),u(_.children[0].id))):(s(_.id),u(null))};return i.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[i.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[i.jsx("strong",{children:"Panel Admin"}),i.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),i.jsx("nav",{children:cp.map(_=>i.jsxs("div",{style:{marginBottom:6},children:[i.jsxs("div",{onClick:()=>x(_),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===_.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[i.jsx("span",{children:_.label}),Array.isArray(_.children)&&_.children.length>0?i.jsx("span",{style:{marginLeft:8},children:d[_.id]?"":""}):null]}),Array.isArray(_.children)&&_.children.length>0&&d[_.id]&&i.jsx("div",{style:{marginLeft:12,marginTop:6},children:_.children.map(b=>i.jsx("div",{onClick:()=>{s(_.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},_.id))})]}),i.jsx("main",{style:{flex:1,padding:24},children:p?i.jsx(p,{}):i.jsx(yx,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function d_(){const[o,a]=j.useState(null);j.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]),j.useEffect(()=>{let u=!0;return(async()=>{try{const d=await Fl();if(!u||!d)return;const h=d.nombre||d.comercio||d.name||"";h&&(document.title=String(h));const g=d.logoUrl||d.logo||null;if(g)try{let p=document.querySelector("link[rel~='icon']");p||(p=document.createElement("link"),p.rel="icon",document.getElementsByTagName("head")[0].appendChild(p)),p.href=String(g)}catch{}}catch{}})(),()=>{u=!1}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return i.jsxs("div",{children:[!o&&i.jsx(G0,{onLogin:s}),o&&o.role==="cajero"&&i.jsx(fx,{onLogout:l}),o&&o.role==="admin"&&i.jsx(u_,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&i.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[i.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),i.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',i.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),i.jsx("div",{style:{marginTop:18},children:i.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class f_ extends ku.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?i.jsxs("div",{style:{padding:18},children:[i.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),i.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[i.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}jv.createRoot(document.getElementById("root")).render(i.jsx(f_,{children:i.jsx(d_,{})}));
