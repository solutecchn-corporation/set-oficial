function uv(o,a){for(var s=0;s<a.length;s++){const l=a[s];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in o)){const d=Object.getOwnPropertyDescriptor(l,u);d&&Object.defineProperty(o,u,d.get?d:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function s(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(u){if(u.ep)return;u.ep=!0;const d=s(u);fetch(u.href,d)}})();function lp(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function dv(o){if(Object.prototype.hasOwnProperty.call(o,"__esModule"))return o;var a=o.default;if(typeof a=="function"){var s=function l(){var u=!1;try{u=this instanceof l}catch{}return u?Reflect.construct(a,arguments,this.constructor):a.apply(this,arguments)};s.prototype=a.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(o).forEach(function(l){var u=Object.getOwnPropertyDescriptor(o,l);Object.defineProperty(s,l,u.get?u:{enumerable:!0,get:function(){return o[l]}})}),s}var Fc={exports:{}},Jr={};var _g;function hv(){if(_g)return Jr;_g=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");function s(l,u,d){var f=null;if(d!==void 0&&(f=""+d),u.key!==void 0&&(f=""+u.key),"key"in u){d={};for(var g in u)g!=="key"&&(d[g]=u[g])}else d=u;return u=d.ref,{$$typeof:o,type:l,key:f,ref:u!==void 0?u:null,props:d}}return Jr.Fragment=a,Jr.jsx=s,Jr.jsxs=s,Jr}var xg;function fv(){return xg||(xg=1,Fc.exports=hv()),Fc.exports}var r=fv(),Zc={exports:{}},Qr={},Wc={exports:{}},eu={};var jg;function gv(){return jg||(jg=1,(function(o){function a(D,L){var ee=D.length;D.push(L);e:for(;0<ee;){var oe=ee-1>>>1,pe=D[oe];if(0<u(pe,L))D[oe]=L,D[ee]=pe,ee=oe;else break e}}function s(D){return D.length===0?null:D[0]}function l(D){if(D.length===0)return null;var L=D[0],ee=D.pop();if(ee!==L){D[0]=ee;e:for(var oe=0,pe=D.length,A=pe>>>1;oe<A;){var z=2*(oe+1)-1,K=D[z],Q=z+1,se=D[Q];if(0>u(K,ee))Q<pe&&0>u(se,K)?(D[oe]=se,D[Q]=ee,oe=Q):(D[oe]=K,D[z]=ee,oe=z);else if(Q<pe&&0>u(se,ee))D[oe]=se,D[Q]=ee,oe=Q;else break e}}return L}function u(D,L){var ee=D.sortIndex-L.sortIndex;return ee!==0?ee:D.id-L.id}if(o.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;o.unstable_now=function(){return d.now()}}else{var f=Date,g=f.now();o.unstable_now=function(){return f.now()-g}}var p=[],m=[],v=1,x=null,j=3,b=!1,w=!1,T=!1,O=!1,C=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function G(D){for(var L=s(m);L!==null;){if(L.callback===null)l(m);else if(L.startTime<=D)l(m),L.sortIndex=L.expirationTime,a(p,L);else break;L=s(m)}}function E(D){if(T=!1,G(D),!w)if(s(p)!==null)w=!0,q||(q=!0,F());else{var L=s(m);L!==null&&_e(E,L.startTime-D)}}var q=!1,U=-1,H=5,he=-1;function J(){return O?!0:!(o.unstable_now()-he<H)}function Z(){if(O=!1,q){var D=o.unstable_now();he=D;var L=!0;try{e:{w=!1,T&&(T=!1,M(U),U=-1),b=!0;var ee=j;try{t:{for(G(D),x=s(p);x!==null&&!(x.expirationTime>D&&J());){var oe=x.callback;if(typeof oe=="function"){x.callback=null,j=x.priorityLevel;var pe=oe(x.expirationTime<=D);if(D=o.unstable_now(),typeof pe=="function"){x.callback=pe,G(D),L=!0;break t}x===s(p)&&l(p),G(D)}else l(p);x=s(p)}if(x!==null)L=!0;else{var A=s(m);A!==null&&_e(E,A.startTime-D),L=!1}}break e}finally{x=null,j=ee,b=!1}L=void 0}}finally{L?F():q=!1}}}var F;if(typeof B=="function")F=function(){B(Z)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,W=k.port2;k.port1.onmessage=Z,F=function(){W.postMessage(null)}}else F=function(){C(Z,0)};function _e(D,L){U=C(function(){D(o.unstable_now())},L)}o.unstable_IdlePriority=5,o.unstable_ImmediatePriority=1,o.unstable_LowPriority=4,o.unstable_NormalPriority=3,o.unstable_Profiling=null,o.unstable_UserBlockingPriority=2,o.unstable_cancelCallback=function(D){D.callback=null},o.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<D?Math.floor(1e3/D):5},o.unstable_getCurrentPriorityLevel=function(){return j},o.unstable_next=function(D){switch(j){case 1:case 2:case 3:var L=3;break;default:L=j}var ee=j;j=L;try{return D()}finally{j=ee}},o.unstable_requestPaint=function(){O=!0},o.unstable_runWithPriority=function(D,L){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var ee=j;j=D;try{return L()}finally{j=ee}},o.unstable_scheduleCallback=function(D,L,ee){var oe=o.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?oe+ee:oe):ee=oe,D){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ee+pe,D={id:v++,callback:L,priorityLevel:D,startTime:ee,expirationTime:pe,sortIndex:-1},ee>oe?(D.sortIndex=ee,a(m,D),s(p)===null&&D===s(m)&&(T?(M(U),U=-1):T=!0,_e(E,ee-oe))):(D.sortIndex=pe,a(p,D),w||b||(w=!0,q||(q=!0,F()))),D},o.unstable_shouldYield=J,o.unstable_wrapCallback=function(D){var L=j;return function(){var ee=j;j=L;try{return D.apply(this,arguments)}finally{j=ee}}}})(eu)),eu}var Sg;function pv(){return Sg||(Sg=1,Wc.exports=gv()),Wc.exports}var tu={exports:{}},ke={};var wg;function mv(){if(wg)return ke;wg=1;var o=Symbol.for("react.transitional.element"),a=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),j=Symbol.iterator;function b(A){return A===null||typeof A!="object"?null:(A=j&&A[j]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,O={};function C(A,z,K){this.props=A,this.context=z,this.refs=O,this.updater=K||w}C.prototype.isReactComponent={},C.prototype.setState=function(A,z){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,z,"setState")},C.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function M(){}M.prototype=C.prototype;function B(A,z,K){this.props=A,this.context=z,this.refs=O,this.updater=K||w}var G=B.prototype=new M;G.constructor=B,T(G,C.prototype),G.isPureReactComponent=!0;var E=Array.isArray;function q(){}var U={H:null,A:null,T:null,S:null},H=Object.prototype.hasOwnProperty;function he(A,z,K){var Q=K.ref;return{$$typeof:o,type:A,key:z,ref:Q!==void 0?Q:null,props:K}}function J(A,z){return he(A.type,z,A.props)}function Z(A){return typeof A=="object"&&A!==null&&A.$$typeof===o}function F(A){var z={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(K){return z[K]})}var k=/\/+/g;function W(A,z){return typeof A=="object"&&A!==null&&A.key!=null?F(""+A.key):z.toString(36)}function _e(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(q,q):(A.status="pending",A.then(function(z){A.status==="pending"&&(A.status="fulfilled",A.value=z)},function(z){A.status==="pending"&&(A.status="rejected",A.reason=z)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function D(A,z,K,Q,se){var ie=typeof A;(ie==="undefined"||ie==="boolean")&&(A=null);var fe=!1;if(A===null)fe=!0;else switch(ie){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(A.$$typeof){case o:case a:fe=!0;break;case v:return fe=A._init,D(fe(A._payload),z,K,Q,se)}}if(fe)return se=se(A),fe=Q===""?"."+W(A,0):Q,E(se)?(K="",fe!=null&&(K=fe.replace(k,"$&/")+"/"),D(se,z,K,"",function(Ue){return Ue})):se!=null&&(Z(se)&&(se=J(se,K+(se.key==null||A&&A.key===se.key?"":(""+se.key).replace(k,"$&/")+"/")+fe)),z.push(se)),1;fe=0;var de=Q===""?".":Q+":";if(E(A))for(var ye=0;ye<A.length;ye++)Q=A[ye],ie=de+W(Q,ye),fe+=D(Q,z,K,ie,se);else if(ye=b(A),typeof ye=="function")for(A=ye.call(A),ye=0;!(Q=A.next()).done;)Q=Q.value,ie=de+W(Q,ye++),fe+=D(Q,z,K,ie,se);else if(ie==="object"){if(typeof A.then=="function")return D(_e(A),z,K,Q,se);throw z=String(A),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return fe}function L(A,z,K){if(A==null)return A;var Q=[],se=0;return D(A,Q,"","",function(ie){return z.call(K,ie,se++)}),Q}function ee(A){if(A._status===-1){var z=A._result;z=z(),z.then(function(K){(A._status===0||A._status===-1)&&(A._status=1,A._result=K)},function(K){(A._status===0||A._status===-1)&&(A._status=2,A._result=K)}),A._status===-1&&(A._status=0,A._result=z)}if(A._status===1)return A._result.default;throw A._result}var oe=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},pe={map:L,forEach:function(A,z,K){L(A,function(){z.apply(this,arguments)},K)},count:function(A){var z=0;return L(A,function(){z++}),z},toArray:function(A){return L(A,function(z){return z})||[]},only:function(A){if(!Z(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return ke.Activity=x,ke.Children=pe,ke.Component=C,ke.Fragment=s,ke.Profiler=u,ke.PureComponent=B,ke.StrictMode=l,ke.Suspense=p,ke.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,ke.__COMPILER_RUNTIME={__proto__:null,c:function(A){return U.H.useMemoCache(A)}},ke.cache=function(A){return function(){return A.apply(null,arguments)}},ke.cacheSignal=function(){return null},ke.cloneElement=function(A,z,K){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var Q=T({},A.props),se=A.key;if(z!=null)for(ie in z.key!==void 0&&(se=""+z.key),z)!H.call(z,ie)||ie==="key"||ie==="__self"||ie==="__source"||ie==="ref"&&z.ref===void 0||(Q[ie]=z[ie]);var ie=arguments.length-2;if(ie===1)Q.children=K;else if(1<ie){for(var fe=Array(ie),de=0;de<ie;de++)fe[de]=arguments[de+2];Q.children=fe}return he(A.type,se,Q)},ke.createContext=function(A){return A={$$typeof:f,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:d,_context:A},A},ke.createElement=function(A,z,K){var Q,se={},ie=null;if(z!=null)for(Q in z.key!==void 0&&(ie=""+z.key),z)H.call(z,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(se[Q]=z[Q]);var fe=arguments.length-2;if(fe===1)se.children=K;else if(1<fe){for(var de=Array(fe),ye=0;ye<fe;ye++)de[ye]=arguments[ye+2];se.children=de}if(A&&A.defaultProps)for(Q in fe=A.defaultProps,fe)se[Q]===void 0&&(se[Q]=fe[Q]);return he(A,ie,se)},ke.createRef=function(){return{current:null}},ke.forwardRef=function(A){return{$$typeof:g,render:A}},ke.isValidElement=Z,ke.lazy=function(A){return{$$typeof:v,_payload:{_status:-1,_result:A},_init:ee}},ke.memo=function(A,z){return{$$typeof:m,type:A,compare:z===void 0?null:z}},ke.startTransition=function(A){var z=U.T,K={};U.T=K;try{var Q=A(),se=U.S;se!==null&&se(K,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(q,oe)}catch(ie){oe(ie)}finally{z!==null&&K.types!==null&&(z.types=K.types),U.T=z}},ke.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},ke.use=function(A){return U.H.use(A)},ke.useActionState=function(A,z,K){return U.H.useActionState(A,z,K)},ke.useCallback=function(A,z){return U.H.useCallback(A,z)},ke.useContext=function(A){return U.H.useContext(A)},ke.useDebugValue=function(){},ke.useDeferredValue=function(A,z){return U.H.useDeferredValue(A,z)},ke.useEffect=function(A,z){return U.H.useEffect(A,z)},ke.useEffectEvent=function(A){return U.H.useEffectEvent(A)},ke.useId=function(){return U.H.useId()},ke.useImperativeHandle=function(A,z,K){return U.H.useImperativeHandle(A,z,K)},ke.useInsertionEffect=function(A,z){return U.H.useInsertionEffect(A,z)},ke.useLayoutEffect=function(A,z){return U.H.useLayoutEffect(A,z)},ke.useMemo=function(A,z){return U.H.useMemo(A,z)},ke.useOptimistic=function(A,z){return U.H.useOptimistic(A,z)},ke.useReducer=function(A,z,K){return U.H.useReducer(A,z,K)},ke.useRef=function(A){return U.H.useRef(A)},ke.useState=function(A){return U.H.useState(A)},ke.useSyncExternalStore=function(A,z,K){return U.H.useSyncExternalStore(A,z,K)},ke.useTransition=function(){return U.H.useTransition()},ke.version="19.2.0",ke}var Eg;function Eu(){return Eg||(Eg=1,tu.exports=mv()),tu.exports}var nu={exports:{}},Mt={};var Cg;function yv(){if(Cg)return Mt;Cg=1;var o=Eu();function a(p){var m="https://react.dev/errors/"+p;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)m+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var l={d:{f:s,r:function(){throw Error(a(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},u=Symbol.for("react.portal");function d(p,m,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:x==null?null:""+x,children:p,containerInfo:m,implementation:v}}var f=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(p,m){if(p==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Mt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Mt.createPortal=function(p,m){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(a(299));return d(p,m,null,v)},Mt.flushSync=function(p){var m=f.T,v=l.p;try{if(f.T=null,l.p=2,p)return p()}finally{f.T=m,l.p=v,l.d.f()}},Mt.preconnect=function(p,m){typeof p=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,l.d.C(p,m))},Mt.prefetchDNS=function(p){typeof p=="string"&&l.d.D(p)},Mt.preinit=function(p,m){if(typeof p=="string"&&m&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin),j=typeof m.integrity=="string"?m.integrity:void 0,b=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;v==="style"?l.d.S(p,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:x,integrity:j,fetchPriority:b}):v==="script"&&l.d.X(p,{crossOrigin:x,integrity:j,fetchPriority:b,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Mt.preinitModule=function(p,m){if(typeof p=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var v=g(m.as,m.crossOrigin);l.d.M(p,{crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&l.d.M(p)},Mt.preload=function(p,m){if(typeof p=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var v=m.as,x=g(v,m.crossOrigin);l.d.L(p,v,{crossOrigin:x,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Mt.preloadModule=function(p,m){if(typeof p=="string")if(m){var v=g(m.as,m.crossOrigin);l.d.m(p,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:v,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else l.d.m(p)},Mt.requestFormReset=function(p){l.d.r(p)},Mt.unstable_batchedUpdates=function(p,m){return p(m)},Mt.useFormState=function(p,m,v){return f.H.useFormState(p,m,v)},Mt.useFormStatus=function(){return f.H.useHostTransitionStatus()},Mt.version="19.2.0",Mt}var Tg;function op(){if(Tg)return nu.exports;Tg=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),nu.exports=yv(),nu.exports}var Ag;function vv(){if(Ag)return Qr;Ag=1;var o=pv(),a=Eu(),s=op();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function u(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function f(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function p(e){if(d(e)!==e)throw Error(l(188))}function m(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var n=e,i=t;;){var c=n.return;if(c===null)break;var h=c.alternate;if(h===null){if(i=c.return,i!==null){n=i;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===n)return p(c),e;if(h===i)return p(c),t;h=h.sibling}throw Error(l(188))}if(n.return!==i.return)n=c,i=h;else{for(var y=!1,_=c.child;_;){if(_===n){y=!0,n=c,i=h;break}if(_===i){y=!0,i=c,n=h;break}_=_.sibling}if(!y){for(_=h.child;_;){if(_===n){y=!0,n=h,i=c;break}if(_===i){y=!0,i=h,n=c;break}_=_.sibling}if(!y)throw Error(l(189))}}if(n.alternate!==i)throw Error(l(190))}if(n.tag!==3)throw Error(l(188));return n.stateNode.current===n?e:t}function v(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=v(e),t!==null)return t;e=e.sibling}return null}var x=Object.assign,j=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),B=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),U=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),he=Symbol.for("react.activity"),J=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function F(e){return e===null||typeof e!="object"?null:(e=Z&&e[Z]||e["@@iterator"],typeof e=="function"?e:null)}var k=Symbol.for("react.client.reference");function W(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===k?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case T:return"Fragment";case C:return"Profiler";case O:return"StrictMode";case E:return"Suspense";case q:return"SuspenseList";case he:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case w:return"Portal";case B:return e.displayName||"Context";case M:return(e._context.displayName||"Context")+".Consumer";case G:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case U:return t=e.displayName||null,t!==null?t:W(e.type)||"Memo";case H:t=e._payload,e=e._init;try{return W(e(t))}catch{}}return null}var _e=Array.isArray,D=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},oe=[],pe=-1;function A(e){return{current:e}}function z(e){0>pe||(e.current=oe[pe],oe[pe]=null,pe--)}function K(e,t){pe++,oe[pe]=e.current,e.current=t}var Q=A(null),se=A(null),ie=A(null),fe=A(null);function de(e,t){switch(K(ie,t),K(se,e),K(Q,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?$f(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=$f(t),e=Pf(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(Q),K(Q,e)}function ye(){z(Q),z(se),z(ie)}function Ue(e){e.memoizedState!==null&&K(fe,e);var t=Q.current,n=Pf(t,e.type);t!==n&&(K(se,e),K(Q,n))}function Ve(e){se.current===e&&(z(Q),z(se)),fe.current===e&&(z(fe),Pr._currentValue=ee)}var ze,De;function Qe(e){if(ze===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ze=t&&t[1]||"",De=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ze+e+De}var ht=!1;function Dt(e,t){if(!e||ht)return"";ht=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(X){var Y=X}Reflect.construct(e,[],le)}else{try{le.call()}catch(X){Y=X}e.call(le.prototype)}}else{try{throw Error()}catch(X){Y=X}(le=e())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(X){if(X&&Y&&typeof X.stack=="string")return[X.stack,Y.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var c=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");c&&c.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var h=i.DetermineComponentFrameRoot(),y=h[0],_=h[1];if(y&&_){var N=y.split(`
`),P=_.split(`
`);for(c=i=0;i<N.length&&!N[i].includes("DetermineComponentFrameRoot");)i++;for(;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;if(i===N.length||c===P.length)for(i=N.length-1,c=P.length-1;1<=i&&0<=c&&N[i]!==P[c];)c--;for(;1<=i&&0<=c;i--,c--)if(N[i]!==P[c]){if(i!==1||c!==1)do if(i--,c--,0>c||N[i]!==P[c]){var te=`
`+N[i].replace(" at new "," at ");return e.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",e.displayName)),te}while(1<=i&&0<=c);break}}}finally{ht=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Qe(n):""}function Et(e,t){switch(e.tag){case 26:case 27:case 5:return Qe(e.type);case 16:return Qe("Lazy");case 13:return e.child!==t&&t!==null?Qe("Suspense Fallback"):Qe("Suspense");case 19:return Qe("SuspenseList");case 0:case 15:return Dt(e.type,!1);case 11:return Dt(e.type.render,!1);case 1:return Dt(e.type,!0);case 31:return Qe("Activity");default:return""}}function $t(e){try{var t="",n=null;do t+=Et(e,n),n=e,e=e.return;while(e);return t}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}var Ln=Object.prototype.hasOwnProperty,lt=o.unstable_scheduleCallback,ut=o.unstable_cancelCallback,An=o.unstable_shouldYield,Ml=o.unstable_requestPaint,Ot=o.unstable_now,ql=o.unstable_getCurrentPriorityLevel,oi=o.unstable_ImmediatePriority,as=o.unstable_UserBlockingPriority,ka=o.unstable_NormalPriority,Ll=o.unstable_LowPriority,is=o.unstable_IdlePriority,Il=o.log,ci=o.unstable_setDisableYieldValue,Ua=null,Lt=null;function On(e){if(typeof Il=="function"&&ci(e),Lt&&typeof Lt.setStrictMode=="function")try{Lt.setStrictMode(Ua,e)}catch{}}var It=Math.clz32?Math.clz32:ss,Hl=Math.log,rs=Math.LN2;function ss(e){return e>>>=0,e===0?32:31-(Hl(e)/rs|0)|0}var ui=256,ln=262144,on=4194304;function Nn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function di(e,t,n){var i=e.pendingLanes;if(i===0)return 0;var c=0,h=e.suspendedLanes,y=e.pingedLanes;e=e.warmLanes;var _=i&134217727;return _!==0?(i=_&~h,i!==0?c=Nn(i):(y&=_,y!==0?c=Nn(y):n||(n=_&~e,n!==0&&(c=Nn(n))))):(_=i&~h,_!==0?c=Nn(_):y!==0?c=Nn(y):n||(n=i&~e,n!==0&&(c=Nn(n)))),c===0?0:t!==0&&t!==c&&(t&h)===0&&(h=c&-c,n=t&-t,h>=n||h===32&&(n&4194048)!==0)?t:c}function za(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function ir(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ls(){var e=on;return on<<=1,(on&62914560)===0&&(on=4194304),e}function Da(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Rn(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Vl(e,t,n,i,c,h){var y=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var _=e.entanglements,N=e.expirationTimes,P=e.hiddenUpdates;for(n=y&~n;0<n;){var te=31-It(n),le=1<<te;_[te]=0,N[te]=-1;var Y=P[te];if(Y!==null)for(P[te]=null,te=0;te<Y.length;te++){var X=Y[te];X!==null&&(X.lane&=-536870913)}n&=~le}i!==0&&os(e,i,0),h!==0&&c===0&&e.tag!==0&&(e.suspendedLanes|=h&~(y&~t))}function os(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-It(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|n&261930}function cs(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-It(n),c=1<<i;c&t|e[i]&t&&(e[i]|=t),n&=~c}}function us(e,t){var n=t&-t;return n=(n&42)!==0?1:rr(n),(n&(e.suspendedLanes|t))!==0?0:n}function rr(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ba(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function sr(){var e=L.p;return e!==0?e:(e=window.event,e===void 0?32:fg(e.type))}function ds(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}var xn=Math.random().toString(36).slice(2),bt="__reactFiber$"+xn,Bt="__reactProps$"+xn,ia="__reactContainer$"+xn,V="__reactEvents$"+xn,re="__reactListeners$"+xn,xe="__reactHandles$"+xn,ue="__reactResources$"+xn,ge="__reactMarker$"+xn;function be(e){delete e[bt],delete e[Bt],delete e[V],delete e[re],delete e[xe]}function ve(e){var t=e[bt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ia]||n[bt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Ff(e);e!==null;){if(n=e[bt])return n;e=Ff(e)}return t}e=n,n=e.parentNode}return null}function Oe(e){if(e=e[bt]||e[ia]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function ce(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function me(e){var t=e[ue];return t||(t=e[ue]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Se(e){e[ge]=!0}var Be=new Set,Le={};function Ze(e,t){Xe(e,t),Xe(e+"Capture",t)}function Xe(e,t){for(Le[e]=t,e=0;e<t.length;e++)Be.add(t[e])}var gt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kn={},Ma={};function hi(e){return Ln.call(Ma,e)?!0:Ln.call(kn,e)?!1:gt.test(e)?Ma[e]=!0:(kn[e]=!0,!1)}function Un(e,t,n){if(hi(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function zn(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Ne(e,t,n,i){if(i===null)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+i)}}function Ke(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ht(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function it(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,h=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(y){n=""+y,h.call(this,y)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(y){n=""+y},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Pt(e){if(!e._valueTracker){var t=Ht(e)?"checked":"value";e._valueTracker=it(e,t,""+e[t])}}function ra(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Ht(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function fi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var $l=/[\n"\\]/g;function cn(e){return e.replace($l,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Pl(e,t,n,i,c,h,y,_){e.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?e.type=y:e.removeAttribute("type"),t!=null?y==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Ke(t)):e.value!==""+Ke(t)&&(e.value=""+Ke(t)):y!=="submit"&&y!=="reset"||e.removeAttribute("value"),t!=null?Gl(e,y,Ke(t)):n!=null?Gl(e,y,Ke(n)):i!=null&&e.removeAttribute("value"),c==null&&h!=null&&(e.defaultChecked=!!h),c!=null&&(e.checked=c&&typeof c!="function"&&typeof c!="symbol"),_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?e.name=""+Ke(_):e.removeAttribute("name")}function Bu(e,t,n,i,c,h,y,_){if(h!=null&&typeof h!="function"&&typeof h!="symbol"&&typeof h!="boolean"&&(e.type=h),t!=null||n!=null){if(!(h!=="submit"&&h!=="reset"||t!=null)){Pt(e);return}n=n!=null?""+Ke(n):"",t=t!=null?""+Ke(t):n,_||t===e.value||(e.value=t),e.defaultValue=t}i=i??c,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=_?e.checked:!!i,e.defaultChecked=!!i,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(e.name=y),Pt(e)}function Gl(e,t,n){t==="number"&&fi(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function gi(e,t,n,i){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&i&&(e[n].defaultSelected=!0)}else{for(n=""+Ke(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,i&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Mu(e,t,n){if(t!=null&&(t=""+Ke(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Ke(n):""}function qu(e,t,n,i){if(t==null){if(i!=null){if(n!=null)throw Error(l(92));if(_e(i)){if(1<i.length)throw Error(l(93));i=i[0]}n=i}n==null&&(n=""),t=n}n=Ke(t),e.defaultValue=n,i=e.textContent,i===n&&i!==""&&i!==null&&(e.value=i),Pt(e)}function pi(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var rm=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lu(e,t,n){var i=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,n):typeof n!="number"||n===0||rm.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Iu(e,t,n){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var c in t)i=t[c],t.hasOwnProperty(c)&&n[c]!==i&&Lu(e,c,i)}else for(var h in t)t.hasOwnProperty(h)&&Lu(e,h,t[h])}function Kl(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function hs(e){return lm.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function In(){}var Yl=null;function Jl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var mi=null,yi=null;function Hu(e){var t=Oe(e);if(t&&(e=t.stateNode)){var n=e[Bt]||null;e:switch(e=t.stateNode,t.type){case"input":if(Pl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+cn(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var c=i[Bt]||null;if(!c)throw Error(l(90));Pl(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name)}}for(t=0;t<n.length;t++)i=n[t],i.form===e.form&&ra(i)}break e;case"textarea":Mu(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&gi(e,!!n.multiple,t,!1)}}}var Ql=!1;function Vu(e,t,n){if(Ql)return e(t,n);Ql=!0;try{var i=e(t);return i}finally{if(Ql=!1,(mi!==null||yi!==null)&&(Ws(),mi&&(t=mi,e=yi,yi=mi=null,Hu(t),e)))for(t=0;t<e.length;t++)Hu(e[t])}}function lr(e,t){var n=e.stateNode;if(n===null)return null;var i=n[Bt]||null;if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(l(231,t,typeof n));return n}var Hn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xl=!1;if(Hn)try{var or={};Object.defineProperty(or,"passive",{get:function(){Xl=!0}}),window.addEventListener("test",or,or),window.removeEventListener("test",or,or)}catch{Xl=!1}var sa=null,Fl=null,fs=null;function $u(){if(fs)return fs;var e,t=Fl,n=t.length,i,c="value"in sa?sa.value:sa.textContent,h=c.length;for(e=0;e<n&&t[e]===c[e];e++);var y=n-e;for(i=1;i<=y&&t[n-i]===c[h-i];i++);return fs=c.slice(e,1<i?1-i:void 0)}function gs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ps(){return!0}function Pu(){return!1}function Gt(e){function t(n,i,c,h,y){this._reactName=n,this._targetInst=c,this.type=i,this.nativeEvent=h,this.target=y,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(n=e[_],this[_]=n?n(h):h[_]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?ps:Pu,this.isPropagationStopped=Pu,this}return x(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ps)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ps)},persist:function(){},isPersistent:ps}),t}var qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ms=Gt(qa),cr=x({},qa,{view:0,detail:0}),om=Gt(cr),Zl,Wl,ur,ys=x({},cr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:to,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ur&&(ur&&e.type==="mousemove"?(Zl=e.screenX-ur.screenX,Wl=e.screenY-ur.screenY):Wl=Zl=0,ur=e),Zl)},movementY:function(e){return"movementY"in e?e.movementY:Wl}}),Gu=Gt(ys),cm=x({},ys,{dataTransfer:0}),um=Gt(cm),dm=x({},cr,{relatedTarget:0}),eo=Gt(dm),hm=x({},qa,{animationName:0,elapsedTime:0,pseudoElement:0}),fm=Gt(hm),gm=x({},qa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pm=Gt(gm),mm=x({},qa,{data:0}),Ku=Gt(mm),ym={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _m(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=bm[e])?!!t[e]:!1}function to(){return _m}var xm=x({},cr,{key:function(e){if(e.key){var t=ym[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=gs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vm[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:to,charCode:function(e){return e.type==="keypress"?gs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?gs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),jm=Gt(xm),Sm=x({},ys,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yu=Gt(Sm),wm=x({},cr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:to}),Em=Gt(wm),Cm=x({},qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tm=Gt(Cm),Am=x({},ys,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Om=Gt(Am),Nm=x({},qa,{newState:0,oldState:0}),Rm=Gt(Nm),km=[9,13,27,32],no=Hn&&"CompositionEvent"in window,dr=null;Hn&&"documentMode"in document&&(dr=document.documentMode);var Um=Hn&&"TextEvent"in window&&!dr,Ju=Hn&&(!no||dr&&8<dr&&11>=dr),Qu=" ",Xu=!1;function Fu(e,t){switch(e){case"keyup":return km.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vi=!1;function zm(e,t){switch(e){case"compositionend":return Zu(t);case"keypress":return t.which!==32?null:(Xu=!0,Qu);case"textInput":return e=t.data,e===Qu&&Xu?null:e;default:return null}}function Dm(e,t){if(vi)return e==="compositionend"||!no&&Fu(e,t)?(e=$u(),fs=Fl=sa=null,vi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ju&&t.locale!=="ko"?null:t.data;default:return null}}var Bm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bm[e.type]:t==="textarea"}function ed(e,t,n,i){mi?yi?yi.push(i):yi=[i]:mi=i,t=sl(t,"onChange"),0<t.length&&(n=new ms("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var hr=null,fr=null;function Mm(e){Mf(e,0)}function vs(e){var t=ce(e);if(ra(t))return e}function td(e,t){if(e==="change")return t}var nd=!1;if(Hn){var ao;if(Hn){var io="oninput"in document;if(!io){var ad=document.createElement("div");ad.setAttribute("oninput","return;"),io=typeof ad.oninput=="function"}ao=io}else ao=!1;nd=ao&&(!document.documentMode||9<document.documentMode)}function id(){hr&&(hr.detachEvent("onpropertychange",rd),fr=hr=null)}function rd(e){if(e.propertyName==="value"&&vs(fr)){var t=[];ed(t,fr,e,Jl(e)),Vu(Mm,t)}}function qm(e,t,n){e==="focusin"?(id(),hr=t,fr=n,hr.attachEvent("onpropertychange",rd)):e==="focusout"&&id()}function Lm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vs(fr)}function Im(e,t){if(e==="click")return vs(t)}function Hm(e,t){if(e==="input"||e==="change")return vs(t)}function Vm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ft=typeof Object.is=="function"?Object.is:Vm;function gr(e,t){if(Ft(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var c=n[i];if(!Ln.call(t,c)||!Ft(e[c],t[c]))return!1}return!0}function sd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ld(e,t){var n=sd(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sd(n)}}function od(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?od(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function cd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=fi(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=fi(e.document)}return t}function ro(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var $m=Hn&&"documentMode"in document&&11>=document.documentMode,bi=null,so=null,pr=null,lo=!1;function ud(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lo||bi==null||bi!==fi(i)||(i=bi,"selectionStart"in i&&ro(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),pr&&gr(pr,i)||(pr=i,i=sl(so,"onSelect"),0<i.length&&(t=new ms("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=bi)))}function La(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _i={animationend:La("Animation","AnimationEnd"),animationiteration:La("Animation","AnimationIteration"),animationstart:La("Animation","AnimationStart"),transitionrun:La("Transition","TransitionRun"),transitionstart:La("Transition","TransitionStart"),transitioncancel:La("Transition","TransitionCancel"),transitionend:La("Transition","TransitionEnd")},oo={},dd={};Hn&&(dd=document.createElement("div").style,"AnimationEvent"in window||(delete _i.animationend.animation,delete _i.animationiteration.animation,delete _i.animationstart.animation),"TransitionEvent"in window||delete _i.transitionend.transition);function Ia(e){if(oo[e])return oo[e];if(!_i[e])return e;var t=_i[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in dd)return oo[e]=t[n];return e}var hd=Ia("animationend"),fd=Ia("animationiteration"),gd=Ia("animationstart"),Pm=Ia("transitionrun"),Gm=Ia("transitionstart"),Km=Ia("transitioncancel"),pd=Ia("transitionend"),md=new Map,co="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");co.push("scrollEnd");function jn(e,t){md.set(e,t),Ze(t,[e])}var bs=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},un=[],xi=0,uo=0;function _s(){for(var e=xi,t=uo=xi=0;t<e;){var n=un[t];un[t++]=null;var i=un[t];un[t++]=null;var c=un[t];un[t++]=null;var h=un[t];if(un[t++]=null,i!==null&&c!==null){var y=i.pending;y===null?c.next=c:(c.next=y.next,y.next=c),i.pending=c}h!==0&&yd(n,c,h)}}function xs(e,t,n,i){un[xi++]=e,un[xi++]=t,un[xi++]=n,un[xi++]=i,uo|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function ho(e,t,n,i){return xs(e,t,n,i),js(e)}function Ha(e,t){return xs(e,null,null,t),js(e)}function yd(e,t,n){e.lanes|=n;var i=e.alternate;i!==null&&(i.lanes|=n);for(var c=!1,h=e.return;h!==null;)h.childLanes|=n,i=h.alternate,i!==null&&(i.childLanes|=n),h.tag===22&&(e=h.stateNode,e===null||e._visibility&1||(c=!0)),e=h,h=h.return;return e.tag===3?(h=e.stateNode,c&&t!==null&&(c=31-It(n),e=h.hiddenUpdates,i=e[c],i===null?e[c]=[t]:i.push(t),t.lane=n|536870912),h):null}function js(e){if(50<Mr)throw Mr=0,xc=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var ji={};function Ym(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(e,t,n,i){return new Ym(e,t,n,i)}function fo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Vn(e,t){var n=e.alternate;return n===null?(n=Zt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function vd(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ss(e,t,n,i,c,h){var y=0;if(i=e,typeof e=="function")fo(e)&&(y=1);else if(typeof e=="string")y=Zy(e,n,Q.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case he:return e=Zt(31,n,t,c),e.elementType=he,e.lanes=h,e;case T:return Va(n.children,c,h,t);case O:y=8,c|=24;break;case C:return e=Zt(12,n,t,c|2),e.elementType=C,e.lanes=h,e;case E:return e=Zt(13,n,t,c),e.elementType=E,e.lanes=h,e;case q:return e=Zt(19,n,t,c),e.elementType=q,e.lanes=h,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case B:y=10;break e;case M:y=9;break e;case G:y=11;break e;case U:y=14;break e;case H:y=16,i=null;break e}y=29,n=Error(l(130,e===null?"null":typeof e,"")),i=null}return t=Zt(y,n,t,c),t.elementType=e,t.type=i,t.lanes=h,t}function Va(e,t,n,i){return e=Zt(7,e,i,t),e.lanes=n,e}function go(e,t,n){return e=Zt(6,e,null,t),e.lanes=n,e}function bd(e){var t=Zt(18,null,null,0);return t.stateNode=e,t}function po(e,t,n){return t=Zt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var _d=new WeakMap;function dn(e,t){if(typeof e=="object"&&e!==null){var n=_d.get(e);return n!==void 0?n:(t={value:e,source:t,stack:$t(t)},_d.set(e,t),t)}return{value:e,source:t,stack:$t(t)}}var Si=[],wi=0,ws=null,mr=0,hn=[],fn=0,la=null,Dn=1,Bn="";function $n(e,t){Si[wi++]=mr,Si[wi++]=ws,ws=e,mr=t}function xd(e,t,n){hn[fn++]=Dn,hn[fn++]=Bn,hn[fn++]=la,la=e;var i=Dn;e=Bn;var c=32-It(i)-1;i&=~(1<<c),n+=1;var h=32-It(t)+c;if(30<h){var y=c-c%5;h=(i&(1<<y)-1).toString(32),i>>=y,c-=y,Dn=1<<32-It(t)+c|n<<c|i,Bn=h+e}else Dn=1<<h|n<<c|i,Bn=e}function mo(e){e.return!==null&&($n(e,1),xd(e,1,0))}function yo(e){for(;e===ws;)ws=Si[--wi],Si[wi]=null,mr=Si[--wi],Si[wi]=null;for(;e===la;)la=hn[--fn],hn[fn]=null,Bn=hn[--fn],hn[fn]=null,Dn=hn[--fn],hn[fn]=null}function jd(e,t){hn[fn++]=Dn,hn[fn++]=Bn,hn[fn++]=la,Dn=t.id,Bn=t.overflow,la=e}var Nt=null,ot=null,Ge=!1,oa=null,gn=!1,vo=Error(l(519));function ca(e){var t=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yr(dn(t,e)),vo}function Sd(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[bt]=e,t[Bt]=i,n){case"dialog":He("cancel",t),He("close",t);break;case"iframe":case"object":case"embed":He("load",t);break;case"video":case"audio":for(n=0;n<Lr.length;n++)He(Lr[n],t);break;case"source":He("error",t);break;case"img":case"image":case"link":He("error",t),He("load",t);break;case"details":He("toggle",t);break;case"input":He("invalid",t),Bu(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":He("invalid",t);break;case"textarea":He("invalid",t),qu(t,i.value,i.defaultValue,i.children)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||i.suppressHydrationWarning===!0||Hf(t.textContent,n)?(i.popover!=null&&(He("beforetoggle",t),He("toggle",t)),i.onScroll!=null&&He("scroll",t),i.onScrollEnd!=null&&He("scrollend",t),i.onClick!=null&&(t.onclick=In),t=!0):t=!1,t||ca(e,!0)}function wd(e){for(Nt=e.return;Nt;)switch(Nt.tag){case 5:case 31:case 13:gn=!1;return;case 27:case 3:gn=!0;return;default:Nt=Nt.return}}function Ei(e){if(e!==Nt)return!1;if(!Ge)return wd(e),Ge=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||Bc(e.type,e.memoizedProps)),n=!n),n&&ot&&ca(e),wd(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ot=Xf(e)}else if(t===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));ot=Xf(e)}else t===27?(t=ot,Sa(e.type)?(e=Hc,Hc=null,ot=e):ot=t):ot=Nt?mn(e.stateNode.nextSibling):null;return!0}function $a(){ot=Nt=null,Ge=!1}function bo(){var e=oa;return e!==null&&(Qt===null?Qt=e:Qt.push.apply(Qt,e),oa=null),e}function yr(e){oa===null?oa=[e]:oa.push(e)}var _o=A(null),Pa=null,Pn=null;function ua(e,t,n){K(_o,t._currentValue),t._currentValue=n}function Gn(e){e._currentValue=_o.current,z(_o)}function xo(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function jo(e,t,n,i){var c=e.child;for(c!==null&&(c.return=e);c!==null;){var h=c.dependencies;if(h!==null){var y=c.child;h=h.firstContext;e:for(;h!==null;){var _=h;h=c;for(var N=0;N<t.length;N++)if(_.context===t[N]){h.lanes|=n,_=h.alternate,_!==null&&(_.lanes|=n),xo(h.return,n,e),i||(y=null);break e}h=_.next}}else if(c.tag===18){if(y=c.return,y===null)throw Error(l(341));y.lanes|=n,h=y.alternate,h!==null&&(h.lanes|=n),xo(y,n,e),y=null}else y=c.child;if(y!==null)y.return=c;else for(y=c;y!==null;){if(y===e){y=null;break}if(c=y.sibling,c!==null){c.return=y.return,y=c;break}y=y.return}c=y}}function Ci(e,t,n,i){e=null;for(var c=t,h=!1;c!==null;){if(!h){if((c.flags&524288)!==0)h=!0;else if((c.flags&262144)!==0)break}if(c.tag===10){var y=c.alternate;if(y===null)throw Error(l(387));if(y=y.memoizedProps,y!==null){var _=c.type;Ft(c.pendingProps.value,y.value)||(e!==null?e.push(_):e=[_])}}else if(c===fe.current){if(y=c.alternate,y===null)throw Error(l(387));y.memoizedState.memoizedState!==c.memoizedState.memoizedState&&(e!==null?e.push(Pr):e=[Pr])}c=c.return}e!==null&&jo(t,e,n,i),t.flags|=262144}function Es(e){for(e=e.firstContext;e!==null;){if(!Ft(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ga(e){Pa=e,Pn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Rt(e){return Ed(Pa,e)}function Cs(e,t){return Pa===null&&Ga(e),Ed(e,t)}function Ed(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Pn===null){if(e===null)throw Error(l(308));Pn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Pn=Pn.next=t;return n}var Jm=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Qm=o.unstable_scheduleCallback,Xm=o.unstable_NormalPriority,_t={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function So(){return{controller:new Jm,data:new Map,refCount:0}}function vr(e){e.refCount--,e.refCount===0&&Qm(Xm,function(){e.controller.abort()})}var br=null,wo=0,Ti=0,Ai=null;function Fm(e,t){if(br===null){var n=br=[];wo=0,Ti=Tc(),Ai={status:"pending",value:void 0,then:function(i){n.push(i)}}}return wo++,t.then(Cd,Cd),t}function Cd(){if(--wo===0&&br!==null){Ai!==null&&(Ai.status="fulfilled");var e=br;br=null,Ti=0,Ai=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Zm(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(c){n.push(c)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var c=0;c<n.length;c++)(0,n[c])(t)},function(c){for(i.status="rejected",i.reason=c,c=0;c<n.length;c++)(0,n[c])(void 0)}),i}var Td=D.S;D.S=function(e,t){df=Ot(),typeof t=="object"&&t!==null&&typeof t.then=="function"&&Fm(e,t),Td!==null&&Td(e,t)};var Ka=A(null);function Eo(){var e=Ka.current;return e!==null?e:rt.pooledCache}function Ts(e,t){t===null?K(Ka,Ka.current):K(Ka,t.pool)}function Ad(){var e=Eo();return e===null?null:{parent:_t._currentValue,pool:e}}var Oi=Error(l(460)),Co=Error(l(474)),As=Error(l(542)),Os={then:function(){}};function Od(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Nd(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(In,In),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,kd(e),e;default:if(typeof t.status=="string")t.then(In,In);else{if(e=rt,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var c=t;c.status="fulfilled",c.value=i}},function(i){if(t.status==="pending"){var c=t;c.status="rejected",c.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,kd(e),e}throw Ja=t,Oi}}function Ya(e){try{var t=e._init;return t(e._payload)}catch(n){throw n!==null&&typeof n=="object"&&typeof n.then=="function"?(Ja=n,Oi):n}}var Ja=null;function Rd(){if(Ja===null)throw Error(l(459));var e=Ja;return Ja=null,e}function kd(e){if(e===Oi||e===As)throw Error(l(483))}var Ni=null,_r=0;function Ns(e){var t=_r;return _r+=1,Ni===null&&(Ni=[]),Nd(Ni,e,t)}function xr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Rs(e,t){throw t.$$typeof===j?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Ud(e){function t(I,R){if(e){var $=I.deletions;$===null?(I.deletions=[R],I.flags|=16):$.push(R)}}function n(I,R){if(!e)return null;for(;R!==null;)t(I,R),R=R.sibling;return null}function i(I){for(var R=new Map;I!==null;)I.key!==null?R.set(I.key,I):R.set(I.index,I),I=I.sibling;return R}function c(I,R){return I=Vn(I,R),I.index=0,I.sibling=null,I}function h(I,R,$){return I.index=$,e?($=I.alternate,$!==null?($=$.index,$<R?(I.flags|=67108866,R):$):(I.flags|=67108866,R)):(I.flags|=1048576,R)}function y(I){return e&&I.alternate===null&&(I.flags|=67108866),I}function _(I,R,$,ae){return R===null||R.tag!==6?(R=go($,I.mode,ae),R.return=I,R):(R=c(R,$),R.return=I,R)}function N(I,R,$,ae){var Te=$.type;return Te===T?te(I,R,$.props.children,ae,$.key):R!==null&&(R.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===H&&Ya(Te)===R.type)?(R=c(R,$.props),xr(R,$),R.return=I,R):(R=Ss($.type,$.key,$.props,null,I.mode,ae),xr(R,$),R.return=I,R)}function P(I,R,$,ae){return R===null||R.tag!==4||R.stateNode.containerInfo!==$.containerInfo||R.stateNode.implementation!==$.implementation?(R=po($,I.mode,ae),R.return=I,R):(R=c(R,$.children||[]),R.return=I,R)}function te(I,R,$,ae,Te){return R===null||R.tag!==7?(R=Va($,I.mode,ae,Te),R.return=I,R):(R=c(R,$),R.return=I,R)}function le(I,R,$){if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return R=go(""+R,I.mode,$),R.return=I,R;if(typeof R=="object"&&R!==null){switch(R.$$typeof){case b:return $=Ss(R.type,R.key,R.props,null,I.mode,$),xr($,R),$.return=I,$;case w:return R=po(R,I.mode,$),R.return=I,R;case H:return R=Ya(R),le(I,R,$)}if(_e(R)||F(R))return R=Va(R,I.mode,$,null),R.return=I,R;if(typeof R.then=="function")return le(I,Ns(R),$);if(R.$$typeof===B)return le(I,Cs(I,R),$);Rs(I,R)}return null}function Y(I,R,$,ae){var Te=R!==null?R.key:null;if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return Te!==null?null:_(I,R,""+$,ae);if(typeof $=="object"&&$!==null){switch($.$$typeof){case b:return $.key===Te?N(I,R,$,ae):null;case w:return $.key===Te?P(I,R,$,ae):null;case H:return $=Ya($),Y(I,R,$,ae)}if(_e($)||F($))return Te!==null?null:te(I,R,$,ae,null);if(typeof $.then=="function")return Y(I,R,Ns($),ae);if($.$$typeof===B)return Y(I,R,Cs(I,$),ae);Rs(I,$)}return null}function X(I,R,$,ae,Te){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return I=I.get($)||null,_(R,I,""+ae,Te);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case b:return I=I.get(ae.key===null?$:ae.key)||null,N(R,I,ae,Te);case w:return I=I.get(ae.key===null?$:ae.key)||null,P(R,I,ae,Te);case H:return ae=Ya(ae),X(I,R,$,ae,Te)}if(_e(ae)||F(ae))return I=I.get($)||null,te(R,I,ae,Te,null);if(typeof ae.then=="function")return X(I,R,$,Ns(ae),Te);if(ae.$$typeof===B)return X(I,R,$,Cs(R,ae),Te);Rs(R,ae)}return null}function je(I,R,$,ae){for(var Te=null,Ye=null,we=R,qe=R=0,Pe=null;we!==null&&qe<$.length;qe++){we.index>qe?(Pe=we,we=null):Pe=we.sibling;var Je=Y(I,we,$[qe],ae);if(Je===null){we===null&&(we=Pe);break}e&&we&&Je.alternate===null&&t(I,we),R=h(Je,R,qe),Ye===null?Te=Je:Ye.sibling=Je,Ye=Je,we=Pe}if(qe===$.length)return n(I,we),Ge&&$n(I,qe),Te;if(we===null){for(;qe<$.length;qe++)we=le(I,$[qe],ae),we!==null&&(R=h(we,R,qe),Ye===null?Te=we:Ye.sibling=we,Ye=we);return Ge&&$n(I,qe),Te}for(we=i(we);qe<$.length;qe++)Pe=X(we,I,qe,$[qe],ae),Pe!==null&&(e&&Pe.alternate!==null&&we.delete(Pe.key===null?qe:Pe.key),R=h(Pe,R,qe),Ye===null?Te=Pe:Ye.sibling=Pe,Ye=Pe);return e&&we.forEach(function(Aa){return t(I,Aa)}),Ge&&$n(I,qe),Te}function Ae(I,R,$,ae){if($==null)throw Error(l(151));for(var Te=null,Ye=null,we=R,qe=R=0,Pe=null,Je=$.next();we!==null&&!Je.done;qe++,Je=$.next()){we.index>qe?(Pe=we,we=null):Pe=we.sibling;var Aa=Y(I,we,Je.value,ae);if(Aa===null){we===null&&(we=Pe);break}e&&we&&Aa.alternate===null&&t(I,we),R=h(Aa,R,qe),Ye===null?Te=Aa:Ye.sibling=Aa,Ye=Aa,we=Pe}if(Je.done)return n(I,we),Ge&&$n(I,qe),Te;if(we===null){for(;!Je.done;qe++,Je=$.next())Je=le(I,Je.value,ae),Je!==null&&(R=h(Je,R,qe),Ye===null?Te=Je:Ye.sibling=Je,Ye=Je);return Ge&&$n(I,qe),Te}for(we=i(we);!Je.done;qe++,Je=$.next())Je=X(we,I,qe,Je.value,ae),Je!==null&&(e&&Je.alternate!==null&&we.delete(Je.key===null?qe:Je.key),R=h(Je,R,qe),Ye===null?Te=Je:Ye.sibling=Je,Ye=Je);return e&&we.forEach(function(cv){return t(I,cv)}),Ge&&$n(I,qe),Te}function at(I,R,$,ae){if(typeof $=="object"&&$!==null&&$.type===T&&$.key===null&&($=$.props.children),typeof $=="object"&&$!==null){switch($.$$typeof){case b:e:{for(var Te=$.key;R!==null;){if(R.key===Te){if(Te=$.type,Te===T){if(R.tag===7){n(I,R.sibling),ae=c(R,$.props.children),ae.return=I,I=ae;break e}}else if(R.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===H&&Ya(Te)===R.type){n(I,R.sibling),ae=c(R,$.props),xr(ae,$),ae.return=I,I=ae;break e}n(I,R);break}else t(I,R);R=R.sibling}$.type===T?(ae=Va($.props.children,I.mode,ae,$.key),ae.return=I,I=ae):(ae=Ss($.type,$.key,$.props,null,I.mode,ae),xr(ae,$),ae.return=I,I=ae)}return y(I);case w:e:{for(Te=$.key;R!==null;){if(R.key===Te)if(R.tag===4&&R.stateNode.containerInfo===$.containerInfo&&R.stateNode.implementation===$.implementation){n(I,R.sibling),ae=c(R,$.children||[]),ae.return=I,I=ae;break e}else{n(I,R);break}else t(I,R);R=R.sibling}ae=po($,I.mode,ae),ae.return=I,I=ae}return y(I);case H:return $=Ya($),at(I,R,$,ae)}if(_e($))return je(I,R,$,ae);if(F($)){if(Te=F($),typeof Te!="function")throw Error(l(150));return $=Te.call($),Ae(I,R,$,ae)}if(typeof $.then=="function")return at(I,R,Ns($),ae);if($.$$typeof===B)return at(I,R,Cs(I,$),ae);Rs(I,$)}return typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint"?($=""+$,R!==null&&R.tag===6?(n(I,R.sibling),ae=c(R,$),ae.return=I,I=ae):(n(I,R),ae=go($,I.mode,ae),ae.return=I,I=ae),y(I)):n(I,R)}return function(I,R,$,ae){try{_r=0;var Te=at(I,R,$,ae);return Ni=null,Te}catch(we){if(we===Oi||we===As)throw we;var Ye=Zt(29,we,null,I.mode);return Ye.lanes=ae,Ye.return=I,Ye}finally{}}}var Qa=Ud(!0),zd=Ud(!1),da=!1;function To(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ao(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ha(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function fa(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(Fe&2)!==0){var c=i.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),i.pending=t,t=js(e),yd(e,null,n),t}return xs(e,i,t,n),js(e)}function jr(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,cs(e,n)}}function Oo(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var c=null,h=null;if(n=n.firstBaseUpdate,n!==null){do{var y={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};h===null?c=h=y:h=h.next=y,n=n.next}while(n!==null);h===null?c=h=t:h=h.next=t}else c=h=t;n={baseState:i.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:i.shared,callbacks:i.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var No=!1;function Sr(){if(No){var e=Ai;if(e!==null)throw e}}function wr(e,t,n,i){No=!1;var c=e.updateQueue;da=!1;var h=c.firstBaseUpdate,y=c.lastBaseUpdate,_=c.shared.pending;if(_!==null){c.shared.pending=null;var N=_,P=N.next;N.next=null,y===null?h=P:y.next=P,y=N;var te=e.alternate;te!==null&&(te=te.updateQueue,_=te.lastBaseUpdate,_!==y&&(_===null?te.firstBaseUpdate=P:_.next=P,te.lastBaseUpdate=N))}if(h!==null){var le=c.baseState;y=0,te=P=N=null,_=h;do{var Y=_.lane&-536870913,X=Y!==_.lane;if(X?($e&Y)===Y:(i&Y)===Y){Y!==0&&Y===Ti&&(No=!0),te!==null&&(te=te.next={lane:0,tag:_.tag,payload:_.payload,callback:null,next:null});e:{var je=e,Ae=_;Y=t;var at=n;switch(Ae.tag){case 1:if(je=Ae.payload,typeof je=="function"){le=je.call(at,le,Y);break e}le=je;break e;case 3:je.flags=je.flags&-65537|128;case 0:if(je=Ae.payload,Y=typeof je=="function"?je.call(at,le,Y):je,Y==null)break e;le=x({},le,Y);break e;case 2:da=!0}}Y=_.callback,Y!==null&&(e.flags|=64,X&&(e.flags|=8192),X=c.callbacks,X===null?c.callbacks=[Y]:X.push(Y))}else X={lane:Y,tag:_.tag,payload:_.payload,callback:_.callback,next:null},te===null?(P=te=X,N=le):te=te.next=X,y|=Y;if(_=_.next,_===null){if(_=c.shared.pending,_===null)break;X=_,_=X.next,X.next=null,c.lastBaseUpdate=X,c.shared.pending=null}}while(!0);te===null&&(N=le),c.baseState=N,c.firstBaseUpdate=P,c.lastBaseUpdate=te,h===null&&(c.shared.lanes=0),va|=y,e.lanes=y,e.memoizedState=le}}function Dd(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function Bd(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Dd(n[e],t)}var Ri=A(null),ks=A(0);function Md(e,t){e=ea,K(ks,e),K(Ri,t),ea=e|t.baseLanes}function Ro(){K(ks,ea),K(Ri,Ri.current)}function ko(){ea=ks.current,z(Ri),z(ks)}var Wt=A(null),pn=null;function ga(e){var t=e.alternate;K(yt,yt.current&1),K(Wt,e),pn===null&&(t===null||Ri.current!==null||t.memoizedState!==null)&&(pn=e)}function Uo(e){K(yt,yt.current),K(Wt,e),pn===null&&(pn=e)}function qd(e){e.tag===22?(K(yt,yt.current),K(Wt,e),pn===null&&(pn=e)):pa()}function pa(){K(yt,yt.current),K(Wt,Wt.current)}function en(e){z(Wt),pn===e&&(pn=null),z(yt)}var yt=A(0);function Us(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||Lc(n)||Ic(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder==="forwards"||t.memoizedProps.revealOrder==="backwards"||t.memoizedProps.revealOrder==="unstable_legacy-backwards"||t.memoizedProps.revealOrder==="together")){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Kn=0,Me=null,tt=null,xt=null,zs=!1,ki=!1,Xa=!1,Ds=0,Er=0,Ui=null,Wm=0;function pt(){throw Error(l(321))}function zo(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ft(e[n],t[n]))return!1;return!0}function Do(e,t,n,i,c,h){return Kn=h,Me=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=e===null||e.memoizedState===null?xh:Xo,Xa=!1,h=n(i,c),Xa=!1,ki&&(h=Id(t,n,i,c)),Ld(e),h}function Ld(e){D.H=Ar;var t=tt!==null&&tt.next!==null;if(Kn=0,xt=tt=Me=null,zs=!1,Er=0,Ui=null,t)throw Error(l(300));e===null||jt||(e=e.dependencies,e!==null&&Es(e)&&(jt=!0))}function Id(e,t,n,i){Me=e;var c=0;do{if(ki&&(Ui=null),Er=0,ki=!1,25<=c)throw Error(l(301));if(c+=1,xt=tt=null,e.updateQueue!=null){var h=e.updateQueue;h.lastEffect=null,h.events=null,h.stores=null,h.memoCache!=null&&(h.memoCache.index=0)}D.H=jh,h=t(n,i)}while(ki);return h}function ey(){var e=D.H,t=e.useState()[0];return t=typeof t.then=="function"?Cr(t):t,e=e.useState()[0],(tt!==null?tt.memoizedState:null)!==e&&(Me.flags|=1024),t}function Bo(){var e=Ds!==0;return Ds=0,e}function Mo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function qo(e){if(zs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}zs=!1}Kn=0,xt=tt=Me=null,ki=!1,Er=Ds=0,Ui=null}function Vt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?Me.memoizedState=xt=e:xt=xt.next=e,xt}function vt(){if(tt===null){var e=Me.alternate;e=e!==null?e.memoizedState:null}else e=tt.next;var t=xt===null?Me.memoizedState:xt.next;if(t!==null)xt=t,tt=e;else{if(e===null)throw Me.alternate===null?Error(l(467)):Error(l(310));tt=e,e={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},xt===null?Me.memoizedState=xt=e:xt=xt.next=e}return xt}function Bs(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cr(e){var t=Er;return Er+=1,Ui===null&&(Ui=[]),e=Nd(Ui,e,t),t=Me,(xt===null?t.memoizedState:xt.next)===null&&(t=t.alternate,D.H=t===null||t.memoizedState===null?xh:Xo),e}function Ms(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return Cr(e);if(e.$$typeof===B)return Rt(e)}throw Error(l(438,String(e)))}function Lo(e){var t=null,n=Me.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var i=Me.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(c){return c.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=Bs(),Me.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=J;return t.index++,n}function Yn(e,t){return typeof t=="function"?t(e):t}function qs(e){var t=vt();return Io(t,tt,e)}function Io(e,t,n){var i=e.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=n;var c=e.baseQueue,h=i.pending;if(h!==null){if(c!==null){var y=c.next;c.next=h.next,h.next=y}t.baseQueue=c=h,i.pending=null}if(h=e.baseState,c===null)e.memoizedState=h;else{t=c.next;var _=y=null,N=null,P=t,te=!1;do{var le=P.lane&-536870913;if(le!==P.lane?($e&le)===le:(Kn&le)===le){var Y=P.revertLane;if(Y===0)N!==null&&(N=N.next={lane:0,revertLane:0,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null}),le===Ti&&(te=!0);else if((Kn&Y)===Y){P=P.next,Y===Ti&&(te=!0);continue}else le={lane:0,revertLane:P.revertLane,gesture:null,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},N===null?(_=N=le,y=h):N=N.next=le,Me.lanes|=Y,va|=Y;le=P.action,Xa&&n(h,le),h=P.hasEagerState?P.eagerState:n(h,le)}else Y={lane:le,revertLane:P.revertLane,gesture:P.gesture,action:P.action,hasEagerState:P.hasEagerState,eagerState:P.eagerState,next:null},N===null?(_=N=Y,y=h):N=N.next=Y,Me.lanes|=le,va|=le;P=P.next}while(P!==null&&P!==t);if(N===null?y=h:N.next=_,!Ft(h,e.memoizedState)&&(jt=!0,te&&(n=Ai,n!==null)))throw n;e.memoizedState=h,e.baseState=y,e.baseQueue=N,i.lastRenderedState=h}return c===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Ho(e){var t=vt(),n=t.queue;if(n===null)throw Error(l(311));n.lastRenderedReducer=e;var i=n.dispatch,c=n.pending,h=t.memoizedState;if(c!==null){n.pending=null;var y=c=c.next;do h=e(h,y.action),y=y.next;while(y!==c);Ft(h,t.memoizedState)||(jt=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),n.lastRenderedState=h}return[h,i]}function Hd(e,t,n){var i=Me,c=vt(),h=Ge;if(h){if(n===void 0)throw Error(l(407));n=n()}else n=t();var y=!Ft((tt||c).memoizedState,n);if(y&&(c.memoizedState=n,jt=!0),c=c.queue,Po(Pd.bind(null,i,c,e),[e]),c.getSnapshot!==t||y||xt!==null&&xt.memoizedState.tag&1){if(i.flags|=2048,zi(9,{destroy:void 0},$d.bind(null,i,c,n,t),null),rt===null)throw Error(l(349));h||(Kn&127)!==0||Vd(i,t,n)}return n}function Vd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Me.updateQueue,t===null?(t=Bs(),Me.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $d(e,t,n,i){t.value=n,t.getSnapshot=i,Gd(t)&&Kd(e)}function Pd(e,t,n){return n(function(){Gd(t)&&Kd(e)})}function Gd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ft(e,n)}catch{return!0}}function Kd(e){var t=Ha(e,2);t!==null&&Xt(t,e,2)}function Vo(e){var t=Vt();if(typeof e=="function"){var n=e;if(e=n(),Xa){On(!0);try{n()}finally{On(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:e},t}function Yd(e,t,n,i){return e.baseState=n,Io(e,tt,typeof i=="function"?i:Yn)}function ty(e,t,n,i,c){if(Hs(e))throw Error(l(485));if(e=t.action,e!==null){var h={payload:c,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){h.listeners.push(y)}};D.T!==null?n(!0):h.isTransition=!1,i(h),n=t.pending,n===null?(h.next=t.pending=h,Jd(t,h)):(h.next=n.next,t.pending=n.next=h)}}function Jd(e,t){var n=t.action,i=t.payload,c=e.state;if(t.isTransition){var h=D.T,y={};D.T=y;try{var _=n(c,i),N=D.S;N!==null&&N(y,_),Qd(e,t,_)}catch(P){$o(e,t,P)}finally{h!==null&&y.types!==null&&(h.types=y.types),D.T=h}}else try{h=n(c,i),Qd(e,t,h)}catch(P){$o(e,t,P)}}function Qd(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){Xd(e,t,i)},function(i){return $o(e,t,i)}):Xd(e,t,n)}function Xd(e,t,n){t.status="fulfilled",t.value=n,Fd(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Jd(e,n)))}function $o(e,t,n){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=n,Fd(t),t=t.next;while(t!==i)}e.action=null}function Fd(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Zd(e,t){return t}function Wd(e,t){if(Ge){var n=rt.formState;if(n!==null){e:{var i=Me;if(Ge){if(ot){t:{for(var c=ot,h=gn;c.nodeType!==8;){if(!h){c=null;break t}if(c=mn(c.nextSibling),c===null){c=null;break t}}h=c.data,c=h==="F!"||h==="F"?c:null}if(c){ot=mn(c.nextSibling),i=c.data==="F!";break e}}ca(i)}i=!1}i&&(t=n[0])}}return n=Vt(),n.memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zd,lastRenderedState:t},n.queue=i,n=vh.bind(null,Me,i),i.dispatch=n,i=Vo(!1),h=Qo.bind(null,Me,!1,i.queue),i=Vt(),c={state:t,dispatch:null,action:e,pending:null},i.queue=c,n=ty.bind(null,Me,c,h,n),c.dispatch=n,i.memoizedState=e,[t,n,!1]}function eh(e){var t=vt();return th(t,tt,e)}function th(e,t,n){if(t=Io(e,t,Zd)[0],e=qs(Yn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=Cr(t)}catch(y){throw y===Oi?As:y}else i=t;t=vt();var c=t.queue,h=c.dispatch;return n!==t.memoizedState&&(Me.flags|=2048,zi(9,{destroy:void 0},ny.bind(null,c,n),null)),[i,h,e]}function ny(e,t){e.action=t}function nh(e){var t=vt(),n=tt;if(n!==null)return th(t,n,e);vt(),t=t.memoizedState,n=vt();var i=n.queue.dispatch;return n.memoizedState=e,[t,i,!1]}function zi(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},t=Me.updateQueue,t===null&&(t=Bs(),Me.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function ah(){return vt().memoizedState}function Ls(e,t,n,i){var c=Vt();Me.flags|=e,c.memoizedState=zi(1|t,{destroy:void 0},n,i===void 0?null:i)}function Is(e,t,n,i){var c=vt();i=i===void 0?null:i;var h=c.memoizedState.inst;tt!==null&&i!==null&&zo(i,tt.memoizedState.deps)?c.memoizedState=zi(t,h,n,i):(Me.flags|=e,c.memoizedState=zi(1|t,h,n,i))}function ih(e,t){Ls(8390656,8,e,t)}function Po(e,t){Is(2048,8,e,t)}function ay(e){Me.flags|=4;var t=Me.updateQueue;if(t===null)t=Bs(),Me.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function rh(e){var t=vt().memoizedState;return ay({ref:t,nextImpl:e}),function(){if((Fe&2)!==0)throw Error(l(440));return t.impl.apply(void 0,arguments)}}function sh(e,t){return Is(4,2,e,t)}function lh(e,t){return Is(4,4,e,t)}function oh(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ch(e,t,n){n=n!=null?n.concat([e]):null,Is(4,4,oh.bind(null,t,e),n)}function Go(){}function uh(e,t){var n=vt();t=t===void 0?null:t;var i=n.memoizedState;return t!==null&&zo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function dh(e,t){var n=vt();t=t===void 0?null:t;var i=n.memoizedState;if(t!==null&&zo(t,i[1]))return i[0];if(i=e(),Xa){On(!0);try{e()}finally{On(!1)}}return n.memoizedState=[i,t],i}function Ko(e,t,n){return n===void 0||(Kn&1073741824)!==0&&($e&261930)===0?e.memoizedState=t:(e.memoizedState=n,e=ff(),Me.lanes|=e,va|=e,n)}function hh(e,t,n,i){return Ft(n,t)?n:Ri.current!==null?(e=Ko(e,n,i),Ft(e,t)||(jt=!0),e):(Kn&42)===0||(Kn&1073741824)!==0&&($e&261930)===0?(jt=!0,e.memoizedState=n):(e=ff(),Me.lanes|=e,va|=e,t)}function fh(e,t,n,i,c){var h=L.p;L.p=h!==0&&8>h?h:8;var y=D.T,_={};D.T=_,Qo(e,!1,t,n);try{var N=c(),P=D.S;if(P!==null&&P(_,N),N!==null&&typeof N=="object"&&typeof N.then=="function"){var te=Zm(N,i);Tr(e,t,te,an(e))}else Tr(e,t,i,an(e))}catch(le){Tr(e,t,{then:function(){},status:"rejected",reason:le},an())}finally{L.p=h,y!==null&&_.types!==null&&(y.types=_.types),D.T=y}}function iy(){}function Yo(e,t,n,i){if(e.tag!==5)throw Error(l(476));var c=gh(e).queue;fh(e,c,t,ee,n===null?iy:function(){return ph(e),n(i)})}function gh(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:ee},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yn,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function ph(e){var t=gh(e);t.next===null&&(t=e.alternate.memoizedState),Tr(e,t.next.queue,{},an())}function Jo(){return Rt(Pr)}function mh(){return vt().memoizedState}function yh(){return vt().memoizedState}function ry(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=an();e=ha(n);var i=fa(t,e,n);i!==null&&(Xt(i,t,n),jr(i,t,n)),t={cache:So()},e.payload=t;return}t=t.return}}function sy(e,t,n){var i=an();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Hs(e)?bh(t,n):(n=ho(e,t,n,i),n!==null&&(Xt(n,e,i),_h(n,t,i)))}function vh(e,t,n){var i=an();Tr(e,t,n,i)}function Tr(e,t,n,i){var c={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Hs(e))bh(t,c);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var y=t.lastRenderedState,_=h(y,n);if(c.hasEagerState=!0,c.eagerState=_,Ft(_,y))return xs(e,t,c,0),rt===null&&_s(),!1}catch{}finally{}if(n=ho(e,t,c,i),n!==null)return Xt(n,e,i),_h(n,t,i),!0}return!1}function Qo(e,t,n,i){if(i={lane:2,revertLane:Tc(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},Hs(e)){if(t)throw Error(l(479))}else t=ho(e,n,i,2),t!==null&&Xt(t,e,2)}function Hs(e){var t=e.alternate;return e===Me||t!==null&&t===Me}function bh(e,t){ki=zs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function _h(e,t,n){if((n&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,cs(e,n)}}var Ar={readContext:Rt,use:Ms,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useLayoutEffect:pt,useInsertionEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useSyncExternalStore:pt,useId:pt,useHostTransitionStatus:pt,useFormState:pt,useActionState:pt,useOptimistic:pt,useMemoCache:pt,useCacheRefresh:pt};Ar.useEffectEvent=pt;var xh={readContext:Rt,use:Ms,useCallback:function(e,t){return Vt().memoizedState=[e,t===void 0?null:t],e},useContext:Rt,useEffect:ih,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Ls(4194308,4,oh.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ls(4194308,4,e,t)},useInsertionEffect:function(e,t){Ls(4,2,e,t)},useMemo:function(e,t){var n=Vt();t=t===void 0?null:t;var i=e();if(Xa){On(!0);try{e()}finally{On(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=Vt();if(n!==void 0){var c=n(t);if(Xa){On(!0);try{n(t)}finally{On(!1)}}}else c=t;return i.memoizedState=i.baseState=c,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:c},i.queue=e,e=e.dispatch=sy.bind(null,Me,e),[i.memoizedState,e]},useRef:function(e){var t=Vt();return e={current:e},t.memoizedState=e},useState:function(e){e=Vo(e);var t=e.queue,n=vh.bind(null,Me,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Go,useDeferredValue:function(e,t){var n=Vt();return Ko(n,e,t)},useTransition:function(){var e=Vo(!1);return e=fh.bind(null,Me,e.queue,!0,!1),Vt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=Me,c=Vt();if(Ge){if(n===void 0)throw Error(l(407));n=n()}else{if(n=t(),rt===null)throw Error(l(349));($e&127)!==0||Vd(i,t,n)}c.memoizedState=n;var h={value:n,getSnapshot:t};return c.queue=h,ih(Pd.bind(null,i,h,e),[e]),i.flags|=2048,zi(9,{destroy:void 0},$d.bind(null,i,h,n,t),null),n},useId:function(){var e=Vt(),t=rt.identifierPrefix;if(Ge){var n=Bn,i=Dn;n=(i&~(1<<32-It(i)-1)).toString(32)+n,t="_"+t+"R_"+n,n=Ds++,0<n&&(t+="H"+n.toString(32)),t+="_"}else n=Wm++,t="_"+t+"r_"+n.toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:Jo,useFormState:Wd,useActionState:Wd,useOptimistic:function(e){var t=Vt();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Qo.bind(null,Me,!0,n),n.dispatch=t,[e,t]},useMemoCache:Lo,useCacheRefresh:function(){return Vt().memoizedState=ry.bind(null,Me)},useEffectEvent:function(e){var t=Vt(),n={impl:e};return t.memoizedState=n,function(){if((Fe&2)!==0)throw Error(l(440));return n.impl.apply(void 0,arguments)}}},Xo={readContext:Rt,use:Ms,useCallback:uh,useContext:Rt,useEffect:Po,useImperativeHandle:ch,useInsertionEffect:sh,useLayoutEffect:lh,useMemo:dh,useReducer:qs,useRef:ah,useState:function(){return qs(Yn)},useDebugValue:Go,useDeferredValue:function(e,t){var n=vt();return hh(n,tt.memoizedState,e,t)},useTransition:function(){var e=qs(Yn)[0],t=vt().memoizedState;return[typeof e=="boolean"?e:Cr(e),t]},useSyncExternalStore:Hd,useId:mh,useHostTransitionStatus:Jo,useFormState:eh,useActionState:eh,useOptimistic:function(e,t){var n=vt();return Yd(n,tt,e,t)},useMemoCache:Lo,useCacheRefresh:yh};Xo.useEffectEvent=rh;var jh={readContext:Rt,use:Ms,useCallback:uh,useContext:Rt,useEffect:Po,useImperativeHandle:ch,useInsertionEffect:sh,useLayoutEffect:lh,useMemo:dh,useReducer:Ho,useRef:ah,useState:function(){return Ho(Yn)},useDebugValue:Go,useDeferredValue:function(e,t){var n=vt();return tt===null?Ko(n,e,t):hh(n,tt.memoizedState,e,t)},useTransition:function(){var e=Ho(Yn)[0],t=vt().memoizedState;return[typeof e=="boolean"?e:Cr(e),t]},useSyncExternalStore:Hd,useId:mh,useHostTransitionStatus:Jo,useFormState:nh,useActionState:nh,useOptimistic:function(e,t){var n=vt();return tt!==null?Yd(n,tt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Lo,useCacheRefresh:yh};jh.useEffectEvent=rh;function Fo(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:x({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Zo={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=an(),c=ha(i);c.payload=t,n!=null&&(c.callback=n),t=fa(e,c,i),t!==null&&(Xt(t,e,i),jr(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=an(),c=ha(i);c.tag=1,c.payload=t,n!=null&&(c.callback=n),t=fa(e,c,i),t!==null&&(Xt(t,e,i),jr(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=an(),i=ha(n);i.tag=2,t!=null&&(i.callback=t),t=fa(e,i,n),t!==null&&(Xt(t,e,n),jr(t,e,n))}};function Sh(e,t,n,i,c,h,y){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,h,y):t.prototype&&t.prototype.isPureReactComponent?!gr(n,i)||!gr(c,h):!0}function wh(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Zo.enqueueReplaceState(t,t.state,null)}function Fa(e,t){var n=t;if("ref"in t){n={};for(var i in t)i!=="ref"&&(n[i]=t[i])}if(e=e.defaultProps){n===t&&(n=x({},n));for(var c in e)n[c]===void 0&&(n[c]=e[c])}return n}function Eh(e){bs(e)}function Ch(e){console.error(e)}function Th(e){bs(e)}function Vs(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function Ah(e,t,n){try{var i=e.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(c){setTimeout(function(){throw c})}}function Wo(e,t,n){return n=ha(n),n.tag=3,n.payload={element:null},n.callback=function(){Vs(e,t)},n}function Oh(e){return e=ha(e),e.tag=3,e}function Nh(e,t,n,i){var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var h=i.value;e.payload=function(){return c(h)},e.callback=function(){Ah(t,n,i)}}var y=n.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(e.callback=function(){Ah(t,n,i),typeof c!="function"&&(ba===null?ba=new Set([this]):ba.add(this));var _=i.stack;this.componentDidCatch(i.value,{componentStack:_!==null?_:""})})}function ly(e,t,n,i,c){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=n.alternate,t!==null&&Ci(t,n,c,!0),n=Wt.current,n!==null){switch(n.tag){case 31:case 13:return pn===null?el():n.alternate===null&&mt===0&&(mt=3),n.flags&=-257,n.flags|=65536,n.lanes=c,i===Os?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([i]):t.add(i),wc(e,i,c)),!1;case 22:return n.flags|=65536,i===Os?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([i]):n.add(i)),wc(e,i,c)),!1}throw Error(l(435,n.tag))}return wc(e,i,c),el(),!1}if(Ge)return t=Wt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=c,i!==vo&&(e=Error(l(422),{cause:i}),yr(dn(e,n)))):(i!==vo&&(t=Error(l(423),{cause:i}),yr(dn(t,n))),e=e.current.alternate,e.flags|=65536,c&=-c,e.lanes|=c,i=dn(i,n),c=Wo(e.stateNode,i,c),Oo(e,c),mt!==4&&(mt=2)),!1;var h=Error(l(520),{cause:i});if(h=dn(h,n),Br===null?Br=[h]:Br.push(h),mt!==4&&(mt=2),t===null)return!0;i=dn(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=c&-c,n.lanes|=e,e=Wo(n.stateNode,i,e),Oo(n,e),!1;case 1:if(t=n.type,h=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||h!==null&&typeof h.componentDidCatch=="function"&&(ba===null||!ba.has(h))))return n.flags|=65536,c&=-c,n.lanes|=c,c=Oh(c),Nh(c,e,n,i),Oo(n,c),!1}n=n.return}while(n!==null);return!1}var ec=Error(l(461)),jt=!1;function kt(e,t,n,i){t.child=e===null?zd(t,null,n,i):Qa(t,e.child,n,i)}function Rh(e,t,n,i,c){n=n.render;var h=t.ref;if("ref"in i){var y={};for(var _ in i)_!=="ref"&&(y[_]=i[_])}else y=i;return Ga(t),i=Do(e,t,n,y,h,c),_=Bo(),e!==null&&!jt?(Mo(e,t,c),Jn(e,t,c)):(Ge&&_&&mo(t),t.flags|=1,kt(e,t,i,c),t.child)}function kh(e,t,n,i,c){if(e===null){var h=n.type;return typeof h=="function"&&!fo(h)&&h.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=h,Uh(e,t,h,i,c)):(e=Ss(n.type,null,i,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,!oc(e,c)){var y=h.memoizedProps;if(n=n.compare,n=n!==null?n:gr,n(y,i)&&e.ref===t.ref)return Jn(e,t,c)}return t.flags|=1,e=Vn(h,i),e.ref=t.ref,e.return=t,t.child=e}function Uh(e,t,n,i,c){if(e!==null){var h=e.memoizedProps;if(gr(h,i)&&e.ref===t.ref)if(jt=!1,t.pendingProps=i=h,oc(e,c))(e.flags&131072)!==0&&(jt=!0);else return t.lanes=e.lanes,Jn(e,t,c)}return tc(e,t,n,i,c)}function zh(e,t,n,i){var c=i.children,h=e!==null?e.memoizedState:null;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.mode==="hidden"){if((t.flags&128)!==0){if(h=h!==null?h.baseLanes|n:n,e!==null){for(i=t.child=e.child,c=0;i!==null;)c=c|i.lanes|i.childLanes,i=i.sibling;i=c&~h}else i=0,t.child=null;return Dh(e,t,h,n,i)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Ts(t,h!==null?h.cachePool:null),h!==null?Md(t,h):Ro(),qd(t);else return i=t.lanes=536870912,Dh(e,t,h!==null?h.baseLanes|n:n,n,i)}else h!==null?(Ts(t,h.cachePool),Md(t,h),pa(),t.memoizedState=null):(e!==null&&Ts(t,null),Ro(),pa());return kt(e,t,c,n),t.child}function Or(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Dh(e,t,n,i,c){var h=Eo();return h=h===null?null:{parent:_t._currentValue,pool:h},t.memoizedState={baseLanes:n,cachePool:h},e!==null&&Ts(t,null),Ro(),qd(t),e!==null&&Ci(e,t,i,!0),t.childLanes=c,null}function $s(e,t){return t=Gs({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Bh(e,t,n){return Qa(t,e.child,null,n),e=$s(t,t.pendingProps),e.flags|=2,en(t),t.memoizedState=null,e}function oy(e,t,n){var i=t.pendingProps,c=(t.flags&128)!==0;if(t.flags&=-129,e===null){if(Ge){if(i.mode==="hidden")return e=$s(t,i),t.lanes=536870912,Or(null,e);if(Uo(t),(e=ot)?(e=Qf(e,gn),e=e!==null&&e.data==="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:la!==null?{id:Dn,overflow:Bn}:null,retryLane:536870912,hydrationErrors:null},n=bd(e),n.return=t,t.child=n,Nt=t,ot=null)):e=null,e===null)throw ca(t);return t.lanes=536870912,null}return $s(t,i)}var h=e.memoizedState;if(h!==null){var y=h.dehydrated;if(Uo(t),c)if(t.flags&256)t.flags&=-257,t=Bh(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(l(558));else if(jt||Ci(e,t,n,!1),c=(n&e.childLanes)!==0,jt||c){if(i=rt,i!==null&&(y=us(i,n),y!==0&&y!==h.retryLane))throw h.retryLane=y,Ha(e,y),Xt(i,e,y),ec;el(),t=Bh(e,t,n)}else e=h.treeContext,ot=mn(y.nextSibling),Nt=t,Ge=!0,oa=null,gn=!1,e!==null&&jd(t,e),t=$s(t,i),t.flags|=4096;return t}return e=Vn(e.child,{mode:i.mode,children:i.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Ps(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(l(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function tc(e,t,n,i,c){return Ga(t),n=Do(e,t,n,i,void 0,c),i=Bo(),e!==null&&!jt?(Mo(e,t,c),Jn(e,t,c)):(Ge&&i&&mo(t),t.flags|=1,kt(e,t,n,c),t.child)}function Mh(e,t,n,i,c,h){return Ga(t),t.updateQueue=null,n=Id(t,i,n,c),Ld(e),i=Bo(),e!==null&&!jt?(Mo(e,t,h),Jn(e,t,h)):(Ge&&i&&mo(t),t.flags|=1,kt(e,t,n,h),t.child)}function qh(e,t,n,i,c){if(Ga(t),t.stateNode===null){var h=ji,y=n.contextType;typeof y=="object"&&y!==null&&(h=Rt(y)),h=new n(i,h),t.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Zo,t.stateNode=h,h._reactInternals=t,h=t.stateNode,h.props=i,h.state=t.memoizedState,h.refs={},To(t),y=n.contextType,h.context=typeof y=="object"&&y!==null?Rt(y):ji,h.state=t.memoizedState,y=n.getDerivedStateFromProps,typeof y=="function"&&(Fo(t,n,y,i),h.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof h.getSnapshotBeforeUpdate=="function"||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(y=h.state,typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount(),y!==h.state&&Zo.enqueueReplaceState(h,h.state,null),wr(t,i,h,c),Sr(),h.state=t.memoizedState),typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){h=t.stateNode;var _=t.memoizedProps,N=Fa(n,_);h.props=N;var P=h.context,te=n.contextType;y=ji,typeof te=="object"&&te!==null&&(y=Rt(te));var le=n.getDerivedStateFromProps;te=typeof le=="function"||typeof h.getSnapshotBeforeUpdate=="function",_=t.pendingProps!==_,te||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(_||P!==y)&&wh(t,h,i,y),da=!1;var Y=t.memoizedState;h.state=Y,wr(t,i,h,c),Sr(),P=t.memoizedState,_||Y!==P||da?(typeof le=="function"&&(Fo(t,n,le,i),P=t.memoizedState),(N=da||Sh(t,n,N,i,Y,P,y))?(te||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=P),h.props=i,h.state=P,h.context=y,i=N):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{h=t.stateNode,Ao(e,t),y=t.memoizedProps,te=Fa(n,y),h.props=te,le=t.pendingProps,Y=h.context,P=n.contextType,N=ji,typeof P=="object"&&P!==null&&(N=Rt(P)),_=n.getDerivedStateFromProps,(P=typeof _=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(y!==le||Y!==N)&&wh(t,h,i,N),da=!1,Y=t.memoizedState,h.state=Y,wr(t,i,h,c),Sr();var X=t.memoizedState;y!==le||Y!==X||da||e!==null&&e.dependencies!==null&&Es(e.dependencies)?(typeof _=="function"&&(Fo(t,n,_,i),X=t.memoizedState),(te=da||Sh(t,n,te,i,Y,X,N)||e!==null&&e.dependencies!==null&&Es(e.dependencies))?(P||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(i,X,N),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(i,X,N)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=X),h.props=i,h.state=X,h.context=N,i=te):(typeof h.componentDidUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||y===e.memoizedProps&&Y===e.memoizedState||(t.flags|=1024),i=!1)}return h=i,Ps(e,t),i=(t.flags&128)!==0,h||i?(h=t.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:h.render(),t.flags|=1,e!==null&&i?(t.child=Qa(t,e.child,null,c),t.child=Qa(t,null,n,c)):kt(e,t,n,c),t.memoizedState=h.state,e=t.child):e=Jn(e,t,c),e}function Lh(e,t,n,i){return $a(),t.flags|=256,kt(e,t,n,i),t.child}var nc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ac(e){return{baseLanes:e,cachePool:Ad()}}function ic(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=nn),e}function Ih(e,t,n){var i=t.pendingProps,c=!1,h=(t.flags&128)!==0,y;if((y=h)||(y=e!==null&&e.memoizedState===null?!1:(yt.current&2)!==0),y&&(c=!0,t.flags&=-129),y=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ge){if(c?ga(t):pa(),(e=ot)?(e=Qf(e,gn),e=e!==null&&e.data!=="&"?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:la!==null?{id:Dn,overflow:Bn}:null,retryLane:536870912,hydrationErrors:null},n=bd(e),n.return=t,t.child=n,Nt=t,ot=null)):e=null,e===null)throw ca(t);return Ic(e)?t.lanes=32:t.lanes=536870912,null}var _=i.children;return i=i.fallback,c?(pa(),c=t.mode,_=Gs({mode:"hidden",children:_},c),i=Va(i,c,n,null),_.return=t,i.return=t,_.sibling=i,t.child=_,i=t.child,i.memoizedState=ac(n),i.childLanes=ic(e,y,n),t.memoizedState=nc,Or(null,i)):(ga(t),rc(t,_))}var N=e.memoizedState;if(N!==null&&(_=N.dehydrated,_!==null)){if(h)t.flags&256?(ga(t),t.flags&=-257,t=sc(e,t,n)):t.memoizedState!==null?(pa(),t.child=e.child,t.flags|=128,t=null):(pa(),_=i.fallback,c=t.mode,i=Gs({mode:"visible",children:i.children},c),_=Va(_,c,n,null),_.flags|=2,i.return=t,_.return=t,i.sibling=_,t.child=i,Qa(t,e.child,null,n),i=t.child,i.memoizedState=ac(n),i.childLanes=ic(e,y,n),t.memoizedState=nc,t=Or(null,i));else if(ga(t),Ic(_)){if(y=_.nextSibling&&_.nextSibling.dataset,y)var P=y.dgst;y=P,i=Error(l(419)),i.stack="",i.digest=y,yr({value:i,source:null,stack:null}),t=sc(e,t,n)}else if(jt||Ci(e,t,n,!1),y=(n&e.childLanes)!==0,jt||y){if(y=rt,y!==null&&(i=us(y,n),i!==0&&i!==N.retryLane))throw N.retryLane=i,Ha(e,i),Xt(y,e,i),ec;Lc(_)||el(),t=sc(e,t,n)}else Lc(_)?(t.flags|=192,t.child=e.child,t=null):(e=N.treeContext,ot=mn(_.nextSibling),Nt=t,Ge=!0,oa=null,gn=!1,e!==null&&jd(t,e),t=rc(t,i.children),t.flags|=4096);return t}return c?(pa(),_=i.fallback,c=t.mode,N=e.child,P=N.sibling,i=Vn(N,{mode:"hidden",children:i.children}),i.subtreeFlags=N.subtreeFlags&65011712,P!==null?_=Vn(P,_):(_=Va(_,c,n,null),_.flags|=2),_.return=t,i.return=t,i.sibling=_,t.child=i,Or(null,i),i=t.child,_=e.child.memoizedState,_===null?_=ac(n):(c=_.cachePool,c!==null?(N=_t._currentValue,c=c.parent!==N?{parent:N,pool:N}:c):c=Ad(),_={baseLanes:_.baseLanes|n,cachePool:c}),i.memoizedState=_,i.childLanes=ic(e,y,n),t.memoizedState=nc,Or(e.child,i)):(ga(t),n=e.child,e=n.sibling,n=Vn(n,{mode:"visible",children:i.children}),n.return=t,n.sibling=null,e!==null&&(y=t.deletions,y===null?(t.deletions=[e],t.flags|=16):y.push(e)),t.child=n,t.memoizedState=null,n)}function rc(e,t){return t=Gs({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Gs(e,t){return e=Zt(22,e,null,t),e.lanes=0,e}function sc(e,t,n){return Qa(t,e.child,null,n),e=rc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Hh(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),xo(e.return,t,n)}function lc(e,t,n,i,c,h){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:c,treeForkCount:h}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=i,y.tail=n,y.tailMode=c,y.treeForkCount=h)}function Vh(e,t,n){var i=t.pendingProps,c=i.revealOrder,h=i.tail;i=i.children;var y=yt.current,_=(y&2)!==0;if(_?(y=y&1|2,t.flags|=128):y&=1,K(yt,y),kt(e,t,i,n),i=Ge?mr:0,!_&&e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Hh(e,n,t);else if(e.tag===19)Hh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Us(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),lc(t,!1,c,n,h,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Us(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}lc(t,!0,n,null,h,i);break;case"together":lc(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function Jn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),va|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Ci(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,n=Vn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Vn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function oc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Es(e)))}function cy(e,t,n){switch(t.tag){case 3:de(t,t.stateNode.containerInfo),ua(t,_t,e.memoizedState.cache),$a();break;case 27:case 5:Ue(t);break;case 4:de(t,t.stateNode.containerInfo);break;case 10:ua(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,Uo(t),null;break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(ga(t),t.flags|=128,null):(n&t.child.childLanes)!==0?Ih(e,t,n):(ga(t),e=Jn(e,t,n),e!==null?e.sibling:null);ga(t);break;case 19:var c=(e.flags&128)!==0;if(i=(n&t.childLanes)!==0,i||(Ci(e,t,n,!1),i=(n&t.childLanes)!==0),c){if(i)return Vh(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),K(yt,yt.current),i)break;return null;case 22:return t.lanes=0,zh(e,t,n,t.pendingProps);case 24:ua(t,_t,e.memoizedState.cache)}return Jn(e,t,n)}function $h(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)jt=!0;else{if(!oc(e,n)&&(t.flags&128)===0)return jt=!1,cy(e,t,n);jt=(e.flags&131072)!==0}else jt=!1,Ge&&(t.flags&1048576)!==0&&xd(t,mr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=Ya(t.elementType),t.type=e,typeof e=="function")fo(e)?(i=Fa(e,i),t.tag=1,t=qh(null,t,e,i,n)):(t.tag=0,t=tc(null,t,e,i,n));else{if(e!=null){var c=e.$$typeof;if(c===G){t.tag=11,t=Rh(null,t,e,i,n);break e}else if(c===U){t.tag=14,t=kh(null,t,e,i,n);break e}}throw t=W(e)||e,Error(l(306,t,""))}}return t;case 0:return tc(e,t,t.type,t.pendingProps,n);case 1:return i=t.type,c=Fa(i,t.pendingProps),qh(e,t,i,c,n);case 3:e:{if(de(t,t.stateNode.containerInfo),e===null)throw Error(l(387));i=t.pendingProps;var h=t.memoizedState;c=h.element,Ao(e,t),wr(t,i,null,n);var y=t.memoizedState;if(i=y.cache,ua(t,_t,i),i!==h.cache&&jo(t,[_t],n,!0),Sr(),i=y.element,h.isDehydrated)if(h={element:i,isDehydrated:!1,cache:y.cache},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){t=Lh(e,t,i,n);break e}else if(i!==c){c=dn(Error(l(424)),t),yr(c),t=Lh(e,t,i,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(ot=mn(e.firstChild),Nt=t,Ge=!0,oa=null,gn=!0,n=zd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if($a(),i===c){t=Jn(e,t,n);break e}kt(e,t,i,n)}t=t.child}return t;case 26:return Ps(e,t),e===null?(n=tg(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ge||(n=t.type,e=t.pendingProps,i=ll(ie.current).createElement(n),i[bt]=t,i[Bt]=e,Ut(i,n,e),Se(i),t.stateNode=i):t.memoizedState=tg(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Ue(t),e===null&&Ge&&(i=t.stateNode=Zf(t.type,t.pendingProps,ie.current),Nt=t,gn=!0,c=ot,Sa(t.type)?(Hc=c,ot=mn(i.firstChild)):ot=c),kt(e,t,t.pendingProps.children,n),Ps(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ge&&((c=i=ot)&&(i=Ly(i,t.type,t.pendingProps,gn),i!==null?(t.stateNode=i,Nt=t,ot=mn(i.firstChild),gn=!1,c=!0):c=!1),c||ca(t)),Ue(t),c=t.type,h=t.pendingProps,y=e!==null?e.memoizedProps:null,i=h.children,Bc(c,h)?i=null:y!==null&&Bc(c,y)&&(t.flags|=32),t.memoizedState!==null&&(c=Do(e,t,ey,null,null,n),Pr._currentValue=c),Ps(e,t),kt(e,t,i,n),t.child;case 6:return e===null&&Ge&&((e=n=ot)&&(n=Iy(n,t.pendingProps,gn),n!==null?(t.stateNode=n,Nt=t,ot=null,e=!0):e=!1),e||ca(t)),null;case 13:return Ih(e,t,n);case 4:return de(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Qa(t,null,i,n):kt(e,t,i,n),t.child;case 11:return Rh(e,t,t.type,t.pendingProps,n);case 7:return kt(e,t,t.pendingProps,n),t.child;case 8:return kt(e,t,t.pendingProps.children,n),t.child;case 12:return kt(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,ua(t,t.type,i.value),kt(e,t,i.children,n),t.child;case 9:return c=t.type._context,i=t.pendingProps.children,Ga(t),c=Rt(c),i=i(c),t.flags|=1,kt(e,t,i,n),t.child;case 14:return kh(e,t,t.type,t.pendingProps,n);case 15:return Uh(e,t,t.type,t.pendingProps,n);case 19:return Vh(e,t,n);case 31:return oy(e,t,n);case 22:return zh(e,t,n,t.pendingProps);case 24:return Ga(t),i=Rt(_t),e===null?(c=Eo(),c===null&&(c=rt,h=So(),c.pooledCache=h,h.refCount++,h!==null&&(c.pooledCacheLanes|=n),c=h),t.memoizedState={parent:i,cache:c},To(t),ua(t,_t,c)):((e.lanes&n)!==0&&(Ao(e,t),wr(t,null,null,n),Sr()),c=e.memoizedState,h=t.memoizedState,c.parent!==i?(c={parent:i,cache:i},t.memoizedState=c,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=c),ua(t,_t,i)):(i=h.cache,ua(t,_t,i),i!==c.cache&&jo(t,[_t],n,!0))),kt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function Qn(e){e.flags|=4}function cc(e,t,n,i,c){if((t=(e.mode&32)!==0)&&(t=!1),t){if(e.flags|=16777216,(c&335544128)===c)if(e.stateNode.complete)e.flags|=8192;else if(yf())e.flags|=8192;else throw Ja=Os,Co}else e.flags&=-16777217}function Ph(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!sg(t))if(yf())e.flags|=8192;else throw Ja=Os,Co}function Ks(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ls():536870912,e.lanes|=t,qi|=t)}function Nr(e,t){if(!Ge)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ct(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags&65011712,i|=c.flags&65011712,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,i|=c.subtreeFlags,i|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function uy(e,t,n){var i=t.pendingProps;switch(yo(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ct(t),null;case 1:return ct(t),null;case 3:return n=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Gn(_t),ye(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ei(t)?Qn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,bo())),ct(t),null;case 26:var c=t.type,h=t.memoizedState;return e===null?(Qn(t),h!==null?(ct(t),Ph(t,h)):(ct(t),cc(t,c,null,i,n))):h?h!==e.memoizedState?(Qn(t),ct(t),Ph(t,h)):(ct(t),t.flags&=-16777217):(e=e.memoizedProps,e!==i&&Qn(t),ct(t),cc(t,c,e,i,n)),null;case 27:if(Ve(t),n=ie.current,c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Qn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return ct(t),null}e=Q.current,Ei(t)?Sd(t):(e=Zf(c,i,n),t.stateNode=e,Qn(t))}return ct(t),null;case 5:if(Ve(t),c=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&Qn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return ct(t),null}if(h=Q.current,Ei(t))Sd(t);else{var y=ll(ie.current);switch(h){case 1:h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":h=y.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":h=y.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":h=y.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof i.is=="string"?y.createElement("select",{is:i.is}):y.createElement("select"),i.multiple?h.multiple=!0:i.size&&(h.size=i.size);break;default:h=typeof i.is=="string"?y.createElement(c,{is:i.is}):y.createElement(c)}}h[bt]=t,h[Bt]=i;e:for(y=t.child;y!==null;){if(y.tag===5||y.tag===6)h.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}t.stateNode=h;e:switch(Ut(h,c,i),c){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Qn(t)}}return ct(t),cc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&Qn(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(l(166));if(e=ie.current,Ei(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,c=Nt,c!==null)switch(c.tag){case 27:case 5:i=c.memoizedProps}e[bt]=t,e=!!(e.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||Hf(e.nodeValue,n)),e||ca(t,!0)}else e=ll(e).createTextNode(i),e[bt]=t,t.stateNode=e}return ct(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(i=Ei(t),n!==null){if(e===null){if(!i)throw Error(l(318));if(e=t.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[bt]=t}else $a(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ct(t),e=!1}else n=bo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(en(t),t):(en(t),null);if((t.flags&128)!==0)throw Error(l(558))}return ct(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(c=Ei(t),i!==null&&i.dehydrated!==null){if(e===null){if(!c)throw Error(l(318));if(c=t.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(l(317));c[bt]=t}else $a(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ct(t),c=!1}else c=bo(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=c),c=!0;if(!c)return t.flags&256?(en(t),t):(en(t),null)}return en(t),(t.flags&128)!==0?(t.lanes=n,t):(n=i!==null,e=e!==null&&e.memoizedState!==null,n&&(i=t.child,c=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(c=i.alternate.memoizedState.cachePool.pool),h=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(h=i.memoizedState.cachePool.pool),h!==c&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Ks(t,t.updateQueue),ct(t),null);case 4:return ye(),e===null&&Rc(t.stateNode.containerInfo),ct(t),null;case 10:return Gn(t.type),ct(t),null;case 19:if(z(yt),i=t.memoizedState,i===null)return ct(t),null;if(c=(t.flags&128)!==0,h=i.rendering,h===null)if(c)Nr(i,!1);else{if(mt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(h=Us(e),h!==null){for(t.flags|=128,Nr(i,!1),e=h.updateQueue,t.updateQueue=e,Ks(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)vd(n,e),n=n.sibling;return K(yt,yt.current&1|2),Ge&&$n(t,i.treeForkCount),t.child}e=e.sibling}i.tail!==null&&Ot()>Fs&&(t.flags|=128,c=!0,Nr(i,!1),t.lanes=4194304)}else{if(!c)if(e=Us(h),e!==null){if(t.flags|=128,c=!0,e=e.updateQueue,t.updateQueue=e,Ks(t,e),Nr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!h.alternate&&!Ge)return ct(t),null}else 2*Ot()-i.renderingStartTime>Fs&&n!==536870912&&(t.flags|=128,c=!0,Nr(i,!1),t.lanes=4194304);i.isBackwards?(h.sibling=t.child,t.child=h):(e=i.last,e!==null?e.sibling=h:t.child=h,i.last=h)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ot(),e.sibling=null,n=yt.current,K(yt,c?n&1|2:n&1),Ge&&$n(t,i.treeForkCount),e):(ct(t),null);case 22:case 23:return en(t),ko(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(n&536870912)!==0&&(t.flags&128)===0&&(ct(t),t.subtreeFlags&6&&(t.flags|=8192)):ct(t),n=t.updateQueue,n!==null&&Ks(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),e!==null&&z(Ka),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Gn(_t),ct(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function dy(e,t){switch(yo(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Gn(_t),ye(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Ve(t),null;case 31:if(t.memoizedState!==null){if(en(t),t.alternate===null)throw Error(l(340));$a()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(en(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));$a()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return z(yt),null;case 4:return ye(),null;case 10:return Gn(t.type),null;case 22:case 23:return en(t),ko(),e!==null&&z(Ka),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Gn(_t),null;case 25:return null;default:return null}}function Gh(e,t){switch(yo(t),t.tag){case 3:Gn(_t),ye();break;case 26:case 27:case 5:Ve(t);break;case 4:ye();break;case 31:t.memoizedState!==null&&en(t);break;case 13:en(t);break;case 19:z(yt);break;case 10:Gn(t.type);break;case 22:case 23:en(t),ko(),e!==null&&z(Ka);break;case 24:Gn(_t)}}function Rr(e,t){try{var n=t.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var c=i.next;n=c;do{if((n.tag&e)===e){i=void 0;var h=n.create,y=n.inst;i=h(),y.destroy=i}n=n.next}while(n!==c)}}catch(_){et(t,t.return,_)}}function ma(e,t,n){try{var i=t.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var h=c.next;i=h;do{if((i.tag&e)===e){var y=i.inst,_=y.destroy;if(_!==void 0){y.destroy=void 0,c=t;var N=n,P=_;try{P()}catch(te){et(c,N,te)}}}i=i.next}while(i!==h)}}catch(te){et(t,t.return,te)}}function Kh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Bd(t,n)}catch(i){et(e,e.return,i)}}}function Yh(e,t,n){n.props=Fa(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){et(e,t,i)}}function kr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof n=="function"?e.refCleanup=n(i):n.current=i}}catch(c){et(e,t,c)}}function Mn(e,t){var n=e.ref,i=e.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(c){et(e,t,c)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(c){et(e,t,c)}else n.current=null}function Jh(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(c){et(e,e.return,c)}}function uc(e,t,n){try{var i=e.stateNode;Uy(i,e.type,n,t),i[Bt]=t}catch(c){et(e,e.return,c)}}function Qh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Sa(e.type)||e.tag===4}function dc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Qh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Sa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hc(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=In));else if(i!==4&&(i===27&&Sa(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(hc(e,t,n),e=e.sibling;e!==null;)hc(e,t,n),e=e.sibling}function Ys(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(i===27&&Sa(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Ys(e,t,n),e=e.sibling;e!==null;)Ys(e,t,n),e=e.sibling}function Xh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,c=t.attributes;c.length;)t.removeAttributeNode(c[0]);Ut(t,i,n),t[bt]=e,t[Bt]=n}catch(h){et(e,e.return,h)}}var Xn=!1,St=!1,fc=!1,Fh=typeof WeakSet=="function"?WeakSet:Set,At=null;function hy(e,t){if(e=e.containerInfo,zc=gl,e=cd(e),ro(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var c=i.anchorOffset,h=i.focusNode;i=i.focusOffset;try{n.nodeType,h.nodeType}catch{n=null;break e}var y=0,_=-1,N=-1,P=0,te=0,le=e,Y=null;t:for(;;){for(var X;le!==n||c!==0&&le.nodeType!==3||(_=y+c),le!==h||i!==0&&le.nodeType!==3||(N=y+i),le.nodeType===3&&(y+=le.nodeValue.length),(X=le.firstChild)!==null;)Y=le,le=X;for(;;){if(le===e)break t;if(Y===n&&++P===c&&(_=y),Y===h&&++te===i&&(N=y),(X=le.nextSibling)!==null)break;le=Y,Y=le.parentNode}le=X}n=_===-1||N===-1?null:{start:_,end:N}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dc={focusedElem:e,selectionRange:n},gl=!1,At=t;At!==null;)if(t=At,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,At=e;else for(;At!==null;){switch(t=At,h=t.alternate,e=t.flags,t.tag){case 0:if((e&4)!==0&&(e=t.updateQueue,e=e!==null?e.events:null,e!==null))for(n=0;n<e.length;n++)c=e[n],c.ref.impl=c.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&h!==null){e=void 0,n=t,c=h.memoizedProps,h=h.memoizedState,i=n.stateNode;try{var je=Fa(n.type,c);e=i.getSnapshotBeforeUpdate(je,h),i.__reactInternalSnapshotBeforeUpdate=e}catch(Ae){et(n,n.return,Ae)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)qc(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,At=e;break}At=t.return}}function Zh(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Zn(e,n),i&4&&Rr(5,n);break;case 1:if(Zn(e,n),i&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(y){et(n,n.return,y)}else{var c=Fa(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(c,t,e.__reactInternalSnapshotBeforeUpdate)}catch(y){et(n,n.return,y)}}i&64&&Kh(n),i&512&&kr(n,n.return);break;case 3:if(Zn(e,n),i&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Bd(e,t)}catch(y){et(n,n.return,y)}}break;case 27:t===null&&i&4&&Xh(n);case 26:case 5:Zn(e,n),t===null&&i&4&&Jh(n),i&512&&kr(n,n.return);break;case 12:Zn(e,n);break;case 31:Zn(e,n),i&4&&tf(e,n);break;case 13:Zn(e,n),i&4&&nf(e,n),i&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=xy.bind(null,n),Hy(e,n))));break;case 22:if(i=n.memoizedState!==null||Xn,!i){t=t!==null&&t.memoizedState!==null||St,c=Xn;var h=St;Xn=i,(St=t)&&!h?Wn(e,n,(n.subtreeFlags&8772)!==0):Zn(e,n),Xn=c,St=h}break;case 30:break;default:Zn(e,n)}}function Wh(e){var t=e.alternate;t!==null&&(e.alternate=null,Wh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var dt=null,Kt=!1;function Fn(e,t,n){for(n=n.child;n!==null;)ef(e,t,n),n=n.sibling}function ef(e,t,n){if(Lt&&typeof Lt.onCommitFiberUnmount=="function")try{Lt.onCommitFiberUnmount(Ua,n)}catch{}switch(n.tag){case 26:St||Mn(n,t),Fn(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:St||Mn(n,t);var i=dt,c=Kt;Sa(n.type)&&(dt=n.stateNode,Kt=!1),Fn(e,t,n),Hr(n.stateNode),dt=i,Kt=c;break;case 5:St||Mn(n,t);case 6:if(i=dt,c=Kt,dt=null,Fn(e,t,n),dt=i,Kt=c,dt!==null)if(Kt)try{(dt.nodeType===9?dt.body:dt.nodeName==="HTML"?dt.ownerDocument.body:dt).removeChild(n.stateNode)}catch(h){et(n,t,h)}else try{dt.removeChild(n.stateNode)}catch(h){et(n,t,h)}break;case 18:dt!==null&&(Kt?(e=dt,Yf(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Ki(e)):Yf(dt,n.stateNode));break;case 4:i=dt,c=Kt,dt=n.stateNode.containerInfo,Kt=!0,Fn(e,t,n),dt=i,Kt=c;break;case 0:case 11:case 14:case 15:ma(2,n,t),St||ma(4,n,t),Fn(e,t,n);break;case 1:St||(Mn(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Yh(n,t,i)),Fn(e,t,n);break;case 21:Fn(e,t,n);break;case 22:St=(i=St)||n.memoizedState!==null,Fn(e,t,n),St=i;break;default:Fn(e,t,n)}}function tf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Ki(e)}catch(n){et(t,t.return,n)}}}function nf(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ki(e)}catch(n){et(t,t.return,n)}}function fy(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Fh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Fh),t;default:throw Error(l(435,e.tag))}}function Js(e,t){var n=fy(e);t.forEach(function(i){if(!n.has(i)){n.add(i);var c=jy.bind(null,e,i);i.then(c,c)}})}function Yt(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var c=n[i],h=e,y=t,_=y;e:for(;_!==null;){switch(_.tag){case 27:if(Sa(_.type)){dt=_.stateNode,Kt=!1;break e}break;case 5:dt=_.stateNode,Kt=!1;break e;case 3:case 4:dt=_.stateNode.containerInfo,Kt=!0;break e}_=_.return}if(dt===null)throw Error(l(160));ef(h,y,c),dt=null,Kt=!1,h=c.alternate,h!==null&&(h.return=null),c.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)af(t,e),t=t.sibling}var Sn=null;function af(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Yt(t,e),Jt(e),i&4&&(ma(3,e,e.return),Rr(3,e),ma(5,e,e.return));break;case 1:Yt(t,e),Jt(e),i&512&&(St||n===null||Mn(n,n.return)),i&64&&Xn&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var c=Sn;if(Yt(t,e),Jt(e),i&512&&(St||n===null||Mn(n,n.return)),i&4){var h=n!==null?n.memoizedState:null;if(i=e.memoizedState,n===null)if(i===null)if(e.stateNode===null){e:{i=e.type,n=e.memoizedProps,c=c.ownerDocument||c;t:switch(i){case"title":h=c.getElementsByTagName("title")[0],(!h||h[ge]||h[bt]||h.namespaceURI==="http://www.w3.org/2000/svg"||h.hasAttribute("itemprop"))&&(h=c.createElement(i),c.head.insertBefore(h,c.querySelector("head > title"))),Ut(h,i,n),h[bt]=e,Se(h),i=h;break e;case"link":var y=ig("link","href",c).get(i+(n.href||""));if(y){for(var _=0;_<y.length;_++)if(h=y[_],h.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&h.getAttribute("rel")===(n.rel==null?null:n.rel)&&h.getAttribute("title")===(n.title==null?null:n.title)&&h.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){y.splice(_,1);break t}}h=c.createElement(i),Ut(h,i,n),c.head.appendChild(h);break;case"meta":if(y=ig("meta","content",c).get(i+(n.content||""))){for(_=0;_<y.length;_++)if(h=y[_],h.getAttribute("content")===(n.content==null?null:""+n.content)&&h.getAttribute("name")===(n.name==null?null:n.name)&&h.getAttribute("property")===(n.property==null?null:n.property)&&h.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&h.getAttribute("charset")===(n.charSet==null?null:n.charSet)){y.splice(_,1);break t}}h=c.createElement(i),Ut(h,i,n),c.head.appendChild(h);break;default:throw Error(l(468,i))}h[bt]=e,Se(h),i=h}e.stateNode=i}else rg(c,e.type,e.stateNode);else e.stateNode=ag(c,i,e.memoizedProps);else h!==i?(h===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):h.count--,i===null?rg(c,e.type,e.stateNode):ag(c,i,e.memoizedProps)):i===null&&e.stateNode!==null&&uc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Yt(t,e),Jt(e),i&512&&(St||n===null||Mn(n,n.return)),n!==null&&i&4&&uc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Yt(t,e),Jt(e),i&512&&(St||n===null||Mn(n,n.return)),e.flags&32){c=e.stateNode;try{pi(c,"")}catch(je){et(e,e.return,je)}}i&4&&e.stateNode!=null&&(c=e.memoizedProps,uc(e,c,n!==null?n.memoizedProps:c)),i&1024&&(fc=!0);break;case 6:if(Yt(t,e),Jt(e),i&4){if(e.stateNode===null)throw Error(l(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(je){et(e,e.return,je)}}break;case 3:if(ul=null,c=Sn,Sn=ol(t.containerInfo),Yt(t,e),Sn=c,Jt(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Ki(t.containerInfo)}catch(je){et(e,e.return,je)}fc&&(fc=!1,rf(e));break;case 4:i=Sn,Sn=ol(e.stateNode.containerInfo),Yt(t,e),Jt(e),Sn=i;break;case 12:Yt(t,e),Jt(e);break;case 31:Yt(t,e),Jt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Js(e,i)));break;case 13:Yt(t,e),Jt(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Xs=Ot()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Js(e,i)));break;case 22:c=e.memoizedState!==null;var N=n!==null&&n.memoizedState!==null,P=Xn,te=St;if(Xn=P||c,St=te||N,Yt(t,e),St=te,Xn=P,Jt(e),i&8192)e:for(t=e.stateNode,t._visibility=c?t._visibility&-2:t._visibility|1,c&&(n===null||N||Xn||St||Za(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){N=n=t;try{if(h=N.stateNode,c)y=h.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{_=N.stateNode;var le=N.memoizedProps.style,Y=le!=null&&le.hasOwnProperty("display")?le.display:null;_.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(je){et(N,N.return,je)}}}else if(t.tag===6){if(n===null){N=t;try{N.stateNode.nodeValue=c?"":N.memoizedProps}catch(je){et(N,N.return,je)}}}else if(t.tag===18){if(n===null){N=t;try{var X=N.stateNode;c?Jf(X,!0):Jf(N.stateNode,!1)}catch(je){et(N,N.return,je)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,Js(e,n))));break;case 19:Yt(t,e),Jt(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,Js(e,i)));break;case 30:break;case 21:break;default:Yt(t,e),Jt(e)}}function Jt(e){var t=e.flags;if(t&2){try{for(var n,i=e.return;i!==null;){if(Qh(i)){n=i;break}i=i.return}if(n==null)throw Error(l(160));switch(n.tag){case 27:var c=n.stateNode,h=dc(e);Ys(e,h,c);break;case 5:var y=n.stateNode;n.flags&32&&(pi(y,""),n.flags&=-33);var _=dc(e);Ys(e,_,y);break;case 3:case 4:var N=n.stateNode.containerInfo,P=dc(e);hc(e,P,N);break;default:throw Error(l(161))}}catch(te){et(e,e.return,te)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function rf(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;rf(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Zn(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Zh(e,t.alternate,t),t=t.sibling}function Za(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ma(4,t,t.return),Za(t);break;case 1:Mn(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&Yh(t,t.return,n),Za(t);break;case 27:Hr(t.stateNode);case 26:case 5:Mn(t,t.return),Za(t);break;case 22:t.memoizedState===null&&Za(t);break;case 30:Za(t);break;default:Za(t)}e=e.sibling}}function Wn(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,c=e,h=t,y=h.flags;switch(h.tag){case 0:case 11:case 15:Wn(c,h,n),Rr(4,h);break;case 1:if(Wn(c,h,n),i=h,c=i.stateNode,typeof c.componentDidMount=="function")try{c.componentDidMount()}catch(P){et(i,i.return,P)}if(i=h,c=i.updateQueue,c!==null){var _=i.stateNode;try{var N=c.shared.hiddenCallbacks;if(N!==null)for(c.shared.hiddenCallbacks=null,c=0;c<N.length;c++)Dd(N[c],_)}catch(P){et(i,i.return,P)}}n&&y&64&&Kh(h),kr(h,h.return);break;case 27:Xh(h);case 26:case 5:Wn(c,h,n),n&&i===null&&y&4&&Jh(h),kr(h,h.return);break;case 12:Wn(c,h,n);break;case 31:Wn(c,h,n),n&&y&4&&tf(c,h);break;case 13:Wn(c,h,n),n&&y&4&&nf(c,h);break;case 22:h.memoizedState===null&&Wn(c,h,n),kr(h,h.return);break;case 30:break;default:Wn(c,h,n)}t=t.sibling}}function gc(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&vr(n))}function pc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&vr(e))}function wn(e,t,n,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)sf(e,t,n,i),t=t.sibling}function sf(e,t,n,i){var c=t.flags;switch(t.tag){case 0:case 11:case 15:wn(e,t,n,i),c&2048&&Rr(9,t);break;case 1:wn(e,t,n,i);break;case 3:wn(e,t,n,i),c&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&vr(e)));break;case 12:if(c&2048){wn(e,t,n,i),e=t.stateNode;try{var h=t.memoizedProps,y=h.id,_=h.onPostCommit;typeof _=="function"&&_(y,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(N){et(t,t.return,N)}}else wn(e,t,n,i);break;case 31:wn(e,t,n,i);break;case 13:wn(e,t,n,i);break;case 23:break;case 22:h=t.stateNode,y=t.alternate,t.memoizedState!==null?h._visibility&2?wn(e,t,n,i):Ur(e,t):h._visibility&2?wn(e,t,n,i):(h._visibility|=2,Di(e,t,n,i,(t.subtreeFlags&10256)!==0||!1)),c&2048&&gc(y,t);break;case 24:wn(e,t,n,i),c&2048&&pc(t.alternate,t);break;default:wn(e,t,n,i)}}function Di(e,t,n,i,c){for(c=c&&((t.subtreeFlags&10256)!==0||!1),t=t.child;t!==null;){var h=e,y=t,_=n,N=i,P=y.flags;switch(y.tag){case 0:case 11:case 15:Di(h,y,_,N,c),Rr(8,y);break;case 23:break;case 22:var te=y.stateNode;y.memoizedState!==null?te._visibility&2?Di(h,y,_,N,c):Ur(h,y):(te._visibility|=2,Di(h,y,_,N,c)),c&&P&2048&&gc(y.alternate,y);break;case 24:Di(h,y,_,N,c),c&&P&2048&&pc(y.alternate,y);break;default:Di(h,y,_,N,c)}t=t.sibling}}function Ur(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,i=t,c=i.flags;switch(i.tag){case 22:Ur(n,i),c&2048&&gc(i.alternate,i);break;case 24:Ur(n,i),c&2048&&pc(i.alternate,i);break;default:Ur(n,i)}t=t.sibling}}var zr=8192;function Bi(e,t,n){if(e.subtreeFlags&zr)for(e=e.child;e!==null;)lf(e,t,n),e=e.sibling}function lf(e,t,n){switch(e.tag){case 26:Bi(e,t,n),e.flags&zr&&e.memoizedState!==null&&Wy(n,Sn,e.memoizedState,e.memoizedProps);break;case 5:Bi(e,t,n);break;case 3:case 4:var i=Sn;Sn=ol(e.stateNode.containerInfo),Bi(e,t,n),Sn=i;break;case 22:e.memoizedState===null&&(i=e.alternate,i!==null&&i.memoizedState!==null?(i=zr,zr=16777216,Bi(e,t,n),zr=i):Bi(e,t,n));break;default:Bi(e,t,n)}}function of(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function Dr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];At=i,uf(i,e)}of(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)cf(e),e=e.sibling}function cf(e){switch(e.tag){case 0:case 11:case 15:Dr(e),e.flags&2048&&ma(9,e,e.return);break;case 3:Dr(e);break;case 12:Dr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Qs(e)):Dr(e);break;default:Dr(e)}}function Qs(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var i=t[n];At=i,uf(i,e)}of(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ma(8,t,t.return),Qs(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Qs(t));break;default:Qs(t)}e=e.sibling}}function uf(e,t){for(;At!==null;){var n=At;switch(n.tag){case 0:case 11:case 15:ma(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:vr(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,At=i;else e:for(n=e;At!==null;){i=At;var c=i.sibling,h=i.return;if(Wh(i),i===n){At=null;break e}if(c!==null){c.return=h,At=c;break e}At=h}}}var gy={getCacheForType:function(e){var t=Rt(_t),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Rt(_t).controller.signal}},py=typeof WeakMap=="function"?WeakMap:Map,Fe=0,rt=null,Ie=null,$e=0,We=0,tn=null,ya=!1,Mi=!1,mc=!1,ea=0,mt=0,va=0,Wa=0,yc=0,nn=0,qi=0,Br=null,Qt=null,vc=!1,Xs=0,df=0,Fs=1/0,Zs=null,ba=null,Ct=0,_a=null,Li=null,ta=0,bc=0,_c=null,hf=null,Mr=0,xc=null;function an(){return(Fe&2)!==0&&$e!==0?$e&-$e:D.T!==null?Tc():sr()}function ff(){if(nn===0)if(($e&536870912)===0||Ge){var e=ln;ln<<=1,(ln&3932160)===0&&(ln=262144),nn=e}else nn=536870912;return e=Wt.current,e!==null&&(e.flags|=32),nn}function Xt(e,t,n){(e===rt&&(We===2||We===9)||e.cancelPendingCommit!==null)&&(Ii(e,0),xa(e,$e,nn,!1)),Rn(e,n),((Fe&2)===0||e!==rt)&&(e===rt&&((Fe&2)===0&&(Wa|=n),mt===4&&xa(e,$e,nn,!1)),qn(e))}function gf(e,t,n){if((Fe&6)!==0)throw Error(l(327));var i=!n&&(t&127)===0&&(t&e.expiredLanes)===0||za(e,t),c=i?vy(e,t):Sc(e,t,!0),h=i;do{if(c===0){Mi&&!i&&xa(e,t,0,!1);break}else{if(n=e.current.alternate,h&&!my(n)){c=Sc(e,t,!1),h=!1;continue}if(c===2){if(h=t,e.errorRecoveryDisabledLanes&h)var y=0;else y=e.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){t=y;e:{var _=e;c=Br;var N=_.current.memoizedState.isDehydrated;if(N&&(Ii(_,y).flags|=256),y=Sc(_,y,!1),y!==2){if(mc&&!N){_.errorRecoveryDisabledLanes|=h,Wa|=h,c=4;break e}h=Qt,Qt=c,h!==null&&(Qt===null?Qt=h:Qt.push.apply(Qt,h))}c=y}if(h=!1,c!==2)continue}}if(c===1){Ii(e,0),xa(e,t,0,!0);break}e:{switch(i=e,h=c,h){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:xa(i,t,nn,!ya);break e;case 2:Qt=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(c=Xs+300-Ot(),10<c)){if(xa(i,t,nn,!ya),di(i,0,!0)!==0)break e;ta=t,i.timeoutHandle=Gf(pf.bind(null,i,n,Qt,Zs,vc,t,nn,Wa,qi,ya,h,"Throttled",-0,0),c);break e}pf(i,n,Qt,Zs,vc,t,nn,Wa,qi,ya,h,null,-0,0)}}break}while(!0);qn(e)}function pf(e,t,n,i,c,h,y,_,N,P,te,le,Y,X){if(e.timeoutHandle=-1,le=t.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:In},lf(t,h,le);var je=(h&62914560)===h?Xs-Ot():(h&4194048)===h?df-Ot():0;if(je=ev(le,je),je!==null){ta=h,e.cancelPendingCommit=je(Sf.bind(null,e,t,h,n,i,c,y,_,N,te,le,null,Y,X)),xa(e,h,y,!P);return}}Sf(e,t,h,n,i,c,y,_,N)}function my(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var c=n[i],h=c.getSnapshot;c=c.value;try{if(!Ft(h(),c))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xa(e,t,n,i){t&=~yc,t&=~Wa,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var c=t;0<c;){var h=31-It(c),y=1<<h;i[h]=-1,c&=~y}n!==0&&os(e,n,t)}function Ws(){return(Fe&6)===0?(qr(0),!1):!0}function jc(){if(Ie!==null){if(We===0)var e=Ie.return;else e=Ie,Pn=Pa=null,qo(e),Ni=null,_r=0,e=Ie;for(;e!==null;)Gh(e.alternate,e),e=e.return;Ie=null}}function Ii(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,By(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),ta=0,jc(),rt=e,Ie=n=Vn(e.current,null),$e=t,We=0,tn=null,ya=!1,Mi=za(e,t),mc=!1,qi=nn=yc=Wa=va=mt=0,Qt=Br=null,vc=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var c=31-It(i),h=1<<c;t|=e[c],i&=~h}return ea=t,_s(),n}function mf(e,t){Me=null,D.H=Ar,t===Oi||t===As?(t=Rd(),We=3):t===Co?(t=Rd(),We=4):We=t===ec?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,tn=t,Ie===null&&(mt=1,Vs(e,dn(t,e.current)))}function yf(){var e=Wt.current;return e===null?!0:($e&4194048)===$e?pn===null:($e&62914560)===$e||($e&536870912)!==0?e===pn:!1}function vf(){var e=D.H;return D.H=Ar,e===null?Ar:e}function bf(){var e=D.A;return D.A=gy,e}function el(){mt=4,ya||($e&4194048)!==$e&&Wt.current!==null||(Mi=!0),(va&134217727)===0&&(Wa&134217727)===0||rt===null||xa(rt,$e,nn,!1)}function Sc(e,t,n){var i=Fe;Fe|=2;var c=vf(),h=bf();(rt!==e||$e!==t)&&(Zs=null,Ii(e,t)),t=!1;var y=mt;e:do try{if(We!==0&&Ie!==null){var _=Ie,N=tn;switch(We){case 8:jc(),y=6;break e;case 3:case 2:case 9:case 6:Wt.current===null&&(t=!0);var P=We;if(We=0,tn=null,Hi(e,_,N,P),n&&Mi){y=0;break e}break;default:P=We,We=0,tn=null,Hi(e,_,N,P)}}yy(),y=mt;break}catch(te){mf(e,te)}while(!0);return t&&e.shellSuspendCounter++,Pn=Pa=null,Fe=i,D.H=c,D.A=h,Ie===null&&(rt=null,$e=0,_s()),y}function yy(){for(;Ie!==null;)_f(Ie)}function vy(e,t){var n=Fe;Fe|=2;var i=vf(),c=bf();rt!==e||$e!==t?(Zs=null,Fs=Ot()+500,Ii(e,t)):Mi=za(e,t);e:do try{if(We!==0&&Ie!==null){t=Ie;var h=tn;t:switch(We){case 1:We=0,tn=null,Hi(e,t,h,1);break;case 2:case 9:if(Od(h)){We=0,tn=null,xf(t);break}t=function(){We!==2&&We!==9||rt!==e||(We=7),qn(e)},h.then(t,t);break e;case 3:We=7;break e;case 4:We=5;break e;case 7:Od(h)?(We=0,tn=null,xf(t)):(We=0,tn=null,Hi(e,t,h,7));break;case 5:var y=null;switch(Ie.tag){case 26:y=Ie.memoizedState;case 5:case 27:var _=Ie;if(y?sg(y):_.stateNode.complete){We=0,tn=null;var N=_.sibling;if(N!==null)Ie=N;else{var P=_.return;P!==null?(Ie=P,tl(P)):Ie=null}break t}}We=0,tn=null,Hi(e,t,h,5);break;case 6:We=0,tn=null,Hi(e,t,h,6);break;case 8:jc(),mt=6;break e;default:throw Error(l(462))}}by();break}catch(te){mf(e,te)}while(!0);return Pn=Pa=null,D.H=i,D.A=c,Fe=n,Ie!==null?0:(rt=null,$e=0,_s(),mt)}function by(){for(;Ie!==null&&!An();)_f(Ie)}function _f(e){var t=$h(e.alternate,e,ea);e.memoizedProps=e.pendingProps,t===null?tl(e):Ie=t}function xf(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Mh(n,t,t.pendingProps,t.type,void 0,$e);break;case 11:t=Mh(n,t,t.pendingProps,t.type.render,t.ref,$e);break;case 5:qo(t);default:Gh(n,t),t=Ie=vd(t,ea),t=$h(n,t,ea)}e.memoizedProps=e.pendingProps,t===null?tl(e):Ie=t}function Hi(e,t,n,i){Pn=Pa=null,qo(t),Ni=null,_r=0;var c=t.return;try{if(ly(e,c,t,n,$e)){mt=1,Vs(e,dn(n,e.current)),Ie=null;return}}catch(h){if(c!==null)throw Ie=c,h;mt=1,Vs(e,dn(n,e.current)),Ie=null;return}t.flags&32768?(Ge||i===1?e=!0:Mi||($e&536870912)!==0?e=!1:(ya=e=!0,(i===2||i===9||i===3||i===6)&&(i=Wt.current,i!==null&&i.tag===13&&(i.flags|=16384))),jf(t,e)):tl(t)}function tl(e){var t=e;do{if((t.flags&32768)!==0){jf(t,ya);return}e=t.return;var n=uy(t.alternate,t,ea);if(n!==null){Ie=n;return}if(t=t.sibling,t!==null){Ie=t;return}Ie=t=e}while(t!==null);mt===0&&(mt=5)}function jf(e,t){do{var n=dy(e.alternate,e);if(n!==null){n.flags&=32767,Ie=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Ie=e;return}Ie=e=n}while(e!==null);mt=6,Ie=null}function Sf(e,t,n,i,c,h,y,_,N){e.cancelPendingCommit=null;do nl();while(Ct!==0);if((Fe&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(h=t.lanes|t.childLanes,h|=uo,Vl(e,n,h,y,_,N),e===rt&&(Ie=rt=null,$e=0),Li=t,_a=e,ta=n,bc=h,_c=c,hf=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Sy(ka,function(){return Af(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=D.T,D.T=null,c=L.p,L.p=2,y=Fe,Fe|=4;try{hy(e,t,n)}finally{Fe=y,L.p=c,D.T=i}}Ct=1,wf(),Ef(),Cf()}}function wf(){if(Ct===1){Ct=0;var e=_a,t=Li,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=D.T,D.T=null;var i=L.p;L.p=2;var c=Fe;Fe|=4;try{af(t,e);var h=Dc,y=cd(e.containerInfo),_=h.focusedElem,N=h.selectionRange;if(y!==_&&_&&_.ownerDocument&&od(_.ownerDocument.documentElement,_)){if(N!==null&&ro(_)){var P=N.start,te=N.end;if(te===void 0&&(te=P),"selectionStart"in _)_.selectionStart=P,_.selectionEnd=Math.min(te,_.value.length);else{var le=_.ownerDocument||document,Y=le&&le.defaultView||window;if(Y.getSelection){var X=Y.getSelection(),je=_.textContent.length,Ae=Math.min(N.start,je),at=N.end===void 0?Ae:Math.min(N.end,je);!X.extend&&Ae>at&&(y=at,at=Ae,Ae=y);var I=ld(_,Ae),R=ld(_,at);if(I&&R&&(X.rangeCount!==1||X.anchorNode!==I.node||X.anchorOffset!==I.offset||X.focusNode!==R.node||X.focusOffset!==R.offset)){var $=le.createRange();$.setStart(I.node,I.offset),X.removeAllRanges(),Ae>at?(X.addRange($),X.extend(R.node,R.offset)):($.setEnd(R.node,R.offset),X.addRange($))}}}}for(le=[],X=_;X=X.parentNode;)X.nodeType===1&&le.push({element:X,left:X.scrollLeft,top:X.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<le.length;_++){var ae=le[_];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}gl=!!zc,Dc=zc=null}finally{Fe=c,L.p=i,D.T=n}}e.current=t,Ct=2}}function Ef(){if(Ct===2){Ct=0;var e=_a,t=Li,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=D.T,D.T=null;var i=L.p;L.p=2;var c=Fe;Fe|=4;try{Zh(e,t.alternate,t)}finally{Fe=c,L.p=i,D.T=n}}Ct=3}}function Cf(){if(Ct===4||Ct===3){Ct=0,Ml();var e=_a,t=Li,n=ta,i=hf;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Ct=5:(Ct=0,Li=_a=null,Tf(e,e.pendingLanes));var c=e.pendingLanes;if(c===0&&(ba=null),Ba(n),t=t.stateNode,Lt&&typeof Lt.onCommitFiberRoot=="function")try{Lt.onCommitFiberRoot(Ua,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=D.T,c=L.p,L.p=2,D.T=null;try{for(var h=e.onRecoverableError,y=0;y<i.length;y++){var _=i[y];h(_.value,{componentStack:_.stack})}}finally{D.T=t,L.p=c}}(ta&3)!==0&&nl(),qn(e),c=e.pendingLanes,(n&261930)!==0&&(c&42)!==0?e===xc?Mr++:(Mr=0,xc=e):Mr=0,qr(0)}}function Tf(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,vr(t)))}function nl(){return wf(),Ef(),Cf(),Af()}function Af(){if(Ct!==5)return!1;var e=_a,t=bc;bc=0;var n=Ba(ta),i=D.T,c=L.p;try{L.p=32>n?32:n,D.T=null,n=_c,_c=null;var h=_a,y=ta;if(Ct=0,Li=_a=null,ta=0,(Fe&6)!==0)throw Error(l(331));var _=Fe;if(Fe|=4,cf(h.current),sf(h,h.current,y,n),Fe=_,qr(0,!1),Lt&&typeof Lt.onPostCommitFiberRoot=="function")try{Lt.onPostCommitFiberRoot(Ua,h)}catch{}return!0}finally{L.p=c,D.T=i,Tf(e,t)}}function Of(e,t,n){t=dn(n,t),t=Wo(e.stateNode,t,2),e=fa(e,t,2),e!==null&&(Rn(e,2),qn(e))}function et(e,t,n){if(e.tag===3)Of(e,e,n);else for(;t!==null;){if(t.tag===3){Of(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ba===null||!ba.has(i))){e=dn(n,e),n=Oh(2),i=fa(t,n,2),i!==null&&(Nh(n,i,t,e),Rn(i,2),qn(i));break}}t=t.return}}function wc(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new py;var c=new Set;i.set(t,c)}else c=i.get(t),c===void 0&&(c=new Set,i.set(t,c));c.has(n)||(mc=!0,c.add(n),e=_y.bind(null,e,t,n),t.then(e,e))}function _y(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rt===e&&($e&n)===n&&(mt===4||mt===3&&($e&62914560)===$e&&300>Ot()-Xs?(Fe&2)===0&&Ii(e,0):yc|=n,qi===$e&&(qi=0)),qn(e)}function Nf(e,t){t===0&&(t=ls()),e=Ha(e,t),e!==null&&(Rn(e,t),qn(e))}function xy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Nf(e,n)}function jy(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(t),Nf(e,n)}function Sy(e,t){return lt(e,t)}var al=null,Vi=null,Ec=!1,il=!1,Cc=!1,ja=0;function qn(e){e!==Vi&&e.next===null&&(Vi===null?al=Vi=e:Vi=Vi.next=e),il=!0,Ec||(Ec=!0,Ey())}function qr(e,t){if(!Cc&&il){Cc=!0;do for(var n=!1,i=al;i!==null;){if(e!==0){var c=i.pendingLanes;if(c===0)var h=0;else{var y=i.suspendedLanes,_=i.pingedLanes;h=(1<<31-It(42|e)+1)-1,h&=c&~(y&~_),h=h&201326741?h&201326741|1:h?h|2:0}h!==0&&(n=!0,zf(i,h))}else h=$e,h=di(i,i===rt?h:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(h&3)===0||za(i,h)||(n=!0,zf(i,h));i=i.next}while(n);Cc=!1}}function wy(){Rf()}function Rf(){il=Ec=!1;var e=0;ja!==0&&Dy()&&(e=ja);for(var t=Ot(),n=null,i=al;i!==null;){var c=i.next,h=kf(i,t);h===0?(i.next=null,n===null?al=c:n.next=c,c===null&&(Vi=n)):(n=i,(e!==0||(h&3)!==0)&&(il=!0)),i=c}Ct!==0&&Ct!==5||qr(e),ja!==0&&(ja=0)}function kf(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,c=e.expirationTimes,h=e.pendingLanes&-62914561;0<h;){var y=31-It(h),_=1<<y,N=c[y];N===-1?((_&n)===0||(_&i)!==0)&&(c[y]=ir(_,t)):N<=t&&(e.expiredLanes|=_),h&=~_}if(t=rt,n=$e,n=di(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,n===0||e===t&&(We===2||We===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&ut(i),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||za(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(i!==null&&ut(i),Ba(n)){case 2:case 8:n=as;break;case 32:n=ka;break;case 268435456:n=is;break;default:n=ka}return i=Uf.bind(null,e),n=lt(n,i),e.callbackPriority=t,e.callbackNode=n,t}return i!==null&&i!==null&&ut(i),e.callbackPriority=2,e.callbackNode=null,2}function Uf(e,t){if(Ct!==0&&Ct!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(nl()&&e.callbackNode!==n)return null;var i=$e;return i=di(e,e===rt?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(gf(e,i,t),kf(e,Ot()),e.callbackNode!=null&&e.callbackNode===n?Uf.bind(null,e):null)}function zf(e,t){if(nl())return null;gf(e,t,!0)}function Ey(){My(function(){(Fe&6)!==0?lt(oi,wy):Rf()})}function Tc(){if(ja===0){var e=Ti;e===0&&(e=ui,ui<<=1,(ui&261888)===0&&(ui=256)),ja=e}return ja}function Df(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:hs(""+e)}function Bf(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Cy(e,t,n,i,c){if(t==="submit"&&n&&n.stateNode===c){var h=Df((c[Bt]||null).action),y=i.submitter;y&&(t=(t=y[Bt]||null)?Df(t.formAction):y.getAttribute("formAction"),t!==null&&(h=t,y=null));var _=new ms("action","action",null,i,c);e.push({event:_,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(ja!==0){var N=y?Bf(c,y):new FormData(c);Yo(n,{pending:!0,data:N,method:c.method,action:h},null,N)}}else typeof h=="function"&&(_.preventDefault(),N=y?Bf(c,y):new FormData(c),Yo(n,{pending:!0,data:N,method:c.method,action:h},h,N))},currentTarget:c}]})}}for(var Ac=0;Ac<co.length;Ac++){var Oc=co[Ac],Ty=Oc.toLowerCase(),Ay=Oc[0].toUpperCase()+Oc.slice(1);jn(Ty,"on"+Ay)}jn(hd,"onAnimationEnd"),jn(fd,"onAnimationIteration"),jn(gd,"onAnimationStart"),jn("dblclick","onDoubleClick"),jn("focusin","onFocus"),jn("focusout","onBlur"),jn(Pm,"onTransitionRun"),jn(Gm,"onTransitionStart"),jn(Km,"onTransitionCancel"),jn(pd,"onTransitionEnd"),Xe("onMouseEnter",["mouseout","mouseover"]),Xe("onMouseLeave",["mouseout","mouseover"]),Xe("onPointerEnter",["pointerout","pointerover"]),Xe("onPointerLeave",["pointerout","pointerover"]),Ze("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ze("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ze("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ze("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oy=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lr));function Mf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],c=i.event;i=i.listeners;e:{var h=void 0;if(t)for(var y=i.length-1;0<=y;y--){var _=i[y],N=_.instance,P=_.currentTarget;if(_=_.listener,N!==h&&c.isPropagationStopped())break e;h=_,c.currentTarget=P;try{h(c)}catch(te){bs(te)}c.currentTarget=null,h=N}else for(y=0;y<i.length;y++){if(_=i[y],N=_.instance,P=_.currentTarget,_=_.listener,N!==h&&c.isPropagationStopped())break e;h=_,c.currentTarget=P;try{h(c)}catch(te){bs(te)}c.currentTarget=null,h=N}}}}function He(e,t){var n=t[V];n===void 0&&(n=t[V]=new Set);var i=e+"__bubble";n.has(i)||(qf(t,e,2,!1),n.add(i))}function Nc(e,t,n){var i=0;t&&(i|=4),qf(n,e,i,t)}var rl="_reactListening"+Math.random().toString(36).slice(2);function Rc(e){if(!e[rl]){e[rl]=!0,Be.forEach(function(n){n!=="selectionchange"&&(Oy.has(n)||Nc(n,!1,e),Nc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[rl]||(t[rl]=!0,Nc("selectionchange",!1,t))}}function qf(e,t,n,i){switch(fg(t)){case 2:var c=av;break;case 8:c=iv;break;default:c=Kc}n=c.bind(null,t,n,e),c=void 0,!Xl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),i?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function kc(e,t,n,i,c){var h=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var y=i.tag;if(y===3||y===4){var _=i.stateNode.containerInfo;if(_===c)break;if(y===4)for(y=i.return;y!==null;){var N=y.tag;if((N===3||N===4)&&y.stateNode.containerInfo===c)return;y=y.return}for(;_!==null;){if(y=ve(_),y===null)return;if(N=y.tag,N===5||N===6||N===26||N===27){i=h=y;continue e}_=_.parentNode}}i=i.return}Vu(function(){var P=h,te=Jl(n),le=[];e:{var Y=md.get(e);if(Y!==void 0){var X=ms,je=e;switch(e){case"keypress":if(gs(n)===0)break e;case"keydown":case"keyup":X=jm;break;case"focusin":je="focus",X=eo;break;case"focusout":je="blur",X=eo;break;case"beforeblur":case"afterblur":X=eo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":X=Gu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":X=um;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":X=Em;break;case hd:case fd:case gd:X=fm;break;case pd:X=Tm;break;case"scroll":case"scrollend":X=om;break;case"wheel":X=Om;break;case"copy":case"cut":case"paste":X=pm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":X=Yu;break;case"toggle":case"beforetoggle":X=Rm}var Ae=(t&4)!==0,at=!Ae&&(e==="scroll"||e==="scrollend"),I=Ae?Y!==null?Y+"Capture":null:Y;Ae=[];for(var R=P,$;R!==null;){var ae=R;if($=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||$===null||I===null||(ae=lr(R,I),ae!=null&&Ae.push(Ir(R,ae,$))),at)break;R=R.return}0<Ae.length&&(Y=new X(Y,je,null,n,te),le.push({event:Y,listeners:Ae}))}}if((t&7)===0){e:{if(Y=e==="mouseover"||e==="pointerover",X=e==="mouseout"||e==="pointerout",Y&&n!==Yl&&(je=n.relatedTarget||n.fromElement)&&(ve(je)||je[ia]))break e;if((X||Y)&&(Y=te.window===te?te:(Y=te.ownerDocument)?Y.defaultView||Y.parentWindow:window,X?(je=n.relatedTarget||n.toElement,X=P,je=je?ve(je):null,je!==null&&(at=d(je),Ae=je.tag,je!==at||Ae!==5&&Ae!==27&&Ae!==6)&&(je=null)):(X=null,je=P),X!==je)){if(Ae=Gu,ae="onMouseLeave",I="onMouseEnter",R="mouse",(e==="pointerout"||e==="pointerover")&&(Ae=Yu,ae="onPointerLeave",I="onPointerEnter",R="pointer"),at=X==null?Y:ce(X),$=je==null?Y:ce(je),Y=new Ae(ae,R+"leave",X,n,te),Y.target=at,Y.relatedTarget=$,ae=null,ve(te)===P&&(Ae=new Ae(I,R+"enter",je,n,te),Ae.target=$,Ae.relatedTarget=at,ae=Ae),at=ae,X&&je)t:{for(Ae=Ny,I=X,R=je,$=0,ae=I;ae;ae=Ae(ae))$++;ae=0;for(var Te=R;Te;Te=Ae(Te))ae++;for(;0<$-ae;)I=Ae(I),$--;for(;0<ae-$;)R=Ae(R),ae--;for(;$--;){if(I===R||R!==null&&I===R.alternate){Ae=I;break t}I=Ae(I),R=Ae(R)}Ae=null}else Ae=null;X!==null&&Lf(le,Y,X,Ae,!1),je!==null&&at!==null&&Lf(le,at,je,Ae,!0)}}e:{if(Y=P?ce(P):window,X=Y.nodeName&&Y.nodeName.toLowerCase(),X==="select"||X==="input"&&Y.type==="file")var Ye=td;else if(Wu(Y))if(nd)Ye=Hm;else{Ye=Lm;var we=qm}else X=Y.nodeName,!X||X.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?P&&Kl(P.elementType)&&(Ye=td):Ye=Im;if(Ye&&(Ye=Ye(e,P))){ed(le,Ye,n,te);break e}we&&we(e,Y,P),e==="focusout"&&P&&Y.type==="number"&&P.memoizedProps.value!=null&&Gl(Y,"number",Y.value)}switch(we=P?ce(P):window,e){case"focusin":(Wu(we)||we.contentEditable==="true")&&(bi=we,so=P,pr=null);break;case"focusout":pr=so=bi=null;break;case"mousedown":lo=!0;break;case"contextmenu":case"mouseup":case"dragend":lo=!1,ud(le,n,te);break;case"selectionchange":if($m)break;case"keydown":case"keyup":ud(le,n,te)}var qe;if(no)e:{switch(e){case"compositionstart":var Pe="onCompositionStart";break e;case"compositionend":Pe="onCompositionEnd";break e;case"compositionupdate":Pe="onCompositionUpdate";break e}Pe=void 0}else vi?Fu(e,n)&&(Pe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Pe="onCompositionStart");Pe&&(Ju&&n.locale!=="ko"&&(vi||Pe!=="onCompositionStart"?Pe==="onCompositionEnd"&&vi&&(qe=$u()):(sa=te,Fl="value"in sa?sa.value:sa.textContent,vi=!0)),we=sl(P,Pe),0<we.length&&(Pe=new Ku(Pe,e,null,n,te),le.push({event:Pe,listeners:we}),qe?Pe.data=qe:(qe=Zu(n),qe!==null&&(Pe.data=qe)))),(qe=Um?zm(e,n):Dm(e,n))&&(Pe=sl(P,"onBeforeInput"),0<Pe.length&&(we=new Ku("onBeforeInput","beforeinput",null,n,te),le.push({event:we,listeners:Pe}),we.data=qe)),Cy(le,e,P,n,te)}Mf(le,t)})}function Ir(e,t,n){return{instance:e,listener:t,currentTarget:n}}function sl(e,t){for(var n=t+"Capture",i=[];e!==null;){var c=e,h=c.stateNode;if(c=c.tag,c!==5&&c!==26&&c!==27||h===null||(c=lr(e,n),c!=null&&i.unshift(Ir(e,c,h)),c=lr(e,t),c!=null&&i.push(Ir(e,c,h))),e.tag===3)return i;e=e.return}return[]}function Ny(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Lf(e,t,n,i,c){for(var h=t._reactName,y=[];n!==null&&n!==i;){var _=n,N=_.alternate,P=_.stateNode;if(_=_.tag,N!==null&&N===i)break;_!==5&&_!==26&&_!==27||P===null||(N=P,c?(P=lr(n,h),P!=null&&y.unshift(Ir(n,P,N))):c||(P=lr(n,h),P!=null&&y.push(Ir(n,P,N)))),n=n.return}y.length!==0&&e.push({event:t,listeners:y})}var Ry=/\r\n?/g,ky=/\u0000|\uFFFD/g;function If(e){return(typeof e=="string"?e:""+e).replace(Ry,`
`).replace(ky,"")}function Hf(e,t){return t=If(t),If(e)===t}function nt(e,t,n,i,c,h){switch(n){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||pi(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&pi(e,""+i);break;case"className":zn(e,"class",i);break;case"tabIndex":zn(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":zn(e,n,i);break;case"style":Iu(e,i,h);break;case"data":if(t!=="object"){zn(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=hs(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof h=="function"&&(n==="formAction"?(t!=="input"&&nt(e,t,"name",c.name,c,null),nt(e,t,"formEncType",c.formEncType,c,null),nt(e,t,"formMethod",c.formMethod,c,null),nt(e,t,"formTarget",c.formTarget,c,null)):(nt(e,t,"encType",c.encType,c,null),nt(e,t,"method",c.method,c,null),nt(e,t,"target",c.target,c,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(n);break}i=hs(""+i),e.setAttribute(n,i);break;case"onClick":i!=null&&(e.onclick=In);break;case"onScroll":i!=null&&He("scroll",e);break;case"onScrollEnd":i!=null&&He("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}n=hs(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":i===!0?e.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":He("beforetoggle",e),He("toggle",e),Un(e,"popover",i);break;case"xlinkActuate":Ne(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":Ne(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":Ne(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":Ne(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":Ne(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":Ne(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":Ne(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":Ne(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":Ne(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":Un(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=sm.get(n)||n,Un(e,n,i))}}function Uc(e,t,n,i,c,h){switch(n){case"style":Iu(e,i,h);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(n=i.__html,n!=null){if(c.children!=null)throw Error(l(60));e.innerHTML=n}}break;case"children":typeof i=="string"?pi(e,i):(typeof i=="number"||typeof i=="bigint")&&pi(e,""+i);break;case"onScroll":i!=null&&He("scroll",e);break;case"onScrollEnd":i!=null&&He("scrollend",e);break;case"onClick":i!=null&&(e.onclick=In);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Le.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(c=n.endsWith("Capture"),t=n.slice(2,c?n.length-7:void 0),h=e[Bt]||null,h=h!=null?h[n]:null,typeof h=="function"&&e.removeEventListener(t,h,c),typeof i=="function")){typeof h!="function"&&h!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,c);break e}n in e?e[n]=i:i===!0?e.setAttribute(n,""):Un(e,n,i)}}}function Ut(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",e),He("load",e);var i=!1,c=!1,h;for(h in n)if(n.hasOwnProperty(h)){var y=n[h];if(y!=null)switch(h){case"src":i=!0;break;case"srcSet":c=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:nt(e,t,h,y,n,null)}}c&&nt(e,t,"srcSet",n.srcSet,n,null),i&&nt(e,t,"src",n.src,n,null);return;case"input":He("invalid",e);var _=h=y=c=null,N=null,P=null;for(i in n)if(n.hasOwnProperty(i)){var te=n[i];if(te!=null)switch(i){case"name":c=te;break;case"type":y=te;break;case"checked":N=te;break;case"defaultChecked":P=te;break;case"value":h=te;break;case"defaultValue":_=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(l(137,t));break;default:nt(e,t,i,te,n,null)}}Bu(e,h,_,N,P,y,c,!1);return;case"select":He("invalid",e),i=y=h=null;for(c in n)if(n.hasOwnProperty(c)&&(_=n[c],_!=null))switch(c){case"value":h=_;break;case"defaultValue":y=_;break;case"multiple":i=_;default:nt(e,t,c,_,n,null)}t=h,n=y,e.multiple=!!i,t!=null?gi(e,!!i,t,!1):n!=null&&gi(e,!!i,n,!0);return;case"textarea":He("invalid",e),h=c=i=null;for(y in n)if(n.hasOwnProperty(y)&&(_=n[y],_!=null))switch(y){case"value":i=_;break;case"defaultValue":c=_;break;case"children":h=_;break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(l(91));break;default:nt(e,t,y,_,n,null)}qu(e,i,c,h);return;case"option":for(N in n)if(n.hasOwnProperty(N)&&(i=n[N],i!=null))switch(N){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:nt(e,t,N,i,n,null)}return;case"dialog":He("beforetoggle",e),He("toggle",e),He("cancel",e),He("close",e);break;case"iframe":case"object":He("load",e);break;case"video":case"audio":for(i=0;i<Lr.length;i++)He(Lr[i],e);break;case"image":He("error",e),He("load",e);break;case"details":He("toggle",e);break;case"embed":case"source":case"link":He("error",e),He("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(P in n)if(n.hasOwnProperty(P)&&(i=n[P],i!=null))switch(P){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:nt(e,t,P,i,n,null)}return;default:if(Kl(t)){for(te in n)n.hasOwnProperty(te)&&(i=n[te],i!==void 0&&Uc(e,t,te,i,n,void 0));return}}for(_ in n)n.hasOwnProperty(_)&&(i=n[_],i!=null&&nt(e,t,_,i,n,null))}function Uy(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var c=null,h=null,y=null,_=null,N=null,P=null,te=null;for(X in n){var le=n[X];if(n.hasOwnProperty(X)&&le!=null)switch(X){case"checked":break;case"value":break;case"defaultValue":N=le;default:i.hasOwnProperty(X)||nt(e,t,X,null,i,le)}}for(var Y in i){var X=i[Y];if(le=n[Y],i.hasOwnProperty(Y)&&(X!=null||le!=null))switch(Y){case"type":h=X;break;case"name":c=X;break;case"checked":P=X;break;case"defaultChecked":te=X;break;case"value":y=X;break;case"defaultValue":_=X;break;case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(l(137,t));break;default:X!==le&&nt(e,t,Y,X,i,le)}}Pl(e,y,_,N,P,te,h,c);return;case"select":X=y=_=Y=null;for(h in n)if(N=n[h],n.hasOwnProperty(h)&&N!=null)switch(h){case"value":break;case"multiple":X=N;default:i.hasOwnProperty(h)||nt(e,t,h,null,i,N)}for(c in i)if(h=i[c],N=n[c],i.hasOwnProperty(c)&&(h!=null||N!=null))switch(c){case"value":Y=h;break;case"defaultValue":_=h;break;case"multiple":y=h;default:h!==N&&nt(e,t,c,h,i,N)}t=_,n=y,i=X,Y!=null?gi(e,!!n,Y,!1):!!i!=!!n&&(t!=null?gi(e,!!n,t,!0):gi(e,!!n,n?[]:"",!1));return;case"textarea":X=Y=null;for(_ in n)if(c=n[_],n.hasOwnProperty(_)&&c!=null&&!i.hasOwnProperty(_))switch(_){case"value":break;case"children":break;default:nt(e,t,_,null,i,c)}for(y in i)if(c=i[y],h=n[y],i.hasOwnProperty(y)&&(c!=null||h!=null))switch(y){case"value":Y=c;break;case"defaultValue":X=c;break;case"children":break;case"dangerouslySetInnerHTML":if(c!=null)throw Error(l(91));break;default:c!==h&&nt(e,t,y,c,i,h)}Mu(e,Y,X);return;case"option":for(var je in n)if(Y=n[je],n.hasOwnProperty(je)&&Y!=null&&!i.hasOwnProperty(je))switch(je){case"selected":e.selected=!1;break;default:nt(e,t,je,null,i,Y)}for(N in i)if(Y=i[N],X=n[N],i.hasOwnProperty(N)&&Y!==X&&(Y!=null||X!=null))switch(N){case"selected":e.selected=Y&&typeof Y!="function"&&typeof Y!="symbol";break;default:nt(e,t,N,Y,i,X)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in n)Y=n[Ae],n.hasOwnProperty(Ae)&&Y!=null&&!i.hasOwnProperty(Ae)&&nt(e,t,Ae,null,i,Y);for(P in i)if(Y=i[P],X=n[P],i.hasOwnProperty(P)&&Y!==X&&(Y!=null||X!=null))switch(P){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(l(137,t));break;default:nt(e,t,P,Y,i,X)}return;default:if(Kl(t)){for(var at in n)Y=n[at],n.hasOwnProperty(at)&&Y!==void 0&&!i.hasOwnProperty(at)&&Uc(e,t,at,void 0,i,Y);for(te in i)Y=i[te],X=n[te],!i.hasOwnProperty(te)||Y===X||Y===void 0&&X===void 0||Uc(e,t,te,Y,i,X);return}}for(var I in n)Y=n[I],n.hasOwnProperty(I)&&Y!=null&&!i.hasOwnProperty(I)&&nt(e,t,I,null,i,Y);for(le in i)Y=i[le],X=n[le],!i.hasOwnProperty(le)||Y===X||Y==null&&X==null||nt(e,t,le,Y,i,X)}function Vf(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function zy(){if(typeof performance.getEntriesByType=="function"){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var c=n[i],h=c.transferSize,y=c.initiatorType,_=c.duration;if(h&&_&&Vf(y)){for(y=0,_=c.responseEnd,i+=1;i<n.length;i++){var N=n[i],P=N.startTime;if(P>_)break;var te=N.transferSize,le=N.initiatorType;te&&Vf(le)&&(N=N.responseEnd,y+=te*(N<_?1:(_-P)/(N-P)))}if(--i,t+=8*(h+y)/(c.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var zc=null,Dc=null;function ll(e){return e.nodeType===9?e:e.ownerDocument}function $f(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Pf(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Bc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Mc=null;function Dy(){var e=window.event;return e&&e.type==="popstate"?e===Mc?!1:(Mc=e,!0):(Mc=null,!1)}var Gf=typeof setTimeout=="function"?setTimeout:void 0,By=typeof clearTimeout=="function"?clearTimeout:void 0,Kf=typeof Promise=="function"?Promise:void 0,My=typeof queueMicrotask=="function"?queueMicrotask:typeof Kf<"u"?function(e){return Kf.resolve(null).then(e).catch(qy)}:Gf;function qy(e){setTimeout(function(){throw e})}function Sa(e){return e==="head"}function Yf(e,t){var n=t,i=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"||n==="/&"){if(i===0){e.removeChild(c),Ki(t);return}i--}else if(n==="$"||n==="$?"||n==="$~"||n==="$!"||n==="&")i++;else if(n==="html")Hr(e.ownerDocument.documentElement);else if(n==="head"){n=e.ownerDocument.head,Hr(n);for(var h=n.firstChild;h;){var y=h.nextSibling,_=h.nodeName;h[ge]||_==="SCRIPT"||_==="STYLE"||_==="LINK"&&h.rel.toLowerCase()==="stylesheet"||n.removeChild(h),h=y}}else n==="body"&&Hr(e.ownerDocument.body);n=c}while(n);Ki(t)}function Jf(e,t){var n=e;e=0;do{var i=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",n.getAttribute("style")===""&&n.removeAttribute("style")):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(e===0)break;e--}else n!=="$"&&n!=="$?"&&n!=="$~"&&n!=="$!"||e++;n=i}while(n)}function qc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":qc(n),be(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Ly(e,t,n,i){for(;e.nodeType===1;){var c=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[ge])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(h=e.getAttribute("rel"),h==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(h!==c.rel||e.getAttribute("href")!==(c.href==null||c.href===""?null:c.href)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin)||e.getAttribute("title")!==(c.title==null?null:c.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(h=e.getAttribute("src"),(h!==(c.src==null?null:c.src)||e.getAttribute("type")!==(c.type==null?null:c.type)||e.getAttribute("crossorigin")!==(c.crossOrigin==null?null:c.crossOrigin))&&h&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var h=c.name==null?null:""+c.name;if(c.type==="hidden"&&e.getAttribute("name")===h)return e}else return e;if(e=mn(e.nextSibling),e===null)break}return null}function Iy(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=mn(e.nextSibling),e===null))return null;return e}function Qf(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!t||(e=mn(e.nextSibling),e===null))return null;return e}function Lc(e){return e.data==="$?"||e.data==="$~"}function Ic(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function Hy(e,t){var n=e.ownerDocument;if(e.data==="$~")e._reactRetry=t;else if(e.data!=="$?"||n.readyState!=="loading")t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function mn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="$~"||t==="&"||t==="F!"||t==="F")break;if(t==="/$"||t==="/&")return null}}return e}var Hc=null;function Xf(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"||n==="/&"){if(t===0)return mn(e.nextSibling);t--}else n!=="$"&&n!=="$!"&&n!=="$?"&&n!=="$~"&&n!=="&"||t++}e=e.nextSibling}return null}function Ff(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"||n==="$~"||n==="&"){if(t===0)return e;t--}else n!=="/$"&&n!=="/&"||t++}e=e.previousSibling}return null}function Zf(e,t,n){switch(t=ll(n),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Hr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);be(e)}var yn=new Map,Wf=new Set;function ol(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var na=L.d;L.d={f:Vy,r:$y,D:Py,C:Gy,L:Ky,m:Yy,X:Qy,S:Jy,M:Xy};function Vy(){var e=na.f(),t=Ws();return e||t}function $y(e){var t=Oe(e);t!==null&&t.tag===5&&t.type==="form"?ph(t):na.r(e)}var $i=typeof document>"u"?null:document;function eg(e,t,n){var i=$i;if(i&&typeof t=="string"&&t){var c=cn(t);c='link[rel="'+e+'"][href="'+c+'"]',typeof n=="string"&&(c+='[crossorigin="'+n+'"]'),Wf.has(c)||(Wf.add(c),e={rel:e,crossOrigin:n,href:t},i.querySelector(c)===null&&(t=i.createElement("link"),Ut(t,"link",e),Se(t),i.head.appendChild(t)))}}function Py(e){na.D(e),eg("dns-prefetch",e,null)}function Gy(e,t){na.C(e,t),eg("preconnect",e,t)}function Ky(e,t,n){na.L(e,t,n);var i=$i;if(i&&e&&t){var c='link[rel="preload"][as="'+cn(t)+'"]';t==="image"&&n&&n.imageSrcSet?(c+='[imagesrcset="'+cn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(c+='[imagesizes="'+cn(n.imageSizes)+'"]')):c+='[href="'+cn(e)+'"]';var h=c;switch(t){case"style":h=Pi(e);break;case"script":h=Gi(e)}yn.has(h)||(e=x({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),yn.set(h,e),i.querySelector(c)!==null||t==="style"&&i.querySelector(Vr(h))||t==="script"&&i.querySelector($r(h))||(t=i.createElement("link"),Ut(t,"link",e),Se(t),i.head.appendChild(t)))}}function Yy(e,t){na.m(e,t);var n=$i;if(n&&e){var i=t&&typeof t.as=="string"?t.as:"script",c='link[rel="modulepreload"][as="'+cn(i)+'"][href="'+cn(e)+'"]',h=c;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":h=Gi(e)}if(!yn.has(h)&&(e=x({rel:"modulepreload",href:e},t),yn.set(h,e),n.querySelector(c)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector($r(h)))return}i=n.createElement("link"),Ut(i,"link",e),Se(i),n.head.appendChild(i)}}}function Jy(e,t,n){na.S(e,t,n);var i=$i;if(i&&e){var c=me(i).hoistableStyles,h=Pi(e);t=t||"default";var y=c.get(h);if(!y){var _={loading:0,preload:null};if(y=i.querySelector(Vr(h)))_.loading=5;else{e=x({rel:"stylesheet",href:e,"data-precedence":t},n),(n=yn.get(h))&&Vc(e,n);var N=y=i.createElement("link");Se(N),Ut(N,"link",e),N._p=new Promise(function(P,te){N.onload=P,N.onerror=te}),N.addEventListener("load",function(){_.loading|=1}),N.addEventListener("error",function(){_.loading|=2}),_.loading|=4,cl(y,t,i)}y={type:"stylesheet",instance:y,count:1,state:_},c.set(h,y)}}}function Qy(e,t){na.X(e,t);var n=$i;if(n&&e){var i=me(n).hoistableScripts,c=Gi(e),h=i.get(c);h||(h=n.querySelector($r(c)),h||(e=x({src:e,async:!0},t),(t=yn.get(c))&&$c(e,t),h=n.createElement("script"),Se(h),Ut(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function Xy(e,t){na.M(e,t);var n=$i;if(n&&e){var i=me(n).hoistableScripts,c=Gi(e),h=i.get(c);h||(h=n.querySelector($r(c)),h||(e=x({src:e,async:!0,type:"module"},t),(t=yn.get(c))&&$c(e,t),h=n.createElement("script"),Se(h),Ut(h,"link",e),n.head.appendChild(h)),h={type:"script",instance:h,count:1,state:null},i.set(c,h))}}function tg(e,t,n,i){var c=(c=ie.current)?ol(c):null;if(!c)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Pi(n.href),n=me(c).hoistableStyles,i=n.get(t),i||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Pi(n.href);var h=me(c).hoistableStyles,y=h.get(e);if(y||(c=c.ownerDocument||c,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},h.set(e,y),(h=c.querySelector(Vr(e)))&&!h._p&&(y.instance=h,y.state.loading=5),yn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},yn.set(e,n),h||Fy(c,e,n,y.state))),t&&i===null)throw Error(l(528,""));return y}if(t&&i!==null)throw Error(l(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=Gi(n),n=me(c).hoistableScripts,i=n.get(t),i||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Pi(e){return'href="'+cn(e)+'"'}function Vr(e){return'link[rel="stylesheet"]['+e+"]"}function ng(e){return x({},e,{"data-precedence":e.precedence,precedence:null})}function Fy(e,t,n,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),Ut(t,"link",n),Se(t),e.head.appendChild(t))}function Gi(e){return'[src="'+cn(e)+'"]'}function $r(e){return"script[async]"+e}function ag(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+cn(n.href)+'"]');if(i)return t.instance=i,Se(i),i;var c=x({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),Se(i),Ut(i,"style",c),cl(i,n.precedence,e),t.instance=i;case"stylesheet":c=Pi(n.href);var h=e.querySelector(Vr(c));if(h)return t.state.loading|=4,t.instance=h,Se(h),h;i=ng(n),(c=yn.get(c))&&Vc(i,c),h=(e.ownerDocument||e).createElement("link"),Se(h);var y=h;return y._p=new Promise(function(_,N){y.onload=_,y.onerror=N}),Ut(h,"link",i),t.state.loading|=4,cl(h,n.precedence,e),t.instance=h;case"script":return h=Gi(n.src),(c=e.querySelector($r(h)))?(t.instance=c,Se(c),c):(i=n,(c=yn.get(h))&&(i=x({},n),$c(i,c)),e=e.ownerDocument||e,c=e.createElement("script"),Se(c),Ut(c,"link",i),e.head.appendChild(c),t.instance=c);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,cl(i,n.precedence,e));return t.instance}function cl(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),c=i.length?i[i.length-1]:null,h=c,y=0;y<i.length;y++){var _=i[y];if(_.dataset.precedence===t)h=_;else if(h!==c)break}h?h.parentNode.insertBefore(e,h.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Vc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function $c(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var ul=null;function ig(e,t,n){if(ul===null){var i=new Map,c=ul=new Map;c.set(n,i)}else c=ul,i=c.get(n),i||(i=new Map,c.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),c=0;c<n.length;c++){var h=n[c];if(!(h[ge]||h[bt]||e==="link"&&h.getAttribute("rel")==="stylesheet")&&h.namespaceURI!=="http://www.w3.org/2000/svg"){var y=h.getAttribute(t)||"";y=e+y;var _=i.get(y);_?_.push(h):i.set(y,[h])}}return i}function rg(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Zy(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function sg(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function Wy(e,t,n,i){if(n.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(n.state.loading&4)===0){if(n.instance===null){var c=Pi(i.href),h=t.querySelector(Vr(c));if(h){t=h._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(e.count++,e=dl.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=h,Se(h);return}h=t.ownerDocument||t,i=ng(i),(c=yn.get(c))&&Vc(i,c),h=h.createElement("link"),Se(h);var y=h;y._p=new Promise(function(_,N){y.onload=_,y.onerror=N}),Ut(h,"link",i),n.instance=h}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&(n.state.loading&3)===0&&(e.count++,n=dl.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}var Pc=0;function ev(e,t){return e.stylesheets&&e.count===0&&fl(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&fl(e,e.stylesheets),e.unsuspend){var h=e.unsuspend;e.unsuspend=null,h()}},6e4+t);0<e.imgBytes&&Pc===0&&(Pc=62500*zy());var c=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&fl(e,e.stylesheets),e.unsuspend)){var h=e.unsuspend;e.unsuspend=null,h()}},(e.imgBytes>Pc?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(c)}}:null}function dl(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fl(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var hl=null;function fl(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,hl=new Map,t.forEach(tv,e),hl=null,dl.call(e))}function tv(e,t){if(!(t.state.loading&4)){var n=hl.get(e);if(n)var i=n.get(null);else{n=new Map,hl.set(e,n);for(var c=e.querySelectorAll("link[data-precedence],style[data-precedence]"),h=0;h<c.length;h++){var y=c[h];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(n.set(y.dataset.precedence,y),i=y)}i&&n.set(null,i)}c=t.instance,y=c.getAttribute("data-precedence"),h=n.get(y)||i,h===i&&n.set(null,c),n.set(y,c),this.count++,i=dl.bind(this),c.addEventListener("load",i),c.addEventListener("error",i),h?h.parentNode.insertBefore(c,h.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(c,e.firstChild)),t.state.loading|=4}}var Pr={$$typeof:B,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function nv(e,t,n,i,c,h,y,_,N){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Da(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Da(0),this.hiddenUpdates=Da(null),this.identifierPrefix=i,this.onUncaughtError=c,this.onCaughtError=h,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function lg(e,t,n,i,c,h,y,_,N,P,te,le){return e=new nv(e,t,n,y,N,P,te,le,_),t=1,h===!0&&(t|=24),h=Zt(3,null,null,t),e.current=h,h.stateNode=e,t=So(),t.refCount++,e.pooledCache=t,t.refCount++,h.memoizedState={element:i,isDehydrated:n,cache:t},To(h),e}function og(e){return e?(e=ji,e):ji}function cg(e,t,n,i,c,h){c=og(c),i.context===null?i.context=c:i.pendingContext=c,i=ha(t),i.payload={element:n},h=h===void 0?null:h,h!==null&&(i.callback=h),n=fa(e,i,t),n!==null&&(Xt(n,e,t),jr(n,e,t))}function ug(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Gc(e,t){ug(e,t),(e=e.alternate)&&ug(e,t)}function dg(e){if(e.tag===13||e.tag===31){var t=Ha(e,67108864);t!==null&&Xt(t,e,67108864),Gc(e,67108864)}}function hg(e){if(e.tag===13||e.tag===31){var t=an();t=rr(t);var n=Ha(e,t);n!==null&&Xt(n,e,t),Gc(e,t)}}var gl=!0;function av(e,t,n,i){var c=D.T;D.T=null;var h=L.p;try{L.p=2,Kc(e,t,n,i)}finally{L.p=h,D.T=c}}function iv(e,t,n,i){var c=D.T;D.T=null;var h=L.p;try{L.p=8,Kc(e,t,n,i)}finally{L.p=h,D.T=c}}function Kc(e,t,n,i){if(gl){var c=Yc(i);if(c===null)kc(e,t,i,pl,n),gg(e,i);else if(sv(c,e,t,n,i))i.stopPropagation();else if(gg(e,i),t&4&&-1<rv.indexOf(e)){for(;c!==null;){var h=Oe(c);if(h!==null)switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var y=Nn(h.pendingLanes);if(y!==0){var _=h;for(_.pendingLanes|=2,_.entangledLanes|=2;y;){var N=1<<31-It(y);_.entanglements[1]|=N,y&=~N}qn(h),(Fe&6)===0&&(Fs=Ot()+500,qr(0))}}break;case 31:case 13:_=Ha(h,2),_!==null&&Xt(_,h,2),Ws(),Gc(h,2)}if(h=Yc(i),h===null&&kc(e,t,i,pl,n),h===c)break;c=h}c!==null&&i.stopPropagation()}else kc(e,t,i,null,n)}}function Yc(e){return e=Jl(e),Jc(e)}var pl=null;function Jc(e){if(pl=null,e=ve(e),e!==null){var t=d(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=f(t),e!==null)return e;e=null}else if(n===31){if(e=g(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return pl=e,null}function fg(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ql()){case oi:return 2;case as:return 8;case ka:case Ll:return 32;case is:return 268435456;default:return 32}default:return 32}}var Qc=!1,wa=null,Ea=null,Ca=null,Gr=new Map,Kr=new Map,Ta=[],rv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function gg(e,t){switch(e){case"focusin":case"focusout":wa=null;break;case"dragenter":case"dragleave":Ea=null;break;case"mouseover":case"mouseout":Ca=null;break;case"pointerover":case"pointerout":Gr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Kr.delete(t.pointerId)}}function Yr(e,t,n,i,c,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:h,targetContainers:[c]},t!==null&&(t=Oe(t),t!==null&&dg(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function sv(e,t,n,i,c){switch(t){case"focusin":return wa=Yr(wa,e,t,n,i,c),!0;case"dragenter":return Ea=Yr(Ea,e,t,n,i,c),!0;case"mouseover":return Ca=Yr(Ca,e,t,n,i,c),!0;case"pointerover":var h=c.pointerId;return Gr.set(h,Yr(Gr.get(h)||null,e,t,n,i,c)),!0;case"gotpointercapture":return h=c.pointerId,Kr.set(h,Yr(Kr.get(h)||null,e,t,n,i,c)),!0}return!1}function pg(e){var t=ve(e.target);if(t!==null){var n=d(t);if(n!==null){if(t=n.tag,t===13){if(t=f(n),t!==null){e.blockedOn=t,ds(e.priority,function(){hg(n)});return}}else if(t===31){if(t=g(n),t!==null){e.blockedOn=t,ds(e.priority,function(){hg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ml(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yc(e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Yl=i,n.target.dispatchEvent(i),Yl=null}else return t=Oe(n),t!==null&&dg(t),e.blockedOn=n,!1;t.shift()}return!0}function mg(e,t,n){ml(e)&&n.delete(t)}function lv(){Qc=!1,wa!==null&&ml(wa)&&(wa=null),Ea!==null&&ml(Ea)&&(Ea=null),Ca!==null&&ml(Ca)&&(Ca=null),Gr.forEach(mg),Kr.forEach(mg)}function yl(e,t){e.blockedOn===t&&(e.blockedOn=null,Qc||(Qc=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,lv)))}var vl=null;function yg(e){vl!==e&&(vl=e,o.unstable_scheduleCallback(o.unstable_NormalPriority,function(){vl===e&&(vl=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],c=e[t+2];if(typeof i!="function"){if(Jc(i||n)===null)continue;break}var h=Oe(n);h!==null&&(e.splice(t,3),t-=3,Yo(h,{pending:!0,data:c,method:n.method,action:i},i,c))}}))}function Ki(e){function t(N){return yl(N,e)}wa!==null&&yl(wa,e),Ea!==null&&yl(Ea,e),Ca!==null&&yl(Ca,e),Gr.forEach(t),Kr.forEach(t);for(var n=0;n<Ta.length;n++){var i=Ta[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Ta.length&&(n=Ta[0],n.blockedOn===null);)pg(n),n.blockedOn===null&&Ta.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var c=n[i],h=n[i+1],y=c[Bt]||null;if(typeof h=="function")y||yg(n);else if(y){var _=null;if(h&&h.hasAttribute("formAction")){if(c=h,y=h[Bt]||null)_=y.formAction;else if(Jc(c)!==null)continue}else _=y.action;typeof _=="function"?n[i+1]=_:(n.splice(i,3),i-=3),yg(n)}}}function vg(){function e(h){h.canIntercept&&h.info==="react-transition"&&h.intercept({handler:function(){return new Promise(function(y){return c=y})},focusReset:"manual",scroll:"manual"})}function t(){c!==null&&(c(),c=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var h=navigation.currentEntry;h&&h.url!=null&&navigation.navigate(h.url,{state:h.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var i=!1,c=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),c!==null&&(c(),c=null)}}}function Xc(e){this._internalRoot=e}bl.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var n=t.current,i=an();cg(n,i,e,t,null,null)},bl.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;cg(e.current,2,null,e,null,null),Ws(),t[ia]=null}};function bl(e){this._internalRoot=e}bl.prototype.unstable_scheduleHydration=function(e){if(e){var t=sr();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ta.length&&t!==0&&t<Ta[n].priority;n++);Ta.splice(n,0,e),n===0&&pg(e)}};var bg=a.version;if(bg!=="19.2.0")throw Error(l(527,bg,"19.2.0"));L.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=m(t),e=e!==null?v(e):null,e=e===null?null:e.stateNode,e};var ov={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_l.isDisabled&&_l.supportsFiber)try{Ua=_l.inject(ov),Lt=_l}catch{}}return Qr.createRoot=function(e,t){if(!u(e))throw Error(l(299));var n=!1,i="",c=Eh,h=Ch,y=Th;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(c=t.onUncaughtError),t.onCaughtError!==void 0&&(h=t.onCaughtError),t.onRecoverableError!==void 0&&(y=t.onRecoverableError)),t=lg(e,1,!1,null,null,n,i,null,c,h,y,vg),e[ia]=t.current,Rc(e),new Xc(t)},Qr.hydrateRoot=function(e,t,n){if(!u(e))throw Error(l(299));var i=!1,c="",h=Eh,y=Ch,_=Th,N=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onUncaughtError!==void 0&&(h=n.onUncaughtError),n.onCaughtError!==void 0&&(y=n.onCaughtError),n.onRecoverableError!==void 0&&(_=n.onRecoverableError),n.formState!==void 0&&(N=n.formState)),t=lg(e,1,!0,t,n??null,i,c,N,h,y,_,vg),t.context=og(null),n=t.current,i=an(),i=rr(i),c=ha(i),c.callback=null,fa(n,c,i),n=i,t.current.lanes=n,Rn(t,n),qn(t),e[ia]=t.current,Rc(e),new bl(t)},Qr.version="19.2.0",Qr}var Og;function bv(){if(Og)return Zc.exports;Og=1;function o(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(o)}catch(a){console.error(a)}}return o(),Zc.exports=vv(),Zc.exports}var _v=bv(),S=Eu();const cp=lp(S);var hu=function(o,a){return hu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,l){s.__proto__=l}||function(s,l){for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(s[u]=l[u])},hu(o,a)};function up(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");hu(o,a);function s(){this.constructor=o}o.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}var Nl=function(){return Nl=Object.assign||function(a){for(var s,l=1,u=arguments.length;l<u;l++){s=arguments[l];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},Nl.apply(this,arguments)};function nr(o,a){var s={};for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&a.indexOf(l)<0&&(s[l]=o[l]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(o);u<l.length;u++)a.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(o,l[u])&&(s[l[u]]=o[l[u]]);return s}function dp(o,a,s,l){var u=arguments.length,d=u<3?a:l===null?l=Object.getOwnPropertyDescriptor(a,s):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(o,a,s,l);else for(var g=o.length-1;g>=0;g--)(f=o[g])&&(d=(u<3?f(d):u>3?f(a,s,d):f(a,s))||d);return u>3&&d&&Object.defineProperty(a,s,d),d}function hp(o,a){return function(s,l){a(s,l,o)}}function fp(o,a,s,l,u,d){function f(C){if(C!==void 0&&typeof C!="function")throw new TypeError("Function expected");return C}for(var g=l.kind,p=g==="getter"?"get":g==="setter"?"set":"value",m=!a&&o?l.static?o:o.prototype:null,v=a||(m?Object.getOwnPropertyDescriptor(m,l.name):{}),x,j=!1,b=s.length-1;b>=0;b--){var w={};for(var T in l)w[T]=T==="access"?{}:l[T];for(var T in l.access)w.access[T]=l.access[T];w.addInitializer=function(C){if(j)throw new TypeError("Cannot add initializers after decoration has completed");d.push(f(C||null))};var O=(0,s[b])(g==="accessor"?{get:v.get,set:v.set}:v[p],w);if(g==="accessor"){if(O===void 0)continue;if(O===null||typeof O!="object")throw new TypeError("Object expected");(x=f(O.get))&&(v.get=x),(x=f(O.set))&&(v.set=x),(x=f(O.init))&&u.unshift(x)}else(x=f(O))&&(g==="field"?u.unshift(x):v[p]=x)}m&&Object.defineProperty(m,l.name,v),j=!0}function gp(o,a,s){for(var l=arguments.length>2,u=0;u<a.length;u++)s=l?a[u].call(o,s):a[u].call(o);return l?s:void 0}function pp(o){return typeof o=="symbol"?o:"".concat(o)}function mp(o,a,s){return typeof a=="symbol"&&(a=a.description?"[".concat(a.description,"]"):""),Object.defineProperty(o,"name",{configurable:!0,value:s?"".concat(s," ",a):a})}function yp(o,a){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,a)}function Ee(o,a,s,l){function u(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function g(v){try{m(l.next(v))}catch(x){f(x)}}function p(v){try{m(l.throw(v))}catch(x){f(x)}}function m(v){v.done?d(v.value):u(v.value).then(g,p)}m((l=l.apply(o,a||[])).next())})}function vp(o,a){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},l,u,d,f=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return f.next=g(0),f.throw=g(1),f.return=g(2),typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(m){return function(v){return p([m,v])}}function p(m){if(l)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(s=0)),s;)try{if(l=1,u&&(d=m[0]&2?u.return:m[0]?u.throw||((d=u.return)&&d.call(u),0):u.next)&&!(d=d.call(u,m[1])).done)return d;switch(u=0,d&&(m=[m[0]&2,d.value]),m[0]){case 0:case 1:d=m;break;case 4:return s.label++,{value:m[1],done:!1};case 5:s.label++,u=m[1],m=[0];continue;case 7:m=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(m[0]===6||m[0]===2)){s=0;continue}if(m[0]===3&&(!d||m[1]>d[0]&&m[1]<d[3])){s.label=m[1];break}if(m[0]===6&&s.label<d[1]){s.label=d[1],d=m;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(m);break}d[2]&&s.ops.pop(),s.trys.pop();continue}m=a.call(o,s)}catch(v){m=[6,v],u=0}finally{l=d=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}var Dl=Object.create?(function(o,a,s,l){l===void 0&&(l=s);var u=Object.getOwnPropertyDescriptor(a,s);(!u||("get"in u?!a.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(o,l,u)}):(function(o,a,s,l){l===void 0&&(l=s),o[l]=a[s]});function bp(o,a){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&Dl(a,o,s)}function Rl(o){var a=typeof Symbol=="function"&&Symbol.iterator,s=a&&o[a],l=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&l>=o.length&&(o=void 0),{value:o&&o[l++],done:!o}}};throw new TypeError(a?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cu(o,a){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var l=s.call(o),u,d=[],f;try{for(;(a===void 0||a-- >0)&&!(u=l.next()).done;)d.push(u.value)}catch(g){f={error:g}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(f)throw f.error}}return d}function _p(){for(var o=[],a=0;a<arguments.length;a++)o=o.concat(Cu(arguments[a]));return o}function xp(){for(var o=0,a=0,s=arguments.length;a<s;a++)o+=arguments[a].length;for(var l=Array(o),u=0,a=0;a<s;a++)for(var d=arguments[a],f=0,g=d.length;f<g;f++,u++)l[u]=d[f];return l}function jp(o,a,s){if(s||arguments.length===2)for(var l=0,u=a.length,d;l<u;l++)(d||!(l in a))&&(d||(d=Array.prototype.slice.call(a,0,l)),d[l]=a[l]);return o.concat(d||Array.prototype.slice.call(a))}function tr(o){return this instanceof tr?(this.v=o,this):new tr(o)}function Sp(o,a,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=s.apply(o,a||[]),u,d=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",f),u[Symbol.asyncIterator]=function(){return this},u;function f(b){return function(w){return Promise.resolve(w).then(b,x)}}function g(b,w){l[b]&&(u[b]=function(T){return new Promise(function(O,C){d.push([b,T,O,C])>1||p(b,T)})},w&&(u[b]=w(u[b])))}function p(b,w){try{m(l[b](w))}catch(T){j(d[0][3],T)}}function m(b){b.value instanceof tr?Promise.resolve(b.value.v).then(v,x):j(d[0][2],b)}function v(b){p("next",b)}function x(b){p("throw",b)}function j(b,w){b(w),d.shift(),d.length&&p(d[0][0],d[0][1])}}function wp(o){var a,s;return a={},l("next"),l("throw",function(u){throw u}),l("return"),a[Symbol.iterator]=function(){return this},a;function l(u,d){a[u]=o[u]?function(f){return(s=!s)?{value:tr(o[u](f)),done:!1}:d?d(f):f}:d}}function Ep(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=o[Symbol.asyncIterator],s;return a?a.call(o):(o=typeof Rl=="function"?Rl(o):o[Symbol.iterator](),s={},l("next"),l("throw"),l("return"),s[Symbol.asyncIterator]=function(){return this},s);function l(d){s[d]=o[d]&&function(f){return new Promise(function(g,p){f=o[d](f),u(g,p,f.done,f.value)})}}function u(d,f,g,p){Promise.resolve(p).then(function(m){d({value:m,done:g})},f)}}function Cp(o,a){return Object.defineProperty?Object.defineProperty(o,"raw",{value:a}):o.raw=a,o}var xv=Object.create?(function(o,a){Object.defineProperty(o,"default",{enumerable:!0,value:a})}):function(o,a){o.default=a},fu=function(o){return fu=Object.getOwnPropertyNames||function(a){var s=[];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(s[s.length]=l);return s},fu(o)};function Tp(o){if(o&&o.__esModule)return o;var a={};if(o!=null)for(var s=fu(o),l=0;l<s.length;l++)s[l]!=="default"&&Dl(a,o,s[l]);return xv(a,o),a}function Ap(o){return o&&o.__esModule?o:{default:o}}function Op(o,a,s,l){if(s==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof a=="function"?o!==a||!l:!a.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?l:s==="a"?l.call(o):l?l.value:a.get(o)}function Np(o,a,s,l,u){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!u)throw new TypeError("Private accessor was defined without a setter");if(typeof a=="function"?o!==a||!u:!a.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?u.call(o,s):u?u.value=s:a.set(o,s),s}function Rp(o,a){if(a===null||typeof a!="object"&&typeof a!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof o=="function"?a===o:o.has(a)}function kp(o,a,s){if(a!=null){if(typeof a!="object"&&typeof a!="function")throw new TypeError("Object expected.");var l,u;if(s){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=a[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=a[Symbol.dispose],s&&(u=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");u&&(l=function(){try{u.call(this)}catch(d){return Promise.reject(d)}}),o.stack.push({value:a,dispose:l,async:s})}else s&&o.stack.push({async:!0});return a}var jv=typeof SuppressedError=="function"?SuppressedError:function(o,a,s){var l=new Error(s);return l.name="SuppressedError",l.error=o,l.suppressed=a,l};function Up(o){function a(d){o.error=o.hasError?new jv(d,o.error,"An error was suppressed during disposal."):d,o.hasError=!0}var s,l=0;function u(){for(;s=o.stack.pop();)try{if(!s.async&&l===1)return l=0,o.stack.push(s),Promise.resolve().then(u);if(s.dispose){var d=s.dispose.call(s.value);if(s.async)return l|=2,Promise.resolve(d).then(u,function(f){return a(f),u()})}else l|=1}catch(f){a(f)}if(l===1)return o.hasError?Promise.reject(o.error):Promise.resolve();if(o.hasError)throw o.error}return u()}function zp(o,a){return typeof o=="string"&&/^\.\.?\//.test(o)?o.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(s,l,u,d,f){return l?a?".jsx":".js":u&&(!d||!f)?s:u+d+"."+f.toLowerCase()+"js"}):o}const Sv={__extends:up,__assign:Nl,__rest:nr,__decorate:dp,__param:hp,__esDecorate:fp,__runInitializers:gp,__propKey:pp,__setFunctionName:mp,__metadata:yp,__awaiter:Ee,__generator:vp,__createBinding:Dl,__exportStar:bp,__values:Rl,__read:Cu,__spread:_p,__spreadArrays:xp,__spreadArray:jp,__await:tr,__asyncGenerator:Sp,__asyncDelegator:wp,__asyncValues:Ep,__makeTemplateObject:Cp,__importStar:Tp,__importDefault:Ap,__classPrivateFieldGet:Op,__classPrivateFieldSet:Np,__classPrivateFieldIn:Rp,__addDisposableResource:kp,__disposeResources:Up,__rewriteRelativeImportExtension:zp},wv=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:kp,get __assign(){return Nl},__asyncDelegator:wp,__asyncGenerator:Sp,__asyncValues:Ep,__await:tr,__awaiter:Ee,__classPrivateFieldGet:Op,__classPrivateFieldIn:Rp,__classPrivateFieldSet:Np,__createBinding:Dl,__decorate:dp,__disposeResources:Up,__esDecorate:fp,__exportStar:bp,__extends:up,__generator:vp,__importDefault:Ap,__importStar:Tp,__makeTemplateObject:Cp,__metadata:yp,__param:hp,__propKey:pp,__read:Cu,__rest:nr,__rewriteRelativeImportExtension:zp,__runInitializers:gp,__setFunctionName:mp,__spread:_p,__spreadArray:jp,__spreadArrays:xp,__values:Rl,default:Sv},Symbol.toStringTag,{value:"Module"})),Ev=o=>o?(...a)=>o(...a):(...a)=>fetch(...a);class Tu extends Error{constructor(a,s="FunctionsError",l){super(a),this.name=s,this.context=l}}class Cv extends Tu{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class Ng extends Tu{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class Rg extends Tu{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}var gu;(function(o){o.Any="any",o.ApNortheast1="ap-northeast-1",o.ApNortheast2="ap-northeast-2",o.ApSouth1="ap-south-1",o.ApSoutheast1="ap-southeast-1",o.ApSoutheast2="ap-southeast-2",o.CaCentral1="ca-central-1",o.EuCentral1="eu-central-1",o.EuWest1="eu-west-1",o.EuWest2="eu-west-2",o.EuWest3="eu-west-3",o.SaEast1="sa-east-1",o.UsEast1="us-east-1",o.UsWest1="us-west-1",o.UsWest2="us-west-2"})(gu||(gu={}));class Tv{constructor(a,{headers:s={},customFetch:l,region:u=gu.Any}={}){this.url=a,this.headers=s,this.region=u,this.fetch=Ev(l)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){return Ee(this,arguments,void 0,function*(s,l={}){var u;let d,f;try{const{headers:g,method:p,body:m,signal:v,timeout:x}=l;let j={},{region:b}=l;b||(b=this.region);const w=new URL(`${this.url}/${s}`);b&&b!=="any"&&(j["x-region"]=b,w.searchParams.set("forceFunctionRegion",b));let T;m&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?typeof Blob<"u"&&m instanceof Blob||m instanceof ArrayBuffer?(j["Content-Type"]="application/octet-stream",T=m):typeof m=="string"?(j["Content-Type"]="text/plain",T=m):typeof FormData<"u"&&m instanceof FormData?T=m:(j["Content-Type"]="application/json",T=JSON.stringify(m)):T=m;let O=v;x&&(f=new AbortController,d=setTimeout(()=>f.abort(),x),v?(O=f.signal,v.addEventListener("abort",()=>f.abort())):O=f.signal);const C=yield this.fetch(w.toString(),{method:p||"POST",headers:Object.assign(Object.assign(Object.assign({},j),this.headers),g),body:T,signal:O}).catch(E=>{throw new Cv(E)}),M=C.headers.get("x-relay-error");if(M&&M==="true")throw new Ng(C);if(!C.ok)throw new Rg(C);let B=((u=C.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),G;return B==="application/json"?G=yield C.json():B==="application/octet-stream"||B==="application/pdf"?G=yield C.blob():B==="text/event-stream"?G=C:B==="multipart/form-data"?G=yield C.formData():G=yield C.text(),{data:G,error:null,response:C}}catch(g){return{data:null,error:g,response:g instanceof Rg||g instanceof Ng?g.context:void 0}}finally{d&&clearTimeout(d)}})}}var qt={};const ar=dv(wv);var xl={},jl={},Sl={},wl={},El={},Cl={},kg;function Dp(){if(kg)return Cl;kg=1,Object.defineProperty(Cl,"__esModule",{value:!0});class o extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}}return Cl.default=o,Cl}var Ug;function Bp(){if(Ug)return El;Ug=1,Object.defineProperty(El,"__esModule",{value:!0});const a=ar.__importDefault(Dp());class s{constructor(u){var d,f;this.shouldThrowOnError=!1,this.method=u.method,this.url=u.url,this.headers=new Headers(u.headers),this.schema=u.schema,this.body=u.body,this.shouldThrowOnError=(d=u.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=u.signal,this.isMaybeSingle=(f=u.isMaybeSingle)!==null&&f!==void 0?f:!1,u.fetch?this.fetch=u.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(u,d){return this.headers=new Headers(this.headers),this.headers.set(u,d),this}then(u,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let g=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,v,x,j;let b=null,w=null,T=null,O=p.status,C=p.statusText;if(p.ok){if(this.method!=="HEAD"){const E=await p.text();E===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?w=E:w=JSON.parse(E))}const B=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),G=(x=p.headers.get("content-range"))===null||x===void 0?void 0:x.split("/");B&&G&&G.length>1&&(T=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(b={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,T=null,O=406,C="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const B=await p.text();try{b=JSON.parse(B),Array.isArray(b)&&p.status===404&&(w=[],b=null,O=200,C="OK")}catch{p.status===404&&B===""?(O=204,C="No Content"):b={message:B}}if(b&&this.isMaybeSingle&&(!((j=b?.details)===null||j===void 0)&&j.includes("0 rows"))&&(b=null,O=200,C="OK"),b&&this.shouldThrowOnError)throw new a.default(b)}return{error:b,data:w,count:T,status:O,statusText:C}});return this.shouldThrowOnError||(g=g.catch(p=>{var m,v,x;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(v=p?.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(x=p?.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),g.then(u,d)}returns(){return this}overrideTypes(){return this}}return El.default=s,El}var zg;function Mp(){if(zg)return wl;zg=1,Object.defineProperty(wl,"__esModule",{value:!0});const a=ar.__importDefault(Bp());class s extends a.default{select(u){let d=!1;const f=(u??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),this.headers.append("Prefer","return=representation"),this}order(u,{ascending:d=!0,nullsFirst:f,foreignTable:g,referencedTable:p=g}={}){const m=p?`${p}.order`:"order",v=this.url.searchParams.get(m);return this.url.searchParams.set(m,`${v?`${v},`:""}${u}.${d?"asc":"desc"}${f===void 0?"":f?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:d,referencedTable:f=d}={}){const g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(g,`${u}`),this}range(u,d,{foreignTable:f,referencedTable:g=f}={}){const p=typeof g>"u"?"offset":`${g}.offset`,m=typeof g>"u"?"limit":`${g}.limit`;return this.url.searchParams.set(p,`${u}`),this.url.searchParams.set(m,`${d-u+1}`),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:u=!1,verbose:d=!1,settings:f=!1,buffers:g=!1,wal:p=!1,format:m="text"}={}){var v;const x=[u?"analyze":null,d?"verbose":null,f?"settings":null,g?"buffers":null,p?"wal":null].filter(Boolean).join("|"),j=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${m}; for="${j}"; options=${x};`),m==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(u){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${u}`),this}}return wl.default=s,wl}var Dg;function Au(){if(Dg)return Sl;Dg=1,Object.defineProperty(Sl,"__esModule",{value:!0});const a=ar.__importDefault(Mp()),s=new RegExp("[,()]");class l extends a.default{eq(d,f){return this.url.searchParams.append(d,`eq.${f}`),this}neq(d,f){return this.url.searchParams.append(d,`neq.${f}`),this}gt(d,f){return this.url.searchParams.append(d,`gt.${f}`),this}gte(d,f){return this.url.searchParams.append(d,`gte.${f}`),this}lt(d,f){return this.url.searchParams.append(d,`lt.${f}`),this}lte(d,f){return this.url.searchParams.append(d,`lte.${f}`),this}like(d,f){return this.url.searchParams.append(d,`like.${f}`),this}likeAllOf(d,f){return this.url.searchParams.append(d,`like(all).{${f.join(",")}}`),this}likeAnyOf(d,f){return this.url.searchParams.append(d,`like(any).{${f.join(",")}}`),this}ilike(d,f){return this.url.searchParams.append(d,`ilike.${f}`),this}ilikeAllOf(d,f){return this.url.searchParams.append(d,`ilike(all).{${f.join(",")}}`),this}ilikeAnyOf(d,f){return this.url.searchParams.append(d,`ilike(any).{${f.join(",")}}`),this}is(d,f){return this.url.searchParams.append(d,`is.${f}`),this}in(d,f){const g=Array.from(new Set(f)).map(p=>typeof p=="string"&&s.test(p)?`"${p}"`:`${p}`).join(",");return this.url.searchParams.append(d,`in.(${g})`),this}contains(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cs.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cs.{${f.join(",")}}`):this.url.searchParams.append(d,`cs.${JSON.stringify(f)}`),this}containedBy(d,f){return typeof f=="string"?this.url.searchParams.append(d,`cd.${f}`):Array.isArray(f)?this.url.searchParams.append(d,`cd.{${f.join(",")}}`):this.url.searchParams.append(d,`cd.${JSON.stringify(f)}`),this}rangeGt(d,f){return this.url.searchParams.append(d,`sr.${f}`),this}rangeGte(d,f){return this.url.searchParams.append(d,`nxl.${f}`),this}rangeLt(d,f){return this.url.searchParams.append(d,`sl.${f}`),this}rangeLte(d,f){return this.url.searchParams.append(d,`nxr.${f}`),this}rangeAdjacent(d,f){return this.url.searchParams.append(d,`adj.${f}`),this}overlaps(d,f){return typeof f=="string"?this.url.searchParams.append(d,`ov.${f}`):this.url.searchParams.append(d,`ov.{${f.join(",")}}`),this}textSearch(d,f,{config:g,type:p}={}){let m="";p==="plain"?m="pl":p==="phrase"?m="ph":p==="websearch"&&(m="w");const v=g===void 0?"":`(${g})`;return this.url.searchParams.append(d,`${m}fts${v}.${f}`),this}match(d){return Object.entries(d).forEach(([f,g])=>{this.url.searchParams.append(f,`eq.${g}`)}),this}not(d,f,g){return this.url.searchParams.append(d,`not.${f}.${g}`),this}or(d,{foreignTable:f,referencedTable:g=f}={}){const p=g?`${g}.or`:"or";return this.url.searchParams.append(p,`(${d})`),this}filter(d,f,g){return this.url.searchParams.append(d,`${f}.${g}`),this}}return Sl.default=l,Sl}var Bg;function qp(){if(Bg)return jl;Bg=1,Object.defineProperty(jl,"__esModule",{value:!0});const a=ar.__importDefault(Au());class s{constructor(u,{headers:d={},schema:f,fetch:g}){this.url=u,this.headers=new Headers(d),this.schema=f,this.fetch=g}select(u,d){const{head:f=!1,count:g}=d??{},p=f?"HEAD":"GET";let m=!1;const v=(u??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",v),g&&this.headers.append("Prefer",`count=${g}`),new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(u,{count:d,defaultToNull:f=!0}={}){var g;const p="POST";if(d&&this.headers.append("Prefer",`count=${d}`),f||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const m=u.reduce((v,x)=>v.concat(Object.keys(x)),[]);if(m.length>0){const v=[...new Set(m)].map(x=>`"${x}"`);this.url.searchParams.set("columns",v.join(","))}}return new a.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}upsert(u,{onConflict:d,ignoreDuplicates:f=!1,count:g,defaultToNull:p=!0}={}){var m;const v="POST";if(this.headers.append("Prefer",`resolution=${f?"ignore":"merge"}-duplicates`),d!==void 0&&this.url.searchParams.set("on_conflict",d),g&&this.headers.append("Prefer",`count=${g}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(u)){const x=u.reduce((j,b)=>j.concat(Object.keys(b)),[]);if(x.length>0){const j=[...new Set(x)].map(b=>`"${b}"`);this.url.searchParams.set("columns",j.join(","))}}return new a.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}update(u,{count:d}={}){var f;const g="PATCH";return d&&this.headers.append("Prefer",`count=${d}`),new a.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}delete({count:u}={}){var d;const f="DELETE";return u&&this.headers.append("Prefer",`count=${u}`),new a.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return jl.default=s,jl}var Mg;function Av(){if(Mg)return xl;Mg=1,Object.defineProperty(xl,"__esModule",{value:!0});const o=ar,a=o.__importDefault(qp()),s=o.__importDefault(Au());class l{constructor(d,{headers:f={},schema:g,fetch:p}={}){this.url=d,this.headers=new Headers(f),this.schemaName=g,this.fetch=p}from(d){const f=new URL(`${this.url}/${d}`);return new a.default(f,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(d){return new l(this.url,{headers:this.headers,schema:d,fetch:this.fetch})}rpc(d,f={},{head:g=!1,get:p=!1,count:m}={}){var v;let x;const j=new URL(`${this.url}/rpc/${d}`);let b;g||p?(x=g?"HEAD":"GET",Object.entries(f).filter(([T,O])=>O!==void 0).map(([T,O])=>[T,Array.isArray(O)?`{${O.join(",")}}`:`${O}`]).forEach(([T,O])=>{j.searchParams.append(T,O)})):(x="POST",b=f);const w=new Headers(this.headers);return m&&w.set("Prefer",`count=${m}`),new s.default({method:x,url:j,headers:w,schema:this.schemaName,body:b,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return xl.default=l,xl}var qg;function Ov(){if(qg)return qt;qg=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.PostgrestError=qt.PostgrestBuilder=qt.PostgrestTransformBuilder=qt.PostgrestFilterBuilder=qt.PostgrestQueryBuilder=qt.PostgrestClient=void 0;const o=ar,a=o.__importDefault(Av());qt.PostgrestClient=a.default;const s=o.__importDefault(qp());qt.PostgrestQueryBuilder=s.default;const l=o.__importDefault(Au());qt.PostgrestFilterBuilder=l.default;const u=o.__importDefault(Mp());qt.PostgrestTransformBuilder=u.default;const d=o.__importDefault(Bp());qt.PostgrestBuilder=d.default;const f=o.__importDefault(Dp());return qt.PostgrestError=f.default,qt.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:d.default,PostgrestError:f.default},qt}var Lp=Ov();const Ip=lp(Lp),Nv=uv({__proto__:null,default:Ip},[Lp]),{PostgrestClient:Rv,PostgrestQueryBuilder:cx,PostgrestFilterBuilder:ux,PostgrestTransformBuilder:dx,PostgrestBuilder:hx,PostgrestError:fx}=Ip||Nv;class kv{static detectEnvironment(){var a;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((a=navigator.userAgent)===null||a===void 0)&&a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const s=process.versions;if(s&&s.node){const l=s.node,u=parseInt(l.replace(/^v/,"").split(".")[0]);return u>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${u} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${u} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const a=this.detectEnvironment();if(a.constructor)return a.constructor;let s=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(s+=`

Suggested solution: ${a.workaround}`),new Error(s)}static createWebSocket(a,s){const l=this.getWebSocketConstructor();return new l(a,s)}static isWebSocketSupported(){try{const a=this.detectEnvironment();return a.type==="native"||a.type==="ws"}catch{return!1}}}const Uv="2.81.1",zv=`realtime-js/${Uv}`,Hp="1.0.0",Dv="2.0.0",Lg=Hp,pu=1e4,Bv=1e3,Mv=100;var ii;(function(o){o[o.connecting=0]="connecting",o[o.open=1]="open",o[o.closing=2]="closing",o[o.closed=3]="closed"})(ii||(ii={}));var Tt;(function(o){o.closed="closed",o.errored="errored",o.joined="joined",o.joining="joining",o.leaving="leaving"})(Tt||(Tt={}));var vn;(function(o){o.close="phx_close",o.error="phx_error",o.join="phx_join",o.reply="phx_reply",o.leave="phx_leave",o.access_token="access_token"})(vn||(vn={}));var mu;(function(o){o.websocket="websocket"})(mu||(mu={}));var ri;(function(o){o.Connecting="connecting",o.Open="open",o.Closing="closing",o.Closed="closed"})(ri||(ri={}));class qv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(a,s){if(this._isArrayBuffer(a.payload))return s(this._binaryEncodePush(a));if(a.event===this.BROADCAST&&!(a.payload instanceof ArrayBuffer)&&typeof a.payload.event=="string")return s(this._binaryEncodeUserBroadcastPush(a));let l=[a.join_ref,a.ref,a.topic,a.event,a.payload];return s(JSON.stringify(l))}_binaryEncodePush(a){const{join_ref:s,ref:l,event:u,topic:d,payload:f}=a,g=this.META_LENGTH+s.length+l.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+g);let m=new DataView(p),v=0;m.setUint8(v++,this.KINDS.push),m.setUint8(v++,s.length),m.setUint8(v++,l.length),m.setUint8(v++,d.length),m.setUint8(v++,u.length),Array.from(s,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(l,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(d,j=>m.setUint8(v++,j.charCodeAt(0))),Array.from(u,j=>m.setUint8(v++,j.charCodeAt(0)));var x=new Uint8Array(p.byteLength+f.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(f),p.byteLength),x.buffer}_binaryEncodeUserBroadcastPush(a){var s;return this._isArrayBuffer((s=a.payload)===null||s===void 0?void 0:s.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:new ArrayBuffer(0),m=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,v=new ArrayBuffer(this.HEADER_LENGTH+m);let x=new DataView(v),j=0;x.setUint8(j++,this.KINDS.userBroadcastPush),x.setUint8(j++,u.length),x.setUint8(j++,d.length),x.setUint8(j++,f.length),x.setUint8(j++,g.length),x.setUint8(j++,this.BINARY_ENCODING),Array.from(u,w=>x.setUint8(j++,w.charCodeAt(0))),Array.from(d,w=>x.setUint8(j++,w.charCodeAt(0))),Array.from(f,w=>x.setUint8(j++,w.charCodeAt(0))),Array.from(g,w=>x.setUint8(j++,w.charCodeAt(0)));var b=new Uint8Array(v.byteLength+p.byteLength);return b.set(new Uint8Array(v),0),b.set(new Uint8Array(p),v.byteLength),b.buffer}_encodeJsonUserBroadcastPush(a){var s,l;const{join_ref:u,ref:d,topic:f}=a,g=a.payload.event,p=(l=(s=a.payload)===null||s===void 0?void 0:s.payload)!==null&&l!==void 0?l:{},v=new TextEncoder().encode(JSON.stringify(p)).buffer,x=this.USER_BROADCAST_PUSH_META_LENGTH+u.length+d.length+f.length+g.length,j=new ArrayBuffer(this.HEADER_LENGTH+x);let b=new DataView(j),w=0;b.setUint8(w++,this.KINDS.userBroadcastPush),b.setUint8(w++,u.length),b.setUint8(w++,d.length),b.setUint8(w++,f.length),b.setUint8(w++,g.length),b.setUint8(w++,this.JSON_ENCODING),Array.from(u,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(d,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(f,O=>b.setUint8(w++,O.charCodeAt(0))),Array.from(g,O=>b.setUint8(w++,O.charCodeAt(0)));var T=new Uint8Array(j.byteLength+v.byteLength);return T.set(new Uint8Array(j),0),T.set(new Uint8Array(v),j.byteLength),T.buffer}decode(a,s){if(this._isArrayBuffer(a)){let l=this._binaryDecode(a);return s(l)}if(typeof a=="string"){const l=JSON.parse(a),[u,d,f,g,p]=l;return s({join_ref:u,ref:d,topic:f,event:g,payload:p})}return s({})}_binaryDecode(a){const s=new DataView(a),l=s.getUint8(0),u=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(a,s,u);case this.KINDS.reply:return this._decodeReply(a,s,u);case this.KINDS.broadcast:return this._decodeBroadcast(a,s,u);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(a,s,u)}}_decodePush(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3);let g=this.HEADER_LENGTH+this.META_LENGTH-1;const p=l.decode(a.slice(g,g+u));g=g+u;const m=l.decode(a.slice(g,g+d));g=g+d;const v=l.decode(a.slice(g,g+f));g=g+f;const x=JSON.parse(l.decode(a.slice(g,a.byteLength)));return{join_ref:p,ref:null,topic:m,event:v,payload:x}}_decodeReply(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+this.META_LENGTH;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+f));p=p+f;const j=l.decode(a.slice(p,p+g));p=p+g;const b=JSON.parse(l.decode(a.slice(p,a.byteLength))),w={status:j,response:b};return{join_ref:m,ref:v,topic:x,event:vn.reply,payload:w}}_decodeBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2);let f=this.HEADER_LENGTH+2;const g=l.decode(a.slice(f,f+u));f=f+u;const p=l.decode(a.slice(f,f+d));f=f+d;const m=JSON.parse(l.decode(a.slice(f,a.byteLength)));return{join_ref:null,ref:null,topic:g,event:p,payload:m}}_decodeUserBroadcast(a,s,l){const u=s.getUint8(1),d=s.getUint8(2),f=s.getUint8(3),g=s.getUint8(4);let p=this.HEADER_LENGTH+4;const m=l.decode(a.slice(p,p+u));p=p+u;const v=l.decode(a.slice(p,p+d));p=p+d;const x=l.decode(a.slice(p,p+f));p=p+f;const j=a.slice(p,a.byteLength),b=g===this.JSON_ENCODING?JSON.parse(l.decode(j)):j,w={type:this.BROADCAST,event:v,payload:b};return f>0&&(w.meta=JSON.parse(x)),{join_ref:null,ref:null,topic:m,event:this.BROADCAST,payload:w}}_isArrayBuffer(a){var s;return a instanceof ArrayBuffer||((s=a?.constructor)===null||s===void 0?void 0:s.name)==="ArrayBuffer"}}class Vp{constructor(a,s){this.callback=a,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var st;(function(o){o.abstime="abstime",o.bool="bool",o.date="date",o.daterange="daterange",o.float4="float4",o.float8="float8",o.int2="int2",o.int4="int4",o.int4range="int4range",o.int8="int8",o.int8range="int8range",o.json="json",o.jsonb="jsonb",o.money="money",o.numeric="numeric",o.oid="oid",o.reltime="reltime",o.text="text",o.time="time",o.timestamp="timestamp",o.timestamptz="timestamptz",o.timetz="timetz",o.tsrange="tsrange",o.tstzrange="tstzrange"})(st||(st={}));const Ig=(o,a,s={})=>{var l;const u=(l=s.skipTypes)!==null&&l!==void 0?l:[];return a?Object.keys(a).reduce((d,f)=>(d[f]=Lv(f,o,a,u),d),{}):{}},Lv=(o,a,s,l)=>{const u=a.find(g=>g.name===o),d=u?.type,f=s[o];return d&&!l.includes(d)?$p(d,f):yu(f)},$p=(o,a)=>{if(o.charAt(0)==="_"){const s=o.slice(1,o.length);return $v(a,s)}switch(o){case st.bool:return Iv(a);case st.float4:case st.float8:case st.int2:case st.int4:case st.int8:case st.numeric:case st.oid:return Hv(a);case st.json:case st.jsonb:return Vv(a);case st.timestamp:return Pv(a);case st.abstime:case st.date:case st.daterange:case st.int4range:case st.int8range:case st.money:case st.reltime:case st.text:case st.time:case st.timestamptz:case st.timetz:case st.tsrange:case st.tstzrange:return yu(a);default:return yu(a)}},yu=o=>o,Iv=o=>{switch(o){case"t":return!0;case"f":return!1;default:return o}},Hv=o=>{if(typeof o=="string"){const a=parseFloat(o);if(!Number.isNaN(a))return a}return o},Vv=o=>{if(typeof o=="string")try{return JSON.parse(o)}catch(a){return console.log(`JSON parse error: ${a}`),o}return o},$v=(o,a)=>{if(typeof o!="string")return o;const s=o.length-1,l=o[s];if(o[0]==="{"&&l==="}"){let d;const f=o.slice(1,s);try{d=JSON.parse("["+f+"]")}catch{d=f?f.split(","):[]}return d.map(g=>$p(a,g))}return o},Pv=o=>typeof o=="string"?o.replace(" ","T"):o,Pp=o=>{const a=new URL(o);return a.protocol=a.protocol.replace(/^ws/i,"http"),a.pathname=a.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),a.pathname===""||a.pathname==="/"?a.pathname="/api/broadcast":a.pathname=a.pathname+"/api/broadcast",a.href};class au{constructor(a,s,l={},u=pu){this.channel=a,this.event=s,this.payload=l,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,s){var l;return this._hasReceived(a)&&s((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:a,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const a=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:s}){this.recHooks.filter(l=>l.status===a).forEach(l=>l.callback(s))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}var Hg;(function(o){o.SYNC="sync",o.JOIN="join",o.LEAVE="leave"})(Hg||(Hg={}));class Fr{constructor(a,s){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=s?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fr.syncState(this.state,u,d,f),this.pendingDiffs.forEach(p=>{this.state=Fr.syncDiff(this.state,p,d,f)}),this.pendingDiffs=[],g()}),this.channel._on(l.diff,{},u=>{const{onJoin:d,onLeave:f,onSync:g}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=Fr.syncDiff(this.state,u,d,f),g())}),this.onJoin((u,d,f)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:f})}),this.onLeave((u,d,f)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,s,l,u){const d=this.cloneDeep(a),f=this.transformState(s),g={},p={};return this.map(d,(m,v)=>{f[m]||(p[m]=v)}),this.map(f,(m,v)=>{const x=d[m];if(x){const j=v.map(O=>O.presence_ref),b=x.map(O=>O.presence_ref),w=v.filter(O=>b.indexOf(O.presence_ref)<0),T=x.filter(O=>j.indexOf(O.presence_ref)<0);w.length>0&&(g[m]=w),T.length>0&&(p[m]=T)}else g[m]=v}),this.syncDiff(d,{joins:g,leaves:p},l,u)}static syncDiff(a,s,l,u){const{joins:d,leaves:f}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return l||(l=()=>{}),u||(u=()=>{}),this.map(d,(g,p)=>{var m;const v=(m=a[g])!==null&&m!==void 0?m:[];if(a[g]=this.cloneDeep(p),v.length>0){const x=a[g].map(b=>b.presence_ref),j=v.filter(b=>x.indexOf(b.presence_ref)<0);a[g].unshift(...j)}l(g,v,p)}),this.map(f,(g,p)=>{let m=a[g];if(!m)return;const v=p.map(x=>x.presence_ref);m=m.filter(x=>v.indexOf(x.presence_ref)<0),a[g]=m,u(g,m,p),m.length===0&&delete a[g]}),a}static map(a,s){return Object.getOwnPropertyNames(a).map(l=>s(l,a[l]))}static transformState(a){return a=this.cloneDeep(a),Object.getOwnPropertyNames(a).reduce((s,l)=>{const u=a[l];return"metas"in u?s[l]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):s[l]=u,s},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Vg;(function(o){o.ALL="*",o.INSERT="INSERT",o.UPDATE="UPDATE",o.DELETE="DELETE"})(Vg||(Vg={}));var Zr;(function(o){o.BROADCAST="broadcast",o.PRESENCE="presence",o.POSTGRES_CHANGES="postgres_changes",o.SYSTEM="system"})(Zr||(Zr={}));var aa;(function(o){o.SUBSCRIBED="SUBSCRIBED",o.TIMED_OUT="TIMED_OUT",o.CLOSED="CLOSED",o.CHANNEL_ERROR="CHANNEL_ERROR"})(aa||(aa={}));class Ou{constructor(a,s={config:{}},l){var u,d;if(this.topic=a,this.params=s,this.socket=l,this.bindings={},this.state=Tt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new au(this,vn.join,this.params,this.timeout),this.rejoinTimer=new Vp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Tt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Tt.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vn.reply,{},(f,g)=>{this._trigger(this._replyEventName(g),f)}),this.presence=new Fr(this),this.broadcastEndpointURL=Pp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,s=this.timeout){var l,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==Tt.closed){const{config:{broadcast:f,presence:g,private:p}}=this.params,m=(u=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(b=>b.filter))!==null&&u!==void 0?u:[],v=!!this.bindings[Zr.PRESENCE]&&this.bindings[Zr.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,x={},j={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:v}),postgres_changes:m,private:p};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>a?.(aa.CHANNEL_ERROR,b)),this._onClose(()=>a?.(aa.CLOSED)),this.updateJoinPayload(Object.assign({config:j},x)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:b})=>{var w;if(this.socket.setAuth(),b===void 0){a?.(aa.SUBSCRIBED);return}else{const T=this.bindings.postgres_changes,O=(w=T?.length)!==null&&w!==void 0?w:0,C=[];for(let M=0;M<O;M++){const B=T[M],{filter:{event:G,schema:E,table:q,filter:U}}=B,H=b&&b[M];if(H&&H.event===G&&H.schema===E&&H.table===q&&H.filter===U)C.push(Object.assign(Object.assign({},B),{id:H.id}));else{this.unsubscribe(),this.state=Tt.errored,a?.(aa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,a&&a(aa.SUBSCRIBED);return}}).receive("error",b=>{this.state=Tt.errored,a?.(aa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{a?.(aa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,s={}){return await this.send({type:"presence",event:"track",payload:a},s.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,s,l){return this.state===Tt.joined&&a===Zr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(a,s,l)}async httpSend(a,s,l={}){var u;const d=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(s==null)return Promise.reject("Payload is required for httpSend()");const f={method:"POST",headers:{Authorization:d,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(u=l.timeout)!==null&&u!==void 0?u:this.timeout);if(g.status===202)return{success:!0};let p=g.statusText;try{const m=await g.json();p=m.error||m.message||p}catch{}return Promise.reject(new Error(p))}async send(a,s={}){var l,u;if(!this._canPush()&&a.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:f}=a,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:f,private:this.private}]})};try{const m=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(l=s.timeout)!==null&&l!==void 0?l:this.timeout);return await((u=m.body)===null||u===void 0?void 0:u.cancel()),m.ok?"ok":"error"}catch(m){return m.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var f,g,p;const m=this._push(a.type,a,s.timeout||this.timeout);a.type==="broadcast"&&!(!((p=(g=(f=this.params)===null||f===void 0?void 0:f.config)===null||g===void 0?void 0:g.broadcast)===null||p===void 0)&&p.ack)&&d("ok"),m.receive("ok",()=>d("ok")),m.receive("error",()=>d("error")),m.receive("timeout",()=>d("timed out"))})}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=Tt.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vn.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(u=>{l=new au(this,vn.leave,{},a),l.receive("ok",()=>{s(),u("ok")}).receive("timeout",()=>{s(),u("timed out")}).receive("error",()=>{u("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Tt.closed,this.bindings={}}async _fetchWithTimeout(a,s,l){const u=new AbortController,d=setTimeout(()=>u.abort(),l),f=await this.socket.fetch(a,Object.assign(Object.assign({},s),{signal:u.signal}));return clearTimeout(d),f}_push(a,s,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new au(this,a,s,l);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>Mv){const s=this.pushBuffer.shift();s&&(s.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${s.event}`,s.payload))}}_onMessage(a,s,l){return s}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,s,l){var u,d;const f=a.toLocaleLowerCase(),{close:g,error:p,leave:m,join:v}=vn;if(l&&[g,p,m,v].indexOf(f)>=0&&l!==this._joinRef())return;let j=this._onMessage(f,s,l);if(s&&!j)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(b=>{var w,T,O;return((w=b.filter)===null||w===void 0?void 0:w.event)==="*"||((O=(T=b.filter)===null||T===void 0?void 0:T.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===f}).map(b=>b.callback(j,l)):(d=this.bindings[f])===null||d===void 0||d.filter(b=>{var w,T,O,C,M,B;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in b){const G=b.id,E=(w=b.filter)===null||w===void 0?void 0:w.event;return G&&((T=s.ids)===null||T===void 0?void 0:T.includes(G))&&(E==="*"||E?.toLocaleLowerCase()===((O=s.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const G=(M=(C=b?.filter)===null||C===void 0?void 0:C.event)===null||M===void 0?void 0:M.toLocaleLowerCase();return G==="*"||G===((B=s?.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===f}).map(b=>{if(typeof j=="object"&&"ids"in j){const w=j.data,{schema:T,table:O,commit_timestamp:C,type:M,errors:B}=w;j=Object.assign(Object.assign({},{schema:T,table:O,commit_timestamp:C,eventType:M,new:{},old:{},errors:B}),this._getPayloadRecords(w))}b.callback(j,l)})}_isClosed(){return this.state===Tt.closed}_isJoined(){return this.state===Tt.joined}_isJoining(){return this.state===Tt.joining}_isLeaving(){return this.state===Tt.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,s,l){const u=a.toLocaleLowerCase(),d={type:u,filter:s,callback:l};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(a,s){const l=a.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===l&&Ou.isEqual(u.filter,s))})),this}static isEqual(a,s){if(Object.keys(a).length!==Object.keys(s).length)return!1;for(const l in a)if(a[l]!==s[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(vn.close,{},a)}_onError(a){this._on(vn.error,{},s=>a(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Tt.joining,this.joinPush.resend(a))}_getPayloadRecords(a){const s={new:{},old:{}};return(a.type==="INSERT"||a.type==="UPDATE")&&(s.new=Ig(a.columns,a.record)),(a.type==="UPDATE"||a.type==="DELETE")&&(s.old=Ig(a.columns,a.old_record)),s}}const iu=()=>{},Tl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Gv=[1e3,2e3,5e3,1e4],Kv=1e4,Yv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jv{constructor(a,s){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=pu,this.transport=null,this.heartbeatIntervalMs=Tl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=iu,this.ref=0,this.reconnectTimer=null,this.vsn=Lg,this.logger=iu,this.conn=null,this.sendBuffer=[],this.serializer=new qv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((l=s?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=s.params.apikey,this.endPoint=`${a}/${mu.websocket}`,this.httpEndpoint=Pp(a),this._initializeOptions(s),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(s?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=kv.createWebSocket(this.endpointURL())}catch(a){this._setConnectionState("disconnected");const s=a.message;throw s.includes("Node.js")?new Error(`${s}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${s}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,s){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(a?this.conn.close(a,s??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){const s=await a.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const a=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,s,l){this.logger(a,s,l)}connectionState(){switch(this.conn&&this.conn.readyState){case ii.connecting:return ri.Connecting;case ii.open:return ri.Open;case ii.closing:return ri.Closing;default:return ri.Closed}}isConnected(){return this.connectionState()===ri.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(a,s={config:{}}){const l=`realtime:${a}`,u=this.getChannels().find(d=>d.topic===l);if(u)return u;{const d=new Ou(`realtime:${a}`,s,this);return this.channels.push(d),d}}push(a){const{topic:s,event:l,payload:u,ref:d}=a,f=()=>{this.encode(a,g=>{var p;(p=this.conn)===null||p===void 0||p.send(g)})};this.log("push",`${s} ${l} (${d})`,u),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(s){this.log("error","error in heartbeat callback",s)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(s){this.log("error","error in heartbeat callback",s)}this._wasManualDisconnect=!1,(a=this.conn)===null||a===void 0||a.close(Bv,"heartbeat timeout"),setTimeout(()=>{var s;this.isConnected()||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout()},Tl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(s){this.log("error","error in heartbeat callback",s)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let s=this.channels.find(l=>l.topic===a&&(l._isJoined()||l._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${a}"`),s.unsubscribe())}_remove(a){this.channels=this.channels.filter(s=>s.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,s=>{if(s.topic==="phoenix"&&s.event==="phx_reply")try{this.heartbeatCallback(s.payload.status==="ok"?"ok":"error")}catch(m){this.log("error","error in heartbeat callback",m)}s.ref&&s.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:u,payload:d,ref:f}=s,g=f?`(${f})`:"",p=d.status||"";this.log("receive",`${p} ${l} ${u} ${g}`.trim(),d),this.channels.filter(m=>m._isMember(l)).forEach(m=>m._trigger(u,d,f)),this._triggerStateCallbacks("message",s)})}_clearTimer(a){var s;a==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):a==="reconnect"&&((s=this.reconnectTimer)===null||s===void 0||s.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ii.open||this.conn.readyState===ii.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(s=>{this.log("error","error waiting for auth on connect",s),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(a){var s;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(s=this.reconnectTimer)===null||s===void 0||s.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(vn.error))}_appendParams(a,s){if(Object.keys(s).length===0)return a;const l=a.match(/\?/)?"&":"?",u=new URLSearchParams(s);return`${a}${l}${u}`}_workerObjectUrl(a){let s;if(a)s=a;else{const l=new Blob([Yv],{type:"application/javascript"});s=URL.createObjectURL(l)}return s}_setConnectionState(a,s=!1){this._connectionState=a,a==="connecting"?this._wasManualDisconnect=!1:a==="disconnecting"&&(this._wasManualDisconnect=s)}async _performAuth(a=null){let s;a?s=a:this.accessToken?s=await this.accessToken():s=this.accessTokenValue,this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(l=>{const u={access_token:s,version:zv};s&&l.updateJoinPayload(u),l.joinedOnce&&l._isJoined()&&l._push(vn.access_token,{access_token:s})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this.setAuth().catch(s=>{this.log("error",`error setting auth in ${a}`,s)})}_triggerStateCallbacks(a,s){try{this.stateChangeCallbacks[a].forEach(l=>{try{l(s)}catch(u){this.log("error",`error in ${a} callback`,u)}})}catch(l){this.log("error",`error triggering ${a} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new Vp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Tl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var s,l,u,d,f,g,p,m,v,x,j,b;switch(this.transport=(s=a?.transport)!==null&&s!==void 0?s:null,this.timeout=(l=a?.timeout)!==null&&l!==void 0?l:pu,this.heartbeatIntervalMs=(u=a?.heartbeatIntervalMs)!==null&&u!==void 0?u:Tl.HEARTBEAT_INTERVAL,this.worker=(d=a?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(f=a?.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(g=a?.heartbeatCallback)!==null&&g!==void 0?g:iu,this.vsn=(p=a?.vsn)!==null&&p!==void 0?p:Lg,a?.params&&(this.params=a.params),a?.logger&&(this.logger=a.logger),(a?.logLevel||a?.log_level)&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=a?.reconnectAfterMs)!==null&&m!==void 0?m:(w=>Gv[w-1]||Kv),this.vsn){case Hp:this.encode=(v=a?.encode)!==null&&v!==void 0?v:((w,T)=>T(JSON.stringify(w))),this.decode=(x=a?.decode)!==null&&x!==void 0?x:((w,T)=>T(JSON.parse(w)));break;case Dv:this.encode=(j=a?.encode)!==null&&j!==void 0?j:this.serializer.encode.bind(this.serializer),this.decode=(b=a?.decode)!==null&&b!==void 0?b:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=a?.workerUrl}}}class Nu extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}}function ft(o){return typeof o=="object"&&o!==null&&"__isStorageError"in o}class Qv extends Nu{constructor(a,s,l){super(a),this.name="StorageApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class vu extends Nu{constructor(a,s){super(a),this.name="StorageUnknownError",this.originalError=s}}const Ru=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Xv=()=>Response,bu=o=>{if(Array.isArray(o))return o.map(s=>bu(s));if(typeof o=="function"||o!==Object(o))return o;const a={};return Object.entries(o).forEach(([s,l])=>{const u=s.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));a[u]=bu(l)}),a},Fv=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},ru=o=>{var a;return o.msg||o.message||o.error_description||(typeof o.error=="string"?o.error:(a=o.error)===null||a===void 0?void 0:a.message)||JSON.stringify(o)},Zv=(o,a,s)=>Ee(void 0,void 0,void 0,function*(){const l=yield Xv();o instanceof l&&!s?.noResolveJson?o.json().then(u=>{const d=o.status||500,f=u?.statusCode||d+"";a(new Qv(ru(u),d,f))}).catch(u=>{a(new vu(ru(u),u))}):a(new vu(ru(o),o))}),Wv=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"||!l?u:(Fv(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,a?.duplex&&(u.duplex=a.duplex),Object.assign(Object.assign({},u),s))};function ns(o,a,s,l,u,d){return Ee(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,Wv(a,l,u,d)).then(p=>{if(!p.ok)throw p;return l?.noResolveJson?p:p.json()}).then(p=>f(p)).catch(p=>Zv(p,g,l))})})}function Wr(o,a,s,l){return Ee(this,void 0,void 0,function*(){return ns(o,"GET",a,s,l)})}function Tn(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return ns(o,"POST",a,l,u,s)})}function _u(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return ns(o,"PUT",a,l,u,s)})}function eb(o,a,s,l){return Ee(this,void 0,void 0,function*(){return ns(o,"HEAD",a,Object.assign(Object.assign({},s),{noResolveJson:!0}),l)})}function ku(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return ns(o,"DELETE",a,l,u,s)})}class tb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s}then(a,s){return this.execute().then(a,s)}execute(){return Ee(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}}var Gp;class nb{constructor(a,s){this.downloadFn=a,this.shouldThrowOnError=s,this[Gp]="BlobDownloadBuilder",this.promise=null}asStream(){return new tb(this.downloadFn,this.shouldThrowOnError)}then(a,s){return this.getPromise().then(a,s)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return Ee(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ft(a))return{data:null,error:a};throw a}})}}Gp=Symbol.toStringTag;const ab={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$g={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ib{constructor(a,s={},l,u){this.shouldThrowOnError=!1,this.url=a,this.headers=s,this.bucketId=l,this.fetch=Ru(u)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(a,s,l,u){return Ee(this,void 0,void 0,function*(){try{let d;const f=Object.assign(Object.assign({},$g),u);let g=Object.assign(Object.assign({},this.headers),a==="POST"&&{"x-upsert":String(f.upsert)});const p=f.metadata;typeof Blob<"u"&&l instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),p&&d.append("metadata",this.encodeMetadata(p)),d.append("",l)):typeof FormData<"u"&&l instanceof FormData?(d=l,d.has("cacheControl")||d.append("cacheControl",f.cacheControl),p&&!d.has("metadata")&&d.append("metadata",this.encodeMetadata(p))):(d=l,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,p&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(p))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!f.duplex&&(f.duplex="half")),u?.headers&&(g=Object.assign(Object.assign({},g),u.headers));const m=this._removeEmptyFolders(s),v=this._getFinalPath(m),x=yield(a=="PUT"?_u:Tn)(this.fetch,`${this.url}/object/${v}`,d,Object.assign({headers:g},f?.duplex?{duplex:f.duplex}:{}));return{data:{path:m,id:x.Id,fullPath:x.Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(ft(d))return{data:null,error:d};throw d}})}upload(a,s,l){return Ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",a,s,l)})}uploadToSignedUrl(a,s,l,u){return Ee(this,void 0,void 0,function*(){const d=this._removeEmptyFolders(a),f=this._getFinalPath(d),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",s);try{let p;const m=Object.assign({upsert:$g.upsert},u),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(m.upsert)});typeof Blob<"u"&&l instanceof Blob?(p=new FormData,p.append("cacheControl",m.cacheControl),p.append("",l)):typeof FormData<"u"&&l instanceof FormData?(p=l,p.append("cacheControl",m.cacheControl)):(p=l,v["cache-control"]=`max-age=${m.cacheControl}`,v["content-type"]=m.contentType);const x=yield _u(this.fetch,g.toString(),p,{headers:v});return{data:{path:d,fullPath:x.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(ft(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(a,s){return Ee(this,void 0,void 0,function*(){try{let l=this._getFinalPath(a);const u=Object.assign({},this.headers);s?.upsert&&(u["x-upsert"]="true");const d=yield Tn(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:u}),f=new URL(this.url+d.url),g=f.searchParams.get("token");if(!g)throw new Nu("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l))return{data:null,error:l};throw l}})}update(a,s,l){return Ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",a,s,l)})}move(a,s,l){return Ee(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ft(u))return{data:null,error:u};throw u}})}copy(a,s,l){return Ee(this,void 0,void 0,function*(){try{return{data:{path:(yield Tn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:s,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ft(u))return{data:null,error:u};throw u}})}createSignedUrl(a,s,l){return Ee(this,void 0,void 0,function*(){try{let u=this._getFinalPath(a),d=yield Tn(this.fetch,`${this.url}/object/sign/${u}`,Object.assign({expiresIn:s},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const f=l?.download?`&download=${l.download===!0?"":l.download}`:"";return d={signedUrl:encodeURI(`${this.url}${d.signedURL}${f}`)},{data:d,error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ft(u))return{data:null,error:u};throw u}})}createSignedUrls(a,s,l){return Ee(this,void 0,void 0,function*(){try{const u=yield Tn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:a},{headers:this.headers}),d=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:u.map(f=>Object.assign(Object.assign({},f),{signedUrl:f.signedURL?encodeURI(`${this.url}${f.signedURL}${d}`):null})),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ft(u))return{data:null,error:u};throw u}})}download(a,s){const u=typeof s?.transform<"u"?"render/image/authenticated":"object",d=this.transformOptsToQueryString(s?.transform||{}),f=d?`?${d}`:"",g=this._getFinalPath(a),p=()=>Wr(this.fetch,`${this.url}/${u}/${g}${f}`,{headers:this.headers,noResolveJson:!0});return new nb(p,this.shouldThrowOnError)}info(a){return Ee(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{const l=yield Wr(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:bu(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l))return{data:null,error:l};throw l}})}exists(a){return Ee(this,void 0,void 0,function*(){const s=this._getFinalPath(a);try{return yield eb(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l)&&l instanceof vu){const u=l.originalError;if([400,404].includes(u?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(a,s){const l=this._getFinalPath(a),u=[],d=s?.download?`download=${s.download===!0?"":s.download}`:"";d!==""&&u.push(d);const g=typeof s?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(s?.transform||{});p!==""&&u.push(p);let m=u.join("&");return m!==""&&(m=`?${m}`),{data:{publicUrl:encodeURI(`${this.url}/${g}/public/${l}${m}`)}}}remove(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield ku(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}list(a,s,l){return Ee(this,void 0,void 0,function*(){try{const u=Object.assign(Object.assign(Object.assign({},ab),s),{prefix:a||""});return{data:yield Tn(this.fetch,`${this.url}/object/list/${this.bucketId}`,u,{headers:this.headers},l),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ft(u))return{data:null,error:u};throw u}})}listV2(a,s){return Ee(this,void 0,void 0,function*(){try{const l=Object.assign({},a);return{data:yield Tn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},s),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l))return{data:null,error:l};throw l}})}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return typeof Buffer<"u"?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){const s=[];return a.width&&s.push(`width=${a.width}`),a.height&&s.push(`height=${a.height}`),a.resize&&s.push(`resize=${a.resize}`),a.format&&s.push(`format=${a.format}`),a.quality&&s.push(`quality=${a.quality}`),s.join("&")}}const Kp="2.81.1",Yp={"X-Client-Info":`storage-js/${Kp}`};class rb{constructor(a,s={},l,u){this.shouldThrowOnError=!1;const d=new URL(a);u?.useNewHostname&&/supabase\.(co|in|red)$/.test(d.hostname)&&!d.hostname.includes("storage.supabase.")&&(d.hostname=d.hostname.replace("supabase.","storage.supabase.")),this.url=d.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=Ru(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(a){return Ee(this,void 0,void 0,function*(){try{const s=this.listBucketOptionsToQueryString(a);return{data:yield Wr(this.fetch,`${this.url}/bucket${s}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}getBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield Wr(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}createBucket(a){return Ee(this,arguments,void 0,function*(s,l={public:!1}){try{return{data:yield Tn(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(ft(u))return{data:null,error:u};throw u}})}updateBucket(a,s){return Ee(this,void 0,void 0,function*(){try{return{data:yield _u(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ft(l))return{data:null,error:l};throw l}})}emptyBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield ku(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}listBucketOptionsToQueryString(a){const s={};return a&&("limit"in a&&(s.limit=String(a.limit)),"offset"in a&&(s.offset=String(a.offset)),a.search&&(s.search=a.search),a.sortColumn&&(s.sortColumn=a.sortColumn),a.sortOrder&&(s.sortOrder=a.sortOrder)),Object.keys(s).length>0?"?"+new URLSearchParams(s).toString():""}}class sb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Yp),s),this.fetch=Ru(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}listBuckets(a){return Ee(this,void 0,void 0,function*(){try{const s=new URLSearchParams;a?.limit!==void 0&&s.set("limit",a.limit.toString()),a?.offset!==void 0&&s.set("offset",a.offset.toString()),a?.sortColumn&&s.set("sortColumn",a.sortColumn),a?.sortOrder&&s.set("sortOrder",a.sortOrder),a?.search&&s.set("search",a.search);const l=s.toString(),u=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield Wr(this.fetch,u,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield ku(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ft(s))return{data:null,error:s};throw s}})}}const Uu={"X-Client-Info":`storage-js/${Kp}`,"Content-Type":"application/json"};class Jp extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function rn(o){return typeof o=="object"&&o!==null&&"__isStorageVectorsError"in o}class su extends Jp{constructor(a,s,l){super(a),this.name="StorageVectorsApiError",this.status=s,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lb extends Jp{constructor(a,s){super(a),this.name="StorageVectorsUnknownError",this.originalError=s}}var Pg;(function(o){o.InternalError="InternalError",o.S3VectorConflictException="S3VectorConflictException",o.S3VectorNotFoundException="S3VectorNotFoundException",o.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",o.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",o.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Pg||(Pg={}));const zu=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),ob=o=>{if(typeof o!="object"||o===null)return!1;const a=Object.getPrototypeOf(o);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Symbol.toStringTag in o)&&!(Symbol.iterator in o)},Gg=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),cb=(o,a,s)=>Ee(void 0,void 0,void 0,function*(){if(o&&typeof o=="object"&&"status"in o&&"ok"in o&&typeof o.status=="number"&&!s?.noResolveJson){const u=o.status||500,d=o;if(typeof d.json=="function")d.json().then(f=>{const g=f?.statusCode||f?.code||u+"";a(new su(Gg(f),u,g))}).catch(()=>{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new su(g,u,f))});else{const f=u+"",g=d.statusText||`HTTP ${u} error`;a(new su(g,u,f))}}else a(new lb(Gg(o),o))}),ub=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return l?(ob(l)?(u.headers=Object.assign({"Content-Type":"application/json"},a?.headers),u.body=JSON.stringify(l)):u.body=l,Object.assign(Object.assign({},u),s)):u};function db(o,a,s,l,u,d){return Ee(this,void 0,void 0,function*(){return new Promise((f,g)=>{o(s,ub(a,l,u,d)).then(p=>{if(!p.ok)throw p;if(l?.noResolveJson)return p;const m=p.headers.get("content-type");return!m||!m.includes("application/json")?{}:p.json()}).then(p=>f(p)).catch(p=>cb(p,g,l))})})}function sn(o,a,s,l,u){return Ee(this,void 0,void 0,function*(){return db(o,"POST",a,l,u,s)})}class hb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Uu),s),this.fetch=zu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(a){return Ee(this,void 0,void 0,function*(){try{return{data:(yield sn(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}getIndex(a,s){return Ee(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(rn(l))return{data:null,error:l};throw l}})}listIndexes(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}deleteIndex(a,s){return Ee(this,void 0,void 0,function*(){try{return{data:(yield sn(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:s},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(rn(l))return{data:null,error:l};throw l}})}}class fb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Uu),s),this.fetch=zu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(a){return Ee(this,void 0,void 0,function*(){try{if(a.vectors.length<1||a.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield sn(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}getVectors(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}listVectors(a){return Ee(this,void 0,void 0,function*(){try{if(a.segmentCount!==void 0){if(a.segmentCount<1||a.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(a.segmentIndex!==void 0&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw new Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:yield sn(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}queryVectors(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}deleteVectors(a){return Ee(this,void 0,void 0,function*(){try{if(a.keys.length<1||a.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield sn(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}}class gb{constructor(a,s={},l){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Uu),s),this.fetch=zu(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:(yield sn(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}getBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:yield sn(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}listBuckets(){return Ee(this,arguments,void 0,function*(a={}){try{return{data:yield sn(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}deleteBucket(a){return Ee(this,void 0,void 0,function*(){try{return{data:(yield sn(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(rn(s))return{data:null,error:s};throw s}})}}class pb extends gb{constructor(a,s={}){super(a,s.headers||{},s.fetch)}from(a){return new mb(this.url,this.headers,a,this.fetch)}}class mb extends hb{constructor(a,s,l,u){super(a,s,u),this.vectorBucketName=l}createIndex(a){const s=Object.create(null,{createIndex:{get:()=>super.createIndex}});return Ee(this,void 0,void 0,function*(){return s.createIndex.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const a=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return Ee(this,arguments,void 0,function*(s={}){return a.listIndexes.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName}))})}getIndex(a){const s=Object.create(null,{getIndex:{get:()=>super.getIndex}});return Ee(this,void 0,void 0,function*(){return s.getIndex.call(this,this.vectorBucketName,a)})}deleteIndex(a){const s=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return Ee(this,void 0,void 0,function*(){return s.deleteIndex.call(this,this.vectorBucketName,a)})}index(a){return new yb(this.url,this.headers,this.vectorBucketName,a,this.fetch)}}class yb extends fb{constructor(a,s,l,u,d){super(a,s,d),this.vectorBucketName=l,this.indexName=u}putVectors(a){const s=Object.create(null,{putVectors:{get:()=>super.putVectors}});return Ee(this,void 0,void 0,function*(){return s.putVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(a){const s=Object.create(null,{getVectors:{get:()=>super.getVectors}});return Ee(this,void 0,void 0,function*(){return s.getVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const a=Object.create(null,{listVectors:{get:()=>super.listVectors}});return Ee(this,arguments,void 0,function*(s={}){return a.listVectors.call(this,Object.assign(Object.assign({},s),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(a){const s=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return Ee(this,void 0,void 0,function*(){return s.queryVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(a){const s=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return Ee(this,void 0,void 0,function*(){return s.deleteVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class vb extends rb{constructor(a,s={},l,u){super(a,s,l,u)}from(a){return new ib(this.url,this.headers,a,this.fetch)}get vectors(){return new pb(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new sb(this.url+"/iceberg",this.headers,this.fetch)}}const bb="2.81.1";let Xr="";typeof Deno<"u"?Xr="deno":typeof document<"u"?Xr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xr="react-native":Xr="node";const _b={"X-Client-Info":`supabase-js-${Xr}/${bb}`},xb={headers:_b},jb={schema:"public"},Sb={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wb={},Eb=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Cb=()=>Headers,Tb=(o,a,s)=>{const l=Eb(s),u=Cb();return async(d,f)=>{var g;const p=(g=await a())!==null&&g!==void 0?g:o;let m=new u(f?.headers);return m.has("apikey")||m.set("apikey",o),m.has("Authorization")||m.set("Authorization",`Bearer ${p}`),l(d,Object.assign(Object.assign({},f),{headers:m}))}};function Ab(o){return o.endsWith("/")?o:o+"/"}function Ob(o,a){var s,l;const{db:u,auth:d,realtime:f,global:g}=o,{db:p,auth:m,realtime:v,global:x}=a,j={db:Object.assign(Object.assign({},p),u),auth:Object.assign(Object.assign({},m),d),realtime:Object.assign(Object.assign({},v),f),storage:{},global:Object.assign(Object.assign(Object.assign({},x),g),{headers:Object.assign(Object.assign({},(s=x?.headers)!==null&&s!==void 0?s:{}),(l=g?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return o.accessToken?j.accessToken=o.accessToken:delete j.accessToken,j}function Nb(o){const a=o?.trim();if(!a)throw new Error("supabaseUrl is required.");if(!a.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ab(a))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Qp="2.81.1",Zi=30*1e3,xu=3,lu=xu*Zi,Rb="http://localhost:9999",kb="supabase.auth.token",Ub={"X-Client-Info":`gotrue-js/${Qp}`},ju="X-Supabase-Api-Version",Xp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},zb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Db=600*1e3;class es extends Error{constructor(a,s,l){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=l}}function Ce(o){return typeof o=="object"&&o!==null&&"__isAuthError"in o}class Bb extends es{constructor(a,s,l){super(a,s,l),this.name="AuthApiError",this.status=s,this.code=l}}function Mb(o){return Ce(o)&&o.name==="AuthApiError"}class si extends es{constructor(a,s){super(a),this.name="AuthUnknownError",this.originalError=s}}class Ra extends es{constructor(a,s,l,u){super(a,l,u),this.name=s,this.status=l}}class En extends Ra{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function qb(o){return Ce(o)&&o.name==="AuthSessionMissingError"}class Yi extends Ra{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Al extends Ra{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class Ol extends Ra{constructor(a,s=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Lb(o){return Ce(o)&&o.name==="AuthImplicitGrantRedirectError"}class Kg extends Ra{constructor(a,s=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Su extends Ra{constructor(a,s){super(a,"AuthRetryableFetchError",s,void 0)}}function ou(o){return Ce(o)&&o.name==="AuthRetryableFetchError"}class Yg extends Ra{constructor(a,s,l){super(a,"AuthWeakPasswordError",s,"weak_password"),this.reasons=l}}class wu extends Ra{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}const kl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jg=` 	
\r=`.split(""),Ib=(()=>{const o=new Array(128);for(let a=0;a<o.length;a+=1)o[a]=-1;for(let a=0;a<Jg.length;a+=1)o[Jg[a].charCodeAt(0)]=-2;for(let a=0;a<kl.length;a+=1)o[kl[a].charCodeAt(0)]=a;return o})();function Qg(o,a,s){if(o!==null)for(a.queue=a.queue<<8|o,a.queuedBits+=8;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(kl[l]),a.queuedBits-=6}else if(a.queuedBits>0)for(a.queue=a.queue<<6-a.queuedBits,a.queuedBits=6;a.queuedBits>=6;){const l=a.queue>>a.queuedBits-6&63;s(kl[l]),a.queuedBits-=6}}function Fp(o,a,s){const l=Ib[o];if(l>-1)for(a.queue=a.queue<<6|l,a.queuedBits+=6;a.queuedBits>=8;)s(a.queue>>a.queuedBits-8&255),a.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(o)}"`)}}function Xg(o){const a=[],s=f=>{a.push(String.fromCodePoint(f))},l={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=f=>{$b(f,l,s)};for(let f=0;f<o.length;f+=1)Fp(o.charCodeAt(f),u,d);return a.join("")}function Hb(o,a){if(o<=127){a(o);return}else if(o<=2047){a(192|o>>6),a(128|o&63);return}else if(o<=65535){a(224|o>>12),a(128|o>>6&63),a(128|o&63);return}else if(o<=1114111){a(240|o>>18),a(128|o>>12&63),a(128|o>>6&63),a(128|o&63);return}throw new Error(`Unrecognized Unicode codepoint: ${o.toString(16)}`)}function Vb(o,a){for(let s=0;s<o.length;s+=1){let l=o.charCodeAt(s);if(l>55295&&l<=56319){const u=(l-55296)*1024&65535;l=(o.charCodeAt(s+1)-56320&65535|u)+65536,s+=1}Hb(l,a)}}function $b(o,a,s){if(a.utf8seq===0){if(o<=127){s(o);return}for(let l=1;l<6;l+=1)if((o>>7-l&1)===0){a.utf8seq=l;break}if(a.utf8seq===2)a.codepoint=o&31;else if(a.utf8seq===3)a.codepoint=o&15;else if(a.utf8seq===4)a.codepoint=o&7;else throw new Error("Invalid UTF-8 sequence");a.utf8seq-=1}else if(a.utf8seq>0){if(o<=127)throw new Error("Invalid UTF-8 sequence");a.codepoint=a.codepoint<<6|o&63,a.utf8seq-=1,a.utf8seq===0&&s(a.codepoint)}}function er(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};for(let u=0;u<o.length;u+=1)Fp(o.charCodeAt(u),s,l);return new Uint8Array(a)}function Pb(o){const a=[];return Vb(o,s=>a.push(s)),new Uint8Array(a)}function li(o){const a=[],s={queue:0,queuedBits:0},l=u=>{a.push(u)};return o.forEach(u=>Qg(u,s,l)),Qg(null,s,l),a.join("")}function Gb(o){return Math.round(Date.now()/1e3)+o}function Kb(){return Symbol("auth-callback")}const zt=()=>typeof window<"u"&&typeof document<"u",ei={tested:!1,writable:!1},Zp=()=>{if(!zt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ei.tested)return ei.writable;const o=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(o,o),globalThis.localStorage.removeItem(o),ei.tested=!0,ei.writable=!0}catch{ei.tested=!0,ei.writable=!1}return ei.writable};function Yb(o){const a={},s=new URL(o);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((u,d)=>{a[d]=u})}catch{}return s.searchParams.forEach((l,u)=>{a[u]=l}),a}const Wp=o=>o?(...a)=>o(...a):(...a)=>fetch(...a),Jb=o=>typeof o=="object"&&o!==null&&"status"in o&&"ok"in o&&"json"in o&&typeof o.json=="function",Wi=async(o,a,s)=>{await o.setItem(a,JSON.stringify(s))},ti=async(o,a)=>{const s=await o.getItem(a);if(!s)return null;try{return JSON.parse(s)}catch{return s}},Oa=async(o,a)=>{await o.removeItem(a)};class Bl{constructor(){this.promise=new Bl.promiseConstructor((a,s)=>{this.resolve=a,this.reject=s})}}Bl.promiseConstructor=Promise;function cu(o){const a=o.split(".");if(a.length!==3)throw new wu("Invalid JWT structure");for(let l=0;l<a.length;l++)if(!zb.test(a[l]))throw new wu("JWT not in base64url format");return{header:JSON.parse(Xg(a[0])),payload:JSON.parse(Xg(a[1])),signature:er(a[2]),raw:{header:a[0],payload:a[1]}}}async function Qb(o){return await new Promise(a=>{setTimeout(()=>a(null),o)})}function Xb(o,a){return new Promise((l,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const f=await o(d);if(!a(d,null,f)){l(f);return}}catch(f){if(!a(d,f)){u(f);return}}})()})}function Fb(o){return("0"+o.toString(16)).substr(-2)}function Zb(){const a=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=s.length;let u="";for(let d=0;d<56;d++)u+=s.charAt(Math.floor(Math.random()*l));return u}return crypto.getRandomValues(a),Array.from(a,Fb).join("")}async function Wb(o){const s=new TextEncoder().encode(o),l=await crypto.subtle.digest("SHA-256",s),u=new Uint8Array(l);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function e0(o){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),o;const s=await Wb(o);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ji(o,a,s=!1){const l=Zb();let u=l;s&&(u+="/PASSWORD_RECOVERY"),await Wi(o,`${a}-code-verifier`,u);const d=await e0(l);return[d,l===d?"plain":"s256"]}const t0=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function n0(o){const a=o.headers.get(ju);if(!a||!a.match(t0))return null;try{return new Date(`${a}T00:00:00.0Z`)}catch{return null}}function a0(o){if(!o)throw new Error("Missing exp claim");const a=Math.floor(Date.now()/1e3);if(o<=a)throw new Error("JWT has expired")}function i0(o){switch(o){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const r0=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Qi(o){if(!r0.test(o))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function uu(){const o={};return new Proxy(o,{get:(a,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const l=s.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function s0(o,a){return new Proxy(o,{get:(s,l,u)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const d=l.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(s,l,u)}return!a.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a.value=!0),Reflect.get(s,l,u)}})}function Fg(o){return JSON.parse(JSON.stringify(o))}const ai=o=>o.msg||o.message||o.error_description||o.error||JSON.stringify(o),l0=[502,503,504];async function Zg(o){var a;if(!Jb(o))throw new Su(ai(o),0);if(l0.includes(o.status))throw new Su(ai(o),o.status);let s;try{s=await o.json()}catch(d){throw new si(ai(d),d)}let l;const u=n0(o);if(u&&u.getTime()>=Xp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?l=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(l=s.error_code),l){if(l==="weak_password")throw new Yg(ai(s),o.status,((a=s.weak_password)===null||a===void 0?void 0:a.reasons)||[]);if(l==="session_not_found")throw new En}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((d,f)=>d&&typeof f=="string",!0))throw new Yg(ai(s),o.status,s.weak_password.reasons);throw new Bb(ai(s),o.status||500,l)}const o0=(o,a,s,l)=>{const u={method:o,headers:a?.headers||{}};return o==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},a?.headers),u.body=JSON.stringify(l),Object.assign(Object.assign({},u),s))};async function Re(o,a,s,l){var u;const d=Object.assign({},l?.headers);d[ju]||(d[ju]=Xp["2024-01-01"].name),l?.jwt&&(d.Authorization=`Bearer ${l.jwt}`);const f=(u=l?.query)!==null&&u!==void 0?u:{};l?.redirectTo&&(f.redirect_to=l.redirectTo);const g=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",p=await c0(o,a,s+g,{headers:d,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(p):{data:Object.assign({},p),error:null}}async function c0(o,a,s,l,u,d){const f=o0(a,l,u,d);let g;try{g=await o(s,Object.assign({},f))}catch(p){throw console.error(p),new Su(ai(p),0)}if(g.ok||await Zg(g),l?.noResolveJson)return g;try{return await g.json()}catch(p){await Zg(p)}}function Cn(o){var a;let s=null;h0(o)&&(s=Object.assign({},o),o.expires_at||(s.expires_at=Gb(o.expires_in)));const l=(a=o.user)!==null&&a!==void 0?a:o;return{data:{session:s,user:l},error:null}}function Wg(o){const a=Cn(o);return!a.error&&o.weak_password&&typeof o.weak_password=="object"&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.message&&typeof o.weak_password.message=="string"&&o.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0)&&(a.data.weak_password=o.weak_password),a}function Na(o){var a;return{data:{user:(a=o.user)!==null&&a!==void 0?a:o},error:null}}function u0(o){return{data:o,error:null}}function d0(o){const{action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d}=o,f=nr(o,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),g={action_link:a,email_otp:s,hashed_token:l,redirect_to:u,verification_type:d},p=Object.assign({},f);return{data:{properties:g,user:p},error:null}}function ep(o){return o}function h0(o){return o.access_token&&o.refresh_token&&o.expires_in}const du=["global","local","others"];class f0{constructor({url:a="",headers:s={},fetch:l}){this.url=a,this.headers=s,this.fetch=Wp(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,s=du[0]){if(du.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${du.join(", ")}`);try{return await Re(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(l){if(Ce(l))return{data:null,error:l};throw l}}async inviteUserByEmail(a,s={}){try{return await Re(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Na})}catch(l){if(Ce(l))return{data:{user:null},error:l};throw l}}async generateLink(a){try{const{options:s}=a,l=nr(a,["options"]),u=Object.assign(Object.assign({},l),s);return"newEmail"in l&&(u.new_email=l?.newEmail,delete u.newEmail),await Re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:d0,redirectTo:s?.redirectTo})}catch(s){if(Ce(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(a){try{return await Re(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:Na})}catch(s){if(Ce(s))return{data:{user:null},error:s};throw s}}async listUsers(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ep});if(v.error)throw v.error;const x=await v.json(),j=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const T=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=T}),m.total=parseInt(j)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(Ce(m))return{data:{users:[]},error:m};throw m}}async getUserById(a){Qi(a);try{return await Re(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:Na})}catch(s){if(Ce(s))return{data:{user:null},error:s};throw s}}async updateUserById(a,s){Qi(a);try{return await Re(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:s,headers:this.headers,xform:Na})}catch(l){if(Ce(l))return{data:{user:null},error:l};throw l}}async deleteUser(a,s=!1){Qi(a);try{return await Re(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:s},xform:Na})}catch(l){if(Ce(l))return{data:{user:null},error:l};throw l}}async _listFactors(a){Qi(a.userId);try{const{data:s,error:l}=await Re(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:s,error:l}}catch(s){if(Ce(s))return{data:null,error:s};throw s}}async _deleteFactor(a){Qi(a.userId),Qi(a.id);try{return{data:await Re(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(s){if(Ce(s))return{data:null,error:s};throw s}}async _listOAuthClients(a){var s,l,u,d,f,g,p;try{const m={nextPage:null,lastPage:0,total:0},v=await Re(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(s=a?.page)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:"",per_page:(d=(u=a?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:ep});if(v.error)throw v.error;const x=await v.json(),j=(f=v.headers.get("x-total-count"))!==null&&f!==void 0?f:0,b=(p=(g=v.headers.get("link"))===null||g===void 0?void 0:g.split(","))!==null&&p!==void 0?p:[];return b.length>0&&(b.forEach(w=>{const T=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);m[`${O}Page`]=T}),m.total=parseInt(j)),{data:Object.assign(Object.assign({},x),m),error:null}}catch(m){if(Ce(m))return{data:{clients:[]},error:m};throw m}}async _createOAuthClient(a){try{return await Re(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ce(s))return{data:null,error:s};throw s}}async _getOAuthClient(a){try{return await Re(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ce(s))return{data:null,error:s};throw s}}async _updateOAuthClient(a,s){try{return await Re(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:s,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(Ce(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(a){try{return await Re(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ce(s))return{data:null,error:s};throw s}}async _regenerateOAuthClientSecret(a){try{return await Re(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ce(s))return{data:null,error:s};throw s}}}function tp(o={}){return{getItem:a=>o[a]||null,setItem:(a,s)=>{o[a]=s},removeItem:a=>{delete o[a]}}}const Xi={debug:!!(globalThis&&Zp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class em extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class g0 extends em{}async function p0(o,a,s){Xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",o,a);const l=new globalThis.AbortController;return a>0&&setTimeout(()=>{l.abort(),Xi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",o)},a),await Promise.resolve().then(()=>globalThis.navigator.locks.request(o,a===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async u=>{if(u){Xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",o,u.name);try{return await s()}finally{Xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",o,u.name)}}else{if(a===0)throw Xi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",o),new g0(`Acquiring an exclusive Navigator LockManager lock "${o}" immediately failed`);if(Xi.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}function m0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tm(o){if(!/^0x[a-fA-F0-9]{40}$/.test(o))throw new Error(`@supabase/auth-js: Address "${o}" is invalid.`);return o.toLowerCase()}function y0(o){return parseInt(o,16)}function v0(o){const a=new TextEncoder().encode(o);return"0x"+Array.from(a,l=>l.toString(16).padStart(2,"0")).join("")}function b0(o){var a;const{chainId:s,domain:l,expirationTime:u,issuedAt:d=new Date,nonce:f,notBefore:g,requestId:p,resources:m,scheme:v,uri:x,version:j}=o;{if(!Number.isInteger(s))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${s}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!x)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(j!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${j}`);if(!((a=o.statement)===null||a===void 0)&&a.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${o.statement}`)}const b=tm(o.address),w=v?`${v}://${l}`:l,T=o.statement?`${o.statement}
`:"",O=`${w} wants you to sign in with your Ethereum account:
${b}

${T}`;let C=`URI: ${x}
Version: ${j}
Chain ID: ${s}${f?`
Nonce: ${f}`:""}
Issued At: ${d.toISOString()}`;if(u&&(C+=`
Expiration Time: ${u.toISOString()}`),g&&(C+=`
Not Before: ${g.toISOString()}`),p&&(C+=`
Request ID: ${p}`),m){let M=`
Resources:`;for(const B of m){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);M+=`
- ${B}`}C+=M}return`${O}
${C}`}class wt extends Error{constructor({message:a,code:s,cause:l,name:u}){var d;super(a,{cause:l}),this.__isWebAuthnError=!0,this.name=(d=u??(l instanceof Error?l.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=s}}class Ul extends wt{constructor(a,s){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s,message:a}),this.name="WebAuthnUnknownError",this.originalError=s}}function _0({error:o,options:a}){var s,l,u;const{publicKey:d}=a;if(!d)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new wt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else if(o.name==="ConstraintError"){if(((s=d.authenticatorSelection)===null||s===void 0?void 0:s.requireResidentKey)===!0)return new wt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:o});if(a.mediation==="conditional"&&((l=d.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new wt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:o});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new wt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:o})}else{if(o.name==="InvalidStateError")return new wt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:o});if(o.name==="NotAllowedError")return new wt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="NotSupportedError")return d.pubKeyCredParams.filter(g=>g.type==="public-key").length===0?new wt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:o}):new wt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:o});if(o.name==="SecurityError"){const f=window.location.hostname;if(nm(f)){if(d.rp.id!==f)return new wt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new wt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new wt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:o})}else if(o.name==="UnknownError")return new wt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new wt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}function x0({error:o,options:a}){const{publicKey:s}=a;if(!s)throw Error("options was missing required publicKey property");if(o.name==="AbortError"){if(a.signal instanceof AbortSignal)return new wt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:o})}else{if(o.name==="NotAllowedError")return new wt({message:o.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o});if(o.name==="SecurityError"){const l=window.location.hostname;if(nm(l)){if(s.rpId!==l)return new wt({message:`The RP ID "${s.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:o})}else return new wt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:o})}else if(o.name==="UnknownError")return new wt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:o})}return new wt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:o})}class j0{createNewAbortSignal(){if(this.controller){const s=new Error("Cancelling existing WebAuthn API call for new one");s.name="AbortError",this.controller.abort(s)}const a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){const a=new Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}const S0=new j0;function w0(o){if(!o)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(o);const{challenge:a,user:s,excludeCredentials:l}=o,u=nr(o,["challenge","user","excludeCredentials"]),d=er(a).buffer,f=Object.assign(Object.assign({},s),{id:er(s.id).buffer}),g=Object.assign(Object.assign({},u),{challenge:d,user:f});if(l&&l.length>0){g.excludeCredentials=new Array(l.length);for(let p=0;p<l.length;p++){const m=l[p];g.excludeCredentials[p]=Object.assign(Object.assign({},m),{id:er(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return g}function E0(o){if(!o)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(o);const{challenge:a,allowCredentials:s}=o,l=nr(o,["challenge","allowCredentials"]),u=er(a).buffer,d=Object.assign(Object.assign({},l),{challenge:u});if(s&&s.length>0){d.allowCredentials=new Array(s.length);for(let f=0;f<s.length;f++){const g=s[f];d.allowCredentials[f]=Object.assign(Object.assign({},g),{id:er(g.id).buffer,type:g.type||"public-key",transports:g.transports})}}return d}function C0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o;return{id:o.id,rawId:o.id,response:{attestationObject:li(new Uint8Array(o.response.attestationObject)),clientDataJSON:li(new Uint8Array(o.response.clientDataJSON))},type:"public-key",clientExtensionResults:o.getClientExtensionResults(),authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function T0(o){var a;if("toJSON"in o&&typeof o.toJSON=="function")return o.toJSON();const s=o,l=o.getClientExtensionResults(),u=o.response;return{id:o.id,rawId:o.id,response:{authenticatorData:li(new Uint8Array(u.authenticatorData)),clientDataJSON:li(new Uint8Array(u.clientDataJSON)),signature:li(new Uint8Array(u.signature)),userHandle:u.userHandle?li(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(a=s.authenticatorAttachment)!==null&&a!==void 0?a:void 0}}function nm(o){return o==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(o)}function np(){var o,a;return!!(zt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((o=navigator?.credentials)===null||o===void 0?void 0:o.create)=="function"&&typeof((a=navigator?.credentials)===null||a===void 0?void 0:a.get)=="function")}async function A0(o){try{const a=await navigator.credentials.create(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ul("Browser returned unexpected credential type",a)}:{data:null,error:new Ul("Empty credential response",a)}}catch(a){return{data:null,error:_0({error:a,options:o})}}}async function O0(o){try{const a=await navigator.credentials.get(o);return a?a instanceof PublicKeyCredential?{data:a,error:null}:{data:null,error:new Ul("Browser returned unexpected credential type",a)}:{data:null,error:new Ul("Empty credential response",a)}}catch(a){return{data:null,error:x0({error:a,options:o})}}}const N0={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},R0={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function zl(...o){const a=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),s=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),l={};for(const u of o)if(u)for(const d in u){const f=u[d];if(f!==void 0)if(Array.isArray(f))l[d]=f;else if(s(f))l[d]=f;else if(a(f)){const g=l[d];a(g)?l[d]=zl(g,f):l[d]=zl(f)}else l[d]=f}return l}function k0(o,a){return zl(N0,o,a||{})}function U0(o,a){return zl(R0,o,a||{})}class z0{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:s,friendlyName:l,signal:u},d){try{const{data:f,error:g}=await this.client.mfa.challenge({factorId:a,webauthn:s});if(!f)return{data:null,error:g};const p=u??S0.createNewAbortSignal();if(f.webauthn.type==="create"){const{user:m}=f.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${l}`),m.displayName||(m.displayName=m.name)}switch(f.webauthn.type){case"create":{const m=k0(f.webauthn.credential_options.publicKey,d?.create),{data:v,error:x}=await A0({publicKey:m,signal:p});return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}case"request":{const m=U0(f.webauthn.credential_options.publicKey,d?.request),{data:v,error:x}=await O0(Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:m,signal:p}));return v?{data:{factorId:a,challengeId:f.id,webauthn:{type:f.webauthn.type,credential_response:v}},error:null}:{data:null,error:x}}}}catch(f){return Ce(f)?{data:null,error:f}:{data:null,error:new si("Unexpected error in challenge",f)}}}async _verify({challengeId:a,factorId:s,webauthn:l}){return this.client.mfa.verify({factorId:s,challengeId:a,webauthn:l})}async _authenticate({factorId:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new es("rpId is required for WebAuthn authentication")};try{if(!np())return{data:null,error:new si("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this.challenge({factorId:a,webauthn:{rpId:s,rpOrigins:l},signal:u},{request:d});if(!f)return{data:null,error:g};const{webauthn:p}=f;return this._verify({factorId:a,challengeId:f.challengeId,webauthn:{type:p.type,rpId:s,rpOrigins:l,credential_response:p.credential_response}})}catch(f){return Ce(f)?{data:null,error:f}:{data:null,error:new si("Unexpected error in authenticate",f)}}}async _register({friendlyName:a,webauthn:{rpId:s=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!s)return{data:null,error:new es("rpId is required for WebAuthn registration")};try{if(!np())return{data:null,error:new si("Browser does not support WebAuthn",null)};const{data:f,error:g}=await this._enroll({friendlyName:a});if(!f)return await this.client.mfa.listFactors().then(v=>{var x;return(x=v.data)===null||x===void 0?void 0:x.all.find(j=>j.factor_type==="webauthn"&&j.friendly_name===a&&j.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v?.id}):void 0),{data:null,error:g};const{data:p,error:m}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:s,rpOrigins:l},signal:u},{create:d});return p?this._verify({factorId:f.id,challengeId:p.challengeId,webauthn:{rpId:s,rpOrigins:l,type:p.webauthn.type,credential_response:p.webauthn.credential_response}}):{data:null,error:m}}catch(f){return Ce(f)?{data:null,error:f}:{data:null,error:new si("Unexpected error in register",f)}}}}m0();const D0={url:Rb,storageKey:kb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ub,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function ap(o,a,s){return await s()}const Fi={};class ts{get jwks(){var a,s;return(s=(a=Fi[this.storageKey])===null||a===void 0?void 0:a.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(a){Fi[this.storageKey]=Object.assign(Object.assign({},Fi[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,s;return(s=(a=Fi[this.storageKey])===null||a===void 0?void 0:a.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){Fi[this.storageKey]=Object.assign(Object.assign({},Fi[this.storageKey]),{cachedAt:a})}constructor(a){var s,l,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},D0),a);if(this.storageKey=d.storageKey,this.instanceID=(s=ts.nextInstanceID[this.storageKey])!==null&&s!==void 0?s:0,ts.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&zt()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new f0({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Wp(d.fetch),this.lock=d.lock||ap,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,d.lock?this.lock=d.lock:zt()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=p0:this.lock=ap,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new z0(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:Zp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=tp(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=tp(this.memoryStorage)),zt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f),await this._notifyAllSubscribers(f.data.event,f.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Qp}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var a;try{let s={},l="none";if(zt()&&(s=Yb(window.location.href),this._isImplicitGrantCallback(s)?l="implicit":await this._isPKCECallback(s)&&(l="pkce")),zt()&&this.detectSessionInUrl&&l!=="none"){const{data:u,error:d}=await this._getSessionFromURL(s,l);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Lb(d)){const p=(a=d.details)===null||a===void 0?void 0:a.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:d}}return await this._removeSession(),{error:d}}const{session:f,redirectType:g}=u;return this._debug("#_initialize()","detected session in URL",f,"redirect type",g),await this._saveSession(f),setTimeout(async()=>{g==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return Ce(s)?this._returnResult({error:s}):this._returnResult({error:new si("Unexpected error during initialization",s)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var s,l,u;try{const d=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(s=a?.options)===null||s===void 0?void 0:s.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(u=a?.options)===null||u===void 0?void 0:u.captchaToken}},xform:Cn}),{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ce(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(a){var s,l,u;try{let d;if("email"in a){const{email:v,password:x,options:j}=a;let b=null,w=null;this.flowType==="pkce"&&([b,w]=await Ji(this.storage,this.storageKey)),d=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:j?.emailRedirectTo,body:{email:v,password:x,data:(s=j?.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:j?.captchaToken},code_challenge:b,code_challenge_method:w},xform:Cn})}else if("phone"in a){const{phone:v,password:x,options:j}=a;d=await Re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:x,data:(l=j?.data)!==null&&l!==void 0?l:{},channel:(u=j?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:j?.captchaToken}},xform:Cn})}else throw new Al("You must provide either an email or phone number and a password");const{data:f,error:g}=d;if(g||!f)return this._returnResult({data:{user:null,session:null},error:g});const p=f.session,m=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(d){if(Ce(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(a){try{let s;if("email"in a){const{email:d,password:f,options:g}=a;s=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:Wg})}else if("phone"in a){const{phone:d,password:f,options:g}=a;s=await Re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:f,gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:Wg})}else throw new Al("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const d=new Yi;return this._returnResult({data:{user:null,session:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:u})}catch(s){if(Ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOAuth(a){var s,l,u,d;return await this._handleProviderSignIn(a.provider,{redirectTo:(s=a.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=a.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=a.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=a.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){const{chain:s}=a;switch(s){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}}async signInWithEthereum(a){var s,l,u,d,f,g,p,m,v,x,j;let b,w;if("message"in a)b=a.message,w=a.signature;else{const{chain:T,wallet:O,statement:C,options:M}=a;let B;if(zt())if(typeof O=="object")B=O;else{const he=window;if("ethereum"in he&&typeof he.ethereum=="object"&&"request"in he.ethereum&&typeof he.ethereum.request=="function")B=he.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=O}const G=new URL((s=M?.url)!==null&&s!==void 0?s:window.location.href),E=await B.request({method:"eth_requestAccounts"}).then(he=>he).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const q=tm(E[0]);let U=(l=M?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!U){const he=await B.request({method:"eth_chainId"});U=y0(he)}const H={domain:G.host,address:q,statement:C,uri:G.href,version:"1",chainId:U,nonce:(u=M?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(f=(d=M?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(g=M?.signInWithEthereum)===null||g===void 0?void 0:g.expirationTime,notBefore:(p=M?.signInWithEthereum)===null||p===void 0?void 0:p.notBefore,requestId:(m=M?.signInWithEthereum)===null||m===void 0?void 0:m.requestId,resources:(v=M?.signInWithEthereum)===null||v===void 0?void 0:v.resources};b=b0(H),w=await B.request({method:"personal_sign",params:[v0(b),q]})}try{const{data:T,error:O}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:b,signature:w},!((x=a.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(j=a.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:Cn});if(O)throw O;if(!T||!T.session||!T.user){const C=new Yi;return this._returnResult({data:{user:null,session:null},error:C})}return T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",T.session)),this._returnResult({data:Object.assign({},T),error:O})}catch(T){if(Ce(T))return this._returnResult({data:{user:null,session:null},error:T});throw T}}async signInWithSolana(a){var s,l,u,d,f,g,p,m,v,x,j,b;let w,T;if("message"in a)w=a.message,T=a.signature;else{const{chain:O,wallet:C,statement:M,options:B}=a;let G;if(zt())if(typeof C=="object")G=C;else{const q=window;if("solana"in q&&typeof q.solana=="object"&&("signIn"in q.solana&&typeof q.solana.signIn=="function"||"signMessage"in q.solana&&typeof q.solana.signMessage=="function"))G=q.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!B?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=C}const E=new URL((s=B?.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in G&&G.signIn){const q=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),M?{statement:M}:null));let U;if(Array.isArray(q)&&q[0]&&typeof q[0]=="object")U=q[0];else if(q&&typeof q=="object"&&"signedMessage"in q&&"signature"in q)U=q;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in U&&"signature"in U&&(typeof U.signedMessage=="string"||U.signedMessage instanceof Uint8Array)&&U.signature instanceof Uint8Array)w=typeof U.signedMessage=="string"?U.signedMessage:new TextDecoder().decode(U.signedMessage),T=U.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...M?["",M,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(u=(l=B?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=B?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((f=B?.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((g=B?.signInWithSolana)===null||g===void 0)&&g.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((p=B?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((m=B?.signInWithSolana)===null||m===void 0)&&m.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((x=(v=B?.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||x===void 0)&&x.length?["Resources",...B.signInWithSolana.resources.map(U=>`- ${U}`)]:[]].join(`
`);const q=await G.signMessage(new TextEncoder().encode(w),"utf8");if(!q||!(q instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");T=q}}try{const{data:O,error:C}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:li(T)},!((j=a.options)===null||j===void 0)&&j.captchaToken?{gotrue_meta_security:{captcha_token:(b=a.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:Cn});if(C)throw C;if(!O||!O.session||!O.user){const M=new Yi;return this._returnResult({data:{user:null,session:null},error:M})}return O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),this._returnResult({data:Object.assign({},O),error:C})}catch(O){if(Ce(O))return this._returnResult({data:{user:null,session:null},error:O});throw O}}async _exchangeCodeForSession(a){const s=await ti(this.storage,`${this.storageKey}-code-verifier`),[l,u]=(s??"").split("/");try{const{data:d,error:f}=await Re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:l},xform:Cn});if(await Oa(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!d||!d.session||!d.user){const g=new Yi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:f})}catch(d){if(Ce(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(a){try{const{options:s,provider:l,token:u,access_token:d,nonce:f}=a,g=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:u,access_token:d,nonce:f,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Cn}),{data:p,error:m}=g;if(m)return this._returnResult({data:{user:null,session:null},error:m});if(!p||!p.session||!p.user){const v=new Yi;return this._returnResult({data:{user:null,session:null},error:v})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:p,error:m})}catch(s){if(Ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithOtp(a){var s,l,u,d,f;try{if("email"in a){const{email:g,options:p}=a;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await Ji(this.storage,this.storageKey));const{error:x}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:g,data:(s=p?.data)!==null&&s!==void 0?s:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:m,code_challenge_method:v},redirectTo:p?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}if("phone"in a){const{phone:g,options:p}=a,{data:m,error:v}=await Re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:g,data:(u=p?.data)!==null&&u!==void 0?u:{},create_user:(d=p?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(f=p?.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:m?.message_id},error:v})}throw new Al("You must provide either an email or phone number.")}catch(g){if(Ce(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async verifyOtp(a){var s,l;try{let u,d;"options"in a&&(u=(s=a.options)===null||s===void 0?void 0:s.redirectTo,d=(l=a.options)===null||l===void 0?void 0:l.captchaToken);const{data:f,error:g}=await Re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:Cn});if(g)throw g;if(!f)throw new Error("An error occurred on token verification.");const p=f.session,m=f.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(a.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),this._returnResult({data:{user:m,session:p},error:null})}catch(u){if(Ce(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(a){var s,l,u,d,f;try{let g=null,p=null;this.flowType==="pkce"&&([g,p]=await Ji(this.storage,this.storageKey));const m=await Re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:(l=(s=a.options)===null||s===void 0?void 0:s.redirectTo)!==null&&l!==void 0?l:void 0}),!((u=a?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:p}),headers:this.headers,xform:u0});return!((d=m.data)===null||d===void 0)&&d.url&&zt()&&!(!((f=a.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(m.data.url),this._returnResult(m)}catch(g){if(Ce(g))return this._returnResult({data:null,error:g});throw g}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{const{data:{session:s},error:l}=a;if(l)throw l;if(!s)throw new En;const{error:u}=await Re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(a){if(Ce(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{const s=`${this.url}/resend`;if("email"in a){const{email:l,type:u,options:d}=a,{error:f}=await Re(this.fetch,"POST",s,{headers:this.headers,body:{email:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in a){const{phone:l,type:u,options:d}=a,{data:f,error:g}=await Re(this.fetch,"POST",s,{headers:this.headers,body:{phone:l,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:g})}throw new Al("You must provide either an email or phone number and a type")}catch(s){if(Ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(a,s){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await l,await s()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=s();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await a(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let a=null;const s=await ti(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?a=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!a)return{data:{session:null},error:null};const l=a.expires_at?a.expires_at*1e3-Date.now()<lu:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",a.expires_at),!l){if(this.userStorage){const f=await ti(this.userStorage,this.storageKey+"-user");f?.user?a.user=f.user:a.user=uu()}if(this.storage.isServer&&a.user&&!a.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};a.user=s0(a.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:a},error:null}}const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){return a?await this._getUser(a):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(a){try{return a?await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:Na}):await this._useSession(async s=>{var l,u,d;const{data:f,error:g}=s;if(g)throw g;return!(!((l=f.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new En}:await Re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:Na})})}catch(s){if(Ce(s))return qb(s)&&(await this._removeSession(),await Oa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:s});throw s}}async updateUser(a,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,s))}async _updateUser(a,s={}){try{return await this._useSession(async l=>{const{data:u,error:d}=l;if(d)throw d;if(!u.session)throw new En;const f=u.session;let g=null,p=null;this.flowType==="pkce"&&a.email!=null&&([g,p]=await Ji(this.storage,this.storageKey));const{data:m,error:v}=await Re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s?.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:p}),jwt:f.access_token,xform:Na});if(v)throw v;return f.user=m.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(l){if(Ce(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new En;const s=Date.now()/1e3;let l=s,u=!0,d=null;const{payload:f}=cu(a.access_token);if(f.exp&&(l=f.exp,u=l<=s),u){const{data:g,error:p}=await this._callRefreshToken(a.refresh_token);if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!g)return{data:{user:null,session:null},error:null};d=g}else{const{data:g,error:p}=await this._getUser(a.access_token);if(p)throw p;d={access_token:a.access_token,refresh_token:a.refresh_token,user:g.user,token_type:"bearer",expires_in:l-s,expires_at:l},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(s){if(Ce(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async s=>{var l;if(!a){const{data:f,error:g}=s;if(g)throw g;a=(l=f.session)!==null&&l!==void 0?l:void 0}if(!a?.refresh_token)throw new En;const{data:u,error:d}=await this._callRefreshToken(a.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(s){if(Ce(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async _getSessionFromURL(a,s){try{if(!zt())throw new Ol("No browser detected.");if(a.error||a.error_description||a.error_code)throw new Ol(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Kg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ol("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new Kg("No code detected.");const{data:M,error:B}=await this._exchangeCodeForSession(a.code);if(B)throw B;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:M.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:u,access_token:d,refresh_token:f,expires_in:g,expires_at:p,token_type:m}=a;if(!d||!g||!f||!m)throw new Ol("No session defined in URL");const v=Math.round(Date.now()/1e3),x=parseInt(g);let j=v+x;p&&(j=parseInt(p));const b=j-v;b*1e3<=Zi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${x}s`);const w=j-x;v-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,j,v):v-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,j,v);const{data:T,error:O}=await this._getUser(d);if(O)throw O;const C={provider_token:l,provider_refresh_token:u,access_token:d,expires_in:x,expires_at:j,refresh_token:f,token_type:m,user:T.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:C,redirectType:a.type},error:null})}catch(l){if(Ce(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(a){return!!(a.access_token||a.error_description)}async _isPKCECallback(a){const s=await ti(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&s)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({error:d});const f=(l=u.session)===null||l===void 0?void 0:l.access_token;if(f){const{error:g}=await this.admin.signOut(f,a);if(g&&!(Mb(g)&&(g.status===404||g.status===401||g.status===403)))return this._returnResult({error:g})}return a!=="others"&&(await this._removeSession(),await Oa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){const s=Kb(),l={id:s,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:l}}}async _emitInitialSession(a){return await this._useSession(async s=>{var l,u;try{const{data:{session:d},error:f}=s;if(f)throw f;await((l=this.stateChangeEmitters.get(a))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(a))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",d),console.error(d)}})}async resetPasswordForEmail(a,s={}){let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Ji(this.storage,this.storageKey,!0));try{return await Re(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:l,code_challenge_method:u,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(Ce(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var a;try{const{data:s,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(a=s.user.identities)!==null&&a!==void 0?a:[]},error:null})}catch(s){if(Ce(s))return this._returnResult({data:null,error:s});throw s}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var s;try{const{data:l,error:u}=await this._useSession(async d=>{var f,g,p,m,v;const{data:x,error:j}=d;if(j)throw j;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:(f=a.options)===null||f===void 0?void 0:f.redirectTo,scopes:(g=a.options)===null||g===void 0?void 0:g.scopes,queryParams:(p=a.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Re(this.fetch,"GET",b,{headers:this.headers,jwt:(v=(m=x.session)===null||m===void 0?void 0:m.access_token)!==null&&v!==void 0?v:void 0})});if(u)throw u;return zt()&&!(!((s=a.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:a.provider,url:l?.url},error:null})}catch(l){if(Ce(l))return this._returnResult({data:{provider:a.provider,url:null},error:l});throw l}}async linkIdentityIdToken(a){return await this._useSession(async s=>{var l;try{const{error:u,data:{session:d}}=s;if(u)throw u;const{options:f,provider:g,token:p,access_token:m,nonce:v}=a,x=await Re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=d?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:g,id_token:p,access_token:m,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Cn}),{data:j,error:b}=x;return b?this._returnResult({data:{user:null,session:null},error:b}):!j||!j.session||!j.user?this._returnResult({data:{user:null,session:null},error:new Yi}):(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("USER_UPDATED",j.session)),this._returnResult({data:j,error:b}))}catch(u){if(Ce(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)throw f;return await Re(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:(u=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})})}catch(s){if(Ce(s))return this._returnResult({data:null,error:s});throw s}}async _refreshAccessToken(a){const s=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(s,"begin");try{const l=Date.now();return await Xb(async u=>(u>0&&await Qb(200*Math.pow(2,u-1)),this._debug(s,"refreshing attempt",u),await Re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:Cn})),(u,d)=>{const f=200*Math.pow(2,u);return d&&ou(d)&&Date.now()+f-l<Zi})}catch(l){if(this._debug(s,"error",l),Ce(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(s,"end")}}_isValidSession(a){return typeof a=="object"&&a!==null&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,s){const l=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",s,"url",l),zt()&&!s.skipBrowserRedirect&&window.location.assign(l),{data:{provider:a,url:l},error:null}}async _recoverAndRefresh(){var a,s;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const u=await ti(this.storage,this.storageKey);if(u&&this.userStorage){let f=await ti(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:u.user},await Wi(this.userStorage,this.storageKey+"-user",f)),u.user=(a=f?.user)!==null&&a!==void 0?a:uu()}else if(u&&!u.user&&!u.user){const f=await ti(this.storage,this.storageKey+"-user");f&&f?.user?(u.user=f.user,await Oa(this.storage,this.storageKey+"-user"),await Wi(this.storage,this.storageKey,u)):u.user=uu()}if(this._debug(l,"session from storage",u),!this._isValidSession(u)){this._debug(l,"session is not valid"),u!==null&&await this._removeSession();return}const d=((s=u.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<lu;if(this._debug(l,`session has${d?"":" not"} expired with margin of ${lu}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:f}=await this._callRefreshToken(u.refresh_token);f&&(console.error(f),ou(f)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:g}=await this._getUser(u.access_token);!g&&f?.user?(u.user=f.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(l,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(l,"error",u),console.error(u);return}finally{this._debug(l,"end")}}async _callRefreshToken(a){var s,l;if(!a)throw new En;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Bl;const{data:d,error:f}=await this._refreshAccessToken(a);if(f)throw f;if(!d.session)throw new En;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const g={data:d.session,error:null};return this.refreshingDeferred.resolve(g),g}catch(d){if(this._debug(u,"error",d),Ce(d)){const f={data:null,error:d};return ou(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(f),f}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(a,s,l=!0){const u=`#_notifyAllSubscribers(${a})`;this._debug(u,"begin",s,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:a,session:s});const d=[],f=Array.from(this.stateChangeEmitters.values()).map(async g=>{try{await g.callback(a,s)}catch(p){d.push(p)}});if(await Promise.all(f),d.length>0){for(let g=0;g<d.length;g+=1)console.error(d[g]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0;const s=Object.assign({},a),l=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&s.user&&await Wi(this.userStorage,this.storageKey+"-user",{user:s.user});const u=Object.assign({},s);delete u.user;const d=Fg(u);await Wi(this.storage,this.storageKey,d)}else{const u=Fg(s);await Wi(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),await Oa(this.storage,this.storageKey),await Oa(this.storage,this.storageKey+"-code-verifier"),await Oa(this.storage,this.storageKey+"-user"),this.userStorage&&await Oa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&zt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",a)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const a=setInterval(()=>this._autoRefreshTokenTick(),Zi);this.autoRefreshTicker=a,a&&typeof a=="object"&&typeof a.unref=="function"?a.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const a=Date.now();try{return await this._useSession(async s=>{const{data:{session:l}}=s;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((l.expires_at*1e3-a)/Zi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${Zi}ms, refresh threshold is ${xu} ticks`),u<=xu&&await this._callRefreshToken(l.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof em)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){const s=`#_onVisibilityChanged(${a})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,s,l){const u=[`provider=${encodeURIComponent(s)}`];if(l?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&u.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[d,f]=await Ji(this.storage,this.storageKey),g=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(f)}`});u.push(g.toString())}if(l?.queryParams){const d=new URLSearchParams(l.queryParams);u.push(d.toString())}return l?.skipBrowserRedirect&&u.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${a}?${u.join("&")}`}async _unenroll(a){try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;return d?this._returnResult({data:null,error:d}):await Re(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token})})}catch(s){if(Ce(s))return this._returnResult({data:null,error:s});throw s}}async _enroll(a){try{return await this._useSession(async s=>{var l,u;const{data:d,error:f}=s;if(f)return this._returnResult({data:null,error:f});const g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},a.factorType==="phone"?{phone:a.phone}:a.factorType==="totp"?{issuer:a.issuer}:{}),{data:p,error:m}=await Re(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return m?this._returnResult({data:null,error:m}):(a.factorType==="totp"&&p.type==="totp"&&(!((u=p?.totp)===null||u===void 0)&&u.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),this._returnResult({data:p,error:null}))})}catch(s){if(Ce(s))return this._returnResult({data:null,error:s});throw s}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:a.webauthn.type==="create"?C0(a.webauthn.credential_response):T0(a.webauthn.credential_response)})}:{code:a.code}),{data:g,error:p}=await Re(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:f,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});return p?this._returnResult({data:null,error:p}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+g.expires_in},g)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",g),this._returnResult({data:g,error:p}))})}catch(s){if(Ce(s))return this._returnResult({data:null,error:s});throw s}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var l;const{data:u,error:d}=s;if(d)return this._returnResult({data:null,error:d});const f=await Re(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:(l=u?.session)===null||l===void 0?void 0:l.access_token});if(f.error)return f;const{data:g}=f;if(g.type!=="webauthn")return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:w0(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:E0(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(s){if(Ce(s))return this._returnResult({data:null,error:s});throw s}})}async _challengeAndVerify(a){const{data:s,error:l}=await this._challenge({factorId:a.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:a.factorId,challengeId:s.id,code:a.code})}async _listFactors(){var a;const{data:{user:s},error:l}=await this.getUser();if(l)return{data:null,error:l};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(a=s?.factors)!==null&&a!==void 0?a:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(){var a,s;const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=cu(l.access_token);let f=null;d.aal&&(f=d.aal);let g=f;((s=(a=l.user.factors)===null||a===void 0?void 0:a.filter(v=>v.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(g="aal2");const m=d.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:m},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async s=>{const{data:{session:l},error:u}=s;return u?this._returnResult({data:null,error:u}):l?await Re(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:l.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new En})})}catch(s){if(Ce(s))return this._returnResult({data:null,error:s});throw s}}async _approveAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new En});const f=await Re(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&zt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(Ce(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(a,s){try{return await this._useSession(async l=>{const{data:{session:u},error:d}=l;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new En});const f=await Re(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:g=>({data:g,error:null})});return f.data&&f.data.redirect_url&&zt()&&!s?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(l){if(Ce(l))return this._returnResult({data:null,error:l});throw l}}async fetchJwk(a,s={keys:[]}){let l=s.keys.find(g=>g.kid===a);if(l)return l;const u=Date.now();if(l=this.jwks.keys.find(g=>g.kid===a),l&&this.jwks_cached_at+Db>u)return l;const{data:d,error:f}=await Re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,l=d.keys.find(g=>g.kid===a),!l)?null:l}async getClaims(a,s={}){try{let l=a;if(!l){const{data:b,error:w}=await this.getSession();if(w||!b.session)return this._returnResult({data:null,error:w});l=b.session.access_token}const{header:u,payload:d,signature:f,raw:{header:g,payload:p}}=cu(l);s?.allowExpired||a0(d.exp);const m=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,s?.keys?{keys:s.keys}:s?.jwks);if(!m){const{error:b}=await this.getUser(l);if(b)throw b;return{data:{claims:d,header:u,signature:f},error:null}}const v=i0(u.alg),x=await crypto.subtle.importKey("jwk",m,v,!0,["verify"]);if(!await crypto.subtle.verify(v,x,f,Pb(`${g}.${p}`)))throw new wu("Invalid JWT signature");return{data:{claims:d,header:u,signature:f},error:null}}catch(l){if(Ce(l))return this._returnResult({data:null,error:l});throw l}}}ts.nextInstanceID={};const B0=ts;class M0 extends B0{constructor(a){super(a)}}class q0{constructor(a,s,l){var u,d,f;this.supabaseUrl=a,this.supabaseKey=s;const g=Nb(a);if(!s)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);const p=`sb-${g.hostname.split(".")[0]}-auth-token`,m={db:jb,realtime:wb,auth:Object.assign(Object.assign({},Sb),{storageKey:p}),global:xb},v=Ob(l??{},m);this.storageKey=(u=v.auth.storageKey)!==null&&u!==void 0?u:"",this.headers=(d=v.global.headers)!==null&&d!==void 0?d:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(x,j)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(j)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=v.auth)!==null&&f!==void 0?f:{},this.headers,v.global.fetch),this.fetch=Tb(s,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(x=>this.realtime.setAuth(x)).catch(x=>console.warn("Failed to set initial Realtime auth token:",x)),this.rest=new Rv(new URL("rest/v1",g).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new vb(this.storageUrl.href,this.headers,this.fetch,l?.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new Tv(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,s={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,s,l)}channel(a,s={config:{}}){return this.realtime.channel(a,s)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,s;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,storageKey:f,flowType:g,lock:p,debug:m,throwOnError:v},x,j){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M0({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),x),storageKey:f,autoRefreshToken:a,persistSession:s,detectSessionInUrl:l,storage:u,userStorage:d,flowType:g,lock:p,debug:m,throwOnError:v,fetch:j,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(a){return new Jv(this.realtimeUrl.href,Object.assign(Object.assign({},a),{params:Object.assign({apikey:this.supabaseKey},a?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,l)=>{this._handleTokenChanged(s,"CLIENT",l?.access_token)})}_handleTokenChanged(a,s,l){(a==="TOKEN_REFRESHED"||a==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):a==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const L0=(o,a,s)=>new q0(o,a,s);function I0(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const a=o.match(/^v(\d+)\./);return a?parseInt(a[1],10)<=18:!1}I0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const H0="https://sqwqlvsjtimallidxrsz.supabase.co",V0="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxd3FsdnNqdGltYWxsaWR4cnN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0MjM4NTYsImV4cCI6MjA3ODk5OTg1Nn0.5s_2Dz76gha9Zb-0RPzJ_vBz-TTP6zHrNyAugBpxnEQ",ne=L0(H0,V0,{auth:{persistSession:!1}}),bn=Object.freeze(Object.defineProperty({__proto__:null,default:ne,supabase:ne},Symbol.toStringTag,{value:"Module"}));function $0({onLogin:o}){const[a,s]=S.useState(""),[l,u]=S.useState(""),[d,f]=S.useState(null);async function g(p){p.preventDefault(),f(null);try{const{data:m,error:v}=await ne.from("users").select("id, username, password, role").eq("username",a).limit(1).single();if(v){f("Error al consultar el servicio de autenticacin"),console.error("Supabase error:",v),v?.code==="42703"&&console.warn("La consulta solicita una columna inexistente en la tabla `users`. Verifica el DDL y ajusta `.select(...)` segn las columnas reales.");return}if(!m){f("Credenciales invlidas");return}const x=m;if(x.password===l){const j={id:x.id,username:x.username,role:x.role};localStorage.setItem("user",JSON.stringify(j));try{console.debug("Login: stored localStorage.user =",j)}catch{}try{if(x.role==="cajero"){const{data:b,error:w}=await ne.from("cai").select("id, cai, rango_de, rango_hasta, fecha_vencimiento, secuencia_actual").eq("cajero",x.username).order("id",{ascending:!1}).limit(1);if(!w&&Array.isArray(b)&&b.length>0){try{localStorage.setItem("caiInfo",JSON.stringify(b[0]))}catch{}try{console.debug("Login: stored localStorage.caiInfo =",b[0])}catch{}}else try{localStorage.removeItem("caiInfo")}catch{}}}catch(b){console.debug("Login: error fetching cai for cajero",b)}f("Inicio de sesin correcto"),typeof o=="function"&&o()}else f("Credenciales invlidas")}catch(m){f(m.message||"Error al consultar la base de datos")}}return r.jsx("div",{className:"login-root",children:r.jsxs("div",{className:"login-card",role:"region","aria-label":"login panel",children:[r.jsx("h3",{className:"login-title",children:"Bienvenido a SET"}),r.jsx("div",{className:"login-sub",children:"Inicia sesin con tu cuenta"}),r.jsxs("div",{className:"login-inner",children:[r.jsxs("form",{onSubmit:g,children:[r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"username",children:"Usuario"}),r.jsx("input",{id:"username",className:"input",value:a,onChange:p=>s(p.target.value),placeholder:"usuario",required:!0,autoComplete:"username"})]}),r.jsxs("div",{className:"form-field",children:[r.jsx("label",{htmlFor:"password",children:"Contrasea"}),r.jsx("input",{id:"password",className:"input",type:"password",value:l,onChange:p=>u(p.target.value),placeholder:"contrasea",required:!0,autoComplete:"current-password"})]}),r.jsx("div",{children:r.jsx("button",{className:"btn-primary",type:"submit",children:"Entrar"})})]}),d&&r.jsx("p",{style:{marginTop:12},children:d}),r.jsxs("div",{className:"login-foot",children:["Credenciales de prueba: ",r.jsx("span",{className:"hint",children:"admin / admin"})]})]})]})})}function P0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Devolucin de Caja"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Esta vista servir para gestionar devoluciones en la caja. Aqu podrs registrar y revisar devoluciones realizadas."}),r.jsx("p",{style:{color:"#6b7280"},children:"Contenido placeholder  implementar lgica de devoluciones segn requisitos."})]})]})}function G0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!0),[d,f]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[x,j]=S.useState(()=>new Date().toISOString().slice(0,16)),[b,w]=S.useState(()=>{try{const C=localStorage.getItem("user");if(C)return JSON.parse(C).username||"usuario"}catch{}return"usuario"});S.useEffect(()=>{fetch("/data-base/ingreso-de-efectivo.json").then(C=>C.json()).then(C=>{const M=C&&Array.isArray(C.ingresos)?C.ingresos:[],B=localStorage.getItem("ingresosEfectivo");let G=[];try{B&&(G=JSON.parse(B))}catch{}const E=[...M,...G];s(E)}).catch(()=>{const C=localStorage.getItem("ingresosEfectivo");try{C&&s(JSON.parse(C))}catch{s([])}}).finally(()=>u(!1))},[]);function T(C){localStorage.setItem("ingresosEfectivo",JSON.stringify(C))}function O(C){if(C.preventDefault(),!g||m===""||Number(m)<=0)return alert("Complete motivo y monto vlido");const M=a.length?Math.max(...a.map(E=>E.id))+1:1,B={id:M,factura:d||`F-${M}`,motivo:g,monto:Number(m),fechaHora:new Date(x).toISOString(),usuario:b},G=[...a,B];s(G),T(G),f(""),p(""),v(""),j(new Date().toISOString().slice(0,16))}return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Ingreso de Efectivo"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Registros de Ingresos"}),l?r.jsx("p",{children:"Cargando..."}):r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"Factura"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Motivo"}),r.jsx("th",{style:{textAlign:"right",padding:8},children:"Monto"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Fecha y hora"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Usuario"})]})}),r.jsx("tbody",{children:a.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:18,textAlign:"center",color:"#94a3b8"},children:"No hay registros"})}):a.map(C=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:{padding:8},children:C.factura}),r.jsx("td",{style:{padding:8},children:C.motivo}),r.jsxs("td",{style:{padding:8,textAlign:"right"},children:["L",C.monto.toFixed(2)]}),r.jsx("td",{style:{padding:8},children:new Date(C.fechaHora).toLocaleString()}),r.jsx("td",{style:{padding:8},children:C.usuario})]},C.id))})]})})]}),r.jsxs("aside",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nuevo ingreso"}),r.jsxs("form",{onSubmit:O,style:{display:"grid",gap:8},children:[r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Factura",r.jsx("input",{value:d,onChange:C=>f(C.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Motivo",r.jsx("input",{value:g,onChange:C=>p(C.target.value),className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Monto",r.jsx("input",{value:m,onChange:C=>v(C.target.value===""?"":Number(C.target.value)),type:"number",step:"0.01",className:"input",style:{marginTop:6},required:!0})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Fecha y hora",r.jsx("input",{value:x,onChange:C=>j(C.target.value),type:"datetime-local",className:"input",style:{marginTop:6}})]}),r.jsxs("label",{style:{fontSize:13,color:"#475569"},children:["Usuario",r.jsx("input",{value:b,onChange:C=>w(C.target.value),className:"input",style:{marginTop:6}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginTop:6},children:[r.jsx("button",{type:"submit",className:"btn-primary",children:"Agregar"}),r.jsx("button",{type:"button",onClick:()=>{f(""),p(""),v(""),j(new Date().toISOString().slice(0,16))},className:"btn-opaque",style:{background:"transparent",color:"#2563eb"},children:"Limpiar"})]})]})]})]})]})}function K0({onBack:o}){const[a,s]=S.useState([]),[l,u]=S.useState(!1),[d,f]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(!1),[x,j]=S.useState(!1),[b,w]=S.useState(null),T=async()=>{u(!0);try{const{data:J,error:Z}=await ne.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, validez_dias, subtotal, impuesto, total, estado").order("fecha_cotizacion",{ascending:!1});if(Z)throw Z;const F=Array.isArray(J)?J:[],k=Array.from(new Set(F.map(D=>D.cliente_id).filter(Boolean)));let W={};if(k.length>0)try{const{data:D}=await ne.from("clientes").select("id,nombre").in("id",k);if(Array.isArray(D))for(const L of D)W[String(L.id)]=L.nombre||""}catch(D){console.warn("Error cargando nombres de clientes:",D)}const _e=F.map(D=>({...D,cliente_nombre:W[String(D.cliente_id)]||null}));s(_e)}catch(J){console.warn("Error cargando cotizaciones:",J),s([])}u(!1)};S.useEffect(()=>{T()},[]);const[O,C]=S.useState(null),[M,B]=S.useState(null),[G,E]=S.useState(""),q=async J=>{f(J);try{const{data:Z,error:F}=await ne.from("cotizaciones").select("id, cliente_id, usuario, fecha_cotizacion, numero_cotizacion, subtotal, impuesto, total, estado").eq("id",J).maybeSingle();if(F&&console.warn("Error cargando cabecera de cotizacion",F),C(Z||null),Z&&Z.cliente_id)try{const{data:_e}=await ne.from("clientes").select("id,nombre").eq("id",Z.cliente_id).maybeSingle();B(_e?.nombre||null)}catch{B(null)}else B(null);const{data:k,error:W}=await ne.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J);if(W)throw W;p(Array.isArray(k)?k:[]),v(!0)}catch(Z){console.warn("Error cargando detalles de cotizacion",Z),p([])}},U=async J=>{try{const{data:Z,error:F}=await ne.from("cotizaciones_detalle").select("*").eq("cotizacion_id",J.id),k=Array.isArray(Z)?Z:[],W={header:J,detalles:k};try{localStorage.setItem("cotizacion_to_load",JSON.stringify(W))}catch(_e){console.warn("No se pudo escribir localStorage",_e)}try{window.dispatchEvent(new CustomEvent("cotizacion:load",{detail:W}))}catch{}o()}catch(Z){console.warn("Error cargando detalles para editar",Z)}},H=async J=>{if(confirm("Eliminar esta cotizacin? Esta accin no se puede deshacer."))try{const{error:Z}=await ne.from("cotizaciones_detalle").delete().eq("cotizacion_id",J);Z&&console.warn("Error eliminando detalles:",Z);const{error:F}=await ne.from("cotizaciones").delete().eq("id",J);if(F)throw F;T()}catch(Z){console.warn("Error eliminando cotizacion:",Z)}},he=async()=>{if(b)try{const J={cliente:b.cliente||null,rtn:b.rtn||null,nota:b.nota||null,subtotal:Number(b.subtotal||0),isv:Number(b.isv||0),impuesto_18:Number(b.impuesto_18||0),impuesto_turistico:Number(b.impuesto_turistico||0),total:Number(b.total||0)},{error:Z}=await ne.from("cotizaciones").update(J).eq("id",b.id);if(Z&&console.warn("Error actualizando cotizacion:",Z),b.id){const{error:F}=await ne.from("cotizaciones_detalle").delete().eq("cotizacion_id",b.id);F&&console.warn("Error borrando detalles antiguos:",F);const k=g.map(_e=>({..._e,cotizacion_id:b.id})),{error:W}=await ne.from("cotizaciones_detalle").insert(k);W&&console.warn("Error insertando detalles actualizados:",W)}j(!1),T()}catch(J){console.warn("Error guardando cotizacion editada:",J)}};return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Cotizaciones Guardadas"}),r.jsxs("div",{children:[r.jsx("button",{onClick:T,className:"btn-opaque",style:{marginRight:8},children:"Refrescar"}),r.jsx("button",{onClick:o,className:"btn-opaque",children:"Volver"})]})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("label",{style:{color:"#475569",fontSize:14},children:"Buscar:"}),r.jsx("input",{placeholder:"Nmero o cliente",value:G,onChange:J=>E(J.target.value),style:{padding:8,borderRadius:6,border:"1px solid #e6edf3",minWidth:240}}),r.jsx("button",{onClick:()=>E(""),className:"btn-opaque",style:{marginLeft:6},children:"Limpiar"})]})}),l?r.jsx("div",{children:"Cargando..."}):a.length===0?r.jsx("div",{style:{color:"#64748b"},children:"No hay cotizaciones guardadas."}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Nmero"}),r.jsx("th",{style:{padding:8},children:"Fecha"}),r.jsx("th",{style:{padding:8},children:"Usuario"}),r.jsx("th",{style:{padding:8},children:"Cliente ID"}),r.jsx("th",{style:{padding:8},children:"Total"}),r.jsx("th",{style:{padding:8},children:"Estado"}),r.jsx("th",{style:{padding:8},children:"Acciones"})]})}),r.jsx("tbody",{children:a.filter(J=>{if(!G)return!0;const Z=G.toLowerCase(),F=(J.numero_cotizacion||"").toLowerCase(),k=(J.cliente_nombre||"")?.toLowerCase(),W=(J.usuario||"").toLowerCase();return F.includes(Z)||k.includes(Z)||W.includes(Z)}).map(J=>r.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[r.jsx("td",{style:{padding:8},children:J.numero_cotizacion||""}),r.jsx("td",{style:{padding:8},children:J.fecha_cotizacion?new Date(J.fecha_cotizacion).toLocaleString():""}),r.jsx("td",{style:{padding:8},children:J.usuario||""}),r.jsx("td",{style:{padding:8},children:J.cliente_nombre||(J.cliente_id?String(J.cliente_id):"")}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||0).toFixed(2)]}),r.jsx("td",{style:{padding:8},children:J.estado||""}),r.jsxs("td",{style:{padding:8},children:[r.jsx("button",{onClick:()=>q(J.id),className:"btn-opaque",style:{marginRight:6},children:"Ver"}),String(J.estado||"").toLowerCase()==="aceptada"?r.jsx("button",{className:"btn-opaque",style:{marginRight:6,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"No se puede editar una cotizacin aceptada",children:"Editar"}):r.jsx("button",{onClick:()=>U(J),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),r.jsx("button",{onClick:()=>H(J.id),className:"btn-opaque",style:{background:"#ef4444",color:"white"},children:"Eliminar"})]})]},J.id))})]})]}),m&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Detalle de Cotizacin #",d]}),r.jsx("button",{onClick:()=>{v(!1),p([]),f(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[O&&r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Nmero:"})," ",O.numero_cotizacion]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Fecha:"})," ",O.fecha_cotizacion?new Date(O.fecha_cotizacion).toLocaleString():""]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Usuario:"})," ",O.usuario]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Cliente:"})," ",M??(O.cliente_id?String(O.cliente_id):"C/F")]})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:[r.jsx("strong",{children:"Subtotal:"})," L ",Number(O.subtotal||0).toFixed(2)]}),r.jsxs("div",{children:[r.jsx("strong",{children:"Impuesto:"})," L ",Number(O.impuesto||0).toFixed(2)]}),r.jsxs("div",{style:{fontSize:"1.15rem",fontWeight:800},children:[r.jsx("strong",{children:"Total:"})," L ",Number(O.total||0).toFixed(2)]})]})]}),r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"Descripcin"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio U."}),r.jsx("th",{style:{padding:8},children:"Subtotal"}),r.jsx("th",{style:{padding:8},children:"Descuento"}),r.jsx("th",{style:{padding:8},children:"Total"})]})}),r.jsx("tbody",{children:g.map((J,Z)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:J.descripcion}),r.jsx("td",{style:{padding:8},children:J.cantidad}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.precio_unitario||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.subtotal||(J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.descuento||0).toFixed(2)]}),r.jsxs("td",{style:{padding:8},children:["L ",Number(J.total||(J.subtotal||0)-(J.descuento||0)).toFixed(2)]})]},Z))})]})]})]})}),x&&b&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:880,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0},children:["Editar Cotizacin #",b.id]}),r.jsx("button",{onClick:()=>{j(!1),p([]),w(null)},className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Cliente"}),r.jsx("input",{value:b.cliente||"",onChange:J=>w({...b,cliente:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"RTN"}),r.jsx("input",{value:b.rtn||"",onChange:J=>w({...b,rtn:J.target.value}),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{textAlign:"left",borderBottom:"1px solid #e6edf3"},children:[r.jsx("th",{style:{padding:8},children:"SKU"}),r.jsx("th",{style:{padding:8},children:"Nombre"}),r.jsx("th",{style:{padding:8},children:"Cantidad"}),r.jsx("th",{style:{padding:8},children:"Precio"}),r.jsx("th",{style:{padding:8},children:"Subtotal"})]})}),r.jsx("tbody",{children:g.map((J,Z)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f8fafc"},children:[r.jsx("td",{style:{padding:8},children:J.sku}),r.jsx("td",{style:{padding:8},children:J.nombre}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:J.cantidad||0,onChange:F=>{const k=Number(F.target.value||0),W=[...g];W[Z]={...W[Z],cantidad:k},p(W)},style:{width:80,padding:6}})}),r.jsx("td",{style:{padding:8},children:r.jsx("input",{type:"number",value:J.precio_unitario||0,onChange:F=>{const k=Number(F.target.value||0),W=[...g];W[Z]={...W[Z],precio_unitario:k},p(W)},style:{width:120,padding:6}})}),r.jsxs("td",{style:{padding:8},children:["L ",Number((J.precio_unitario||0)*(J.cantidad||0)).toFixed(2)]})]},Z))})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:()=>{j(!1),p([]),w(null)},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:he,className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"Guardar cambios"})]})]})]})})]})}function Y0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:1e3,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Pedidos en Lnea"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Aqu se mostrarn los pedidos recibidos por canales en lnea. Placeholder de ejemplo."}),r.jsx("p",{style:{color:"#6b7280"},children:"Integrar con API de pedidos cuando est disponible."})]})]})}function J0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Parcial"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte parcial de caja. Muestra resumen de ventas desde el ltimo corte."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar clculo y persistencia de cortes."})]})]})}function Q0({onBack:o}){return r.jsxs("div",{style:{padding:20,maxWidth:900,margin:"24px auto"},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"Corte de Caja Total"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{padding:"8px 12px"},children:"Volver"})]}),r.jsxs("section",{style:{background:"white",padding:16,borderRadius:8,boxShadow:"0 1px 6px rgba(2,6,23,0.06)"},children:[r.jsx("p",{children:"Registrar corte total de caja. Resumen completo del da o periodo seleccionado."}),r.jsx("p",{style:{color:"#6b7280"},children:"Placeholder: implementar reporte y exportacin."})]})]})}function X0({open:o,onClose:a,onSelect:s}){const[l,u]=S.useState(""),[d,f]=S.useState(!1),[g,p]=S.useState([]);return S.useEffect(()=>{if(!o)return;let m=!0;return(async()=>{f(!0);try{const{data:v,error:x}=await ne.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100);if(x)throw x;m&&p(Array.isArray(v)?v:[])}catch(v){console.warn("Error cargando clientes:",v)}finally{m&&f(!1)}})(),()=>{m=!1}},[o]),S.useEffect(()=>{if(!o)return;const m=setTimeout(async()=>{f(!0);try{const v=String(l||"").trim();let x;if(v===""?x=await ne.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").order("id",{ascending:!1}).limit(100):x=await ne.from("clientes").select("id,nombre,rtn,telefono,correo_electronico,tipo_cliente,exonerado").or(`nombre.ilike.%${v}%,rtn.ilike.%${v}%`).order("id",{ascending:!1}).limit(100),x.error)throw x.error;p(Array.isArray(x.data)?x.data:[])}catch(v){console.warn("Error buscando clientes:",v)}finally{f(!1)}},250);return()=>clearTimeout(m)},[l,o]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:99999},children:r.jsxs("div",{style:{width:820,maxWidth:"95%",maxHeight:"80vh",overflow:"auto",background:"white",borderRadius:10,padding:16},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Buscar Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{value:l,onChange:m=>u(m.target.value),placeholder:"Buscar por nombre o RTN...",style:{flex:1,padding:8,borderRadius:6,border:"1px solid #e2e8f0"}}),r.jsx("div",{style:{minWidth:100,textAlign:"right"},children:d?"Cargando...":`${g.length} encontrados`})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8},children:"RTN"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Nombre / Razn social"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Telfono"}),r.jsx("th",{style:{textAlign:"left",padding:8},children:"Correo"}),r.jsx("th",{style:{padding:8}})]})}),r.jsxs("tbody",{children:[g.map(m=>r.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[r.jsx("td",{style:{padding:8},children:m.rtn}),r.jsx("td",{style:{padding:8},children:m.nombre}),r.jsx("td",{style:{padding:8},children:m.telefono}),r.jsx("td",{style:{padding:8},children:m.correo_electronico}),r.jsx("td",{style:{padding:8},children:r.jsx("button",{onClick:()=>{s(m),a()},className:"btn-opaque",children:"Seleccionar"})})]},String(m.id))),g.length===0&&!d&&r.jsx("tr",{children:r.jsx("td",{colSpan:5,style:{padding:16,textAlign:"center",color:"#64748b"},children:"No hay clientes"})})]})]})})]})}):null}function F0({open:o,onClose:a,totalDue:s,onConfirm:l}){const[u,d]=S.useState(0),[f,g]=S.useState(0),[p,m]=S.useState(0);S.useEffect(()=>{o||(d(0),g(0),m(0))},[o]);const v=Number((Number(u)+Number(f)+Number(p)).toFixed(2)),x=Number((s-v).toFixed(2)),j=v>=s&&v>0,b=()=>{const w=[];u>0&&w.push(`efectivo:(${u.toFixed(2)})`),f>0&&w.push(`tarjeta:(${f.toFixed(2)})`),p>0&&w.push(`transferencia:(${p.toFixed(2)})`);const T=w.join(",");l({efectivo:u,tarjeta:f,transferencia:p,totalPaid:v,tipoPagoString:T}),a()};return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:11e3},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0},children:"Registrar Pago"}),r.jsx("button",{onClick:a,className:"btn-opaque",children:"Cerrar"})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsxs("div",{style:{marginBottom:8},children:["Total a pagar: ",r.jsxs("strong",{children:["L ",s.toFixed(2)]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[r.jsxs("div",{children:[r.jsx("label",{children:"Efectivo"}),r.jsx("input",{type:"number",value:u,onChange:w=>d(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Tarjeta"}),r.jsx("input",{type:"number",value:f,onChange:w=>g(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsxs("div",{children:[r.jsx("label",{children:"Transferencia"}),r.jsx("input",{type:"number",value:p,onChange:w=>m(Number(w.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e6edf3"}})]}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8},children:r.jsxs("div",{children:[r.jsx("label",{children:"Total ingresado"}),r.jsxs("div",{style:{padding:8,borderRadius:6,border:"1px solid #e6edf3"},children:["L ",v.toFixed(2)]})]})})]}),r.jsx("div",{style:{marginTop:12},children:x>0?r.jsxs("div",{style:{color:"#ef4444"},children:["Falta: L ",x.toFixed(2)]}):r.jsxs("div",{style:{color:"#16a34a"},children:["Pago completo. Cambio/Exceso: L ",Math.abs(x).toFixed(2)]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:b,className:"btn-opaque",disabled:!j,style:{background:j?"#16a34a":"gray",color:"white"},children:"Confirmar pago"})]})]})]})}):null}function Z0({productos:o,imageUrls:a,agregarAlCarrito:s,openUbicacion:l,thStyle:u,tdStyle:d,skuStyle:f}){return r.jsx("div",{style:{maxHeight:"70vh",overflowY:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f1f5f9",position:"sticky",top:0,zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:u}),r.jsx("th",{style:u,children:"Imagen"}),r.jsx("th",{style:u,children:"SKU"}),r.jsx("th",{style:u,children:"Nombre"}),r.jsx("th",{style:u,children:"Categora"}),r.jsx("th",{style:u,children:"Precio"}),r.jsx("th",{style:u,children:"Stock"}),r.jsx("th",{style:u,children:"Accin"})]})}),r.jsx("tbody",{children:o.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{textAlign:"center",padding:40,color:"#94a3b8",fontSize:"1rem"},children:"No se encontraron productos"})}):o.map(g=>r.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0"},children:[r.jsx("td",{style:d,children:r.jsx("button",{type:"button",onClick:()=>l(g.sku||""),title:"Ver ubicacin",className:"btn-opaque",style:{padding:6,borderRadius:6},children:""})}),r.jsx("td",{style:d,children:a[String(g.id)]?r.jsx("img",{src:encodeURI(a[String(g.id)]),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):g.imagen?r.jsx("img",{src:String(g.imagen),alt:String(g.nombre||""),style:{width:32,height:32,objectFit:"cover"},onError:p=>{p.currentTarget.src=""}}):""}),r.jsx("td",{style:d,children:r.jsx("code",{style:f,children:g.sku})}),r.jsx("td",{style:d,children:r.jsx("strong",{children:g.nombre})}),r.jsx("td",{style:d,children:r.jsx("span",{style:{color:"#64748b"},children:g.categoria})}),r.jsxs("td",{style:d,children:["L",Number(g.precio||0).toFixed(2)]}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=p>10?"#16a34a":p>0?"#d97706":"#dc2626";return r.jsx("span",{style:{color:m,fontWeight:600},children:p})})()}),r.jsx("td",{style:d,children:(()=>{const p=Number(g.stock||0),m=Number(g.precio||0),v=p<1||m<=0,x=v?p<1?"Agotado":"Sin precio":"Agregar";return r.jsx("button",{onClick:()=>s(g),disabled:v,className:"btn-opaque",style:{padding:"6px 14px",borderRadius:6,fontSize:"0.8rem"},title:v?p<1?"No hay stock disponible":"El producto no tiene precio vlido":"Agregar al carrito",children:x})})()})]},g.id))})]})})}function W0({carrito:o,actualizarCantidad:a,eliminarDelCarrito:s,vaciarCarrito:l,subtotal:u,perItemTaxes:d,taxRate:f,tax18Rate:g,taxTouristRate:p,total:m,openSelector:v,btnStyle:x}){return r.jsxs("div",{style:{background:"white",borderRadius:10,padding:16,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",height:"fit-content",position:"sticky",top:16,alignSelf:"start"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("h3",{style:{margin:0,fontSize:"1.1rem",fontWeight:600},children:["Carrito (",o.length,")"]}),o.length>0&&r.jsx("button",{onClick:l,className:"btn-opaque",style:{background:"transparent",color:"#2563eb",fontSize:"0.85rem",padding:"6px 8px"},children:"Vaciar"})]}),o.length>0&&r.jsxs("div",{style:{border:"2px solid #e2e8f0",borderRadius:8,padding:12,marginBottom:16,background:"#f8fafc"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:500},children:[r.jsx("span",{children:"Subtotal:"}),r.jsxs("span",{children:["L",u.toFixed(2)]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",color:"#16a34a",fontWeight:500},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsxs("div",{children:["ISV (",(f*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.isv||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto 18%: ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.imp18||0),0)).toFixed(2)]})]}),r.jsxs("div",{children:["Impuesto turstico (",(p*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L",Number(d.reduce((j,b)=>j+(b.tur||0),0)).toFixed(2)]})]})]})}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"1.25rem",fontWeight:700,marginTop:8,color:"#1e293b"},children:[r.jsx("span",{children:"TOTAL:"}),r.jsxs("span",{children:["L",m.toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#475569"},children:[r.jsxs("div",{children:["Tax rates: ISV ",(f*100).toFixed(2),"%, 18% ",(g*100).toFixed(2),"%, Tur ",(p*100).toFixed(2),"%"]}),r.jsxs("details",{style:{marginTop:6},children:[r.jsx("summary",{style:{cursor:"pointer"},children:"Ver desglose por tem"}),r.jsx("div",{style:{marginTop:8},children:d.map(j=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:"1px dashed #eef2ff"},children:[r.jsxs("div",{style:{color:"#0f172a"},children:[j.nombre,"  L",j.price.toFixed(2)]}),r.jsxs("div",{style:{color:"#0f172a"},children:["ISV: L",j.isv.toFixed(2),"  18%: L",j.imp18.toFixed(2),"  Tur: L",j.tur.toFixed(2)]})]},String(j.id)))})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:16},children:[r.jsx("button",{onClick:()=>v("cotizacion"),className:"btn-opaque",children:"Cotizacin"}),r.jsx("button",{onClick:()=>v("factura"),className:"btn-opaque",children:"Facturar"})]})]}),o.length===0?r.jsx("div",{style:{textAlign:"center",padding:"40px 0",color:"#94a3b8",fontStyle:"italic"},children:"Carrito vaco"}):r.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto",borderTop:"1px solid #e2e8f0",paddingTop:8},children:o.map(j=>r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px dashed #e2e8f0"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:500,fontSize:"0.9rem"},children:["[",j.producto.sku,"] ",j.producto.nombre]}),r.jsxs("div",{style:{fontSize:"0.8rem",color:"#64748b"},children:["L",Number(j.producto.precio||0).toFixed(2)," c/u"]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("button",{onClick:()=>a(j.producto.id,-1),style:x,children:""}),r.jsx("span",{style:{minWidth:28,textAlign:"center",fontWeight:600},children:j.cantidad}),r.jsx("button",{onClick:()=>a(j.producto.id,1),style:x,children:"+"}),r.jsx("button",{onClick:()=>s(j.producto.id),style:{...x,background:"#ef4444"},children:""})]})]},j.producto.id))})]})}function e_({userName:o,userRole:a,userId:s,caiInfo:l,onOpenDatosFactura:u,onLogout:d,onNavigate:f}){const[g,p]=S.useState(!1),m=S.useRef(null);return S.useEffect(()=>{function v(x){m.current&&!m.current.contains(x.target)&&p(!1)}return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]),r.jsxs("header",{style:{background:"#1e293b",color:"white",padding:"14px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative"},children:[r.jsx("h1",{style:{margin:0,fontSize:"1.4rem",fontWeight:600},children:"Solutecc  -  Caja"}),r.jsxs("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:"none"},children:[r.jsx("div",{style:{fontSize:"0.95rem",color:"#e2e8f0",fontWeight:500},children:o?`${o}`:""}),r.jsx("div",{style:{fontSize:"0.8rem",color:"#94a3b8"},children:a?`${a}`:""}),s!=null&&r.jsxs("div",{style:{fontSize:"0.75rem",color:"#cbd5e1",marginTop:2},children:["ID: ",String(s)]})]}),r.jsxs("div",{style:{position:"relative"},ref:m,children:[r.jsx("button",{onClick:()=>p(v=>!v),"aria-expanded":g,className:"btn-opaque",style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:8},children:"Menu "}),g&&r.jsxs("div",{style:{position:"absolute",right:0,marginTop:8,background:"white",color:"#0b1724",borderRadius:8,boxShadow:"0 8px 24px rgba(2,6,23,0.16)",minWidth:220,zIndex:60,overflow:"hidden"},children:[r.jsx("button",{onClick:()=>{p(!1),d()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cerrar Sesin"}),r.jsx("button",{onClick:()=>{p(!1),u&&u()},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Datos de factura"}),r.jsx("button",{onClick:()=>{p(!1),f("DevolucionCaja")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Devolucin de caja"}),r.jsx("button",{onClick:()=>{p(!1),f("IngresoEfectivo")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Ingreso de efectivo"}),r.jsx("button",{onClick:()=>{p(!1),f("CotizacionesGuardadas")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Cotizaciones guardadas"}),r.jsx("button",{onClick:()=>{p(!1),f("PedidosEnLinea")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Pedidos en lnea"}),r.jsx("button",{onClick:()=>{p(!1),f("CorteCajaParcial")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja parcial"}),r.jsx("button",{onClick:()=>{p(!1),f("CorteCajaTotal")},className:"btn-opaque",style:{width:"100%",background:"transparent",color:"#0b1724",padding:"10px 12px",textAlign:"left"},children:"Corte de caja total"})]})]})]})}function t_({open:o,onClose:a,width:s=520,children:l,zIndex:u=9999}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:u},onClick:()=>{a&&a()},children:r.jsx("div",{onClick:d=>d.stopPropagation(),style:{width:s,maxWidth:"95%",background:"white",borderRadius:12,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:l})}):null}function n_({open:o,onClose:a,caiInfo:s}){return r.jsx(t_,{open:o,onClose:a,width:520,children:r.jsxs("div",{children:[r.jsx("h3",{style:{marginTop:0},children:"Datos de factura"}),r.jsxs("div",{style:{color:"#475569",marginTop:8},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"CAI:"})," ",s?.cai??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango desde:"})," ",s?.rango_de??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Rango hasta:"})," ",s?.rango_hasta??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Fecha lmite emisin:"})," ",s?.fecha_vencimiento??s?.fecha_limite_emision??"-"]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Secuencia actual:"})," ",s?.secuencia_actual??"-"]})]}),r.jsx("div",{style:{marginTop:18,display:"flex",justifyContent:"flex-end",gap:8},children:r.jsx("button",{className:"btn-opaque",onClick:a,style:{padding:"8px 12px"},children:"Cerrar"})})]})})}function a_({open:o,selectedEntrada:a,onClose:s,imageUrls:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:10,padding:18,boxShadow:"0 12px 40px rgba(2,6,23,0.3)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:a?a.producto:"Ubicacin"}),r.jsx("button",{onClick:s,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),a?r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(()=>{const u=a.id?l[String(a.id)]??a.imagen:a.imagen;return u?r.jsx("img",{src:encodeURI(String(u)),alt:a.producto,style:{width:320,height:200,objectFit:"cover",borderRadius:8,flexShrink:0},onError:d=>{d.currentTarget.src=""}}):r.jsx("div",{style:{width:320,height:200,background:"#f1f5f9",borderRadius:8,display:"flex",alignItems:"center",justifyContent:"center"},children:"Sin imagen"})})(),r.jsxs("div",{style:{flex:1},children:[r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"SKU:"})," ",a.sku]}),r.jsxs("p",{style:{margin:"6px 0"},children:[r.jsx("strong",{children:"Descripcin:"})," ",a.descripcion]}),r.jsxs("div",{style:{marginTop:8,padding:8,borderRadius:8,background:"#f8fafc"},children:[r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Seccin:"})," ",a.ubicacion?.seccion]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Bloque:"})," ",a.ubicacion?.bloque]}),r.jsxs("p",{style:{margin:0},children:[r.jsx("strong",{children:"Estante:"})," ",a.ubicacion?.estante]})]}),r.jsx("p",{style:{marginTop:8,color:"#6b7280"},children:r.jsxs("small",{children:["Cantidad: ",a.cantidad]})})]})]})}):r.jsx("div",{children:r.jsx("p",{children:"No se encontr informacin de ubicacin para este artculo."})})]})}):null}function i_({open:o,onClose:a,onCancel:s,onSave:l}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:520,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Guardar cotizacin"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569"},children:"Desea guardar esta cotizacin en el sistema al finalizar el flujo?"}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{onClick:s,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"No, cerrar"}),r.jsx("button",{onClick:async()=>{await l()},className:"btn-opaque",style:{background:"#2563eb",color:"white"},children:"S, guardar"})]})]})}):null}function r_({open:o,onClose:a,doFacturaClienteFinal:s,doFacturaClienteNormal:l,doFacturaClienteJuridico:u,carritoLength:d,subtotal:f,taxRate:g,taxableSubtotal:p}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)",display:"flex",gap:16,alignItems:"stretch"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Seleccionar tipo de cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:"Elige si la factura ser para Cliente Final o para un Cliente registrado. Cliente Final genera una factura inmediata lista para imprimir. Cliente Normal permite ingresar datos del cliente."}),r.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[r.jsxs("div",{onClick:s,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Final"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Factura para consumidor final. No requiere RTN."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:l,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Normal"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar nombre y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]}),r.jsxs("div",{onClick:u,role:"button",tabIndex:0,style:{flex:1,borderRadius:10,padding:14,cursor:"pointer",boxShadow:"0 6px 18px rgba(2,6,23,0.08)",border:"1px solid #e6edf3",display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontSize:28},children:""}),r.jsx("div",{style:{fontWeight:700},children:"Cliente Jurdico"}),r.jsx("div",{style:{color:"#64748b",fontSize:13},children:"Ingresar razn social y nmero de identificacin (RTN) para la factura."}),r.jsx("div",{style:{marginTop:8,color:"#0f172a",fontWeight:700},children:""})]})]})]}),r.jsxs("div",{style:{width:220,borderLeft:"1px dashed #e6edf3",paddingLeft:16,display:"flex",flexDirection:"column",gap:8},children:[r.jsx("div",{style:{fontWeight:700},children:"Resumen"}),r.jsxs("div",{style:{color:"#475569"},children:["Items: ",r.jsx("strong",{children:d})]}),r.jsxs("div",{style:{color:"#475569"},children:["SubTotal: ",r.jsxs("strong",{children:["L ",f.toFixed(2)]})]}),r.jsxs("div",{style:{color:"#475569"},children:["ISV (",(g*100).toFixed(2),"%): ",r.jsxs("strong",{children:["L ",(p*g).toFixed(2)]})]}),r.jsxs("div",{style:{marginTop:8,fontSize:18,fontWeight:800},children:["Total: L ",(f+p*g).toFixed(2)]}),r.jsx("div",{style:{marginTop:12,fontSize:12,color:"#94a3b8"},children:"Seleccione una opcin para continuar."})]})]})}):null}function s_({open:o,onClose:a,clienteTipo:s,clienteRTN:l,clienteNombre:u,clienteTelefono:d,clienteCorreo:f,clienteExonerado:g,clienteSearchOpen:p,setClienteSearchOpen:m,onRTNChange:v,onNombreChange:x,onTelefonoChange:j,onCorreoChange:b,onExoneradoChange:w,onCreateCliente:T,onCancel:O,onOpenCreateCliente:C,onOpenPayment:M,paymentDone:B,submitClienteNormal:G}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:600,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:s==="juridico"?"Datos del Cliente (Jurdico)":"Datos del Cliente"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsx("p",{style:{color:"#475569",marginTop:6},children:s==="juridico"?"Ingrese nmero de identificacin (RTN) y razn social del cliente jurdico. Estos datos se incluirn en la factura.":"Ingrese nmero de identificacin (RTN) y nombre completo del cliente. Estos datos se incluirn en la factura."}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN o Identificacin"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{value:l,onChange:E=>v(E.target.value),placeholder:"00000000000000",style:{flex:1,padding:10,borderRadius:8,border:"1px solid #e2e8f0"}}),s==="juridico"&&r.jsx("button",{onClick:()=>m(!0),className:"btn-opaque",style:{padding:"8px 10px"},children:"Buscar"})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:s==="juridico"?"Razn social":"Nombre completo"}),r.jsx("input",{value:u,onChange:E=>x(E.target.value),placeholder:s==="juridico"?"Razn social de la empresa":"Nombre del cliente",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx(X0,{open:p,onClose:()=>m(!1),onSelect:E=>{}}),r.jsx("button",{onClick:O,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:C,className:"btn-opaque",style:{background:"transparent",color:"#0b5cff"},children:"Crear cliente"}),B?r.jsx("button",{onClick:G,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Generar Factura"}):r.jsx("button",{onClick:M,className:"btn-opaque",disabled:!u||!l,style:{opacity:!u||!l?.6:1},children:"Realizar pago"})]})]})}):null}function l_({open:o,onClose:a,clienteRTN:s,clienteNombre:l,clienteTelefono:u,clienteCorreo:d,clienteExonerado:f,onChangeRTN:g,onChangeNombre:p,onChangeTelefono:m,onChangeCorreo:v,onChangeExonerado:x,onCreate:j}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(2,6,23,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"white",borderRadius:12,padding:20,boxShadow:"0 18px 50px rgba(2,6,23,0.35)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"Crear Cliente Jurdico"}),r.jsx("button",{onClick:a,className:"btn-opaque",style:{padding:"6px 10px"},children:"Cerrar"})]}),r.jsxs("p",{style:{color:"#475569",marginTop:6},children:["Complete los datos del cliente jurdico. El campo tipo se fijar a ",r.jsx("strong",{children:"juridico"}),"."]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"RTN"}),r.jsx("input",{value:s,onChange:b=>g(b.target.value),placeholder:"00000000000000",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Razn social"}),r.jsx("input",{value:l,onChange:b=>p(b.target.value),placeholder:"Razn social",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Telfono"}),r.jsx("input",{value:u,onChange:b=>m(b.target.value),placeholder:"Telfono",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("label",{style:{fontSize:13,color:"#334155"},children:"Correo electrnico"}),r.jsx("input",{value:d,onChange:b=>v(b.target.value),placeholder:"correo@ejemplo.com",style:{padding:10,borderRadius:8,border:"1px solid #e2e8f0"}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{id:"exon",type:"checkbox",checked:f,onChange:b=>x(b.target.checked)}),r.jsx("label",{htmlFor:"exon",children:"Exonerado"})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[r.jsx("button",{onClick:a,className:"btn-opaque",style:{background:"transparent",color:"#111"},children:"Cancelar"}),r.jsx("button",{onClick:async()=>{await j()},className:"btn-opaque",style:{opacity:!l||!s?.6:1},disabled:!l||!s,children:"Crear cliente"})]})]})}):null}function ip(o={},a="factura",s={}){const l=o.cliente||(a==="factura"?"Consumidor Final":"Cotizacin Cliente"),u=o.rtn||"C/F",d=o.factura||String(Math.floor(Math.random()*9e5)+1e5),f=new Date().toLocaleString(),g=Array.isArray(s.carrito)?s.carrito:[],p=typeof s.subtotal=="number"?s.subtotal:g.reduce((M,B)=>M+Number(B.producto&&B.producto.precio||B.precio||0)*(B.cantidad||1),0),m=typeof s.isvTotal=="number"?s.isvTotal:0,v=typeof s.imp18Total=="number"?s.imp18Total:0,x=typeof s.impTouristTotal=="number"?s.impTouristTotal:0,j=p+m+v+x,w=g.map(M=>{const B=String(M.producto&&(M.producto.nombre||M.producto.descripcion)||M.descripcion||M.nombre||""),G=Number(M.cantidad||0),E=Number((M.producto&&(M.producto.precio??M.producto.precio_unitario))??M.precio_unitario??M.precio??0),q=E.toFixed(2),U=(G*E).toFixed(2);return`<tr><td>${M.producto&&M.producto.sku||M.sku||""} ${B}</td><td style="text-align:center">${G}</td><td style="text-align:right">L ${q}</td><td style="text-align:right">L ${U}</td></tr>`}).join(`
`),T=a==="factura"?"FACTURA":"COTIZACIN",O=a==="factura"?"":'<div style="margin-top:12px;text-align:center;color:#475569">Vlida por 24 horas desde la fecha de emisin.</div>';return`<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>${T}</title><style>
    body{font-family:Arial,Helvetica,sans-serif;font-size:12px;color:#000;margin:20px}
    .factura{max-width:800px;margin:0 auto}
    .header{display:flex;justify-content:space-between;align-items:center}
    .header img{width:180px;height:auto}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border:1px solid #000;padding:6px;text-align:left}
    th{background:#eee}
    .right{text-align:right}
    </style></head><body><div class="factura"><div class="header"><div>
    <h2>Solutecc - Punto de Ventas</h2>
    <div>RTN: 00000000000000</div>
    </div><div><h3>${T}</h3><div>No: ${d}</div><div>Fecha: ${f}</div></div></div>
    <hr/>
    <div><strong>Cliente:</strong> ${l}</div>
    <div><strong>RTN:</strong> ${u}</div>
    <table><thead><tr><th>Descripcin</th><th>Cant</th><th>Precio</th><th>Total</th></tr></thead><tbody>
    ${w}
    </tbody></table>
    <div style="margin-top:8px;text-align:right"><div>SubTotal: L ${p.toFixed(2)}</div><div>ISV: L ${m.toFixed(2)}</div><div>Impuesto 18%: L ${v.toFixed(2)}</div><div>Impuesto turstico: L ${x.toFixed(2)}</div><h3>Total: L ${j.toFixed(2)}</h3></div>
    ${O}
    <div style="margin-top:20px;text-align:center"><small>Gracias por su preferencia</small></div>
    </div></body></html>`}function o_({onLogout:o}){S.useEffect(()=>{const V=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=V||""}},[]);const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,f]=S.useState(""),[g,p]=S.useState("Todas"),[m,v]=S.useState(.15),[x,j]=S.useState(0),[b,w]=S.useState(0),T=["Todas",...Array.from(new Set(a.map(V=>V.categoria)))],O=a.filter(V=>(String(V.nombre||"").toLowerCase().includes(d.toLowerCase())||String(V.sku||"").toLowerCase().includes(d.toLowerCase()))&&(g==="Todas"||V.categoria===g)),C=l.reduce((V,re)=>V+Number(re.producto.precio||0)*re.cantidad,0);let M=0,B=0,G=0;for(const V of l){const re=Number(V.producto.precio||0)*V.cantidad,xe=!!V.producto.exento,ue=!!V.producto.aplica_impuesto_18,ge=!!V.producto.aplica_impuesto_turistico;if(!xe){if(ue){const be=re*(x||0);B+=be}else{const be=re*(m||0);M+=be}ge&&(G+=re*(b||0))}}const E=C+M+B+G,q=l.map(V=>{const re=Number(V.producto.precio||0)*V.cantidad,xe=!!V.producto.exento,ue=!!V.producto.aplica_impuesto_18,ge=!!V.producto.aplica_impuesto_turistico;if(xe)return{id:V.producto.id,nombre:V.producto.nombre,price:re,isv:0,imp18:0,tur:0,totalTax:0};const be=ue?0:re*(m||0),ve=ue?re*(x||0):0,Oe=ge?re*(b||0):0;return{id:V.producto.id,nombre:V.producto.nombre,price:re,isv:be,imp18:ve,tur:Oe,totalTax:be+ve+Oe}}),U=V=>{const re=Number(V.stock??0),xe=Number(V.precio??0);re<1||xe<=0||u(ue=>ue.find(be=>be.producto.id===V.id)?ue.map(be=>be.producto.id===V.id?{...be,cantidad:be.cantidad+1}:be):[...ue,{producto:V,cantidad:1}])},H=(V,re)=>{u(xe=>xe.map(ue=>{if(String(ue.producto.id)===String(V)){const ge=ue.cantidad+re;return ge>0?{...ue,cantidad:ge}:ue}return ue}).filter(ue=>ue.cantidad>0))},he=V=>{u(re=>re.filter(xe=>String(xe.producto.id)!==String(V)))},J=()=>u([]),[Z,F]=S.useState(!1),[k,W]=S.useState("factura"),[_e,D]=S.useState(!1),[L,ee]=S.useState(null),[oe,pe]=S.useState(null),[A,z]=S.useState(!1),[K,Q]=S.useState(!1),[se,ie]=S.useState(""),[fe,de]=S.useState(""),ye=S.useRef(null),Ue=S.useRef(null),[Ve,ze]=S.useState("final"),[De,Qe]=S.useState(""),[ht,Dt]=S.useState(""),[Et,$t]=S.useState(!1),[Ln,lt]=S.useState(!1),[ut,An]=S.useState(!1),[Ml,Ot]=S.useState(!1),[ql,oi]=S.useState(null),[as,ka]=S.useState(!1),Ll=async V=>{if(de(V),!V||String(V).trim()===""){ie("");return}try{if(Ve==="juridico"){console.debug("handleRTNChange: buscando cliente juridico para RTN=",V);const{data:ge,error:be}=await ne.from("clientes").select("id,nombre,telefono,correo_electronico,exonerado").eq("rtn",V).eq("tipo_cliente","juridico").maybeSingle();if(console.debug("handleRTNChange: supabase response",{data:ge,error:be}),!be&&ge&&ge.nombre){ie(ge.nombre||""),Qe(ge.telefono||""),Dt(ge.correo_electronico||""),$t(!!ge.exonerado),setTimeout(()=>{try{Ue.current?.focus()}catch{}},50);return}else{ie(""),Qe(""),Dt(""),$t(!1);return}}const re="clientenatural";console.debug("handleRTNChange: buscando clientenatural para RTN=",V);const{data:xe,error:ue}=await ne.from(re).select("nombre").eq("rtn",V).maybeSingle();console.debug("handleRTNChange: supabase response clientenatural",{data:xe,error:ue}),!ue&&xe&&xe.nombre?(ie(xe.nombre||""),setTimeout(()=>{try{Ue.current?.focus()}catch{}},50)):ie("")}catch(re){console.warn("Error buscando cliente por RTN:",re)}},is=V=>{if(V==="cotizacion"){W("cotizacion"),F(!0);return}W(V),F(!0)},Il=async(V={})=>{try{if(!l||l.length===0)return null;const re=ci(),xe=M,ue=B,ge=G,be=Number(xe||0)+Number(ue||0)+Number(ge||0),ve=re+be;let Oe=V.cliente_id??null;if(!Oe&&V.rtn)try{const{data:Xe,error:gt}=await ne.from("clientes").select("id").eq("rtn",V.rtn).maybeSingle();!gt&&Xe&&Xe.id&&(Oe=Xe.id)}catch{}const ce=Rn||"system",me=String(Math.floor(Math.random()*9e5)+1e5),Se={cliente_id:Oe,usuario:ce,numero_cotizacion:me,validez_dias:30,subtotal:re,impuesto:be,total:ve,estado:"pendiente"};let Be=V.cotizacion_id??oe;if(Be){const Xe={cliente_id:Se.cliente_id||null,usuario:Se.usuario,validez_dias:Se.validez_dias,subtotal:Se.subtotal,impuesto:Se.impuesto,total:Se.total,estado:Se.estado},{error:gt}=await ne.from("cotizaciones").update(Xe).eq("id",Be);if(gt)return console.warn("Error actualizando cotizacion:",gt),null}else{const{data:Xe,error:gt}=await ne.from("cotizaciones").insert([Se]).select("id").maybeSingle();if(gt)return console.warn("Error insertando cotizacion:",gt),null;if(Be=Xe?.id||null,!Be)return null}const Le=l.map(Xe=>{const gt=Number(Xe.producto.precio||0),kn=Number(Xe.cantidad||0),Ma=!!Xe.producto.exento,hi=!!Xe.producto.aplica_impuesto_18,Un=!!Xe.producto.aplica_impuesto_turistico,zn=Ma||hi?0:gt*(m||0)*kn,Ne=Ma?0:hi?gt*(x||0)*kn:0,Ke=Ma?0:Un?gt*(b||0)*kn:0,Ht=gt*kn,it=Ht+zn+Ne+Ke;return{cotizacion_id:Be,producto_id:Xe.producto.id||null,descripcion:Xe.producto.nombre||"",cantidad:kn,precio_unitario:gt,subtotal:Ht,descuento:0,total:it}});try{await ne.from("cotizaciones_detalle").delete().eq("cotizacion_id",Be)}catch{}const{error:Ze}=await ne.from("cotizaciones_detalle").insert(Le);return Ze?console.warn("Error insertando cotizaciones_detalle:",Ze):console.debug("Cotizacion guardada id=",Be),Be}catch(re){return console.warn("Error guardando cotizacion:",re),null}},ci=()=>l.reduce((V,re)=>V+Number(re.producto.precio||0)*re.cantidad,0),Ua=()=>l.reduce((V,re)=>V+(re.producto.exento?0:Number(re.producto.precio||0)*re.cantidad),0),Lt=async()=>{ze("final"),ie("Consumidor Final"),de("C/F"),console.debug("doFacturaClienteFinal: abrir modal pago (invoiceAfterPayment)"),ka(!0),An(!0),F(!1)},On=()=>{ze("normal"),ie(""),de(""),Ot(!1),oi(null),z(!0),F(!1)},It=()=>{ze("juridico"),ie(""),de(""),Ot(!1),oi(null),z(!0),F(!1)},Hl=async(V,re,xe)=>{const ue=ip({cliente:V,rtn:re},k,{carrito:l,subtotal:ci(),isvTotal:M,imp18Total:B,impTouristTotal:G});if(k==="factura"&&oe)try{console.debug("Pre-print: marcando cotizacion como aceptada, id=",oe);const{error:be}=await ne.from("cotizaciones").update({estado:"aceptada"}).eq("id",oe);if(be)console.warn("Error marcando cotizacion (pre-print):",be);else try{pe(null)}catch{}}catch(be){console.warn("Error marcacion pre-print:",be)}if(k==="factura")try{let be=null,ve=null;try{const Oe=localStorage.getItem("user"),ce=Oe?JSON.parse(Oe):null;ve=ce&&(ce.id||ce.user?.id||ce.sub||ce.user_id)?ce.id||ce.user?.id||ce.sub||ce.user_id:null;const me=ce&&(ce.username||ce.user?.username||ce.name||ce.user?.name)?ce.username||ce.user?.username||ce.name||ce.user?.name:null;if(console.debug("PV: CAI lookup - raw localStorage.user:",Oe),console.debug("PV: CAI lookup - parsed user object:",ce),console.debug("PV: CAI lookup - extracted userId:",ve,"typeof",typeof ve),console.debug("PV: CAI lookup - extracted userNameFromStorage:",me),ve){const Se=typeof ve=="string"&&/^\d+$/.test(ve)?Number(ve):ve;try{const{data:Be,error:Le}=await ne.from("cai").select("id,cai,fecha_vencimiento,rango_de,rango_hasta").eq("usuario_id",Se).order("id",{ascending:!1}).limit(1);!Le&&Array.isArray(Be)&&Be.length>0&&(be=Be[0])}catch(Be){console.debug("PV: CAI lookup by usuario_id failed (likely column missing):",Be)}}if(!be&&me)try{const{data:Se,error:Be}=await ne.from("cai").select("id,cai,fecha_vencimiento,rango_de,rango_hasta").eq("cajero",me).order("id",{ascending:!1}).limit(1);!Be&&Array.isArray(Se)&&Se.length>0&&(be=Se[0])}catch(Se){console.debug("PV: CAI lookup by cajero failed:",Se)}}catch(Oe){console.debug("No se pudo cargar CAI desde frontend:",Oe)}await rs({clienteName:V,rtn:re,paymentPayload:xe,caiData:be,usuarioId:ve})}catch(be){console.warn("Error preparando venta antes de imprimir:",be),alert("Error preparando venta antes de imprimir: "+String(be))}const ge=window.open("","_blank");if(ge){ge.document.open(),ge.document.write(ue),ge.document.close();try{ge.focus(),ge.print()}catch(be){console.warn("Error during print (finalize):",be)}setTimeout(()=>{try{ge.close()}catch{}},800)}k==="factura"&&(J(),await ss()),k==="cotizacion"&&(ee({cliente:V,rtn:re}),D(!0))},rs=async({clienteName:V,rtn:re,paymentPayload:xe,caiData:ue,usuarioId:ge})=>{if(!l||l.length===0)return null;const be=xe&&xe.tipoPagoString?String(xe.tipoPagoString):"",ve=xe&&xe.totalPaid?Number(xe.totalPaid||0):0,Oe=ve>Number(E||0)?ve-Number(E||0):0;let ce=String(Math.floor(Math.random()*9e5)+1e5);const me=ue||Ba||null;let Se=null;if(me&&(me.rango_de!==void 0||me.secuencia_actual!==void 0))try{const Ne=me.rango_de!=null?String(me.rango_de):"",Ke=me.rango_hasta!=null?String(me.rango_hasta):"",Ht=me.secuencia_actual!=null?String(me.secuencia_actual):"",it=Number(Ne.replace(/[^0-9]/g,""))||0,ra=(Number(Ht.replace(/[^0-9]/g,""))||0)+1;Se=ra;const fi=Math.max((Ke||Ne||"").length,String(it+ra).length,1),$l=it+ra;ce=String($l).padStart(fi,"0")}catch(Ne){console.debug("Error computing factura from cai, falling back to random:",Ne)}const Be={rtn:re||null,nombre_cliente:V||null,usuario:Rn||"system",factura:ce,tipo_pago:be,subtotal:Number(C||0),impuesto:Number(M+B+G||0),total:Number(E||0),estado:"pagada",cambio:String(Number(Oe).toFixed(2)),cai:me?.cai??null,rango_desde:me?.rango_de??null,rango_hasta:me?.rango_hasta??null,fecha_limite_emision:me?.fecha_vencimiento??me?.fecha_limite_emision??null};let Le=null,Ze=null;try{const Ne=await ne.from("ventas").insert([Be]).select("id, factura");Le=Ne.data??Ne,Ze=Ne.error??null}catch(Ne){Ze=Ne}if(console.debug("Insert venta response:",{ventaInsRaw:Le,ventaErr:Ze}),Ze){const Ne=String(Ze&&(Ze.message||Ze.msg||Ze.details)||""),Ke=Ze&&Ze.code?String(Ze.code):"";if(Ke==="PGRST204"||Ne.includes("Could not find the")||/column .* of 'ventas'/.test(Ne)){console.warn("Insert venta failed due missing column(s). Retrying without CAI fields.",{msg:Ne,code:Ke});const it={...Be};delete it.cai,delete it.rango_desde,delete it.rango_hasta,delete it.fecha_limite_emision;try{const Pt=await ne.from("ventas").insert([it]).select("id, factura");if(Le=Pt.data??Pt,Ze=Pt.error??null,console.debug("Fallback insert ventas response:",{ventaInsRaw:Le,ventaErr:Ze}),Ze)throw Ze}catch(Pt){throw console.error("Fallback insert also failed:",Pt),Pt}}else throw Ze}const Xe=Array.isArray(Le)?Le[0]:Le;let gt=Xe?Xe.id||Xe.id:null;if(!gt)try{const{data:Ne,error:Ke}=await ne.from("ventas").select("id").eq("factura",ce).maybeSingle();Ke&&console.debug("Error buscando venta por factura (fallback):",Ke),Ne&&Ne.id&&(gt=Ne.id)}catch(Ne){console.debug("fallback lookup error",Ne)}if(!gt)return console.warn("No se pudo obtener venta.id tras insertar. Respuesta:",Le),null;const kn=l.map(Ne=>{const Ke=Number(Ne.producto.precio||0),Ht=Number(Ne.cantidad||0),it=Ke*Ht,Pt=0,ra=it-Pt;return{venta_id:gt,factura:ce,producto_id:Ne.producto.id,cantidad:Ht,precio_unitario:Ke,subtotal:it,descuento:Pt,total:ra}});if(ue&&ge&&(Ne=>typeof Ne=="string"&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Ne))(ge))try{const Ne=l.map(it=>({producto_id:String(it.producto.id),cantidad:Number(it.cantidad||0),precio_unitario:Number(it.producto.precio||0),subtotal:Number((Number(it.producto.precio||0)*it.cantidad).toFixed(6)),descuento:0,total:Number((Number(it.producto.precio||0)*it.cantidad).toFixed(6))})),{data:Ke,error:Ht}=await ne.rpc("create_venta_with_detalle",{p_usuario_id:ge,p_usuario:Rn||ge,p_rtn:re||null,p_nombre_cliente:V||null,p_tipo_pago:be,p_subtotal:Number(C||0),p_impuesto:Number(M+B+G||0),p_total:Number(E||0),p_cambio:String(Number(Oe).toFixed(2)),p_detalles:Ne});if(console.debug("RPC create_venta_with_detalle response:",{rpcData:Ke,rpcErr:Ht}),Ht)console.warn("RPC create_venta_with_detalle failed, falling back to client inserts",Ht);else if(Ke&&Array.isArray(Ke)&&Ke.length>0){const it=Ke[0];return it.venta_id||it.venta_id===0?it.venta_id:gt}else if(Ke&&Ke.venta_id)return Ke.venta_id}catch(Ne){console.warn("Error calling RPC create_venta_with_detalle:",Ne)}else ue&&ge&&console.debug("Skipping RPC create_venta_with_detalle because usuarioId is not a UUID. usuarioId:",ge);const{data:hi,error:Un}=await ne.from("ventas_detalle").insert(kn).select("id");if(console.debug("Insert ventas_detalle response:",{detalleIns:hi,detErr:Un}),Un)throw Un;const zn=me&&(me.id||me.id===0)?me.id:null;if(zn!=null&&Se!=null)try{const{error:Ne}=await ne.from("cai").update({secuencia_actual:Se}).eq("id",zn);Ne?console.debug("Error updating cai.secuencia_actual (manual path):",Ne):console.debug("Updated cai.secuencia_actual to",Se,"for cai id",zn)}catch(Ne){console.debug("Exception updating cai.secuencia_actual:",Ne)}return gt},ss=async()=>{if(k==="factura"&&oe)try{console.debug("handlePostPrint: marcando cotizacion como facturado, id=",oe);const{error:V}=await ne.from("cotizaciones").update({estado:"aceptada"}).eq("id",oe);V?console.warn("Error marcando cotizacion como facturado:",V):console.debug("Cotizacion marcada como facturado:",oe)}catch(V){console.warn("Error procesando cotizacion tras facturar",V)}};S.useEffect(()=>{A&&setTimeout(()=>{try{ye.current?.focus()}catch{}},80)},[A]);const ui=async()=>{try{if(fe&&se){const ue={rtn:fe,nombre:se},{error:ge}=await ne.from("clientenatural").upsert(ue,{onConflict:"rtn"});ge&&console.warn("Error guardando clientenatural:",ge)}}catch(ue){console.warn("Error upsert clientenatural:",ue)}try{if(fe&&se)if(Ve==="juridico"){const{data:ue,error:ge}=await ne.from("clientes").select("id").eq("rtn",fe).eq("tipo_cliente","juridico").maybeSingle();if(ge&&console.warn("Error buscando cliente juridico:",ge),ue&&ue.id){const{error:be}=await ne.from("clientes").update({nombre:se,telefono:De||null,correo_electronico:ht||null,exonerado:Et}).eq("id",ue.id);be&&console.warn("Error actualizando cliente juridico:",be)}else{const{error:be}=await ne.from("clientes").insert([{nombre:se,rtn:fe,telefono:De||null,correo_electronico:ht||null,tipo_cliente:"juridico",exonerado:Et}]);be&&console.warn("Error insertando cliente juridico:",be)}}else{const ue={rtn:fe,nombre:se},{error:ge}=await ne.from("clientenatural").upsert(ue,{onConflict:"rtn"});ge&&console.warn("Error guardando clientenatural:",ge)}}catch(ue){console.warn("Error upsert cliente:",ue)}const V=ip({cliente:se||"Cliente",rtn:fe||""},k,{carrito:l,subtotal:ci(),isvTotal:M,imp18Total:B,impTouristTotal:G});if(k==="factura"&&oe)try{console.debug("Pre-print: marcando cotizacion como facturado, id=",oe);const{error:ue}=await ne.from("cotizaciones").update({estado:"aceptada"}).eq("id",oe);if(ue)console.warn("Error marcando cotizacion como facturado (pre-print):",ue);else{console.debug("Cotizacion marcada como facturado (pre-print):",oe);try{pe(null)}catch{}}}catch(ue){console.warn("Error marcacion pre-print:",ue)}if(k==="factura")try{let ue=null,ge=null;try{const be=localStorage.getItem("user"),ve=be?JSON.parse(be):null;ge=ve&&(ve.id||ve.user?.id||ve.sub||ve.user_id)?ve.id||ve.user?.id||ve.sub||ve.user_id:null;const Oe=ve&&(ve.username||ve.user?.username||ve.name||ve.user?.name)?ve.username||ve.user?.username||ve.name||ve.user?.name:null;if(console.debug("PV (clienteNormal): CAI lookup - raw localStorage.user:",be),console.debug("PV (clienteNormal): CAI lookup - parsed user object:",ve),console.debug("PV (clienteNormal): CAI lookup - extracted userId:",ge,"typeof",typeof ge),console.debug("PV (clienteNormal): CAI lookup - extracted userNameFromStorage:",Oe),ge){const ce=typeof ge=="string"&&/^\d+$/.test(ge)?Number(ge):ge;try{const{data:me,error:Se}=await ne.from("cai").select("id,cai,fecha_vencimiento,rango_de,rango_hasta").eq("usuario_id",ce).order("id",{ascending:!1}).limit(1);!Se&&Array.isArray(me)&&me.length>0&&(ue=me[0])}catch(me){console.debug("PV (clienteNormal): CAI lookup by usuario_id failed (likely column missing):",me)}}if(!ue&&Oe)try{const{data:ce,error:me}=await ne.from("cai").select("id,cai,fecha_vencimiento,rango_de,rango_hasta").eq("cajero",Oe).order("id",{ascending:!1}).limit(1);!me&&Array.isArray(ce)&&ce.length>0&&(ue=ce[0])}catch(ce){console.debug("PV (clienteNormal): CAI lookup by cajero failed:",ce)}}catch(be){console.debug("No se pudo cargar CAI desde frontend (cliente normal):",be)}await rs({clienteName:se||"Cliente",rtn:fe||null,paymentPayload:ql,caiData:ue,usuarioId:ge})}catch(ue){console.warn("Error insertando venta en flujo cliente normal:",ue)}const re=window.open("","_blank");if(re){re.document.open(),re.document.write(V),re.document.close();try{re.focus(),re.print()}catch(ue){console.warn("Error during print (cliente normal):",ue)}setTimeout(()=>{try{re.close()}catch{}},800)}await(async()=>{k==="factura"&&(J(),await ss()),k==="cotizacion"&&(ee({cliente:se||"Cliente",rtn:fe||null}),D(!0))})(),z(!1)},[ln,on]=S.useState(null),[Nn,di]=S.useState([]),[za,ir]=S.useState(!1),[ls,Da]=S.useState(null);S.useEffect(()=>{fetch("/data-base/inventario.json").then(async V=>{if(!V.ok)return console.warn("inventario.json no disponible, status",V.status),null;const re=V.headers.get("content-type")||"";if(!re.includes("application/json"))return console.warn("inventario.json no es JSON, content-type:",re),null;try{return await V.json()}catch(xe){return console.warn("Error parseando inventario.json:",xe),null}}).then(V=>{V&&Array.isArray(V.items)&&di(V.items),console.log("inventario cargado:",V&&V.items?V.items.length:0)}).catch(V=>{console.warn("Error cargando inventario:",V)})},[]),S.useEffect(()=>{let V=!0;return(async()=>{try{const{data:re,error:xe}=await ne.from("inventario").select("id, sku, nombre, categoria, imagen, modelo, descripcion, exento, aplica_impuesto_18, aplica_impuesto_turistico");if(xe)throw xe;const ue=Array.isArray(re)?re:[],ge=ue.map(ce=>String(ce.id));if(ge.length===0){V&&s([]);return}const be={};try{const{data:ce,error:me}=await ne.from("precios").select("producto_id, precio").order("id",{ascending:!1});if(me)throw me;if(console.debug("PV: precios total rows",Array.isArray(ce)?ce.length:0),Array.isArray(ce))for(const Se of ce){const Be=String(Se.producto_id);be[Be]||(be[Be]=Number(Se.precio||0))}}catch(ce){console.warn("Error cargando precios en PV:",ce)}let ve={};try{const{data:ce,error:me}=await ne.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",ge);if(me)throw me;const Se=Array.isArray(ce)?ce:[];ve={},ge.forEach(Be=>ve[Be]=0);for(const Be of Se){const Le=String(Be.producto_id),Ze=Number(Be.cantidad)||0,Xe=String(Be.tipo_de_movimiento||"").toUpperCase();Xe==="ENTRADA"?ve[Le]=(ve[Le]||0)+Ze:Xe==="SALIDA"&&(ve[Le]=(ve[Le]||0)-Ze)}}catch(ce){console.warn("Error cargando registro_de_inventario en PV:",ce),ve={},ge.forEach(me=>ve[me]=0)}console.debug("PV: priceMap sample",Object.keys(be).slice(0,5).map(ce=>[ce,be[ce]]));const Oe=ue.map(ce=>({id:String(ce.id),sku:ce.sku,nombre:ce.nombre,categoria:ce.categoria,imagen:ce.imagen,precio:be[String(ce.id)]!==void 0?be[String(ce.id)]:ce.precio!==void 0?Number(ce.precio):0,exento:ce.exento===!0||String(ce.exento)==="true"||Number(ce.exento)===1||!1,aplica_impuesto_18:ce.aplica_impuesto_18===!0||String(ce.aplica_impuesto_18)==="true"||Number(ce.aplica_impuesto_18)===1||!1,aplica_impuesto_turistico:ce.aplica_impuesto_turistico===!0||String(ce.aplica_impuesto_turistico)==="true"||Number(ce.aplica_impuesto_turistico)===1||!1,stock:Number((ve[String(ce.id)]||0).toFixed(2))}));V&&s(Oe)}catch(re){console.warn("Error cargando productos desde inventario:",re),V&&s([])}})(),()=>{V=!1}},[]),S.useEffect(()=>{const V=xe=>{try{const ue=xe||(()=>{const ve=localStorage.getItem("cotizacion_to_load");return ve?JSON.parse(ve):null})();if(!ue)return;try{pe(ue.header&&ue.header.id?String(ue.header.id):null)}catch{}const be=(Array.isArray(ue.detalles)?ue.detalles:[]).map(ve=>{const Oe=a.find(me=>String(me.id)===String(ve.producto_id));return{producto:Oe?{...Oe}:{id:String(ve.producto_id||"temp-"+Math.random().toString(36).slice(2,8)),sku:ve.sku??void 0,nombre:ve.descripcion||ve.nombre||"Artculo",precio:Number(ve.precio_unitario||ve.precio||0),categoria:void 0,exento:!1,aplica_impuesto_18:!1,aplica_impuesto_turistico:!1,stock:0,imagen:void 0},cantidad:Number(ve.cantidad||1)}});be.length>0&&u(be);try{localStorage.removeItem("cotizacion_to_load")}catch{}}catch{}};V();const re=xe=>{try{V(xe.detail)}catch{}};return window.addEventListener("cotizacion:load",re),()=>{window.removeEventListener("cotizacion:load",re)}},[a]);const[Rn,Vl]=S.useState(null),[os,cs]=S.useState(null),[us,rr]=S.useState(null),[Ba,sr]=S.useState(null),[ds,xn]=S.useState(!1),[bt,Bt]=S.useState({});S.useEffect(()=>{try{const V=localStorage.getItem("user");if(V){const re=JSON.parse(V);Vl(re.username||re.name||null),cs(re.role||null);let xe=null;try{xe=re&&(re.id||re.user?.id||re.sub||re.user_id)?re.id||re.user?.id||re.sub||re.user_id:null,rr(xe??null),console.debug("PV: localStorage.user parsed:",re),console.debug("PV: extracted userId for CAI/RPC usage:",xe)}catch(ue){console.debug("PV: error parsing localStorage.user for debug:",ue)}try{const ue=localStorage.getItem("caiInfo");if(ue){const ge=JSON.parse(ue);sr(ge),console.debug("PV: loaded caiInfo from localStorage:",ge),(async()=>{try{if(!(ge&&ge.rango_de!==void 0&&ge.rango_hasta!==void 0&&ge.fecha_vencimiento!==void 0&&ge.secuencia_actual!==void 0)){const ve=re&&(re.username||re.user?.username||re.name||re.user?.name)?re.username||re.user?.username||re.name||re.user?.name:null,Oe=xe&&typeof xe=="string"&&/^\d+$/.test(xe)?Number(xe):xe;let ce=null;try{if(Oe!=null){const{data:me,error:Se}=await ne.from("cai").select("id,cai,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("usuario_id",Oe).order("id",{ascending:!1}).limit(1);!Se&&Array.isArray(me)&&me.length>0&&(ce=me[0])}}catch(me){console.debug("PV: refetch CAI by usuario_id failed (column may be missing):",me)}if(!ce&&ve)try{const{data:me,error:Se}=await ne.from("cai").select("id,cai,rango_de,rango_hasta,fecha_vencimiento,secuencia_actual").eq("cajero",ve).order("id",{ascending:!1}).limit(1);!Se&&Array.isArray(me)&&me.length>0&&(ce=me[0])}catch(me){console.debug("PV: refetch CAI by cajero failed:",me)}if(ce){sr(ce);try{localStorage.setItem("caiInfo",JSON.stringify(ce))}catch{}console.debug("PV: refreshed caiInfo from Supabase:",ce)}}}catch(be){console.debug("PV: error trying to refresh caiInfo:",be)}})()}}catch(ue){console.debug("PV: error parsing localStorage.caiInfo:",ue)}}}catch{}},[]),S.useEffect(()=>{let V=!0;return(async()=>{try{const{data:re,error:xe}=await ne.from("impuesto").select("id, impuesto_venta");if(xe)throw xe;if(!re||!Array.isArray(re))return;const ue=Oe=>{const ce=re.find(Be=>Number(Be.id)===Oe);if(!ce)return null;const me=ce.impuesto_venta;if(me==null)return null;const Se=Number(me);return Number.isNaN(Se)?null:Se>1?Se/100:Se},ge=ue(1),be=ue(2),ve=ue(3);if(V){let Oe=ge,ce=be,me=ve;try{if((Oe===null||Oe===0)&&V){const Be=(await ne.from("impuesto").select("impuesto_venta").eq("id",1).maybeSingle())?.data?.impuesto_venta??null,Le=Be==null?null:Number(Be);Le!=null&&!Number.isNaN(Le)&&(Oe=Le>1?Le/100:Le)}if((ce===null||ce===0)&&V){const Be=(await ne.from("impuesto").select("impuesto_venta").eq("id",2).maybeSingle())?.data?.impuesto_venta??null,Le=Be==null?null:Number(Be);Le!=null&&!Number.isNaN(Le)&&(ce=Le>1?Le/100:Le)}if((me===null||me===0)&&V){const Be=(await ne.from("impuesto").select("impuesto_venta").eq("id",3).maybeSingle())?.data?.impuesto_venta??null,Le=Be==null?null:Number(Be);Le!=null&&!Number.isNaN(Le)&&(me=Le>1?Le/100:Le)}}catch(Se){console.warn("PV: fallback single-id impuesto fetch failed",Se)}(Oe===null||Oe===0)&&(Oe=.15),(ce===null||ce===0)&&(ce=.18),(me===null||me===0)&&(me=.04),v(Oe),j(ce),w(me),console.debug("PV: impuestos raw rows",re),console.debug("PV: resolved tax rates",{taxRate:Oe,tax18Rate:ce,taxTouristRate:me})}}catch(re){console.warn("Error cargando impuesto en PV:",re)}})(),()=>{V=!1}},[]);const ia=V=>{console.log("openUbicacion",V,"entradasCount",Nn.length);let re=null;try{re=a.find(ue=>String(ue.sku||"")===String(V)||String(ue.id)===String(V))||null}catch{re=null}if(re){const ue=Number(re.stock??0),ge={id:re.id,producto:re.nombre||"",sku:re.sku||"",imagen:re.imagen||null,descripcion:re.descripcion||"",ubicacion:re.ubicacion||null,cantidad:ue};Da(ge),ir(!0);return}const xe=Nn.find(ue=>ue.sku===V)||null;console.log("entrada encontrada",xe),Da(xe),ir(!0)};if(S.useEffect(()=>{let V=!0;return(async()=>{try{const re="inventario",xe={};await Promise.all((a||[]).map(async ue=>{const ge=ue.imagen;if(!ge){xe[String(ue.id)]=null;return}const be=String(ge);if(be.startsWith("http")){xe[String(ue.id)]=be;return}let ve=be;const Oe=String(be).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);Oe&&(ve=decodeURIComponent(Oe[2]));try{const ce=await ne.storage.from(re).getPublicUrl(ve),me=ce?.data?.publicUrl||ce?.data?.publicURL||null;if(me){xe[String(ue.id)]=me;return}}catch{}try{const me=(await ne.storage.from(re).createSignedUrl(ve,604800))?.data?.signedUrl??null;xe[String(ue.id)]=me}catch{xe[String(ue.id)]=null}})),V&&Bt(xe)}catch(re){console.warn("Error resolviendo imgenes en PV",re)}})(),()=>{V=!1}},[a]),ln){if(ln==="DevolucionCaja")return r.jsx(P0,{onBack:()=>on(null)});if(ln==="IngresoEfectivo")return r.jsx(G0,{onBack:()=>on(null)});if(ln==="CotizacionesGuardadas")return r.jsx(K0,{onBack:()=>on(null)});if(ln==="PedidosEnLinea")return r.jsx(Y0,{onBack:()=>on(null)});if(ln==="CorteCajaParcial")return r.jsx(J0,{onBack:()=>on(null)});if(ln==="CorteCajaTotal")return r.jsx(Q0,{onBack:()=>on(null)})}return r.jsxs("div",{style:{minHeight:"100vh",fontFamily:"system-ui, sans-serif",background:"#f8fafc"},children:[r.jsx(e_,{userName:Rn,userRole:os,userId:us,caiInfo:Ba,onLogout:o,onNavigate:V=>on(V),onOpenDatosFactura:()=>xn(!0)}),r.jsxs("div",{style:{padding:16,maxWidth:1600,margin:"0 auto"},children:[r.jsxs("div",{style:{background:"white",padding:14,borderRadius:10,boxShadow:"0 1px 4px rgba(0,0,0,0.05)",marginBottom:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[r.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",value:d,onChange:V=>f(V.target.value),onKeyDown:V=>{if(V.key==="Enter"){const re=String(d||"").trim().toLowerCase();if(!re)return;const ue=O.find(ge=>String(ge.sku||"").toLowerCase()===re)||O[0];if(ue){const ge=Number(ue.stock??0),be=Number(ue.precio??0);ge>=1&&be>0?U(ue):console.debug("No se puede agregar por stock/precio",{id:ue.id,stockNum:ge,precioNum:be})}}},style:{flex:1,minWidth:220,padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1"}}),r.jsx("select",{value:g,onChange:V=>p(V.target.value),style:{padding:"10px 12px",borderRadius:8,border:"1px solid #cbd5e1",minWidth:140},children:T.map(V=>r.jsx("option",{value:V,children:V},V))})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 420px",gap:16},children:[r.jsx("div",{style:{background:"white",borderRadius:10,overflow:"hidden",boxShadow:"0 1px 4px rgba(0,0,0,0.05)",minHeight:"60vh"},children:r.jsx(Z0,{productos:O,imageUrls:bt,agregarAlCarrito:U,openUbicacion:ia,thStyle:c_,tdStyle:u_,skuStyle:d_})}),r.jsx(W0,{carrito:l,actualizarCantidad:H,eliminarDelCarrito:he,vaciarCarrito:J,subtotal:C,perItemTaxes:q,taxRate:m,tax18Rate:x,taxTouristRate:b,total:E,openSelector:is,btnStyle:h_})]})]}),r.jsx(a_,{open:za,selectedEntrada:ls,onClose:()=>{ir(!1),Da(null)},imageUrls:bt}),r.jsx(F0,{open:ut,totalDue:E,onClose:()=>An(!1),onConfirm:async V=>{if(oi(V),Ot(!0),as)try{ka(!1),await Hl("Consumidor Final","C/F",V)}catch(re){console.warn("Error facturando despus del pago:",re)}An(!1)}}),r.jsx(i_,{open:_e,onClose:()=>D(!1),onCancel:()=>{D(!1),ee(null)},onSave:async()=>{D(!1);try{const V=await Il(L||{});V&&pe(String(V))}catch(V){console.warn("Error guardando cotizacion desde confirm modal",V)}ee(null)}}),r.jsx(r_,{open:Z,onClose:()=>F(!1),doFacturaClienteFinal:Lt,doFacturaClienteNormal:On,doFacturaClienteJuridico:It,carritoLength:l.length,subtotal:ci(),taxRate:m,taxableSubtotal:Ua()}),r.jsx(s_,{open:A,onClose:()=>z(!1),clienteTipo:Ve,clienteRTN:fe,clienteNombre:se,clienteTelefono:De,clienteCorreo:ht,clienteExonerado:Et,clienteSearchOpen:K,setClienteSearchOpen:V=>Q(V),onRTNChange:V=>Ll(V),onNombreChange:V=>ie(V),onTelefonoChange:V=>Qe(V),onCorreoChange:V=>Dt(V),onExoneradoChange:V=>$t(V),onCreateCliente:()=>lt(!0),onCancel:()=>z(!1),onOpenCreateCliente:()=>lt(!0),onOpenPayment:()=>An(!0),paymentDone:Ml,submitClienteNormal:ui}),r.jsx(l_,{open:Ln,onClose:()=>lt(!1),clienteRTN:fe,clienteNombre:se,clienteTelefono:De,clienteCorreo:ht,clienteExonerado:Et,onChangeRTN:V=>de(V),onChangeNombre:V=>ie(V),onChangeTelefono:V=>Qe(V),onChangeCorreo:V=>Dt(V),onChangeExonerado:V=>$t(V),onCreate:async()=>{try{if(!se||!fe)return;const{data:V,error:re}=await ne.from("clientes").select("id").eq("rtn",fe).maybeSingle();if(re&&console.warn("Error buscando cliente al crear:",re),V&&V.id){const{error:xe}=await ne.from("clientes").update({nombre:se,telefono:De||null,correo_electronica:ht||null,tipo_cliente:"juridico",exonerado:Et}).eq("id",V.id);xe&&console.warn("Error actualizando cliente al crear:",xe)}else{const{error:xe}=await ne.from("clientes").insert([{nombre:se,rtn:fe,telefono:De||null,correo_electronica:ht||null,tipo_cliente:"juridico",exonerado:Et}]);xe&&console.warn("Error insertando cliente al crear:",xe)}}catch(V){console.warn("Error creando cliente juridico:",V)}lt(!1)}}),r.jsx(n_,{open:ds,onClose:()=>xn(!1),caiInfo:Ba})]})}const c_={padding:"12px 10px",textAlign:"left",fontSize:"0.85rem",fontWeight:600,color:"#475569"},u_={padding:"10px",fontSize:"0.9rem",verticalAlign:"middle"},d_={fontSize:"0.75rem",background:"#e2e8f0",padding:"2px 6px",borderRadius:4,fontFamily:"monospace"},h_={width:26,height:26,borderRadius:6,border:"none",background:"#e2e8f0",fontWeight:"bold",cursor:"pointer",fontSize:"0.9rem"},rp=[{id:"dashboard",label:"Dashboard"},{id:"datos",label:"Datos de mi empresa"},{id:"usuarios",label:"Usuarios / Cajeros",children:[{id:"usuarios_internal",label:"Usuarios Cajeros"},{id:"usuarios_web",label:"Usuarios web (usuarios_web)"}]},{id:"factura",label:"Factura y CAI",children:[{id:"cai",label:"Gestio de CAI por cajas"},{id:"facturas",label:"Facturas (ventas)"},{id:"historial_facturas",label:"Historial de facturas"},{id:"impuestos",label:"Impuestos"}]},{id:"inventario",label:"Inventario",children:[{id:"inventario_productos",label:"Productos (Inventario)"},{id:"precios_productos",label:"Precios de productos"},{id:"precios_historico",label:"Histrico de precios"},{id:"stock",label:"Stock"},{id:"inventario_salidas",label:"Movimiento de Inventario"},{id:"inventario_categorias",label:"Categoras / Marcas (opcional)"}]},{id:"compras",label:"Compras y Proveedores",children:[{id:"compras_main",label:"Compras (compras)"},{id:"compras_detalle",label:"Detalle de Compras (Lneas)"},{id:"proveedores",label:"Proveedores (proveedores)"},{id:"devoluciones_proveedores",label:"Devolucin a Proveedores"}]},{id:"cierres",label:"Cierres de caja",children:[{id:"caja_sesiones",label:"Sesiones de caja (caja_sesiones)"},{id:"caja_movimientos",label:"Movimientos de caja (caja_movimientos)"}]},{id:"pedidos",label:"Pedidos web / Ecommerce",children:[{id:"pedidos_web",label:"Pedidos web (pedidos_web)"},{id:"pedidos_detalle",label:"Detalle de pedidos (pedidos_web_detalle)"},{id:"pagos_web",label:"Pagos web (pagos_web)"}]},{id:"cotizaciones",label:"Cotizaciones",children:[{id:"cotizaciones",label:"Cotizaciones (cotizaciones)"},{id:"cotizaciones_detalle",label:"Detalle de cotizaciones (cotizaciones_detalle)"}]},{id:"reportes",label:"Reportes",children:[{id:"rep_ventas",label:"Ventas (ventas + ventas_detalle)"},{id:"rep_devoluciones",label:"Devoluciones (devoluciones_ventas)"},{id:"rep_ingresos_egresos",label:"Ingresos / Egresos (caja_movimientos)"},{id:"rep_compras",label:"Compras"},{id:"rep_inventario",label:"Inventario"},{id:"rep_export",label:"Exportar reportes generales (PDF / Excel)"}]},{id:"contaduria",label:"Contadura / Libro Diario",children:[{id:"cuentas_contables",label:"Cuentas contables (cuentas_contables)"},{id:"libro_diario",label:"Libro diario (libro_diario)"},{id:"auditoria",label:"Auditora (auditoria)"}]},{id:"salir",label:"Salir"}];function f_({title:o,children:a}){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:o}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:a})]})}function g_(){const[o,a]=S.useState(null);return S.useEffect(()=>{fetch("/data-base/dashboard-data.json").then(s=>s.json()).then(s=>a(s)).catch(()=>a(null))},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Dashboard"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:o?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Ventas (ltimos das)"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.sales,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Flujo de caja"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.cashflow,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Inventario por categora"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.inventory,null,2)})]}),r.jsxs("div",{style:{padding:12,borderRadius:8,background:"#fff"},children:[r.jsx("h3",{children:"Promedios"}),r.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(o.averages,null,2)})]})]}):r.jsx("div",{children:"Cargando datos del dashboard..."})})]})}const p_="modulepreload",m_=function(o){return"/"+o},sp={},_n=function(a,s,l){let u=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(j=>({status:"fulfilled",value:j}),j=>({status:"rejected",reason:j}))))};var f=m;document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),p=g?.nonce||g?.getAttribute("nonce");u=m(s.map(v=>{if(v=m_(v),v in sp)return;sp[v]=!0;const x=v.endsWith(".css"),j=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${j}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":p_,x||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),x)return new Promise((w,T)=>{b.addEventListener("load",w),b.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${v}`)))})}))}function d(g){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=g,window.dispatchEvent(p),!p.defaultPrevented)throw g}return u.then(g=>{for(const p of g||[])p.status==="rejected"&&d(p.reason);return a().catch(d)})};function am({open:o,title:a="Confirmado",message:s="",onClose:l,onCancel:u,confirmLabel:d="Aceptar",cancelLabel:f="Cancelar"}){return o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:r.jsxs("div",{style:{width:420,background:"#fff",borderRadius:8,padding:18,boxShadow:"0 4px 20px rgba(2,6,23,0.2)"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("div",{style:{marginTop:8,color:"#334155"},children:s}),r.jsxs("div",{style:{marginTop:16,display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{className:"btn-opaque",onClick:u??l,style:{width:"auto"},children:f}),r.jsx("button",{className:"btn-primary",onClick:l,style:{width:"auto"},children:d})]})]})}):null}function y_(){const[o,a]=S.useState(null),[s,l]=S.useState(!1),[u,d]=S.useState(!1),[f,g]=S.useState({}),[p,m]=S.useState(null),[v,x]=S.useState(!1),[j,b]=S.useState(null),[w,T]=S.useState(!1),[O,C]=S.useState(null),[M,B]=S.useState(null),[G,E]=S.useState(!1),[q,U]=S.useState(""),[H,he]=S.useState(""),[J,Z]=S.useState(null),[F,k]=S.useState(null);S.useEffect(()=>{let z=!0;return(async()=>{l(!0);try{const K=(await _n(async()=>{const{default:ie}=await Promise.resolve().then(()=>bn);return{default:ie}},void 0)).default,{data:Q,error:se}=await K.from("empresa").select("*").limit(1).single();if(!z)return;if(se)throw se;if(Q){a(Q),g(Q);try{localStorage.setItem("companyData",JSON.stringify(Q))}catch{}l(!1);return}}catch(K){console.debug("No se pudo cargar empresa desde Supabase, fallback a JSON/localStorage",K)}try{const K=localStorage.getItem("companyData");if(K){a(JSON.parse(K)),g(JSON.parse(K)),l(!1);return}}catch{}try{const K=await fetch("/data-base/company.json");if(!K.ok)throw new Error("no json");const Q=await K.json();if(!z)return;a(Q),g(Q)}catch{z&&a(null)}finally{z&&l(!1)}})(),()=>{z=!1}},[]),S.useEffect(()=>{o&&g(o)},[o]),S.useEffect(()=>{try{const z=localStorage.getItem("pendingCompanySave");if(z){const K=JSON.parse(z);x(!0),b(K.payload??null),T(!!K.needsLogo)}}catch{}},[]),S.useEffect(()=>{let z=!0;return(async()=>{try{if(!o||!o.logo){z&&Z(null);return}const K=String(o.logo);if(K.startsWith("http")){z&&Z(K);return}const Q=(await _n(async()=>{const{default:Ue}=await Promise.resolve().then(()=>bn);return{default:Ue}},void 0)).default,se="logo",fe=(await Q.storage.from(se).getPublicUrl(K))?.data?.publicUrl??null;if(fe){z&&Z(fe);return}const ye=(await Q.storage.from(se).createSignedUrl(K,3600))?.data?.signedUrl??null;if(ye){z&&Z(ye);return}z&&Z(null)}catch(K){console.warn("Error resolving company logo URL",K),z&&Z(null)}})(),()=>{z=!1}},[o?.logo]),S.useEffect(()=>{let z=!0;return(async()=>{try{if(p){z&&k(p);return}const K=f?.logo;if(!K){z&&k(null);return}const Q=String(K);if(Q.startsWith("http")){z&&k(Q);return}const se=(await _n(async()=>{const{default:Ve}=await Promise.resolve().then(()=>bn);return{default:Ve}},void 0)).default,ie="logo",de=(await se.storage.from(ie).getPublicUrl(Q))?.data?.publicUrl??null;if(de){z&&k(de);return}const Ue=(await se.storage.from(ie).createSignedUrl(Q,3600))?.data?.signedUrl??null;if(Ue){z&&k(Ue);return}z&&k(null)}catch(K){console.warn("Error resolving edit logo URL",K),z&&k(null)}})(),()=>{z=!1}},[f?.logo,p]);function W(){d(!0),g(o||{})}function _e(){d(!1);try{p&&(URL.revokeObjectURL(p),m(null))}catch{}g(o||{})}function D(z){const{name:K,value:Q}=z.target;g(se=>({...se,[K]:Q}))}function L(z){const K=z.target.files?.[0]??null;if(g(Q=>({...Q,logoFile:K})),K)try{const Q=URL.createObjectURL(K);m(Q)}catch{m(null)}else m(null)}function ee(z=!1){const K="logo",Q="https://sqwqlvsjtimallidxrsz.supabase.co";if(z){if(p)return p;const fe=f?.logo;if(!fe)return"/logo192.png";if(String(fe).startsWith("http"))return String(fe);let de=String(fe);return de.startsWith(`${K}/`)&&(de=de.slice(K.length+1)),`${Q}/storage/v1/object/public/${K}/${encodeURIComponent(de)}`}if(!o)return"/logo192.png";const se=o.logo;if(!se)return"/logo192.png";if(String(se).startsWith("http"))return String(se);let ie=String(se);return ie.startsWith(`${K}/`)&&(ie=ie.slice(K.length+1)),`${Q}/storage/v1/object/public/${K}/${encodeURIComponent(ie)}`}async function oe(){try{const z=(await _n(async()=>{const{default:de}=await Promise.resolve().then(()=>bn);return{default:de}},void 0)).default,K={...f||{}};let Q=null;const se=de=>{if(!de)return null;if(!de.startsWith("http"))return de;const ye=de.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return ye?decodeURIComponent(ye[2]):null},ie=o?.logo??null;try{const de=f&&f.logoFile instanceof File?f.logoFile:null,ye="logo";if(de){const Ve=`logo/${K.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now()))}/${Date.now()}_${de.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,ze=await z.storage.from(ye).upload(Ve,de,{upsert:!0});if(ze.error)throw ze.error;const De=ze.data?.path??Ve;Q=De,K.logo=De}}catch(de){console.warn("Logo upload error",de)}try{K.logoFile&&delete K.logoFile}catch{}let fe=null;try{if(o&&o.id){const{data:de,error:ye}=await z.from("empresa").update(K).eq("id",o.id).select("*");if(ye)throw ye;fe=Array.isArray(de)?de[0]??null:de}else{const{data:de,error:ye}=await z.from("empresa").insert(K).select("*");if(ye)throw ye;fe=Array.isArray(de)?de[0]??null:de}try{if(Q){const de=se(ie);if(de&&de!==Q){const Ue=await z.storage.from("logo").remove([de]);Ue.error&&console.warn("Failed to remove old company logo after DB update",Ue.error)}}}catch(de){console.warn("Error removing old logo after DB success",de)}}catch(de){try{if(Q){const Ue=await z.storage.from("logo").remove([Q]);Ue.error&&console.warn("Failed to remove uploaded logo after DB error",Ue.error)}}catch(ye){console.warn("Error cleaning uploaded logo after DB failure",ye)}throw de}a(fe),g(fe);try{console.debug("Empresa guardada, logo field:",fe?.logo)}catch{}try{B(fe?.logo??null)}catch{}try{U("Datos guardados"),he("Los datos de la empresa se guardaron correctamente."),E(!0)}catch{}try{p&&(URL.revokeObjectURL(p),m(null))}catch{}try{localStorage.setItem("companyData",JSON.stringify(fe))}catch{}d(!1)}catch(z){console.error("Error guardando empresa en Supabase",z);try{C(z?.message||String(z))}catch{}try{const K={...f||{}};K.logoFile&&delete K.logoFile;const Q=!!(f&&f.logoFile instanceof File);localStorage.setItem("pendingCompanySave",JSON.stringify({payload:K,needsLogo:Q,ts:Date.now()})),x(!0),b(K),T(Q),a(f);try{localStorage.setItem("companyData",JSON.stringify(f))}catch{}d(!1),U("Guardado localmente"),he("Los datos se guardaron localmente porque no se pudo alcanzar Supabase. Puedes reintentar cuando tengas conexin."),E(!0)}catch(K){console.error("Error saving locally",K)}}}async function pe(){const z=j;if(!z){U("Sin pendientes"),he("No hay datos pendientes para enviar"),E(!0);return}try{const K=(await _n(async()=>{const{default:se}=await Promise.resolve().then(()=>bn);return{default:se}},void 0)).default;let Q=null;if(z.id){const{data:se,error:ie}=await K.from("empresa").update(z).eq("id",z.id).select("*");if(ie)throw ie;Q=Array.isArray(se)?se[0]??null:se}else{const{data:se,error:ie}=await K.from("empresa").insert(z).select("*");if(ie)throw ie;Q=Array.isArray(se)?se[0]??null:se}localStorage.removeItem("pendingCompanySave"),x(!1),b(null),T(!1),a(Q),g(Q),U("Sincronizado"),he("Los datos pendientes se sincronizaron con Supabase correctamente."),E(!0)}catch(K){console.error("Error reenviando datos pendientes",K),U("Error al reenviar"),he("No se pudo reenviar los datos a Supabase: "+(K?.message||String(K))),E(!0)}}function A(){try{localStorage.removeItem("pendingCompanySave"),x(!1),b(null),T(!1),U("Pendiente descartado"),he("El guardado pendiente fue descartado."),E(!0)}catch{}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Datos de mi empresa"}),s?r.jsx("div",{children:"Cargando datos de la empresa..."}):o?r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-start"},children:[r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,minWidth:420,boxShadow:"0 1px 3px rgba(2,6,23,0.06)"},children:[v?r.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fbbf24",padding:8,borderRadius:6,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("strong",{children:"Guardado localmente:"})," Los datos no se sincronizaron con Supabase.",O?r.jsxs("div",{style:{fontSize:12,color:"#b91c1c"},children:["Error: ",String(O)]}):null,w?r.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"Nota: el archivo de logo no se incluy y deber subirse de nuevo."}):null]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn-primary",onClick:pe,children:"Reintentar guardar en Supabase"}),r.jsx("button",{className:"btn-opaque",onClick:A,children:"Descartar pendiente"})]})]})}):null,M?r.jsxs("div",{style:{marginBottom:8,fontSize:13},children:[r.jsx("strong",{children:"Logo guardado:"}),r.jsxs("div",{style:{marginTop:6},children:[r.jsx("a",{href:ee(!1),target:"_blank",rel:"noopener noreferrer",children:"Abrir logo"}),r.jsx("div",{style:{color:"#374151",fontSize:12},children:String(M)})]})]}):null,r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsx("div",{style:{width:120,height:60,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:6,overflow:"hidden"},children:r.jsx("img",{src:u?F??ee(!0):J??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h3",{style:{marginTop:0},children:o.nombre})]}),r.jsxs("div",{style:{marginTop:8,color:"#334155"},children:[r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"RTN:"})," ",u?r.jsx("input",{name:"rtn",value:f.rtn||"",onChange:D,className:"input"}):o.rtn]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Telfono:"})," ",u?r.jsx("input",{name:"telefono",value:f.telefono||"",onChange:D,className:"input"}):o.telefono]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Correo:"})," ",u?r.jsx("input",{name:"email",value:f.email||"",onChange:D,className:"input"}):o.email]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Direccin:"})," ",u?r.jsx("textarea",{name:"direccion",value:f.direccion||"",onChange:D,className:"input",style:{minHeight:64}}):o.direccion]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("strong",{children:"Logo (archivo o URL):"}),u?r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:6},children:[r.jsx("input",{type:"file",accept:"image/*",onChange:L}),r.jsx("input",{name:"logo",value:f.logo||"",onChange:D,className:"input",placeholder:"https://.../logo.png",style:{flex:1}})]}):r.jsx("span",{style:{marginLeft:6},children:o.logo?"URL configurada":"No hay logo"}),u&&p?r.jsxs("div",{style:{marginTop:8},children:[r.jsx("small",{children:"Preview:"}),r.jsx("div",{style:{width:160,height:60,marginTop:6,background:"#fff",border:"1px solid #e6e6e6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("img",{src:p,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})})]}):null]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",gap:8},children:u?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:oe,className:"btn-primary",children:"Guardar"}),r.jsx("button",{type:"button",onClick:_e,className:"btn-opaque",children:"Cancelar"})]}):r.jsx(r.Fragment,{children:r.jsx("button",{type:"button",onClick:W,className:"btn-primary",children:"Actualizar datos"})})})]}),r.jsx("div",{style:{flex:1,minWidth:320},children:r.jsxs("div",{style:{background:"#fff",padding:16,borderRadius:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{style:{width:220,height:90,display:"flex",alignItems:"center",justifyContent:"center",background:"#f1f5f9",borderRadius:8,overflow:"hidden",marginBottom:12},children:r.jsx("img",{src:u?F??ee(!0):J??ee(!1),alt:"logo",style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),r.jsx("h4",{style:{margin:0,marginBottom:8},children:"Detalles rpidos"}),r.jsxs("p",{style:{margin:0},children:["RTN: ",r.jsx("strong",{children:o.rtn})]}),r.jsxs("p",{style:{margin:0},children:["Telfono: ",r.jsx("strong",{children:o.telefono})]}),r.jsxs("p",{style:{marginTop:8},children:["Correo: ",r.jsx("strong",{children:o.email})]}),r.jsxs("p",{style:{marginTop:8},children:["Direccin: ",r.jsx("strong",{children:o.direccion})]})]})})]}):r.jsx("div",{children:"No se encontraron datos de la empresa."}),r.jsx(am,{open:G,title:q,message:H,onClose:()=>E(!1)})]})}function v_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios web (usuarios_web)"}),r.jsx("div",{style:{marginTop:8,color:"#475569"},children:"Esta vista mostrar los usuarios registrados desde la web. (Placeholder)"})]})}function b_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(""),[p,m]=S.useState(""),[v,x]=S.useState(""),[j,b]=S.useState(""),[w,T]=S.useState(null),[O,C]=S.useState(""),[M,B]=S.useState(""),[G,E]=S.useState("");async function q(){l(!0),d(null);try{const{data:k,error:W}=await ne.from("users").select("id, username, role, nombre_usuario").limit(1e3);if(W)throw W;a(Array.isArray(k)?k:[])}catch(k){d(k?.message||String(k)),a([])}finally{l(!1)}}async function U(){if(!p)return d("Ingrese un nombre de usuario para crear");if(!v)return d("Ingrese una contrasea para crear");l(!0),d(null);try{const k={username:p,password:v,role:"cajero"};j&&(k.nombre_usuario=j);const{error:W}=await ne.from("users").insert(k);if(W)throw W;m(""),x(""),b(""),await q()}catch(k){d(k?.message||String(k))}finally{l(!1)}}function H(k){T(k.id),C(k.username||""),E(k.nombre_usuario||""),B(""),d(null)}function he(){T(null),C(""),B(""),E(""),d(null)}async function J(){if(w!=null){if(!O)return d("El nombre de usuario no puede estar vaco");l(!0),d(null);try{const k={username:O};M&&(k.password=M),k.nombre_usuario=G||null;const{error:W}=await ne.from("users").update(k).eq("id",w);if(W)throw W;he(),await q()}catch(k){d(k?.message||String(k))}finally{l(!1)}}}async function Z(k,W){if(W!=="cajero")return d('Solo se pueden eliminar usuarios con role "cajero"');if(confirm("Eliminar este usuario? Esta accin no se puede deshacer.")){l(!0),d(null);try{const{error:_e}=await ne.from("users").delete().eq("id",k);if(_e)throw _e;await q()}catch(_e){d(_e?.message||String(_e))}finally{l(!1)}}}S.useEffect(()=>{let k=!0;return(async()=>k&&await q())(),()=>{k=!1}},[]);const F=o.filter(k=>{if(!f)return!0;const W=f.toLowerCase();return(k.username||"").toLowerCase().includes(W)||(String(k.id)||"").includes(W)||(k.role||"").toLowerCase().includes(W)||(k.nombre_usuario||"").toLowerCase().includes(W)});return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Usuarios Cajeros"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},children:[r.jsx("input",{placeholder:"Buscar usuario o rol...",className:"input",value:f,onChange:k=>g(k.target.value),style:{minWidth:220}}),r.jsx("button",{onClick:()=>q(),className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${F.length} usuarios`}),r.jsx("div",{style:{width:"100%",height:8}}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{placeholder:"Nuevo usuario",className:"input",value:p,onChange:k=>m(k.target.value)}),r.jsx("input",{placeholder:"Nombre",className:"input",value:j,onChange:k=>b(k.target.value)}),r.jsx("input",{placeholder:"Contrasea",className:"input",type:"password",value:v,onChange:k=>x(k.target.value)}),r.jsx("button",{onClick:()=>U(),className:"btn-primary",children:"Crear (role: cajero)"})]})]}),u?r.jsx("div",{style:{color:"red",marginBottom:12},children:u}):r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Rol"})]})}),r.jsx("tbody",{children:F.map(k=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:k.id}),r.jsx("td",{style:{minWidth:180},children:w===k.id?r.jsx("input",{className:"input",value:O,onChange:W=>C(W.target.value)}):k.username||"-"}),r.jsx("td",{style:{minWidth:180},children:w===k.id?r.jsx("input",{className:"input",value:G,onChange:W=>E(W.target.value)}):k.nombre_usuario||"-"}),r.jsx("td",{style:{width:220},children:w===k.id?r.jsx("input",{className:"input",placeholder:"Nueva contrasea (opcional)",type:"password",value:M,onChange:W=>B(W.target.value)}):k.role||"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:w===k.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>J(),className:"btn-primary",style:{marginRight:6},children:"Guardar"}),r.jsx("button",{onClick:()=>he(),className:"btn-opaque",children:"Cancelar"})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>H(k),className:"btn-opaque",style:{marginRight:6},children:"Editar"}),k.role==="cajero"?r.jsx("button",{onClick:()=>Z(k.id,k.role),className:"btn-danger",children:"Eliminar"}):r.jsx("button",{className:"btn-opaque",disabled:!0,title:"No se puede eliminar usuarios admin",children:"Eliminar"})]})})]},k.id))})]}),F.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron usuarios."})]})]})}function __({open:o,onClose:a,row:s,cajeros:l,availableCajeros:u,availableCajas:d,onSave:f}){const[g,p]=S.useState(null),[m,v]=S.useState(null),[x,j]=S.useState(!1),[b,w]=S.useState(null),[T,O]=S.useState(""),[C,M]=S.useState(""),[B,G]=S.useState(""),[E,q]=S.useState(""),[U,H]=S.useState(!1),[he,J]=S.useState(null);if(S.useEffect(()=>{if(!o||!s)return;w(s.caja??null),O(s.cai??""),M(s.rango_de??""),G(s.rango_hasta??""),q(s.fecha_vencimiento??"");const F=s.cajero??null;if(F){const k=l.find(W=>W.username===F||W.nombre_usuario===F);k?(p(k.id),v(null),j(!1)):(p(null),v(F),j(!0))}else p(null),v(null),j(!1);J(null)},[o,s,l]),!o||!s)return null;async function Z(){if(!s){J("Registro invlido");return}if(b!=null&&(b<1||b>5)){J("La caja debe estar entre 1 y 5");return}H(!0),J(null);try{const F={cai:T??null,rango_de:C??null,rango_hasta:B??null,fecha_vencimiento:E??null,caja:b??null};if(g!=null){const k=l.find(W=>W.id===g);F.cajero=k?k.username:null,F.usuario_id=k?k.id:null}else F.cajero=m??null,F.usuario_id=null;await f(s.id,F),a()}catch(F){J(F?.message||String(F))}finally{H(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar CAI  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:T,onChange:F=>O(F.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:C,onChange:F=>M(F.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:B,onChange:F=>G(F.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:E,onChange:F=>q(F.target.value)}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:g!=null?String(g):x?"__custom__":"",onChange:F=>{const k=F.target.value;k===""?(p(null),v(null),j(!1)):k==="__custom__"?(p(null),j(!0)):/^\d+$/.test(k)&&(p(Number(k)),v(null),j(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??l).map(F=>r.jsxs("option",{value:String(F.id),children:[F.username,F.nombre_usuario?`  ${F.nombre_usuario}`:""]},F.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),x&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:m??"",onChange:F=>{v(F.target.value),p(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:b??"",onChange:F=>w(F.target.value===""?null:Number(F.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(d??[1,2,3,4,5]).map(F=>r.jsx("option",{value:F,children:F},F))]})]})]})]})]}),he&&r.jsx("div",{style:{color:"red",marginTop:12},children:he}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:U,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:Z,disabled:U,style:{width:"auto",padding:"8px 14px"},children:U?"Guardando...":"Guardar"})]})]})})}function x_({open:o,onClose:a,cajeros:s,availableCajeros:l,availableCajas:u,onCreate:d}){const[f,g]=S.useState(null),[p,m]=S.useState(null),[v,x]=S.useState(!1),[j,b]=S.useState(null),[w,T]=S.useState(""),[O,C]=S.useState(""),[M,B]=S.useState(""),[G,E]=S.useState(""),[q,U]=S.useState(!1),[H,he]=S.useState(null);if(!o)return null;async function J(){const Z=[];if(w||Z.push("CAI"),O||Z.push("Rango Desde"),M||Z.push("Rango Hasta"),G||Z.push("Fecha de Vencimiento"),j==null&&Z.push("Caja"),f==null&&!p&&Z.push("Cajero"),Z.length>0){he(`Campos obligatorios faltantes: ${Z.join(", ")}`);return}if(j!=null&&(j<1||j>5)){he("La caja debe estar entre 1 y 5");return}U(!0),he(null);try{const F={cai:w??null,rango_de:O??null,rango_hasta:M??null,fecha_vencimiento:G??null,caja:j??null};if(f!=null){const k=s.find(W=>W.id===f);F.cajero=k?k.username:null,F.usuario_id=k?k.id:null}else F.cajero=p??null,F.usuario_id=null;await d(F),a()}catch(F){he(F?.message||String(F))}finally{U(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar CAI"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"CAI"}),r.jsx("input",{className:"input",value:w,onChange:Z=>T(Z.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Desde"}),r.jsx("input",{className:"input",value:O,onChange:Z=>C(Z.target.value)}),r.jsx("label",{style:{display:"block",marginTop:8,marginBottom:6},children:"Rango Hasta"}),r.jsx("input",{className:"input",value:M,onChange:Z=>B(Z.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Fecha de Vencimiento"}),r.jsx("input",{className:"input",type:"date",value:G,onChange:Z=>E(Z.target.value)}),r.jsx("label",{style:{display:"block",marginTop:12,marginBottom:6},children:"Cajero"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:200},value:f!=null?String(f):v?"__custom__":"",onChange:Z=>{const F=Z.target.value;F===""?(g(null),m(null),x(!1)):F==="__custom__"?(g(null),x(!0)):/^\d+$/.test(F)&&(g(Number(F)),m(null),x(!1))},children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(l??s).map(Z=>r.jsxs("option",{value:String(Z.id),children:[Z.username,Z.nombre_usuario?`  ${Z.nombre_usuario}`:""]},Z.id)),r.jsx("option",{value:"__custom__",children:"-- personalizado --"})]}),v&&r.jsx("input",{className:"input",placeholder:"Nombre de cajero",value:p??"",onChange:Z=>{m(Z.target.value),g(null)},style:{minHeight:36}}),r.jsxs("div",{style:{marginLeft:12},children:[r.jsx("label",{style:{display:"block",marginBottom:6},children:"Caja"}),r.jsxs("select",{className:"input",style:{minHeight:36,minWidth:120},value:j??"",onChange:Z=>b(Z.target.value===""?null:Number(Z.target.value)),children:[r.jsx("option",{value:"",children:"-- sin asignar --"}),(u??[1,2,3,4,5]).map(Z=>r.jsx("option",{value:Z,children:Z},Z))]})]})]})]})]}),H&&r.jsx("div",{style:{color:"red",marginTop:12},children:H}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:q,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:J,disabled:q,style:{width:"auto",padding:"8px 14px"},children:q?"Creando...":"Crear"})]})]})})}function j_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState([]),[p,m]=S.useState(null),[v,x]=S.useState(!1),[j,b]=S.useState(!1);async function w(){l(!0),d(null);try{const{data:E,error:q}=await ne.from("cai").select("id, cai, rango_de, rango_hasta, fecha_vencimiento, caja, cajero, usuario_id").order("id",{ascending:!0});if(q)throw q;a(Array.isArray(E)?E:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}async function T(){try{const{data:E}=await ne.from("users").select("id, username, nombre_usuario").eq("role","cajero").order("username",{ascending:!0});g(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),T()},[]);const O=new Set(o.filter(E=>E.cajero).map(E=>String(E.cajero))),C=new Set(o.filter(E=>E.caja!=null).map(E=>Number(E.caja)));function M(E){m(E),x(!0),d(null)}function B(){x(!1),m(null)}async function G(E,q){l(!0),d(null);try{const{error:U}=await ne.from("cai").update(q).eq("id",E);if(U)throw U;await w()}catch(U){throw d(U?.message||String(U)),U}finally{l(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Gestio de -CAI- por cajas"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>w(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>b(!0),style:{marginLeft:6},children:"Agregar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} registros`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"CAI"}),r.jsx("th",{children:"Rango Desde"}),r.jsx("th",{children:"Rango Hasta"}),r.jsx("th",{children:"Vencimiento"}),r.jsx("th",{children:"Cajero"}),r.jsx("th",{children:"Usuario ID"}),r.jsx("th",{children:"Caja"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:200},children:E.cai}),r.jsx("td",{children:E.rango_de}),r.jsx("td",{children:E.rango_hasta}),r.jsx("td",{children:E.fecha_vencimiento}),r.jsx("td",{style:{minWidth:180},children:E.cajero||"-"}),r.jsx("td",{style:{minWidth:160},children:E.usuario_id??"-"}),r.jsx("td",{style:{width:120},children:E.caja??"-"}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx(r.Fragment,{children:r.jsx("button",{onClick:()=>M(E),className:"btn-opaque",style:{marginRight:6},children:"Editar"})})})]},E.id))})]}),o.length===0&&!s&&r.jsx("div",{style:{padding:12},children:"No se encontraron registros."})]}),r.jsx(__,{open:v,onClose:B,row:p,cajeros:f,availableCajeros:p?f.filter(E=>!O.has(E.username)||E.username===p.cajero):f.filter(E=>!O.has(E.username)),availableCajas:p?[1,2,3,4,5].filter(E=>!C.has(E)||E===p.caja):[1,2,3,4,5].filter(E=>!C.has(E)),onSave:G}),r.jsx(x_,{open:j,onClose:()=>b(!1),cajeros:f,availableCajeros:f.filter(E=>!O.has(E.username)),availableCajas:[1,2,3,4,5].filter(E=>!C.has(E)),onCreate:async E=>{l(!0),d(null);try{const{error:q}=await ne.from("cai").insert(E);if(q)throw q;await w(),b(!1)}catch(q){throw d(q?.message||String(q)),q}finally{l(!1)}}})]})}function S_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Facturas (ventas)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de facturas y gestin de ventas. (Placeholder)"})]})}function w_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Historial de facturas"}),r.jsx("p",{style:{color:"#475569"},children:"Historial de facturas emitidas. (Placeholder)"})]})}var Du=op();function E_({open:o,title:a="Confirmar",message:s="Ests seguro?",onClose:l,onConfirm:u}){const[d,f]=cp.useState(!1);if(!o)return null;const g=async()=>{try{f(!0),await u()}finally{f(!1)}};return Du.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:420},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsx("p",{children:s}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{className:"btn-opaque",onClick:l,disabled:d,children:"Cancelar"}),r.jsx("button",{className:"btn-danger",onClick:g,disabled:d,children:d?"...":"Eliminar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function C_({open:o,title:a="Formulario",columns:s,initialData:l={},onClose:u,onSave:d}){const[f,g]=S.useState({}),[p,m]=S.useState(!1),[v,x]=S.useState(null);if(S.useEffect(()=>{g(l||{}),l&&typeof l.imagen=="string"?x(l.imagen):x(null)},[l,o]),!o)return null;const j=(O,C)=>{g(M=>({...M,[O]:C}))},b=async O=>{O.preventDefault();try{m(!0),await d(f)}finally{m(!1)}},w=O=>O==="creado_en"?null:O==="id"?r.jsx("input",{className:"input",value:f[O]??"",readOnly:!0}):O.includes("publicacion")||O.includes("exento")||O.includes("aplica_impuesto")||O==="publicacion_web"?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsxs("label",{className:"switch",children:[r.jsx("input",{type:"checkbox",checked:!!f[O],onChange:C=>j(O,C.target.checked)}),r.jsx("span",{className:"slider"})]}),r.jsx("span",{style:{fontSize:13},children:f[O]?"S":"No"})]}):O.includes("categoria")||O.includes("marca")?r.jsx("input",{type:"text",className:"input",value:f[O]??"",onChange:C=>j(O,C.target.value===""?null:C.target.value)}):O==="imagen"?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[v?r.jsx("img",{src:v,alt:"preview",style:{maxWidth:200,maxHeight:120,objectFit:"contain"}}):null,r.jsx("input",{type:"file",accept:"image/*",onChange:C=>{const M=C.target.files&&C.target.files[0];if(j(O,M??null),M)try{const B=URL.createObjectURL(M);x(B)}catch{x(null)}else x(null)}}),v?r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>{j(O,null),x(null)},children:"Eliminar imagen"}):null]}):r.jsx("input",{className:"input",value:f[O]??"",onChange:C=>j(O,C.target.value)}),T=r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:720,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:a}),r.jsxs("form",{onSubmit:b,children:[r.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:s.map(O=>r.jsxs("label",{style:{display:"block"},children:[r.jsx("div",{style:{fontSize:12,color:"#374151",marginBottom:6},children:String(O).replace(/_/g," ").toUpperCase()}),w(O)]},O))}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:u,disabled:p,children:"Cancelar"}),r.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Guardando...":"Guardar"})]})]})]})});return Du.createPortal(T,typeof document<"u"&&document.body||document.createElement("div"))}function T_({open:o,data:a,title:s="Detalle",onClose:l,onEdit:u,onDeleteClick:d}){if(!o)return null;const f=a||{},[g,p]=S.useState(null),[m,v]=S.useState(null),[x,j]=S.useState(null),[b,w]=S.useState(null);return S.useEffect(()=>{let T=!0;return(async()=>{const C=typeof f.imagen=="string"?f.imagen:null;if(!C){T&&p(null);return}if(C.startsWith("http")){T&&(p(C),j(C));return}let M=C;const B=String(C).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);B&&(M=decodeURIComponent(B[2]));const G="inventario";try{const E=(await _n(async()=>{const{default:J}=await Promise.resolve().then(()=>bn);return{default:J}},void 0)).default,q=await E.storage.from(G).getPublicUrl(M),U=q?.data?.publicUrl||q?.data?.publicURL||null;if(U){T&&(p(U),j(U));return}const H=await E.storage.from(G).createSignedUrl(M,3600*24*7);if(H.error){console.warn("ProductDetailModal createSignedUrl error",H.error),T&&p(null);return}const he=H.data?.signedUrl??null;T&&(p(he),j(he))}catch(E){console.error("ProductDetailModal resolve error",E),T&&p(null)}})(),()=>{T=!1}},[f]),S.useEffect(()=>{let T=!0;return(async()=>{if(w(null),!!x)try{const C=await fetch(x,{method:"HEAD"});if(!T)return;w(`HEAD ${C.status} ${C.statusText} - content-type: ${C.headers.get("content-type")}`)}catch(C){if(!T)return;w(`FETCH_ERROR: ${String(C)}`)}})(),()=>{T=!1}},[x]),Du.createPortal(r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",padding:18,borderRadius:8,width:760,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:s}),r.jsxs("div",{style:{display:"flex",gap:18},children:[r.jsx("div",{style:{flex:1},children:r.jsx("table",{style:{width:"100%"},children:r.jsx("tbody",{children:Object.keys(f).map(T=>{const O=f[T];return T==="imagen"&&typeof O=="string"?null:r.jsxs("tr",{children:[r.jsx("td",{style:{fontWeight:700,padding:6,width:160},children:String(T).replace(/_/g," ").toUpperCase()}),r.jsx("td",{style:{padding:6},children:String(O??"-")})]},T)})})})}),r.jsx("div",{style:{width:280,textAlign:"center"},children:g?r.jsx("img",{src:encodeURI(g),alt:"imagen",style:{maxWidth:260,maxHeight:260,objectFit:"contain"},onError:T=>{console.warn("Image load failed for",g),v(g),p(null)}}):m?r.jsxs("div",{style:{width:260,height:200,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff5f5",color:"#b91c1c",border:"1px dashed #fca5a5",padding:8},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"Error cargando imagen"}),r.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",style:{color:"#b91c1c",wordBreak:"break-all"},children:"Abrir imagen"})]}):r.jsx("div",{style:{width:260,height:200,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280"},children:"Sin imagen"})})]}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{type:"button",className:"btn-opaque",onClick:()=>u(f),children:"Editar"}),r.jsx("button",{type:"button",className:"btn-danger",onClick:()=>d(f.id),children:"Eliminar"}),r.jsx("button",{type:"button",className:"btn-opaque",onClick:l,children:"Cerrar"})]})]})}),typeof document<"u"&&document.body||document.createElement("div"))}function A_({table:o,select:a,title:s,limit:l=500,columns:u,searchColumns:d,order:f,filters:g,allowAdd:p=!1,allowEdit:m=!1,allowDelete:v=!1,formExclude:x=[]}){const[j,b]=S.useState(null),[w,T]=S.useState(!1),[O,C]=S.useState(null),[M,B]=S.useState(""),[G,E]=S.useState(!1),[q,U]=S.useState("add"),[H,he]=S.useState({}),[J,Z]=S.useState(!1),[F,k]=S.useState(null),[W,_e]=S.useState(!1),[D,L]=S.useState(null),ee=S.useRef(!0),oe=async()=>{T(!0),C(null);try{const ie=(await _n(async()=>{const{default:Ue}=await Promise.resolve().then(()=>bn);return{default:Ue}},void 0)).default,fe=a||"*";let de=ie.from(o).select(fe).limit(l);f&&(Array.isArray(f)?f:String(f).split(",").map(Ve=>Ve.trim()).filter(Boolean)).forEach(Ve=>{const ze=Ve.split(" ").map(ht=>ht.trim()).filter(Boolean),De=ze[0],Qe=ze[1]?ze[1].toLowerCase():"asc";de=de.order(De,{ascending:Qe!=="desc"})}),g&&Object.entries(g).forEach(([Ue,Ve])=>{Ve==null||Ve===""||(de=de.eq(Ue,Ve))});const ye=await de;if(console.debug("SupabaseTable fetch result for",o,ye),!ee.current)return;if(ye.error)throw ye.error;b(Array.isArray(ye.data)?ye.data:[])}catch(ie){console.error("SupabaseTable error",ie),C(ie?.message||String(ie)),b([])}finally{ee.current&&T(!1)}};S.useEffect(()=>(ee.current=!0,oe(),()=>{ee.current=!1}),[o,a,l]);const pe=S.useMemo(()=>u&&u.length>0?u:!j||j.length===0?[]:Object.keys(j[0]),[u,j]),A=S.useMemo(()=>{if(!j)return null;const ie=(M||"").toString().trim().toLowerCase();if(!ie)return j;const fe=d&&d.length>0?d:pe;return j.filter(de=>fe.some(ye=>{const Ue=de?.[ye];return Ue==null?!1:String(Ue).toLowerCase().includes(ie)}))},[j,M,d,pe]),z=()=>{p&&(U("add"),he({}),E(!0))},K=ie=>{m&&(U("edit"),he(ie),E(!0))},Q=async ie=>{const fe=(await _n(async()=>{const{default:de}=await Promise.resolve().then(()=>bn);return{default:de}},void 0)).default;try{const de="inventario",ye={...ie},Ue=q==="edit"?H?.imagen??null:null,Ve=ze=>{if(!ze)return null;if(!ze.startsWith("http"))return ze;const De=ze.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return De?decodeURIComponent(De[2]):null};if(ye.imagen&&ye.imagen instanceof File){const ze=ye.imagen,De=ye.id??(crypto&&crypto.randomUUID?crypto.randomUUID():String(Date.now())),Qe=`${o}/${De}/${Date.now()}_${ze.name.replace(/[^a-zA-Z0-9.\-_/]/g,"_")}`,ht=await fe.storage.from(de).upload(Qe,ze,{upsert:!0});if(ht.error)throw ht.error;const Dt=ht.data?.path??Qe;ye.imagen=Dt;try{const Et=Ve(Ue);if(Et&&Et!==Dt){const $t=await fe.storage.from(de).remove([Et]);$t.error&&console.warn("Failed to remove old image",$t.error)}}catch(Et){console.warn("Error removing old image",Et)}}if(q==="edit"&&(ye.imagen==null||ye.imagen===""))try{const ze=Ve(H?.imagen??null);if(ze){const De=await fe.storage.from(de).remove([ze]);De.error&&console.warn("Failed to remove old image on clear",De.error)}}catch(ze){console.warn("Error removing old image on clear",ze)}if(q==="add"){const{error:ze}=await fe.from(o).insert([ye]);if(ze)throw ze}else{const ze=ye.id,De={...ye};delete De.id;const{error:Qe}=await fe.from(o).update(De).eq("id",ze);if(Qe)throw Qe}E(!1),await oe()}catch(de){console.error("Error saving",de),C(de?.message||String(de))}},se=async()=>{if(F==null)return;const ie=(await _n(async()=>{const{default:fe}=await Promise.resolve().then(()=>bn);return{default:fe}},void 0)).default;try{if(!v)return;try{const de="inventario",ye=j?.find(De=>De.id===F),Ue=De=>{if(!De)return null;if(!De.startsWith("http"))return De;const Qe=De.match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);return Qe?decodeURIComponent(Qe[2]):null},Ve=ye?.imagen??null,ze=Ue(Ve);if(ze){const De=await ie.storage.from(de).remove([ze]);De.error&&console.warn("Failed to remove image on delete",De.error)}}catch(de){console.warn("Error removing image before delete",de)}const{error:fe}=await ie.from(o).delete().eq("id",F);if(fe)throw fe;Z(!1),k(null),await oe()}catch(fe){console.error("Error deleting",fe),C(fe?.message||String(fe))}};return r.jsxs("div",{style:{padding:18},children:[s?r.jsx("h2",{style:{marginTop:0},children:s}):null,r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("input",{placeholder:"Buscar...",value:M,onChange:ie=>B(ie.target.value),className:"input",style:{minWidth:240}}),r.jsx("button",{onClick:()=>{C(null),B(""),oe()},className:"btn-opaque",children:"Recargar"}),r.jsx("div",{style:{marginLeft:"auto"},children:r.jsx("button",{onClick:z,className:"btn-primary",children:"Agregar"})})]}),w&&r.jsxs("div",{children:["Cargando datos de `",o,"` desde Supabase..."]}),O&&r.jsxs("div",{style:{color:"#b91c1c"},children:["Error: ",O]}),!w&&j&&j.length===0&&r.jsxs("div",{children:["No hay registros en la tabla ",r.jsx("strong",{children:o}),"."]}),!w&&A&&A.length>0&&r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[pe.map(ie=>r.jsx("th",{children:String(ie).replace(/_/g," ").toUpperCase()},ie)),r.jsx("th",{style:{width:140},children:"Acciones"})]})}),r.jsx("tbody",{children:A.map((ie,fe)=>r.jsxs("tr",{children:[pe.map(de=>{if(de==="imagen"){const ye=ie?.imagen??null;return ye||console.debug("SupabaseTable: row has no imagen for id",ie?.id,ie),r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:ye?r.jsx(im,{src:String(ye)}):r.jsx("span",{style:{color:"#6b7280"},children:"-"})},de)}return r.jsx("td",{style:{maxWidth:420,wordBreak:"break-word"},children:O_(ie[de])},de)}),r.jsx("td",{className:"admin-actions",children:r.jsx("button",{className:"btn-opaque",onClick:()=>{L(ie),_e(!0)},children:"Ver"})})]},ie.id??fe))})]})}),r.jsx(C_,{open:G,title:q==="add"?`Agregar a ${o}`:`Editar ${o}`,columns:pe.filter(ie=>!x.includes(ie)),initialData:H,onClose:()=>E(!1),onSave:Q}),r.jsx(T_,{open:W,data:D,title:`Detalle de ${o}`,onClose:()=>_e(!1),onEdit:ie=>{_e(!1),K(ie)},onDeleteClick:ie=>{_e(!1),k(ie),Z(!0)}}),r.jsx(E_,{open:J,title:"Confirmar eliminacin",message:`Eliminar registro de ${o}?`,onClose:()=>Z(!1),onConfirm:se})]})}function O_(o){if(o==null)return"-";if(typeof o=="object")return JSON.stringify(o);if(typeof o=="boolean")return o?"S":"No";if(typeof o=="number"&&(o===0||o===1))return o===1?"S":"No";if(typeof o=="string"){const a=o.toLowerCase().trim();if(a==="1"||a==="true"||a==="t"||a==="si"||a==="s"||a==="yes")return"S";if(a==="0"||a==="false"||a==="f"||a==="no"||a==="n"||a==="not")return"No";if((o.startsWith("http")||o.startsWith("/"))&&(a.endsWith(".png")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".gif")||a.endsWith(".webp")||a.endsWith(".svg")||a.includes("/storage/")))return r.jsx(im,{src:o})}return String(o)}function im({src:o}){const[a,s]=S.useState(null),[l,u]=S.useState(null);return S.useEffect(()=>{let d=!0;return(async()=>{if(!o)return;if(o.startsWith("http")){d&&s(o);return}let g=o;const p=String(o).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);p&&(g=decodeURIComponent(p[2]));try{const m=(await _n(async()=>{const{default:T}=await Promise.resolve().then(()=>bn);return{default:T}},void 0)).default,v="inventario",x=await m.storage.from(v).getPublicUrl(g),j=x?.data?.publicUrl||x?.data?.publicURL||null;if(j){d&&s(j);return}const b=await m.storage.from(v).createSignedUrl(g,3600*24*7);if(b.error){console.warn("Thumbnail createSignedUrl error",b.error),d&&s(null);return}const w=b.data?.signedUrl??null;d&&s(w)}catch(m){console.error("Thumbnail resolve error",m),d&&s(null)}})(),()=>{d=!1}},[o]),!a&&!l?r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#f3f4f6",color:"#6b7280",borderRadius:4},children:"Cargando..."}):a?r.jsx("img",{src:encodeURI(a),alt:"img",style:{maxWidth:140,maxHeight:80,objectFit:"contain"},onError:d=>{u(a),s(null)}}):r.jsx("div",{style:{width:140,height:80,display:"flex",alignItems:"center",justifyContent:"center",background:"#fff7ed",border:"1px dashed #f59e0b",padding:4},children:r.jsx("a",{href:l??o,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,color:"#92400e",textDecoration:"underline",wordBreak:"break-all"},children:"Abrir imagen"})})}function N_(){const[o,a]=S.useState(null),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState([]);return S.useEffect(()=>{let v=!0;return(async()=>{try{const b=await(await _n(async()=>{const{default:U}=await Promise.resolve().then(()=>bn);return{default:U}},void 0)).default.from("inventario").select("id,categoria,marca,publicacion_web,exento,aplica_impuesto_18,aplica_impuesto_turistico");if(!v)return;const w=Array.isArray(b.data)?b.data:[],T=new Set(w.map(U=>U.categoria??"").filter(Boolean)),O=new Set(w.map(U=>U.marca??"").filter(Boolean)),C=w.length,M=w.filter(U=>!!U.publicacion_web).length,B=U=>{if(U==null)return!1;if(typeof U=="boolean")return U===!0;if(typeof U=="number")return U===1;const H=String(U).toLowerCase().trim();return H==="1"||H==="true"||H==="t"||H==="si"||H==="s"||H==="yes"},G=w.filter(U=>B(U.exento)).length,E=w.filter(U=>B(U.aplica_impuesto_18)).length,q=w.filter(U=>B(U.aplica_impuesto_turistico)).length;a({categorias:T.size,marcas:O.size,items:C,publicadas:M,exentos:G,aplica_impuesto_18:E,aplica_impuesto_turistico:q}),g(Array.from(T).sort()),m(Array.from(O).sort())}catch(j){console.error("Error loading inventario summary",j)}})(),()=>{v=!1}},[]),r.jsxs("div",{children:[r.jsx("h2",{style:{marginTop:0},children:"PRODUCTOS"}),r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[r.jsx(ni,{label:"Categoras (cuenta)",value:o?String(o.categorias):"..."}),r.jsx(ni,{label:"Marcas",value:o?String(o.marcas):"..."}),r.jsx(ni,{label:"Items",value:o?String(o.items):"..."}),r.jsx(ni,{label:"Publicadas en web",value:o?String(o.publicadas):"..."}),r.jsx(ni,{label:"Exentos",value:o?String(o.exentos):"..."}),r.jsx(ni,{label:"Aplica impuesto 18%",value:o?String(o.aplica_impuesto_18):"..."}),r.jsx(ni,{label:"Impuesto turstico",value:o?String(o.aplica_impuesto_turistico):"..."})]}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Categoria:"}),r.jsxs("select",{value:s,onChange:v=>l(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),f.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Marca:"}),r.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"input",children:[r.jsx("option",{value:"",children:"Todas"}),p.map(v=>r.jsx("option",{value:v,children:v},v))]})]}),r.jsx("button",{className:"btn-opaque",onClick:()=>{l(""),d("")},children:"Limpiar filtros"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})]}),r.jsx(A_,{table:"inventario",select:"id, nombre, sku, codigo_barras, categoria, marca, descripcion, modelo, publicacion_web, exento, aplica_impuesto_18, aplica_impuesto_turistico, creado_en,imagen",title:"",order:["id","categoria","marca"],filters:{categoria:s||void 0,marca:u||void 0},columns:["imagen","sku","nombre","marca","modelo","categoria","descripcion","publicacion_web","exento","aplica_impuesto_18","aplica_impuesto_turistico","creado_en"],searchColumns:["nombre","sku","descripcion","codigo_barras","modelo"],formExclude:["codigo_barras","creado_en"],allowAdd:!0,allowEdit:!0,allowDelete:!0})]})}function ni({label:o,value:a}){return r.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.04)",minWidth:140},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:o}),r.jsx("div",{style:{fontSize:20,fontWeight:700,marginTop:6},children:a})]})}function R_({open:o,onClose:a,products:s,availableCajas:l,onCreate:u}){const[d,f]=S.useState(null),[g,p]=S.useState(""),[m,v]=S.useState(!1),[x,j]=S.useState(null),[b,w]=S.useState(null),[T,O]=S.useState(null),[C,M]=S.useState(null),[B,G]=S.useState(null),[E,q]=S.useState(null),[U,H]=S.useState(null),[he,J]=S.useState(null),[Z,F]=S.useState(null),[k,W]=S.useState(!1);S.useEffect(()=>{o&&(f(null),p(""),w(null),O(null),M(null),J(null),F(null),j(null))},[o]);async function _e(){const L=[];if(d||L.push("Producto"),g||L.push("Precio"),L.length>0){j(`Faltan campos: ${L.join(", ")}`);return}const ee=Number(g);if(isNaN(ee)||ee<0){j("Precio invlido");return}v(!0),j(null);try{await u({producto_id:d,precio:g});try{const oe={};if(B!==null&&(oe.exento=B),E!==null&&(oe.aplica_impuesto_18=E),U!==null&&(oe.aplica_impuesto_turistico=U),Object.keys(oe).length>0){const{error:pe}=await ne.from("inventario").update(oe).eq("id",d);pe&&console.warn("Error actualizando inventario flags:",pe)}}catch(oe){console.warn("Error al persistir flags en inventario:",oe)}a()}catch(oe){j(oe?.message||String(oe))}finally{v(!1)}}function D(L){return L?Number(L.replace(",",".")):NaN}return S.useEffect(()=>{let L=!0;async function ee(){if(w(null),O(null),M(null),J(null),F(null),!d)return;const oe=D(g);if(!isNaN(oe)){W(!0);try{const{data:pe,error:A}=await ne.from("compras_detalle").select("costo_unitario").eq("producto_id",d);if(A)throw A;const z=Array.isArray(pe)?pe.map(lt=>Number(lt.costo_unitario)).filter(lt=>!isNaN(lt)):[],K=z.length>0?z.reduce((lt,ut)=>lt+ut,0)/z.length:0;if(!L)return;w(K);let Q=!1,se=!1,ie=!1;try{const{data:lt,error:ut}=await ne.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",d).single();!ut&&lt&&(Q=!!lt.exento,se=!!lt.aplica_impuesto_18,ie=!!lt.aplica_impuesto_turistico,B===null&&G(Q),E===null&&q(se),U===null&&H(ie))}catch{}const{data:fe}=await ne.from("impuesto").select("id, impuesto_venta"),de={};Array.isArray(fe)&&fe.forEach(lt=>{de[String(lt.id)]=Number(lt.impuesto_venta)});const ye=B!==null?B:Q,Ue=E!==null?E:se,Ve=U!==null?U:ie;let ze=0;ye?ze=0:Ue?ze=de[2]??de[1]??0:ze=de[1]??0;let De=0;Ve&&(De=de[3]??0);const Qe=(ze||0)+(De||0),ht=Qe>1?Qe/100:Qe,Dt=oe*ht;O(Qe),M(Dt);const Et=oe-K,$t=K>0?Et/K*100:null;J($t);const Ln=oe>0?(oe-K-Dt)/oe*100:null;F(Ln)}catch{}finally{L&&W(!1)}}}return ee(),()=>{L=!1}},[d,g,B,E,U]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar precio"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:d??"",onChange:L=>f(L.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),s.map(L=>r.jsx("option",{value:L.id,children:L.nombre},L.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!B,onChange:L=>G(L.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!E,onChange:L=>q(L.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!U,onChange:L=>H(L.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:g,onChange:L=>p(L.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:b==null?"":b.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:C==null?"":C.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:he==null?"":he.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:Z==null?"":Z.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),x&&r.jsx("div",{style:{color:"red",marginTop:12},children:x}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:m,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:_e,disabled:m,style:{width:"auto",padding:"8px 14px"},children:m?"Creando...":"Crear"})]})]})}):null}function k_({open:o,onClose:a,row:s,products:l,availableProducts:u,onSave:d}){const[f,g]=S.useState(null),[p,m]=S.useState(""),[v,x]=S.useState(!1),[j,b]=S.useState(null),[w,T]=S.useState(null),[O,C]=S.useState(null),[M,B]=S.useState(null),[G,E]=S.useState(null),[q,U]=S.useState(null),[H,he]=S.useState(null),[J,Z]=S.useState(null),[F,k]=S.useState(null),[W,_e]=S.useState(!1);S.useEffect(()=>{if(!(!o||!s)){g(s.producto_id);try{const ee=Number(s.precio);m(isNaN(ee)?String(s.precio):ee.toFixed(2))}catch{m(s.precio)}b(null)}},[o,s]);function D(ee){return ee?Number(ee.replace(",",".")):NaN}if(S.useEffect(()=>{let ee=!0;async function oe(){if(T(null),C(null),B(null),Z(null),k(null),!o||!s||!f)return;const pe=D(p);if(!isNaN(pe)){_e(!0);try{const{data:A,error:z}=await ne.from("compras_detalle").select("costo_unitario").eq("producto_id",f);if(z)throw z;const K=Array.isArray(A)?A.map(ut=>Number(ut.costo_unitario)).filter(ut=>!isNaN(ut)):[],Q=K.length>0?K.reduce((ut,An)=>ut+An,0)/K.length:0;if(!ee)return;T(Q);let se=!1,ie=!1,fe=!1;try{const{data:ut,error:An}=await ne.from("inventario").select("exento,aplica_impuesto_18,aplica_impuesto_turistico").eq("id",f).single();!An&&ut&&(se=!!ut.exento,ie=!!ut.aplica_impuesto_18,fe=!!ut.aplica_impuesto_turistico,G===null&&E(se),q===null&&U(ie),H===null&&he(fe))}catch{}const{data:de}=await ne.from("impuesto").select("id, impuesto_venta"),ye={};Array.isArray(de)&&de.forEach(ut=>ye[String(ut.id)]=Number(ut.impuesto_venta));const Ue=G!==null?G:se,Ve=q!==null?q:ie,ze=H!==null?H:fe;let De=0;Ue?De=0:Ve?De=ye[2]??ye[1]??0:De=ye[1]??0;let Qe=0;ze&&(Qe=ye[3]??0);const ht=(De||0)+(Qe||0),Dt=ht>1?ht/100:ht,Et=pe*Dt;C(ht),B(Et);const $t=pe-Q,Ln=Q>0?$t/Q*100:null;Z(Ln);const lt=pe>0?(pe-Q-Et)/pe*100:null;k(lt)}catch{}finally{ee&&_e(!1)}}}return oe(),()=>{ee=!1}},[o,s,f,p,G,q,H]),!o||!s)return null;async function L(){const ee=[];if(f||ee.push("Producto"),p||ee.push("Precio"),ee.length>0){b(`Faltan campos: ${ee.join(", ")}`);return}const oe=Number(p);if(isNaN(oe)||oe<0){b("Precio invlido");return}x(!0),b(null);try{const pe=s.id;await d(pe,{producto_id:f,precio:p});try{const A={};if(G!==null&&(A.exento=G),q!==null&&(A.aplica_impuesto_18=q),H!==null&&(A.aplica_impuesto_turistico=H),Object.keys(A).length>0&&f){const{error:z}=await ne.from("inventario").update(A).eq("id",f);z&&console.warn("Error actualizando inventario flags:",z)}}catch(A){console.warn("Error al persistir flags en inventario:",A)}a()}catch(pe){b(pe?.message||String(pe))}finally{x(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:640,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar precio  ID ",s.id]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Producto"}),r.jsxs("select",{className:"input",value:f??"",onChange:ee=>g(ee.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),(u??l).map(ee=>r.jsx("option",{value:ee.id,children:ee.nombre},ee.id))]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!G,onChange:ee=>E(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Exento (si activo, impuesto = 0)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!q,onChange:ee=>U(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Usar impuesto 18% (id=2)"})]}),r.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"checkbox",checked:!!H,onChange:ee=>he(ee.target.checked)}),r.jsx("span",{style:{fontSize:13},children:"Impuesto turstico (+ id=3)"})]})]}),r.jsx("label",{style:{fontSize:13},children:"Precio"}),r.jsx("input",{className:"input",value:p,onChange:ee=>m(ee.target.value),placeholder:"0.00"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Costo (promedio compras)"}),r.jsx("input",{className:"input",value:w==null?"":w.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Impuesto (monto)"}),r.jsx("input",{className:"input",value:M==null?"":M.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Margen de ganancia (%)"}),r.jsx("input",{className:"input",value:J==null?"":J.toFixed(2),readOnly:!0,placeholder:"--"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Rentabilidad (%)"}),r.jsx("input",{className:"input",value:F==null?"":F.toFixed(2),readOnly:!0,placeholder:"--"})]})]})]}),j&&r.jsx("div",{style:{color:"red",marginTop:12},children:j}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:v,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:L,disabled:v,style:{width:"auto",padding:"8px 14px"},children:v?"Guardando...":"Guardar"})]})]})})}function U_(){const[o,a]=S.useState([]),[s,l]=S.useState([]),[u,d]=S.useState(!1),[f,g]=S.useState(null),[p,m]=S.useState(!1),[v,x]=S.useState(!1),[j,b]=S.useState(null);async function w(){d(!0),g(null);try{const{data:E,error:q}=await ne.from("precios").select("id, producto_id, precio").order("id",{ascending:!0});if(q)throw q;a(Array.isArray(E)?E:[])}catch(E){g(E?.message||String(E)),a([])}finally{d(!1)}}async function T(){try{const{data:E}=await ne.from("inventario").select("id, nombre").order("nombre",{ascending:!0});l(Array.isArray(E)?E:[])}catch{}}S.useEffect(()=>{w(),T()},[]);const O=new Set(o.map(E=>String(E.producto_id))),C=s.filter(E=>!O.has(E.id));function M(E){b(E),x(!0),g(null)}async function B(E){d(!0),g(null);try{const{error:q}=await ne.from("precios").insert(E);if(q)throw q;try{const U={producto_id:E.producto_id,precio:E.precio},{error:H}=await ne.from("precios_historico").insert(U);H&&console.warn("No se pudo insertar en precios_historico",H)}catch(U){console.warn("Error registrando precios_historico",U)}await w()}catch(q){throw g(q?.message||String(q)),q}finally{d(!1)}}async function G(E,q){d(!0),g(null);try{const{error:U}=await ne.from("precios").update(q).eq("id",E);if(U)throw U;let H=q.producto_id,he=q.precio;if(!H||he===void 0)try{const{data:J}=await ne.from("precios").select("producto_id, precio").eq("id",E).limit(1).single();J&&(H=H||J.producto_id,he=he===void 0?J.precio:he)}catch{}try{if(H&&he!==void 0){const J={producto_id:H,precio:he},{error:Z}=await ne.from("precios_historico").insert(J);Z&&console.warn("No se pudo insertar en precios_historico",Z)}}catch(J){console.warn("Error registrando precios_historico",J)}await w()}catch(U){throw g(U?.message||String(U)),U}finally{d(!1)}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Precios de productos"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{w(),T()},children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),style:{marginLeft:6},children:"Agregar precio"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:u?"Cargando...":`${o.length} precios`})]}),f&&r.jsx("div",{style:{color:"red",marginBottom:12},children:f}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:E.id}),r.jsx("td",{style:{minWidth:220},children:s.find(q=>q.id===E.producto_id)?.nombre||E.producto_id}),r.jsx("td",{children:E.precio}),r.jsx("td",{style:{whiteSpace:"nowrap"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>M(E),children:"Editar"})})]},E.id))})]})}),r.jsx(R_,{open:p,onClose:()=>m(!1),products:C,onCreate:async E=>{await B(E),m(!1)}}),r.jsx(k_,{open:v,onClose:()=>{x(!1),b(null)},row:j,products:s,availableProducts:[...s.filter(E=>!O.has(E.id)),...j?s.filter(E=>E.id===j.producto_id):[]],onSave:async(E,q)=>{await G(E,q),x(!1),b(null)}})]})}function z_(){const[o,a]=S.useState(""),[s,l]=S.useState([]),[u,d]=S.useState(null),[f,g]=S.useState([]),[p,m]=S.useState(!1),[v,x]=S.useState(null);async function j(){if(x(null),l([]),d(null),g([]),!!o){m(!0);try{const{data:w,error:T}=await ne.from("inventario").select("id, nombre, sku").ilike("sku",`%${o}%`).order("nombre",{ascending:!0});if(T)throw T;if(l(Array.isArray(w)?w:[]),Array.isArray(w)&&w.length===1){const O=w[0].id;d(O),await b(O)}}catch(w){x(w?.message||String(w))}finally{m(!1)}}}async function b(w){m(!0),x(null);try{const{data:T,error:O}=await ne.from("precios_historico").select("id, producto_id, precio, cambiado_en").eq("producto_id",w).order("cambiado_en",{ascending:!1});if(O)throw O;g(Array.isArray(T)?T:[])}catch(T){x(T?.message||String(T)),g([])}finally{m(!1)}}return S.useEffect(()=>{u&&b(u)},[u]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Histrico de precios"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Buscar por SKU",value:o,onChange:w=>a(w.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>j(),children:"Buscar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l([]),d(null),g([])},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:p?"Cargando...":`${f.length} registros`})]}),v&&r.jsx("div",{style:{color:"red",marginBottom:12},children:v}),s.length>0&&r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Resultados:"}),r.jsx("ul",{children:s.map(w=>r.jsxs("li",{style:{marginBottom:6},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>d(w.id),style:{marginRight:8},children:w.sku}),r.jsx("strong",{children:w.nombre})," ",r.jsxs("span",{style:{color:"#6b7280"},children:["(",w.id,")"]})]},w.id))})]}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Precio"}),r.jsx("th",{children:"Actualizacion"})]})}),r.jsx("tbody",{children:f.map(w=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(w.id)}),r.jsx("td",{style:{minWidth:220},children:s.find(T=>T.id===w.producto_id)?.nombre||w.producto_id}),r.jsx("td",{children:Number(w.precio).toFixed(2)}),r.jsx("td",{children:w.cambiado_en})]},String(w.id)))})]})]})]})}function D_(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState({}),[v,x]=S.useState({}),[j,b]=S.useState(!1),[w,T]=S.useState(null);async function O(){b(!0),T(null);try{let C=ne.from("inventario").select("id, nombre, sku, marca, modelo, descripcion, imagen");o&&(C=C.ilike("sku",`%${o}%`)),s&&(C=C.ilike("marca",`%${s}%`)),u&&(C=C.ilike("modelo",`%${u}%`));const{data:M,error:B}=await C.order("nombre",{ascending:!0});if(B)throw B;const G=Array.isArray(M)?M:[];g(G);const E=G.map(J=>J.id);if(E.length===0){m({});return}const{data:q,error:U}=await ne.from("registro_de_inventario").select("producto_id, cantidad, tipo_de_movimiento").in("producto_id",E);if(U)throw U;const H=Array.isArray(q)?q:[],he={};for(const J of G)he[String(J.id)]=0;for(const J of H){const Z=String(J.producto_id),F=Number(J.cantidad)||0,k=String(J.tipo_de_movimiento||"").toUpperCase();he.hasOwnProperty(Z)||(he[Z]=0),k==="ENTRADA"?he[Z]=(he[Z]||0)+F:k==="SALIDA"&&(he[Z]=(he[Z]||0)-F)}for(const J of Object.keys(he))he[J]=Number((he[J]||0).toFixed(2));m(he);try{const J=(await _n(async()=>{const{default:k}=await Promise.resolve().then(()=>bn);return{default:k}},void 0)).default,Z="inventario",F={};await Promise.all(G.map(async k=>{const W=k.imagen;if(!W){F[String(k.id)]=null;return}const _e=String(W);if(_e.startsWith("http")){F[String(k.id)]=_e;return}let D=_e;const L=String(_e).match(/\/storage\/v1\/object\/public\/([^/]+)\/(.*)/);L&&(D=decodeURIComponent(L[2]));try{const ee=await J.storage.from(Z).getPublicUrl(D),oe=ee?.data?.publicUrl||ee?.data?.publicURL||null;if(oe){F[String(k.id)]=oe;return}}catch{}try{const oe=(await J.storage.from(Z).createSignedUrl(D,604800))?.data?.signedUrl??null;F[String(k.id)]=oe}catch{F[String(k.id)]=null}})),x(F)}catch{}}catch(C){T(C?.message||String(C)),g([]),m({})}finally{b(!1)}}return S.useEffect(()=>{O()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Stock"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"Filtro SKU",value:o,onChange:C=>a(C.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Marca",value:s,onChange:C=>l(C.target.value)}),r.jsx("input",{className:"input",placeholder:"Filtro Modelo",value:u,onChange:C=>d(C.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>O(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),O()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:j?"Cargando...":`${f.length} productos`})]}),w&&r.jsx("div",{style:{color:"red",marginBottom:12},children:w}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("div",{}),r.jsx("div",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir tabla"})})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Imagen"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Marca"}),r.jsx("th",{children:"Modelo"}),r.jsx("th",{children:"Descripcin"}),r.jsx("th",{children:"Stock"})]})}),r.jsx("tbody",{children:f.map(C=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:v[String(C.id)]?r.jsx("img",{src:encodeURI(v[String(C.id)]),alt:C.nombre,style:{width:48,height:48,objectFit:"cover"},onError:M=>{M.currentTarget.src=""}}):C.imagen?r.jsx("img",{src:C.imagen,alt:C.nombre,style:{width:48,height:48,objectFit:"cover"},onError:M=>{M.currentTarget.src=""}}):""}),r.jsx("td",{children:C.sku||""}),r.jsx("td",{children:C.marca||""}),r.jsx("td",{children:C.modelo||""}),r.jsx("td",{style:{maxWidth:320},children:C.descripcion||""}),r.jsx("td",{style:{textAlign:"right"},children:p[String(C.id)]!=null?String(p[String(C.id)]):"0"})]},C.id))})]})]})]})}function B_(){const[o,a]=S.useState(""),[s,l]=S.useState(""),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,m]=S.useState([]),[v,x]=S.useState(!1),[j,b]=S.useState([]),[w,T]=S.useState({}),[O,C]=S.useState(!1),[M,B]=S.useState(null);async function G(){C(!0),B(null),b([]);try{let H=null;if(o||s||u){let W=ne.from("inventario").select("id").order("nombre",{ascending:!0});o&&(W=W.ilike("sku",`%${o}%`)),s&&(W=W.ilike("marca",`%${s}%`)),u&&(W=W.ilike("categoria",`%${u}%`));const{data:_e,error:D}=await W;if(D)throw D;if(H=Array.isArray(_e)?_e.map(L=>String(L.id)):[],H.length===0){b([]),T({}),C(!1);return}}let he=ne.from("registro_de_inventario").select("id, producto_id, cantidad, tipo_de_movimiento, referencia, usuario, fecha_salida");if(H&&(he=he.in("producto_id",H)),v){const W=new Date(Date.now()-864e5).toISOString();he=he.gte("fecha_salida",W)}he=he.order("fecha_salida",{ascending:!1});const{data:J,error:Z}=await he;if(Z)throw Z;const F=Array.isArray(J)?J.map(W=>({id:W.id,producto_id:String(W.producto_id),cantidad:Number(W.cantidad),tipo_de_movimiento:W.tipo_de_movimiento,referencia:W.referencia,usuario:W.usuario,fecha_salida:W.fecha_salida})):[];b(F);const k=Array.from(new Set(F.map(W=>W.producto_id))).filter(Boolean);if(k.length>0){const{data:W}=await ne.from("inventario").select("id, nombre, sku, marca, categoria").in("id",k),_e={};Array.isArray(W)&&W.forEach(D=>{_e[String(D.id)]={id:D.id,nombre:D.nombre,sku:D.sku,marca:D.marca,categoria:D.categoria}}),T(_e)}else T({})}catch(H){B(H?.message||String(H)),b([])}finally{C(!1)}}async function E(){try{const{data:H,error:he}=await ne.from("inventario").select("marca, categoria");if(he)throw he;const J=new Set,Z=new Set;Array.isArray(H)&&H.forEach(F=>{F.marca&&J.add(String(F.marca)),F.categoria&&Z.add(String(F.categoria))}),g(Array.from(J).sort()),m(Array.from(Z).sort())}catch(H){console.warn("Error loading filter options",H)}}S.useEffect(()=>{G(),E()},[]);const q=j.filter(H=>String(H.tipo_de_movimiento).toUpperCase()==="ENTRADA"),U=j.filter(H=>String(H.tipo_de_movimiento).toUpperCase()==="SALIDA");return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimiento de Inventario"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("input",{className:"input",placeholder:"SKU",value:o,onChange:H=>a(H.target.value)}),r.jsxs("select",{className:"input",value:s,onChange:H=>l(H.target.value),children:[r.jsx("option",{value:"",children:"-- Marca (todas) --"}),f.map(H=>r.jsx("option",{value:H,children:H},H))]}),r.jsxs("select",{className:"input",value:u,onChange:H=>d(H.target.value),children:[r.jsx("option",{value:"",children:"-- Categora (todas) --"}),p.map(H=>r.jsx("option",{value:H,children:H},H))]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:v,onChange:H=>x(H.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{a(""),l(""),d(""),x(!1),G()},children:"Limpiar"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:O?"Cargando...":`${j.length} registros`})]}),M&&r.jsx("div",{style:{color:"red",marginBottom:12},children:M}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Entradas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:q.map(H=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(H.id)}),r.jsx("td",{style:{minWidth:120},children:w[H.producto_id]?.sku||H.producto_id}),r.jsx("td",{children:w[H.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(H.cantidad).toFixed(2)}),r.jsx("td",{children:H.referencia||""}),r.jsx("td",{children:H.usuario||""}),r.jsx("td",{children:H.fecha_salida||""})]},String(H.id)))})]})]}),r.jsxs("div",{style:{flex:1,background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("strong",{children:"Salidas"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{document.body.classList.add("print-table-only"),setTimeout(()=>{window.print(),document.body.classList.remove("print-table-only")},50)},children:"Imprimir"})]}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"SKU"}),r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Referencia"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"})]})}),r.jsx("tbody",{children:U.map(H=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:70},children:String(H.id)}),r.jsx("td",{style:{minWidth:120},children:w[H.producto_id]?.sku||H.producto_id}),r.jsx("td",{children:w[H.producto_id]?.nombre||""}),r.jsx("td",{style:{textAlign:"right"},children:Number(H.cantidad).toFixed(2)}),r.jsx("td",{children:H.referencia||""}),r.jsx("td",{children:H.usuario||""}),r.jsx("td",{children:H.fecha_salida||""})]},String(H.id)))})]})]})]})]})}function M_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Categoras / Marcas (opcional)"}),r.jsx("p",{style:{color:"#475569"},children:"Gestin de categoras y marcas. (Placeholder)"})]})}function q_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Sesiones de caja (caja_sesiones)"}),r.jsx("p",{style:{color:"#475569"},children:"Registros de sesiones de caja. (Placeholder)"})]})}function L_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Movimientos de caja (caja_movimientos)"}),r.jsx("p",{style:{color:"#475569"},children:"Listado de movimientos de caja. (Placeholder)"})]})}function I_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ventas (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ventas. (Placeholder)"})]})}function H_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devoluciones (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de devoluciones. (Placeholder)"})]})}function V_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Ingresos / Egresos (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de ingresos y egresos. (Placeholder)"})]})}function $_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (reportes)"}),r.jsx("p",{style:{color:"#475569"},children:"Reporte de compras. (Placeholder)"})]})}function P_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Exportar reportes generales (PDF / Excel)"}),r.jsx("p",{style:{color:"#475569"},children:"Exportar reportes a PDF/Excel. (Placeholder)"})]})}function G_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Cuentas contables (cuentas_contables)"}),r.jsx("p",{style:{color:"#475569"},children:"Plan de cuentas y gestin contable. (Placeholder)"})]})}function K_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Libro diario (libro_diario)"}),r.jsx("p",{style:{color:"#475569"},children:"Libro diario contable. (Placeholder)"})]})}function Y_(){return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Auditora (auditoria)"}),r.jsx("p",{style:{color:"#475569"},children:"Registro de auditoras y trazabilidad. (Placeholder)"})]})}function J_({open:o,onClose:a,onCreate:s}){const[l,u]=S.useState(""),[d,f]=S.useState(""),[g,p]=S.useState(""),[m,v]=S.useState(""),[x,j]=S.useState(""),[b,w]=S.useState(""),[T,O]=S.useState(!0),[C,M]=S.useState(!1),[B,G]=S.useState(null);if(!o)return null;async function E(){const q=[];if(l.trim()||q.push("Nombre"),q.length){G(`Faltan campos: ${q.join(", ")}`);return}M(!0),G(null);try{await s({nombre:l.trim(),rtn:d.trim()||void 0,telefono:g.trim()||void 0,correo:m.trim()||void 0,direccion:x.trim()||void 0,tipo_proveedor:b||void 0,activo:T}),u(""),f(""),p(""),v(""),j(""),w(""),O(!0),a()}catch(U){G(U?.message||String(U))}finally{M(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsx("h3",{style:{marginTop:0},children:"Agregar proveedor"}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:l,onChange:q=>u(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:d,onChange:q=>f(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:g,onChange:q=>p(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:m,onChange:q=>v(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:x,onChange:q=>j(q.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:b,onChange:q=>w(q.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:T,onChange:q=>O(q.target.checked)})," ","Activo"]})]}),B&&r.jsx("div",{style:{color:"red",marginTop:12},children:B}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:C,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:E,disabled:C,style:{width:"auto",padding:"8px 14px"},children:C?"Creando...":"Crear"})]})]})})}function Q_({open:o,onClose:a,row:s,onSave:l}){const[u,d]=S.useState(""),[f,g]=S.useState(""),[p,m]=S.useState(""),[v,x]=S.useState(""),[j,b]=S.useState(""),[w,T]=S.useState(""),[O,C]=S.useState(!0),[M,B]=S.useState(!1),[G,E]=S.useState(null);if(S.useEffect(()=>{!o||!s||(d(s.nombre||""),g(s.rtn||""),m(s.telefono||""),x(s.correo||""),b(s.direccion||""),T(s.tipo_proveedor||""),C(s.activo??!0),E(null))},[o,s]),!o||!s)return null;async function q(){if(!s){E("No hay fila seleccionada");return}const U=[];if(u.trim()||U.push("Nombre"),U.length){E(`Faltan campos: ${U.join(", ")}`);return}B(!0),E(null);try{await l(s.id,{nombre:u.trim(),rtn:f.trim()||void 0,telefono:p.trim()||void 0,correo:v.trim()||void 0,direccion:j.trim()||void 0,tipo_proveedor:w||void 0,activo:O}),a()}catch(H){E(H?.message||String(H))}finally{B(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:680,maxWidth:"95%",background:"#fff",borderRadius:8,padding:16},children:[r.jsxs("h3",{style:{marginTop:0},children:["Editar proveedor  ID ",String(s.id)]}),r.jsxs("div",{style:{display:"grid",gap:8},children:[r.jsx("label",{style:{fontSize:13},children:"Nombre"}),r.jsx("input",{className:"input",value:u,onChange:U=>d(U.target.value)}),r.jsx("label",{style:{fontSize:13},children:"RTN"}),r.jsx("input",{className:"input",value:f,onChange:U=>g(U.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Telfono"}),r.jsx("input",{className:"input",value:p,onChange:U=>m(U.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Correo"}),r.jsx("input",{className:"input",value:v,onChange:U=>x(U.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Direccin"}),r.jsx("input",{className:"input",value:j,onChange:U=>b(U.target.value)}),r.jsx("label",{style:{fontSize:13},children:"Tipo"}),r.jsx("input",{className:"input",value:w,onChange:U=>T(U.target.value),placeholder:"local / internacional"}),r.jsxs("label",{style:{fontSize:13},children:[r.jsx("input",{type:"checkbox",checked:O,onChange:U=>C(U.target.checked)})," ","Activo"]})]}),G&&r.jsx("div",{style:{color:"red",marginTop:12},children:G}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:a,disabled:M,style:{width:"auto"},children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:q,disabled:M,style:{width:"auto",padding:"8px 14px"},children:M?"Guardando...":"Guardar"})]})]})})}function X_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(""),[p,m]=S.useState(!1),[v,x]=S.useState(!1),[j,b]=S.useState(null),[w,T]=S.useState(!1),[O,C]=S.useState(null);async function M(q){l(!0),d(null);try{let U=null,H=null;if(q&&q.trim()){const J=`%${q.trim()}%`,Z=await ne.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").or(`nombre.ilike.${J},rtn.ilike.${J}`).order("id",{ascending:!0});U=Z.data,H=Z.error}else{const he=await ne.from("proveedores").select("id, nombre, rtn, telefono, correo, direccion, tipo_proveedor, activo").order("id",{ascending:!0});U=he.data,H=he.error}if(H)throw H;a(Array.isArray(U)?U:[])}catch(U){d(U?.message||String(U)),a([])}finally{l(!1)}}S.useEffect(()=>{M()},[]),S.useEffect(()=>{const q=setTimeout(()=>{M(f)},350);return()=>clearTimeout(q)},[f]);async function B(q){l(!0),d(null);try{const U={...q};if(delete U.id,U.rtn){const{data:he,error:J}=await ne.from("proveedores").select("id, nombre").eq("rtn",U.rtn).limit(1);if(J)throw J;if(Array.isArray(he)&&he.length>0)throw new Error(`Ya existe un proveedor con RTN ${U.rtn}`)}const{error:H}=await ne.from("proveedores").insert(U);if(H)throw H;await M()}catch(U){throw String(U).includes("Ya existe un proveedor")?d(String(U)):U?.code==="23505"||String(U).includes("duplicate key value")?d("Clave duplicada: el id ya existe. Ejecuta la reparacin de la sequence en la BD (setval) o contacta al administrador."):d(U?.message||String(U)),U}finally{l(!1)}}async function G(q,U){l(!0),d(null);try{const{error:H}=await ne.from("proveedores").update(U).eq("id",q);if(H)throw H;await M()}catch(H){throw d(H?.message||String(H)),H}finally{l(!1)}}async function E(){if(O){l(!0),d(null);try{const{error:q}=await ne.from("proveedores").delete().eq("id",O.id);if(q)throw q;T(!1),C(null),await M()}catch(q){d(q?.message||String(q))}finally{l(!1)}}}return r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Proveedores (proveedores)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>M(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:"Agregar proveedor"}),r.jsxs("div",{style:{marginLeft:12,display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{className:"input",placeholder:"Buscar por nombre o RTN...",value:f,onChange:q=>g(q.target.value),style:{width:260}}),r.jsx("button",{className:"btn-opaque",onClick:()=>{g(""),M()},children:"Limpiar"})]}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} proveedores`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"RTN"}),r.jsx("th",{children:"Nombre"}),r.jsx("th",{children:"Telfono"}),r.jsx("th",{children:"Correo"}),r.jsx("th",{children:"Direccin"}),r.jsx("th",{children:"Tipo"}),r.jsx("th",{children:"Activo"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(q=>r.jsxs("tr",{children:[r.jsx("td",{children:q.rtn||""}),r.jsx("td",{style:{minWidth:180},children:q.nombre}),r.jsx("td",{children:q.telefono||""}),r.jsx("td",{children:q.correo||""}),r.jsx("td",{children:q.direccion||""}),r.jsx("td",{children:q.tipo_proveedor||""}),r.jsx("td",{children:q.activo?"S":"No"}),r.jsxs("td",{style:{whiteSpace:"nowrap"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{b(q),x(!0)},children:"Editar"}),r.jsx("button",{className:"btn-danger",onClick:()=>{C(q),T(!0)},style:{marginLeft:8},children:"Eliminar"})]})]},q.id))})]})}),r.jsx(J_,{open:p,onClose:()=>m(!1),onCreate:async q=>{await B(q),m(!1)}}),r.jsx(Q_,{open:v,onClose:()=>{x(!1),b(null)},row:j,onSave:async(q,U)=>{await G(q,U),x(!1),b(null)}}),r.jsx(am,{open:w,title:O?`Eliminar proveedor ${O.nombre}`:"Eliminar proveedor",message:O?`Confirma eliminar al proveedor ${O.nombre}? Esta accin es irreversible.`:"Confirma eliminar el proveedor?",onClose:async()=>{await E()},onCancel:()=>{T(!1),C(null)},confirmLabel:"Eliminar",cancelLabel:"Cerrar"})]})}function F_({open:o,onClose:a,onCreated:s}){const[l,u]=S.useState([]),[d,f]=S.useState([]),[g,p]=S.useState(0),[m,v]=S.useState(null),[x,j]=S.useState(""),[b,w]=S.useState("factura"),[T,O]=S.useState([]),[C,M]=S.useState(null),[B,G]=S.useState(1),[E,q]=S.useState(null),[U,H]=S.useState(!1),[he,J]=S.useState(null);if(S.useEffect(()=>{o&&(async()=>{try{const L=await ne.from("inventario").select("id, nombre, exento").order("nombre",{ascending:!0});u(Array.isArray(L.data)?L.data:[])}catch{}try{const L=await ne.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});f(Array.isArray(L.data)?L.data:[])}catch{}try{const L=await ne.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),ee=Array.isArray(L.data)&&L.data.length>0?L.data[0]:null,oe=ee?Number(ee.impuesto_venta):0;p(oe)}catch{}})()},[o]),!o)return null;function Z(){v(null),j(""),w("factura"),O([]),M(null),G(1),q(null),J(null)}function F(){if(!C){J("Selecciona un producto");return}if(!E||E<=0){J("Costo unitario invlido");return}if(!B||B<=0){J("Cantidad invlida");return}const L=l.find(oe=>oe.id===C),ee=oe=>{if(oe==null)return!1;if(typeof oe=="boolean")return oe===!0;if(typeof oe=="number")return oe===1;const pe=String(oe).toLowerCase().trim();return pe==="1"||pe==="true"||pe==="t"||pe==="si"||pe==="s"||pe==="yes"};O(oe=>[...oe,{producto_id:C,nombre:L?.nombre||"",cantidad:B,costo_unitario:E,exento:ee(L?.exento)}]),M(null),G(1),q(null),J(null)}function k(L){O(ee=>ee.filter((oe,pe)=>pe!==L))}function W(){const L=g,ee=L>1?L/100:L;let oe=0,pe=0,A=0;for(const z of T){const K=z.cantidad*z.costo_unitario;let Q=0,se=K;z.exento||(Q=K*ee,se=K-Q),oe+=se,pe+=Q,A+=K}return{subtotal:oe,impuesto:pe,total:A}}async function _e(){if(J(null),!m){J("Selecciona un proveedor");return}if(T.length===0){J("Agrega al menos un producto");return}H(!0);try{const{subtotal:L,impuesto:ee,total:oe}=W(),pe={proveedor_id:m,numero_documento:x||null,tipo_documento:b||null,subtotal:L,impuesto:ee,total:oe,usuario:null},A=await ne.from("compras").insert(pe).select("id").single();if(A.error)throw A.error;const z=A.data.id,K=T.map(se=>({compra_id:z,producto_id:se.producto_id,cantidad:se.cantidad,costo_unitario:se.costo_unitario})),Q=await ne.from("compras_detalle").insert(K);if(Q.error)throw await ne.from("compras").delete().eq("id",z),Q.error;try{const se=x?`Compra - ${x}`:`Compra ${z}`;let ie="sistema";try{const Ue=localStorage.getItem("user");if(Ue){const Ve=JSON.parse(Ue);ie=Ve.username?`${Ve.username}${Ve.role?` (${Ve.role})`:""}`:String(Ve)}}catch{}const fe=new Date().toISOString(),de=T.map(Ue=>({producto_id:Ue.producto_id,cantidad:Ue.cantidad,tipo_de_movimiento:"ENTRADA",referencia:se,usuario:ie,fecha_salida:fe})),ye=await ne.from("registro_de_inventario").insert(de);ye.error&&(console.warn("Error registrando en registro_de_inventario",ye.error),J("Compra guardada, pero fall el registro en inventario: "+ye.error.message))}catch(se){console.warn("Registro inventario fallo",se)}Z(),a(),s&&s()}catch(L){J(L?.message||String(L))}finally{H(!1)}}const D=W();return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva compra"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),r.jsxs("select",{className:"input",value:m??"",onChange:L=>v(L.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),d.map(L=>r.jsx("option",{value:L.id,children:L.nombre},String(L.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento"}),r.jsx("input",{className:"input",value:x,onChange:L=>j(L.target.value)}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Tipo documento"}),r.jsx("input",{className:"input",value:b,onChange:L=>w(L.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:C??"",onChange:L=>M(L.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(L=>r.jsx("option",{value:L.id,children:L.nombre},L.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:L=>G(Number(L.target.value))}),r.jsx("input",{className:"input",type:"number",style:{width:120},value:E??"",onChange:L=>q(Number(L.target.value)),placeholder:"Costo unitario"}),r.jsx("button",{className:"btn-primary",onClick:F,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:T.map((L,ee)=>{const oe=L.cantidad*L.costo_unitario,pe=g>1?g/100:g,A=L.exento?0:oe*pe,z=L.exento?oe:oe-A;return r.jsxs("tr",{children:[r.jsx("td",{children:L.nombre}),r.jsx("td",{children:L.cantidad}),r.jsx("td",{children:L.costo_unitario.toFixed(2)}),r.jsx("td",{children:A.toFixed(2)}),r.jsx("td",{children:z.toFixed(2)}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>k(ee),children:"Quitar"})})]},`${L.producto_id}-${ee}`)})})]})})]})]}),r.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"flex-end",gap:12},children:r.jsxs("div",{style:{textAlign:"right"},children:[r.jsxs("div",{children:["Subtotal: ",r.jsx("strong",{children:D.subtotal.toFixed(2)})]}),r.jsxs("div",{children:["Impuesto: ",r.jsx("strong",{children:D.impuesto.toFixed(2)})]}),r.jsxs("div",{children:["Total: ",r.jsx("strong",{children:D.total.toFixed(2)})]})]})}),he&&r.jsx("div",{style:{color:"red",marginTop:12},children:he}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>{Z(),a()},disabled:U,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:_e,disabled:U,children:U?"Guardando...":"Confirmar compra"})]})]})})}function Z_({open:o,compraId:a,onClose:s}){const[l,u]=S.useState([]),[d,f]=S.useState({}),[g,p]=S.useState({}),[m,v]=S.useState(0),[x,j]=S.useState(!1);return S.useEffect(()=>{if(!o||a==null)return;let b=!0;return(async()=>{j(!0);try{const{data:w,error:T}=await ne.from("compras_detalle").select("id, compra_id, producto_id, cantidad, costo_unitario, subtotal").eq("compra_id",a);if(T)throw T;const O=Array.isArray(w)?w:[];if(!b)return;u(O);const C=Array.from(new Set(O.map(M=>M.producto_id))).filter(Boolean);if(C.length>0){const{data:M}=await ne.from("inventario").select("id, nombre, exento").in("id",C),B={},G={};Array.isArray(M)&&M.forEach(E=>{B[String(E.id)]={id:E.id,nombre:E.nombre},G[String(E.id)]=E.exento===!0||E.exento===1||String(E.exento).toLowerCase()==="true"}),b&&(f(B),p(G))}else f({});try{const{data:M}=await ne.from("impuesto").select("impuesto_venta").limit(1).order("id",{ascending:!0}),B=Array.isArray(M)&&M.length>0?M[0]:null,G=B?Number(B.impuesto_venta):0;b&&v(G)}catch{}}catch(w){console.error("Error cargando detalle de compra",w)}finally{b&&j(!1)}})(),()=>{b=!1}},[o,a]),o?r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:760,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle de compra ",a]}),r.jsx("div",{style:{marginTop:8},children:x?r.jsx("div",{children:"Cargando..."}):r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Costo unit."}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:l.map(b=>{const w=Number(b.cantidad),T=Number(b.costo_unitario),O=w*T,C=m>1?m/100:m,M=g[String(b.producto_id)]===!0,B=M?0:O*C,G=M?O:O-B;return r.jsxs("tr",{children:[r.jsx("td",{children:d[String(b.producto_id)]?d[String(b.producto_id)].nombre:String(b.producto_id)}),r.jsx("td",{children:w.toFixed(2)}),r.jsx("td",{children:T.toFixed(2)}),r.jsx("td",{children:B.toFixed(2)}),r.jsx("td",{children:G.toFixed(2)}),r.jsx("td",{children:O.toFixed(2)})]},String(b.id))})}),r.jsx("tfoot",{children:l.length>0&&(()=>{const b=l.reduce((w,T)=>{const O=Number(T.cantidad),C=Number(T.costo_unitario),M=O*C,B=m>1?m/100:m,G=g[String(T.producto_id)]===!0,E=G?0:M*B,q=G?M:M-E;return w.subtotal+=q,w.impuesto+=E,w.total+=M,w},{subtotal:0,impuesto:0,total:0});return r.jsxs("tr",{children:[r.jsx("td",{colSpan:3,style:{textAlign:"right"},children:"Totales:"}),r.jsx("td",{children:b.impuesto.toFixed(2)}),r.jsx("td",{children:b.subtotal.toFixed(2)}),r.jsx("td",{children:b.total.toFixed(2)})]})})()})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:s,children:"Cerrar"})})]})}):null}function W_(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(!1),[p,m]=S.useState(!1),[v,x]=S.useState(null),[j,b]=S.useState([]),[w,T]=S.useState(""),[O,C]=S.useState(""),[M,B]=S.useState(!1);async function G(){l(!0),d(null);try{let E=ne.from("compras").select("id, proveedor_id, numero_documento, fecha_compra, subtotal, impuesto, total");if(w){const H=Number(w);isNaN(H)?E=E.eq("proveedor_id",w):E=E.eq("proveedor_id",H)}if(O&&(E=E.ilike("numero_documento",`%${O}%`)),M){const H=new Date(Date.now()-864e5).toISOString();E=E.gte("fecha_compra",H)}const{data:q,error:U}=await E.order("id",{ascending:!1});if(U)throw U;a(Array.isArray(q)?q:[])}catch(E){d(E?.message||String(E)),a([])}finally{l(!1)}}return S.useEffect(()=>{G()},[]),S.useEffect(()=>{let E=!0;return(async()=>{try{const{data:q}=await ne.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});if(!E)return;b(Array.isArray(q)?q:[])}catch{}})(),()=>{E=!1}},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Compras (compras)"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:w,onChange:E=>T(E.target.value),children:[r.jsx("option",{value:"",children:"-- proveedor (todos) --"}),j.map(E=>r.jsx("option",{value:String(E.id),children:E.nombre},String(E.id)))]}),r.jsx("input",{className:"input",placeholder:"Nmero documento",value:O,onChange:E=>C(E.target.value)}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"checkbox",checked:M,onChange:E=>B(E.target.checked)})," ltimas 24h"]}),r.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Aplicar"}),r.jsx("button",{className:"btn-opaque",onClick:()=>{T(""),C(""),B(!1),G()},children:"Limpiar"})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:[r.jsx("button",{className:"btn-opaque",onClick:()=>G(),children:"Recargar"}),r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva compra"}),r.jsx("div",{style:{marginLeft:12,color:"#64748b"},children:s?"Cargando...":`${o.length} compras`})]})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Subtotal"}),r.jsx("th",{children:"Impuesto"}),r.jsx("th",{children:"Total"})]})}),r.jsx("tbody",{children:o.map(E=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(E.id)}),r.jsx("td",{children:String(E.proveedor_id)}),r.jsx("td",{children:E.numero_documento||""}),r.jsx("td",{children:E.fecha_compra||""}),r.jsx("td",{children:E.subtotal||""}),r.jsx("td",{children:E.impuesto||""}),r.jsx("td",{children:E.total||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>{x(E.id),m(!0)},children:"Detalle"})})]},String(E.id)))})]})}),r.jsx(F_,{open:f,onClose:()=>g(!1),onCreated:()=>{g(!1),G()}}),r.jsx(Z_,{open:p,compraId:v,onClose:()=>{m(!1),x(null)}})]})}function ex(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(!1),[p,m]=S.useState(null);async function v(){l(!0),d(null);try{const{data:x,error:j}=await ne.from("devoluciones_proveedores").select("id, proveedor_id, numero_documento, usuario, created_at").order("created_at",{ascending:!1});if(j)throw j;a(Array.isArray(x)?x.map(b=>({id:b.id,proveedor_id:b.proveedor_id,numero_documento:b.numero_documento,usuario:b.usuario,fecha:b.created_at})):[])}catch(x){d(x?.message||String(x)),a([])}finally{l(!1)}}return S.useEffect(()=>{v()},[]),r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{marginTop:0},children:"Devolucin a Proveedores"}),r.jsx("p",{style:{color:"#475569"},children:"Registra devoluciones de productos hacia proveedores. Este proceso crear un registro de devolucin y registrar la salida en `registro_de_inventario`."}),r.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[r.jsx("button",{className:"btn-primary",onClick:()=>g(!0),children:"Nueva devolucin"}),r.jsx("div",{style:{marginLeft:"auto",color:"#64748b"},children:s?"Cargando...":`${o.length} devoluciones`})]}),u&&r.jsx("div",{style:{color:"red",marginBottom:12},children:u}),r.jsx("div",{style:{background:"#fff",padding:12,borderRadius:8,overflowX:"auto"},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"ID"}),r.jsx("th",{children:"Proveedor"}),r.jsx("th",{children:"Documento"}),r.jsx("th",{children:"Usuario"}),r.jsx("th",{children:"Fecha"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:o.map(x=>r.jsxs("tr",{children:[r.jsx("td",{style:{width:80},children:String(x.id)}),r.jsx("td",{children:String(x.proveedor_id||"")}),r.jsx("td",{children:x.numero_documento||""}),r.jsx("td",{children:x.usuario||""}),r.jsx("td",{children:x.fecha||""}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>m(x.id),children:"Detalle"})})]},String(x.id)))})]})}),f&&r.jsx(tx,{onClose:()=>{g(!1),v()}}),p&&r.jsx(nx,{id:p,onClose:()=>{m(null),v()}})]})}function tx({onClose:o}){const[a,s]=S.useState([]),[l,u]=S.useState([]),[d,f]=S.useState(null),[g,p]=S.useState([]),[m,v]=S.useState(null),[x,j]=S.useState(null),[b,w]=S.useState(""),[T,O]=S.useState([]),[C,M]=S.useState(null),[B,G]=S.useState(1),[E,q]=S.useState(!1),[U,H]=S.useState(null);S.useEffect(()=>{(async()=>{try{const k=await ne.from("proveedores").select("id, nombre").order("nombre",{ascending:!0});s(Array.isArray(k.data)?k.data:[])}catch{}try{const k=await ne.from("inventario").select("id, nombre, sku").order("nombre",{ascending:!0});u(Array.isArray(k.data)?k.data:[])}catch{}})()},[]);async function he(){if(b){H(null);try{const{data:k,error:W}=await ne.from("compras").select("id, proveedor_id, numero_documento").eq("numero_documento",b).limit(1).single();if(W)throw W;if(!k){H("No se encontr compra con ese nmero de documento");return}f(k.id),v(k.proveedor_id);try{const{data:Q}=await ne.from("proveedores").select("id, nombre").eq("id",k.proveedor_id).limit(1).single();Q&&Q.nombre&&j(Q.nombre)}catch{}const{data:_e}=await ne.from("compras_detalle").select("producto_id, cantidad, costo_unitario").eq("compra_id",k.id),D=Array.isArray(_e)?_e:[],{data:L}=await ne.from("devoluciones_proveedores").select("id").eq("numero_documento",b),ee=Array.isArray(L)?L.map(Q=>Q.id):[];let oe={};if(ee.length>0){const{data:Q}=await ne.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").in("devolucion_id",ee);Array.isArray(Q)&&Q.forEach(se=>{const ie=String(se.producto_id);oe[ie]=(oe[ie]||0)+Number(se.cantidad)})}const pe=D.map(Q=>Q.producto_id),{data:A}=await ne.from("inventario").select("id, nombre, sku").in("id",pe),z={};Array.isArray(A)&&A.forEach(Q=>{z[String(Q.id)]=Q});const K=D.map(Q=>{const se=String(Q.producto_id),ie=Number(Q.cantidad),fe=oe[se]||0,de=Math.max(0,ie-fe);return{producto_id:se,nombre:z[se]?.nombre||se,sku:z[se]?.sku,purchased:ie,returned:fe,available:de,costo_unitario:Number(Q.costo_unitario||0)}});p(K),u(K.map(Q=>({id:Q.producto_id,nombre:Q.nombre,sku:Q.sku})))}catch(k){H(k?.message||String(k))}}}function J(){if(!C){H("Selecciona un producto");return}if(!B||B<=0){H("Cantidad invlida");return}const k=l.find(_e=>_e.id===C),W=g.find(_e=>_e.producto_id===C);if(W&&B>W.available){H(`Cantidad excede disponible para devolucin (${W.available})`);return}O(_e=>[..._e,{producto_id:C,nombre:k?.nombre,cantidad:B}]),M(null),G(1),H(null),W&&(p(_e=>_e.map(D=>D.producto_id===W.producto_id?{...D,available:Math.max(0,D.available-B)}:D)),u(_e=>_e.map(D=>(D.id===W.producto_id,D))))}function Z(k){O(W=>W.filter((_e,D)=>D!==k))}async function F(){if(H(null),!m){H("Selecciona un proveedor");return}if(T.length===0){H("Agrega al menos un producto");return}q(!0);try{const k={proveedor_id:m,numero_documento:b||null,usuario:null},W=await ne.from("devoluciones_proveedores").insert(k).select("id").single();if(W.error)throw W.error;const _e=W.data.id;try{const D=T.map(ee=>({devolucion_id:_e,producto_id:ee.producto_id,cantidad:ee.cantidad})),L=await ne.from("devoluciones_proveedores_detalle").insert(D);L.error&&console.warn("No se pudo insertar detalles de devolucin",L.error)}catch(D){console.warn("Detalles tabla puede no existir",D)}try{const D=b?`Devolucin - ${b}`:`Devolucin ${_e}`;let L="sistema";try{const A=localStorage.getItem("user");if(A){const z=JSON.parse(A);L=z.username?`${z.username}${z.role?` (${z.role})`:""}`:String(z)}}catch{}const ee=new Date().toISOString(),oe=T.map(A=>({producto_id:A.producto_id,cantidad:A.cantidad,tipo_de_movimiento:"SALIDA",referencia:D,usuario:L,fecha_salida:ee})),pe=await ne.from("registro_de_inventario").insert(oe);pe.error&&(console.warn("Error registrando en registro_de_inventario",pe.error),H("Devolucin guardada, pero fall el registro en inventario: "+pe.error.message))}catch(D){console.warn("Registro inventario fallo",D)}o()}catch(k){H(k?.message||String(k))}finally{q(!1)}}return r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:900,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"90vh",overflow:"auto"},children:[r.jsx("h3",{style:{marginTop:0},children:"Nueva devolucin a proveedor"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Proveedor"}),d?r.jsx("div",{style:{padding:8,background:"#f1f5f9",borderRadius:6},children:x||String(m||"")}):r.jsxs("select",{className:"input",value:m??"",onChange:k=>v(k.target.value||null),children:[r.jsx("option",{value:"",children:"-- seleccionar proveedor --"}),a.map(k=>r.jsx("option",{value:k.id,children:k.nombre},String(k.id)))]}),r.jsx("label",{style:{fontSize:13,marginTop:8},children:"Nmero documento / referencia"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{className:"input",value:b,onChange:k=>w(k.target.value)}),r.jsx("button",{className:"btn-opaque",onClick:()=>he(),children:"Buscar compra"})]}),d&&r.jsxs("div",{style:{marginTop:8,color:"#374151"},children:["Compra encontrada: #",d,"  proveedor seleccionado automticamente."]}),g&&g.length>0&&r.jsxs("div",{style:{marginTop:8,background:"#f8fafc",padding:8,borderRadius:6},children:[r.jsxs("div",{style:{fontSize:13,marginBottom:6},children:[r.jsx("strong",{children:"Productos en la compra"})," (disponible para devolucin)"]}),r.jsxs("table",{className:"admin-table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Comprado"}),r.jsx("th",{children:"Devuelto"}),r.jsx("th",{children:"Disponible"}),r.jsx("th",{})]})}),r.jsx("tbody",{children:g.map(k=>r.jsxs("tr",{children:[r.jsx("td",{children:k.nombre}),r.jsx("td",{style:{textAlign:"right"},children:Number(k.purchased).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(k.returned).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:Number(k.available).toFixed(2)}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("button",{className:"btn-opaque",onClick:()=>{M(k.producto_id),G(k.available||1)},children:"Usar"})})]},k.producto_id))})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13},children:"Agregar producto a devolver"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"input",value:C??"",onChange:k=>M(k.target.value||null),disabled:!!d,children:[r.jsx("option",{value:"",children:"-- seleccionar producto --"}),l.map(k=>r.jsx("option",{value:k.id,children:k.nombre},k.id))]}),r.jsx("input",{className:"input",type:"number",style:{width:90},value:B,onChange:k=>{const W=Number(k.target.value),_e=g.find(D=>D.producto_id===C);if(_e){const D=Number(_e.available||0);return isNaN(W)||W<1?G(1):W>D?G(D):G(W)}G(W)},min:1,max:C?g.find(k=>k.producto_id===C)?.available??void 0:void 0,disabled:(()=>{const k=g.find(W=>W.producto_id===C);return!!k&&Number(k.available||0)<=1})()}),r.jsx("button",{className:"btn-primary",onClick:J,children:"Agregar"})]}),r.jsx("div",{style:{marginTop:12},children:r.jsxs("table",{className:"admin-table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"}),r.jsx("th",{children:"Acciones"})]})}),r.jsx("tbody",{children:T.map((k,W)=>r.jsxs("tr",{children:[r.jsx("td",{children:k.nombre}),r.jsx("td",{style:{textAlign:"right"},children:k.cantidad}),r.jsx("td",{children:r.jsx("button",{className:"btn-opaque",onClick:()=>Z(W),children:"Quitar"})})]},`${k.producto_id}-${W}`))})]})})]})]}),U&&r.jsx("div",{style:{color:"red",marginTop:12},children:U}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[r.jsx("button",{className:"btn-opaque",onClick:o,disabled:E,children:"Cancelar"}),r.jsx("button",{className:"btn-primary",onClick:F,disabled:E,children:E?"Guardando...":"Registrar devolucin"})]})]})})}function nx({id:o,onClose:a}){const[s,l]=S.useState([]),[u,d]=S.useState(!1),[f,g]=S.useState(null);async function p(){d(!0),g(null);try{const{data:m,error:v}=await ne.from("devoluciones_proveedores_detalle").select("producto_id, cantidad").eq("devolucion_id",o);if(v)throw v;const x=Array.isArray(m)?m:[];if(x.length>0){const j=x.map(T=>T.producto_id),{data:b}=await ne.from("inventario").select("id, nombre, sku").in("id",j),w={};Array.isArray(b)&&b.forEach(T=>{w[String(T.id)]=T}),l(x.map(T=>({producto:w[String(T.producto_id)]?.nombre||String(T.producto_id),cantidad:T.cantidad})))}else{const{data:j}=await ne.from("registro_de_inventario").select("producto_id, cantidad").like("referencia",`%${o}%`),b=Array.isArray(j)?j:[],w=b.map(C=>C.producto_id),{data:T}=await ne.from("inventario").select("id, nombre, sku").in("id",w),O={};Array.isArray(T)&&T.forEach(C=>{O[String(C.id)]=C}),l(b.map(C=>({producto:O[String(C.producto_id)]?.nombre||String(C.producto_id),cantidad:C.cantidad})))}}catch(m){g(m?.message||String(m)),l([])}finally{d(!1)}}return S.useEffect(()=>{p()},[o]),r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:r.jsxs("div",{style:{width:720,maxWidth:"98%",background:"#fff",borderRadius:8,padding:16,maxHeight:"80vh",overflow:"auto"},children:[r.jsxs("h3",{style:{marginTop:0},children:["Detalle devolucin #",String(o)]}),u&&r.jsx("div",{children:"Cargando..."}),f&&r.jsx("div",{style:{color:"red"},children:f}),r.jsxs("table",{className:"admin-table",style:{marginTop:8},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"Producto"}),r.jsx("th",{children:"Cantidad"})]})}),r.jsx("tbody",{children:s.map((m,v)=>r.jsxs("tr",{children:[r.jsx("td",{children:m.producto}),r.jsx("td",{style:{textAlign:"right"},children:Number(m.cantidad).toFixed(2)})]},v))})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn-opaque",onClick:a,children:"Cerrar"})})]})})}const ax={1:"Impuesto de venta",2:"Impuesto 18%",3:"Impuesto turstico"};function ix(){const[o,a]=S.useState([]),[s,l]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,m]=S.useState(null),v=async()=>{l(!0),m(null);try{const{data:b,error:w}=await ne.from("impuesto").select("id, impuesto_venta").order("id",{ascending:!0});if(w)throw w;a(Array.isArray(b)?b:[])}catch(b){console.warn("Error cargando impuestos:",b),m(String(b.message||b))}finally{l(!1)}};S.useEffect(()=>{v()},[]);const x=(b,w)=>{a(T=>T.map(O=>O.id===b?{...O,impuesto_venta:w}:O))},j=async b=>{const w=o.find(T=>T.id===b);if(w){d(b),m(null);try{const T={impuesto_venta:w.impuesto_venta??null},{error:O}=await ne.from("impuesto").update(T).eq("id",b);if(O)throw O;await v()}catch(T){console.warn("Error guardando impuesto:",T),m(String(T.message||T))}finally{d(null)}}};return r.jsxs("div",{children:[r.jsx("h2",{children:"Impuestos"}),r.jsx("p",{style:{color:"#475569"},children:"Edite los valores de impuestos. Solo se permite actualizar registros existentes."}),s?r.jsx("div",{children:"Cargando..."}):r.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[o.map(b=>r.jsxs("div",{style:{width:300,borderRadius:8,padding:12,background:"white",boxShadow:"0 6px 18px rgba(2,6,23,0.06)"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8},children:ax[b.id]??`Impuesto #${b.id}`}),r.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:8},children:["ID: ",b.id]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("label",{style:{fontSize:12,color:"#334155"},children:"Impuesto (porcentaje)"}),r.jsx("input",{type:"text",value:b.impuesto_venta??"",onChange:w=>x(b.id,w.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid #e2e8f0"},disabled:f!==b.id}),r.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginTop:6},children:f===b.id?"Ahora puede editar. ":'Pulse "Actualizar" para habilitar edicin'})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},children:[r.jsx("div",{style:{color:"#94a3b8",fontSize:12},children:u===b.id?"Guardando...":""}),r.jsx("div",{style:{display:"flex",gap:8},children:f===b.id?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{g(null),v()},className:"btn-opaque",style:{background:"transparent"},children:"Cancelar"}),r.jsx("button",{onClick:()=>j(b.id),className:"btn-opaque",disabled:u===b.id,style:{opacity:u===b.id?.6:1},children:"Guardar"})]}):r.jsx("button",{onClick:()=>g(b.id),className:"btn-opaque",children:"Actualizar"})})]})]},b.id)),o.length===0&&r.jsx("div",{style:{color:"#64748b"},children:"No hay registros en la tabla `impuesto`."})]}),p&&r.jsxs("div",{style:{marginTop:12,color:"red"},children:["Error: ",p]})]})}const rx={dashboard:g_,datos:y_,usuarios_internal:b_,usuarios_web:v_,cai:j_,facturas:S_,historial_facturas:w_,inventario_productos:N_,precios_productos:U_,precios_historico:z_,stock:D_,inventario_salidas:B_,inventario_categorias:M_,proveedores:X_,caja_sesiones:q_,caja_movimientos:L_,rep_ventas:I_,rep_devoluciones:H_,rep_ingresos_egresos:V_,rep_compras:$_,compras_main:W_,devoluciones_proveedores:ex,rep_export:P_,cuentas_contables:G_,libro_diario:K_,auditoria:Y_,impuestos:ix};function sx({onLogout:o}){const[a,s]=S.useState("dashboard"),[l,u]=S.useState(null),[d,f]=S.useState({}),g=l||a,p=rx[g],v=(j=>{for(const b of rp){if(b.id===j)return b.label;if(b.children){const w=b.children.find(T=>T.id===j);if(w)return w.label}}return"Panel de Administracin"})(g),x=j=>{if(j.id==="salir")return o();j.children&&j.children.length>0?(f(b=>({...b,[j.id]:!b[j.id]})),(j.id!==a||!l)&&(s(j.id),u(j.children[0].id))):(s(j.id),u(null))};return r.jsxs("div",{style:{display:"flex",minHeight:"100vh",background:"#f8fafc"},children:[r.jsxs("aside",{style:{width:260,background:"#0f1724",color:"white",padding:18,boxShadow:"2px 0 6px rgba(2,6,23,0.08)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18},children:[r.jsx("strong",{children:"Panel Admin"}),r.jsx("button",{onClick:o,className:"btn-opaque",style:{background:"#ef4444",padding:"6px 8px"},children:"Salir"})]}),r.jsx("nav",{children:rp.map(j=>r.jsxs("div",{style:{marginBottom:6},children:[r.jsxs("div",{onClick:()=>x(j),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderRadius:6,cursor:"pointer",background:a===j.id&&!l?"rgba(255,255,255,0.06)":"transparent"},children:[r.jsx("span",{children:j.label}),Array.isArray(j.children)&&j.children.length>0?r.jsx("span",{style:{marginLeft:8},children:d[j.id]?"":""}):null]}),Array.isArray(j.children)&&j.children.length>0&&d[j.id]&&r.jsx("div",{style:{marginLeft:12,marginTop:6},children:j.children.map(b=>r.jsx("div",{onClick:()=>{s(j.id),u(b.id)},style:{padding:"6px 8px",borderRadius:6,cursor:"pointer",marginBottom:4,fontSize:13,color:l===b.id?"#e2e8f0":"#cbd5e1",background:l===b.id?"rgba(255,255,255,0.04)":"transparent"},children:b.label},b.id))})]},j.id))})]}),r.jsx("main",{style:{flex:1,padding:24},children:p?r.jsx(p,{}):r.jsx(f_,{title:v,children:a===g?"Seleccione una opcin del submen para ver la seccin correspondiente.":"Contenido no implementado o en construccin."})})]})}function lx(){const[o,a]=S.useState(null);S.useEffect(()=>{try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}},[]);function s(){try{const u=localStorage.getItem("user");u&&a(JSON.parse(u))}catch{a(null)}}function l(){localStorage.removeItem("user"),a(null)}return r.jsxs("div",{children:[!o&&r.jsx($0,{onLogin:s}),o&&o.role==="cajero"&&r.jsx(o_,{onLogout:l}),o&&o.role==="admin"&&r.jsx(sx,{onLogout:l}),o&&o.role!=="cajero"&&o.role!=="admin"&&r.jsxs("div",{style:{padding:24,maxWidth:900,margin:"32px auto",textAlign:"center"},children:[r.jsx("h2",{style:{marginTop:0},children:"Acceso restringido"}),r.jsxs("p",{style:{color:"#475569"},children:['Su cuenta tiene rol "',o.role||"sin rol",'". Solo usuarios con rol ',r.jsx("strong",{children:"cajero"})," pueden acceder al Punto de Ventas."]}),r.jsx("div",{style:{marginTop:18},children:r.jsx("button",{onClick:l,className:"btn-opaque",children:"Cerrar sesin"})})]})]})}class ox extends cp.Component{constructor(a){super(a),this.state={error:null,info:null}}static getDerivedStateFromError(a){return{error:a,info:null}}componentDidCatch(a,s){console.error("ErrorBoundary caught:",a,s),this.setState({error:a,info:s})}render(){return this.state.error?r.jsxs("div",{style:{padding:18},children:[r.jsx("h2",{style:{color:"#b91c1c"},children:"Error en la aplicacin"}),r.jsxs("div",{style:{background:"#fff",padding:12,borderRadius:6,border:"1px solid #fee2e2"},children:[r.jsxs("pre",{style:{whiteSpace:"pre-wrap",fontSize:12},children:[String(this.state.error),this.state.info?.componentStack]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Recargar"})})]})]}):this.props.children}}_v.createRoot(document.getElementById("root")).render(r.jsx(ox,{children:r.jsx(lx,{})}));
